"use strict";var nerdamer=(()=>{var E0=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var b1=E0((Xi,l1)=>{var zt=(function(i){"use strict";var t=1e7,e=7,v=9007199254740992,q=de(v),X="0123456789abcdefghijklmnopqrstuvwxyz",K=typeof BigInt=="function";function H(n,s,w,N){return typeof n>"u"?H[0]:typeof s<"u"?+s==10&&!w?a(n):Te(n,s,w,N):a(n)}function W(n,s){this.value=n,this.sign=s,this.isSmall=!1}W.prototype=Object.create(H.prototype);function u(n){this.value=n,this.sign=n<0,this.isSmall=!0}u.prototype=Object.create(H.prototype);function re(n){this.value=n}re.prototype=Object.create(H.prototype);function j(n){return-v<n&&n<v}function de(n){return n<1e7?[n]:n<1e14?[n%1e7,Math.floor(n/1e7)]:[n%1e7,Math.floor(n/1e7)%1e7,Math.floor(n/1e14)]}function _e(n){Ue(n);var s=n.length;if(s<4&&b(n,q)<0)switch(s){case 0:return 0;case 1:return n[0];case 2:return n[0]+n[1]*t;default:return n[0]+(n[1]+n[2]*t)*t}return n}function Ue(n){for(var s=n.length;n[--s]===0;);n.length=s+1}function te(n){for(var s=new Array(n),w=-1;++w<n;)s[w]=0;return s}function ue(n){return n>0?Math.floor(n):Math.ceil(n)}function ce(n,s){var w=n.length,N=s.length,I=new Array(w),P=0,B=t,x,L;for(L=0;L<N;L++)x=n[L]+s[L]+P,P=x>=B?1:0,I[L]=x-P*B;for(;L<w;)x=n[L]+P,P=x===B?1:0,I[L++]=x-P*B;return P>0&&I.push(P),I}function Z(n,s){return n.length>=s.length?ce(n,s):ce(s,n)}function Le(n,s){var w=n.length,N=new Array(w),I=t,P,B;for(B=0;B<w;B++)P=n[B]-I+s,s=Math.floor(P/I),N[B]=P-s*I,s+=1;for(;s>0;)N[B++]=s%I,s=Math.floor(s/I);return N}W.prototype.add=function(n){var s=a(n);if(this.sign!==s.sign)return this.subtract(s.negate());var w=this.value,N=s.value;return s.isSmall?new W(Le(w,Math.abs(N)),this.sign):new W(Z(w,N),this.sign)},W.prototype.plus=W.prototype.add,u.prototype.add=function(n){var s=a(n),w=this.value;if(w<0!==s.sign)return this.subtract(s.negate());var N=s.value;if(s.isSmall){if(j(w+N))return new u(w+N);N=de(Math.abs(N))}return new W(Le(N,Math.abs(w)),w<0)},u.prototype.plus=u.prototype.add,re.prototype.add=function(n){return new re(this.value+a(n).value)},re.prototype.plus=re.prototype.add;function Be(n,s){var w=n.length,N=s.length,I=new Array(w),P=0,B=t,x,L;for(x=0;x<N;x++)L=n[x]-P-s[x],L<0?(L+=B,P=1):P=0,I[x]=L;for(x=N;x<w;x++){if(L=n[x]-P,L<0)L+=B;else{I[x++]=L;break}I[x]=L}for(;x<w;x++)I[x]=n[x];return Ue(I),I}function $e(n,s,w){var N;return b(n,s)>=0?N=Be(n,s):(N=Be(s,n),w=!w),N=_e(N),typeof N=="number"?(w&&(N=-N),new u(N)):new W(N,w)}function ve(n,s,w){var N=n.length,I=new Array(N),P=-s,B=t,x,L;for(x=0;x<N;x++)L=n[x]+P,P=Math.floor(L/B),L%=B,I[x]=L<0?L+B:L;return I=_e(I),typeof I=="number"?(w&&(I=-I),new u(I)):new W(I,w)}W.prototype.subtract=function(n){var s=a(n);if(this.sign!==s.sign)return this.add(s.negate());var w=this.value,N=s.value;return s.isSmall?ve(w,Math.abs(N),this.sign):$e(w,N,this.sign)},W.prototype.minus=W.prototype.subtract,u.prototype.subtract=function(n){var s=a(n),w=this.value;if(w<0!==s.sign)return this.add(s.negate());var N=s.value;return s.isSmall?new u(w-N):ve(N,Math.abs(w),w>=0)},u.prototype.minus=u.prototype.subtract,re.prototype.subtract=function(n){return new re(this.value-a(n).value)},re.prototype.minus=re.prototype.subtract,W.prototype.negate=function(){return new W(this.value,!this.sign)},u.prototype.negate=function(){var n=this.sign,s=new u(-this.value);return s.sign=!n,s},re.prototype.negate=function(){return new re(-this.value)},W.prototype.abs=function(){return new W(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},re.prototype.abs=function(){return new re(this.value>=0?this.value:-this.value)};function qe(n,s){var w=n.length,N=s.length,I=w+N,P=te(I),B=t,x,L,z,he,Se;for(z=0;z<w;++z){he=n[z];for(var Re=0;Re<N;++Re)Se=s[Re],x=he*Se+P[z+Re],L=Math.floor(x/B),P[z+Re]=x-L*B,P[z+Re+1]+=L}return Ue(P),P}function me(n,s){var w=n.length,N=new Array(w),I=t,P=0,B,x;for(x=0;x<w;x++)B=n[x]*s+P,P=Math.floor(B/I),N[x]=B-P*I;for(;P>0;)N[x++]=P%I,P=Math.floor(P/I);return N}function Q(n,s){for(var w=[];s-- >0;)w.push(0);return w.concat(n)}function c(n,s){var w=Math.max(n.length,s.length);if(w<=30)return qe(n,s);w=Math.ceil(w/2);var N=n.slice(w),I=n.slice(0,w),P=s.slice(w),B=s.slice(0,w),x=c(I,B),L=c(N,P),z=c(Z(I,N),Z(B,P)),he=Z(Z(x,Q(Be(Be(z,x),L),w)),Q(L,2*w));return Ue(he),he}function p(n,s){return-.012*n-.012*s+15e-6*n*s>0}W.prototype.multiply=function(n){var s=a(n),w=this.value,N=s.value,I=this.sign!==s.sign,P;if(s.isSmall){if(N===0)return H[0];if(N===1)return this;if(N===-1)return this.negate();if(P=Math.abs(N),P<t)return new W(me(w,P),I);N=de(P)}return p(w.length,N.length)?new W(c(w,N),I):new W(qe(w,N),I)},W.prototype.times=W.prototype.multiply;function r(n,s,w){return n<t?new W(me(s,n),w):new W(qe(s,de(n)),w)}u.prototype._multiplyBySmall=function(n){return j(n.value*this.value)?new u(n.value*this.value):r(Math.abs(n.value),de(Math.abs(this.value)),this.sign!==n.sign)},W.prototype._multiplyBySmall=function(n){return n.value===0?H[0]:n.value===1?this:n.value===-1?this.negate():r(Math.abs(n.value),this.value,this.sign!==n.sign)},u.prototype.multiply=function(n){return a(n)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,re.prototype.multiply=function(n){return new re(this.value*a(n).value)},re.prototype.times=re.prototype.multiply;function g(n){var s=n.length,w=te(s+s),N=t,I,P,B,x,L;for(B=0;B<s;B++){x=n[B],P=0-x*x;for(var z=B;z<s;z++)L=n[z],I=2*(x*L)+w[B+z]+P,P=Math.floor(I/N),w[B+z]=I-P*N;w[B+s]=P}return Ue(w),w}W.prototype.square=function(){return new W(g(this.value),!1)},u.prototype.square=function(){var n=this.value*this.value;return j(n)?new u(n):new W(g(de(Math.abs(this.value))),!1)},re.prototype.square=function(n){return new re(this.value*this.value)};function d(n,s){var w=n.length,N=s.length,I=t,P=te(s.length),B=s[N-1],x=Math.ceil(I/(2*B)),L=me(n,x),z=me(s,x),he,Se,Re,Fe,De,Ze,xe;for(L.length<=w&&L.push(0),z.push(0),B=z[N-1],Se=w-N;Se>=0;Se--){for(he=I-1,L[Se+N]!==B&&(he=Math.floor((L[Se+N]*I+L[Se+N-1])/B)),Re=0,Fe=0,Ze=z.length,De=0;De<Ze;De++)Re+=he*z[De],xe=Math.floor(Re/I),Fe+=L[Se+De]-(Re-xe*I),Re=xe,Fe<0?(L[Se+De]=Fe+I,Fe=-1):(L[Se+De]=Fe,Fe=0);for(;Fe!==0;){for(he-=1,Re=0,De=0;De<Ze;De++)Re+=L[Se+De]-I+z[De],Re<0?(L[Se+De]=Re+I,Re=0):(L[Se+De]=Re,Re=1);Fe+=Re}P[Se]=he}return L=A(L,x)[0],[_e(P),_e(L)]}function S(n,s){for(var w=n.length,N=s.length,I=[],P=[],B=t,x,L,z,he,Se;w;){if(P.unshift(n[--w]),Ue(P),b(P,s)<0){I.push(0);continue}L=P.length,z=P[L-1]*B+P[L-2],he=s[N-1]*B+s[N-2],L>N&&(z=(z+1)*B),x=Math.ceil(z/he);do{if(Se=me(s,x),b(Se,P)<=0)break;x--}while(x);I.push(x),P=Be(P,Se)}return I.reverse(),[_e(I),_e(P)]}function A(n,s){var w=n.length,N=te(w),I=t,P,B,x,L;for(x=0,P=w-1;P>=0;--P)L=x*I+n[P],B=ue(L/s),x=L-B*s,N[P]=B|0;return[N,x|0]}function D(n,s){var w,N=a(s);if(K)return[new re(n.value/N.value),new re(n.value%N.value)];var I=n.value,P=N.value,B;if(P===0)throw new Error("Cannot divide by zero");if(n.isSmall)return N.isSmall?[new u(ue(I/P)),new u(I%P)]:[H[0],n];if(N.isSmall){if(P===1)return[n,H[0]];if(P==-1)return[n.negate(),H[0]];var x=Math.abs(P);if(x<t){w=A(I,x),B=_e(w[0]);var L=w[1];return n.sign&&(L=-L),typeof B=="number"?(n.sign!==N.sign&&(B=-B),[new u(B),new u(L)]):[new W(B,n.sign!==N.sign),new u(L)]}P=de(x)}var z=b(I,P);if(z===-1)return[H[0],n];if(z===0)return[H[n.sign===N.sign?1:-1],H[0]];I.length+P.length<=200?w=d(I,P):w=S(I,P),B=w[0];var he=n.sign!==N.sign,Se=w[1],Re=n.sign;return typeof B=="number"?(he&&(B=-B),B=new u(B)):B=new W(B,he),typeof Se=="number"?(Re&&(Se=-Se),Se=new u(Se)):Se=new W(Se,Re),[B,Se]}W.prototype.divmod=function(n){var s=D(this,n);return{quotient:s[0],remainder:s[1]}},re.prototype.divmod=u.prototype.divmod=W.prototype.divmod,W.prototype.divide=function(n){return D(this,n)[0]},re.prototype.over=re.prototype.divide=function(n){return new re(this.value/a(n).value)},u.prototype.over=u.prototype.divide=W.prototype.over=W.prototype.divide,W.prototype.mod=function(n){return D(this,n)[1]},re.prototype.mod=re.prototype.remainder=function(n){return new re(this.value%a(n).value)},u.prototype.remainder=u.prototype.mod=W.prototype.remainder=W.prototype.mod,W.prototype.pow=function(n){var s=a(n),w=this.value,N=s.value,I,P,B;if(N===0)return H[1];if(w===0)return H[0];if(w===1)return H[1];if(w===-1)return s.isEven()?H[1]:H[-1];if(s.sign)return H[0];if(!s.isSmall)throw new Error("The exponent "+s.toString()+" is too large.");if(this.isSmall&&j(I=Math.pow(w,N)))return new u(ue(I));for(P=this,B=H[1];N&!0&&(B=B.times(P),--N),N!==0;)N/=2,P=P.square();return B},u.prototype.pow=W.prototype.pow,re.prototype.pow=function(n){var s=a(n),w=this.value,N=s.value,I=BigInt(0),P=BigInt(1),B=BigInt(2);if(N===I)return H[1];if(w===I)return H[0];if(w===P)return H[1];if(w===BigInt(-1))return s.isEven()?H[1]:H[-1];if(s.isNegative())return new re(I);for(var x=this,L=H[1];(N&P)===P&&(L=L.times(x),--N),N!==I;)N/=B,x=x.square();return L},W.prototype.modPow=function(n,s){if(n=a(n),s=a(s),s.isZero())throw new Error("Cannot take modPow with modulus 0");var w=H[1],N=this.mod(s);for(n.isNegative()&&(n=n.multiply(H[-1]),N=N.modInv(s));n.isPositive();){if(N.isZero())return H[0];n.isOdd()&&(w=w.multiply(N).mod(s)),n=n.divide(2),N=N.square().mod(s)}return w},re.prototype.modPow=u.prototype.modPow=W.prototype.modPow;function b(n,s){if(n.length!==s.length)return n.length>s.length?1:-1;for(var w=n.length-1;w>=0;w--)if(n[w]!==s[w])return n[w]>s[w]?1:-1;return 0}W.prototype.compareAbs=function(n){var s=a(n),w=this.value,N=s.value;return s.isSmall?1:b(w,N)},u.prototype.compareAbs=function(n){var s=a(n),w=Math.abs(this.value),N=s.value;return s.isSmall?(N=Math.abs(N),w===N?0:w>N?1:-1):-1},re.prototype.compareAbs=function(n){var s=this.value,w=a(n).value;return s=s>=0?s:-s,w=w>=0?w:-w,s===w?0:s>w?1:-1},W.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var s=a(n),w=this.value,N=s.value;return this.sign!==s.sign?s.sign?1:-1:s.isSmall?this.sign?-1:1:b(w,N)*(this.sign?-1:1)},W.prototype.compareTo=W.prototype.compare,u.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var s=a(n),w=this.value,N=s.value;return s.isSmall?w==N?0:w>N?1:-1:w<0!==s.sign?w<0?-1:1:w<0?1:-1},u.prototype.compareTo=u.prototype.compare,re.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var s=this.value,w=a(n).value;return s===w?0:s>w?1:-1},re.prototype.compareTo=re.prototype.compare,W.prototype.equals=function(n){return this.compare(n)===0},re.prototype.eq=re.prototype.equals=u.prototype.eq=u.prototype.equals=W.prototype.eq=W.prototype.equals,W.prototype.notEquals=function(n){return this.compare(n)!==0},re.prototype.neq=re.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=W.prototype.neq=W.prototype.notEquals,W.prototype.greater=function(n){return this.compare(n)>0},re.prototype.gt=re.prototype.greater=u.prototype.gt=u.prototype.greater=W.prototype.gt=W.prototype.greater,W.prototype.lesser=function(n){return this.compare(n)<0},re.prototype.lt=re.prototype.lesser=u.prototype.lt=u.prototype.lesser=W.prototype.lt=W.prototype.lesser,W.prototype.greaterOrEquals=function(n){return this.compare(n)>=0},re.prototype.geq=re.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=W.prototype.geq=W.prototype.greaterOrEquals,W.prototype.lesserOrEquals=function(n){return this.compare(n)<=0},re.prototype.leq=re.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=W.prototype.leq=W.prototype.lesserOrEquals,W.prototype.isEven=function(){return(this.value[0]&1)===0},u.prototype.isEven=function(){return(this.value&1)===0},re.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},W.prototype.isOdd=function(){return(this.value[0]&1)===1},u.prototype.isOdd=function(){return(this.value&1)===1},re.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},W.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},re.prototype.isPositive=u.prototype.isPositive,W.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},re.prototype.isNegative=u.prototype.isNegative,W.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return Math.abs(this.value)===1},re.prototype.isUnit=function(){return this.abs().value===BigInt(1)},W.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return this.value===0},re.prototype.isZero=function(){return this.value===BigInt(0)},W.prototype.isDivisibleBy=function(n){var s=a(n);return s.isZero()?!1:s.isUnit()?!0:s.compareAbs(2)===0?this.isEven():this.mod(s).isZero()},re.prototype.isDivisibleBy=u.prototype.isDivisibleBy=W.prototype.isDivisibleBy;function C(n){var s=n.abs();if(s.isUnit())return!1;if(s.equals(2)||s.equals(3)||s.equals(5))return!0;if(s.isEven()||s.isDivisibleBy(3)||s.isDivisibleBy(5))return!1;if(s.lesser(49))return!0}function V(n,s){for(var w=n.prev(),N=w,I=0,P,B,x,L;N.isEven();)N=N.divide(2),I++;e:for(x=0;x<s.length;x++)if(!n.lesser(s[x])&&(L=zt(s[x]).modPow(N,n),!(L.isUnit()||L.equals(w)))){for(P=I-1;P!=0;P--){if(L=L.square().mod(n),L.isUnit())return!1;if(L.equals(w))continue e}return!1}return!0}W.prototype.isPrime=function(n){var s=C(this);if(s!==i)return s;var w=this.abs(),N=w.bitLength();if(N<=64)return V(w,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var I=Math.log(2)*N.toJSNumber(),P=Math.ceil(n===!0?2*Math.pow(I,2):I),B=[],x=0;x<P;x++)B.push(zt(x+2));return V(w,B)},re.prototype.isPrime=u.prototype.isPrime=W.prototype.isPrime,W.prototype.isProbablePrime=function(n,s){var w=C(this);if(w!==i)return w;for(var N=this.abs(),I=n===i?5:n,P=[],B=0;B<I;B++)P.push(zt.randBetween(2,N.minus(2),s));return V(N,P)},re.prototype.isProbablePrime=u.prototype.isProbablePrime=W.prototype.isProbablePrime,W.prototype.modInv=function(n){for(var s=zt.zero,w=zt.one,N=a(n),I=this.abs(),P,B,x;!I.isZero();)P=N.divide(I),B=s,x=N,s=w,N=I,w=B.subtract(P.multiply(w)),I=x.subtract(P.multiply(I));if(!N.isUnit())throw new Error(this.toString()+" and "+n.toString()+" are not co-prime");return s.compare(0)===-1&&(s=s.add(n)),this.isNegative()?s.negate():s},re.prototype.modInv=u.prototype.modInv=W.prototype.modInv,W.prototype.next=function(){var n=this.value;return this.sign?ve(n,1,this.sign):new W(Le(n,1),this.sign)},u.prototype.next=function(){var n=this.value;return n+1<v?new u(n+1):new W(q,!1)},re.prototype.next=function(){return new re(this.value+BigInt(1))},W.prototype.prev=function(){var n=this.value;return this.sign?new W(Le(n,1),!0):ve(n,1,this.sign)},u.prototype.prev=function(){var n=this.value;return n-1>-v?new u(n-1):new W(q,!0)},re.prototype.prev=function(){return new re(this.value-BigInt(1))};for(var J=[1];2*J[J.length-1]<=t;)J.push(2*J[J.length-1]);var ie=J.length,fe=J[ie-1];function Oe(n){return Math.abs(n)<=t}W.prototype.shiftLeft=function(n){var s=a(n).toJSNumber();if(!Oe(s))throw new Error(String(s)+" is too large for shifting.");if(s<0)return this.shiftRight(-s);var w=this;if(w.isZero())return w;for(;s>=ie;)w=w.multiply(fe),s-=ie-1;return w.multiply(J[s])},re.prototype.shiftLeft=u.prototype.shiftLeft=W.prototype.shiftLeft,W.prototype.shiftRight=function(n){var s,w=a(n).toJSNumber();if(!Oe(w))throw new Error(String(w)+" is too large for shifting.");if(w<0)return this.shiftLeft(-w);for(var N=this;w>=ie;){if(N.isZero()||N.isNegative()&&N.isUnit())return N;s=D(N,fe),N=s[1].isNegative()?s[0].prev():s[0],w-=ie-1}return s=D(N,J[w]),s[1].isNegative()?s[0].prev():s[0]},re.prototype.shiftRight=u.prototype.shiftRight=W.prototype.shiftRight;function ge(n,s,w){s=a(s);for(var N=n.isNegative(),I=s.isNegative(),P=N?n.not():n,B=I?s.not():s,x=0,L=0,z=null,he=null,Se=[];!P.isZero()||!B.isZero();)z=D(P,fe),x=z[1].toJSNumber(),N&&(x=fe-1-x),he=D(B,fe),L=he[1].toJSNumber(),I&&(L=fe-1-L),P=z[0],B=he[0],Se.push(w(x,L));for(var Re=w(N?1:0,I?1:0)!==0?zt(-1):zt(0),Fe=Se.length-1;Fe>=0;Fe-=1)Re=Re.multiply(fe).add(zt(Se[Fe]));return Re}W.prototype.not=function(){return this.negate().prev()},re.prototype.not=u.prototype.not=W.prototype.not,W.prototype.and=function(n){return ge(this,n,function(s,w){return s&w})},re.prototype.and=u.prototype.and=W.prototype.and,W.prototype.or=function(n){return ge(this,n,function(s,w){return s|w})},re.prototype.or=u.prototype.or=W.prototype.or,W.prototype.xor=function(n){return ge(this,n,function(s,w){return s^w})},re.prototype.xor=u.prototype.xor=W.prototype.xor;var Ve=1<<30,Qe=(t&-t)*(t&-t)|Ve;function Ae(n){var s=n.value,w=typeof s=="number"?s|Ve:typeof s=="bigint"?s|BigInt(Ve):s[0]+s[1]*t|Qe;return w&-w}function Ge(n,s){if(s.compareTo(n)<=0){var w=Ge(n,s.square(s)),N=w.p,I=w.e,P=N.multiply(s);return P.compareTo(n)<=0?{p:P,e:I*2+1}:{p:N,e:I*2}}return{p:zt(1),e:0}}W.prototype.bitLength=function(){var n=this;return n.compareTo(zt(0))<0&&(n=n.negate().subtract(zt(1))),n.compareTo(zt(0))===0?zt(0):zt(Ge(n,zt(2)).e).add(zt(1))},re.prototype.bitLength=u.prototype.bitLength=W.prototype.bitLength;function je(n,s){return n=a(n),s=a(s),n.greater(s)?n:s}function tt(n,s){return n=a(n),s=a(s),n.lesser(s)?n:s}function Xe(n,s){if(n=a(n).abs(),s=a(s).abs(),n.equals(s))return n;if(n.isZero())return s;if(s.isZero())return n;for(var w=H[1],N,I;n.isEven()&&s.isEven();)N=tt(Ae(n),Ae(s)),n=n.divide(N),s=s.divide(N),w=w.multiply(N);for(;n.isEven();)n=n.divide(Ae(n));do{for(;s.isEven();)s=s.divide(Ae(s));n.greater(s)&&(I=s,s=n,n=I),s=s.subtract(n)}while(!s.isZero());return w.isUnit()?n:n.multiply(w)}function Je(n,s){return n=a(n).abs(),s=a(s).abs(),n.divide(Xe(n,s)).multiply(s)}function nt(n,s,w){n=a(n),s=a(s);var N=w||Math.random,I=tt(n,s),P=je(n,s),B=P.subtract(I).add(1);if(B.isSmall)return I.add(Math.floor(N()*B));for(var x=h(B,t).value,L=[],z=!0,he=0;he<x.length;he++){var Se=z?x[he]+(he+1<x.length?x[he+1]/t:0):t,Re=ue(N()*Se);L.push(Re),Re<x[he]&&(z=!1)}return I.add(H.fromArray(L,t,!1))}var Te=function(n,s,w,N){w=w||X,n=String(n),N||(n=n.toLowerCase(),w=w.toLowerCase());var I=n.length,P,B=Math.abs(s),x={};for(P=0;P<w.length;P++)x[w[P]]=P;for(P=0;P<I;P++){var L=n[P];if(L!=="-"&&L in x&&x[L]>=B){if(L==="1"&&B===1)continue;throw new Error(L+" is not a valid digit in base "+s+".")}}s=a(s);var z=[],he=n[0]==="-";for(P=he?1:0;P<n.length;P++){var L=n[P];if(L in x)z.push(a(x[L]));else if(L==="<"){var Se=P;do P++;while(n[P]!==">"&&P<n.length);z.push(a(n.slice(Se+1,P)))}else throw new Error(L+" is not a valid character")}return F(z,s,he)};function F(n,s,w){var N=H[0],I=H[1],P;for(P=n.length-1;P>=0;P--)N=N.add(n[P].times(I)),I=I.times(s);return w?N.negate():N}function G(n,s){return s=s||X,n<s.length?s[n]:"<"+n+">"}function h(n,s){if(s=zt(s),s.isZero()){if(n.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(s.equals(-1)){if(n.isZero())return{value:[0],isNegative:!1};if(n.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-n.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var w=Array.apply(null,Array(n.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return w.unshift([1]),{value:[].concat.apply([],w),isNegative:!1}}var N=!1;if(n.isNegative()&&s.isPositive()&&(N=!0,n=n.abs()),s.isUnit())return n.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(n.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:N};for(var I=[],P=n,B;P.isNegative()||P.compareAbs(s)>=0;){B=P.divmod(s),P=B.quotient;var x=B.remainder;x.isNegative()&&(x=s.minus(x).abs(),P=P.next()),I.push(x.toJSNumber())}return I.push(P.toJSNumber()),{value:I.reverse(),isNegative:N}}function R(n,s,w){var N=h(n,s);return(N.isNegative?"-":"")+N.value.map(function(I){return G(I,w)}).join("")}W.prototype.toArray=function(n){return h(this,n)},u.prototype.toArray=function(n){return h(this,n)},re.prototype.toArray=function(n){return h(this,n)},W.prototype.toString=function(n,s){if(n===i&&(n=10),n!==10||s)return R(this,n,s);for(var w=this.value,N=w.length,I=String(w[--N]),P="0000000",B;--N>=0;)B=String(w[N]),I+=P.slice(B.length)+B;var x=this.sign?"-":"";return x+I},u.prototype.toString=function(n,s){return n===i&&(n=10),n!=10||s?R(this,n,s):String(this.value)},re.prototype.toString=u.prototype.toString,re.prototype.toJSON=W.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},W.prototype.valueOf=function(){return parseInt(this.toString(),10)},W.prototype.toJSNumber=W.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,re.prototype.valueOf=re.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Y(n){if(j(+n)){var s=+n;if(s===ue(s))return K?new re(BigInt(s)):new u(s);throw new Error("Invalid integer: "+n)}var w=n[0]==="-";w&&(n=n.slice(1));var N=n.split(/e/i);if(N.length>2)throw new Error("Invalid integer: "+N.join("e"));if(N.length===2){var I=N[1];if(I[0]==="+"&&(I=I.slice(1)),I=+I,I!==ue(I)||!j(I))throw new Error("Invalid integer: "+I+" is not a valid exponent.");var P=N[0],B=P.indexOf(".");if(B>=0&&(I-=P.length-B-1,P=P.slice(0,B)+P.slice(B+1)),I<0)throw new Error("Cannot include negative exponent part for integers");P+=new Array(I+1).join("0"),n=P}var x=/^([0-9][0-9]*)$/.test(n);if(!x)throw new Error("Invalid integer: "+n);if(K)return new re(BigInt(w?"-"+n:n));for(var L=[],z=n.length,he=e,Se=z-he;z>0;)L.push(+n.slice(Se,z)),Se-=he,Se<0&&(Se=0),z-=he;return Ue(L),new W(L,w)}function U(n){if(K)return new re(BigInt(n));if(j(n)){if(n!==ue(n))throw new Error(n+" is not an integer.");return new u(n)}return Y(n.toString())}function a(n){return typeof n=="number"?U(n):typeof n=="string"?Y(n):typeof n=="bigint"?new re(n):n}for(var y=0;y<1e3;y++)H[y]=a(y),y>0&&(H[-y]=a(-y));return H.one=H[1],H.zero=H[0],H.minusOne=H[-1],H.max=je,H.min=tt,H.gcd=Xe,H.lcm=Je,H.isInstance=function(n){return n instanceof W||n instanceof u||n instanceof re},H.randBetween=nt,H.fromArray=function(n,s,w){return F(n.map(a),a(s||10),w)},H})();typeof l1<"u"&&l1.hasOwnProperty("exports")&&(l1.exports=zt);typeof define=="function"&&define.amd&&define(function(){return zt})});var B1=E0((F1,a1)=>{(function(i){"use strict";var t=9e15,e=1e9,v="0123456789abcdef",q="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",X="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",K={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-t,maxE:t,crypto:!1},H,W,u,re,j=!0,de="[DecimalError] ",_e=de+"Invalid argument: ",Ue=de+"Precision limit exceeded",te=de+"crypto unavailable",ue="[object Decimal]",ce=Math.floor,Z=Math.pow,Le=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Be=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,$e=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,ve=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qe=1e7,me=7,Q=9007199254740991,c=q.length-1,p=X.length-1,r={toStringTag:ue};r.absoluteValue=r.abs=function(){var m=new this.constructor(this);return m.s<0&&(m.s=1),C(m)},r.ceil=function(){return C(new this.constructor(this),this.e+1,2)},r.clampedTo=r.clamp=function(m,E){var M,_=this,T=_.constructor;if(m=new T(m),E=new T(E),!m.s||!E.s)return new T(NaN);if(m.gt(E))throw Error(_e+E);return M=_.cmp(m),M<0?m:_.cmp(E)>0?E:new T(_)},r.comparedTo=r.cmp=function(m){var E,M,_,T,O=this,ee=O.d,oe=(m=new O.constructor(m)).d,ae=O.s,le=m.s;if(!ee||!oe)return!ae||!le?NaN:ae!==le?ae:ee===oe?0:!ee^ae<0?1:-1;if(!ee[0]||!oe[0])return ee[0]?ae:oe[0]?-le:0;if(ae!==le)return ae;if(O.e!==m.e)return O.e>m.e^ae<0?1:-1;for(_=ee.length,T=oe.length,E=0,M=_<T?_:T;E<M;++E)if(ee[E]!==oe[E])return ee[E]>oe[E]^ae<0?1:-1;return _===T?0:_>T^ae<0?1:-1},r.cosine=r.cos=function(){var m,E,M=this,_=M.constructor;return M.d?M.d[0]?(m=_.precision,E=_.rounding,_.precision=m+Math.max(M.e,M.sd())+me,_.rounding=1,M=D(_,G(_,M)),_.precision=m,_.rounding=E,C(re==2||re==3?M.neg():M,m,E,!0)):new _(1):new _(NaN)},r.cubeRoot=r.cbrt=function(){var m,E,M,_,T,O,ee,oe,ae,le,ye=this,Ce=ye.constructor;if(!ye.isFinite()||ye.isZero())return new Ce(ye);for(j=!1,O=ye.s*Z(ye.s*ye,1/3),!O||Math.abs(O)==1/0?(M=g(ye.d),m=ye.e,(O=(m-M.length+1)%3)&&(M+=O==1||O==-2?"0":"00"),O=Z(M,1/3),m=ce((m+1)/3)-(m%3==(m<0?-1:2)),O==1/0?M="5e"+m:(M=O.toExponential(),M=M.slice(0,M.indexOf("e")+1)+m),_=new Ce(M),_.s=ye.s):_=new Ce(O.toString()),ee=(m=Ce.precision)+3;;)if(oe=_,ae=oe.times(oe).times(oe),le=ae.plus(ye),_=b(le.plus(ye).times(oe),le.plus(ae),ee+2,1),g(oe.d).slice(0,ee)===(M=g(_.d)).slice(0,ee))if(M=M.slice(ee-3,ee+1),M=="9999"||!T&&M=="4999"){if(!T&&(C(oe,m+1,0),oe.times(oe).times(oe).eq(ye))){_=oe;break}ee+=4,T=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(C(_,m+1,1),E=!_.times(_).times(_).eq(ye));break}return j=!0,C(_,m,Ce.rounding,E)},r.decimalPlaces=r.dp=function(){var m,E=this.d,M=NaN;if(E){if(m=E.length-1,M=(m-ce(this.e/me))*me,m=E[m],m)for(;m%10==0;m/=10)M--;M<0&&(M=0)}return M},r.dividedBy=r.div=function(m){return b(this,new this.constructor(m))},r.dividedToIntegerBy=r.divToInt=function(m){var E=this,M=E.constructor;return C(b(E,new M(m),0,1,1),M.precision,M.rounding)},r.equals=r.eq=function(m){return this.cmp(m)===0},r.floor=function(){return C(new this.constructor(this),this.e+1,3)},r.greaterThan=r.gt=function(m){return this.cmp(m)>0},r.greaterThanOrEqualTo=r.gte=function(m){var E=this.cmp(m);return E==1||E===0},r.hyperbolicCosine=r.cosh=function(){var m,E,M,_,T,O=this,ee=O.constructor,oe=new ee(1);if(!O.isFinite())return new ee(O.s?1/0:NaN);if(O.isZero())return oe;M=ee.precision,_=ee.rounding,ee.precision=M+Math.max(O.e,O.sd())+4,ee.rounding=1,T=O.d.length,T<32?(m=Math.ceil(T/3),E=(1/F(4,m)).toString()):(m=16,E="2.3283064365386962890625e-10"),O=Te(ee,1,O.times(E),new ee(1),!0);for(var ae,le=m,ye=new ee(8);le--;)ae=O.times(O),O=oe.minus(ae.times(ye.minus(ae.times(ye))));return C(O,ee.precision=M,ee.rounding=_,!0)},r.hyperbolicSine=r.sinh=function(){var m,E,M,_,T=this,O=T.constructor;if(!T.isFinite()||T.isZero())return new O(T);if(E=O.precision,M=O.rounding,O.precision=E+Math.max(T.e,T.sd())+4,O.rounding=1,_=T.d.length,_<3)T=Te(O,2,T,T,!0);else{m=1.4*Math.sqrt(_),m=m>16?16:m|0,T=T.times(1/F(5,m)),T=Te(O,2,T,T,!0);for(var ee,oe=new O(5),ae=new O(16),le=new O(20);m--;)ee=T.times(T),T=T.times(oe.plus(ee.times(ae.times(ee).plus(le))))}return O.precision=E,O.rounding=M,C(T,E,M,!0)},r.hyperbolicTangent=r.tanh=function(){var m,E,M=this,_=M.constructor;return M.isFinite()?M.isZero()?new _(M):(m=_.precision,E=_.rounding,_.precision=m+7,_.rounding=1,b(M.sinh(),M.cosh(),_.precision=m,_.rounding=E)):new _(M.s)},r.inverseCosine=r.acos=function(){var m=this,E=m.constructor,M=m.abs().cmp(1),_=E.precision,T=E.rounding;return M!==-1?M===0?m.isNeg()?fe(E,_,T):new E(0):new E(NaN):m.isZero()?fe(E,_+4,T).times(.5):(E.precision=_+6,E.rounding=1,m=new E(1).minus(m).div(m.plus(1)).sqrt().atan(),E.precision=_,E.rounding=T,m.times(2))},r.inverseHyperbolicCosine=r.acosh=function(){var m,E,M=this,_=M.constructor;return M.lte(1)?new _(M.eq(1)?0:NaN):M.isFinite()?(m=_.precision,E=_.rounding,_.precision=m+Math.max(Math.abs(M.e),M.sd())+4,_.rounding=1,j=!1,M=M.times(M).minus(1).sqrt().plus(M),j=!0,_.precision=m,_.rounding=E,M.ln()):new _(M)},r.inverseHyperbolicSine=r.asinh=function(){var m,E,M=this,_=M.constructor;return!M.isFinite()||M.isZero()?new _(M):(m=_.precision,E=_.rounding,_.precision=m+2*Math.max(Math.abs(M.e),M.sd())+6,_.rounding=1,j=!1,M=M.times(M).plus(1).sqrt().plus(M),j=!0,_.precision=m,_.rounding=E,M.ln())},r.inverseHyperbolicTangent=r.atanh=function(){var m,E,M,_,T=this,O=T.constructor;return T.isFinite()?T.e>=0?new O(T.abs().eq(1)?T.s/0:T.isZero()?T:NaN):(m=O.precision,E=O.rounding,_=T.sd(),Math.max(_,m)<2*-T.e-1?C(new O(T),m,E,!0):(O.precision=M=_-T.e,T=b(T.plus(1),new O(1).minus(T),M+m,1),O.precision=m+4,O.rounding=1,T=T.ln(),O.precision=m,O.rounding=E,T.times(.5))):new O(NaN)},r.inverseSine=r.asin=function(){var m,E,M,_,T=this,O=T.constructor;return T.isZero()?new O(T):(E=T.abs().cmp(1),M=O.precision,_=O.rounding,E!==-1?E===0?(m=fe(O,M+4,_).times(.5),m.s=T.s,m):new O(NaN):(O.precision=M+6,O.rounding=1,T=T.div(new O(1).minus(T.times(T)).sqrt().plus(1)).atan(),O.precision=M,O.rounding=_,T.times(2)))},r.inverseTangent=r.atan=function(){var m,E,M,_,T,O,ee,oe,ae,le=this,ye=le.constructor,Ce=ye.precision,Pe=ye.rounding;if(le.isFinite()){if(le.isZero())return new ye(le);if(le.abs().eq(1)&&Ce+4<=p)return ee=fe(ye,Ce+4,Pe).times(.25),ee.s=le.s,ee}else{if(!le.s)return new ye(NaN);if(Ce+4<=p)return ee=fe(ye,Ce+4,Pe).times(.5),ee.s=le.s,ee}for(ye.precision=oe=Ce+10,ye.rounding=1,M=Math.min(28,oe/me+2|0),m=M;m;--m)le=le.div(le.times(le).plus(1).sqrt().plus(1));for(j=!1,E=Math.ceil(oe/me),_=1,ae=le.times(le),ee=new ye(le),T=le;m!==-1;)if(T=T.times(ae),O=ee.minus(T.div(_+=2)),T=T.times(ae),ee=O.plus(T.div(_+=2)),ee.d[E]!==void 0)for(m=E;ee.d[m]===O.d[m]&&m--;);return M&&(ee=ee.times(2<<M-1)),j=!0,C(ee,ye.precision=Ce,ye.rounding=Pe,!0)},r.isFinite=function(){return!!this.d},r.isInteger=r.isInt=function(){return!!this.d&&ce(this.e/me)>this.d.length-2},r.isNaN=function(){return!this.s},r.isNegative=r.isNeg=function(){return this.s<0},r.isPositive=r.isPos=function(){return this.s>0},r.isZero=function(){return!!this.d&&this.d[0]===0},r.lessThan=r.lt=function(m){return this.cmp(m)<0},r.lessThanOrEqualTo=r.lte=function(m){return this.cmp(m)<1},r.logarithm=r.log=function(m){var E,M,_,T,O,ee,oe,ae,le=this,ye=le.constructor,Ce=ye.precision,Pe=ye.rounding,it=5;if(m==null)m=new ye(10),E=!0;else{if(m=new ye(m),M=m.d,m.s<0||!M||!M[0]||m.eq(1))return new ye(NaN);E=m.eq(10)}if(M=le.d,le.s<0||!M||!M[0]||le.eq(1))return new ye(M&&!M[0]?-1/0:le.s!=1?NaN:M?0:1/0);if(E)if(M.length>1)O=!0;else{for(T=M[0];T%10===0;)T/=10;O=T!==1}if(j=!1,oe=Ce+it,ee=je(le,oe),_=E?ie(ye,oe+10):je(m,oe),ae=b(ee,_,oe,1),S(ae.d,T=Ce,Pe))do if(oe+=10,ee=je(le,oe),_=E?ie(ye,oe+10):je(m,oe),ae=b(ee,_,oe,1),!O){+g(ae.d).slice(T+1,T+15)+1==1e14&&(ae=C(ae,Ce+1,0));break}while(S(ae.d,T+=10,Pe));return j=!0,C(ae,Ce,Pe)},r.minus=r.sub=function(m){var E,M,_,T,O,ee,oe,ae,le,ye,Ce,Pe,it=this,at=it.constructor;if(m=new at(m),!it.d||!m.d)return!it.s||!m.s?m=new at(NaN):it.d?m.s=-m.s:m=new at(m.d||it.s!==m.s?it:NaN),m;if(it.s!=m.s)return m.s=-m.s,it.plus(m);if(le=it.d,Pe=m.d,oe=at.precision,ae=at.rounding,!le[0]||!Pe[0]){if(Pe[0])m.s=-m.s;else if(le[0])m=new at(it);else return new at(ae===3?-0:0);return j?C(m,oe,ae):m}if(M=ce(m.e/me),ye=ce(it.e/me),le=le.slice(),O=ye-M,O){for(Ce=O<0,Ce?(E=le,O=-O,ee=Pe.length):(E=Pe,M=ye,ee=le.length),_=Math.max(Math.ceil(oe/me),ee)+2,O>_&&(O=_,E.length=1),E.reverse(),_=O;_--;)E.push(0);E.reverse()}else{for(_=le.length,ee=Pe.length,Ce=_<ee,Ce&&(ee=_),_=0;_<ee;_++)if(le[_]!=Pe[_]){Ce=le[_]<Pe[_];break}O=0}for(Ce&&(E=le,le=Pe,Pe=E,m.s=-m.s),ee=le.length,_=Pe.length-ee;_>0;--_)le[ee++]=0;for(_=Pe.length;_>O;){if(le[--_]<Pe[_]){for(T=_;T&&le[--T]===0;)le[T]=qe-1;--le[T],le[_]+=qe}le[_]-=Pe[_]}for(;le[--ee]===0;)le.pop();for(;le[0]===0;le.shift())--M;return le[0]?(m.d=le,m.e=J(le,M),j?C(m,oe,ae):m):new at(ae===3?-0:0)},r.modulo=r.mod=function(m){var E,M=this,_=M.constructor;return m=new _(m),!M.d||!m.s||m.d&&!m.d[0]?new _(NaN):!m.d||M.d&&!M.d[0]?C(new _(M),_.precision,_.rounding):(j=!1,_.modulo==9?(E=b(M,m.abs(),0,3,1),E.s*=m.s):E=b(M,m,0,_.modulo,1),E=E.times(m),j=!0,M.minus(E))},r.naturalExponential=r.exp=function(){return Ge(this)},r.naturalLogarithm=r.ln=function(){return je(this)},r.negated=r.neg=function(){var m=new this.constructor(this);return m.s=-m.s,C(m)},r.plus=r.add=function(m){var E,M,_,T,O,ee,oe,ae,le,ye,Ce=this,Pe=Ce.constructor;if(m=new Pe(m),!Ce.d||!m.d)return!Ce.s||!m.s?m=new Pe(NaN):Ce.d||(m=new Pe(m.d||Ce.s===m.s?Ce:NaN)),m;if(Ce.s!=m.s)return m.s=-m.s,Ce.minus(m);if(le=Ce.d,ye=m.d,oe=Pe.precision,ae=Pe.rounding,!le[0]||!ye[0])return ye[0]||(m=new Pe(Ce)),j?C(m,oe,ae):m;if(O=ce(Ce.e/me),_=ce(m.e/me),le=le.slice(),T=O-_,T){for(T<0?(M=le,T=-T,ee=ye.length):(M=ye,_=O,ee=le.length),O=Math.ceil(oe/me),ee=O>ee?O+1:ee+1,T>ee&&(T=ee,M.length=1),M.reverse();T--;)M.push(0);M.reverse()}for(ee=le.length,T=ye.length,ee-T<0&&(T=ee,M=ye,ye=le,le=M),E=0;T;)E=(le[--T]=le[T]+ye[T]+E)/qe|0,le[T]%=qe;for(E&&(le.unshift(E),++_),ee=le.length;le[--ee]==0;)le.pop();return m.d=le,m.e=J(le,_),j?C(m,oe,ae):m},r.precision=r.sd=function(m){var E,M=this;if(m!==void 0&&m!==!!m&&m!==1&&m!==0)throw Error(_e+m);return M.d?(E=Oe(M.d),m&&M.e+1>E&&(E=M.e+1)):E=NaN,E},r.round=function(){var m=this,E=m.constructor;return C(new E(m),m.e+1,E.rounding)},r.sine=r.sin=function(){var m,E,M=this,_=M.constructor;return M.isFinite()?M.isZero()?new _(M):(m=_.precision,E=_.rounding,_.precision=m+Math.max(M.e,M.sd())+me,_.rounding=1,M=nt(_,G(_,M)),_.precision=m,_.rounding=E,C(re>2?M.neg():M,m,E,!0)):new _(NaN)},r.squareRoot=r.sqrt=function(){var m,E,M,_,T,O,ee=this,oe=ee.d,ae=ee.e,le=ee.s,ye=ee.constructor;if(le!==1||!oe||!oe[0])return new ye(!le||le<0&&(!oe||oe[0])?NaN:oe?ee:1/0);for(j=!1,le=Math.sqrt(+ee),le==0||le==1/0?(E=g(oe),(E.length+ae)%2==0&&(E+="0"),le=Math.sqrt(E),ae=ce((ae+1)/2)-(ae<0||ae%2),le==1/0?E="5e"+ae:(E=le.toExponential(),E=E.slice(0,E.indexOf("e")+1)+ae),_=new ye(E)):_=new ye(le.toString()),M=(ae=ye.precision)+3;;)if(O=_,_=O.plus(b(ee,O,M+2,1)).times(.5),g(O.d).slice(0,M)===(E=g(_.d)).slice(0,M))if(E=E.slice(M-3,M+1),E=="9999"||!T&&E=="4999"){if(!T&&(C(O,ae+1,0),O.times(O).eq(ee))){_=O;break}M+=4,T=1}else{(!+E||!+E.slice(1)&&E.charAt(0)=="5")&&(C(_,ae+1,1),m=!_.times(_).eq(ee));break}return j=!0,C(_,ae,ye.rounding,m)},r.tangent=r.tan=function(){var m,E,M=this,_=M.constructor;return M.isFinite()?M.isZero()?new _(M):(m=_.precision,E=_.rounding,_.precision=m+10,_.rounding=1,M=M.sin(),M.s=1,M=b(M,new _(1).minus(M.times(M)).sqrt(),m+10,0),_.precision=m,_.rounding=E,C(re==2||re==4?M.neg():M,m,E,!0)):new _(NaN)},r.times=r.mul=function(m){var E,M,_,T,O,ee,oe,ae,le,ye=this,Ce=ye.constructor,Pe=ye.d,it=(m=new Ce(m)).d;if(m.s*=ye.s,!Pe||!Pe[0]||!it||!it[0])return new Ce(!m.s||Pe&&!Pe[0]&&!it||it&&!it[0]&&!Pe?NaN:!Pe||!it?m.s/0:m.s*0);for(M=ce(ye.e/me)+ce(m.e/me),ae=Pe.length,le=it.length,ae<le&&(O=Pe,Pe=it,it=O,ee=ae,ae=le,le=ee),O=[],ee=ae+le,_=ee;_--;)O.push(0);for(_=le;--_>=0;){for(E=0,T=ae+_;T>_;)oe=O[T]+it[_]*Pe[T-_-1]+E,O[T--]=oe%qe|0,E=oe/qe|0;O[T]=(O[T]+E)%qe|0}for(;!O[--ee];)O.pop();return E?++M:O.shift(),m.d=O,m.e=J(O,M),j?C(m,Ce.precision,Ce.rounding):m},r.toBinary=function(m,E){return h(this,2,m,E)},r.toDecimalPlaces=r.toDP=function(m,E){var M=this,_=M.constructor;return M=new _(M),m===void 0?M:(d(m,0,e),E===void 0?E=_.rounding:d(E,0,8),C(M,m+M.e+1,E))},r.toExponential=function(m,E){var M,_=this,T=_.constructor;return m===void 0?M=V(_,!0):(d(m,0,e),E===void 0?E=T.rounding:d(E,0,8),_=C(new T(_),m+1,E),M=V(_,!0,m+1)),_.isNeg()&&!_.isZero()?"-"+M:M},r.toFixed=function(m,E){var M,_,T=this,O=T.constructor;return m===void 0?M=V(T):(d(m,0,e),E===void 0?E=O.rounding:d(E,0,8),_=C(new O(T),m+T.e+1,E),M=V(_,!1,m+_.e+1)),T.isNeg()&&!T.isZero()?"-"+M:M},r.toFraction=function(m){var E,M,_,T,O,ee,oe,ae,le,ye,Ce,Pe,it=this,at=it.d,pt=it.constructor;if(!at)return new pt(it);if(le=M=new pt(1),_=ae=new pt(0),E=new pt(_),O=E.e=Oe(at)-it.e-1,ee=O%me,E.d[0]=Z(10,ee<0?me+ee:ee),m==null)m=O>0?E:le;else{if(oe=new pt(m),!oe.isInt()||oe.lt(le))throw Error(_e+oe);m=oe.gt(E)?O>0?E:le:oe}for(j=!1,oe=new pt(g(at)),ye=pt.precision,pt.precision=O=at.length*me*2;Ce=b(oe,E,0,1,1),T=M.plus(Ce.times(_)),T.cmp(m)!=1;)M=_,_=T,T=le,le=ae.plus(Ce.times(T)),ae=T,T=E,E=oe.minus(Ce.times(T)),oe=T;return T=b(m.minus(M),_,0,1,1),ae=ae.plus(T.times(le)),M=M.plus(T.times(_)),ae.s=le.s=it.s,Pe=b(le,_,O,1).minus(it).abs().cmp(b(ae,M,O,1).minus(it).abs())<1?[le,_]:[ae,M],pt.precision=ye,j=!0,Pe},r.toHexadecimal=r.toHex=function(m,E){return h(this,16,m,E)},r.toNearest=function(m,E){var M=this,_=M.constructor;if(M=new _(M),m==null){if(!M.d)return M;m=new _(1),E=_.rounding}else{if(m=new _(m),E===void 0?E=_.rounding:d(E,0,8),!M.d)return m.s?M:m;if(!m.d)return m.s&&(m.s=M.s),m}return m.d[0]?(j=!1,M=b(M,m,0,E,1).times(m),j=!0,C(M)):(m.s=M.s,M=m),M},r.toNumber=function(){return+this},r.toOctal=function(m,E){return h(this,8,m,E)},r.toPower=r.pow=function(m){var E,M,_,T,O,ee,oe=this,ae=oe.constructor,le=+(m=new ae(m));if(!oe.d||!m.d||!oe.d[0]||!m.d[0])return new ae(Z(+oe,le));if(oe=new ae(oe),oe.eq(1))return oe;if(_=ae.precision,O=ae.rounding,m.eq(1))return C(oe,_,O);if(E=ce(m.e/me),E>=m.d.length-1&&(M=le<0?-le:le)<=Q)return T=Ve(ae,oe,M,_),m.s<0?new ae(1).div(T):C(T,_,O);if(ee=oe.s,ee<0){if(E<m.d.length-1)return new ae(NaN);if((m.d[E]&1)==0&&(ee=1),oe.e==0&&oe.d[0]==1&&oe.d.length==1)return oe.s=ee,oe}return M=Z(+oe,le),E=M==0||!isFinite(M)?ce(le*(Math.log("0."+g(oe.d))/Math.LN10+oe.e+1)):new ae(M+"").e,E>ae.maxE+1||E<ae.minE-1?new ae(E>0?ee/0:0):(j=!1,ae.rounding=oe.s=1,M=Math.min(12,(E+"").length),T=Ge(m.times(je(oe,_+M)),_),T.d&&(T=C(T,_+5,1),S(T.d,_,O)&&(E=_+10,T=C(Ge(m.times(je(oe,E+M)),E),E+5,1),+g(T.d).slice(_+1,_+15)+1==1e14&&(T=C(T,_+1,0)))),T.s=ee,j=!0,ae.rounding=O,C(T,_,O))},r.toPrecision=function(m,E){var M,_=this,T=_.constructor;return m===void 0?M=V(_,_.e<=T.toExpNeg||_.e>=T.toExpPos):(d(m,1,e),E===void 0?E=T.rounding:d(E,0,8),_=C(new T(_),m,E),M=V(_,m<=_.e||_.e<=T.toExpNeg,m)),_.isNeg()&&!_.isZero()?"-"+M:M},r.toSignificantDigits=r.toSD=function(m,E){var M=this,_=M.constructor;return m===void 0?(m=_.precision,E=_.rounding):(d(m,1,e),E===void 0?E=_.rounding:d(E,0,8)),C(new _(M),m,E)},r.toString=function(){var m=this,E=m.constructor,M=V(m,m.e<=E.toExpNeg||m.e>=E.toExpPos);return m.isNeg()&&!m.isZero()?"-"+M:M},r.truncated=r.trunc=function(){return C(new this.constructor(this),this.e+1,1)},r.valueOf=r.toJSON=function(){var m=this,E=m.constructor,M=V(m,m.e<=E.toExpNeg||m.e>=E.toExpPos);return m.isNeg()?"-"+M:M};function g(m){var E,M,_,T=m.length-1,O="",ee=m[0];if(T>0){for(O+=ee,E=1;E<T;E++)_=m[E]+"",M=me-_.length,M&&(O+=ge(M)),O+=_;ee=m[E],_=ee+"",M=me-_.length,M&&(O+=ge(M))}else if(ee===0)return"0";for(;ee%10===0;)ee/=10;return O+ee}function d(m,E,M){if(m!==~~m||m<E||m>M)throw Error(_e+m)}function S(m,E,M,_){var T,O,ee,oe;for(O=m[0];O>=10;O/=10)--E;return--E<0?(E+=me,T=0):(T=Math.ceil((E+1)/me),E%=me),O=Z(10,me-E),oe=m[T]%O|0,_==null?E<3?(E==0?oe=oe/100|0:E==1&&(oe=oe/10|0),ee=M<4&&oe==99999||M>3&&oe==49999||oe==5e4||oe==0):ee=(M<4&&oe+1==O||M>3&&oe+1==O/2)&&(m[T+1]/O/100|0)==Z(10,E-2)-1||(oe==O/2||oe==0)&&(m[T+1]/O/100|0)==0:E<4?(E==0?oe=oe/1e3|0:E==1?oe=oe/100|0:E==2&&(oe=oe/10|0),ee=(_||M<4)&&oe==9999||!_&&M>3&&oe==4999):ee=((_||M<4)&&oe+1==O||!_&&M>3&&oe+1==O/2)&&(m[T+1]/O/1e3|0)==Z(10,E-3)-1,ee}function A(m,E,M){for(var _,T=[0],O,ee=0,oe=m.length;ee<oe;){for(O=T.length;O--;)T[O]*=E;for(T[0]+=v.indexOf(m.charAt(ee++)),_=0;_<T.length;_++)T[_]>M-1&&(T[_+1]===void 0&&(T[_+1]=0),T[_+1]+=T[_]/M|0,T[_]%=M)}return T.reverse()}function D(m,E){var M,_,T;if(E.isZero())return E;_=E.d.length,_<32?(M=Math.ceil(_/3),T=(1/F(4,M)).toString()):(M=16,T="2.3283064365386962890625e-10"),m.precision+=M,E=Te(m,1,E.times(T),new m(1));for(var O=M;O--;){var ee=E.times(E);E=ee.times(ee).minus(ee).times(8).plus(1)}return m.precision-=M,E}var b=(function(){function m(_,T,O){var ee,oe=0,ae=_.length;for(_=_.slice();ae--;)ee=_[ae]*T+oe,_[ae]=ee%O|0,oe=ee/O|0;return oe&&_.unshift(oe),_}function E(_,T,O,ee){var oe,ae;if(O!=ee)ae=O>ee?1:-1;else for(oe=ae=0;oe<O;oe++)if(_[oe]!=T[oe]){ae=_[oe]>T[oe]?1:-1;break}return ae}function M(_,T,O,ee){for(var oe=0;O--;)_[O]-=oe,oe=_[O]<T[O]?1:0,_[O]=oe*ee+_[O]-T[O];for(;!_[0]&&_.length>1;)_.shift()}return function(_,T,O,ee,oe,ae){var le,ye,Ce,Pe,it,at,pt,i0,Pt,p0,Ot,Jt,$0,d0,X0,k0,R0,H0,h0,P0,D0=_.constructor,j0=_.s==T.s?1:-1,Yt=_.d,Tt=T.d;if(!Yt||!Yt[0]||!Tt||!Tt[0])return new D0(!_.s||!T.s||(Yt?Tt&&Yt[0]==Tt[0]:!Tt)?NaN:Yt&&Yt[0]==0||!Tt?j0*0:j0/0);for(ae?(it=1,ye=_.e-T.e):(ae=qe,it=me,ye=ce(_.e/it)-ce(T.e/it)),h0=Tt.length,R0=Yt.length,Pt=new D0(j0),p0=Pt.d=[],Ce=0;Tt[Ce]==(Yt[Ce]||0);Ce++);if(Tt[Ce]>(Yt[Ce]||0)&&ye--,O==null?(d0=O=D0.precision,ee=D0.rounding):oe?d0=O+(_.e-T.e)+1:d0=O,d0<0)p0.push(1),at=!0;else{if(d0=d0/it+2|0,Ce=0,h0==1){for(Pe=0,Tt=Tt[0],d0++;(Ce<R0||Pe)&&d0--;Ce++)X0=Pe*ae+(Yt[Ce]||0),p0[Ce]=X0/Tt|0,Pe=X0%Tt|0;at=Pe||Ce<R0}else{for(Pe=ae/(Tt[0]+1)|0,Pe>1&&(Tt=m(Tt,Pe,ae),Yt=m(Yt,Pe,ae),h0=Tt.length,R0=Yt.length),k0=h0,Ot=Yt.slice(0,h0),Jt=Ot.length;Jt<h0;)Ot[Jt++]=0;P0=Tt.slice(),P0.unshift(0),H0=Tt[0],Tt[1]>=ae/2&&++H0;do Pe=0,le=E(Tt,Ot,h0,Jt),le<0?($0=Ot[0],h0!=Jt&&($0=$0*ae+(Ot[1]||0)),Pe=$0/H0|0,Pe>1?(Pe>=ae&&(Pe=ae-1),pt=m(Tt,Pe,ae),i0=pt.length,Jt=Ot.length,le=E(pt,Ot,i0,Jt),le==1&&(Pe--,M(pt,h0<i0?P0:Tt,i0,ae))):(Pe==0&&(le=Pe=1),pt=Tt.slice()),i0=pt.length,i0<Jt&&pt.unshift(0),M(Ot,pt,Jt,ae),le==-1&&(Jt=Ot.length,le=E(Tt,Ot,h0,Jt),le<1&&(Pe++,M(Ot,h0<Jt?P0:Tt,Jt,ae))),Jt=Ot.length):le===0&&(Pe++,Ot=[0]),p0[Ce++]=Pe,le&&Ot[0]?Ot[Jt++]=Yt[k0]||0:(Ot=[Yt[k0]],Jt=1);while((k0++<R0||Ot[0]!==void 0)&&d0--);at=Ot[0]!==void 0}p0[0]||p0.shift()}if(it==1)Pt.e=ye,W=at;else{for(Ce=1,Pe=p0[0];Pe>=10;Pe/=10)Ce++;Pt.e=Ce+ye*it-1,C(Pt,oe?O+Pt.e+1:O,ee,at)}return Pt}})();function C(m,E,M,_){var T,O,ee,oe,ae,le,ye,Ce,Pe,it=m.constructor;e:if(E!=null){if(Ce=m.d,!Ce)return m;for(T=1,oe=Ce[0];oe>=10;oe/=10)T++;if(O=E-T,O<0)O+=me,ee=E,ye=Ce[Pe=0],ae=ye/Z(10,T-ee-1)%10|0;else if(Pe=Math.ceil((O+1)/me),oe=Ce.length,Pe>=oe)if(_){for(;oe++<=Pe;)Ce.push(0);ye=ae=0,T=1,O%=me,ee=O-me+1}else break e;else{for(ye=oe=Ce[Pe],T=1;oe>=10;oe/=10)T++;O%=me,ee=O-me+T,ae=ee<0?0:ye/Z(10,T-ee-1)%10|0}if(_=_||E<0||Ce[Pe+1]!==void 0||(ee<0?ye:ye%Z(10,T-ee-1)),le=M<4?(ae||_)&&(M==0||M==(m.s<0?3:2)):ae>5||ae==5&&(M==4||_||M==6&&(O>0?ee>0?ye/Z(10,T-ee):0:Ce[Pe-1])%10&1||M==(m.s<0?8:7)),E<1||!Ce[0])return Ce.length=0,le?(E-=m.e+1,Ce[0]=Z(10,(me-E%me)%me),m.e=-E||0):Ce[0]=m.e=0,m;if(O==0?(Ce.length=Pe,oe=1,Pe--):(Ce.length=Pe+1,oe=Z(10,me-O),Ce[Pe]=ee>0?(ye/Z(10,T-ee)%Z(10,ee)|0)*oe:0),le)for(;;)if(Pe==0){for(O=1,ee=Ce[0];ee>=10;ee/=10)O++;for(ee=Ce[0]+=oe,oe=1;ee>=10;ee/=10)oe++;O!=oe&&(m.e++,Ce[0]==qe&&(Ce[0]=1));break}else{if(Ce[Pe]+=oe,Ce[Pe]!=qe)break;Ce[Pe--]=0,oe=1}for(O=Ce.length;Ce[--O]===0;)Ce.pop()}return j&&(m.e>it.maxE?(m.d=null,m.e=NaN):m.e<it.minE&&(m.e=0,m.d=[0])),m}function V(m,E,M){if(!m.isFinite())return tt(m);var _,T=m.e,O=g(m.d),ee=O.length;return E?(M&&(_=M-ee)>0?O=O.charAt(0)+"."+O.slice(1)+ge(_):ee>1&&(O=O.charAt(0)+"."+O.slice(1)),O=O+(m.e<0?"e":"e+")+m.e):T<0?(O="0."+ge(-T-1)+O,M&&(_=M-ee)>0&&(O+=ge(_))):T>=ee?(O+=ge(T+1-ee),M&&(_=M-T-1)>0&&(O=O+"."+ge(_))):((_=T+1)<ee&&(O=O.slice(0,_)+"."+O.slice(_)),M&&(_=M-ee)>0&&(T+1===ee&&(O+="."),O+=ge(_))),O}function J(m,E){var M=m[0];for(E*=me;M>=10;M/=10)E++;return E}function ie(m,E,M){if(E>c)throw j=!0,M&&(m.precision=M),Error(Ue);return C(new m(q),E,1,!0)}function fe(m,E,M){if(E>p)throw Error(Ue);return C(new m(X),E,M,!0)}function Oe(m){var E=m.length-1,M=E*me+1;if(E=m[E],E){for(;E%10==0;E/=10)M--;for(E=m[0];E>=10;E/=10)M++}return M}function ge(m){for(var E="";m--;)E+="0";return E}function Ve(m,E,M,_){var T,O=new m(1),ee=Math.ceil(_/me+4);for(j=!1;;){if(M%2&&(O=O.times(E),R(O.d,ee)&&(T=!0)),M=ce(M/2),M===0){M=O.d.length-1,T&&O.d[M]===0&&++O.d[M];break}E=E.times(E),R(E.d,ee)}return j=!0,O}function Qe(m){return m.d[m.d.length-1]&1}function Ae(m,E,M){for(var _,T,O=new m(E[0]),ee=0;++ee<E.length;){if(T=new m(E[ee]),!T.s){O=T;break}_=O.cmp(T),(_===M||_===0&&O.s===M)&&(O=T)}return O}function Ge(m,E){var M,_,T,O,ee,oe,ae,le=0,ye=0,Ce=0,Pe=m.constructor,it=Pe.rounding,at=Pe.precision;if(!m.d||!m.d[0]||m.e>17)return new Pe(m.d?m.d[0]?m.s<0?0:1/0:1:m.s?m.s<0?0:m:NaN);for(E==null?(j=!1,ae=at):ae=E,oe=new Pe(.03125);m.e>-2;)m=m.times(oe),Ce+=5;for(_=Math.log(Z(2,Ce))/Math.LN10*2+5|0,ae+=_,M=O=ee=new Pe(1),Pe.precision=ae;;){if(O=C(O.times(m),ae,1),M=M.times(++ye),oe=ee.plus(b(O,M,ae,1)),g(oe.d).slice(0,ae)===g(ee.d).slice(0,ae)){for(T=Ce;T--;)ee=C(ee.times(ee),ae,1);if(E==null)if(le<3&&S(ee.d,ae-_,it,le))Pe.precision=ae+=10,M=O=oe=new Pe(1),ye=0,le++;else return C(ee,Pe.precision=at,it,j=!0);else return Pe.precision=at,ee}ee=oe}}function je(m,E){var M,_,T,O,ee,oe,ae,le,ye,Ce,Pe,it=1,at=10,pt=m,i0=pt.d,Pt=pt.constructor,p0=Pt.rounding,Ot=Pt.precision;if(pt.s<0||!i0||!i0[0]||!pt.e&&i0[0]==1&&i0.length==1)return new Pt(i0&&!i0[0]?-1/0:pt.s!=1?NaN:i0?0:pt);if(E==null?(j=!1,ye=Ot):ye=E,Pt.precision=ye+=at,M=g(i0),_=M.charAt(0),Math.abs(O=pt.e)<15e14){for(;_<7&&_!=1||_==1&&M.charAt(1)>3;)pt=pt.times(m),M=g(pt.d),_=M.charAt(0),it++;O=pt.e,_>1?(pt=new Pt("0."+M),O++):pt=new Pt(_+"."+M.slice(1))}else return le=ie(Pt,ye+2,Ot).times(O+""),pt=je(new Pt(_+"."+M.slice(1)),ye-at).plus(le),Pt.precision=Ot,E==null?C(pt,Ot,p0,j=!0):pt;for(Ce=pt,ae=ee=pt=b(pt.minus(1),pt.plus(1),ye,1),Pe=C(pt.times(pt),ye,1),T=3;;){if(ee=C(ee.times(Pe),ye,1),le=ae.plus(b(ee,new Pt(T),ye,1)),g(le.d).slice(0,ye)===g(ae.d).slice(0,ye))if(ae=ae.times(2),O!==0&&(ae=ae.plus(ie(Pt,ye+2,Ot).times(O+""))),ae=b(ae,new Pt(it),ye,1),E==null)if(S(ae.d,ye-at,p0,oe))Pt.precision=ye+=at,le=ee=pt=b(Ce.minus(1),Ce.plus(1),ye,1),Pe=C(pt.times(pt),ye,1),T=oe=1;else return C(ae,Pt.precision=Ot,p0,j=!0);else return Pt.precision=Ot,ae;ae=le,T+=2}}function tt(m){return String(m.s*m.s/0)}function Xe(m,E){var M,_,T;for((M=E.indexOf("."))>-1&&(E=E.replace(".","")),(_=E.search(/e/i))>0?(M<0&&(M=_),M+=+E.slice(_+1),E=E.substring(0,_)):M<0&&(M=E.length),_=0;E.charCodeAt(_)===48;_++);for(T=E.length;E.charCodeAt(T-1)===48;--T);if(E=E.slice(_,T),E){if(T-=_,m.e=M=M-_-1,m.d=[],_=(M+1)%me,M<0&&(_+=me),_<T){for(_&&m.d.push(+E.slice(0,_)),T-=me;_<T;)m.d.push(+E.slice(_,_+=me));E=E.slice(_),_=me-E.length}else _-=T;for(;_--;)E+="0";m.d.push(+E),j&&(m.e>m.constructor.maxE?(m.d=null,m.e=NaN):m.e<m.constructor.minE&&(m.e=0,m.d=[0]))}else m.e=0,m.d=[0];return m}function Je(m,E){var M,_,T,O,ee,oe,ae,le,ye;if(E.indexOf("_")>-1){if(E=E.replace(/(\d)_(?=\d)/g,"$1"),ve.test(E))return Xe(m,E)}else if(E==="Infinity"||E==="NaN")return+E||(m.s=NaN),m.e=NaN,m.d=null,m;if(Be.test(E))M=16,E=E.toLowerCase();else if(Le.test(E))M=2;else if($e.test(E))M=8;else throw Error(_e+E);for(O=E.search(/p/i),O>0?(ae=+E.slice(O+1),E=E.substring(2,O)):E=E.slice(2),O=E.indexOf("."),ee=O>=0,_=m.constructor,ee&&(E=E.replace(".",""),oe=E.length,O=oe-O,T=Ve(_,new _(M),O,O*2)),le=A(E,M,qe),ye=le.length-1,O=ye;le[O]===0;--O)le.pop();return O<0?new _(m.s*0):(m.e=J(le,ye),m.d=le,j=!1,ee&&(m=b(m,T,oe*4)),ae&&(m=m.times(Math.abs(ae)<54?Z(2,ae):H.pow(2,ae))),j=!0,m)}function nt(m,E){var M,_=E.d.length;if(_<3)return E.isZero()?E:Te(m,2,E,E);M=1.4*Math.sqrt(_),M=M>16?16:M|0,E=E.times(1/F(5,M)),E=Te(m,2,E,E);for(var T,O=new m(5),ee=new m(16),oe=new m(20);M--;)T=E.times(E),E=E.times(O.plus(T.times(ee.times(T).minus(oe))));return E}function Te(m,E,M,_,T){var O,ee,oe,ae,le=1,ye=m.precision,Ce=Math.ceil(ye/me);for(j=!1,ae=M.times(M),oe=new m(_);;){if(ee=b(oe.times(ae),new m(E++*E++),ye,1),oe=T?_.plus(ee):_.minus(ee),_=b(ee.times(ae),new m(E++*E++),ye,1),ee=oe.plus(_),ee.d[Ce]!==void 0){for(O=Ce;ee.d[O]===oe.d[O]&&O--;);if(O==-1)break}O=oe,oe=_,_=ee,ee=O,le++}return j=!0,ee.d.length=Ce+1,ee}function F(m,E){for(var M=m;--E;)M*=m;return M}function G(m,E){var M,_=E.s<0,T=fe(m,m.precision,1),O=T.times(.5);if(E=E.abs(),E.lte(O))return re=_?4:1,E;if(M=E.divToInt(T),M.isZero())re=_?3:2;else{if(E=E.minus(M.times(T)),E.lte(O))return re=Qe(M)?_?2:3:_?4:1,E;re=Qe(M)?_?1:4:_?3:2}return E.minus(T).abs()}function h(m,E,M,_){var T,O,ee,oe,ae,le,ye,Ce,Pe,it=m.constructor,at=M!==void 0;if(at?(d(M,1,e),_===void 0?_=it.rounding:d(_,0,8)):(M=it.precision,_=it.rounding),!m.isFinite())ye=tt(m);else{for(ye=V(m),ee=ye.indexOf("."),at?(T=2,E==16?M=M*4-3:E==8&&(M=M*3-2)):T=E,ee>=0&&(ye=ye.replace(".",""),Pe=new it(1),Pe.e=ye.length-ee,Pe.d=A(V(Pe),10,T),Pe.e=Pe.d.length),Ce=A(ye,10,T),O=ae=Ce.length;Ce[--ae]==0;)Ce.pop();if(!Ce[0])ye=at?"0p+0":"0";else{if(ee<0?O--:(m=new it(m),m.d=Ce,m.e=O,m=b(m,Pe,M,_,0,T),Ce=m.d,O=m.e,le=W),ee=Ce[M],oe=T/2,le=le||Ce[M+1]!==void 0,le=_<4?(ee!==void 0||le)&&(_===0||_===(m.s<0?3:2)):ee>oe||ee===oe&&(_===4||le||_===6&&Ce[M-1]&1||_===(m.s<0?8:7)),Ce.length=M,le)for(;++Ce[--M]>T-1;)Ce[M]=0,M||(++O,Ce.unshift(1));for(ae=Ce.length;!Ce[ae-1];--ae);for(ee=0,ye="";ee<ae;ee++)ye+=v.charAt(Ce[ee]);if(at){if(ae>1)if(E==16||E==8){for(ee=E==16?4:3,--ae;ae%ee;ae++)ye+="0";for(Ce=A(ye,T,E),ae=Ce.length;!Ce[ae-1];--ae);for(ee=1,ye="1.";ee<ae;ee++)ye+=v.charAt(Ce[ee])}else ye=ye.charAt(0)+"."+ye.slice(1);ye=ye+(O<0?"p":"p+")+O}else if(O<0){for(;++O;)ye="0"+ye;ye="0."+ye}else if(++O>ae)for(O-=ae;O--;)ye+="0";else O<ae&&(ye=ye.slice(0,O)+"."+ye.slice(O))}ye=(E==16?"0x":E==2?"0b":E==8?"0o":"")+ye}return m.s<0?"-"+ye:ye}function R(m,E){if(m.length>E)return m.length=E,!0}function Y(m){return new this(m).abs()}function U(m){return new this(m).acos()}function a(m){return new this(m).acosh()}function y(m,E){return new this(m).plus(E)}function n(m){return new this(m).asin()}function s(m){return new this(m).asinh()}function w(m){return new this(m).atan()}function N(m){return new this(m).atanh()}function I(m,E){m=new this(m),E=new this(E);var M,_=this.precision,T=this.rounding,O=_+4;return!m.s||!E.s?M=new this(NaN):!m.d&&!E.d?(M=fe(this,O,1).times(E.s>0?.25:.75),M.s=m.s):!E.d||m.isZero()?(M=E.s<0?fe(this,_,T):new this(0),M.s=m.s):!m.d||E.isZero()?(M=fe(this,O,1).times(.5),M.s=m.s):E.s<0?(this.precision=O,this.rounding=1,M=this.atan(b(m,E,O,1)),E=fe(this,O,1),this.precision=_,this.rounding=T,M=m.s<0?M.minus(E):M.plus(E)):M=this.atan(b(m,E,O,1)),M}function P(m){return new this(m).cbrt()}function B(m){return C(m=new this(m),m.e+1,2)}function x(m,E,M){return new this(m).clamp(E,M)}function L(m){if(!m||typeof m!="object")throw Error(de+"Object expected");var E,M,_,T=m.defaults===!0,O=["precision",1,e,"rounding",0,8,"toExpNeg",-t,0,"toExpPos",0,t,"maxE",0,t,"minE",-t,0,"modulo",0,9];for(E=0;E<O.length;E+=3)if(M=O[E],T&&(this[M]=K[M]),(_=m[M])!==void 0)if(ce(_)===_&&_>=O[E+1]&&_<=O[E+2])this[M]=_;else throw Error(_e+M+": "+_);if(M="crypto",T&&(this[M]=K[M]),(_=m[M])!==void 0)if(_===!0||_===!1||_===0||_===1)if(_)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[M]=!0;else throw Error(te);else this[M]=!1;else throw Error(_e+M+": "+_);return this}function z(m){return new this(m).cos()}function he(m){return new this(m).cosh()}function Se(m){var E,M,_;function T(O){var ee,oe,ae,le=this;if(!(le instanceof T))return new T(O);if(le.constructor=T,xe(O)){le.s=O.s,j?!O.d||O.e>T.maxE?(le.e=NaN,le.d=null):O.e<T.minE?(le.e=0,le.d=[0]):(le.e=O.e,le.d=O.d.slice()):(le.e=O.e,le.d=O.d?O.d.slice():O.d);return}if(ae=typeof O,ae==="number"){if(O===0){le.s=1/O<0?-1:1,le.e=0,le.d=[0];return}if(O<0?(O=-O,le.s=-1):le.s=1,O===~~O&&O<1e7){for(ee=0,oe=O;oe>=10;oe/=10)ee++;j?ee>T.maxE?(le.e=NaN,le.d=null):ee<T.minE?(le.e=0,le.d=[0]):(le.e=ee,le.d=[O]):(le.e=ee,le.d=[O]);return}if(O*0!==0){O||(le.s=NaN),le.e=NaN,le.d=null;return}return Xe(le,O.toString())}if(ae==="string")return(oe=O.charCodeAt(0))===45?(O=O.slice(1),le.s=-1):(oe===43&&(O=O.slice(1)),le.s=1),ve.test(O)?Xe(le,O):Je(le,O);if(ae==="bigint")return O<0?(O=-O,le.s=-1):le.s=1,Xe(le,O.toString());throw Error(_e+O)}if(T.prototype=r,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=L,T.clone=Se,T.isDecimal=xe,T.abs=Y,T.acos=U,T.acosh=a,T.add=y,T.asin=n,T.asinh=s,T.atan=w,T.atanh=N,T.atan2=I,T.cbrt=P,T.ceil=B,T.clamp=x,T.cos=z,T.cosh=he,T.div=Re,T.exp=Fe,T.floor=De,T.hypot=Ze,T.ln=be,T.log=lt,T.log10=mt,T.log2=ut,T.max=At,T.min=Ft,T.mod=dt,T.mul=_t,T.pow=$t,T.random=Lt,T.round=Gt,T.sign=c0,T.sin=kt,T.sinh=a0,T.sqrt=m0,T.sub=u0,T.sum=y0,T.tan=ft,T.tanh=s1,T.trunc=o1,m===void 0&&(m={}),m&&m.defaults!==!0)for(_=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],E=0;E<_.length;)m.hasOwnProperty(M=_[E++])||(m[M]=this[M]);return T.config(m),T}function Re(m,E){return new this(m).div(E)}function Fe(m){return new this(m).exp()}function De(m){return C(m=new this(m),m.e+1,3)}function Ze(){var m,E,M=new this(0);for(j=!1,m=0;m<arguments.length;)if(E=new this(arguments[m++]),E.d)M.d&&(M=M.plus(E.times(E)));else{if(E.s)return j=!0,new this(1/0);M=E}return j=!0,M.sqrt()}function xe(m){return m instanceof H||m&&m.toStringTag===ue||!1}function be(m){return new this(m).ln()}function lt(m,E){return new this(m).log(E)}function ut(m){return new this(m).log(2)}function mt(m){return new this(m).log(10)}function At(){return Ae(this,arguments,-1)}function Ft(){return Ae(this,arguments,1)}function dt(m,E){return new this(m).mod(E)}function _t(m,E){return new this(m).mul(E)}function $t(m,E){return new this(m).pow(E)}function Lt(m){var E,M,_,T,O=0,ee=new this(1),oe=[];if(m===void 0?m=this.precision:d(m,1,e),_=Math.ceil(m/me),this.crypto)if(crypto.getRandomValues)for(E=crypto.getRandomValues(new Uint32Array(_));O<_;)T=E[O],T>=429e7?E[O]=crypto.getRandomValues(new Uint32Array(1))[0]:oe[O++]=T%1e7;else if(crypto.randomBytes){for(E=crypto.randomBytes(_*=4);O<_;)T=E[O]+(E[O+1]<<8)+(E[O+2]<<16)+((E[O+3]&127)<<24),T>=214e7?crypto.randomBytes(4).copy(E,O):(oe.push(T%1e7),O+=4);O=_/4}else throw Error(te);else for(;O<_;)oe[O++]=Math.random()*1e7|0;for(_=oe[--O],m%=me,_&&m&&(T=Z(10,me-m),oe[O]=(_/T|0)*T);oe[O]===0;O--)oe.pop();if(O<0)M=0,oe=[0];else{for(M=-1;oe[0]===0;M-=me)oe.shift();for(_=1,T=oe[0];T>=10;T/=10)_++;_<me&&(M-=me-_)}return ee.e=M,ee.d=oe,ee}function Gt(m){return C(m=new this(m),m.e+1,this.rounding)}function c0(m){return m=new this(m),m.d?m.d[0]?m.s:0*m.s:m.s||NaN}function kt(m){return new this(m).sin()}function a0(m){return new this(m).sinh()}function m0(m){return new this(m).sqrt()}function u0(m,E){return new this(m).sub(E)}function y0(){var m=0,E=arguments,M=new this(E[m]);for(j=!1;M.s&&++m<E.length;)M=M.plus(E[m]);return j=!0,C(M,this.precision,this.rounding)}function ft(m){return new this(m).tan()}function s1(m){return new this(m).tanh()}function o1(m){return C(m=new this(m),m.e+1,1)}H=Se(K),H.prototype.constructor=H,H.default=H.Decimal=H,q=new H(q),X=new H(X),typeof define=="function"&&define.amd?define(function(){return H}):typeof a1<"u"&&a1.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(r[Symbol.for("nodejs.util.inspect.custom")]=r.toString,r[Symbol.toStringTag]="Decimal"),a1.exports=H):(i||(i=typeof self<"u"&&self&&self.self==self?self:window),u=i.Decimal,H.noConflict=function(){return i.Decimal=u,H},i.Decimal=H)})(F1)});var X1=E0((Hi,E1)=>{"use strict";var V1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],G1={};for(let i of V1)G1[i]=!0;var Pn="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",Dn="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",bn=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof E1<"u"&&(E1.exports={PRIMES:V1,PRIMES_SET:G1,LONG_PI:Pn,LONG_E:Dn,BIG_LOG_CACHE:bn})});var G0=E0((ji,$1)=>{"use strict";var K1=typeof globalThis.nerdamerBigInt>"u"?b1():globalThis.nerdamerBigInt,en=typeof globalThis.nerdamerBigDecimal>"u"?B1():globalThis.nerdamerBigDecimal,Fn=typeof globalThis.nerdamerConstants>"u"?X1():globalThis.nerdamerConstants,tn={convert(i,t){let e=Number(i),v;if(e===0)v=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let q=this.quickConversion(e);if(q[1]<=1e16){let X=Math.abs(e),K=e/X;v=this.fullConversion(X.toFixed(`${q[1]}`.length-1)),v[0]*=K}else v=q}else v=this.fullConversion(e);return v},quickConversion(i){let t=function(v){typeof v!="string"&&(v=v.toString());let q="",X=v.charAt(0);return X==="-"?(v=v.substr(1,v.length),q="-"):X==="+"&&(v=v.substr(1,v.length)),{sign:q,value:v}};function e(v){jt.isScientific(v)&&(v=W0(v));let q=t(v),X=q.value.split("."),K;X.length===1?K=X[0]:K=X[0]+X[1];let H=X[1]?X[1].length:0,W=`1${"0".repeat(H)}`;return K!=="0"&&(K=K.replace(/^0+/u,"")),[q.sign+K,W]}return e(i)},fullConversion(i){let t=Number(i),e=Math.abs(t)>1e10?1e-16:1e-30,v=!1,q=0,X=1,K=1,H=0,W=0,u=t,re,j,de=1e-14;for(;!v;){W++;let _e;if(Math.abs(u)>1e10){let te=Math.round(u);_e=Math.abs(u-te)/Math.abs(te)<de?te:Math.floor(u)}else _e=Math.floor(u);re=q+_e*K,j=X+_e*H;let Ue=u-_e;Ue<e&&(v=!0),u=1/Ue,q=K,X=H,K=re,H=j,(Math.abs(re/j-t)<e||W>30)&&(v=!0)}return[re,j]}},Rt={bigInt:K1,bigDec:en,isInt:()=>!1,scientificToDecimal:()=>"",DivisionByZero:Error,Settings:{PRECISION:21,USE_BIG:!1},Fraction:tn},He=class i{constructor(t){if(this.num,this.den,t instanceof i)return t;if(t===void 0)return this;try{if(Rt.isInt(t))try{this.num=Rt.bigInt(t),this.den=Rt.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return i.simple(t)}else{let e=t instanceof Rt.bigDec?Rt.Fraction.quickConversion(t):Rt.Fraction.convert(t);this.num=new Rt.bigInt(e[0]),this.den=new Rt.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return i.simple(t)}}static create(t){if(t instanceof i)return t;t=t.toString();let e=t.charAt(0)==="-";e&&(t=t.substr(1,t.length-1));let v=new i(t);return e&&v.negate(),v}static isFrac(t){return t instanceof i}static quick(t,e){let v=new i;return v.num=new Rt.bigInt(t),v.den=new Rt.bigInt(e),v}static simple(t){let v=String(Rt.scientificToDecimal(t)).split("."),q=v.join(""),X="1",K=(v[1]||"").length;for(let W=0;W<K;W++)X+="0";return i.quick(q,X).simplify()}multiply(t){if(this.isOne())return t.clone();if(t.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(t.num),e.den=e.den.multiply(t.den),e.simplify()}divide(t){if(t.equals(0))throw new Rt.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(t.clone().invert()).simplify()}subtract(t){return this.clone().add(t.clone().neg())}sub(t){return this.subtract(t)}neg(){return this.num=this.num.multiply(-1),this}add(t){let e=this.den,v=t.den,q=this.clone(),X=q.num,K=t.num;return e.equals(v)?q.num=X.add(K):(q.num=X.multiply(v).add(K.multiply(e)),q.den=e.multiply(v)),q.simplify()}mod(t){let e=this.clone(),v=t.clone();return e.num=e.num.multiply(v.den),e.den=e.den.multiply(v.den),v.num=v.num.multiply(this.den),v.den=v.den.multiply(this.den),e.num=e.num.mod(v.num),e.simplify()}simplify(){let t=Rt.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(t),this.den=this.den.divide(t),this}clone(){let t=new i;return t.num=new Rt.bigInt(this.num),t.den=new Rt.bigInt(this.den),t}decimal(t){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";t||=Rt.Settings.PRECISION,t+=2;let v=[],q=this.num.abs(),X=this.den,K;for(K=0;K<t;K++){let u=q.divide(X),re=q.subtract(u.multiply(X));if(v.push(u),re.equals(0))break;q=re.times(10)}let H=v.shift();if(v.length===0)return e+H.toString();if(K===t){let u=[];for(let re=0;re<2;re++)u.unshift(v.pop());v.push(Math.round(Number(u.join("."))))}let W=`${H.toString()}.${v.join("")}`;return e+W}toDecimal(t){return t||=Rt.Settings.PRECISION,t?this.decimal(t):this.num.valueOf()/this.den.valueOf()}qcompare(t){return[this.num.multiply(t.den),t.num.multiply(this.den)]}equals(t){isNaN(t)||(t=new i(t));let e=this.qcompare(t);return e[0].equals(e[1])}absEquals(t){isNaN(t)||(t=new i(t));let e=this.qcompare(t);return e[0].abs().equals(e[1])}greaterThan(t){isNaN(t)||(t=new i(t));let e=this.qcompare(t);return e[0].gt(e[1])}gt(t){return this.greaterThan(t)}gte(t){return this.greaterThan(t)||this.equals(t)}lte(t){return this.lessThan(t)||this.equals(t)}lessThan(t){isNaN(t)||(t=new i(t));let e=this.qcompare(t);return e[0].lt(e[1])}lt(t){return this.lessThan(t)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let t=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=t,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(t){return i.quick(Rt.bigInt.gcd(t.num,this.num),Rt.bigInt.lcm(t.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Rt.Settings.USE_BIG?new Rt.bigDec(this.num.toString()).div(new Rt.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(t){let e=typeof t=="number"?new i(t):t;return this.mod(e).equals(0)}},B0={isVector:()=>!1,Vector:{fromArray:()=>({})},remove:()=>{}};function v0(i,...t){if(this.elements=[],typeof i>"u")return;let e=i;if(B0.isVector(e)||(e=B0.Vector.fromArray([e,...t])),e){let{elements:v}=e;for(let q=0,X=v.length;q<X;q++)this.add(v[q])}}v0.fromArray=function(t){function e(v){return v0.apply(this,v)}return e.prototype=v0.prototype,new e(t)};v0.prototype={elements:[],add(i){this.contains(i)||this.elements.push(i.clone())},contains(i){for(let t=0;t<this.elements.length;t++){let e=this.elements[t];if(i.equals(e))return!0}return!1},each(i){let{elements:t}=this,e=new v0;for(let v=0,q=t.length;v<q;v++){let X=t[v];i.call(this,X,e,v)}return e},clone(){let i=new v0;return this.each(t=>{i.add(t.clone())}),i},union(i){let t=this.clone();return i.each(e=>{t.add(e)}),t},difference(i){let t=this.clone();return i.each(e=>{t.remove(e)}),t},remove(i){for(let t=0,e=this.elements.length;t<e;t++)if(this.elements[t].equals(i))return B0.remove(this.elements,t),!0;return!1},intersection(i){let t=new v0,e=this;return i.each(v=>{e.contains(v)&&t.add(v)}),t},intersects(i){return this.intersection(i).elements.length>0},isSubset(i){let{elements:t}=i;for(let e=0,v=t.length;e<v;e++)if(!this.contains(t[e]))return!1;return!0},toString(){return`{${this.elements.join(",")}}`}};var _0={_:null,block:()=>{}};function bt(){this.elements=[]}bt.prototype.append=function(t){this.elements.push(t)};bt.prototype.getItems=function(){return this.elements};bt.prototype.toString=function(){return _0._.prettyPrint(this.elements)};bt.prototype.dimensions=function(){return this.elements.length};bt.prototype.text=function(i){return`(${this.elements.map(t=>t.text(i)).join(",")})`};bt.create=function(t){let e=new bt;return t&&e.append(t),e};bt.prototype.clone=function(t){let e=bt.create();return e.elements=this.elements.map(v=>v.clone()),e};bt.prototype.expand=function(t){return this.elements=this.elements.map(e=>_0._.expand(e,t)),this};bt.prototype.evaluate=function(i){return this.elements=this.elements.map(t=>_0._.evaluate(t,i)),this};bt.prototype.map=function(t){let e=this.clone();return e.elements=e.elements.map((v,q)=>t(v,q+1)),e};bt.prototype.add=function(t){return _0.block("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((v,q)=>_0._.add(v,e[q-1]))},void 0,this)};bt.prototype.subtract=function(t){return _0.block("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((v,q)=>_0._.subtract(v,e[q-1]))},void 0,this)};var nn={Settings:{SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0},nround:(i,t)=>Math.round(i*10**t)/10**t};function jt(i){return this instanceof jt?(i=String(typeof i>"u"?0:i),i.startsWith("-")?(this.sign=-1,i=i.substr(1,i.length)):this.sign=1,jt.isScientific(i)?this.fromScientific(i):this.convert(i),this):new jt(i)}jt.prototype={fromScientific(i){let t=String(i).toLowerCase().split("e");this.coeff=t[0],this.exponent=Number(t[1]);let e=this.coeff.split(".");this.wholes=e[0]||"",this.dec=e[1]||"";let{dec:v}=this;return this.decp=v==="0"?0:v.length,this},convert(i){let t=i.split("."),e=t[0]||"",v=t[1]||"";e=jt.removeLeadingZeroes(e),v=jt.removeTrailingZeroes(v);let q=e.length,X=e+v,K=jt.leadingZeroes(X).length;this.exponent=q-(K+1);let H=jt.removeLeadingZeroes(X);this.coeff=`${H.charAt(0)}.${jt.removeTrailingZeroes(H.substr(1,H.length))||"0"}`;let W=this.coeff.split(".")[1]||"";return this.decp=W==="0"?0:W.length,this.dec=v,this.wholes=e,this},round(i){let t=this.copy();if(i=Number(i),i===0)t.coeff=t.coeff.charAt(0);else{let e=this.coeff.substring(0,i+1),v=this.coeff.substring(i+1,i+3),q=Number(v.charAt(0));Number(v.charAt(1))>4&&q++,t.coeff=e+q}return t},copy(){let i=new jt(0);return i.coeff=this.coeff,i.exponent=this.exponent,i.sign=this.sign,i},toString(i){let t;if(nn.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<i)this.decp===0&&this.wholes!==void 0?t=this.wholes:t=this.coeff;else{let e=typeof i>"u"?this.coeff:jt.round(this.coeff,Math.min(i,this.decp||1)),v=this.exponent;e.startsWith("10.")&&(e=typeof i>"u"?e.replace(/^10\./u,"1.0"):jt.round(e.replace(/^10\./u,"1.0"),Math.min(i,this.decp||1)),v=Number(v)+1),t=this.exponent===0?e:`${e}e${v}`}return(this.sign===-1?"-":"")+t}};jt.isScientific=function(t){return/\d+\.?\d*e[+-]*\d+/iu.test(t)};jt.leadingZeroes=function(t){let e=t.match(/^(?<zeros>0*).*$/u);return e?e[1]:""};jt.removeLeadingZeroes=function(t){let e=t.match(/^0*(?<rest>.*)$/u);return e?e[1]:""};jt.removeTrailingZeroes=function(t){let e=t.match(/0*$/u);return e?t.substring(0,t.length-e[0].length):""};jt.round=function(t,e){let v=String(nn.nround(t,e)),q=v.includes(".")?v.split(".").pop():"",X=e-q.length;return X>0&&(v.includes(".")||(v+="."),v+=new Array(X+1).join("0")),v};function s0(i){let t=function(e){this.name=i,this.message=e===void 0?"":e;let v=new Error(this.message);v.name=this.name,this.stack=v.stack};return t.prototype=Object.create(Error.prototype),t}function Ht(i){return Array.isArray(i)}function Xt(i){return`(${i})`}function Bn(i,t){return i<0==t<0}function Dt(...i){return i.shift().replace(/\{(?<idx>\d+)\}/gu,(v,q)=>{let X=i[q];return typeof X=="function"?X():X})}function Vn(i,t,e){let v=[];e||=1;for(let q=i;q<=t;q++)v.push(q*e);return v}function Gn(i){return i&&String(i)}function Xn(i,t,e,v){return i.substr(0,t)+v+i.substr(e,i.length)}function Hn(i){return i!==void 0&&i.custom}function jn(i){return Math.max.apply(void 0,i)}function C1(i){return Math.min.apply(void 0,i)}function Bt(i){return Number(i)%2===0}function M1(i){return 1/(i%1)%2===0}function T1(i){let t=i.length,e=[];for(let v=0;v<t;v++){let q=i[v];e.indexOf(q)===-1&&e.push(q)}return e}function Zn(i){return[].slice.call(i)}function yt(i){return typeof i=="number"?Number.isInteger(i):typeof i<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(i.toString())}function zn(i,t){if(i.sort(),t.sort(),i.length===t.length){for(let e=0;e<i.length;e++)if(i[e]!==t[e])return!1;return!0}return!1}function Wn(i){let t=[],e=i.length;for(let v=0;v<e;v++)t[v]=i[v].clone();return t}function rn(i){return/^\d+\.?\d*$/u.test(i)}function q0(i,t=14){return yt(i)?Number(i)>=Number.MAX_VALUE?i.toString():Number(i):Math.round(i*10**t)/10**t}function Qn(i,t){t||=20;let e=[],v,q,X;e.push(i[0]);for(let K=0;K<i.length-1;K++){v=i[K],q=i[K+1]-v,X=q/t;for(let H=0;H<t;H++)v+=X,e.push(v)}return e}function sn(i,t){if(Ht(i)){let e=i.length;for(let v=0;v<e;v++)t.call(i,v)}else for(let e in i)Object.hasOwn(i,e)&&t.call(i,e)}function L0(i,t){let e;return Ht(i)?e=i.splice(t,1)[0]:(e=i[t],delete i[t]),e}function Jn(i,t){let e={};return e[i]=t,e}function Yn(i){for(let t=0;t<i.length;t++)if(!rn(i[t]))return!1;return!0}function W0(i){let t=Math.sign(i),e=Math.abs(i);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let q=String(e).toLowerCase().split("e"),X=q.pop(),K=Math.abs(Number(X)),H=Math.sign(Number(X)),W=q[0].split(".");if(H===-1)K-=W[0].length,K<0?e=`${W[0].slice(0,K)}.${W[0].slice(K)}${W.length===2?W[1]:""}`:e=`0.${new Array(K+1).join("0")}${W.join("")}`;else{let u=W[1];u&&(K-=u.length),K<0?e=`${W[0]+u.slice(0,K)}.${u.slice(K)}`:e=W.join("")+new Array(K+1).join("0")}}return t<0?`-${e}`:String(e)}function u1(i){let t=i[0];for(let e=1,v=i.length;e<v;e++)if(!i[e].equals(t))return!1;return!0}function Kn(i,t){typeof t!=="function"&&(t=function(q,X){return q===X});let v=[];for(;i.length;){let q=i[0];if(i.length===1){v.push(q);break}let X=[];v.push(q);for(let K=1;K<i.length;K++){let H=i[K];t(q,H)||X.push(H)}i=X}return v}function ei(i,t){let e=i.length,v=[];for(let K=0;K<i.length;K++)v.push([i[K],t[K]]);v.sort((K,H)=>Number(K[0])-Number(H[0]));let q=[],X=[];for(let K=0;K<e;K++)q.push(v[K][0]),X.push(v[K][1]);return[q,X]}var A1=s0("DivisionByZero"),H1=s0("ParseError"),r0=s0("UndefinedError"),_1=s0("OutOfFunctionDomainError"),ti=s0("MaximumIterationsReached"),R1=s0("NerdamerTypeError"),c1=s0("ParityError"),b0=s0("OperatorError"),ni=s0("OutOfRangeError"),I1=s0("DimensionError"),on=s0("InvalidVariableNameError"),ii=s0("ValueLimitExceededError"),j1=s0("NerdamerValueError"),ri=s0("SolveError"),si=s0("InfiniteLoopError"),Z1=s0("UnexpectedTokenError");function q1(i){return i instanceof bt}function z1(i){return i instanceof v0}function f1(i,t,e){let q=Object.keys(i)[0];return t?q:e?{key:q,obj:i[q]}:i[q]}var{keys:k1}=Object,m1={N:1,P:2};function F0(i){return i.group===m1.N||i.group===m1.P}var ln={S:3};function W1(i){return i.group===ln.S&&i.multiplier.equals(1)&&i.power.equals(1)}var an={N:1};function O1(i){for(let t=0;t<i.length;t++)if(i[t].group!==an.N)return!1;return!0}var L1={RESERVED:[]};function p1(i){let t=function(e){L1.RESERVED.indexOf(e)===-1&&L1.RESERVED.push(e)};typeof i=="string"?t(i):sn(i,e=>{t(e)})}var V0={RESERVED:[]};function oi(i){let t=V0.RESERVED.indexOf(i);t!==-1&&(V0.RESERVED[t]=void 0)}var d1={ALLOW_CHARS:[],VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function O0(i,t="variable"){if(d1.ALLOW_CHARS.indexOf(i)!==-1)return;if(!d1.VALIDATION_REGEX.test(i))throw new on(`${i} is not a valid ${t} name`)}var un={RESERVED:[]};function h1(i){return un.RESERVED.indexOf(i)!==-1}var Y0={WARNINGS:[],SHOW_WARNINGS:!1};function U1(i){Y0.WARNINGS.push(i),Y0.SHOW_WARNINGS&&console&&console.warn&&console.warn(i)}function li(){return Y0.WARNINGS}var cn={EXPRESSIONS:[]};function ai(){return cn.EXPRESSIONS.length}var fn={Settings:{}};function ui(i){return fn.Settings[i]}function ci(i){try{return O0(i),V0.RESERVED.indexOf(i)===-1}catch(t){if(t.message==="timeout")throw t;return!1}}function fi(i){return i?V0.RESERVED:V0.RESERVED.join(", ")}var K0={_version:"",C:{}};function pi(i){if(i)try{return K0.C[i].version}catch(t){if(t.message==="timeout")throw t;return`No module named ${i} found!`}return K0._version}function hi(){return K0.C}var pn={functions:null};function gi(){return k1(pn.functions)}var hn={CONSTANTS:null};function mi(i){return String(hn.CONSTANTS[i])}var U0={VARS:null};function di(i){return U0.VARS[i]}function wi(i,t){i||="text";let e={};if(i==="object")e=U0.VARS;else for(let v in U0.VARS)Object.hasOwn(U0.VARS,v)&&(i==="latex"?e[v]=U0.VARS[v].latex(t):i==="text"&&(e[v]=U0.VARS[v].text(t)));return e}var n0={_:null,C:null};function Si(i,t){return n0._.toTeX(i,t)}function vi(i){return n0._.getOperator(i)}function yi(i,t){n0._.aliasOperator(i,t)}function Ni(i,t){n0._.setOperator(i,t)}function Ei(i,t){n0._.peekers[i]&&n0._.peekers[i].push(t)}function Mi(i,t){let e=n0._.peekers[i];if(e){let v=e.indexOf(t);v!==-1&&L0(e,v)}}function gn(i){return n0._.tree(n0._.toRPN(n0._.tokenize(i)))}function Ai(i){return String(i).split(";").map(t=>n0._.parse(t))}function _i(i){return n0._.tokenize(n0._.toRPN(i))}function Ii(i,t){return`<div class="tree">
    <ul>
        <li>
${gn(i).toHTML(3,t)}
        </li>
    </ul>
</div>`}function qi(i,t,e){let v=n0._.functions[i],q=typeof e>"u"?v[1]:e;n0._.functions[i]=[t(v[0],n0.C),q]}var Vt={EXPRESSIONS:[],USER_FUNCTIONS:[],LaTeX:{latex:()=>"",parse:()=>""},text:()=>"",functions:{},Math2:{},_:null,Expression:null};function Oi(i,t,e){let v=i?{}:[];for(let q=0;q<Vt.EXPRESSIONS.length;q++){let X=t?Vt.LaTeX.latex(Vt.EXPRESSIONS[q],e):Vt.text(Vt.EXPRESSIONS[q],e);i?v[q+1]=X:v.push(X)}return v}function Ci(i,t){let e=i?{}:[];for(let v=0;v<Vt.USER_FUNCTIONS.length;v++){let q,X,K=Vt.USER_FUNCTIONS[v],H=Vt.functions[K][2];if(H)({params:q,body:X}=H);else{let re=Vt.Math2[K].toString();[,q]=/\((?<params>.*?)\)/u.exec(re),q=q.split(",").map(j=>j.trim()),X="{JavaScript}"}let W=`${K}(${q.join(", ")})=${X}`,u=Vt.text(W,t);i?e[v+1]=u:e.push(u)}return e}function Ti(i){i=i.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),i=i.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),i=i.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),i=i.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let t=Vt.LaTeX.parse(Vt._.tokenize(i));return new Vt.Expression(Vt._.parse(t))}var l0={libExports:null,VARS:{},_clearFunctions:()=>{},_initConstants:()=>{},clear:null};function Ri(){for(let i in l0.VARS)Object.hasOwn(l0.VARS,i)&&delete l0.VARS[i];return l0.libExports}function Li(){return l0._clearFunctions(),l0.libExports}function Ui(){return l0.libExports}function xi(){return l0.clear("all"),l0.libExports}function $i(i){return i.call(l0.libExports),l0.libExports}var Q0={libExports:null,CONSTANTS:{}};function ki(i,t){if(O0(i),!h1(i))if(t==="delete"||t==="")delete Q0.CONSTANTS[i];else{if(isNaN(t))throw new R1("Constant must be a number!");Q0.CONSTANTS[i]=t}return Q0.libExports}var w0={libExports:null,VARS:{},CONSTANTS:{},parse:()=>null,isSymbol:()=>!1};function Pi(i,t){return O0(i),i in w0.CONSTANTS&&Wt(`Cannot set value for constant ${i}`),t==="delete"||t===""?delete w0.VARS[i]:w0.VARS[i]=w0.isSymbol(t)?t:w0.parse(t),w0.libExports}var w1={libExports:null,_setFunction:()=>!1};function Di(i,t,e){if(!w1._setFunction(i,t,e))throw new Error("Failed to set function!");return w1.libExports}var M0={libExports:null,EXPRESSIONS:[]};function Q1(i,t=!1){if(i==="all")M0.EXPRESSIONS.length=0;else if(i==="last")M0.EXPRESSIONS.pop();else if(i==="first")M0.EXPRESSIONS.shift();else{let e=i?i-1:M0.EXPRESSIONS.length;t===!0?M0.EXPRESSIONS[e]=void 0:L0(M0.EXPRESSIONS,e)}return M0.libExports}var x0={libExports:null,Settings:null,functions:null};function mn(i){let t=x0.libExports.getCore();if(Ht(i))for(let e=0;e<i.length;e++)i&&mn(i[e]);else if(i&&x0.Settings.exclude.indexOf(i.name)===-1){if(i.dependencies){for(let q=0;q<i.dependencies.length;q++)if(!t[i.dependencies[q]])throw new Error(Dt("{0} requires {1} to be loaded!",i.name,i.dependencies[q]))}let e=i.parent,v=i.build.call(t);if(e){t[e]||(t[i.parent]={});let q=e==="nerdamer"?x0.libExports:t[e];q[i.name]=v}i.visible&&(x0.functions[i.name]=[v,i.numargs])}}var Qt={bigDec:null,Settings:null,functions:null,symfunction:null,NerdamerSymbol:null};function x1(i,t){if(typeof i=="object"&&i!==null){let v=i;for(let q in v)Object.hasOwn(v,q)&&x1(q,v[q])}["SAFE"].indexOf(i)!==-1&&Wt(`Cannot modify setting: ${i}`),i==="PRECISION"?(Qt.bigDec.set({precision:t}),Qt.Settings.PRECISION=t,t>21&&x1("USE_BIG",!0)):i==="USE_LN"&&t===!0?(Qt.Settings.LOG="LN",Qt.Settings.LOG10="log",Qt.functions.log=Qt.Settings.LOG_FNS.log10,Qt.functions.log[0]=function(q){return q.isConstant()?new Qt.NerdamerSymbol(Math.log10(q)):Qt.symfunction(Qt.Settings.LOG10,[q])},Qt.functions.LN=Qt.Settings.LOG_FNS.log,delete Qt.functions.log10):Qt.Settings[i]=t}var S0={libExports:null,functions:null,parse:null,callfunction:null,Expression:null};function bi(i=!1){let t=function(v){return function(...X){for(let K=0;K<X.length;K++)X[K]=S0.parse(X[K]);return new S0.Expression(g0("PARSE2NUMBER",()=>S0.callfunction(v,X)))}};for(let e in S0.functions)(!(e in S0.libExports)||i)&&(S0.libExports[e]=t(e))}var dn={suppress_errors:!1};function Wt(i,t=void 0){if(!dn.suppress_errors)throw t?new t(i):new Error(i)}var wn={PRIMES_SET:{}};function J0(i){if(i in wn.PRIMES_SET)return!0;let t=Math.floor(Math.sqrt(i));for(let e=2;e<=t;e++)if(i%e===0)return!1;return!0}var C0={starttime:0,timeout:0,TIMEOUT:800};function J1(){C0.starttime=Date.now(),C0.timeout=C0.TIMEOUT}function Y1(){C0.starttime=0}function S1(){if(C0.starttime!==0&&Date.now()>C0.starttime+C0.timeout)throw new Error("timeout")}var A0={PRIMES:[],PRIMES_SET:{}};function Fi(i){if(S1(),J0(i))return[i];let t=i,e=1,v=[],q=2220446049250313e-31;for(;e<t;){S1();let X=i/e,K=Math.floor(X);if(X-K<=q&&e>1){if(J0(e)&&(A0.PRIMES_SET[e]||(A0.PRIMES.push(e),A0.PRIMES_SET[e]=!0),v.push(e)),J0(K)){v.push(K);break}t=K}e++}return v.sort((X,K)=>X-K)}function Sn(i){let t=A0.PRIMES[A0.PRIMES.length-1]||2;for(let e=t;e<i;e++)J0(e)&&A0.PRIMES.push(e),A0.PRIMES_SET[e]=!0}var g1={Settings:{}};function g0(i,t,e=void 0,v=void 0){let q=g1.Settings[i];g1.Settings[i]=e===void 0?!0:!!e;let X=t.call(v);return g1.Settings[i]=q,X}var vn={_:{parse:()=>{}}};function It(i,t=void 0){return g0("PARSE2NUMBER",()=>vn._.parse(i,t),!0)}var ct={EXPRESSIONS:[],Settings:{EXPRESSION_DECP:5},LaTeX:{latex:()=>""},text:()=>"",variables:()=>[],isVector:()=>!1,isSymbol:()=>!1,isExpression:()=>!1,isNumericSymbol:()=>!1,isFraction:()=>!1,isArray:Ht,_:{parse:()=>{},add:()=>{},subtract:()=>{},multiply:()=>{},divide:()=>{},pow:()=>{},expand:()=>{}},Build:null};function Zt(i){this.symbol=i}Zt.getExpression=function(t,e=void 0){(t==="last"||!t)&&(t=ct.EXPRESSIONS.length),t==="first"&&(t=1);let v=Number(t)-1,q=ct.EXPRESSIONS[v];return q&&new Zt(q)};Zt.prototype={text(i="decimals",t=void 0){t||=ct.Settings.EXPRESSION_DECP;let e=this.symbol;return e.text_?e.text_(i):ct.text(this.symbol,i,void 0,t)},latex(i){return this.symbol.latex?this.symbol.latex(i):ct.LaTeX.latex(this.symbol,i)},valueOf(){return this.symbol.valueOf()},evaluate(...i){if(ct.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let t=i[0],e,v=1;typeof t=="string"?e=t.charAt(0)==="%"?Zt.getExpression(t.substr(1)).text():t:t instanceof Zt||ct.isSymbol(t)?e=t.text():(e=this.symbol.text(),v--);let q=i[v]||{};return new Zt(g0("PARSE2NUMBER",()=>ct._.parse(e,q),!0))},buildFunction(i){return ct.Build.build(this.symbol,i)},isNumber(){return ct.isNumericSymbol(this.symbol)},isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0},isImaginary(){return It(ct._.parse(this.symbol)).isImaginary()},variables(){return ct.variables(this.symbol)},toString(){try{return ct.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(i){if(i.message==="timeout")throw i;return""}},toDecimal(i){ct.Settings.precision=i;let t=ct.text(this.symbol,"decimals");return ct.Settings.precision=void 0,t},isFraction(){return ct.isFraction(this.symbol)},isPolynomial(){return this.symbol.isPoly()},sub(i,t){return new Zt(this.symbol.sub(ct._.parse(i),ct._.parse(t)))},operation(i,t){return ct.isExpression(t)?t=t.symbol:ct.isSymbol(t)||(t=ct._.parse(t)),new Zt(ct._[i](this.symbol.clone(),t.clone()))},add(i){return this.operation("add",i)},subtract(i){return this.operation("subtract",i)},multiply(i){return this.operation("multiply",i)},divide(i){return this.operation("divide",i)},pow(i){return this.operation("pow",i)},expand(){return new Zt(ct._.expand(this.symbol))},each(i,t){if(this.symbol.each)this.symbol.each(i,t);else if(ct.isArray(this.symbol))for(let e=0;e<this.symbol.length;e++)i.call(this.symbol,this.symbol[e],e);else i.call(this.symbol)},eq(i){ct.isSymbol(i)||(i=ct._.parse(i));try{return ct._.subtract(this.symbol.clone(),i).equals(0)}catch(t){if(t.message==="timeout")throw t;return!1}},lt(i){ct.isSymbol(i)||(i=ct._.parse(i));try{return It(ct._.subtract(this.symbol.clone(),i)).lessThan(0)}catch(t){if(t.message==="timeout")throw t;return!1}},gt(i){ct.isSymbol(i)||(i=ct._.parse(i));try{return It(ct._.subtract(this.symbol.clone(),i)).greaterThan(0)}catch(t){if(t.message==="timeout")throw t;return!1}},gte(i){return this.gt(i)||this.eq(i)},lte(i){return this.lt(i)||this.eq(i)},numerator(){return new Zt(this.symbol.getNum())},denominator(){return new Zt(this.symbol.getDenom())},hasFunction(i){return this.symbol.containsFunction(i)},contains(i){return this.symbol.contains(i)}};Zt.prototype.toTeX=Zt.prototype.latex;var Ye={Frac:He,NerdamerSymbol:null,isVector:()=>!1,isArray:Ht,isMatrix:()=>!1,isSymbol:()=>!1,block:g0,_:null,Settings:{PRECISION:1e-14},text:()=>"",LaTeX:null};function Mt(i,...t){this.multiplier=new Ye.Frac(1),Ye.isVector(i)?this.elements=i.elements?.slice(0)??[]:Ye.isArray(i)?this.elements=i.slice(0):Ye.isMatrix(i)?i.elements.length===1?(this.elements=[...i.elements[0]],this.rowVector=!0):i.elements.length>1&&Array.isArray(i.elements[0])&&i.elements[0].length===1&&(this.elements=i.elements.map(e=>e[0]),this.rowVector=!1):typeof i>"u"?this.elements=[]:this.elements=[i,...t]}Mt.arrayPrefill=function(t,e){let v=[];e||=0;for(let q=0;q<t;q++)v[q]=e;return v};Mt.fromArray=function(t){let e=new Mt;return e.elements=t,e};Mt.fromSet=function(t){return Mt.fromArray(t.elements)};Mt.prototype={custom:!0,e(i){return i<1||i>this.elements.length?null:this.elements[i-1]},set(i,t){Ye.isSymbol(t)||(t=new Ye.NerdamerSymbol(t)),this.elements[i]=t},dimensions(){return this.elements.length},modulus(){return Ye.block("SAFE",()=>Ye._.pow(this.dot(this.clone()),new Ye.NerdamerSymbol(.5)),void 0,this)},eql(i){let t=this.elements.length,e=i.elements||i;if(t!==e.length)return!1;do if(Math.abs(Ye._.subtract(this.elements[t-1],e[t-1]).valueOf())>Ye.Settings.PRECISION)return!1;while(--t);return!0},clone(){let i=new Mt,t=this.elements.length;for(let e=0;e<t;e++)i.elements.push(this.elements[e].clone());return i.rowVector=this.rowVector,i},expand(i){return this.elements=this.elements.map(t=>Ye._.expand(t,i)),this},map(i){let t=[];return this.each((e,v)=>{t.push(i(e,v))}),new Mt(t)},each(i){let t=this.elements.length,e=t,v;do v=e-t,i(this.elements[v],v+1);while(--t)},toUnitVector(){return Ye.block("SAFE",()=>{let i=this.modulus();return i.valueOf()===0?this.clone():this.map(t=>Ye._.divide(t,i))},void 0,this)},angleFrom(i){return Ye.block("SAFE",()=>{let t=i.elements||i;if(this.elements.length!==t.length)return null;let v=new Ye.NerdamerSymbol(0),q=new Ye.NerdamerSymbol(0),X=new Ye.NerdamerSymbol(0);this.each((u,re)=>{v=Ye._.add(v,Ye._.multiply(u,t[re-1])),q=Ye._.add(q,Ye._.multiply(u,u)),X=Ye._.add(X,Ye._.multiply(t[re-1],t[re-1]))}),q=Ye._.pow(q,new Ye.NerdamerSymbol(.5)),X=Ye._.pow(X,new Ye.NerdamerSymbol(.5));let K=Ye._.multiply(q,X);if(K.valueOf()===0)return null;let H=Ye._.divide(v,K),W=H.valueOf();return W<-1&&(H=-1),W>1&&(H=1),new Ye.NerdamerSymbol(Math.acos(H))},void 0,this)},isParallelTo(i){let t=this.angleFrom(i).valueOf();return t===null?null:t<=Ye.Settings.PRECISION},isAntiparallelTo(i){let t=this.angleFrom(i).valueOf();return t===null?null:Math.abs(t-Math.PI)<=Ye.Settings.PRECISION},isPerpendicularTo(i){let t=this.dot(i);return t===null?null:Math.abs(t)<=Ye.Settings.PRECISION},add(i){return Ye.block("SAFE",()=>{let t=i.elements||i;return this.elements.length!==t.length?null:this.map((e,v)=>Ye._.add(e,t[v-1]))},void 0,this)},subtract(i){return Ye.block("SAFE",()=>{let t=i.elements||i;return this.elements.length!==t.length?null:this.map((e,v)=>Ye._.subtract(e,t[v-1]))},void 0,this)},multiply(i){return this.map(t=>t.clone()*i.clone())},x(i){return this.multiply(i)},dot(i){return Ye.block("SAFE",()=>{let t=i.elements||i,e=new Ye.NerdamerSymbol(0),v=this.elements.length;if(v!==t.length)return null;do e=Ye._.add(e,Ye._.multiply(this.elements[v-1],t[v-1]));while(--v);return e},void 0,this)},cross(i){let t=i.elements||i;if(this.elements.length!==3||t.length!==3)return null;let e=this.rowVector&&i.rowVector,v=this.elements;return Ye.block("SAFE",()=>{let q=new Mt([Ye._.subtract(Ye._.multiply(v[1],t[2]),Ye._.multiply(v[2],t[1])),Ye._.subtract(Ye._.multiply(v[2],t[0]),Ye._.multiply(v[0],t[2])),Ye._.subtract(Ye._.multiply(v[0],t[1]),Ye._.multiply(v[1],t[0]))]);return q.rowVector=e,q},void 0,this)},toUnitMultiplier(){return this},max(){let i=0,t=this.elements.length,e=t,v;do v=e-t,Math.abs(this.elements[v].valueOf())>Math.abs(i.valueOf())&&(i=this.elements[v]);while(--t);return i},magnitude(){let i=new Ye.NerdamerSymbol(0);return this.each(t=>{i=Ye._.add(i,Ye._.pow(t,new Ye.NerdamerSymbol(2)))}),Ye._.sqrt(i)},indexOf(i){let t=null,e=this.elements.length,v=e,q;do q=v-e,t===null&&this.elements[q].valueOf()===i.valueOf()&&(t=q+1);while(--e);return t},text_(i,t){let e=Ye.text(this,t);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},text(i,t){let e=Ye.text(this,t);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},toString(){return this.text()},latex(i){let t=[];for(let e=0;e<this.elements.length;e++)t.push(Ye.LaTeX.latex(this.elements[e],i));return`[${t.join(", ")}]`}};var ot={Frac:He,NerdamerSymbol:null,Vector:Mt,isMatrix:()=>!1,isVector:()=>!1,isArray:Ht,isSymbol:()=>!1,block:g0,_:null,err:()=>{},LaTeX:null};function St(...i){this.multiplier=new ot.Frac(1);let t=i,e=t.length,v,q=[];if(ot.isMatrix(t))for(v=0;v<e;v++)q.push(t[v].slice(0));else{let X,K,H;for(v=0;v<e;v++)X=t[v],ot.isVector(X)&&(X=X.elements),ot.isArray(X)||(X=[X]),H=X.length,K&&K!==H&&ot.err("Unable to create Matrix. Row dimensions do not match!"),q.push(X),K=H}this.elements=q}St.identity=function(t){let e=new St;for(let v=0;v<t;v++){e.elements.push([]);for(let q=0;q<t;q++)e.set(v,q,v===q?new ot.NerdamerSymbol(1):new ot.NerdamerSymbol(0))}return e};St.fromArray=function(t){function e(v){return St.apply(this,v)}return e.prototype=St.prototype,new e(t)};St.zeroMatrix=function(t,e){let v=new St;for(let q=0;q<t;q++)v.elements.push(ot.Vector.arrayPrefill(e,new ot.NerdamerSymbol(0)));return v};St.prototype={custom:!0,get(i,t){if(this.elements[i])return this.elements[i][t]},map(i,t){let e=new St;return this.each((v,q,X)=>{e.set(q,X,i.call(e,v),t)}),e},set(i,t,e,v){this.elements[i]||=[],v||ot.isSymbol(e)?this.elements[i][t]=e:this.elements[i][t]=new ot.NerdamerSymbol(e)},cols(){return this.elements[0].length},rows(){return this.elements.length},row(i){return!i||i>this.cols()?[]:this.elements[i-1]},col(i){let t=this.rows(),e=[];if(i>this.cols()||!i)return e;for(let v=0;v<t;v++)e.push(this.elements[v][i-1]);return e},eachElement(i){let t=this.rows(),e=this.cols(),v,q;for(v=0;v<t;v++)for(q=0;q<e;q++)i.call(this,this.elements[v][q],v,q)},determinant(){if(!this.isSquare())return null;let i=this.toRightTriangular(),t=i.elements[0][0],e=i.elements.length-1,v=e,q;do q=v-e+1,t=ot._.multiply(t,i.elements[q][q]);while(--e);return t},isSquare(){return this.elements.length===this.elements[0].length},isSingular(){return this.isSquare()&&this.determinant()===0},augment(i){let t=this.rows(),e=i.rows();t!==e&&ot.err("Cannot augment matrix. Rows don't match.");for(let v=0;v<t;v++)this.elements[v]=this.elements[v].concat(i.elements[v]);return this},clone(){let i=this.rows(),t=this.cols(),e=new St;for(let v=0;v<i;v++){e.elements[v]=[];for(let q=0;q<t;q++){let X=this.elements[v][q];e.elements[v][q]=ot.isSymbol(X)?X.clone():X}}return e},toUnitMultiplier(){return this},expand(i){return this.eachElement(t=>ot._.expand(t,i)),this},evaluate(i){return this.eachElement(t=>ot._.evaluate(t,i)),this},invert(){return this.isSquare()||ot.err("Matrix is not square!"),ot.block("SAFE",()=>{let i=this.elements.length,t=i,e,v,q=St.identity(i),X=this.augment(q).toRightTriangular(),K,H=X.elements[0].length,W,u,re,j=[],de;do{e=i-1,u=[],K=H,j[e]=[],re=X.elements[e][e];do W=H-K,de=ot._.divide(X.elements[e][W],re.clone()),u.push(de),W>=t&&j[e].push(de);while(--K);for(X.elements[e]=u,v=0;v<e;v++){u=[],K=H;do W=H-K,u.push(ot._.subtract(X.elements[v][W].clone(),ot._.multiply(X.elements[e][W].clone(),X.elements[v][e].clone())));while(--K);X.elements[v]=u}}while(--i);return St.fromArray(j)},void 0,this)},toRightTriangular(){return ot.block("SAFE",()=>{let i=this.clone(),t,e,v,q=this.elements.length,X=q,K,H,W=this.elements[0].length,u;do{if(K=X-q,e=i.elements[K][K],e.valueOf()===0){for(let re=K+1;re<X;re++)if(v=i.elements[re][K],v&&v.valueOf()!==0){t=[],H=W;do u=W-H,t.push(ot._.add(i.elements[K][u].clone(),i.elements[re][u].clone()));while(--H);i.elements[K]=t;break}}if(e=i.elements[K][K],e.valueOf()!==0)for(let re=K+1;re<X;re++){let j=ot._.divide(i.elements[re][K].clone(),i.elements[K][K].clone());t=[],H=W;do u=W-H,t.push(u<=K?new ot.NerdamerSymbol(0):ot._.subtract(i.elements[re][u].clone(),ot._.multiply(i.elements[K][u].clone(),j.clone())));while(--H);i.elements[re]=t}}while(--q);return i},void 0,this)},transpose(){let i=this.elements.length,t=this.elements[0].length,e=new St,v=t,q,X,K;do{q=t-v,e.elements[q]=[],X=i;do K=i-X,e.elements[q][K]=this.elements[K][q].clone();while(--X)}while(--v);return e},canMultiplyFromLeft(i){let t=ot.isMatrix(i)?i.elements.length:i.length;return this.elements[0].length===t},sameSize(i){return this.rows()===i.rows()&&this.cols()===i.cols()},multiply(i){return ot.block("SAFE",()=>{let t=i.elements||i;if(!this.canMultiplyFromLeft(t)){if(this.sameSize(i)){let _e=new St,Ue=this.rows();for(let te=0;te<Ue;te++){let ue=ot._.multiply(new ot.Vector(this.elements[te]),new ot.Vector(i.elements[te]));_e.elements[te]=ue.elements}return _e}return null}let e=this.elements.length,v=e,q,X,K=t[0].length,H,W=this.elements[0].length,u=[],re,j,de;do{q=v-e,u[q]=[],X=K;do{H=K-X,re=new ot.NerdamerSymbol(0),j=W;do de=W-j,re=ot._.add(re,ot._.multiply(this.elements[q][de],t[de][H]));while(--j);u[q][H]=re}while(--X)}while(--e);return St.fromArray(u)},void 0,this)},add(i,t){let e=new St;return this.sameSize(i)&&this.eachElement((v,q,X)=>{let K=ot._.add(v.clone(),i.elements[q][X].clone());t&&(K=t.call(e,K,v,i.elements[q][X])),e.set(q,X,K)}),e},subtract(i,t){let e=new St;return this.sameSize(i)&&this.eachElement((v,q,X)=>{let K=ot._.subtract(v.clone(),i.elements[q][X].clone());t&&(K=t.call(e,K,v,i.elements[q][X])),e.set(q,X,K)}),e},negate(){return this.each(i=>i.negate()),this},toVector(){if(this.rows()===1||this.cols()===1){let i=new ot.Vector;return i.elements=this.elements,i}return this},toString(i,t){let e=this.rows(),v=[];i=i===void 0?`
`:i;for(let q=0;q<e;q++)v.push(`[${this.elements[q].map(X=>{let K=t?X.multiplier.toDecimal():X.toString();return X===void 0?"":K}).join(",")}]`);return`matrix${Xt(v.join(","))}`},text(){return`matrix(${this.elements.map(i=>`[${i.toString("")}]`)})`},latex(i){let t=this.cols(),{elements:e}=this;return Dt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let v=[];for(let q in e){if(!Object.hasOwn(e,q))continue;let X=[];for(let K=0;K<t;K++)X.push(ot.LaTeX.latex(e[q][K],i));v.push(X.join(" & "))}return v.join(" \\cr ")})}};St.prototype.each=St.prototype.eachElement;var t0={Math2:{},Frac:He,NerdamerSymbol:null,isInt:()=>!1,nround:(i,t)=>i,even:()=>!1,block:(i,t)=>t(),_:null,variables:()=>[],inBrackets:i=>`(${i})`,FN:5,N:1,S:3,P:2,EX:4,CB:7},f0={dependencies:{},reformat:{},getProperName(i){return{continuedFraction:"continuedFraction"}[i]||i},compileDependencies(i,t){let e=f0.dependencies[i],v=t&&t[1]?t[1]:"",q=t&&t[0]?t[0]:{};for(let X in e){if(typeof e[X]=="object")continue;let K=X.split("."),H=e[X];if(typeof H=="function"){let W=H.toString();!W.startsWith("function")&&!W.startsWith("(")&&!W.startsWith("async")&&(W=`function ${W}`),H=W}v+=`let ${K.length>1?K[1]:K[0]}=${H};`,q[X]=K.pop()}return[q,v]},getArgsDeps(i,t){let{args:e}=i,v=t,q=function(X){X.group===t0.FN&&(v=f0.compileDependencies(X.fname,v))};for(let X=0;X<e.length;X++)i.args[X].each(q);return v},build(i,t){let{Math2:e,NerdamerSymbol:v,block:q,_:X,variables:K,inBrackets:H,FN:W,N:u,S:re,P:j,EX:de,CB:_e}=t0;i=q("PARSE2NUMBER",()=>X.parse(i),!0);let Ue=K(i),te=[],ue=[],ce=function(Be,$e){Be.fname===""&&(Be=v.unwrapPARENS(Be)),$e||=[];let ve=[],{group:qe}=Be,me="",Q=function(r){let g=r===_e?"*":"+",d=[];for(let A in Be.symbols){if(!Object.hasOwn(Be.symbols,A))continue;let D=Be.symbols[A],b=ce(D,$e)[0];D.isComposite()&&(b=H(b)),d.push(b)}let S=d.join(g);return S=S&&!Be.multiplier.equals(1)?H(S):S,S},c=function(r){let g;if(r in Math)g=`Math.${r}`;else{if(r=f0.getProperName(r),te.indexOf(r)===-1){let d=e[r].toString();!d.startsWith("function")&&!d.startsWith("(")&&!d.startsWith("async")&&(d=`function ${d}`),$e.push(`let ${r} = ${d}; `),te.push(r)}g=r}return g+=H(Be.args.map(d=>ce(d,$e)[0]).join(",")),g};qe===u?ve.push(Be.multiplier.toDecimal()):Be.multiplier.equals(-1)?me="-":Be.multiplier.equals(1)||ve.push(Be.multiplier.toDecimal());let p;if(qe===re||qe===j)p=Be.value;else if(qe===W)if(ue=f0.compileDependencies(Be.fname,ue),ue=f0.getArgsDeps(Be,ue),f0.reformat[Be.fname]){let r=f0.reformat[Be.fname](Be,ue);ue=r[1],p=r[0]}else p=c(Be.fname);else if(qe===de){let r=Be.previousGroup;r===u||r===re?p=Be.value:r===W?(p=c(Be.fname),ue=f0.compileDependencies(Be.fname,ue),ue=f0.getArgsDeps(Be,ue)):p=Q(Be.previousGroup)}else p=Q(Be.group);if(Be.group!==u&&!Be.power.equals(1)){let r=ce(X.parse(Be.power));$e.push(r[1]),p=`Math.pow${H(`${p},${r[0]}`)}`}return p&&ve.push(me+p),[ve.join("*"),$e.join("").replace(/\n+\s+/gu," ")]};t&&(Ue=t);let Z=ce(i);for(let Be in ue[0]){if(!Object.hasOwn(ue[0],Be))continue;let $e=ue[0][Be];Z[1]=Z[1].replace(Be,$e),ue[1]=ue[1].replace(Be,$e)}return new Function(...Ue,`${(ue[1]||"")+Z[1]} return ${Z[0]};`)}},xt={_:null,isArray:()=>!1,isSymbol:()=>!1,isMatrix:()=>!1,isVector:()=>!1,isSet:()=>!1,isNegative:()=>!1,inBrackets:i=>`(${i})`,Settings:{},SQRT:"sqrt",ABS:"abs",PARENTHESIS:"parens",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",FN:5,S:3,P:2,N:1,CB:7,CP:8,EX:4,Parser:null},Nt={parser:null,space:"~",dot:" \\cdot ",latex(i,t){let{_:e,isArray:v,isSymbol:q,isMatrix:X,isVector:K,isSet:H,isNegative:W,P:u,CB:re}=xt;if(i.clone&&(i=i.clone()),i instanceof e.classes.Collection&&(i=i.elements),v(i)){let $e=[];for(let ve=0;ve<i.length;ve++){let qe=i[ve];q(qe)||(qe=e.parse(qe)),$e.push(this.latex(qe,t))}return this.brackets($e.join(", "),"square")}if(X(i)){let $e=`\\begin{pmatrix}
`;for(let ve=0;ve<i.elements.length;ve++){let qe=[],me=i.elements[ve];for(let Q=0;Q<me.length;Q++)qe.push(this.latex(me[Q],t));$e+=qe.join(" & "),ve<i.elements.length-1&&($e+=`\\\\
`)}return $e+="\\end{pmatrix}",$e}if(K(i)){let $e="\\left[";for(let ve=0;ve<i.elements.length;ve++)$e+=`${this.latex(i.elements[ve],t)} ${ve===i.elements.length-1?"":",\\,"}`;return $e+="\\right]",$e}if(H(i)){let $e="\\{";for(let ve=0;ve<i.elements.length;ve++)$e+=`${this.latex(i.elements[ve],t)} ${ve===i.elements.length-1?"":",\\,"}`;return $e+="\\}",$e}i=i.clone();let j=t==="decimal"||t==="decimals",{power:de}=i,_e=W(de),Ue=i.multiplier.lessThan(0);if(i.group===u&&j)return String(i.multiplier.toDecimal()*i.value**i.power.toDecimal());i.multiplier=i.multiplier.abs();let te;j?te=[String(i.multiplier.toDecimal()),""]:te=[i.multiplier.num,i.multiplier.den];let ue=this.value(i,_e,t,Ue),ce;_e&&de.negate(),j?(ce=q(de)?Nt.latex(de,t):String(de.toDecimal()),String(ce)==="1"&&(ce="")):q(de)?ce=this.latex(de,t):ce=this.formatFrac(de,!0);let Z=["",""],Le=_e?1:0;return Z[Le]=ce,((Ue?"-":"")+this.set(te,ue,Z,i.group===re)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(i,t,e,v){let{isSymbol:q,isNegative:X,Settings:K,SQRT:H,ABS:W,PARENTHESIS:u,FACTORIAL:re,DOUBLEFACTORIAL:j,FN:de,S:_e,P:Ue,N:te,CB:ue,CP:ce,EX:Z}=xt,{group:Le}=i,{previousGroup:Be}=i,$e=["",""],ve=t?1:0;if(i.isInfinity)$e[ve]="\\infty";else if(Le===_e||Le===Ue||Be===_e||Be===Ue||Be===te){let qe=this.formatSubscripts(i.value);qe.replace&&(qe=qe.replace(/(?<prefix>.+)_$/u,"$1\\_"));let me=String(qe).split("_"),Q=this.greek[me[0]];Q&&(me[0]=Q,qe=me.join("_"));let c=this.symbols[me[0]];c&&(me[0]=c,qe=me.join("_")),$e[ve]=qe}else if(Le===de||Be===de){let qe=[],{fname:me}=i;for(let Q=0;Q<i.args.length;Q++){let c=i.args[Q],p;typeof c=="string"?p=c:p=this.latex(c,e),qe.push(p)}if(me===H)$e[ve]=`\\sqrt${this.braces(qe.join(","))}`;else if(me===W)$e[ve]=this.brackets(qe.join(","),"abs");else if(me===u)$e[ve]=this.brackets(qe.join(","),"parens");else if(me==="limit")$e[ve]=` \\lim\\limits_{${qe[1]} \\to ${qe[2]}} ${qe[0]}`;else if(me==="integrate")$e[ve]=`\\int${this.braces(qe[0])}${this.braces(`d${qe[1]}`)}`;else if(me==="defint")$e[ve]=`\\int\\limits_${this.braces(qe[1])}^${this.braces(qe[2])} ${qe[0]} d${qe[3]}`;else if(me===re||me===j){let Q=i.args[0];Q.power.equals(1)&&(Q.isComposite()||Q.isCombination())&&(qe[0]=this.brackets(qe[0])),$e[ve]=qe[0]+(me===re?"!":"!!")}else if(me==="floor")$e[ve]=`\\left \\lfloor${this.braces(qe[0])}\\right \\rfloor`;else if(me==="ceil")$e[ve]=`\\left \\lceil${this.braces(qe[0])}\\right \\rceil`;else if(me===K.LOG&&qe.length>1)$e[ve]=`\\mathrm${this.braces(K.LOG)}_${this.braces(qe[1])}${this.brackets(qe[0])}`;else if(me===K.LOG10)$e[ve]=`\\mathrm${this.braces(K.LOG)}_${this.braces("10")}${this.brackets(qe[0])}`;else if(me===K.LOG2)$e[ve]=`\\mathrm${this.braces(K.LOG)}_${this.braces("2")}${this.brackets(qe[0])}`;else if(me===K.LOG1P)$e[ve]=`\\ln${this.brackets(`1 + ${qe[0]}`)}`;else if(me==="sum"){let Q=qe[0],c=qe[1],p=qe[2],r=qe[3];$e[ve]=`\\sum\\limits_{${this.braces(c)}=${this.braces(p)}}^${this.braces(r)} ${this.braces(Q)}`}else if(me==="product"){let Q=qe[0],c=qe[1],p=qe[2],r=qe[3];$e[ve]=`\\prod\\limits_{${this.braces(c)}=${this.braces(p)}}^${this.braces(r)} ${this.braces(Q)}`}else if(me==="nthroot")$e[ve]=`\\sqrt[${qe[1]}]${this.braces(qe[0])}`;else if(me==="mod")$e[ve]=`${qe[0]} \\bmod ${qe[1]}`;else if(me==="realpart")$e[ve]=`\\operatorname{Re}${this.brackets(qe[0])}`;else if(me==="imagpart")$e[ve]=`\\operatorname{Im}${this.brackets(qe[0])}`;else{let Q=me===""?"":`\\mathrm${this.braces(me.replace(/_/gu,"\\_"))}`;i.isConversion?$e[ve]=Q+this.brackets(qe.join(""),"parens"):$e[ve]=Q+this.brackets(qe.join(","),"parens")}}else if(i.isComposite()){let qe=i.collectSymbols().sort(Le===ce||Be===ce?(p,r)=>r.group-p.group:(p,r)=>{let g=q(p.power)?-1:p.power;return(q(r.power)?-1:r.power)-g}),me=[],Q=qe.length;for(let p=0;p<Q;p++)me.push(Nt.latex(qe[p],e));let c=me.join("+");$e[ve]=!(i.isLinear()&&i.multiplier.equals(1))||v?this.brackets(c,"parens"):c}else if(Le===ue||Be===Z||Be===ue){Le===ue&&i.distributeExponent();let qe=[],me=[],Q=[],c=[],p=0,r=0,g=function(d,S,A){if(A>1&&S.length>0){let D=S.length;for(let b=0;b<D;b++){let C=S[b],V=d[C];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(V)||/^\\left\(.+\\right\)$/gu.test(V)||(d[C]=Nt.brackets(V,"parens"))}}return d};i.each(d=>{let S=X(d.power),A;S?(A=Nt.latex(d.invert(),e),r++,d.isComposite()&&(!i.multiplier.den.equals(1)&&Math.abs(d.power)===1&&(A=Nt.brackets(A,"parens")),Q.push(qe.length)),qe.push(A)):(A=Nt.latex(d,e),p++,d.isComposite()&&(!i.multiplier.num.equals(1)&&Math.abs(d.power)===1&&(A=Nt.brackets(A,"parens")),c.push(me.length)),me.push(A))}),g(me,c,p),$e[0]=me.join(this.dot),g(qe,Q,r),$e[1]=qe.join(this.dot)}return $e},set(i,t,e,v){let q=function(de){return/^\\left\(.+\\right\)$/u.test(de)};e&&=this.formatP(e);let X;v&&(X=e[0],e[0]=""),t=this.merge(t,e);let K=i[0],H=i[1],W=t[0],u=t[1];W&&Number(K)===1&&(K=""),Number(H)===1&&(H="");let re=this.join(K,W,q(W)?"":this.dot),j=this.join(H,u,q(u)?"":this.dot);if(re&&j){let de=this.frac(re,j);return v&&X&&(de=this.brackets(de)+X),de}return re},merge(i,t){let e=[];for(let v=0;v<2;v++)e[v]=i[v]+t[v];return e},join(i,t,e){return!i&&!t?"":i&&!t?i:t&&!i?t:i+e+t},formatSubscripts(i){let t=i.toString().split("_"),e="";for(;t.length>1;)t.length>0&&(e=`_${this.braces(t.pop()+e)}`);return t[0]+e},formatP(i){for(let t=0;t<2;t++){let e=i[t];e&&(i[t]=`^${this.braces(e)}`)}return i},formatFrac(i,t){let e=i.num.toString(),v=i.den.toString();return t&&e==="1"&&v==="1"?"":v==="1"?e:this.frac(e,v)},frac(i,t){return`\\frac${this.braces(i)}${this.braces(t)}`},braces(i){return`{${i}}`},brackets(i,t){t||="parens";let v={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[t];return`\\left${v[0]}${i}\\right${v[1]}`},filterTokens(i){let{isArray:t}=xt,e=[];t(i)&&(e.type=i.type);let v=["\\","left","right","big","Big","large","Large"];for(let q=0,X=i.length;q<X;q++){let K=i[q],H=i[q+1];K.value==="\\"&&H.value==="\\"?e.push(K):t(K)?e.push(Nt.filterTokens(K)):v.indexOf(K.value)===-1&&e.push(K)}return e},parse(i){let{inBrackets:t,SQRT:e}=xt,v,q,X="",K=this.filterTokens(i),H={cdot:"",times:"",infty:"Infinity"},W=function(j){return K[typeof j>"u"?++v:v+=j]},u=function(){return Nt.parse(W())},re=function(j){return j in H?H[j]:j==="*"&&K[v+1].value==="&"?(W(2),","):j==="&"?(W(),","):j==="\\"?"],[":j};for(v=0,q=K.length;v<q;v++){let j=K[v];if(j.value==="frac"){let de=u(),_e=u();X+=`${de}/${_e}`}else if(j.value in Nt.symbols)if(j.value===e&&K[v+1].type==="vector"&&K[v+2].type==="NerdamerSet"){let de=u(),_e=u();X+=`${_e}^${t(`1/${de}`)}`}else X+=j.value+u();else if(j.value==="int"){let de=u();v++;let _e=W().value;_e=re(_e.substring(1,_e.length)),X+=`integrate${t(`${de},${_e}`)}`}else if(j.value==="int_"){let de=u();v++;let _e=W().value;_e===void 0&&(v--,_e=u());let Ue=u(),te=W().value;te===","&&(te=W().value),te==="differentialD"&&(v++,te=W().value),te==="mathrm"&&(v++,te=W().value),X+=`defint${t(`${Ue},${de},${_e},${te}`)}`}else if(j.value&&j.value.startsWith("int_")){let de=j.value.replace("int_","");v++;let _e=W().value;_e===void 0&&(v--,_e=u());let Ue=u(),te=W().value;te===","&&(te=W().value),te==="differentialD"&&(v++,te=W().value),te==="mathrm"&&(v++,te=W().value),X+=`defint${t(`${Ue},${de},${_e},${te}`)}`}else if(j.value==="mathrm"){let de=K[++v][0].value;X+=de+u()}else if(j.value==="sum_"||j.value==="prod_"){let de=j.value==="sum_"?"sum":"product",_e=W();v++;let Ue=u(),te=u();X+=de+t([te,re(_e[0]),re(_e[2]),re(Ue)].join(","))}else if(j.value==="lim_"){let de=W();X+=`limit${t([u(),re(de[0]),re(de[2])].join(","))}`}else if(j.value==="begin"){let de=W();Array.isArray(de)&&de[0].value==="matrix"&&(X+="matrix([")}else if(j.value==="end"){let de=W();Array.isArray(de)&&de[0].value==="matrix"&&(X+="])")}else Array.isArray(j)?X+=re(Nt.parse(j)):X+=re(j.value.toString())}return t(X)}},v1={LONG_PI:"",LONG_E:""},Me={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",get LONG_PI(){return v1.LONG_PI},get LONG_E(){return v1.LONG_E},PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800},o0={bigInt:null,BIG_LOG_CACHE:{},PRIMES:[],NerdamerSymbol:null,CB:7,P:2},rt={csc(i){return 1/Math.sin(i)},sec(i){return 1/Math.cos(i)},cot(i){return 1/Math.tan(i)},acsc(i){return Math.asin(1/i)},asec(i){return Math.acos(1/i)},acot(i){return Math.PI/2-Math.atan(i)},erf(i){let t=1/(1+.5*Math.abs(i)),e=1-t*Math.exp(-i*i-1.26551223+t*(1.00002368+t*(.37409196+t*(.09678418+t*(-.18628806+t*(.27886807+t*(-1.13520398+t*(1.48851587+t*(-.82215223+t*.17087277)))))))));return i>=0?e:-e},diff(i){return function(v){return(i(v+.001)-i(v-.001))/.002}},median(...i){i.sort((e,v)=>e-v);let t=Math.floor(i.length/2);return i.length%2?i[t]:(i[t-1]+i[t])/2},fromContinued(i){let t=i.fractions.slice(),e=1/t.pop();for(let v=0,q=t.length;v<q;v++)e=1/(t.pop()+e);return i.sign*(i.whole+e)},continuedFraction(i,t){t||=20;let e=Math.sign(i),v=Math.abs(i),q=Math.floor(v),X=v-q,K=0,H=!1,W=1e-14,u=1e7,re,j,de={whole:q,sign:e,fractions:[]};for(;!H&&X!==0&&(re=1/X,j=Math.floor(re),!(j>u&&rt.fromContinued(de)-i<=Number.EPSILON));)de.fractions.push(j),X=re-j,(X<=W||K>=t-1)&&(H=!0),K++;let _e=de.fractions.length-1;return de.fractions[_e]===1&&(de.fractions.pop(),de.fractions[--_e]++),de},bigpow(i,t){i instanceof He||(i=He.create(i)),t instanceof He||(t=He.create(t));let e=new He(0);if(t.isInteger())e.num=i.num.pow(t.toString()),e.den=i.den.pow(t.toString());else{let v=He.create(i.num**t.num),q=He.create(i.den**t.num);e.num=rt.nthroot(v,t.den.toString()),e.den=rt.nthroot(q,t.den)}return e},gamma(i){let e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(i<.5)return Math.PI/(Math.sin(Math.PI*i)*rt.gamma(1-i));i-=1;let v=e[0];for(let X=1;X<9;X++)v+=e[X]/(i+X);let q=i+7+.5;return Math.sqrt(2*Math.PI)*q**(i+.5)*Math.exp(-q)*v},bigfactorial(i){let t=new o0.bigInt(1);for(let e=2;e<=i;e++)t=t.times(e);return new He(t)},bigLog(i){let t=o0.BIG_LOG_CACHE;if(t[i])return He.quick.apply(null,t[i].split("/"));i=new He(i);let e=80,v=new He(0),q=i.subtract(new He(1)),X=i.add(new He(1));for(let K=0;K<e;K++){let H=new He(2*K+1),W=rt.bigpow(q.divide(X),H),u=H.clone().invert().multiply(W);v=v.add(u)}return v.multiply(new He(2))},factorial(i){let t=i%1===0;if(t&&i<0)return NaN;if(!t)return rt.gamma(i+1);let e=1;for(let v=2;v<=i;v++)e*=v;return e},dfactorial(i){let t=new He(1);if(yt(i)){let e=i%2===0,v=e?i/2:(i+1)/2;if(e)for(let q=1;q<=v;q++)t=t.multiply(new He(2).multiply(new He(q)));else for(let q=1;q<=v;q++)t=t.multiply(new He(2).multiply(new He(q)).subtract(new He(1)))}else t=2**((1+2*i-Math.cos(Math.PI*i))/4)*Math.PI**((Math.cos(Math.PI*i)-1)/4)*rt.gamma(1+i/2);return t},GCD(...i){let t=T1(i.map(q=>Math.abs(q))).sort(),e=Math.abs(t.shift()),v=t.length;for(;v-- >0;){let q=Math.abs(t.shift());for(;;){if(e%=q,e===0){e=q;break}if(q%=e,q===0)break}}return e},QGCD(...i){let t=i[0];for(let e=1;e<i.length;e++){let v=i[e],q=t.isNegative()&&v.isNegative()?-1:1;t=v.gcd(t),q<0&&t.negate()}return t},LCM(i,t){return i*t/rt.GCD(i,t)},pow(i,t){return i<0&&Math.abs(t)<1?1/t%2===0?NaN:-(Math.abs(i)**t):i**t},factor(i){i=Number(i);let t=Math.sign(i);i=Math.abs(i);let e=rt.ifactor(i),v=new o0.NerdamerSymbol;v.symbols={},v.group=o0.CB;for(let q in e){if(!Object.hasOwn(e,q))continue;let X=new o0.NerdamerSymbol(1);X.group=o0.P,X.value=q;let K=new o0.NerdamerSymbol(e[q]);X.power=K,v.symbols[q]=X}return v.updateHash(),i===1&&(v=new o0.NerdamerSymbol(i)),t<0&&v.negate(),v},sfactor(i,t){t||={};let e=Math.floor(Math.sqrt(i)),{PRIMES:v}=o0,q=v[v.length-1];e>q&&i<1e6&&Sn(e);let X=v.length;for(let K=0;K<X;K++){let H=v[K];for(;i%H===0;)i/=H,t[H]=(t[H]||0)+1}return i>1&&(t[i]=1),t},ifactor(i){let{bigInt:t}=o0,e=new t(i),v=new t(String(i));if(v.equals(0))return{0:1};let q=v.isNegative()?-1:1;v=v.abs();let X={};if(v.lt("65536"))X=rt.sfactor(v,X);else{let K=function(H){H.isPrime()?X[H]=(X[H]||0)+1:X=rt.sfactor(H,X)};try{let W={value:0},u=function(re,j,de){let _e=new t(re),Ue=2,te=new t(re),ue=new t(1);for(;ue.equals(1);){for(let ce=0;ce<=Ue&&ue.equals(1);ce++){if(de.value++>1e3)throw new Error("stopping");te=te.pow(2).add(1).mod(j),ue=t.gcd(te.minus(_e).abs(),j)}Ue*=2,_e=te}return ue.equals(j)?u(re+1,j,de):ue};for(;!v.abs().equals(1);)if(v.isPrime()){K(v);break}else{let re=u(2,v,W);K(re),v=v.divide(re)}}catch(H){if(H.message==="timeout")throw H;X={},K(e)}}if(q===-1){let K=C1(k1(X));X[`-${K}`]=X[K],delete X[K]}return X},boxfactor(i,t){t||=200;let e,v,q=Math.floor(5/12*i),X=0,K=!1;for(;e=Math.floor(i/q),v=i%q,v!==0;){if(K)return[i,1];q=Math.max(v,q-v),X++,K=X>t}return[e,q,X]},fib(i){let t=Math.sign(i);i=Math.abs(i),t=Bt(i)?t:Math.abs(t);let e=0,v=1,q=1;for(let X=2;X<=i;X++)q=e+v,e=v,v=q;return q*t},mod(i,t){return i%t},integer_part(i){return Math.sign(i)*Math.floor(Math.abs(i))},simpson(i,t,e,v){let q=function(de,_e,Ue){let te=de(_e),ue=1e-12;return isNaN(te)&&(te=de(Ue===1?_e+ue:_e-ue)),te};v||=1e-4;let X=Math.abs(Math.floor((e-t)/v));X%2!==0&&X++;let K=(e-t)/X,H=q(i,t,1),W=!1,u=t+K,re,j;for(let de=1;de<X;de++)re=W?2:4,j=re*q(i,u,1),H+=j,W=!W,u+=K;return(H+q(i,u,2))*(K/3)},num_integrate(i,t,e,v,q){if(q<0)throw new Error("max depth cannot be negative");function X(W,u,re,j,de,_e,Ue,te,ue,ce,Z){if(Z.nanEncountered)return NaN;let Le=re-u,Be=W(u+Le*.25),$e=W(re-Le*.25);if(isNaN(Be)){Z.nanEncountered=!0;return}if(isNaN($e)){Z.nanEncountered=!0;return}let ve=Le*(j+4*Be+de)/12,qe=Le*(de+4*$e+_e)/12,me=ve+qe,Q=(me-Ue)/15;if(Z.maxDepthCount>1e3*ue)return;if(ce>ue)return Z.maxDepthCount++,me+Q;if(Math.abs(Q)<te)return me+Q;let c=u+Le*.5,p=X(W,u,c,j,Be,de,ve,te*.5,ue,ce+1,Z);if(isNaN(p))return Z.nanEncountered=!0,NaN;let r=X(W,c,re,de,$e,_e,qe,te*.5,ue,ce+1,Z);return isNaN(r)?(Z.nanEncountered=!0,NaN):p+r}function K(W,u,re,j,de){let _e={maxDepthCount:0,nanEncountered:!1};j===void 0&&(j=1e-9),de===void 0&&(de=45);let Ue=W(u),te=W(.5*(u+re)),ue=W(re),ce=(Ue+4*te+ue)*(re-u)/6,Z=X(W,u,re,Ue,te,ue,ce,j,de,1,_e);if(_e.maxDepthCount>0&&U1(`integrate-adaptive-simpson: Warning: maximum recursion depth (${de}) reached ${_e.maxDepthCount} times`),_e.nanEncountered)throw new Error("Function does not converge over interval!");return Z}let H;try{H=K(i,t,e,v,q)}catch(W){if(W.message==="timeout")throw W;return rt.simpson(i,t,e)}return q0(H,12)},Ci(i){let e=.5772156649015329,v=0;for(let q=1;q<20;q++){let X=2*q;v+=(-1)**q*i**X/(X*rt.factorial(X))}return Math.log(i)+e+v},Si(i){let e=0;for(let v=0;v<20;v++){let q=2*v;e+=(-1)**v*i**(q+1)/((q+1)*rt.factorial(q+1))}return e},Ei(i){if(Number(i)===0)return-1/0;let t=30,e=.5772156649015329,v=0;for(let q=1;q<t;q++)v+=i**q/(q*rt.factorial(q));return e+Math.abs(Math.log(i))+v},Shi(i){let e=0,v,q;for(let X=0;X<30;X++)v=2*X,q=v+1,e+=i**q/(q*q*rt.factorial(v));return e},Chi(i){let e=.5772156649015329,v=function(q){return(Math.cosh(q)-1)/q};return Math.log(i)+e+rt.num_integrate(v,.002,i,.001)},Li(i){return rt.Ei(rt.bigLog(i))},gamma_incomplete(i,t){let e=i-1,v=0,q=t||0;for(let X=0;X<e;X++)v+=q**X/rt.factorial(X);return rt.factorial(e)*Math.exp(-q)*v},step(i){return i>0?1:i<0?0:.5},rect(i){let t=Math.abs(i);return t===.5?t:t>.5?0:1},sinc(i){return i.equals(0)?1:Math.sin(i)/i},tri(i){return i=Math.abs(i),i>=1?0:1-i},nthroot(i,t){if(i instanceof He||(i=new He(i.toString())),t instanceof He||(t=new He(t.toString())),t.equals(1))return i;let e=i.divide(new He(2)),v=new He(1e-15),q,X,K,H=t.clone().invert(),W=t.subtract(new He(1));do{let u=rt.bigpow(e,W),re=H.multiply(i.divide(u).subtract(e)).toDecimal(25);if(q=He.create(re),K)break;e=e.add(q),re=q.toDecimal(),K=X?X===re:!1,X=re}while(q.abs().gte(v));return e},sqrt(i){i instanceof He||(i=new He(i));let t,e,v,q,X=0,K=!1,H=new He(1e-20);t=i.divide(new He(2));let W=1e3;do{if(X>W)throw new Error(`Unable to calculate square root for ${i}`);t=t.add(i.divide(t)).divide(new He(2)),t=new He(t.decimal(30)),e=i.subtract(t.multiply(t)),q=v?v.equals(e):!1,(e.clone().abs().lessThan(H)||q)&&(K=!0),v=e,X++}while(!K);return t}},yn=(function(t){let e="1.1.16",{bigInt:v}=t,{bigDec:q}=t;q.set({precision:250});let X={},{PRIMES:K}=t.constants,{PRIMES_SET:H}=t.constants,W={};v1.LONG_PI=t.constants.LONG_PI,v1.LONG_E=t.constants.LONG_E,(function(){Me.CACHE.roots={};let y=40,n=40;for(let s=2;s<=y;s++)for(let w=2;w<=n;w++){let N=v(s).pow(w);Me.CACHE.roots[`${N}-${w}`]=s}})(),Object.defineProperty(C0,"TIMEOUT",{get:()=>Me.TIMEOUT,configurable:!0});let u=null,re=null,j=null,de=X.N=1,_e=X.P=2,Ue=X.S=3,te=X.EX=4,ue=X.FN=5,ce=X.PL=6,Z=X.CB=7,Le=X.CP=8,Be=Me.CONST_HASH="#",{PARENTHESIS:$e}=Me,{SQRT:ve}=Me,{ABS:qe}=Me,{FACTORIAL:me}=Me,{DOUBLEFACTORIAL:Q}=Me,c=[],p={},r=[],g=[],d=[];Object.defineProperty(dn,"suppress_errors",{get:()=>Me.suppress_errors,configurable:!0}),un.RESERVED=r,Y0.WARNINGS=g,Object.defineProperty(Y0,"SHOW_WARNINGS",{get:()=>Me.SHOW_WARNINGS,configurable:!0}),Object.defineProperty(cn,"EXPRESSIONS",{get:()=>c,configurable:!0}),fn.Settings=Me,K0._version=e,Object.defineProperty(K0,"C",{get:()=>re,configurable:!0}),d1.ALLOW_CHARS=Me.ALLOW_CHARS,d1.VALIDATION_REGEX=Me.VALIDATION_REGEX,wn.PRIMES_SET=H,A0.PRIMES=K,A0.PRIMES_SET=H;let S=function(a){return j(a)?S(a.multiplier.toDecimal()):Number(a)%1!==0};j=function(a){return a instanceof h};let A=function(a){return a instanceof Zt},D=function(a,y=null,n=null){if(n||={c:[],add(s){this.c.indexOf(s)===-1&&isNaN(s)&&this.c.push(s)}},j(a)){let{group:s}=a,w=a.previousGroup;if(s===te&&D(a.power,y,n),s===Le||s===Z||w===Le||w===Z)for(let N in a.symbols)Object.hasOwn(a.symbols,N)&&D(a.symbols[N],y,n);else if(s===Ue||w===Ue)a.value==="e"||a.value==="pi"||a.value===Me.IMAGINARY||n.add(a.value);else if(s===ce||w===ce)D(f1(a.symbols),y,n);else if(s===te)isNaN(Number(a.value))||n.add(a.value),D(a.power,y,n);else if(s===ue&&!y&&a.args)for(let N=0;N<a.args.length;N++)D(a.args[N],y,n)}return n.c.sort()},b=function(a,y){let n=new h(0);for(let s=0;s<a.length;s++){let w=a[s];n=u.add(n,j(w)?w:u.parse(w))}return y?Number(n):n},C=function(a,y){a=u.expand(a),y||={};let n=function(s,w){y[s]||=new h(0),y[s]=u.add(y[s],w.clone())};return a.each(s=>{s.isConstant("all")?n("constants",s):s.group===Ue?n(s.value,s):s.group===ue&&(s.fname===qe||s.fname==="")?C(s.args[0]):s.group===te||s.group===ue||n(D(s).join(" "),s)}),y},V=function(a,y){y||=a.length;for(let n=0;n<y;n++)a[n]||(a[n]=new h(0));return a},J=function(a){return a instanceof Mt},ie=function(a){return a instanceof St};m1.N=de,m1.P=_e,ln.S=Ue;let fe=function(a){return j(a)?a.multiplier.lessThan(0):a<0},Oe=function(a,y,n){let w={},N;for(let I=0;I<n.length;I++)w[n[I]]=new h(Math.floor(Math.random()*5)+1);return g0("PARSE2NUMBER",()=>{N=u.parse(a,w).equals(u.parse(y,w))}),N},ge=function(a,y,n){if(!y){let s=typeof a;if(s==="string"){let w=a;if(!/:?=/u.test(w))return!1;let N=Me.FUNCTION_REGEX.exec(w);if(!N)return!1;let[,I,P,B]=N;a=I,y=P.split(",").map(x=>x.trim()),n=B}else if(s==="function"){let w=a,N=w.name;return O0(N),h1(N)?!1:(re.Math2[N]=w,u.functions[N]=[void 0,w.length],d.includes(N)||d.push(N),!0)}else return!1}return a=a.trim(),O0(a),h1(a)?!1:(y||=D(u.parse(n)),y=y.map(s=>s.trim()),u.functions[a]=[u.mappedFunction,y.length,{name:a,params:y,body:n}],d.includes(a)||d.push(a),!0)},Ve=function(){for(let a of d)delete re.Math2[a],delete u.functions[a]},Qe=function(a){let y,n,s;if(a.group===ue&&a.fname===""?(y=h.unwrapPARENS(u.parse(a).toLinear()),n=u.parse(a.power)):a.group===_e&&(y=u.parse(a.value),n=u.parse(a.power)),y&&n&&y.group===de&&n.group===de&&y.multiplier.isNegative()){s=[];let N=h.toPolarFormArray(It(a))[0],I=u.arg(y),P=n.multiplier.den.toString(),B=n.multiplier.num.toString(),x="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let L=0;L<Number(P);L++){let z=It(u.parse(Dt("(({0})+2*pi*({1}))/({2})",I,L,P))).multiplier.toDecimal();s.push(It(u.parse(Dt(x,N,P,Me.IMAGINARY,z,B))))}return Mt.fromArray(s)}if(a.isConstant(!0,!0)){let w=a.sign(),N=It(a.abs()),I=u.sqrt(N);s=[I.clone(),I.negate()],w<0&&(s=s.map(P=>u.multiply(P,h.imaginary())))}else s=[u.parse(a)];return Mt.fromArray(s)},Ae=function(a,y,n){y=String(y);let s,w;if(a.group===Le){let P=u.expand(a.clone()).stripVar(y);s=u.subtract(a.clone(),P.clone()),w=P}else s=a.clone();let N=s.stripVar(y),I=u.divide(s.clone(),N.clone());return w||=new h(0),n?{a:N,x:I,ax:s,b:w}:[N,I,s,w]},Ge=function(a){let n="u",s=0,w=D(a);for(;!(r.indexOf(n)===-1&&w.indexOf(n)===-1);)n="u"+s++;for(let N=0,I=r.length;N<=I;N++)if(!r[N]){r[N]=n;break}return n};V0.RESERVED=r;let je=function(a){let y=D(a[0],null,null);for(let n=1,s=a.length;n<s;n++)y=y.concat(D(a[n]));return y=T1(y).sort(),y};L1.RESERVED=r,g1.Settings=Me;let tt=function(){let a={};for(let y in u.functions)Object.hasOwn(u.functions,y)&&(a[y]=u.functions[y][0]);return a},Xe=function(a,y,n){let s=[];a.each(w=>{let N,I;w.contains(y)?(N=w.stripVar(y),I=u.divide(w.clone(),N.clone()).power.toDecimal()):(N=w,I=0);let P=s[I];s[I]=P?u.add(P,N):N},!0);for(let w=0;w<s.length;w++)s[w]||=new h(0);return s},Je=function(a){if(Ht(a)){let y=new Mt([]);for(let n=0;n<a.length;n++)y.elements.push(Je(a[n]));return y}return j(a)?a:u.parse(a)};an.N=de;let nt=function(a){for(let y=0;y<a.length;y++)if(!(a[y].isPi()||a[y].isE())&&!a[y].isConstant(!0))return!1;return!0},Te=function(a,y,n){(y.isComposite()&&!a.isComposite()||y.isLinear()&&!a.isLinear())&&([a,y]=[y,a]);let s=new h(0);return a.isLinear()?a.each(w=>{if(y.isComposite())y.isLinear()?y.each(N=>{let I=u.multiply(u.parse(w),u.parse(N)),P=u.expand(u.parse(I),n);s=u.add(s,P)},!0):s=u.add(s,u.multiply(w,u.parse(y)));else{let N=u.multiply(u.parse(w),u.parse(y));s=u.add(s,u.expand(N,n))}},!0):s=u.multiply(a,y),s},F={DivisionByZero:A1,ParseError:H1,OutOfFunctionDomainError:_1,UndefinedError:r0,MaximumIterationsReached:ti,NerdamerTypeError:R1,ParityError:c1,OperatorError:b0,OutOfRangeError:ni,DimensionError:I1,InvalidVariableNameError:on,ValueLimitExceededError:ii,NerdamerValueError:j1,SolveError:ri,InfiniteLoopError:si,UnexpectedTokenError:Z1};o0.bigInt=v,o0.BIG_LOG_CACHE=t.constants.BIG_LOG_CACHE,o0.PRIMES=K,o0.NerdamerSymbol=h,o0.CB=Z,o0.P=_e,Me.FUNCTION_MODULES.push(rt),p1(rt),Math.sign||=function(y){return y=Number(y),y===0||isNaN(y)?y:y>0?1:-1},Math.cosh||=function(y){let n=Math.exp(y);return(n+1/n)/2},Math.sech||=function(y){return 1/Math.cosh(y)},Math.csch||=function(y){return 1/Math.sinh(y)},Math.coth||=function(y){return 1/Math.tanh(y)},Math.sinh||=function(y){let n=Math.exp(y);return(n-1/n)/2},Math.tanh||=function(y){if(y===1/0)return 1;if(y===-1/0)return-1;let n=Math.exp(2*y);return(n-1)/(n+1)},Math.asinh||=function(y){return y===-1/0?y:Math.log(y+Math.sqrt(y*y+1))},Math.acosh||=function(y){return Math.log(y+Math.sqrt(y*y-1))},Math.atanh||=function(y){return Math.log((1+y)/(1-y))/2},Math.trunc||=function(y){return isNaN(y)?NaN:y>0?Math.floor(y):Math.ceil(y)};function G(a,y=void 0,n=void 0,s=void 0){let w=y==="hash",N,I=w?void 0:y,P=I==="decimal"||I==="decimals"||I==="decimals_or_scientific";I==="decimals_or_scientific"&&typeof s>"u"&&(s=Me.DEFAULT_DECP);function B(x,L){switch(y){case"decimals":case"decimal":return N||=function(z){return!1},L?x.toDecimal(L):x.valueOf();case"recurring":{N||=function(mt){return mt.indexOf("'")!==-1};let z=x.toString(),he=/^-?\d+(?:\/\d+)?$/u.exec(z);if(he.length===0)return z;let Se=he[0].split("/"),Re=!1,Fe=Number(Se[0]);Fe<0&&(Fe=-Fe,Re=!0);let De=Number(Se[1]);De||=1;let Ze=Math.floor(Fe/De),xe=10*(Fe-Ze*De);for(Ze=`${Ze.toString()}.`;xe&&xe<De;)xe*=10,Ze+="0";let be="",lt=[],ut=0;for(;;){if(typeof lt[xe]<"u"){let Ft=be.slice(0,lt[xe]),dt=be.slice(lt[xe]),_t=`${Ze+Ft}'${dt}'`;return(Re?"-":"")+_t.replace("'0'","").replace(/\.$/u,"")}let mt=Math.floor(xe/De),At=xe-mt*De;lt[xe]=ut,be+=mt.toString(),ut+=1,xe=10*At}}case"mixed":{N||=function(lt){return lt.indexOf("/")!==-1};let z=x.toString(),he=/^-?\d+(?:\/\d+)?$/u.exec(z);if(he.length===0)return z;let Se=he[0].split("/"),Re=new v(Se[0]),Fe=new v(Se[1]);Fe.equals(0)&&(Fe=new v(1));let De=Re.divmod(Fe),{quotient:Ze}=De,{remainder:xe}=De,be=Se[0][0]==="-"||Ze.equals(0)||xe.equals(0)?"":"+";return(Ze.equals(0)?"":Ze.toString())+be+(xe.equals(0)?"":`${xe.toString()}/${Se[1]}`)}case"scientific":return N||=function(z){return!1},new jt(x.valueOf()).toString(Me.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{N||=function(Se){return!1};let z=x.valueOf(),he=new jt(z);return Math.abs(he.exponent)>=Me.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?he.toString(Me.SCIENTIFIC_MAX_DECIMAL_PLACES):L?x.toDecimal(L):z}default:return N||=function(z){return z.indexOf("/")!==-1},x.toString()}}if(j(a)){let x="",L="",z="",he=a.group||n,{value:Se}=a;if(!w){let xe=B(a.multiplier);String(xe)==="-1"&&String(a.multiplier)==="-1"&&(z="-",xe="1"),String(xe)!=="1"&&(x=xe);let be=a.power?B(a.power):"";String(be)!=="1"&&(j(be)?L=G(be,I):L=be)}switch(he){case de:{x="";let xe;I==="decimals_or_scientific"?xe=B(a.multiplier,s):s&&P?xe=a.multiplier.toDecimal(s):xe=B(a.multiplier),Se=String(a.multiplier)==="-1"?"1":xe,L="";break}case ce:Se=a.collectSymbols().map(xe=>{let be=G(xe,I,n,s);return be==="0"&&(be=""),be}).sort().join("+").replace(/\+-/gu,"-");break;case Le:Se=a.collectSymbols().map(xe=>{let be=G(xe,I,n,s);return be==="0"&&(be=""),be}).sort().join("+").replace(/\+-/gu,"-");break;case Z:Se=a.collectSymbols(xe=>{let be=xe.group;return(be===ce||be===Le)&&xe.power.equals(1)&&xe.multiplier.equals(1)?Xt(G(xe,I)):G(xe,I)}).join("*");break;case te:{let xe=a.previousGroup,be=a.power.group;xe===ce&&(Se=a.collectSymbols(G,I).join("+").replace("+-","-")),!(xe===de||xe===Ue||xe===ue)&&!w&&(Se=Xt(Se)),(be===Le||be===Z||be===ce||a.power.multiplier.toString()!=="1")&&L&&(L=Xt(L));break}}if(he===ue&&(Se=a.fname+Xt(a.args.map(xe=>G(xe,I)).join(","))),he===ue&&a.fname in W){let xe=G(a.args[0]),be=G(a.args[1]);a.args[0].isComposite()&&(xe=Xt(xe)),a.args[1].isComposite()&&(be=Xt(be)),Se=xe+W[a.fname]+be}let Re=typeof N=="function"?N(L):!1;if(L&&he!==te&&Re&&(L=Xt(L)),((he===Le||he===ce)&&(x&&String(x)!=="1"||z==="-")||(he===Z||he===Le||he===ce)&&L&&String(L)!=="1"||!w&&he===_e&&String(Se)==="-1"||a.fname===$e)&&(Se=Xt(Se)),s&&(y==="decimal"||(y==="decimals"||y==="decimals_or_scientific")&&x))if(x.toString().includes("e")){if(y!=="decimals_or_scientific"){let xe=Number(x),be=xe.toExponential(),lt=xe.toPrecision(s);x=be.length<lt.length?be:lt}}else x=q0(Number(x),s);let Fe=z+x,De=typeof N=="function"?N(x):!1;if(x&&De&&(Fe=Xt(Fe)),Number(L)<0&&(L=Xt(L)),x&&(Fe=`${Fe}*`),L){if(Se==="e"&&Me.E_TO_EXP)return`${Fe}exp${Xt(L)}`;L=Me.POWER_OPERATOR+L}he===te&&Se.charAt(0)==="-"&&(Se=Xt(Se));let Ze=Fe+Se;return a.parens&&(Ze=Xt(Ze)),Ze+L}if(J(a)){let x=a.elements.length,L=[];for(let z=0;z<x;z++)L.push(a.elements[z].text(y));return`[${L.join(",")}]`}try{return a.toString()}catch(x){if(x.message==="timeout")throw x;return""}}ct.EXPRESSIONS=c,ct.Settings=Me,ct.LaTeX=Nt,ct.text=G,ct.variables=D,ct.isVector=J,ct.isSymbol=j,ct.isExpression=A,ct.isNumericSymbol=F0,ct.isFraction=S,ct.isArray=Ht,Rt.bigInt=v,Rt.bigDec=q,Rt.isInt=yt,Rt.scientificToDecimal=W0,Rt.DivisionByZero=A1,Rt.Settings=Me;function h(a){S1();let y=a==="Infinity";if(!(this instanceof h))return new h(a);typeof a=="object"&&a!==null&&a instanceof q&&(a=a.toString());let n=String(a);return/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(n)||typeof a=="object"&&a!==null&&a instanceof q?(this.group=de,this.value=Be,this.multiplier=new He(a)):(this.group=Ue,O0(a),this.value=a,this.multiplier=new He(1),this.imaginary=a===Me.IMAGINARY,this.isInfinity=y),this.power=new He(1),this.args=void 0,this.fname=void 0,this.isImgSymbol=void 0,this}h.imaginary=function(){let y=new h(Me.IMAGINARY);return y.imaginary=!0,y},h.infinity=function(y=void 0){let n=new h("Infinity");return y===-1&&n.negate(),n},h.shell=function(y,n){let s=new h(n);return s.group=y,s.symbols={},s.length=0,s},h.unwrapSQRT=function(y,n){let s=y.power;if(y.fname===ve&&(y.isLinear()||n)){let w=y.args[0].clone();w.power=w.power.multiply(new He(1/2)),w.multiplier=w.multiplier.multiply(y.multiplier),y=w,n&&(y.power=s.multiply(new He(1/2)))}return y},h.hyp=function(y,n){return y||=new h(0),n||=new h(0),u.sqrt(u.add(u.pow(y.clone(),new h(2)),u.pow(n.clone(),new h(2))))},h.toPolarFormArray=function(y){let n=y.realpart(),s=y.imagpart(),w=h.hyp(n,s),N=n.equals(0)?u.parse("pi/2"):u.trig.atan(u.divide(s,n));return[w,N]},h.unwrapPARENS=function(y){if(y.fname===""){let n=y.args[0];return n.power=n.power.multiply(y.power),n.multiplier=n.multiplier.multiply(y.multiplier),y.fname===""?h.unwrapPARENS(n):n}return y},h.create=function(y,n){return n=n===void 0?1:n,u.parse(`(${y})^(${n})`)},h.prototype={pushMinus(){let a=this;if((this.group===Z||this.group===Le||this.group===ce)&&this.multiplier.lessThan(0)&&!Bt(this.power)){a=this.clone();let y=a.multiplier.clone();y.negate(),a.toUnitMultiplier();for(let n in a.symbols)if(Object.hasOwn(a.symbols,n)&&(a.symbols[n]=a.symbols[n].clone().negate(),a.group===Z))break;a.length>0&&a.each(n=>n.pushMinus()),a=u.parse(a),a=u.multiply(u.parse(y),a)}return a},getNth(a){let y=It(u.pow(u.parse(this.multiplier),u.parse(String(a)).invert())),n=u.parse(q0(y));return It(u.pow(n,u.parse(String(a)))).equals(u.parse(this.multiplier))?n:y},isToNth(a){let y=this.getNth(a),n=yt(y),s;return this.group===Z?(s=!0,this.each(w=>{w.isToNth(a)||(s=!1)})):s=this.group===de?!0:yt(u.divide(u.parse(this.power),u.parse(a))),n&&s},isSquare(){return this.isToNth(2)},isCube(){return this.isToNth(3)},isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)},powSimp(){if(this.group===Z){let a=[],y=this.multiplier.sign();if(this.each(x=>{let L=x.power;j(L)||L.equals(1)||a.push(L)}),a.length===0)return this.clone();let n=new He(C1(a)),s=this.multiplier.clone().abs(),w=rt.ifactor(s.valueOf()),N=new He(1),I=new He(1);for(let x in w){if(!Object.hasOwn(w,x))continue;let L=new He(w[x]);L.lessThan(n)||(L=L.divide(n).subtract(new He(1)),I=I.multiply(new He(x))),N=N.multiply(u.parse(`${Xt(x)}^${Xt(L)}`).multiplier)}let P=new h(I);this.each(x=>{x=x.clone(),x.power=x.power.divide(n),P=u.multiply(P,x)});let B=u.symfunction($e,[P]);return B.power=n,B.multiplier=y<0?N.negate():N,B}return this.clone()},equals(a){let y;return j(a)?y=a:y=new h(a),this.value===y.value&&this.power.equals(y.power)&&this.multiplier.equals(y.multiplier)&&this.group===y.group},abs(){let a=this.clone();return a.multiplier.abs(),a},gt(a){return j(a)||(a=new h(a)),this.isConstant()&&a.isConstant()&&this.multiplier.greaterThan(a.multiplier)},gte(a){return j(a)||(a=new h(a)),this.equals(a)||this.isConstant()&&a.isConstant()&&this.multiplier.greaterThan(a.multiplier)},lt(a){return j(a)||(a=new h(a)),this.isConstant()&&a.isConstant()&&this.multiplier.lessThan(a.multiplier)},lte(a){return j(a)||(a=new h(a)),this.equals(a)||this.isConstant()&&a.isConstant()&&this.multiplier.lessThan(a.multiplier)},isPoly(a=!1){let y=this.group,n=this.power;if(!yt(n)||Number(n)<0)return!1;if(y===de||y===Ue||this.isConstant(!0))return!0;let s=D(this);if(y===Z&&s.length===1){let w=s[0];if(!w)return!0;for(let N in this.symbols){if(!Object.hasOwn(this.symbols,N))continue;let I=this.symbols[N];if(I.group===ue&&!I.args[0].isConstant()||!I.contains(w)&&!I.isConstant(!0))return!1}return!0}if(this.isComposite()||y===Z&&a){if(!a&&s.length>1)return!1;for(let w in this.symbols)if(!this.symbols[w].isPoly(a))return!1;return!0}return!1},stripVar(a,y=!1){let n;return(this.group===ce||this.group===Ue)&&this.value===a?n=new h(y?0:this.multiplier):this.group===Z&&this.isLinear()?(n=new h(1),this.each(s=>{s.contains(a,!0)||(n=u.multiply(n,s.clone()))}),n.multiplier=n.multiplier.multiply(this.multiplier)):this.group===Le&&!this.isLinear()?n=new h(this.multiplier):this.group===Le&&this.isLinear()?(n=new h(0),this.each(s=>{if(!s.contains(a)){let w=s.clone();w.multiplier=w.multiplier.multiply(this.multiplier),n=u.add(n,w)}}),n.equals(0)&&(n=new h(this.multiplier))):this.group===te&&this.power.contains(a,!0)?n=new h(this.multiplier):this.group===ue&&this.contains(a)?n=new h(this.multiplier):n=this.clone(),n},toArray(a,y){y||={arr:[],add(s,w){let N=this.arr[w];this.arr[w]=N?u.add(N,s):s}};let n=this.group;if(n===Ue&&this.contains(a))y.add(new h(this.multiplier),this.power);else if(n===Z){let s=this.stripVar(a),w=u.divide(this.clone(),s.clone()),N=w.isConstant()?0:w.power;y.add(s,N)}else if(n===ce&&this.value===a)this.each((s,w)=>{y.add(s.stripVar(a),w)});else if(n===Le)this.each(s=>{s.toArray(a,y)});else{if(this.contains(a))throw new R1("Cannot convert to array! Exiting");y.add(this.clone(),0)}y=y.arr;for(let s=0;s<y.length;s++)y[s]||=new h(0);return y},hasFunc(a){let y=this.group===ue||this.group===te;if(y&&!a||y&&this.contains(a))return!0;if(this.symbols){for(let n in this.symbols)if(this.symbols[n].hasFunc(a))return!0}return!1},sub(a,y){a=j(a)?a.clone():u.parse(a),y=j(y)?y.clone():u.parse(y),(a.group===de||a.group===_e)&&Wt("Cannot substitute a number. Must be a variable");let n=!1,s=a.multiplier.equals(1),w=this.multiplier.clone(),N;if(this.value===a.value&&(this.group!==ce&&a.group!==ce||this.group===ce&&a.group===ce))(s||a.multiplier.equals(this.multiplier))&&(a.isLinear()?N=y:a.power.equals(this.power)&&(N=y,n=!0),a.multiplier.equals(this.multiplier)&&(w=new He(1)));else if(this.group===Z||this.previousGroup===Z)N=new h(1),this.each(I=>{let P=u.parse(I.sub(a,y));N=u.multiply(N,P)});else if(this.isComposite()){let I=this.clone();if(a.isComposite()&&I.isComposite()&&I.isLinear()&&a.isLinear()){let P=function(B,x){for(let L in B.symbols){if(!Object.hasOwn(B.symbols,L))continue;let z=B.symbols[L];if(z.isComposite()&&P(z,x)||z.equals(x))return!0}return!1};for(let B in a.symbols)if(Object.hasOwn(a.symbols,B)&&!P(I,a.symbols[B]))return I.clone();N=u.add(u.subtract(I.clone(),a),y)}else N=new h(0),I.each(P=>{N=u.add(N,P.sub(a,y))})}else if(this.group===te)N=u.parse(this.value).sub(a,y);else if(this.group===ue){let I=[];for(let P=0;P<this.args.length;P++){let B=this.args[P];j(B)||(B=u.parse(B)),I.push(B.sub(a,y))}N=u.symfunction(this.fname,I)}if(N){if(!n){let I=this.group===te?this.power.sub(a,y):u.parse(this.power);N=u.pow(N,I)}return N.multiplier=N.multiplier.multiply(w),N}return this.clone()},isMonomial(){if(this.group===Ue)return!0;if(this.group===Z){for(let a in this.symbols)if(this.symbols[a].group!==Ue)return!1}else return!1;return!0},isPi(){return this.group===Ue&&this.value==="pi"},sign(){return this.multiplier.sign()},isE(){return this.value==="e"},isSQRT(){return this.fname===ve},isConstant(a,y){if(y&&this.group===Z){for(let n in this.symbols)if(this.symbols[n].isConstant(!0))return!0}if(a==="functions"&&this.isComposite()){let n=!0;return this.each(s=>{s.isConstant(a,y)||(n=!1)},!0),n}if(a==="all"&&(this.isPi()||this.isE()))return!0;if(a&&this.group===ue){for(let n=0;n<this.args.length;n++)if(!this.args[n].isConstant(a))return!1;return!0}return a?F0(this):this.value===Be},isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let a in this.symbols)if(this.symbols[a].isImaginary())return!0}return!1},realpart(){if(this.isConstant())return this.clone();if(this.imaginary)return new h(0);if(this.isComposite()){let a=new h(0);return this.each(y=>{a=u.add(a,y.realpart())}),a}return this.isImaginary()?new h(0):this.clone()},imagpart(){if(this.group===Ue&&this.isImaginary()){let a=this;return this.power.isNegative()&&(a=this.clone(),a.power.negate(),a.multiplier.negate()),new h(a.multiplier)}if(this.isComposite()){let a=new h(0);return this.each(y=>{a=u.add(a,y.imagpart())}),a}return this.group===Z?this.stripVar(Me.IMAGINARY):new h(0)},isInteger(){return this.isConstant()&&this.multiplier.isInteger()},isLinear(a){if(a){if(this.isConstant()||!this.contains(a,!0))return!0;if(this.group===Ue)return this.value===a?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let y in this.symbols)if(!this.symbols[y].isLinear(a))return!1;return!0}return this.group===Z?this.symbols[a]?this.symbols[a].isLinear(a):!0:!1}return this.power.equals(1)},containsFunction(a){if(typeof a=="string"&&(a=[a]),this.group===ue&&a.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let y in this.symbols)if(this.symbols[y].containsFunction(a))return!0}return!1},multiplyPower(a){if(this.group===de&&this.multiplier.equals(1))return this;let y=this.power;if(this.group!==te&&j(a)&&a.group===de){let n=a.multiplier;this.group===de&&!n.isInteger()&&this.convert(_e),this.power=y.equals(1)?n.clone():y.multiply(n),this.group===_e&&yt(this.power)&&(this.value=Number(this.value)**Number(this.power),this.toLinear(),this.convert(de))}else{this.group!==te&&(y=new h(y),this.convert(te));let n=u.multiply(y,a);this.power=n}return this},setPower(a,y=!1){if(this.group===de&&this.multiplier.equals(1))return this;if(this.group===te&&!j(a))this.group=this.previousGroup,delete this.previousGroup,this.group===de?(this.multiplier=new He(this.value),this.value=Be):this.power=a;else{let n=!1;j(a)&&(a.group===de?a=a.multiplier:n=!0);let s=n?te:_e;this.power=a,this.group===de&&s&&this.convert(s,y)}return this},isInverse(){return this.group===te?this.power.multiplier.lessThan(0):Number(this.power)<0},clone(a=void 0){let y=this,n=a||new h(0),s=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],w=s.length,N;if(y.symbols){n.symbols={};for(let I in y.symbols)Object.hasOwn(y.symbols,I)&&(n.symbols[I]=y.symbols[I].clone())}for(N=0;N<w;N++)y[s[N]]!==void 0&&(n[s[N]]=y[s[N]]);return n.power=y.power.clone(),n.multiplier=y.multiplier.clone(),y.isConversion&&(n.isConversion=y.isConversion),y.isUnit&&(n.isUnit=y.isUnit),n},toUnitMultiplier(a=!1){return this.multiplier.num=new v(this.multiplier.num.isNegative()&&a?-1:1),this.multiplier.den=new v(1),this},toLinear(){return this.power.equals(1)?this:(this.setPower(new He(1)),this)},each(a,y=!1){if(this.symbols)for(let n in this.symbols){if(!Object.hasOwn(this.symbols,n))continue;let s=this.symbols[n];if(s.group===ce&&y)for(let w in s.symbols)Object.hasOwn(s.symbols,w)&&a.call(n,s.symbols[w],w);else a.call(this,s,n)}else a.call(this,this,this.value)},valueOf(){return this.group===de?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:G(this,"decimals")},contains(a,y=!1){a=String(a);let n=this.group;if(this.value===a)return!0;if(this.symbols){for(let s in this.symbols)if(this.symbols[s].contains(a,y))return!0}if(n===ue||this.previousGroup===ue){for(let s=0;s<this.args.length;s++)if(this.args[s].contains(a,y))return!0}return n===te&&(y&&this.power.contains(a,y)||this.value===a)?!0:this.value===a},negate(){return this.multiplier.negate(),(this.group===Le||this.group===ce)&&this.distributeMultiplier(),this},invert(a=!1,y=!1){return a||(this.multiplier=this.multiplier.invert()),j(this.power)?this.power.negate():this.group===Z&&y?this.each(n=>n.invert()):this.power&&this.group!==de&&this.power.negate(),this},distributeMultiplier(a=!1){let y=a?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&y&&this.group!==Z&&!this.multiplier.equals(1)){for(let n in this.symbols){if(!Object.hasOwn(this.symbols,n))continue;let s=this.symbols[n];s.multiplier=s.multiplier.multiply(this.multiplier),s.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent(){if(!this.power.equals(1)){let a=this.power;for(let y in this.symbols){if(!Object.hasOwn(this.symbols,y))continue;let n=this.symbols[y];n.group===te?n.power=u.multiply(n.power,new h(a)):j(this.symbols[y].power)?this.symbols[y].power=u.multiply(this.symbols[y].power,new h(a)):this.symbols[y].power=this.symbols[y].power.multiply(a)}this.toLinear()}return this},convert(a,y=void 0){if(a>ue){let n=this.clone();this.symbols={},a===Z?n.toUnitMultiplier():this.toUnitMultiplier(),this.group===ue&&(n.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[n.keyForGroup(a)]=n,this.group=a,this.length=1}else if(a===te)this.group===de&&this.multiplier.equals(1)||(this.group!==te&&(this.previousGroup=this.group),this.group===de?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=G(this,"hash"),this.group=te);else if(a===de){let n=this.multiplier.toDecimal();this.symbols&&=void 0,new h(this.group===_e?Number(n)*Number(this.value)**Number(this.power):n).clone(this)}else a===_e&&this.group===de&&(this.value=y?this.multiplier.num.toString():Math.abs(Number(this.multiplier.num.toString())),this.toUnitMultiplier(!y),this.group=_e);return this},insert(a,y){if(j(a)||Wt(`Object ${a} is not of type NerdamerSymbol!`),this.symbols){let{group:n}=this;if(n>ue){let s=a.keyForGroup(n),w=s in this.symbols?this.symbols[s]:!1;if(y==="add"){let N=s;w?(this.symbols[N]=u.add(w,a),this.symbols[N].multiplier.equals(0)&&(delete this.symbols[N],this.length--,this.length===0&&(this.convert(de),this.multiplier=new He(0)))):(this.symbols[s]=a,this.length++)}else a.group===_e&&yt(a.power)&&a.convert(de),a.group===te?(a.parens=a.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(a.multiplier.clone().abs()),a.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(a.multiplier),a.toUnitMultiplier()),w&&(a=u.multiply(L0(this.symbols,s),a),a.isConstant()&&(this.multiplier=this.multiplier.multiply(a.multiplier),a=new h(1)),this.length--),a.isOne(!0)?a.multiplier.lessThan(0)&&this.negate():(this.symbols[s]=a,this.length++);this.length===0&&this.convert(de),(this.group===Le||this.group===Z)&&this.updateHash()}}return this},attach(a){if(Ht(a)){for(let y=0;y<a.length;y++)this.insert(a[y],"add");return this}return this.insert(a,"add")},combine(a){if(Ht(a)){for(let y=0;y<a.length;y++)this.insert(a[y],"multiply");return this}return this.insert(a,"multiply")},updateHash(){if(this.group!==de)if(this.group===ue){let a="",{args:y}=this,n=this.fname===$e;for(let w=0;w<y.length;w++)a+=(w===0?"":",")+G(y[w]);let s=n?"":this.fname;this.value=s+(n?a:Xt(a))}else this.group===Ue||this.group===ce||(this.value=G(this,"hash"))},keyForGroup(a){let y=this.group,n;if(y===de)n=this.value;else if(y===Ue||y===_e)a===ce?n=this.power.toDecimal():n=this.value;else if(y===ue)a===ce?n=this.power.toDecimal():n=G(this,"hash");else{if(y===ce)return a===Z?n=G(this,"hash"):a===Le?this.power.equals(1)?n=this.value:n=Xt(G(this,"hash"))+Me.POWER_OPERATOR+this.power.toDecimal():a===ce?n=this.power.toString():n=this.value,n;y===Le?(a===Le&&(n=G(this,"hash")),a===ce?n=this.power.toDecimal():n=this.value):y===Z?a===ce?n=this.power.toDecimal():n=G(this,"hash"):y===te&&(a===ce?n=G(this.power):n=G(this,"hash"))}return n},collectSymbols(a,y,n,s){let w=[];if(this.symbols)for(let N in this.symbols){if(!Object.hasOwn(this.symbols,N))continue;let I=this.symbols[N];s&&(I.group===ce||I.group===Le)?w=w.concat(I.collectSymbols()):w.push(a?a(I,y):I)}else w.push(this);return n===null&&(n=void 0),w.sort(n)},collectSummandSymbols(a,y,n,s){let w=[];if(!this.symbols||this.group===Z)w.push(this);else for(let N in this.symbols){if(!Object.hasOwn(this.symbols,N))continue;let I=this.symbols[N];s&&(I.group===ce||I.group===Le)?w=w.concat(I.collectSymbols()):w.push(a?a(I,y):I)}return n===null&&(n=void 0),w.sort(n)},latex(a){return Nt.latex(this,a)},text(a=void 0){return G(this,a)},isOne(a=!1){let y=a?"absEquals":"equals";return this.group===de?this.multiplier[y](1):this.power.equals(0)},isComposite(){let a=this.group,y=this.previousGroup;return a===Le||a===ce||y===ce||y===Le},isCombination(){let a=this.group,y=this.previousGroup;return a===Z||y===Z},lessThan(a){return this.multiplier.lessThan(a)},greaterThan(a){return j(a)||(a=new h(a)),!this.isConstant(!0)||!a.isConstant(!0)?!1:this.multiplier.greaterThan(a.multiplier)},getDenom(){let a,y;if(y=this.clone(),this.group===Z&&this.power.lessThan(0)&&(y=u.expand(y)),y.power.lessThan(0)||y.group===te&&y.power.multiplier.lessThan(0)){let n=u.parse(y.multiplier.den);a=y.toUnitMultiplier(),a.power.negate(),a=u.multiply(n,a)}else if(y.group===Z){a=u.parse(y.multiplier.den);for(let n in y.symbols){if(!Object.hasOwn(y.symbols,n))continue;let s=y.symbols[n];(Number(s.power)<0||s.group===te&&s.power.multiplier.lessThan(0))&&(a=u.multiply(a,y.symbols[n].clone().invert()))}}else a=u.parse(y.multiplier.den);return a},getNum(){let a,y;return y=this.clone(),y.group===Z&&y.power.lessThan(0)&&(y=u.expand(y)),y.power.greaterThan(0)&&y.group!==Z||y.group===te&&y.power.multiplier.greaterThan(0)?a=u.multiply(u.parse(y.multiplier.num),y.toUnitMultiplier()):y.group===Z?(a=u.parse(y.multiplier.num),y.each(n=>{(Number(n.power)>0||n.group===te&&n.power.multiplier.greaterThan(0))&&(a=u.multiply(a,n.clone()))})):a=u.parse(y.multiplier.num),a},toString(){return this.text()}};function R(){let a=this,y={},n={names:[],actions:[]};function s(l,o){this.start=l,this.end=o}s.prototype.isConstant=function(){return this.start.isConstant()&&this.end.isConstant()},s.prototype.text=function(){return`${G(this.start)}:${G(this.end)}`};function w(l,o,f){if(this.type=o,this.value=l,f!==void 0&&(this.column=f+1),o===w.OPERATOR){let k=B[l];for(let $ in k)Object.hasOwn(k,$)&&(this[$]=k[$])}else o===w.FUNCTION&&(this.precedence=w.MAX_PRECEDENCE,this.leftAssoc=!1)}w.prototype.toString=function(){return this.is_prefix?`\`${this.value}`:this.value},w.OPERATOR="OPERATOR",w.VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL",w.FUNCTION="FUNCTION",w.UNIT="UNIT",w.KEYWORD="KEYWORD",w.MAX_PRECEDENCE=999,this.classes={Collection:bt,Slice:s,Token:w};let N={prec:void 0,cos(l,o){let f=u.parse(String(Math.cos(l)*Math.cosh(o))),k=u.parse(String(Math.sin(l)*Math.sinh(o)));return u.subtract(f,u.multiply(k,h.imaginary()))},sin(l,o){let f=u.parse(String(Math.sin(l)*Math.cosh(o))),k=u.parse(String(Math.cos(l)*Math.sinh(o)));return u.subtract(f,u.multiply(k,h.imaginary()))},tan(l,o){let f=u.parse(String(Math.sin(2*l)/(Math.cos(2*l)+Math.cosh(2*o)))),k=u.parse(String(Math.sinh(2*o)/(Math.cos(2*l)+Math.cosh(2*o))));return u.add(f,u.multiply(k,h.imaginary()))},sec(l,o){let f=this.removeDen(this.cos(l,o));return u.subtract(f[0],u.multiply(f[1],h.imaginary()))},csc(l,o){let f=this.removeDen(this.sin(l,o));return u.add(f[0],u.multiply(f[1],h.imaginary()))},cot(l,o){let f=this.removeDen(this.tan(l,o));return u.subtract(f[0],u.multiply(f[1],h.imaginary()))},acos(l,o){let f=this.fromArray([l,o]),k=u.pow(f.clone(),new h(2)),$=u.expand(k),pe=u.multiply(kt(u.subtract(new h(1),$)),h.imaginary()),se=u.expand(u.add(f.clone(),pe)),ne=ae(se);return u.expand(u.multiply(h.imaginary().negate(),ne))},asin(l,o){return u.subtract(u.parse("pi/2"),this.acos(l,o))},atan(l,o){if(l.equals(0)&&(o.equals(1)||o.equals(-1)))return u.parse(`${h.infinity()}*${Me.IMAGINARY}*${o}`);let f=N.fromArray([l,o]),k=u.expand(u.multiply(h.imaginary(),f.clone())),$=ae(u.expand(u.subtract(new h(1),k.clone()))),pe=ae(u.expand(u.add(new h(1),k.clone())));return u.expand(u.multiply(u.divide(h.imaginary(),new h(2)),u.subtract($,pe)))},asec(l,o){let f=this.removeDen([l,o]);return f[1].negate(),this.acos(...f)},acsc(l,o){let f=this.removeDen([l,o]);return f[1].negate(),this.asin(...f)},acot(l,o){let f=this.removeDen([l,o]);return f[1].negate(),this.atan(...f)},cosh(l,o){let f=u.parse(String(Math.cosh(l)*Math.cos(o))),k=u.parse(String(Math.sinh(l)*Math.sin(o)));return u.add(f,u.multiply(k,h.imaginary()))},sinh(l,o){let f=u.parse(String(Math.sinh(l)*Math.cos(o))),k=u.parse(String(Math.cosh(l)*Math.sin(o)));return u.add(f,u.multiply(k,h.imaginary()))},tanh(l,o){let f=u.parse(String(Math.sinh(2*l)/(Math.cos(2*o)+Math.cosh(2*l)))),k=u.parse(String(Math.sin(2*o)/(Math.cos(2*o)+Math.cosh(2*l))));return u.subtract(f,u.multiply(k,h.imaginary()))},sech(l,o){let f=this.removeDen(this.cosh(l,o));return u.subtract(f[0],u.multiply(f[1],h.imaginary()))},csch(l,o){let f=this.removeDen(this.sinh(l,o));return u.subtract(f[0],u.multiply(f[1],h.imaginary()))},coth(l,o){let f=this.removeDen(this.tanh(l,o));return u.add(f[0],u.multiply(f[1],h.imaginary()))},acosh(l,o){let f=this.fromArray([l,o]),k=kt(u.add(f.clone(),new h(1))),$=kt(u.subtract(f.clone(),new h(1)));return u.expand(ae(u.add(f,u.expand(u.multiply(k,$)))))},asinh(l,o){let f=this.fromArray([l,o]),k=kt(u.add(new h(1),u.expand(u.pow(f.clone(),new h(2)))));return u.expand(ae(u.add(f,k)))},atanh(l,o){let f=this.fromArray([l,o]),k=ae(u.add(f.clone(),new h(1))),$=ae(u.subtract(new h(1),f));return u.expand(u.divide(u.subtract(k,$),new h(2)))},asech(l,o){let f=this.removeDen([l,o]);return f[1].negate(),this.acosh(...f)},acsch(l,o){let f=this.removeDen([l,o]);return f[1].negate(),this.asinh(...f)},acoth(l,o){let f=this.removeDen([l,o]);return f[1].negate(),this.atanh(...f)},sqrt(l){let o=l.realpart(),f=l.imagpart(),k=h.hyp(o,f),$=u.add(o.clone(),k),pe=kt(u.multiply(new h(2),$.clone()));return u.add(u.divide($.clone(),pe.clone()),u.multiply(u.divide(f,pe),h.imaginary()))},log(l,o){let f=ae(h.hyp(l,o)),k=Me.USE_BIG?new h(q.atan2(o.multiplier.toDecimal(),l.multiplier.toDecimal())):Math.atan2(o,l),$=u.parse(k);return u.add(f,u.multiply(h.imaginary(),$))},erf(l,o){return u.symfunction("erf",[l])},removeDen(l){let o,f;Ht(l)?(o=l[0],f=l[1]):(o=l.realpart(),f=l.imagpart());let k=o**2+f**2,$=u.parse(String(o/k)),pe=u.parse(String(f/k));return[$,pe]},fromArray(l){return u.add(l[0],u.multiply(h.imaginary(),l[1]))},evaluate(l,o){let f,k,$=l.power.sign();if(l.power=l.power.abs(),l.power.greaterThan(1)&&(l=u.expand(l)),$<0){let pe=this.removeDen(l);f=pe[0],k=pe[1]}else f=l.realpart(),k=l.imagpart();return f.isConstant("all")&&k.isConstant("all")?this[o](f,k):u.symfunction(o,[l])}},I=this.trig={cos(l){if(l.equals("pi")&&l.multiplier.den.equals(2))return new h(0);if(Me.PARSE2NUMBER){if(l.equals(new h(Me.PI/2)))return new h(0);if(l.isConstant())return Me.USE_BIG?new h(q.cos(l.multiplier.toDecimal())):new h(Math.cos(l.valueOf()));if(l.isImaginary())return N.evaluate(l,"cos")}if(l.equals(0))return new h(1);let o,f=!1,k=ye(l.multiplier.toDecimal()),$=l.multiplier.abs();if(l.multiplier=$,l.isPi()&&l.isLinear())if(yt($))o=new h(Bt($)?1:-1);else{let pe=Number($.num),se=Number($.den);se===2?o=new h(0):se===3?(o=u.parse("1/2"),f=!0):se===4?(o=u.parse("1/sqrt(2)"),f=!0):se===6?(o=u.parse("sqrt(3)/2"),f=!0):o=u.symfunction("cos",[l])}return f&&(k===2||k===3)&&o.negate(),o||=u.symfunction("cos",[l]),o},sin(l){if(Me.PARSE2NUMBER){if(l.isConstant())return Number(l.multiplier.toDecimal())%Math.PI===0?new h(0):Me.USE_BIG?new h(q.sin(l.multiplier.toDecimal())):new h(Math.sin(l.valueOf()));if(l.isImaginary())return N.evaluate(l,"sin")}if(l.equals(0))return new h(0);let o,f=!1,k=ye(l.multiplier.toDecimal()),$=l.multiplier.sign(),pe=l.multiplier.abs();if(l.multiplier=pe,l.equals("pi"))o=new h(0);else if(l.isPi()&&l.isLinear())if(yt(pe))o=new h(0);else{let se=pe.num,ne=pe.den;ne.equals(2)?(o=new h(1),f=!0):ne.equals(3)?(o=u.parse("sqrt(3)/2"),f=!0):ne.equals(4)?(o=u.parse("1/sqrt(2)"),f=!0):ne.equals(6)?(o=u.parse("1/2"),f=!0):o=u.multiply(new h($),u.symfunction("sin",[l]))}return o||=u.multiply(new h($),u.symfunction("sin",[l])),f&&(k===3||k===4)&&o.negate(),o},tan(l){if(Me.PARSE2NUMBER){if(Number(l.multiplier.toDecimal())%Math.PI===0&&l.isLinear())return new h(0);if(l.isConstant())return Me.USE_BIG?new h(q.tan(l.multiplier.toDecimal())):new h(Math.tan(l.valueOf()));if(l.isImaginary())return N.evaluate(l,"tan")}let o,f=!1,k=ye(l.multiplier.toDecimal()),$=l.multiplier;if(l.multiplier=$,l.isPi()&&l.isLinear())if(yt($))o=new h(0);else{let pe=$.num,se=$.den;if(se.equals(2))throw new r0(`tan is undefined for ${l.toString()}`);se.equals(3)?(o=u.parse("sqrt(3)"),f=!0):se.equals(4)?(o=new h(1),f=!0):se.equals(6)?(o=u.parse("1/sqrt(3)"),f=!0):o=u.symfunction("tan",[l])}return o||=u.symfunction("tan",[l]),f&&(k===2||k===4)&&o.negate(),o},sec(l){if(Me.PARSE2NUMBER)return l.isConstant()?Me.USE_BIG?new h(new q(1).dividedBy(q.cos(l.multiplier.toDecimal()))):new h(rt.sec(l.valueOf())):l.isImaginary()?N.evaluate(l,"sec"):u.parse(Dt("1/cos({0})",l));let o,f=!1,k=ye(l.multiplier.toDecimal()),$=l.multiplier.abs();if(l.multiplier=$,l.isPi()&&l.isLinear())if(yt($))o=new h(Bt($)?1:-1);else{let pe=$.num,se=$.den;if(se.equals(2))throw new r0(`sec is undefined for ${l.toString()}`);se.equals(3)?(o=new h(2),f=!0):se.equals(4)?(o=u.parse("sqrt(2)"),f=!0):se.equals(6)?(o=u.parse("2/sqrt(3)"),f=!0):o=u.symfunction("sec",[l])}return f&&(k===2||k===3)&&o.negate(),o||=u.symfunction("sec",[l]),o},csc(l){if(Me.PARSE2NUMBER)return l.isConstant()?Me.USE_BIG?new h(new q(1).dividedBy(q.sin(l.multiplier.toDecimal()))):new h(rt.csc(l.valueOf())):l.isImaginary()?N.evaluate(l,"csc"):u.parse(Dt("1/sin({0})",l));let o,f=!1,k=ye(l.multiplier.toDecimal()),$=l.multiplier.sign(),pe=l.multiplier.abs();if(l.multiplier=pe,l.isPi()&&l.isLinear()){if(yt(pe))throw new r0(`csc is undefined for ${l.toString()}`);{let se=pe.num,ne=pe.den;ne.equals(2)?(o=new h(1),f=!0):ne.equals(3)?(o=u.parse("2/sqrt(3)"),f=!0):ne.equals(4)?(o=u.parse("sqrt(2)"),f=!0):ne.equals(6)?(o=new h(2),f=!0):o=u.multiply(new h($),u.symfunction("csc",[l]))}}return o||=u.multiply(new h($),u.symfunction("csc",[l])),f&&(k===3||k===4)&&o.negate(),o},cot(l){if(Me.PARSE2NUMBER)return Number(l.multiplier.toDecimal())%(Math.PI/2)===0?new h(0):l.isConstant()?Me.USE_BIG?new h(new q(1).dividedBy(q.tan(l.multiplier.toDecimal()))):new h(rt.cot(l.valueOf())):l.isImaginary()?N.evaluate(l,"cot"):u.parse(Dt("1/tan({0})",l));let o,f=!1,k=ye(l.multiplier.toDecimal()),$=l.multiplier;if(l.multiplier=$,l.isPi()&&l.isLinear()){if(yt($))throw new r0(`cot is undefined for ${l.toString()}`);{let pe=$.num,se=$.den;se.equals(2)?o=new h(0):se.equals(3)?(o=u.parse("1/sqrt(3)"),f=!0):se.equals(4)?(o=new h(1),f=!0):se.equals(6)?(o=u.parse("sqrt(3)"),f=!0):o=u.symfunction("cot",[l])}}return o||=u.symfunction("cot",[l]),f&&(k===2||k===4)&&o.negate(),o},acos(l){if(Me.PARSE2NUMBER){if(l.isConstant()){if(l.gt(1)||l.lt(-1)){let o=l.toString();return at(It(`pi/2-asin(${o})`))}return Me.USE_BIG?new h(q.acos(l.multiplier.toDecimal())):new h(Math.acos(l.valueOf()))}if(l.isImaginary())return N.evaluate(l,"acos")}return u.symfunction("acos",[l])},asin(l){if(Me.PARSE2NUMBER){if(l.isConstant()){if(l.gt(1)||l.lt(-1)){let o=Me.IMAGINARY,f=l.multiplier.toDecimal();return at(It(`${o}*log(sqrt(1-${f}^2)-${o}*${f})`))}return Me.USE_BIG?new h(q.asin(l.multiplier.toDecimal())):new h(Math.asin(l.valueOf()))}if(l.isImaginary())return N.evaluate(l,"asin")}return u.symfunction("asin",[l])},atan(l){let o;if(l.equals(0))o=new h(0);else{if(Me.PARSE2NUMBER)return l.isConstant()?Me.USE_BIG?new h(q.atan(l.multiplier.toDecimal())):new h(Math.atan(l.valueOf())):l.isImaginary()?N.evaluate(l,"atan"):u.symfunction("atan",[l]);l.equals(-1)?o=u.parse("-pi/4"):o=u.symfunction("atan",[l])}return o},asec(l){if(Me.PARSE2NUMBER){if(l.equals(0))throw new _1("Input is out of the domain of sec!");if(l.isConstant())return I.acos(l.invert());if(l.isImaginary())return N.evaluate(l,"asec")}return u.symfunction("asec",[l])},acsc(l){if(Me.PARSE2NUMBER){if(l.isConstant())return I.asin(l.invert());if(l.isImaginary())return N.evaluate(l,"acsc")}return u.symfunction("acsc",[l])},acot(l){if(Me.PARSE2NUMBER){if(l.isConstant())return u.add(u.parse("pi/2"),I.atan(l).negate());if(l.isImaginary())return N.evaluate(l,"acot")}return u.symfunction("acot",[l])},atan2(l,o){if(l.equals(0)&&o.equals(0))throw new r0("atan2 is undefined for 0, 0");return Me.PARSE2NUMBER&&l.isConstant()&&o.isConstant()?new h(Math.atan2(l,o)):u.symfunction("atan2",[l,o])}},P=this.trigh={cosh(l){if(Me.PARSE2NUMBER){if(l.isConstant())return new h(Math.cosh(l.valueOf()));if(l.isImaginary())return N.evaluate(l,"cosh")}return u.symfunction("cosh",[l])},sinh(l){if(Me.PARSE2NUMBER){if(l.isConstant())return new h(Math.sinh(l.valueOf()));if(l.isImaginary())return N.evaluate(l,"sinh")}return u.symfunction("sinh",[l])},tanh(l){if(Me.PARSE2NUMBER){if(l.isConstant())return new h(Math.tanh(l.valueOf()));if(l.isImaginary())return N.evaluate(l,"tanh")}return u.symfunction("tanh",[l])},sech(l){return Me.PARSE2NUMBER?l.isConstant()?new h(Math.sech(l.valueOf())):l.isImaginary()?N.evaluate(l,"sech"):u.parse(Dt("1/cosh({0})",l)):u.symfunction("sech",[l])},csch(l){return Me.PARSE2NUMBER?l.isConstant()?new h(Math.csch(l.valueOf())):l.isImaginary()?N.evaluate(l,"csch"):u.parse(Dt("1/sinh({0})",l)):u.symfunction("csch",[l])},coth(l){return Me.PARSE2NUMBER?l.isConstant()?new h(Math.coth(l.valueOf())):l.isImaginary()?N.evaluate(l,"coth"):u.parse(Dt("1/tanh({0})",l)):u.symfunction("coth",[l])},acosh(l){let o;return Me.PARSE2NUMBER&&l.isImaginary()?o=N.evaluate(l,"acosh"):Me.PARSE2NUMBER?o=It(u.parse(Dt(`${Me.LOG}(({0})+sqrt(({0})^2-1))`,l.toString()))):o=u.symfunction("acosh",[l]),o},asinh(l){let o;return Me.PARSE2NUMBER&&l.isImaginary()?o=N.evaluate(l,"asinh"):Me.PARSE2NUMBER?o=It(u.parse(Dt(`${Me.LOG}(({0})+sqrt(({0})^2+1))`,l.toString()))):o=u.symfunction("asinh",[l]),o},atanh(l){let o;return Me.PARSE2NUMBER&&l.isImaginary()?o=N.evaluate(l,"atanh"):Me.PARSE2NUMBER?o=It(u.parse(Dt(`(1/2)*${Me.LOG}((1+({0}))/(1-({0})))`,l.toString()))):o=u.symfunction("atanh",[l]),o},asech(l){let o;return Me.PARSE2NUMBER&&l.isImaginary()?o=N.evaluate(l,"asech"):Me.PARSE2NUMBER?o=It(ae(u.add(l.clone().invert(),kt(u.subtract(u.pow(l,new h(-2)),new h(1)))))):o=u.symfunction("asech",[l]),o},acsch(l){let o;return Me.PARSE2NUMBER&&l.isImaginary()?o=N.evaluate(l,"acsch"):Me.PARSE2NUMBER?o=It(u.parse(Dt(`${Me.LOG}((1+sqrt(1+({0})^2))/({0}))`,l.toString()))):o=u.symfunction("acsch",[l]),o},acoth(l){let o;return Me.PARSE2NUMBER&&l.isImaginary()?o=N.evaluate(l,"acoth"):Me.PARSE2NUMBER?l.equals(1)?o=h.infinity():o=It(u.divide(ae(u.divide(u.add(l.clone(),new h(1)),u.subtract(l.clone(),new h(1)))),new h(2))):o=u.symfunction("acoth",[l]),o}};this.units={};let B={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(l){return l}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(l){return u.symfunction(Me.DOUBLEFACTORIAL,[l])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(l){return be(l)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(l){return u.divide(l,new h(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(l){return l}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(l){return l}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(l){return l.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},x={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},L=this.functions={cos:[I.cos,1],sin:[I.sin,1],tan:[I.tan,1],sec:[I.sec,1],csc:[I.csc,1],cot:[I.cot,1],acos:[I.acos,1],asin:[I.asin,1],atan:[I.atan,1],arccos:[I.acos,1],arcsin:[I.asin,1],arctan:[I.atan,1],asec:[I.asec,1],acsc:[I.acsc,1],acot:[I.acot,1],atan2:[I.atan2,2],acoth:[P.acoth,1],asech:[P.asech,1],acsch:[P.acsch,1],sinh:[P.sinh,1],cosh:[P.cosh,1],tanh:[P.tanh,1],asinh:[P.asinh,1],sech:[P.sech,1],csch:[P.csch,1],coth:[P.coth,1],acosh:[P.acosh,1],atanh:[P.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[_t,1],radians:[$t,1],degrees:[Lt,1],min:[O,-1],max:[T,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[dt,1],tri:[void 0,1],sign:[ee,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[be,1],factorial:[be,1],continuedFraction:[lt,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[le,[1,2]],scientific:[m0,[1,2]],mod:[mt,2],pfactor:[y0,1],vector:[R0,-1],matrix:[H0,-1],NerdamerSet:[h0,-1],imatrix:[pt,-1],parens:[Ze,-1],sqrt:[kt,1],cbrt:[a0,1],nthroot:[u0,2],log:[ae,[1,2]],expand:[it,1],abs:[xe,1],invert:[qn,1],determinant:[P0,1],size:[D0,1],transpose:[Tt,1],dot:[j0,2],cross:[Yt,2],vecget:[i0,2],vecset:[p0,3],vectrim:[Pt,[1,2]],matget:[Ot,3],matset:[k0,4],matgetrow:[Jt,2],matsetrow:[$0,3],matgetcol:[d0,2],matsetcol:[X0,3],rationalize:[c0,1],IF:[At,3],isIn:[Ft,2],realpart:[ft,1],imagpart:[s1,1],conjugate:[o1,1],arg:[m,1],polarform:[E,1],rectform:[M,1],sort:[oe,[1,2]],integer_part:[void 0,1],union:[On,2],contains:[Tn,2],intersection:[Cn,2],difference:[Rn,2],intersects:[Ln,2],isSubset:[Un,2],primes:[xn,2],print:[$n,-1]};this.error=Wt;let z=function(l){let o=Me.FUNCTION_MODULES,f=o.length;for(let k=0;k<f;k++){let $=o[k];if(l in $)return $[l]}return Wt(`The function ${l} is undefined!`)};this.override=function(o,f){y[o]||=[],y[o].push(this[o]),this[o]=f},this.restore=function(o){this[o]&&=y[o].pop()},this.extend=function(o,f,k){let $=this;if(typeof this[o]=="function"&&typeof f=="function"){let se=this[o];this[o]=function(Ee,Ne){return j(Ee)&&j(Ne)&&!k?se.call($,Ee,Ne):f.call($,Ee,Ne,se)}}},this.symfunction=function(o,f){let k=new h(o);return k.group=ue,typeof f=="object"&&(f=[].slice.call(f)),k.args=f,k.fname=o===$e?"":o,k.updateHash(),k},this.callfunction=function(o,f,k=void 0){let $=L[o];$||Wt(`Nerdamer currently does not support the function ${o}`);let pe=$[1]||k,se=$[0],ne;if(f instanceof Array||(f=f===void 0?[]:[f]),pe!==-1){let Ne=Ht(pe),Ie=Ne?pe[0]:pe,we=Ne?pe[1]:pe,ze=f.length,gt=`${o} requires a {0} of {1} arguments. {2} provided!`;ze<Ie&&Wt(Dt(gt,"minimum",Ie,ze)),ze>we&&Wt(Dt(gt,"maximum",we,ze))}let Ee=O1(f);return se?ne=se.apply($[2],f):(se=z(o),Me.PARSE2NUMBER&&Ee?ne=Ce(se.apply(se,f)):ne=u.symfunction(o,f)),ne},this.operator_filter_regex=(function(){let o=`^\\${Object.keys(B).filter(f=>f.length===1).join("\\")}`;return new RegExp(`([${o}])\\s+([${o}])`)})(),this.setOperator=function(o,f=void 0,k=void 0){let $=o.operator;if(B[$]=o,f&&(this[o.action]=f),a[$]=o.operation,!o.action&&!(o.prefix||o.postif)&&(o.action=$),k==="over"||k==="under"){let{precedence:pe}=o;for(let se in B){if(!Object.hasOwn(B,se))continue;let ne=B[se];(k==="over"?ne.precedence>=pe:ne.precedence>pe)&&ne.precedence++}}},this.getOperator=function(o){return B[o]},this.aliasOperator=function(o,f){let k={},$=B[o];for(let pe in $)Object.hasOwn($,pe)&&(k[pe]=$[pe]);k.operator=f,this.setOperator(k)},this.getOperators=function(){return B},this.getBrackets=function(){return x};let he=function(o,f){o=String(o);for(let k=0;k<n.actions.length;k++)o=n.actions[k].call(f,o);for(o=o.replace(/\s+/gu," "),/e/giu.test(o)&&(o=o.replace(/-+\d+\.?\d*e\+?-?\d+/giu,k=>W0(k)),o=o.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,k=>W0(k))),o=o.replace(Me.IMPLIED_MULTIPLICATION_REGEX,(k,$,pe,se,ne)=>{let Ee=ne.charAt(se),Ne="",Ie="*";return Ee.match(/[+\-/*]/u)||(Ne=ne.charAt(se-1)),Ne.match(/[a-z]/iu)&&(Ie=""),$+Ie+pe}).replace(/(?<varname>[a-z0-9_]+)/giu,(k,$)=>Me.USE_MULTICHARACTER_VARS===!1&&!($ in L)&&isNaN($)?$.split("").join("*"):$).replace(/\)\(/gu,")*(")||"0";;){let k=o;if(o=o.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,($,pe,se,ne,Ee)=>{let Ne=pe||ne,Ie=se||Ee;return Ne in L?Ne+Ie:`${Ne}*${Ie}`}),k===o)break}return o};this.initConstants=function(){this.CONSTANTS={E:new h(Me.E),PI:new h(Me.PI)}},this.prettyPrint=function(o){if(Array.isArray(o)){let f=o,k=f.map($=>u.prettyPrint($)).join(", ");return f.type==="vector"?`vector<${k}>`:`(${k})`}return o.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(o,...f){if(Me.callPeekers){let k=this.peekers[o],$=f.map(Gn);for(let pe=0;pe<k.length;pe++)k[pe].apply(null,$)}},this.tokenize=function(o){o=String(o),o=o.trim().replace(/\s+/gu," ");for(let wt in x){if(!Object.hasOwn(x,wt))continue;let qt=new RegExp(x[wt].is_close?`\\s+\\${wt}`:`\\${wt}\\s+`,"g");o=o.replace(qt,wt)}let f=0,k=o.length,$=0,pe=[],se=[pe],ne=se[0],Ee=0,Ne=[],Ie=!1,we,ze=" ",gt="",vt=",",We="-",ke="*",et=function(wt=void 0,qt=void 0){let Ct=[];wt!==void 0&&(Ct.type=wt),Ct.column=qt,se.push(Ct),ne.push(Ct),ne=Ct,Ee++},Ke=function(){se.pop(),ne=se[--Ee]},st=function(wt){wt=wt===void 0?f:wt;let qt=wt+1;for(;o.charAt(qt++)in B;);return o.substring(wt,qt-1)},Et=function(wt){let qt=f-wt.length,Ct=[],e0=wt.charAt(0),z0=wt.length,I0;for(I0=1;I0<z0;I0++){let P1=wt.charAt(I0),D1=e0+P1;D1 in B?e0=D1:(Ct.push(new w(e0,w.OPERATOR,qt+I0)),e0=P1)}return Ct.push(new w(e0,w.OPERATOR,qt+I0)),Ct},ht=function(wt,qt=void 0){qt===void 0&&(qt=o.substring($,wt)),qt in u.units?ne.push(new w(qt,w.UNIT,$)):qt!==""&&ne.push(new w(qt,w.VARIABLE_OR_LITERAL,$))},Ut=function(wt){ne.push(new w(wt,w.FUNCTION,$))},Kt=function(wt){$=wt+1},N0=function(){$=$+we.length-2,f=$-1};for(;f<k;f++){let wt=o.charAt(f);if(wt in B){ht(f);let Ct=ne[0]&&rn(ne[0])&&wt===ke;Ie&&$<f&&!(wt===vt||Ct)&&(Ie=!1,Ke()),Kt(f+1),we=st(f),N0(),ne.push(...Et(we))}else if(wt in x){let qt=x[wt];if(qt.is_open){Ne.push([qt,$]);let Ct=o.substring($,f);Ct in L?Ut(Ct):Ct!==""&&ne.push(new w(Ct,w.VARIABLE_OR_LITERAL,$)),et(qt.maps_to,f)}else if(qt.is_close){let Ct=Ne.pop();if(Ct){if(Ct[0].id!==qt.id-1)throw new c1("Parity error")}else throw new c1(`Missing open bracket for bracket at: ${f+1}`);ht(f),Ke()}Kt(f)}else if(wt===ze){let qt=o.substring($,f),Ct=o.charAt(f+1);if(Ie){if(qt in B)ne.push(new w(qt,w.OPERATOR,f));else{ht(void 0,qt),Ke();let e0=Ct in B;(e0&&B[Ct].value===We||!e0)&&ne.push(new w(ke,w.OPERATOR,f))}Ie=!1}else{let e0=o.substring($,f);e0 in L?(Ie=!0,Ut(e0),et()):e0 in B?ne.push(new w(e0,w.OPERATOR,f)):(ht(void 0,e0),Ct=o.charAt(f+1),qt!==gt&&Ct!==gt&&!(qt in B)&&!(Ct in B)&&ne.push(new w(ke,w.OPERATOR,f)))}Kt(f)}}if(Ne.length){let wt=Ne.pop();throw new c1(`Missing closed bracket for bracket at ${wt[1]+1}`)}return ht(f),pe},this.toRPN=function(o){let f=o.type,k=o.length,$,pe,se=[],ne=[],Ee=[],Ne=function(we,ze){for(;we.length;)ze.push(we.pop())};for($=0;$<k;$++){let Ie=o[$];if(Ie.type!==w.OPERATOR)break;if(!Ie.prefix)throw new b0("Not a prefix operator");Ie.is_prefix=!0,ne.push(Ie)}for(;$<k;$++){if(pe=o[$],pe.type===w.OPERATOR){let Ie=pe;if(Ie.overloaded){let we=o[$+1];we&&we.type===w.VARIABLE_OR_LITERAL&&(Ie.postfix=!1,Ie.action=Ie.overloadAction,Ie.leftAssoc=Ie.overloadLeftAssoc)}for(;ne.length;){let we=ne[ne.length-1];if(!(we.precedence>Ie.precedence||!Ie.leftAssoc&&we.precedence===Ie.precedence))break;se.push(ne.pop())}if((f==="vector"||f==="set")&&"vectorFn"in Ie&&(Ie.action=Ie.vectorFn),Ie.postfix){let we=o[$-1];if(we){if(we.type===w.OPERATOR&&!we.postfix)throw new b0(`Unexpected prefix operator '${we.value}'! at ${we.column}`)}else throw new b0(`Unexpected prefix operator '${pe.value}'! at ${pe.column}`)}else{let we;do{let ze=o[$+1];if(we=ze?ze.type===w.OPERATOR:!1,we){if(!ze.prefix)throw new b0(`A prefix operator was expected at ${ze.column}`);ze.is_prefix=!0,Ee.push(ze),$++}}while(we)}for(Ie.is_prefix?Ee.push(Ie):ne.push(Ie);Ee.length&&(Ie.leftAssoc||!Ie.leftAssoc&&Ee[Ee.length-1].precedence>=Ie.precedence);)ne.push(Ee.pop())}else if(pe.type===w.VARIABLE_OR_LITERAL){se.length===0&&Ne(Ee,ne),se.push(pe);let Ie=ne[ne.length-1];(!Ie||!Ie.leftAssoc)&&Ne(Ee,se)}else pe.type===w.FUNCTION?ne.push(pe):pe.type===w.UNIT&&se.push(pe);if(Array.isArray(pe)){let Ie=pe;se.push(this.toRPN(pe)),Ie.type&&se.push(new w(Ie.type,w.FUNCTION,Ie.column))}}return Ne(ne,se),Ne(Ee,se),se},this.parseRPN=function(o,f){try{f||={};for(let se in f)Object.hasOwn(f,se)&&(f[se]=u.parse(f[se],{}));Me.PARSE2NUMBER&&("e"in f||(f.e=new h(Me.E)),"pi"in f||(f.pi=new h(Me.PI)));let k=[],$;for(let se=0,ne=o.length;se<ne;se++)if($=o[se],Array.isArray($)&&($=this.parseRPN($,f)),$)if($.type===w.OPERATOR)if($.is_prefix||$.postfix)k.push($.operation(k.pop()));else{let Ee=k.pop(),Ne=k.pop();if(typeof Ne>"u")throw new b0(`${$} is not a valid postfix operator at ${$.column}`);let Ie=$.action==="comma";Ne instanceof v0&&!Ie&&(Ne=Mt.fromSet(Ne)),Ee instanceof v0&&!Ie&&(Ee=Mt.fromSet(Ee)),this.callPeekers("pre_operator",Ne,Ee,$);let we=u[$.action](Ne,Ee);this.callPeekers("post_operator",we,Ne,Ee,$),k.push(we)}else if($.type===w.FUNCTION){let Ee=k.pop(),{parent:Ne}=Ee;Ee instanceof bt||(Ee=bt.create(Ee));let Ie=$.value,we=Ee.getItems();this.callPeekers("pre_function",Ie,we);let ze=u.callfunction(Ie,we);this.callPeekers("post_function",ze,Ie,we);let gt=k[k.length-1],vt=o[se+1],We=vt&&vt.type===w.OPERATOR&&vt.value===",";Ne&&(ze.parent=Ne),k.push(ze)}else{let Ee,Ne=$.value;if(Ne in Me.ALIASES)$=u.parse(Me.ALIASES[$]);else if($.type===w.VARIABLE_OR_LITERAL)$=new h(Ne);else if($.type===w.UNIT){let Ie=new h(Ne);Ie.isUnit=!0,$=Ie}Ne in u.CONSTANTS?(Ee=$,$=new h(u.CONSTANTS[Ne])):Ne in f&&Ne!==f[Ne].toString()?(Ee=$,$=f[Ne].clone()):Ne in p&&(Ee=$,$=p[Ne].clone()),Ee&&($.subbed=Ee),k.push($)}let pe=k[0];if(["undefined","string","number"].indexOf(typeof pe)!==-1)throw new Z1("Unexpected token!");return pe}catch(k){if(k.message==="timeout")throw k;[_1].forEach(se=>{if(k instanceof se){let ne=k.column;throw new se(`${k.message}${ne?`: ${ne}`:""}`)}});let pe=k.column;throw new H1(`${k.message}${pe?`: ${pe}`:""}`)}};function Se(l){this.type=l.type,this.value=l.value,this.left=l.left,this.right=l.right}Se.prototype.toString=function(){let o=this.left?`${this.left.toString()}---`:"",f=this.right?`---${this.right.toString()}`:"";return`${o}(${this.value})${f}`},Se.prototype.toHTML=function(o,f){o||=0,f=typeof f>"u"?4:f;let k=function(Ee){return" ".repeat(f*Ee)},$="",pe=this.left?`${k(o+1)}<li>
${this.left.toHTML(o+2,f)}${k(o+1)}</li> 
`:"",se=this.right?`${k(o+1)}<li>
${this.right.toHTML(o+2,f)}${k(o+1)}</li>
`:"";return $=`${k(o)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${k(o)}
`,(pe||se)&&($+=`${k(o)}<ul>
${pe}${se}${k(o)}</ul>
`),$},this.tree=function(o){let f=[];for(let k=0;k<o.length;k++){let $=o[k];if(Array.isArray($)){$=this.tree($),f.push($);continue}if($.type===w.OPERATOR)if($.is_prefix||$.postfix){let pe=$.is_prefix?"left":"right",se=f.pop();$=new Se($),$[pe]=se,f.push($)}else $=new Se($),$.right=f.pop(),$.left=f.pop(),f.push($);else if($.type===w.FUNCTION){$=new Se($);let pe=f.pop();if($.right=pe,$.value==="object"){let se=f[f.length-1];if(se){for(;se.right;)se=se.right;se.right=$;continue}}f.push($)}else f.push(new Se($))}return f[0]},this.parse=function(o,f){o=he(o,this),f||={};let k=this.tokenize(o),$=this.toRPN(k);return this.parseRPN($,f)},this.toObject=function(o){return function k($){let pe=[];for(let se=0,ne=$.length;se<ne;se++){let Ee=$[se],Ne=Ee.value;if(Ee.type===w.VARIABLE_OR_LITERAL)pe.push(new h(Ne));else if(Ee.type===w.FUNCTION){se++;let Ie=u.symfunction(Ne,k($[se]));Ie.isConversion=!0,pe.push(Ie)}else Ee.type===w.OPERATOR?pe.push(Ne):pe.push(k(Ee))}return pe}(u.tokenize(o))};let Re=function(o){let f=0,k=[[]];for(let $=0,pe=o.length;$<pe;$++)o[$]===","?(f++,k[f]=[]):k[f].push(o[$]);return k},Fe=function(l){return l.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(o,f)=>f||o)},De=function(l){let o=[];for(;l.length;){let f=l.shift(),k=l[0],$=Ht(k),pe=k==="-";if(f==="^"&&(k==="+"?l.shift():$&&k[0]==="+"&&k.shift(),$&&k.length===1&&l.unshift(l.shift()[0])),f==="^"&&($&&k[0]==="-"||pe)){let se=o.pop(),ne=o[o.length-1],Ee="1";ne==="*"?(o.pop(),Ee=o.pop()):Ht(ne)&&(Ee=o.pop()),o.push(Ee,"/",se,f),$?k.shift():l.shift(),$&&k.length===1&&o.push(l.shift()[0])}else o.push(f)}return o};this.toTeX=function(o,f){f||={};let k=f.decimals===!0?"decimals":void 0,$=typeof o=="string"?this.toObject(o):o,pe=[],se=typeof f.cdot>"u"?"\\cdot":f.cdot;if($=De($),Ht($)){let ne=[],Ee,Ne;for(let Ie=0;Ie<$.length;Ie++)Ee=$[Ie],$[Ie+1]==="^"?(Ne=$[Ie+2],ne.push(`${Nt.braces(this.toTeX([Ee]))}^${Nt.braces(this.toTeX([Ne]))}`),Ie+=2):ne.push(Ee);$=ne}for(let ne=0,Ee=$.length;ne<Ee;ne++){let Ne=$[ne];if(Ne==="*"&&(Ne=se),j(Ne))if(Ne.group===ue){let{fname:Ie}=Ne,we;if(Ie===ve)we=`\\sqrt${Nt.braces(this.toTeX(Ne.args))}`;else if(Ie===qe)we=Nt.brackets(this.toTeX(Ne.args),"abs");else if(Ie===$e)we=Nt.brackets(this.toTeX(Ne.args),"parens");else if(Ie===Me.LOG10)we=`\\${Me.LOG10_LATEX}\\left( ${this.toTeX(Ne.args)}\\right)`;else if(Ie===Me.LOG2)we=`\\${Me.LOG2_LATEX}\\left( ${this.toTeX(Ne.args)}\\right)`;else if(Ie===Me.LOG1P)we=`\\${Dt(Me.LOG1P_LATEX,this.toTeX(Ne.args))}`;else if(Ie==="integrate"){let ze=Re(Ne.args),gt=Nt.braces(this.toTeX(ze[0])),vt=this.toTeX(ze[1]);we=`\\int ${gt}\\, d${vt}`}else if(Ie==="defint"){let ze=Re(Ne.args),gt=Nt.braces(this.toTeX(ze[0])),vt=this.toTeX(ze[3]),We=this.toTeX(ze[1]),ke=this.toTeX(ze[2]);we=`\\int\\limits_{${We}}^{${ke}} ${gt}\\, d${vt}`}else if(Ie==="diff"){let ze=Re(Ne.args),gt="",vt=Nt.braces(this.toTeX(ze[0]));if(ze.length===1){let We=[];for(let ke=0;ke<ze[0].length;ke++)ze[0][ke].group===3&&We.push(ze[0][ke].value);We.sort(),gt=We.length>0?`\\frac{d}{d ${We[0]}}`:"\\frac{d}{d x}"}else ze.length===2?gt=`\\frac{d}{d ${ze[1]}}`:gt=`\\frac{d^{${ze[2]}}}{d ${this.toTeX(ze[1])}^{${ze[2]}}}`;we=`${gt}\\left(${vt}\\right)`}else if(Ie==="sum"||Ie==="product"){let ze=[[],[],[],[]],gt=0;for(let vt=0;vt<Ne.args.length;vt++){if(Ne.args[vt]===","){gt++;continue}ze[gt].push(Ne.args[vt])}we=(Ie==="sum"?"\\sum_":"\\prod_")+Nt.braces(`${this.toTeX(ze[1])} = ${this.toTeX(ze[2])}`),we+=`^${Nt.braces(this.toTeX(ze[3]))}${Nt.braces(this.toTeX(ze[0]))}`}else if(Ie==="limit"){let ze=this.toTeX.bind(this),gt=u,vt=Re(Ne.args).map(We=>Array.isArray(We)?gt.toTeX(We.join("")):ze(String(We)));we=`\\lim_${Nt.braces(`${vt[1]}\\to ${vt[2]}`)} ${Nt.braces(vt[0])}`}else Ie===me||Ie===Q?we=this.toTeX(Ne.args)+(Ie===me?"!":"!!"):we=Nt.latex(Ne,k);pe.push(we)}else pe.push(Nt.latex(Ne,k));else Ht(Ne)?pe.push(Nt.brackets(this.toTeX(Ne))):Ne==="/"?pe.push(Nt.frac(Fe(pe.pop()),Fe(this.toTeX([$[++ne]])))):pe.push(Ne)}return pe.join(" ")};function Ze(l){return Me.PARSE2NUMBER?l:u.symfunction("parens",[l])}function xe(l){if(l.isInfinity)return h.infinity();if(l.multiplier.lessThan(0)&&l.multiplier.negate(),l.isImaginary()){let f=l.realpart(),k=l.imagpart();if(f.isConstant()&&k.isConstant())return kt(u.add(u.pow(f,new h(2)),u.pow(k,new h(2))))}else{if(F0(l)||Bt(l.power))return l;if(W1(l)&&typeof l.value=="string"&&l.value.startsWith("baseunit_"))return l}if(l.isComposite()){let f=[];l.each($=>{f.push($.multiplier)}),rt.QGCD.apply(null,f).lessThan(0)&&(l.multiplier=l.multiplier.multiply(new He(-1)),l.distributeMultiplier())}let o=u.parse(l.multiplier);return l.toUnitMultiplier(),u.multiply(o,u.symfunction(qe,[l]))}function be(l){let o;if(J(l)){let f=new Mt;return l.each((k,$)=>{f.set($-1,be(k))}),f}if(ie(l)){let f=new St;return l.each((k,$,pe)=>{f.set($,pe,be(k))}),f}if(Me.PARSE2NUMBER&&l.isConstant())return yt(l)?o=rt.bigfactorial(l):o=rt.gamma(l.multiplier.add(new He(1)).toDecimal()),o=Ce(o),o;if(l.isConstant()&&l.getDenom().equals(2)){let k=l.getNum(),$,pe,se;l.multiplier.isNegative()?(se=u.subtract(k.negate(),new h(1)).multiplier.divide(new He(2)),$=u.pow(new h(-4),new h(se)).multiplier.multiply(rt.bigfactorial(se)),pe=rt.bigfactorial(new He(2).multiply(se))):(se=u.add(k,new h(1)).multiplier.divide(new He(2)),$=rt.bigfactorial(new He(2).multiply(se)),pe=u.pow(new h(4),new h(se)).multiplier.multiply(rt.bigfactorial(se)));let ne=$.divide(pe);return u.multiply(u.parse("sqrt(pi)"),new h(ne))}return u.symfunction(me,[l])}function lt(l,o){let f=It(l);if(f.isConstant()){let k=rt.continuedFraction(f,o),$=Mt.fromArray(k.fractions.map(pe=>new h(pe)));return Mt.fromArray([new h(k.sign),new h(k.whole),$])}return u.symfunction("continuedFraction",[l,o])}function ut(l){let o=It(l);return o.isConstant()?new h(rt.erf(o)):o.isImaginary()?N.erf(l):u.symfunction("erf",[l])}function mt(l,o){if(l.isConstant()&&o.isConstant()){let k=new h(1);return k.multiplier=k.multiplier.multiply(l.multiplier.mod(o.multiplier)),k}let f=u.divide(l.clone(),o.clone());return yt(f)?new h(0):u.symfunction("mod",[l,o])}function At(l,o,f){return typeof l!="boolean"&&F0(l)&&(l=!!Number(l)),l?o:f}function Ft(l,o){if(ie(l)){for(let f=0,k=l.rows();f<k;f++)for(let $=0,pe=l.cols();$<pe;$++)if(l.elements[f][$].equals(o))return new h(1)}else if(l.elements){for(let f=0,k=l.elements.length;f<k;f++)if(l.elements[f].equals(o))return new h(1)}return new h(0)}function dt(l){return Me.PARSE2NUMBER?l.isConstant()?new h(rt.sinc(l)):u.parse(Dt("sin({0})/({0})",l)):u.symfunction("sinc",[l])}function _t(l){return l.fname===Me.LOG&&l.isLinear()?u.pow(l.args[0],h.create(l.multiplier)):u.parse(Dt("e^({0})",l))}function $t(l){return u.parse(Dt("({0})*pi/180",l))}function Lt(l){return u.parse(Dt("({0})*180/pi",l))}function Gt(l){let o,f,k;if(l.group===ue&&l.fname===""?(o=h.unwrapPARENS(u.parse(l).toLinear()),f=u.parse(l.power)):l.group===_e&&(o=u.parse(l.value),f=u.parse(l.power)),o&&f&&o.group===de&&f.group===de){k=[];let $=h.toPolarFormArray(l),pe=u.parse(o).abs().toString(),se=m(o).toString(),ne=f.multiplier.den.toString(),Ee=f.multiplier.num.toString(),Ne="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let Ie=0;Ie<Number(ne);Ie++){let we=It(u.parse(Dt("(({0})+2*pi*({1}))/({2})",se,Ie,ne))).multiplier.toDecimal();k.push(It(u.parse(Dt(Ne,pe,ne,Me.IMAGINARY,we,Ee))))}return Mt.fromArray(k)}if(l.isConstant(!0)){let $=l.sign(),pe=It(l.abs()),se=u.sqrt(pe);k=[se.clone(),se.negate()],$<0&&(k=k.map(ne=>u.multiply(ne,h.imaginary())))}else k=[u.parse(l)];return Mt.fromArray(k)}function c0(l){if(l.isComposite()){let o=new h(0),f,k,$,pe,se,ne,Ee,Ne;return l.each(Ie=>{f=Ie.getNum(),k=Ie.getDenom(),$=o.getNum(),pe=o.getDenom(),se=u.multiply(k,$),ne=u.multiply(f,pe),Ee=u.expand(u.add(se,ne)),Ne=u.multiply(pe,k),o=u.divide(Ee,Ne)},!0),o}return l}function kt(l){j(l)||(l=u.parse(l));let o=u.symfunction("sqrt",[l]);if(l.group===te)return u.symfunction(ve,[l]);l.fname===""&&l.power.equals(1)&&(l=l.args[0]);let f=l.multiplier.sign()<0;if(Me.PARSE2NUMBER){if(l.isConstant()&&!f)return new h(q.sqrt(l.multiplier.toDecimal()));if(l.isImaginary())return N.sqrt(l);if(l.group===Ue)return u.symfunction("sqrt",[l])}let k,$,pe=l.isConstant();if(l.group===Z&&l.isLinear()){let se=kt(new h(l.multiplier));for(let ne in l.symbols){if(!Object.hasOwn(l.symbols,ne))continue;let Ee=l.symbols[ne];se=u.multiply(se,kt(Ee))}$=se}else if(l.fname===ve){let se=l.args[0],ne=l.multiplier;se.setPower(l.power.multiply(new He(.25))),$=se,ne.equals(1)||($=u.multiply(kt(u.parse(ne)),$))}else if(!l.power.isInteger())l.setPower(l.power.multiply(new He(.5))),$=l;else if(Number(l.multiplier)<0&&l.group===Ue){let se=u.parse(l.multiplier).negate(),ne=u.parse(l).toUnitMultiplier().negate();$=u.multiply(u.symfunction(Me.SQRT,[ne]),kt(se))}else{let se=l.power.sign();l.power=l.power.abs(),pe&&l.multiplier.lessThan(0)&&(k=h.imaginary(),l.multiplier=l.multiplier.abs());let ne=Number(l.multiplier.toDecimal()),Ee=Math.abs(ne),Ne=Math.sqrt(Ee),Ie;if(yt(Ne))Ie=new h(Ne);else if(yt(ne)){let we=rt.ifactor(ne),ze=1;for(let gt in we){if(!Object.hasOwn(we,gt))continue;let vt=we[gt],We=vt-vt%2;if(We){let ke=Number(gt)**We;ze*=Number(gt)**(We/2),ne/=ke}}Ie=u.multiply(u.symfunction(ve,[new h(ne)]),new h(ze))}else{let we=[new h(l.multiplier.num),new h(l.multiplier.den)],ze=[new h(1),new h(1)],gt=[new h(1),new h(1)],vt=u;for(let We=0;We<2;We++){let ke=we[We];y0(ke).each(et=>{et=h.unwrapPARENS(et);let Ke=et.clone().toLinear(),st=Number(et.power),Et=st%2,ht=(st-Et)/2;ze[We]=vt.multiply(ze[We],vt.pow(Ke,new h(ht))),gt[We]=vt.multiply(gt[We],kt(vt.pow(Ke,new h(Et))))})}Ie=u.divide(u.multiply(ze[0],gt[0]),u.multiply(ze[1],gt[1]))}l=l.toUnitMultiplier(!0),l.isOne()?$=l:Bt(l.power.toString())?$=u.pow(l.clone(),new h(.5)):$=u.symfunction(ve,[l]),se<0&&$.power.negate(),Ie&&($=u.multiply(Ie,$)),k&&($=u.multiply(k,$))}return fe&&Me.PARSE2NUMBER&&$.text()!==o.text()?u.parse($):$}function a0(l){if(!l.isConstant(!0)){let o,f=Number(l.power)/3,k=u.pow(u.parse(l.multiplier),new h(1/3)),$=l.toUnitMultiplier();return yt(f)?o=u.pow($.toLinear(),u.parse(String(f))):$.group===Z?(o=new h(1),$.each(pe=>{o=u.multiply(o,a0(pe))})):o=u.symfunction("cbrt",[$]),u.multiply(k,o)}return u0(l,new h(3))}function m0(l,o){return l.scientific=o||10,l}function u0(l,o,f=void 0,k=void 0){if(o=It(u.parse(o)),o.equals(0))throw new r0("Unable to calculate nthroots of zero");if(Number(l)<0&&Bt(o))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!l.isConstant(!0)){let ne=[l,o];return typeof f<"u"&&ne.push(f),typeof k<"u"&&ne.push(k),u.symfunction("nthroot",ne)}l.group!==de&&(l=It(l)),typeof k>"u"&&(k=!0),f||=25;let $=l.sign(),pe,se;if($<0&&(l=xe(l)),yt(l)&&o.isConstant())return Number(l)<18446744073709552e3?se=He.create(Number(l)**(1/Number(o))):se=rt.nthroot(l,o),k?pe=new h(se):pe=new h(se.toDecimal(f)),u.multiply(new h($),pe)}function y0(l){if(l.greaterThan(9999999999998891e26)||l.equals(-1))return l;if(l.equals(Math.PI))return new h(Math.PI);l=It(l.clone());let o;if(l.isConstant()){o=new h(1);let f=l.toString();if(yt(f)){let k=rt.ifactor(f);for(let $ in k){if(!Object.hasOwn(k,$))continue;let pe=k[$];o=u.multiply(o,u.symfunction("parens",[new h($).setPower(new He(pe))]))}}else{let k=y0(new h(l.multiplier.num)),$=y0(new h(l.multiplier.den));o=u.multiply(u.symfunction("parens",[k]),u.symfunction("parens",[$]).invert())}}else o=u.symfunction("pfactor",[l]);return o}function ft(l){return l.realpart()}function s1(l){return l.imagpart()}function o1(l){let o=l.realpart(),f=l.imagpart();return u.add(o,u.multiply(f.negate(),h.imaginary()))}function m(l){let o=l.realpart(),f=l.imagpart();return o.isConstant()&&f.isConstant()?f.equals(0)&&o.equals(1)?u.parse("0"):f.equals(1)&&o.equals(0)?u.parse("pi/2"):f.equals(0)&&o.equals(-1)?u.parse("pi"):f.equals(-1)&&o.equals(0)?u.parse("-pi/2"):f.equals(1)&&o.equals(1)?u.parse("pi/4"):f.equals(1)&&o.equals(-1)?u.parse("pi*3/4"):f.equals(-1)&&o.equals(1)?u.parse("-pi/4"):f.equals(-1)&&o.equals(-1)?u.parse("-pi*3/4"):new h(Math.atan2(Number(f),Number(o))):u.symfunction("atan2",[f,o])}function E(l){let o=h.toPolarFormArray(l),f=o[1],k=o[0],$=u.parse(Dt("e^({0}*({1}))",Me.IMAGINARY,f));return u.multiply(k,$)}function M(l){let o=l.clone();try{let f=Ae(l,"e",!0),k=u.divide(f.x.power,h.imaginary()),$=It(I.tan(k)),pe=u.pow(f.a,new h(2)),se=$.getDenom(!0),ne=$.getNum();return h.hyp(ne,se).equals(f.a)?u.add(se,u.multiply(h.imaginary(),ne)):o}catch(f){if(f.message==="timeout")throw f;return o}}function _(l,o){o.forEach(ne=>{ne.numVal=It(ne).multiplier});let f,k,$,pe,se;for(;;){if(f=o.length,f<2)return o[0];k=o.pop(),$=o[f-2],(l==="min"?k.numVal<$.numVal:k.numVal>$.numVal)&&(o.pop(),o.push(k))}}function T(...l){return u1(l)?l[0]:O1(l)?new h(Math.max.apply(null,l)):Me.SYMBOLIC_MIN_MAX&&nt(l)?_("max",l):u.symfunction("max",l)}function O(...l){return u1(l)?l[0]:O1(l)?new h(Math.min.apply(null,l)):Me.SYMBOLIC_MIN_MAX&&nt(l)?_("min",l):u.symfunction("min",l)}function ee(l){return l.isConstant(!0)?new h(Math.sign(It(l))):u.symfunction("sign",[l])}function oe(l,o){o=o?o.toString():"asc";let f=function($){return $.group===de?$.multiplier:$.group===ue?$.fname===""?f($.args[0]):$.fname:$.group===Ue?$.power:$.value},k=J(l)?l.elements:l.collectSymbols();return new Mt(k.sort(($,pe)=>{let se=f($),ne=f(pe);return o==="desc"?ne-se:se-ne}))}function ae(l,o=void 0){if(l.equals(1))return new h(0);let f;if(l.fname===ve&&l.multiplier.equals(1))return f=u.divide(ae(l.args[0]),new h(2)),l.power.sign()<0&&f.negate(),f;if(l.equals(0))throw new r0(`${Me.LOG}(0) is undefined!`);if(l.isImaginary())return N.evaluate(l,Me.LOG);if(l.isConstant()&&typeof o<"u"&&o.isConstant()){let k=Math.log(l),$=Math.log(o);f=new h(k/$)}else if(l.group===te&&l.power.multiplier.lessThan(0)||l.power.toString()==="-1")l.power.negate(),f=ae(l).negate();else if(l.value==="e"&&l.multiplier.equals(1)){let k=l.power;f=j(k)?k:new h(k)}else if(l.group===ue&&l.fname==="exp"){let k=l.args[0];l.multiplier.equals(1)?f=u.multiply(k,new h(l.power)):f=u.symfunction(Me.LOG,[l])}else if(Me.PARSE2NUMBER&&F0(l)){l=u.parse(l);let k;l.multiplier.lessThan(0)&&(l.negate(),k=u.multiply(new h(Math.PI),new h("i"))),f=new h(Math.log(l.multiplier.toDecimal())),k&&(f=u.add(f,k))}else{let k;!l.power.equals(1)&&!l.contains("e")&&l.multiplier.isOne()&&(k=l.group===te?l.power:new h(l.power),l.toLinear());let $=typeof o>"u"?[l]:[l,o];$.length>1&&u1($)?f=new h(1):f=u.symfunction(Me.LOG,$),k&&(f=u.multiply(k,f))}return f}function le(l,o){let f=o&&o.isConstant()||typeof o>"u";if(l.isConstant()&&f){let $,pe,se;$=l,o&&o.lessThan(0)&&(o=xe(o),pe=Number(l).toExponential().toString().split("e"),$=pe[0],se=pe[1]);let ne=new h(q0(Number($),Number(o)||0));return u.multiply(ne,u.pow(new h(10),new h(se||0)))}let k=[l];return typeof o<"u"&&k.push(o),u.symfunction("round",k)}function ye(l){let o=Number(l)%2,f;return o<0&&(o=2+o),o>=0&&o<=.5?f=1:o>.5&&o<=1?f=2:o>1&&o<=1.5?f=3:f=4,f}function Ce(l){if(!isFinite(l)){let f=Math.sign(l),k=new h(String(Math.abs(l)));return k.multiplier=k.multiplier.multiply(new He(f)),k}if(j(l))return l;if(typeof l=="number")try{l=He.simple(l)}catch(f){if(f.message==="timeout")throw f;l=new He(l)}let o=new h(0);return o.multiplier=l,o}function Pe(l){let o=l.group,f;if(o===Le){let k=l.getNum(),$=l.getDenom()||new h(1),pe=Number(l.power),se=new h(1);if(Math.abs(pe)===1){$.each(Ne=>{Ne.group===Z?se=u.multiply(se,Pe(Ne.getDenom())):Ne.power.lessThan(0)&&(se=u.multiply(se,Pe(Ne.clone().toUnitMultiplier())))});let ne=new h(0);$.each(Ne=>{ne=u.add(u.divide(Ne,se.clone()),ne)}),se.invert();let Ee;k.isComposite()?(Ee=new h(0),k.each(Ne=>{Ee=u.add(u.multiply(Pe(Ne),se.clone()),Ee)})):Ee=u.multiply(se,k),f=u.divide(Ee,ne)}}else o===Z?(f=new h(1),l.each(k=>{f=u.multiply(f,u.clean(k))})):o===ue&&l.args.length===1&&l.args[0].isConstant()&&(f=g0("PARSE2NUMBER",()=>u.parse(l),!0));return f||=l,f}function it(l,o){return o||={expand_denominator:!0,expand_functions:!0},at(l,o)}function at(l,o){if(Array.isArray(l))return l.map(k=>at(k,o));if(l.expand)return l.expand(o);if(o||={},l.group===ue&&l.fname===""){let k=at(l.args[0],o),$=at(u.pow(k,u.parse(l.power)),o);return u.multiply(u.parse(l.multiplier),$).distributeMultiplier()}if([de,_e,Ue].indexOf(l.group)!==-1)return l;let f=l.clone();try{let k=l.multiplier.toString(),$=Number(l.power),pe=l;if(l.isComposite()&&yt(l.power)&&l.power>0){let se=$-1,ne=new h(0);l.each(Ne=>{ne=u.add(ne,at(u.parse(Ne),o))});let Ee=u.parse(ne);for(let Ne=0;Ne<se;Ne++)Ee=Te(Ee,ne,o);pe=u.multiply(u.parse(k),Ee).distributeMultiplier()}else if(l.group===ue&&o.expand_functions===!0){let se=[];l.args.forEach(ne=>{se.push(at(ne,o))}),pe=u.pow(u.symfunction(l.fname,se),u.parse(l.power)),pe=u.multiply(pe,u.parse(l.multiplier))}else if(l.isComposite()&&yt(l.power)&&l.power<0&&o.expand_denominator===!0)l=l.invert(),pe=at(l,o),pe.invert();else if(l.group===Z){let se=function(Ne){switch(Ne.group){case Le:return 0;case ce:return 1;case Z:return 2;case ue:return 3;default:return 4}},ne=l.collectSymbols().sort((Ne,Ie)=>se(Ie)-se(Ne)).map(Ne=>{let Ie=u.pow(Ne,u.parse(String($)));return at(Ie,o)}),Ee=ne.pop();Ee.isComposite()&&Ee.isLinear()?(ne.forEach(Ne=>{Ee=Te(Ee,Ne,o)}),Ee.isComposite()?(Ee.power>1&&(Ee=at(u.pow(Ee,u.parse(Ee.power)),o)),pe=u.multiply(u.parse(k),Ee).distributeMultiplier()):pe=Ee):(pe=Ee,ne.forEach(Ne=>{pe=u.multiply(pe,Ne)}),pe=u.multiply(pe,u.parse(k)).distributeMultiplier()),pe.group===Z&&(pe=u.parse(pe))}else pe=l;return pe}catch(k){if(k.message==="timeout")throw k;return f}}function pt(l){return St.identity(l)}function i0(l,o){return o.isConstant()&&yt(o)?l.elements[Number(o)]:u.symfunction("vecget",[l,o])}function Pt(l,o){return o=typeof o>"u"?1e-14:o,l=l.clone(),o=Number(o),l.elements.sort((f,k)=>k.group-f.group),l.elements=Kn(l.elements,(f,k)=>Number(u.subtract(It(f),It(k)).abs())<=o),l}function p0(l,o,f){return o.isConstant?(l.elements[Number(o)]=f,l):u.symfunction("vecset",[l,o,f])}function Ot(l,o,f){return o.isConstant()&&f.isConstant()?l.elements[Number(o)][Number(f)]:u.symfunction("matget",[l,o,f])}function Jt(l,o){return o.isConstant()?new St(l.elements[o]):u.symfunction("matgetrow",[l,o])}function $0(l,o,f){if(!o.isConstant())return u.symfunction("matsetrow",[l,o,f]);if(l.elements[Number(o)].length!==f.elements.length)throw new I1("Matrix row must match row dimensions!");let k=l.clone();return k.elements[Number(o)]=f.clone().elements,k}function d0(l,o){if(!o.isConstant())return u.symfunction("matgetcol",[l,o]);let f=Number(o),k=St.fromArray([]);return l.each(($,pe,se)=>{se===f&&k.elements.push([$.clone()])}),k}function X0(l,o,f){if(!o.isConstant())return u.symfunction("matsetcol",[l,o,f]);let k=Number(o);if(l.rows()!==f.elements.length)throw new I1("Matrix column length must match number of rows!");return f.each((($,pe)=>{l.set(pe-1,k,$.elements[0].clone())})),l}function k0(l,o,f,k){return l.elements[o][f]=k,l}function R0(...l){return new Mt(l)}function H0(...l){return St.fromArray(l)}function h0(...l){return v0.fromArray(l)}function P0(l){return ie(l)?l.determinant():l}function D0(l){let o;return ie(l)?o=[new h(l.cols()),new h(l.rows())]:J(l)||z1(l)?o=new h(l.elements.length):Wt("size expects a matrix or a vector"),o}function j0(l,o){return ie(l)&&(l=new Mt(l)),ie(o)&&(o=new Mt(o)),J(l)&&J(o)?l.dot(o):u.multiply(l.clone(),o.clone())}function Yt(l,o){return ie(l)&&(l=new Mt(l)),ie(o)&&(o=new Mt(o)),J(l)&&J(o)?l.cross(o):u.multiply(l.clone(),o.clone())}function Tt(l){return ie(l)?l.transpose():Wt("function transpose expects a matrix")}function qn(l){return ie(l)?l.invert():Wt("invert expects a matrix")}function On(l,o){return l.union(o)}function Cn(l,o){return l.intersection(o)}function Tn(l,o){return l.contains(o)}function Rn(l,o){return l.difference(o)}function Ln(l,o){return new h(Number(l.intersects(o)))}function Un(l,o){return new h(Number(l.isSubset(o)))}function xn(l,o){o??=l;let f=K.slice(l,o).map(k=>new h(k));return f.length===1?f[0]:f.length===0?new h(0):new Mt(f)}function $n(...l){l.forEach(o=>{console.log(o.toString())})}function N1(l){if(!j(l.power)&&l.power.absEquals(.5)){let o=l.power.sign(),f=kt(l.group===_e?new h(l.value):l.toLinear());return o<0&&f.invert(),f}return l}function kn(l){if(l.group===_e){let o=l.value,f=Fi(o)[0];if(!f)return U1("Unable to compute prime factors. This should not happen. Please review and report."),l;let $=new He(Math.log(o)/Math.log(f)).multiply(l.power);if($.den>l.power.den)return l;yt($)?l=new h(f**Number($)):l=new h(f).setPower($)}return l}this.expand=at,this.round=le,this.clean=Pe,this.sqrt=kt,this.cbrt=a0,this.abs=xe,this.log=ae,this.rationalize=c0,this.nthroot=u0,this.arg=m,this.conjugate=o1,this.imagpart=s1,this.realpart=ft,this.getFunction=function(o){return L[o][0]},this.addPreprocessor=function(o,f,k,$){let{names:pe}=n,{actions:se}=n;if(typeof f!="function")throw new Error("Incorrect parameters. Function expected!");k?$?(pe.splice(k,0,o),se.splice(k,0,f)):(pe[k]=o,se[k]=f):(pe.push(o),se.push(f))},this.getPreprocessors=function(){let o={};for(let f=0,k=n.names.length;f<k;f++){let $=n.names[f];o[$]={order:f,action:n.actions[f]}}return o},this.removePreprocessor=function(o,f){let k=n.names.indexOf(o);f?(L0(n.names,k),L0(n.actions,k)):(n.names[k]=void 0,n.actions[k]=void 0)},this.mappedFunction=function(...o){let f={},{params:k}=this;for(let $=0;$<k.length;$++)f[k[$]]=String(o[$]);return u.parse(this.body,f)},this.add=function(o,f){let k=j(o),$=j(f);if(k&&$){if(o.unit||f.unit)return u.Unit.add(o,f);if(o.isInfinity||f.isInfinity){let ht=o.multiplier.lessThan(0),Ut=f.multiplier.lessThan(0);if(o.isInfinity&&f.isInfinity&&ht!==Ut)throw new r0(`(${o})+(${f}) is not defined!`);let Kt=h.infinity();return Ut&&Kt.negate(),Kt}if(o.isComposite()&&o.isLinear()&&f.isComposite()&&f.isLinear()&&(o.distributeMultiplier(),f.distributeMultiplier(),f.length>o.length&&o.group===f.group&&([o,f]=[f,o])),o.multiplier.equals(0))return f;if(f.multiplier.equals(0))return o;if(o.isConstant()&&f.isConstant()&&Me.PARSE2NUMBER)return new h(o.multiplier.add(f.multiplier).toDecimal(Me.PRECISION));let se=o.group,ne=f.group,Ee=o.power.toString(),Ne=f.power.toString();if(se<ne||se===ne&&Number(Ee)>Number(Ne)&&Number(Ne)>0)return this.add(f,o);if(se===Z&&ne===ce&&o.value===f.value){let ht=o;o=f,f=ht,se=o.group,ne=f.group,Ee=o.power.toString(),Ne=f.power.toString()}let Ie=Ee===Ne,we=o.value,ze=f.value,gt=o.isComposite(),vt=f.isComposite(),We,ke,et;if(gt&&(We=G(o,"hash")),vt&&(ke=G(f,"hash")),se===Le&&ne===Le&&f.isLinear()&&!o.isLinear()&&We!==ke)return this.add(f,o);se===ce&&ne===ce&&(we=We,ze=ke);let Ke=se===_e&&ne===de,st=o.value===f.multiplier.toString(),Et=we===ze||We===ke&&We!==void 0||Ke&&st;if(Et&&Ie&&se===ne)if(Ke&&(f=f.convert(_e)),se===ce&&(ne===Ue||ne===_e))o.distributeMultiplier(),et=o.attach(f);else if(et=o,o.multiplier.isOne()&&f.multiplier.isOne()&&se===Le&&o.isLinear()&&f.isLinear())for(let ht in f.symbols){if(!Object.hasOwn(f.symbols,ht))continue;let Ut=f.symbols[ht];et.attach(Ut)}else et.multiplier=et.multiplier.add(f.multiplier);else if(Et&&se!==ce)se===Le&&ne===ce?(f.insert(o,"add"),et=f):(et=h.shell(ce).attach([o,f]),et.value=se===ce?We:we);else if(gt&&o.isLinear()){let ht=se===ne,Ut=se===ce&&ne===ce;if(Ut&&(ht=o.value===f.value),o.distributeMultiplier(),f.isComposite()&&f.isLinear()&&ht){f.distributeMultiplier();for(let Kt in f.symbols){if(!Object.hasOwn(f.symbols,Kt))continue;let N0=f.symbols[Kt];o.attach(N0)}et=o}else Ut&&o.value!==ke||se===ce&&!Et?(et=h.shell(Le).attach([o,f]),et.updateHash()):et=o.attach(f)}else{if(se===ue&&o.fname===ve&&ne!==te&&f.power.equals(.5)){let ht=f.multiplier.clone();f=kt(f.toUnitMultiplier().toLinear()),f.multiplier=ht}o.length===2&&f.length===2&&Bt(o.power)&&Bt(f.power)?et=u.add(at(o),at(f)):(et=h.shell(Le).attach([o,f]),et.updateHash())}if(et.multiplier.equals(0)&&(et=new h(0)),et.length===1){let ht=et.multiplier;et=f1(et.symbols),et.multiplier=et.multiplier.multiply(ht)}return et}if($&&!k){let se=o;o=f,f=se,se=$,$=k,k=se}let pe=ie(f);if(k&&pe){let se=new St;f.eachElement((ne,Ee,Ne)=>{se.set(Ee,Ne,u.add(o.clone(),ne))}),f=se}else if(ie(o)&&pe)f=o.add(f);else if(k&&J(f))f.each((se,ne)=>{ne--,f.elements[ne]=u.add(o.clone(),f.elements[ne])});else if(J(o)&&J(f))f.each((se,ne)=>{ne--,f.elements[ne]=u.add(o.elements[ne],f.elements[ne])});else{if(J(o)&&ie(f))return u.add(f,o);if(ie(o)&&J(f)){if(f.elements.length===o.rows()){let se=new St,ne=o.cols();return f.each((Ee,Ne)=>{let Ie=[];if(J(Ee))for(let we=0;we<ne;we++)Ie.push(u.add(o.elements[Ne-1][we].clone(),Ee.elements[we].clone()));else for(let we=0;we<ne;we++)Ie.push(u.add(o.elements[Ne-1][we].clone(),Ee.clone()));se.elements.push(Ie)}),se}Wt("Dimensions must match!")}}return f},this.subtract=function(o,f){let k=j(o),$=j(f),pe;if(k&&$){let se=o,ne=f;return se.unit||ne.unit?u.Unit.subtract(se,ne):this.add(se,ne.negate())}if($&&J(o))f=o.map(se=>u.subtract(se,f.clone()));else if(k&&J(f))f=f.map(se=>u.subtract(o.clone(),se));else if(J(o)&&J(f)||q1(o)&&q1(f))o.dimensions()===f.dimensions()?f=o.subtract(f):u.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(ie(o)&&J(f)){if(f.elements.length===o.rows()){let se=new St,ne=o.cols();return f.each((Ee,Ne)=>{let Ie=[];for(let we=0;we<ne;we++)Ie.push(u.subtract(o.elements[Ne-1][we].clone(),Ee.clone()));se.elements.push(Ie)}),se}Wt("Dimensions must match!")}else if(J(o)&&ie(f)){let se=f.clone().negate();return u.add(se,o)}else if(ie(o)&&ie(f))f=o.subtract(f);else if(ie(o)&&$){let se=new St;o.each((ne,Ee,Ne)=>{se.set(Ee,Ne,u.subtract(ne,f.clone()))}),f=se}else if(k&&ie(f)){let se=new St;f.each((ne,Ee,Ne)=>{se.set(Ee,Ne,u.subtract(o.clone(),ne))}),f=se}return f},this.multiply=function(o,f){let k=j(o),$=j(f);if(k&&f instanceof bt)return f.elements.push(o),f;if(k&&$){if(f.isUnit){let Ke=o.clone();return o.unit=f,Ke}if(o.unit||f.unit)return u.Unit.multiply(o,f);if(o.isInfinity||f.isInfinity){if(o.equals(0)||f.equals(0))throw new r0(`${o}*${f} is undefined!`);if(f.power.lessThan(0)){if(!o.isInfinity)return new h(0);throw new r0("Infinity/Infinity is not defined!")}let Ke=o.multiplier.multiply(f.multiplier).sign(),st=h.infinity();if(o.isConstant()||f.isConstant()||o.isInfinity&&f.isInfinity)return Ke<0&&st.negate(),st}if(o.multiplier.equals(0)||f.multiplier.equals(0))return new h(0);if(o.isOne())return f.clone();if(f.isOne())return o.clone();if(o.isConstant()&&f.isConstant()&&Me.PARSE2NUMBER){let Ke,st=o.multiplier.num.abs().toString().length,Et=o.multiplier.den.toString().length,ht=st-Et,Ut=f.multiplier.num.abs().toString().length,Kt=f.multiplier.den.toString().length,N0=Ut-Kt,wt=Me.PRECISION-5;if(ht<-wt||ht>wt||N0<-wt||N0>wt){let Ct=new q(String(o.multiplier.num)),e0=new q(String(o.multiplier.den)),z0=new q(String(f.multiplier.num)),I0=new q(String(f.multiplier.den));Ke=new h(Ct.times(z0).dividedBy(e0).dividedBy(I0).toFixed())}else{let Ct=new q(o.multiplier.toDecimal()),e0=new q(f.multiplier.toDecimal()),z0=Ct.times(e0).toFixed();Ke=new h(z0)}return Ke}if(f.group>o.group&&f.group!==Le)return this.multiply(f,o);if(o.group===Z&&f.group===ce&&o.value===f.value){let Ke=o;o=f,f=Ke}let ne=o.group,Ee=f.group,Ne=f.multiplier.num,Ie=f.multiplier.den;if(ne===ue&&o.fname===ve&&!f.isConstant()&&o.args[0].value===f.value&&!o.args[0].multiplier.lessThan(0)){let Ke=o.power,st=u.parse(o.multiplier);o=u.multiply(st,o.args[0].clone()),o.setPower(new He(.5).multiply(Ke)),ne=o.group}else ne===ue&&o.fname===ve&&o.multiplier.equals(1)&&o.power.equals(-1)&&f.isConstant()&&o.args[0].equals(f)&&(o=u.symfunction(ve,[f.clone()]),f=new h(1));let we=o.value,ze=f.value,gt=new He(o.sign()),vt=ne===_e&&Ee===de&&f.multiplier.equals(o.value),We=vt?new He(1).multiply(o.multiplier).abs():o.multiplier.multiply(f.multiplier).abs(),ke=o.clone().toUnitMultiplier();if(f=f.clone().toUnitMultiplier(!0),ne===ue&&Ee===ue){let Ke=o.args[0].clone(),st=f.args[0].clone();if(o.fname===ve&&f.fname===ve&&o.isLinear()&&f.isLinear()){let Et=u.divide(Ke,st).invert();Et.gt(1)&&yt(Et)&&(ke=u.multiply(o.args[0].clone(),kt(Et.clone())),f=new h(1))}else if(o.fname===me&&f.fname===me&&!Ke.isConstant()&&!st.isConstant()&&f.power<0){let Et=u.subtract(Ke.clone(),st.clone());if(Et.isConstant()){let ht=new h(1);if(Et<0){for(let Ut=0,Kt=Math.abs(Et);Ut<=Kt;Ut++){let N0=u.add(Ke.clone(),new h(Ut));ht=u.multiply(ht,N0)}ke=u.multiply(u.pow(Ke,new h(o.power)),u.pow(ht,new h(f.power))),f=new h(1)}else{for(let Ut=0,Kt=Math.abs(Et);Ut<=Kt;Ut++){let N0=u.add(st.clone(),new h(Ut));ht=u.multiply(ht,N0)}ke=u.multiply(u.pow(ht,new h(o.power)),u.pow(st,new h(f.power))),f=new h(1)}}}}if(we===ze&&ne===ce&&ne===Ee&&(we=o.text("hash"),ze=f.text("hash")),Ee===te&&f.previousGroup===ce&&ne===ce&&(we=G(o,"hash",te)),(we===ze||vt)&&!(ne===ce&&(Ee===Ue||Ee===_e||Ee===ue))&&!(ne===ce&&Ee===Z)){let Ke=o.power,st=f.power,Et=j(Ke),ht=j(st),Ut=Et||ht;ne===ce&&Ee!==ce&&f.previousGroup!==ce&&Ke.equals(1)?(ke=new h(0),o.each(Kt=>{ke=u.add(ke,u.multiply(Kt,f.clone()))},!0)):(Ut?ke.power=u.add(j(Ke)?Ke:new h(Ke),j(st)?st:new h(st)):ne===de?ke.power=Ke:ke.power=Ke.add(st),ke.power.equals(0)&&(ke=ke.convert(de)),Ut&&ke.convert(te),o.imaginary&&f.imaginary&&Bt(Number(ke.power)%2)&&(ke=new h(1),We.negate()),ke.group!==te&&ke.previousGroup&&(ke.previousGroup=void 0),ke.multiplier=ke.multiplier.multiply(f.multiplier))}else if(ne===Z&&o.isLinear())if(Ee===Z&&f.distributeExponent(),Ee===Z&&f.isLinear()){for(let Ke in f.symbols){if(!Object.hasOwn(f.symbols,Ke))continue;let st=f.symbols[Ke];ke=ke.combine(st)}ke.multiplier=ke.multiplier.multiply(f.multiplier)}else ke.combine(f);else if(ne===de)ke=f.clone().toUnitMultiplier(!0);else if(ne===Z)ke.distributeExponent(),ke.combine(f);else if(!f.isOne()){let Ke=f.multiplier.clone();f.toUnitMultiplier(),ke=h.shell(Z).combine([ke,f]),ke.multiplier=ke.multiplier.multiply(Ke)}if(ke.group===_e){let Ke=Math.log(ke.value),st=Math.log(Ne)/Ke,Et=Math.log(Ie)/Ke,ht=We.num/Ne,Ut=We.den/Ie;st!==0&&yt(st)&&yt(ht)&&(ke.power=ke.power.add(new He(st)),We.num/=Ne),Et!==0&&yt(Et)&&yt(Ut)&&(ke.power=ke.power.subtract(new He(Et)),We.den/=Ie)}if(ke.length===1){let Ke=ke.multiplier;ke=f1(ke.symbols),ke.multiplier=ke.multiplier.multiply(Ke)}let et=ke.power.toString();if(Bt(et)&&ke.fname===ve){gt=gt.multiply(new He(ke.sign()));let Ke=ke.power;ke=ke.args[0],ke=u.multiply(new h(We),u.pow(ke,new h(Ke.divide(new He(2))))),gt.lessThan(0)&&ke.negate()}else ke.multiplier=ke.multiplier.multiply(We).multiply(gt),ke.group===Le&&ke.isImaginary()&&ke.distributeMultiplier();return ke.group===_e&&yt(ke.power.toDecimal())&&(ke=ke.convert(de)),ke}if($&&!k){let ne=o;o=f,f=ne,ne=$,$=k,k=ne}let pe=ie(f),se=ie(o);if(k&&pe){let ne=new St;f.eachElement((Ee,Ne,Ie)=>{ne.set(Ne,Ie,u.multiply(o.clone(),Ee))}),f=ne}else if(se&&pe)f=o.multiply(f);else if(k&&J(f))f.each((ne,Ee)=>{Ee--,f.elements[Ee]=u.multiply(o.clone(),f.elements[Ee])});else if(J(o)&&J(f))f.each((ne,Ee)=>{Ee--,f.elements[Ee]=u.multiply(o.elements[Ee],f.elements[Ee])});else{if(J(o)&&ie(f))return this.multiply(f,o);if(ie(o)&&J(f)){if(f.elements.length===o.rows()){let ne=new St,Ee=o.cols();return f.each((Ne,Ie)=>{let we=[];for(let ze=0;ze<Ee;ze++)we.push(u.multiply(o.elements[Ie-1][ze].clone(),Ne.clone()));ne.elements.push(we)}),ne}Wt("Dimensions must match!")}}return f},this.divide=function(o,f){let k=j(o),$=j(f);if(k&&$){if(o.unit||f.unit)return u.Unit.divide(o,f);let ne;if(f.equals(0))throw new A1("Division by zero not allowed!");return o.isConstant()&&f.isConstant()?(ne=o.clone(),ne.multiplier=ne.multiplier.divide(f.multiplier)):(f.invert(),ne=u.multiply(o,f)),ne}let pe=J(o),se=J(f);if(k&&se)f=f.map(ne=>u.divide(o.clone(),ne));else if(pe&&$)f=o.map(ne=>u.divide(ne,f.clone()));else if(pe&&se)o.dimensions()===f.dimensions()?f=f.map((ne,Ee)=>u.divide(o.elements[--Ee],ne)):u.error("Cannot divide vectors. Dimensions do not match!");else{let ne=ie(o),Ee=ie(f);if(ne&&$){let Ne=new St;o.eachElement((Ie,we,ze)=>{Ne.set(we,ze,u.divide(Ie,f.clone()))}),f=Ne}else if(k&&Ee){let Ne=new St;f.eachElement((Ie,we,ze)=>{Ne.set(we,ze,u.divide(o.clone(),Ie))}),f=Ne}else if(ne&&Ee){let Ne=new St;o.rows()===f.rows()&&o.cols()===f.cols()?(o.eachElement((Ie,we,ze)=>{Ne.set(we,ze,u.divide(Ie,f.elements[we][ze]))}),f=Ne):u.error("Dimensions do not match!")}else if(ne&&se)if(o.cols()===f.dimensions()){let Ne=new St;o.eachElement((Ie,we,ze)=>{Ne.set(we,ze,u.divide(Ie,f.elements[we].clone()))}),f=Ne}else u.error("Unable to divide matrix by vector.")}return f},this.pow=function(o,f){let k=j(o),$=j(f);if(k&&$){if(o.unit||f.unit)return u.Unit.pow(o,f);if(o.group===ue&&o.fname===qe&&Bt(f)){let We=o.multiplier.clone(),ke=u.pow(o.args[0],f);return ke.multiplier=We,ke}if(o.isInfinity||f.isInfinity){if(o.isInfinity&&f.isInfinity)throw new r0(`(${o})^(${f}) is undefined!`);if(o.isConstant()&&f.isInfinity){if(o.equals(0)){if(f.lessThan(0))throw new r0("0^Infinity is undefined!");return new h(0)}if(o.equals(1))throw new r0(`1^${f.toString()} is undefined!`);if(f.lessThan(0))return new h(0);if(!o.lessThan(0))return h.infinity()}if(o.isInfinity&&f.isConstant()){if(f.equals(0))throw new r0(`${o}^0 is undefined!`);return f.lessThan(0)?new h(0):u.multiply(h.infinity(),u.pow(new h(o.sign()),f.clone()))}}let pe=o.equals(0),se=f.equals(0);if(pe&&se)throw new r0("0^0 is undefined!");if(pe&&f.isConstant()&&f.multiplier.greaterThan(0))return new h(0);if(se)return new h(1);let ne=f.isConstant(),Ee=o.isConstant(),Ne=f.isInteger(),Ie=o.multiplier,we=o.clone();if(Ee&&ne&&o.equals(0)&&f.lessThan(0))throw new r0("Division by zero is not allowed!");if(Me.PARSE2NUMBER&&Ee&&ne&&o.sign()<0&&M1(f)){let We=Math.PI*Number(f.multiplier.toDecimal()),ke=new h(Math.cos(We)),et=u.multiply(h.imaginary(),new h(Math.sin(We)));return u.add(ke,et)}if(Me.PARSE2NUMBER&&o.isImaginary()&&ne&&yt(f)&&!f.lessThan(0)){let We,ke,et,Ke,st,Et=o.realpart(),ht=o.imagpart();if(Et.isConstant("all")&&ht.isConstant("all"))return st=Me.USE_BIG?new h(q.atan2(ht.multiplier.toDecimal(),Et.multiplier.toDecimal()).times(f.toString())):Math.atan2(Number(ht.multiplier.toDecimal()),Number(Et.multiplier.toDecimal()))*Number(f.multiplier.toDecimal()),ke=new h(st),We=u.pow(h.hyp(Et,ht),f),et=u.multiply(We.clone(),u.trig.cos(ke.clone())),Ke=u.multiply(We,u.trig.sin(ke)),u.add(et,u.multiply(h.imaginary(),Ke))}we.toUnitMultiplier();let ze;if(we.group===ue&&we.fname===ve&&!ne){let We=we.args[0];We.multiplyPower(new h(.5)),We.multiplier.multiply(we.multiplier),We.multiplyPower(f),we=We}else ze=Ie.sign(),M1(f)&&ze<0&&(we.negate(),we=u.symfunction($e,[we]),we.negate()),we.multiplyPower(f);let gt,vt;if(Ee&&ne&&Me.PARSE2NUMBER){let We;ze<0&&(o.negate(),f.multiplier.den.equals(2)?We=new h(Me.IMAGINARY):yt(f.multiplier)?Bt(f.multiplier)?We=new h(1):We=new h(-1):Bt(f.multiplier.den)?We=u.pow(u.symfunction($e,[new h(ze)]),f.clone()):We=new h(ze**f.multiplier.num));let ke=Number(o.multiplier.toDecimal())**Number(f.multiplier.toDecimal());if(ke!==0||o.multiplier.equals(0))we=new h(ke);else{let et=new q(o.multiplier.toDecimal()),Ke=new q(f.multiplier.toDecimal());we=new h(et.pow(Ke).toFixed())}We&&(we=u.multiply(we,We))}else if(Ne&&!Ie.equals(1)){if(f.abs().gt(Me.MAX_EXP))return f.sign()<0?new h(0):h.infinity();let ke=f.multiplier.toDecimal(),et=Math.sign(Number(ke)),Ke=Math.abs(Number(ke)),st=new He(1);st.num=Ie.num.pow(Ke),st.den=Ie.den.pow(Ke),et<0&&st.invert(),we.multiplier=we.multiplier.multiply(st)}else{let We=o.sign();if(f.isConstant()&&o.isConstant()&&!f.multiplier.den.equals(1)&&We<0)if(f.multiplier.den.equals(2)){let ke=new h(Me.IMAGINARY);o.negate(),f.lessThan(0)&&(ke.negate(),f.negate()),we=u.multiply(u.pow(o,f),ke)}else{let ke=o.clone();ke.multiplier.negate(),we=u.pow(u.symfunction($e,[new h(ze)]),f.clone());let et=u.pow(new h(ke.multiplier.num),f.clone()),Ke=u.pow(new h(ke.multiplier.den),f.clone()),st=u.divide(et,Ke);we=u.multiply(we,st)}else if(Me.PARSE2NUMBER&&f.isImaginary()){let ke=f.realpart(),et=f.imagpart(),Ke=o.clone().toLinear(),st=u.pow(Ke.clone(),ke),Et=ae(Ke.clone()),ht=I.cos(u.multiply(et.clone(),Et)),Ut=u.multiply(I.sin(u.multiply(et,ae(Ke))),h.imaginary());we=u.multiply(st,u.add(ht,Ut)),we=u.expand(u.parse(we))}else{let ke=o.group===de&&We<0;if(gt=N1(new h(ke?Ie.num:Math.abs(Ie.num)).setPower(f.clone())),vt=N1(new h(Ie.den).setPower(f.clone()).invert()),o.imaginary)if(Ne){let et=Math.sign(f),st=xe(f)%4;we=new h(Bt(st)?-1:Me.IMAGINARY),(st===0||et<0&&st===1||et>0&&st===3)&&we.negate()}else{let et=f.multiplier.multiply(He.quick(1,2)),Ke=(-1)**et.num;we=Bt(et.den)?new h(-1).setPower(et,!0):new h(Ke)}if(We<0&&!ke&&we.negate(),ne&&o.group!==te){let et=Bt(f.multiplier.den),Ke=Bt(o.power),st=we.power.toDecimal(),Et=Bt(st);if(et&&Ke&&!Et){if(st==="1"||st==="1")typeof we.value=="string"&&we.value.startsWith("baseunit_")||(we=u.symfunction(qe,[we]));else if(yt(st))we=u.multiply(u.symfunction(qe,[we.clone().toLinear()]),we.clone().setPower(new He(Number(st)-1)));else{let ht=we.power;we=u.symfunction(qe,[we.toLinear()]).setPower(ht)}Me.POSITIVE_MULTIPLIERS&&we.fname===qe&&(we=we.args[0])}}if(f.equals(2)&&we.group===Z){let et=new h(1);we.each(Ke=>{et=u.multiply(et,u.pow(Ke,f))}),we=et}}}if(we=N1(we),gt&&vt&&(we=u.multiply(we,kn(u.multiply(gt,vt)))),we.fname===ve){let We=we.group===te,ke=We?we.power.multiplier.toString():we.power.toString();if(Bt(ke)){let et=We?u.divide(we.power,new h(2)):new h(we.power.divide(new He(2))),Ke=we.multiplier;we=u.pow(we.args[0],et),we.multiplier=we.multiplier.multiply(Ke)}}else if(!Me.IGNORE_E&&we.isE()&&we.group===te&&we.power.contains("pi")&&we.power.contains(Me.IMAGINARY)&&f.group===Z){let We=f.stripVar(Me.IMAGINARY);we=u.add(I.cos(We),u.multiply(h.imaginary(),I.sin(We)))}return we}if(J(o)&&$)o=o.map(pe=>u.pow(pe,f.clone()));else if(ie(o)&&$){let pe=new St;o.eachElement((se,ne,Ee)=>{pe.set(ne,Ee,u.pow(se,f.clone()))}),o=pe}else if(k&&ie(f)){let pe=new St;f.eachElement((se,ne,Ee)=>{pe.set(ne,Ee,u.pow(o.clone(),se))}),o=pe}return o},this.comma=function(o,f){return o instanceof bt||(o=bt.create(o)),o.append(f),o},this.mod=function(o,f){return mt(o,f)},this.slice=function(o,f){return new s(o,f)},this.equals=function(o,f){return o.group!==Ue&&!o.isLinear()&&Wt(`Cannot set equality for ${o.toString()}`),p[o.value]=f.clone(),f},this.percent=function(o){return u.divide(o,new h(100))},this.assign=function(o,f){if(o instanceof bt&&f instanceof bt)return o.elements.map((k,$)=>u.assign(k,f.elements[$])),Mt.fromArray(f.elements);if(o.parent){let k=o.parent;return k.elements[k.getter]=f,delete k.getter,k}if(o.group!==Ue)throw new j1(`Cannot complete operation. Incorrect LH value for ${o}`);return p[o.value]=f,f},this.functionAssign=function(o,f){let k=o.elements.pop();return ge(k,o.elements,f)};let Z0=function(o){return new h(o===!0?1:0)};this.eq=function(o,f){return Z0(o.equals(f))},this.gt=function(o,f){return Z0(o.gt(f))},this.gte=function(o,f){return Z0(o.gte(f))},this.lt=function(o,f){return Z0(o.lt(f))},this.lte=function(o,f){return Z0(o.lte(f))},this.factorial=function(o){return this.symfunction(me,[o])},this.dfactorial=function(o){return this.symfunction(Q,[o])}}u=new R,vn._=u,ct._=u,Object.defineProperty(pn,"functions",{get:()=>u.functions,configurable:!0}),Object.defineProperty(hn,"CONSTANTS",{get:()=>u.CONSTANTS,configurable:!0}),Object.defineProperty(U0,"VARS",{get:()=>p,configurable:!0}),Object.defineProperty(l0,"VARS",{get:()=>p,configurable:!0}),l0._clearFunctions=Ve,l0._initConstants=()=>u.initConstants(),n0._=u,n0.C=re,xt._=u,xt.isArray=Ht,xt.isSymbol=j,xt.isMatrix=ie,xt.isVector=J,xt.isSet=z1,xt.isNegative=fe,xt.inBrackets=Xt,xt.Settings=Me,xt.SQRT=ve,xt.ABS=qe,xt.PARENTHESIS=$e,xt.FACTORIAL=me,xt.DOUBLEFACTORIAL=Q,xt.FN=ue,xt.S=Ue,xt.P=_e,xt.N=de,xt.CB=Z,xt.CP=Le,xt.EX=te,xt.Parser=R,Nt.parser=(function(){let y=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],n=new R;for(let w in n)y.indexOf(w)===-1&&delete n[w];n.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(w){return w}}),n.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(w){return w}});let s=n.getBrackets();return s["{"].maps_to=void 0,n})(),Object.defineProperty(Vt,"EXPRESSIONS",{get:()=>c,configurable:!0}),Object.defineProperty(Vt,"USER_FUNCTIONS",{get:()=>d,configurable:!0}),Vt.LaTeX=Nt,Vt.text=G,Vt.functions=u.functions,Vt._=u,Ye.Frac=He,Ye.NerdamerSymbol=h,Ye.isVector=J,Ye.isArray=Ht,Ye.isMatrix=ie,Ye.isSymbol=j,Ye.block=g0,Ye._=u,Ye.Settings=Me,Ye.text=G,Ye.LaTeX=Nt,ot.Frac=He,ot.NerdamerSymbol=h,ot.Vector=Mt,ot.isMatrix=ie,ot.isVector=J,ot.isArray=Ht,ot.isSymbol=j,ot.block=g0,ot._=u,ot.err=Wt,ot.LaTeX=Nt,B0.isVector=J,B0.Vector=Mt,B0.remove=L0,_0._=u,_0.block=g0,t0.Math2=rt,t0.Frac=He,t0.NerdamerSymbol=h,t0.isInt=yt,t0.nround=q0,t0.even=Bt,t0.block=g0,t0._=u,t0.variables=D,t0.inBrackets=Xt,t0.FN=ue,t0.N=de,t0.S=Ue,t0.P=_e,t0.EX=te,t0.CB=Z,f0.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":rt.gamma},gamma_incomplete:{"Math2.factorial":rt.factorial},Li:{"Math2.Ei":rt.Ei,"Math2.bigLog":rt.bigLog,Frac:He},Ci:{"Math2.factorial":rt.factorial},Ei:{"Math2.factorial":rt.factorial},Si:{"Math2.factorial":rt.factorial},Shi:{"Math2.factorial":rt.factorial},Chi:{isInt:yt,nround:q0,"Math2.num_integrate":rt.num_integrate},factor:{"Math2.ifactor":rt.ifactor,NerdamerSymbol:h},num_integrate:{"Math2.simpson":rt.simpson,nround:q0},fib:{even:Bt}},f0.reformat={diff(a,y){let n=a.args[1].toString(),s=`let f = ${f0.build(a.args[0].toString(),[n])};`,w=rt.diff.toString();return!w.startsWith("function")&&!w.startsWith("(")&&!w.startsWith("async")&&(w=`function ${w}`),y[1]+=`let diff = ${w};`,y[1]+=s,[`diff(f)(${n})`,y]}},ct.Build=f0,(function(){p1(u.CONSTANTS),p1(u.functions),u.initConstants(),u.error||=Wt,Me.LOG_FNS={log:u.functions.log,log10:u.functions.log10}})();let Y={allSame:u1,allNumeric:Yn,arguments2Array:Zn,armTimeout:J1,arrayAddSlices:Qn,arrayClone:Wn,arrayMax:jn,arrayMin:C1,arrayEqual:zn,arrayUnique:T1,arrayGetVariables:je,arraySum:b,block:g0,build:f0.build,checkTimeout:S1,clearU:oi,comboSort:ei,compare:Oe,convertToVector:Je,customError:s0,customType:Hn,decompose_fn:Ae,disarmTimeout:Y1,each:sn,evaluate:It,even:Bt,evenFraction:M1,fillHoles:V,firstObject:f1,format:Dt,generatePrimes:Sn,getCoeffs:Xe,getU:Ge,importFunctions:tt,inBrackets:Xt,isArray:Ht,isExpression:A,isFraction:S,isInt:yt,isMatrix:ie,isNegative:fe,isNumericSymbol:F0,isPrime:J0,isReserved:h1,isSymbol:j,isVariableSymbol:W1,isVector:J,isCollection:q1,keys:k1,knownVariable:Jn,nroots:Qe,remove:L0,reserveNames:p1,range:Vn,round:q0,sameSign:Bn,scientificToDecimal:W0,separate:C,stringReplace:Xn,text:G,validateName:O0,variables:D,warn:U1};re={groups:X,NerdamerSymbol:h,Expression:Zt,Collection:bt,Frac:He,Vector:Mt,Matrix:St,Parser:R,Scientific:jt,Fraction:tn,Math2:rt,LaTeX:Nt,Utils:Y,PARSER:u,PARENTHESIS:$e,Settings:Me,err:Wt,bigInt:v,bigDec:q,exceptions:F},Vt.Math2=re.Math2,Vt.Expression=Zt;let U=function(a,y,n,s){J1();try{let w=!1;if(ge(a))return yn;a!==null&&typeof a=="object"&&a instanceof Zt&&(a=a.toString()),Ht(n)||(n=typeof n>"u"?[]:[n]),n.forEach(I=>{if(I==="numer"){w=!0;return}let P=u.functions[I];P&&P[1]===1&&(a=`${I}(${a})`)});let N=g0("PARSE2NUMBER",()=>u.parse(a,y),w||Me.PARSE2NUMBER);return s?c[s-1]=N:c.push(N),new Zt(N)}finally{Y1()}};return l0.libExports=U,Q0.libExports=U,Q0.CONSTANTS=u.CONSTANTS,w0.libExports=U,w0.VARS=p,w0.CONSTANTS=u.CONSTANTS,w0.parse=u.parse.bind(u),w0.isSymbol=j,w1.libExports=U,w1._setFunction=ge,M0.libExports=U,M0.EXPRESSIONS=c,x0.libExports=U,x0.Settings=Me,x0.functions=u.functions,Qt.bigDec=q,Qt.Settings=Me,Qt.functions=u.functions,Qt.symfunction=u.symfunction.bind(u),Qt.NerdamerSymbol=h,S0.libExports=U,S0.functions=u.functions,S0.parse=u.parse.bind(u),S0.callfunction=u.callfunction.bind(u),S0.Expression=Zt,U.rpn=_i,U.convertToLaTeX=Si,U.convertFromLaTeX=Ti,U.version=pi,U.getWarnings=li,U.setConstant=ki,U.getConstant=mi,U.clearConstants=Ui,U.setFunction=Di,U.clearFunctions=Li,U.getCore=hi,U.getExpression=U.getEquation=Zt.getExpression,U.reserved=fi,U.clear=Q1,l0.clear=Q1,U.flush=xi,U.expressions=Oi,U.functions=Ci,U.register=mn,U.validateName=O0,U.validVarName=ci,U.supported=gi,U.numEquations=U.numExpressions=ai,U.setVar=Pi,U.getVar=di,U.clearVars=Ri,U.load=$i,U.getVars=wi,U.set=x1,U.get=ui,U.updateAPI=bi,U.replaceFunction=qi,U.setOperator=Ni,U.getOperator=vi,U.aliasOperator=yi,U.tree=gn,U.htmlTree=Ii,U.addPeeker=Ei,U.removePeeker=Mi,U.parse=Ai,U.updateAPI(),U})({bigInt:K1,bigDec:en,constants:Fn});typeof $1<"u"&&($1.exports=yn)});var t1=E0((Zi,Nn)=>{"use strict";var e1=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof Nn<"u"&&e1===void 0&&(e1=G0(),n1());(function(){let t=e1.getCore(),e=t.PARSER,{Frac:v}=t,{Settings:q}=t,{isSymbol:X}=t.Utils,{FN:K}=t.groups,{NerdamerSymbol:H}=t,{text:W}=t.Utils,{inBrackets:u}=t.Utils,{isInt:re}=t.Utils,{format:j}=t.Utils,{even:de}=t.Utils,{evaluate:_e}=t.Utils,{N:Ue}=t.groups,{S:te}=t.groups,{PL:ue}=t.groups,{CP:ce}=t.groups,{CB:Z}=t.groups,{EX:Le}=t.groups,{P:Be}=t.groups,{LOG:$e}=q,ve="exp",qe="abs",me="sqrt",Q="sin",c="cos",p="tan",r="sec",g="csc",d="cot",S="asin",A="acos",D="atan",b="asec",C="acsc",V="acot",J="sinh",ie="cosh",fe="tanh",Oe="csch",ge="sech",Ve="coth",Qe="asech",Ae="acsch",Ge="acoth";function je(G){this.message=G||""}je.prototype=new Error,H.prototype.hasIntegral=function(){return this.containsFunction("integrate")},H.prototype.fnTransform=function(){if(this.group!==K)return this;let h,R=this.args[0],Y=new H(this.multiplier),U=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case J:h=e.parse(j("(e^({0})-e^(-({0})))/2",R));break;case ie:h=e.parse(j("(e^({0})+e^(-({0})))/2",R));break;case fe:h=e.parse(j("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",R));break;case p:h=e.parse(j("sin({0})/cos({0})",R));break;case g:h=e.parse(j("1/sin({0})",R));break;case r:h=e.parse(j("1/cos({0})",R));break;default:h=U}else if(this.power.equals(2))switch(this.fname){case Q:h=e.parse(j("1/2-cos(2*({0}))/2",R));break;case c:h=e.parse(j("1/2+cos(2*({0}))/2",R));break;case p:h=e.parse(j("sin({0})^2/cos({0})^2",R));break;case ie:h=e.parse(j("1/2+cosh(2*({0}))/2",R));break;case J:h=e.parse(j("-1/2+cosh(2*({0}))/2",R));break;case fe:h=e.parse(j("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",R));break;case r:h=e.parse(j("(1-cos(2*({0})))/(1+cos(2*({0})))+1",R));break;default:h=U}else if(this.fname===r)h=e.parse(j("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===g)h=e.parse(j("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===p)this.power.lessThan(0)?h=e.parse(j("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):h=e.parse(j("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===Q&&this.power.lessThan(0))h=e.parse(j("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===c&&this.power.lessThan(0))h=e.parse(j("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===Q&&this.power.equals(3))h=e.parse(j("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===c&&this.power.equals(3))h=e.parse(j("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===c||this.fname===Q)&&de(this.power)){let a=this.power/2,y=e.pow(this.clone().toLinear(),e.parse(2)).fnTransform(),n=e.expand(e.pow(y,e.parse(a)));h=new H(0),n.each(s=>{let w=s.fnTransform();h=e.add(h,w)},!0)}else h=U;return e.multiply(h,Y)},H.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===te)return!1;if(this.fname&&(t.Utils.inTrig(this.fname)||t.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let h in this.symbols)if(this.symbols[h].hasTrig())return!0}return!1},t.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},t.Utils.toCommonDenominator=function(h){if(h.isComposite()&&h.isLinear()){let R=new H(h.multiplier),Y=new H(1),U=new H(0);return h.each(y=>{Y=e.multiply(Y,y.getDenom())},!0),h.each(y=>{let n=y.getNum(),s=y.getDenom(),w=e.multiply(n,e.divide(Y.clone(),s));U=e.add(U,w)}),e.multiply(R,t.Algebra.divide(e.expand(U),e.expand(Y)))}return h},t.Utils.inInverseTrig=function(h){return[S,A,D,C,b,V].indexOf(h)!==-1},t.Utils.inTrig=function(h){return[c,Q,p,r,g,d].indexOf(h)!==-1},t.Utils.inHtrig=function(h){return[J,ie,fe,Ae,Qe,Ge].indexOf(h)!==-1},t.Matrix.jacobian=function(h,R){let Y=new t.Matrix;return R||=t.Utils.arrayGetVariables(h),R.forEach((U,a)=>{h.forEach((y,n)=>{let s=t.Calculus.diff(y.clone(),U);Y.set(n,a,s)})}),Y},t.Matrix.prototype.max=function(){let h=new H(0);return this.each(R=>{let Y=R.abs();Y.gt(h)&&(h=Y)}),h},t.Matrix.cMatrix=function(h,R){let Y=new t.Matrix;return R.forEach((U,a)=>{Y.set(a,0,e.parse(h))}),Y};let tt=t.Utils.allFunctions=function(h){for(let R=0,Y=h.length;R<Y;R++)if(h[R].group!==K)return!1;return!0},Xe=t.Utils.cosAsinBtranform=function(h,R){let Y=h.args[0],U=R.args[0];return e.parse(j("(sin(({0})+({1}))-sin(({0})-({1})))/2",Y,U))},Je=t.Utils.cosAsinAtranform=function(h,R){if(Number(R.power)!==1)return e.multiply(h,R);let Y=h.args[0];return e.parse(j("(sin(2*({0})))/2",Y))},nt=t.Utils.cosAsinBtranform=function(h,R){let Y=h.args[0],U=R.args[0];return e.parse(j("(cos(({0})+({1}))-cos(({0})-({1})))/2",Y,U))},Te=t.Utils.trigTransform=function(h){let R={},Y,U,a=new H(1);for(let y=0,n=h.length;y<n;y++)if(Y=h[y],Y.group===K){let{fname:s}=Y;s===c&&R[Q]?(R[Q].args[0].toString()===Y.args[0].toString()?U=Je(Y,R[Q]):U=Xe(Y,R[Q]),delete R[Q],a=e.multiply(a,U)):s===Q&&R[c]?(R[c].args[0].toString()===Y.args[0].toString()?U=Je(Y,R[c]):U=Xe(Y,R[c]),delete R[c],a=e.multiply(a,U)):s===Q&&R[Q]?(R[Q].args[0].toString()===Y.args[0].toString()?(U=e.multiply(Y,R[Q]),delete R[Q]):(U=nt(Y,R[Q]),delete R[Q]),a=U):R[s]=Y}else a=e.multiply(a,Y);for(let y in R)Object.hasOwn(R,y)&&(a=e.multiply(a,R[y]));return a};t.Settings.integration_depth=10,t.Settings.max_lim_depth=10;let F=t.Calculus={version:"1.4.6",sum(G,h,R,Y){if(h.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${W(h)} provided`);h=h.value;let U;if(t.Utils.isNumericSymbol(R)&&t.Utils.isNumericSymbol(Y)){let a=Y-R<200?"":"PARSE2NUMBER";R=Number(R),Y=Number(Y),U=t.Utils.block(a,()=>{let y=G.text(),n={"~":!0},s=new t.NerdamerSymbol(0);for(let w=R;w<=Y;w++){n[h]=new H(w);let N=e.parse(y,n);s=e.add(s,N)}return s})}else U=e.symfunction("sum",[G,h,R,Y]);return U},product(G,h,R,Y){if(h.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${W(h)} provided`);h=h.value;let U;if(t.Utils.isNumericSymbol(R)&&t.Utils.isNumericSymbol(Y)){let a=Y-R<200?"":"PARSE2NUMBER";U=t.Utils.block(a,()=>{R=Number(R),Y=Number(Y.multiplier);let y=G.text(),n={},s=new t.NerdamerSymbol(1);for(let w=R;w<=Y;w++)n[h]=new H(w),s=e.multiply(s,e.parse(y,n));return s})}else U=e.symfunction("product",[G,h,R,Y]);return U},diff(G,h,R){if(t.Utils.isVector(G)){let s=new t.Vector([]);return G.each(w=>{s.elements.push(F.diff(w,h,R))}),s}if(t.Utils.isMatrix(G)){let s=new t.Matrix;return G.each((w,N,I)=>{s.set(N,I,F.diff(w,h,R))}),s}if(G.LHS&&G.RHS)return new t.Equation(F.diff(G.LHS.clone(),h,R),F.diff(G.RHS.clone(),h,R));let Y=X(h)?h.text():h;if(R=X(R)?R.multiplier:R||1,Y===void 0&&(Y=t.Utils.variables(G)[0]),G.group===K&&G.fname===me){let s=G.args[0],w=G.power.clone();(s.group!==Ue||s.group!==Be)&&(s.power=X(s.power)?e.multiply(s.power,e.multiply(new H(1/2)),w):s.power.multiply(new v(.5)).multiply(w),s.multiplier=s.multiplier.multiply(G.multiplier)),G=s}if(G.group===K&&!X(G.power)){let s=a(e.parse(G)),w=F.diff(G.args[0].clone(),Y);G=e.multiply(s,w)}else G=a(G);return R>1&&(R--,G=F.diff(G,h,R)),G;function U(s){return(s.value===Y||s.contains(Y,!0))&&(s.multiplier=s.multiplier.multiply(s.power),s.power=s.power.subtract(new v(1)),s.power.equals(0)&&(s=H(s.multiplier))),s}function a(s){let w=s.group,N,I,P;if(w===Ue||w===te&&s.value!==Y||w===Be)s=H(0);else if(w===te)s=U(s);else if(w===Z){let B=s.multiplier.clone();s.toUnitMultiplier();let x=e.multiply(n(s),U(s));return x.multiplier=x.multiplier.multiply(B),x}else if(w===K&&s.power.equals(1)){let B=s.multiplier.clone();switch(s.toUnitMultiplier(),s.fname){case $e:P=s.clone(),s=s.args[0].clone(),s.power=s.power.negate(),s.multiplier=P.multiplier.divide(s.multiplier);break;case c:s.fname=Q,s.multiplier.negate();break;case Q:s.fname=c;break;case p:s.fname=r,s.power=new v(2);break;case r:s=y(s,p);break;case g:s=y(s,"-cot");break;case d:s.fname=g,s.multiplier.negate(),s.power=new v(2);break;case S:s=e.parse(`(sqrt(1-(${W(s.args[0])})^2))^(-1)`);break;case A:s=e.parse(`-(sqrt(1-(${W(s.args[0])})^2))^(-1)`);break;case D:s=e.parse(`(1+(${W(s.args[0])})^2)^(-1)`);break;case qe:I=s.args[0].clone(),I.toUnitMultiplier(),s=e.parse(`${u(W(s.args[0]))}/abs${u(W(I))}`);break;case"parens":s=H(1);break;case"cosh":s.fname="sinh";break;case"sinh":s.fname="cosh";break;case fe:s.fname=ge,s.power=new v(2);break;case ge:s=y(s,"-tanh");break;case Oe:{let x=String(s.args[0]);s=e.parse(`-coth(${x})*csch(${x})`);break}case Ve:{let x=String(s.args[0]);s=e.parse(`-csch(${x})^2`);break}case"asinh":s=e.parse(`(sqrt(1+(${W(s.args[0])})^2))^(-1)`);break;case"acosh":s=e.parse(`(sqrt(-1+(${W(s.args[0])})^2))^(-1)`);break;case"atanh":s=e.parse(`(1-(${W(s.args[0])})^2)^(-1)`);break;case Qe:{let x=String(s.args[0]);s=e.parse(`-1/(sqrt(1/(${x})^2-1)*(${x})^2)`);break}case Ge:s=e.parse(`-1/((${s.args[0]})^2-1)`);break;case Ae:{let x=String(s.args[0]);s=e.parse(`-1/(sqrt(1/(${x})^2+1)*(${x})^2)`);break}case b:{let x=String(s.args[0]);s=e.parse(`1/(sqrt(1-1/(${x})^2)*(${x})^2)`);break}case C:{let x=String(s.args[0]);s=e.parse(`-1/(sqrt(1-1/(${x})^2)*(${x})^2)`);break}case V:s=e.parse(`-1/((${s.args[0]})^2+1)`);break;case"S":{let x=String(s.args[0]);s=e.parse(`sin((pi*(${x})^2)/2)`);break}case"C":{let x=String(s.args[0]);s=e.parse(`cos((pi*(${x})^2)/2)`);break}case"Si":{let x=s.args[0];s=e.parse(`sin(${x})/(${x})`);break}case"Shi":{let x=s.args[0];s=e.parse(`sinh(${x})/(${x})`);break}case"Ci":{let x=s.args[0];s=e.parse(`cos(${x})/(${x})`);break}case"Chi":{let x=s.args[0];s=e.parse(`cosh(${x})/(${x})`);break}case"Ei":{let x=s.args[0];s=e.parse(`e^(${x})/(${x})`);break}case"Li":{let x=s.args[0];s=e.parse(`1/${q.LOG}(${x})`);break}case"erf":s=e.parse(`(2*e^(-(${s.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let x=String(s.args[0]),L=String(s.args[1]);s=e.parse(`(${L})/((${L})^2+(${x})^2)`);break}case"sign":s=new H(0);break;case"sinc":s=e.parse(j("(({0})*cos({0})-sin({0}))*({0})^(-2)",s.args[0]));break;case q.LOG10:s=e.parse(`1/((${s.args[0]})*${q.LOG}(10))`);break;default:s=e.symfunction("diff",[s,h])}s.multiplier=s.multiplier.multiply(B)}else if(w===Le||w===K&&X(s.power)){let B;w===Le?B=s.value:w===K&&s.contains(Y)?B=s.fname+u(W(s.args[0])):B=s.value+u(W(s.args[0])),I=F.diff(e.multiply(e.parse($e+u(B)),s.power.clone()),Y),s=e.multiply(s,I)}else if(w===K&&!s.power.equals(1))I=s.clone(),I.toLinear(),I.toUnitMultiplier(),s=e.multiply(U(s.clone()),a(I));else if(w===ce||w===ue){let B=s.clone(),x=new H(0);for(let L in s.symbols)Object.hasOwn(s.symbols,L)&&(x=e.add(x,F.diff(s.symbols[L].clone(),Y)));s=e.multiply(U(B),x)}return s.updateHash(),s}function y(s,w,N){return e.multiply(s,e.parse(w+u(N||W(s.args[0]))))}function n(s){let w=s.collectSymbols(),N=new H(0),I=w.length;for(let P=0;P<I;P++){let B=F.diff(w[P].clone(),Y);for(let x=0;x<I;x++)P!==x&&(B=e.multiply(B,w[x].clone()));N=e.add(N,B)}return N}},integration:{u_substitution(G,h){let R="__u__";function Y(N,I,P){let B=F.diff(I,h),x=P?P(N,I):e.divide(N.clone(),B);return x.contains(h,!0)?null:x}function U(N,I){let P=F.integrate(e.symfunction(N,[new H(R)]),R,0);return P=P.sub(new H(R),I),P.updateHash(),P}let a=G[0].clone(),y=G[1].clone(),n=a.group,s=y.group,w;if(n===K&&s!==K){let N=a.args[0];if(w=Y(y,N.clone()),w)return e.multiply(w,U(a.fname,N));if(w=Y(y,a),w)return F.integration.poly_integrate(a)}else if(s===K&&n!==K){let N=y.args[0];if(w=Y(a,N.clone()),w)return e.multiply(w,U(y.fname,N))}else if(n===K&&s===K){if(w=Y(a.clone(),y.clone()),w||(w=Y(y.clone(),a.clone()),w))return e.multiply(F.integration.poly_integrate(y),w)}else if(n===Le&&s!==Le){let N=a.power;if(w=Y(y,N.clone()),!w){let B=F.integration.decompose_arg(N.clone(),h),x=F.diff(B[2].clone(),h),L=F.integration.decompose_arg(x.clone(),h);if(e.multiply(B[1],L[1]).power.equals(y.power)){let z=e.divide(B[0].clone(),L[0].clone()),he=e.multiply(z.clone(),e.pow(new H(a.value),e.multiply(B[0],new H(R))));return he=e.multiply(he,new H(R)),F.integration.by_parts(he,R,0,{}).sub(R,B[1].clone())}}let I=F.integrate(a.sub(N.clone(),new H(R)),R,0);return e.multiply(I.sub(new H(R),N),w)}else if(s===Le&&n!==Le){let N=y.power;w=Y(a,N.clone());let I=F.integrate(y.sub(N,new H(R)),R,0);return e.multiply(I.sub(new H(R),N),w)}else if(a.isComposite()||y.isComposite()){let N=function(B,x){let L=F.diff(x,h),z=t.Algebra.Factor.factorInner(B),he=t.Algebra.Factor.factorInner(L);return e.divide(z,he)},I=a.isComposite()?a.clone().toLinear():a.clone(),P=y.isComposite()?y.clone().toLinear():y.clone();if(w=Y(I.clone(),P.clone(),N),w)return e.multiply(F.integration.poly_integrate(y),w);if(w=Y(P.clone(),I.clone(),N),w)return e.multiply(F.integration.poly_integrate(a),w)}},poly_integrate(G){let h=G.power.toString(),R=G.multiplier.toDecimal(),Y=G.toUnitMultiplier().toLinear();return Number(h)===-1?e.multiply(new H(R),e.symfunction($e,[Y])):e.parse(j("({0})*({1})^(({2})+1)/(({2})+1)",R,Y,h))},stop(G){throw G||="Unable to compute integral!",t.Utils.warn(G),new je(G)},partial_fraction(G,h,R,Y){X(h)||(h=e.parse(h));let U;U=new H(0);let a=t.Algebra.PartFrac.partfrac(G,h);return a.group===Z&&a.isLinear()?(a.each(y=>{y.isLinear()||F.integration.stop()}),a.each(y=>{U=e.add(U,F.integrate(y,h,R,Y))})):U=e.add(U,F.integrate(a,h,R,Y)),U},get_udv(G){let h=[[],[],[],[],[]],R=function(a){let y=a.group;if(y===K){let{fname:n}=a;t.Utils.inTrig(n)||t.Utils.inHtrig(n)?h[3].push(a):t.Utils.inInverseTrig(n)?h[1].push(a):n===$e?h[0].push(a):F.integration.stop()}else y===te||a.isComposite()&&a.isLinear()||y===Z&&a.isLinear()?h[2].push(a):y===Le||a.isComposite()&&!a.isLinear()?h[4].push(a):F.integration.stop()};G.group===Z?G.each(a=>{R(H.unwrapSQRT(a,!0))}):R(G);let Y,U=new H(1);for(let a=0;a<5;a++){let y=h[a],n,s=y.length;if(s>0){if(s>1){n=new H(1);for(let w=0;w<s;w++)n=e.multiply(n,y[w].clone())}else n=y[0].clone();Y?U=e.multiply(U,n):(Y=n,Y.multiplier=Y.multiplier.multiply(G.multiplier))}}return[Y,U]},trig_sub(G,h,R,Y,U,a){U||=F.integration.decompose_arg(G.clone().toLinear(),h);let y=U[3],n=U[2],s=U[0],w=U[1];if(w.power.equals(2)&&s.greaterThan(0)){let N=t.Utils.getU(G),I=e.parse(p+u(N)),P=e.parse(`${r+u(N)}^2`),B=e.multiply(G.sub(w,I),P),x=F.integrate(B,N,R,Y).sub(I,w);return t.Utils.clearU(I),x}},by_parts(G,h,R,Y){Y.previous||=[];let U,a=F.integration.get_udv(G),y=a[0],n=a[1],s=H.unwrapSQRT(e.expand(F.diff(y.clone(),h)),!0),w=s.clone().stripVar(h);s=e.divide(s,w.clone());let N=F.integrate(n.clone(),h,R||0),I=e.multiply(N.clone(),s),P=I.toString();if(Y.previous.indexOf(P)!==-1&&t.Utils.inTrig(y.fname)&&n.isE())return Y.is_cyclic=!0,new H(1);Y.previous.push(P);let B=e.multiply(y,N),x=I.multiplier.clone();I.toUnitMultiplier();let L=e.multiply(F.integrate(I.clone(),h,R,Y),w);if(L.multiplier=L.multiplier.multiply(x),U=e.subtract(B,L),Y.is_cyclic&&(Y.previous.pop(),Y.previous.length===0)){U=e.expand(U);let z=new H(0);U.each(he=>{he.contains(h)||(z=e.add(z,he.clone()))}),U=e.divide(e.subtract(U,z.clone()),e.subtract(new H(1),z))}return U},decompose_arg:t.Utils.decompose_fn},integrate(G,h,R,Y){if(!h){let U=t.Utils.variables(G);U.length===1&&(h=U[0]),h||="x"}if(t.Utils.isVector(G)){let U=new t.Vector([]);return G.each(a=>{U.elements.push(F.integrate(a,h))}),U}return isNaN(h)||e.error(`variable expected but received ${h}`),G.isConstant(!0)?e.multiply(G.clone(),e.parse(h)):(Y||={},t.Utils.block("PARSE2NUMBER",()=>{R||=0;let U=X(h)?h.toString():h,a=H.unwrapSQRT(G.clone(),!0),y=a.group,n;try{if(++R>t.Settings.integration_depth&&F.integration.stop("Maximum depth reached. Exiting!"),!a.contains(U,!0))n=e.multiply(a.clone(),e.parse(U));else if(y===te)n=F.integration.poly_integrate(a,U,R);else if(y===Le)if(a.previousGroup===K&&!(a.fname==="sqrt"||a.fname===q.PARENTHESIS)&&F.integration.stop(),a.contains(U)&&a.previousGroup!==K)a.power.contains(U)?F.integration.stop():(F.diff(a.clone().toLinear(),U).contains(U)&&F.integration.stop(),n=F.integration.poly_integrate(a,U,R));else{let s=F.diff(a.power.clone(),U);if(s.contains(U)){let w=s.stripVar(U),N=e.divide(s.clone(),w.clone());if(N.group===te&&N.isLinear())return w.multiplier=w.multiplier.divide(new v(2)),e.parse(j("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",w,U,a.multiplier));F.integration.stop()}if(a.isE())s.isLinear()?n=a:s.isE()&&s.power.group===te&&s.power.power.equals(1)?n=e.multiply(e.symfunction("Ei",[a.power.clone()]),a.power):F.integration.stop();else{let w=e.symfunction($e,[e.parse(a.value)]);n=e.divide(a,w)}n=e.divide(n,s)}else if(a.isComposite()&&a.isLinear()){let s=e.parse(a.multiplier);a.toUnitMultiplier(),n=new H(0),a.each(w=>{n=e.add(n,F.integrate(w,U,R))}),n=e.multiply(s,n)}else if(y===ce)if(a.power.greaterThan(1)&&(a=e.expand(a)),a.power.equals(1))n=new H(0),a.each(s=>{n=e.add(n,F.integrate(s,U,R))},!0);else{let s=Number(a.power),w=a.multiplier.clone();a.toUnitMultiplier();let N=a.clone().toLinear(),I=F.integration.decompose_arg(N,U),P=I[3],B=I[2],x=I[0],L=I[1];if(s===-1&&L.group!==ue&&L.power.equals(2)){let z=re(P)?P>0:!0;if(L.group===te&&L.power.equals(2)&&z){let he=function(Ze){let xe=new H(1);return Ze.each(be=>{xe=e.multiply(xe,be.fname==="abs"?be.args[0]:be)}),xe},Se=x.clone(),Re=P.clone();Se=e.pow(Se,new H(1/2)),Re=e.pow(Re,new H(1/2));let Fe=e.multiply(he(Re),he(Se)),De=e.symfunction(D,[e.divide(e.multiply(x,L.toLinear()),Fe.clone())]);n=e.divide(De,Fe)}else if(L.group===te&&L.isLinear())n=e.divide(F.integration.poly_integrate(a),x);else if(L.power.equals(4)){let he=u,Se=e.parse(`${me+he(x)}*${U}^2`),Re=e.parse(`${me+he(2)}*${he(x)}^${he("1/4")}*${he(P)}^${he("1/4")}*${U}`),Fe=e.parse(me+he(P)),De=e.add(e.add(Se.clone(),Re.clone()),Fe.clone()),Ze=e.add(e.subtract(Se,Re),Fe),xe=e.parse(`${me+he(2)}*${he(P)}^${he("3/4")}`),be=e.parse(`${me+he(P)}*${he(P)}^${he("1/4")}*${U}`),lt=e.parse(`2*${he(P)}*${me}${he(2)}*${he(P)}^${he("1/4")}`),ut=e.divide(e.subtract(xe.clone(),be.clone()),e.multiply(lt.clone(),Ze)),mt=e.divide(e.add(xe,be),e.multiply(lt,De.clone()));n=e.add(F.integrate(ut,U,R,Y),F.integrate(mt,U,R,Y))}else n=F.integration.partial_fraction(a,U,R)}else if(s===-1/2)if(L.group===te&&L.power.equals(2))if(B.multiplier.lessThan(0)&&!P.multiplier.lessThan(0))if(x.negate(),P.isConstant()&&x.isConstant()){let z=e.symfunction(me,[x.clone()]),he=e.symfunction(me,[e.multiply(x.clone(),P)]);n=e.divide(e.symfunction(S,[e.divide(B.toLinear(),he)]),z)}else{let z=e.symfunction(me,[x]),he=e.multiply(z.clone(),L.clone().toLinear());n=e.divide(e.symfunction(D,[e.divide(he,e.symfunction(me,[N.clone()]))]),z)}else F.integration.stop();else F.integration.stop();else if(s===1/2&&L.power.equals(2)&&x.greaterThan(0))F.integration.stop();else if(L.isLinear()&&L.group!==ue)n=e.divide(F.integration.poly_integrate(a),x);else if(L.power.equals(2)&&x.greaterThan(0)){let z=e.parse(me+u(x)),he=e.parse(me+u(P)),Se=e.multiply(z.clone(),he.clone()).invert(),Re=e.pow(P,new H(a.power)),Fe=t.Utils.getU(a),De=e.multiply(Se,L.clone().toLinear()),Ze=e.symfunction(D,[De]),xe=(Math.abs(a.power)-1)*2,be=F.integrate(e.parse(`${c+u(Fe)}^${xe}`));return t.Utils.clearU(Fe),e.multiply(be.sub(Fe,Ze),Re)}else if(a.group!==Z&&!a.power.lessThan(0))n=F.integration.by_parts(a,U,R,Y);else{let z=a.clone().toLinear(),Se=t.Algebra.Factor.factorInner(z).toString()!==z.toString();if(t.Algebra.degree(z,e.parse(U)).equals(2)&&!Se)try{let Re=t.Algebra.sqComplete(z,U),Fe=t.Utils.getU(z),De=Re.f.sub(Re.a,Fe),Ze=e.pow(De,e.parse(a.power));n=F.integrate(Ze,Fe).sub(Fe,Re.a)}catch(Re){if(Re.message==="timeout")throw Re;F.integration.stop()}else n=F.integration.partial_fraction(a,U,R,Y)}n.multiplier=n.multiplier.multiply(w)}else if(y===K){let s=a.args[0],w=a.multiplier.clone();a.toUnitMultiplier();let N=F.integration.decompose_arg(s,U),I=N[0],P=N[1],{fname:B}=a;if(B===$e||B===S||B===A||B===D&&P.isLinear()){let x=a.power.toString();if(re(x)&&(R-=x),s.isComposite()){let L=t.Utils.getU(a),z=e.pow(e.parse($e+u(L)),new H(x)),he=F.diff(s,U),Se=e.multiply(z,he),Re=F.integrate(Se,L,R,Y);n=e.multiply(e.parse(w),Re.sub(L,s))}else n=e.multiply(e.parse(w),F.integration.by_parts(a,U,R,Y))}else if(B===p&&a.power.lessThan(0)){let x=a.clone();return x.power.negate(),x.fname=d,e.multiply(e.parse(w),F.integrate(x,U,R))}else{if(!I.contains(U,!0)&&a.isLinear())if(B===qe){let x=e.divide(s.clone(),I.clone());if(x.group===te&&!x.power.lessThan(0))if(t.Utils.even(x.power))n=F.integrate(s,U,R);else{let L=F.integrate(x,U,R);L.power=L.power.subtract(new v(1)),n=e.multiply(e.multiply(e.symfunction(qe,[x.toLinear()]),L),I)}else F.integration.stop()}else{let x=a.args[0].group,L=F.integration.decompose_arg(s,U);switch((!(x===ce||x===te||x===Z)||!L[1].power.equals(1)||s.hasFunc())&&F.integration.stop(),B){case c:n=e.symfunction(Q,[s]);break;case Q:n=e.symfunction(c,[s]),n.negate();break;case p:n=e.parse(j(`${q.LOG}(sec({0}))`,s));break;case r:n=e.parse(j(`${q.LOG}(tan({0})+sec({0}))`,s));break;case g:n=e.parse(j(`-${q.LOG}(csc({0})+cot({0}))`,s));break;case d:n=e.parse(j(`${q.LOG}(sin({0}))`,s));break;case J:n=e.symfunction(ie,[s]);break;case ie:n=e.symfunction(J,[s]);break;case fe:n=e.parse(j(`${q.LOG}(cosh({0}))`,s));break;case b:n=F.integration.by_parts(a,U,R,Y);break;case C:n=F.integration.by_parts(a,U,R,Y);break;case V:n=F.integration.by_parts(a,U,R,Y);break;case Qe:n=F.integration.by_parts(a,U,R,Y);break;case Ae:n=F.integration.by_parts(a,U,R,Y);break;case Ge:n=F.integration.by_parts(a,U,R,Y);break;case ge:n=e.parse(j("atan(sinh({0}))",s));break;case Oe:n=e.parse(j(`${q.LOG}(tanh(({0})/2))`,s));break;case Ve:n=e.parse(j(`${q.LOG}(sinh({0}))`,s));break;case ve:n=F.integrate(e.parse(j("e^({0})",s)),U,R);break;case"S":{let z=a.args[0].clone(),he=F.integration.decompose_arg(z,U),Se=he[1],Re=he[0],Fe=he[3];n=e.parse(j("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Re,Fe,P));break}case"C":{let z=a.args[0].clone(),he=F.integration.decompose_arg(z,U),Se=he[1],Re=he[0],Fe=he[3];n=e.parse(j("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Re,Fe,Se));break}case"erf":{let z=a.args[0].clone(),he=F.integration.decompose_arg(z,U),Se=he[1],Re=he[0];n=e.parse(j("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Re,Se,z));break}case"sign":n=e.multiply(a.clone(),s.clone());break;default:F.integration.stop()}n=e.divide(n,I)}else if(P.isLinear())if(B===c||B===Q){let x=Number(a.power);if(x<0)a.fname=B===Q?g:r,a.invert().updateHash(),n=F.integrate(a,U,R);else{let L=a.args[0],z=a.clone(),he=a.clone(),Se=new H((x-1)/x),Re=e.multiply(I.clone(),new H(x)).invert();z.power=z.power.subtract(new v(1)),he.power=he.power.subtract(new v(2));let Fe=e.symfunction(B===c?Q:c,[s.clone()]);B===Q&&Fe.negate(),n=e.add(e.multiply(e.multiply(Re,z),Fe),e.multiply(Se,F.integrate(e.parse(he),U,R)))}}else if(B===p||B===d){if(a.args[0].isLinear(U)){let x=a.power.subtract(new v(1)).toString(),L=a.clone().toUnitMultiplier(),z=e.parse(j(`${B===d?"-":""}1/({2}*{0})*{3}({1})^({0})`,x,s,I,B));L.power=L.power.subtract(new v(2)),L.power.equals(0)&&(L=e.parse(L)),n=e.subtract(z,F.integrate(L,U,R))}}else if(B===r||B===g){let x=a.power.subtract(new v(1)).toString(),L=a.power.subtract(new v(2)).toString(),z=B===r?p:d,he=a.clone().toUnitMultiplier(),Se=j(`${B===g?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,I,x,L,s,B,z),Re=e.parse(Se);he.power=he.power.subtract(new v(2)),he.power.equals(0)&&(he=e.parse(he)),n=e.add(Re,e.multiply(new H(L/x),F.integrate(he,U,R)))}else(B===ie||B===J)&&a.power.equals(2)?n=F.integrate(a.fnTransform(),U,R):F.integration.stop();else F.integration.stop();n.multiplier=n.multiplier.multiply(w)}}else if(y===ue)n=F.integration.partial_fraction(a,U,R);else if(y===Z){a.getDenom().group===te&&(a=e.expand(a));let w=a.stripVar(U),N=e.divide(a.clone(),w.clone());if(w.contains(U)&&(N=e.multiply(N,w),w=new H(1)),N.group===Z){let I=N.collectSymbols().sort((B,x)=>B.group===x.group?Number(B.power)===Number(x.power)?B<x?1:-1:x.power-B.power:x.group-B.group).map(B=>{let x=H.unwrapSQRT(B,!0);return x.fname===ve?e.parse(j("({1})*e^({0})",x.args[0],x.multiplier)):x}),P=I.length;if(a.power<0){if(P===2)return F.integrate(e.expand(a),U,R,Y)}else if(P===2){try{n=F.integration.u_substitution(I,U)}catch(B){if(B.message==="timeout")throw B}if(!n){let B=I[0].group,x=I[1].group,L=I[0],z=I[1],he=L.fname,Se=z.fname;if(a=e.multiply(L.clone(),z.clone()),B===K&&x===K)if(he===$e||Se===$e)n=F.integration.by_parts(a.clone(),U,R,Y);else{I.sort((be,lt)=>lt.fname>be.fname);let Re=L.args[0];(!Re.isLinear()||!(Re.group===ce||Re.group===Z||Re.group===te))&&F.integration.stop();let Fe=F.integration.decompose_arg(Re,U),De=Fe[1],Ze=Fe[0];De.isLinear()||F.integration.stop();let xe=z.args[0];if(Re.equals(xe))if(he===Q&&Se===c||he===c&&Se===Q)if(L.power.lessThan(0)&&F.integration.stop(),he===Q&&L.power.add(z.power).equals(0))L.fname=p,L.updateHash(),n=F.integrate(L,U,R);else if(de(L.power)&&Se===c&&z.power.lessThan(0)){let be=Number(L.power)/2,lt=e.parse(j("(1-cos({0})^2)^({1})",L.args[0],be));n=F.integrate(e.expand(e.multiply(lt,z.clone())),U,R,Y)}else if(de(L.power)&&Se===Q&&z.power.lessThan(0)){let be=Number(L.power)/2,lt=e.parse(j("(1-sin({0})^2)^({1})",L.args[0],be));n=F.integrate(e.expand(e.multiply(lt,z.clone())),U,R,Y)}else{let be=t.Utils.even(L.power),lt=t.Utils.even(z.power);if(n=new H(0),!be||!lt){let ut,mt;be?(ut=L,mt=z):(ut=z,mt=L);let At=ut.fname===c?-1:1,dt=(mt.power-1)/2,_t=e.parse(`(1-${ut.fname}${t.Utils.inBrackets(Re)}^2)^${dt}`);e.expand(e.multiply(new H(At),e.multiply(ut.clone(),_t))).each(Lt=>{n=e.add(n,F.integration.poly_integrate(Lt.clone()))})}else{let ut=function(_t){let Lt=_t.power/2,Gt;return _t.fname===c?Gt=`((1/2)+(cos(2*(${_t.args[0]}))/2))^${Lt}`:Gt=`((1/2)-(cos(2*(${_t.args[0]}))/2))^${Lt}`,e.parse(Gt)},mt=ut(L),At=ut(z),Ft=e.multiply(mt,At);return e.expand(Ft).each(_t=>{n=e.add(n,F.integrate(_t,U,R))}),e.multiply(n,w)}}else if(he===r&&Se===p&&De.isLinear()&&z.isLinear())n=e.parse(j("sec({0})^({1})/({1})",L.args[0],L.power));else if(he===p&&Se===r&&De.isLinear())if(L.isLinear()&&z.isLinear())n=e.divide(e.symfunction(r,[Re.clone()]),Ze);else if(de(L.power)){let be=Number(L.power)/2,lt=e.parse(j("(sec({0})^2-1)^({1})",L.args[0],be));n=F.integrate(e.expand(e.multiply(lt,z)),U,R)}else F.integration.stop();else if(he===r&&Se===c)L.fname=c,L.invert().updateHash(),n=F.integrate(e.multiply(L,z),U,R);else if(he===Q&&Se===g)z.fname=Q,z.invert().updateHash(),n=F.integrate(e.multiply(L,z),U,R);else if(he===p&&(Se===c||Se===Q)&&z.power.lessThan(0)){let be=e.multiply(L.fnTransform(),z);n=F.integrate(e.expand(be),U,R)}else{let be=e.multiply(L.fnTransform(),z.fnTransform());n=F.integrate(e.expand(be),U,R)}else if((he===Q||he===c)&&(Se===Q||Se===c))if(L.isLinear()&&z.isLinear())if(L.args[0].isLinear()&&z.args[0].isLinear()){let be,lt;Se===Q?(be=L.args[0],lt=z.args[0]):(lt=L.args[0],be=z.args[0]);let ut=e.parse(j("(sin(({1})+({0}))+sin(({1})-({0})))/2",be.toString(),lt.toString()));n=F.integrate(ut,U,R)}else{let be=Te(I);n=F.integrate(e.expand(be),U,R)}else{let be=new H(1);I.forEach(ut=>{let mt=ut.fnTransform();be=e.multiply(be,mt)});let lt=e.expand(be);n=F.integrate(lt,U,R),n.hasIntegral()&&(n=F.integrate(Te(be.collectSymbols()),U,R))}else F.integration.stop()}else if(B===K&&x===te){let Re=L.isLinear();if(L.fname===c&&Re&&z.power.equals(-1))n=e.symfunction("Ci",[L.args[0]]);else if(L.fname===c&&z.power.equals(-1))n=F.integrate(e.multiply(L.fnTransform(),z.clone()),U,R);else if(L.fname===ie&&Re&&z.power.equals(-1))n=e.symfunction("Chi",[L.args[0]]);else if(L.fname===ie&&z.power.equals(-1))n=F.integrate(e.multiply(L.fnTransform(),z.clone()),U,R);else if(L.fname===Q&&Re&&z.power.equals(-1))n=e.symfunction("Si",[L.args[0]]);else if(L.fname===Q&&z.power.equals(-1))n=F.integrate(e.multiply(L.fnTransform(),z.clone()),U,R);else if(L.fname===J&&Re&&z.power.equals(-1))n=e.symfunction("Shi",[L.args[0]]);else if(L.fname===J&&z.power.equals(-1))n=F.integrate(e.multiply(L.fnTransform(),z.clone()),U,R);else if(L.fname===$e&&z.power.equals(-1))n=F.integration.poly_integrate(L,U,R);else if(L.fname==="erf"){if(z.power.equals(1)){let Fe=F.integration.decompose_arg(L.args[0],U),De=Fe[0],Ze=Fe[1],xe=L.args[0].toString();n=e.parse(j("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",De,Ze,xe))}}else n=F.integration.by_parts(a,U,R,Y)}else if(B===Le&&x===te){let Re=he===$e?F.integration.decompose_arg(L.args[0],U)[1]:null;L.isE()&&(L.power.group===te||L.power.group===Z)&&z.power.equals(-1)?n=e.symfunction("Ei",[L.power.clone()]):he===$e&&Re.value===z.value?n=F.integration.poly_integrate(L,U,R):n=F.integration.by_parts(a,U,R,Y)}else if(B===ue&&x===te){if(z.value===L.value&&L.power.equals(-1)){let Re=Math.min.apply(null,t.Utils.keys(L.symbols)),Fe=Math.min(Re,z.power),De=z.clone();De.power=new v(Fe),z=e.divide(z,De.clone());let Ze=new H(0);L.each(xe=>{Ze=e.add(Ze,e.divide(xe.clone(),De.clone()))}),Ze.multiplier=L.multiplier,a=e.divide(z,Ze)}else a=e.expand(a);n=F.integration.partial_fraction(a,U,R)}else if(B===ce&&x===te){let Re=L.clone().toLinear(),Fe=t.Algebra.degree(Re,e.parse(U)).equals(1);if(L.power.equals(-1/2)){let De=F.integration.decompose_arg(L.clone().toLinear(),U),Ze=De[0].negate(),xe=De[1],be=De[3],lt=Number(L.power),ut=Number(z.power);if(re(ut)&&t.Utils.even(ut)&&xe.power.equals(2)){let mt=e.divide(e.multiply(e.pow(be.clone(),new H(2)),e.symfunction(me,[e.divide(be.clone(),Ze.clone())])),e.pow(Ze.clone(),new H(2)));mt=e.multiply(mt,e.symfunction(me,[be]).invert());let At=e.parse("sin(u)");At.power=At.power.multiply(z.power);let Ft=F.integrate(At,"u",R),dt=e.parse(`${S}(${me}(${Ze}/${be})*${U})`);n=e.multiply(mt,Ft.sub(new H("u"),dt))}else if(lt===-1/2){let mt=function(At,Ft){let dt=e.parse(F.integrate(At,U,R,Y).sub(U,j(Ft,U)));if(!dt.hasIntegral())return dt};ut===-1?n=mt(e.expand(e.expand(e.pow(e.multiply(L.invert(),z.invert()),new H(2)))).invert(),"sqrt(1-1/({0})^2)"):ut===-2&&(n=mt(e.sqrt(e.expand(e.divide(e.pow(a,new H(2)).invert(),e.pow(new H(U),new H(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(L.power.equals(-1)&&z.isLinear()&&Fe)n=F.integration.partial_fraction(a,U,R);else if(!L.power.lessThan(0)&&re(L.power)){let De=e.expand(L);n=new H(0),De.each(Ze=>{Ze.group===ue?Ze.each(xe=>{n=e.add(n,F.integrate(e.multiply(z.clone(),xe),U,R))}):n=e.add(n,F.integrate(e.multiply(z.clone(),Ze),U,R))})}else if(L.power.lessThan(-2))n=F.integration.by_parts(a,U,R,Y);else if(L.power.lessThan(0)&&z.power.greaterThan(1)){let De=F.integration.decompose_arg(L.clone().toLinear(),U),Ze=De[0].negate(),xe=De[1],be=De[3],lt=L.clone().toLinear();if(xe.group!==ue&&xe.isLinear()){let ut=Number(z.power),mt="_u_",At=new H(mt),Ft=e.expand(e.divide(e.pow(e.subtract(At.clone(),be.clone()),new H(ut)),At.clone())),dt={};dt[mt]=lt;let _t=e.parse(Ft,dt);n=F.integrate(_t,U,0)}else if(z.power.greaterThan(xe.power)||z.power.equals(xe.power)){let ut=new t.Algebra.Classes.Factors;L=t.Algebra.Factor.coeffFactor(L.invert(),ut);let mt=t.Algebra.divide(z,L);mt.group===Z?n=F.integration.by_parts(a,U,R,Y):(n=new H(0),mt.each(At=>{n=e.add(n,F.integrate(At,U,R))}),ut.each(At=>{n=e.divide(n,At)}),n=e.expand(n))}else n=F.integration.partial_fraction(a,U,R)}else if(L.power.den.equals(2)){let De=F.integration.decompose_arg(L.clone().toLinear(),U),Ze=De[3],xe=De[1],be=De[0],lt=De[2];if(xe.power.equals(2)&&be.lessThan(0)){Ze.equals(1)||(w=e.multiply(w,e.pow(Ze,new H(2))));let ut=U,mt=e.divide(e.pow(be.clone().negate(),new H(1/2)),e.pow(Ze,new H(1/2))),At=e.symfunction(c,[new H(ut)]),Ft=e.pow(e.symfunction(c,[new H(ut)]),new H(L.power.num)),dt=e.pow(e.symfunction(Q,[new H(ut)]),new H(z.power)),_t=e.multiply(e.multiply(Ft,At),dt);n=F.integrate(_t,ut,R).sub(ut,e.symfunction(S,[e.multiply(new H(U),mt)]))}else n=F.integration.partial_fraction(a,U,R,Y)}else Fe&&(n=F.integration.partial_fraction(a,U,R))}else if(L.isComposite()&&z.isComposite())if(n=new H(0),L.power.greaterThan(0)&&z.power.greaterThan(0))e.expand(a).each(Fe=>{n=e.add(n,F.integrate(Fe,U,R))},!0);else{let Re=Number(L.power),Fe=Number(z.power);if(Re<0&&Fe>0){let De=L;L=z,z=De}Re===-1&&Fe===-1?n=F.integration.partial_fraction(a,U):L.each(De=>{let Ze=e.multiply(De,z.clone()),xe=F.integrate(Ze,U,R);n=e.add(n,xe)})}else if(B===ce&&I[0].power.greaterThan(0))L=e.expand(L),n=new H(0),L.each(Re=>{n=e.add(n,F.integrate(e.multiply(Re,z.clone()),U,R))},!0);else if(B===K&&x===Le&&t.Utils.inHtrig(L.fname))L=L.fnTransform(),n=F.integrate(e.expand(e.multiply(L,z)),U,R);else if(B===K&&x===ce||x===K&&B===ce){if(x===K&&B===ce){let lt=L;L=z,z=lt}let Re,Fe,De,Ze,xe=H.unwrapSQRT(F.diff(L.clone(),U),!0),be=H.unwrapSQRT(z,!0);if(xe.power.equals(be.power)){if(Re=new H(z.power),De=xe.clone().toLinear(),Ze=z.clone().toLinear(),Fe=t.Algebra.divide(De.toLinear(),Ze),Fe.isConstant()){let lt=e.pow(Fe,Re.negate());n=e.multiply(lt,F.integration.poly_integrate(L.clone()))}}else n=F.integration.by_parts(a,U,R,Y)}else{let Re=L.clone().toLinear(),Fe=z.clone().toLinear();B===Le&&x===Le&&L.power.contains(U)&&z.power.contains(U)&&!Re.contains(U)&&!Fe.contains(U)?n=e.parse(j("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Re.toString(),Fe.toString(),L.power.multiplier.toString(),z.power.multiplier.toString(),U)):n=F.integration.by_parts(a,U,R,Y)}}}else if(P===3&&(I[2].group===te&&I[2].power.lessThan(2)||I[0].group===ce)){let B=I[0];if(B.group===ce){B.power.greaterThan(1)&&(B=e.expand(B));let x=e.multiply(I[1],I[2]);n=new H(0),B.each(L=>{let z=e.multiply(L,x.clone()),he=F.integrate(z,U,R);n=e.add(n,he)},!0)}else n=F.integration.by_parts(a,U,R,Y)}else if(tt(I)){let B=new H(1);for(let x=0,L=I.length;x<L;x++)B=e.multiply(B,I[x].fnTransform());B=e.expand(B),n=F.integrate(B,U,R)}else{let B=Te(I);n=F.integrate(e.expand(B),U,R)}}else{if(N.equals(1))return F.integrate(e.expand(a),U,R);N.clone().toLinear().isPoly(!0)&&t.Utils.variables(N).length>1&&(N=t.Algebra.Factor.factorInner(N)),n=F.integrate(N,U,R)}n=e.multiply(n,w)}if(n)return n}catch(s){if(s.message==="timeout"||!(s instanceof je||s instanceof t.exceptions.DivisionByZero))throw s}return e.symfunction("integrate",[G,h])},!1))},defint(G,h,R,Y){Y||="x";let U=function(w,N,I){try{return e.parse(w,N)}catch(P){if(P.message==="timeout")throw P;return F.Limit.limit(w,Y,I)}},a=t.Utils.variables(G),y=G.hasTrig(),n,s;if(a.length===1&&!Y&&(Y=a[0]),y||(s=F.integrate(G,Y)),!y&&!s.hasIntegral()){let w={},N={};w[Y]=R,N[Y]=h;let I=U(s,w,R,Y),P=U(s,N,h,Y);n=e.subtract(I,P)}else if(a.length===1&&h.isConstant()&&R.isConstant()){let w=t.Utils.build(G);n=new H(t.Math2.num_integrate(w,Number(h),Number(R)))}else n=e.symfunction("defint",[G,h,R,Y]);return n},Limit:{interval(G,h){return e.parse(j("[{0}, {1}]",G,h))},diverges(){return F.Limit.interval("-Infinity","Infinity")},divide(G,h,R,Y,U){if(U++>q.max_lim_depth)return;let a=G.clone(),y=h.clone();if(h.fname===qe){let z=G.sign(),he=Y.sign();if(Y.isInfinity)return e.multiply(new H(z),new H(he));if(Y.equals(0)){let Se=e.parse(G.multiplier),Re=e.parse(h.multiplier);return e.divide(e.multiply(Se,F.Limit.interval("-1","1")),Re)}return F.Limit.diverges()}let n=function(z){if(t.Utils.isVector(z)){for(let he=0;he<z.elements.length;he++)if(!z.elements[he].isInfinity)return!1;return!0}return z.isInfinity},s=function(z,he){return t.Utils.isVector(z)?!1:z.equals(he)},w,N=0,I,P,B;do if(I=_e(F.Limit.limit(G.clone(),R,Y,U)),P=_e(F.Limit.limit(h.clone(),R,Y,U)),B=n(I)&&n(P)||s(I,0)&&s(P,0),B){let z=F.diff(G.clone(),R),he=F.diff(h.clone(),R),Se=e.divide(z,he);G=Se.getNum(),h=Se.getDenom()}while(B&&++N<q.max_lim_depth);if(N>=q.max_lim_depth)return;let x=P.equals(0),L=Number(y.power);return Y.isConstant(!0)&&x?w=H.infinity(t.Utils.even(L)&&I.lessThan(0)?-1:void 0):x?w=F.Limit.diverges():w=e.divide(I,P),w},rewriteToLog(G){let h=G.power.clone();return G.toLinear(),e.pow(new H("e"),e.multiply(h,e.symfunction(`${q.LOG}`,[G])))},getSubbed(G,h,R){let Y;G.group===Le&&(G=F.rewriteToLog(G));try{Y=G.sub(h,R)}catch(U){if(U.message==="timeout")throw U;Y=G}return Y},isInterval(G){return t.Utils.isVector(G)},isConvergent(G){return!(F.Limit.isInterval(G)&&G.elements[0].isInfinity&&G.elements[1].isInfinity||G.containsFunction("limit"))},limit(G,h,R,Y){if(G.isLinear()&&G.isComposite()){let y=new H(0);return G.each(n=>{y=e.add(y,F.Limit.limit(n,h,R,Y))},!0),y}if(G=t.Algebra.Simplify.simplify(G),Y||=1,Y++>q.max_lim_depth)return;let U=e.parse(G.multiplier);G.toUnitMultiplier();let a;try{if(G.isConstant(!0))a=G;else{let y={};y[h]=R;try{let n=e.parse(G.sub(h,R),y);(n.isConstant(!0)||n.isInfinity)&&(a=n)}catch(n){if(n.message==="timeout")throw n}if(!a){let n=G.getNum(),s=G.getDenom();if(s.isConstant(!0)){if(G.group===Le){let w=G.clone().toLinear(),N=G.power.clone(),I=w.getNum(),P=w.getDenom(),B=t.Utils.decompose_fn(P,h,!0);if(I.group===te&&I.multiplier.isOne()&&B.ax.group===te&&B.b.isConstant(!0)&&B.a.isOne()&&B.b.isConstant(!0))a=e.parse(j("(1/e^({0}))",B.b));else{let x=F.Limit.rewriteToLog(G.clone()),L=x.power.clone(),z=x.clone().toLinear(),he=F.Limit.limit(z,h,R,Y),Se=F.Limit.limit(L,h,R,Y);a=e.pow(he,Se)}}else if(G.group===K&&G.args.length===1){let w,N=F.Limit.limit(G.args[0],h,R,Y);if(t.Utils.isVector(N))return a=N.map(P=>{let B=G.clone();return B.args[0]=P,F.Limit.limit(e.symfunction(G.fname,[P]),h,R,Y)}),e.multiply(U,a);let I;if(N.isConstant(!0)){I=e.symfunction(G.fname,[N]);try{_e(I),w=!0}catch(P){if(P.message==="timeout")throw P;w=!1}}if(w)a=I;else if(F.Limit.isConvergent(N)){if(G.fname===$e)switch(N.toString()){case"0":a=H.infinity().negate();break;case"Infinity":a=H.infinity();break;case"-Infinity":a=H.infinity();break}else if((G.fname===c||G.fname===Q)&&R.isInfinity)a=F.Limit.interval(-1,1);else if(G.fname===p){let P=G.args[0],B=P.getNum(),x=P.getDenom(),L=B.toUnitMultiplier();(R.isInfinity||L.equals("pi")&&x.equals(2))&&(a=F.Limit.diverges())}else if(G.fname===q.FACTORIAL&&N.isInfinity)return H.infinity()}}else if(G.group===te){if(G.power>0)return e.parse(G,y);t.Utils.even(G.power)?a=H.infinity():a=F.Limit.diverges()}else if(G.group===Z){let w,N,I=G.collectSymbols().sort((B,x)=>B.group-x.group),P=I.pop();for(w=_e(F.Limit.limit(P,h,R,Y));I.length;){let B=I.pop();N=_e(F.Limit.limit(B,h,R,Y)),w.isInfinity||!F.Limit.isConvergent(w)&&N.equals(0)||w.equals(0)&&F.Limit.isConvergent(N)?(B.containsFunction($e)&&(B=[P,P=B][0]),B.invert(),w.isInfinity&&N.isInfinity?w=H.infinity():w=F.Limit.divide(P,B,h,R,Y)):(w=e.multiply(w,N),P=e.multiply(P,B))}a=w}else if(G.isComposite()){let w;G.isLinear()||(G=e.expand(G)),a=new H(0);let N=G.collectSymbols().sort((B,x)=>x.group-B.group),I=[],P=new H(0);for(let B=0,x=N.length;B<x;B++){let L=N[B].clone();L.group===K||L.group===Z&&L.hasFunc()?P=e.add(P,L):I.push(L)}I.unshift(P),I.length!==1&&(N=I);for(let B=0,x=N.length;B<x;B++){let L=N[B];try{w=F.Limit.limit(L,h,R,Y)}catch(z){if(z.message==="timeout")throw z;w=F.Limit.diverges()}try{a=e.add(a,w)}catch(z){if(z.message==="timeout")throw z;if(Y++>q.max_lim_depth)return;a=F.Limit.limit(F.diff(G,h),h,R,Y)}}}}else a=F.Limit.divide(n,s,h,R,Y)}}a||=e.symfunction("limit",[G,h,R])}catch(y){if(y.message==="timeout")throw y;a=e.symfunction("limit",[G,h,R])}return e.multiply(U,a)}},Fresnel:{S(G){return G.isConstant(!0)?F.defint(e.parse("sin(pi*x^2/2)"),H(0),G,"x"):e.symfunction("S",[G])},C(G){return G.isConstant(!0)?F.defint(e.parse("cos(pi*x^2/2)"),H(0),G,"x"):e.symfunction("C",[G])}}};e1.register([{name:"diff",visible:!0,numargs:[1,3],build(){return F.diff}},{name:"sum",visible:!0,numargs:4,build(){return F.sum}},{name:"product",visible:!0,numargs:4,build(){return F.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return F.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return F.defint}},{name:"S",visible:!0,numargs:1,build(){return F.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return F.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return F.Limit.limit}}]),e1.updateAPI()})()});var n1=E0((zi,En)=>{"use strict";var T0;typeof En<"u"&&(T0=G0(),t1());(function(){let t=T0.getCore(),e=t.PARSER,{N:v}=t.groups,{P:q}=t.groups,{S:X}=t.groups,{EX:K}=t.groups,{FN:H}=t.groups,{PL:W}=t.groups,{CP:u}=t.groups,{CB:re}=t.groups,{keys:j}=t.Utils,{even:de}=t.Utils,{variables:_e}=t.Utils,{format:Ue}=t.Utils,{round:te}=t.Utils,{Frac:ue}=t,{isInt:ce}=t.Utils,{NerdamerSymbol:Z}=t,{CONST_HASH:Le}=t.Settings,Be=t.Utils.importFunctions(),$e=t.Utils.evaluate;function ve(c,p,r){if(t.Utils.isSymbol(c))this.parse(c),this.variable||=p;else if(isNaN(c))typeof c=="string"&&this.parse(e.parse(c));else{if(r||=0,p===void 0)throw new t.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[r]=c,this.fill(c)}}ve.fromArray=function(p,r){if(typeof r>"u")throw new t.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let g=new ve;return g.coeffs=p,g.variable=r,g},ve.fit=function(p,r,g,d,S,A){let D=new Array(S+1),b=g-r;D[0]=r,D[S]=p,b-=p*d**S;for(let C=S-1;C>0;C--){let V=d**C,J=b/V,fe=Math.sign(J)*Math.floor(Math.abs(J));b-=fe*V,D[C]=fe}if(b!==0)return null;for(let C=0;C<D.length;C++)D[C]=new ue(D[C]);return ve.fromArray(D,A)},ve.prototype={parse(c,p){if(this.variable=_e(c)[0],!c.isPoly())throw t.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${t.Utils.text(c)}`);if(p||=[],c.power.absEquals(1)||(c=e.expand(c)),c.group===t.groups.N)p[0]=c.multiplier;else if(c.group===t.groups.S)p[c.power.toDecimal()]=c.multiplier;else for(let r in c.symbols){if(!Object.hasOwn(c.symbols,r))continue;let g=c.symbols[r],d=g.power;if(t.Utils.isSymbol(d))throw new t.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");d=g.group===v?0:d.toDecimal(),g.symbols?this.parse(g,p):p[d]=g.multiplier}this.coeffs=p,this.fill()},fill(c){c=Number(c)||0;let p=this.coeffs.length;for(let r=0;r<p;r++)this.coeffs[r]===void 0&&(this.coeffs[r]=new ue(c));return this},trim(){let c=this.coeffs.length;for(;c--;){let p=this.coeffs[c],r=p.equals(0);if(p&&r){if(c===0)break;this.coeffs.pop()}else break}return this},modP(c){let p=this.coeffs.length;for(let r=0;r<p;r++){let g=this.coeffs[r],d;if(g<0){let D;for(d=r;d<p;d++)if(this.coeffs[d]>0){D=this.coeffs[d];break}if(D){for(;d>r;d--)this.coeffs[d]=this.coeffs[d].subtract(new ue(1)),this.coeffs[d-1]=this.coeffs[d-1].add(new ue(c));g=this.coeffs[r]}}let S=g.mod(c),A=g.subtract(S).divide(c);if(!A.equals(0)){let D=r+1,b=this.coeffs[D]||new ue(0);b=b.add(A),this.coeffs[D]=new ue(b),this.coeffs[r]=new ue(S)}}return this},add(c){let p=Math.max(this.coeffs.length,c.coeffs.length);for(let r=0;r<p;r++){let g=this.coeffs[r]||new ue(0),d=c.coeffs[r]||new ue(0);this.coeffs[r]=g.add(d)}return this},subtract(c){let p=Math.max(this.coeffs.length,c.coeffs.length);for(let r=0;r<p;r++){let g=this.coeffs[r]||new ue(0),d=c.coeffs[r]||new ue(0);this.coeffs[r]=g.subtract(d)}return this},divide(c){let{variable:p}=this,r=t.Utils.arrayClone(this.coeffs),g=t.Utils.arrayClone(c.coeffs),d=r.length,S=g.length-1,A=[];for(let C=0;C<d;C++){let V=d-(C+1),J=V-S,ie=r[V].divide(g[S]);if(J<0)break;A[J]=ie;for(let fe=0;fe<=S;fe++)r[fe+J]=r[fe+J].subtract(g[fe].multiply(ie))}let D=ve.fromArray(r,p||"x").trim();return[ve.fromArray(A,p||"x"),D]},multiply(c){let p=this.coeffs.length,r=c.coeffs.length,g=[];for(let d=0;d<p;d++){let S=this.coeffs[d];for(let A=0;A<r;A++){let D=d+A,b=c.coeffs[A],C=g[D]||new ue(0);g[D]=C.add(S.multiply(b))}}return this.coeffs=g,this},isZero(){let c=this.coeffs.length;for(let p=0;p<c;p++)if(!this.coeffs[p].equals(0))return!1;return!0},sub(c){let p=new ue(0),r=this.coeffs.length;for(let g=0;g<r;g++){let d=this.coeffs[g];d.equals(0)||(p=p.add(d.multiply(new ue(c**g))))}return p},clone(){let c=new ve;return c.coeffs=this.coeffs,c.variable=this.variable,c},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let c=this.lc(),p=this.coeffs.length;for(let r=0;r<p;r++)this.coeffs[r]=this.coeffs[r].divide(c);return this},gcd(c){let p=this.coeffs.length-1,r=c.coeffs.length-1,g;if(p<r)return c.gcd(this);let d=this;for(;!c.isZero();){let A=c.clone();d=d.clone(),g=d.divide(A),c=g[1],d=A}let S=t.Math2.QGCD.apply(null,d.coeffs);if(!S.equals(1)){let A=d.coeffs.length;for(let D=0;D<A;D++)d.coeffs[D]=d.coeffs[D].divide(S)}return d},diff(){let c=[],p=this.coeffs.length;for(let r=1;r<p;r++)c.push(this.coeffs[r].multiply(new ue(r)));return this.coeffs=c,this},integrate(){let c=[0],p=this.coeffs.length;for(let r=0;r<p;r++){let g=new ue(r+1);c[g]=this.coeffs[r].divide(g)}return this.coeffs=c,this},gcf(c){let p=function(d){for(let S=0;S<d.length;S++)if(!d[S].equals(0))return S},r=[];for(let d=0;d<this.coeffs.length;d++){let S=this.coeffs[d];!S.equals(0)&&r.indexOf(S)===-1&&r.push(S)}let g=[t.Math2.QGCD.apply(void 0,r),p(this.coeffs)].toDecimal();if(c){let d=[];d[g[1]-1]=g[0],g=ve.fromArray(d,this.variable).fill()}return g},quad(c){let p=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let r=this.coeffs[2]||0,g=this.coeffs[1]||0,d=this.coeffs[0],S=g*g-4*r*d;return S<0&&!c||(p[0]=(-g+Math.sqrt(S))/(2*r),p[1]=(-g-Math.sqrt(S))/(2*r)),p},squareFree(){let c=this.clone(),p=1,r=c.clone().diff(),g=c.clone().gcd(r),d=c.divide(g)[0],S=ve.fromArray([new ue(1)],c.variable);for(;!g.equalsNumber(1);){let A=d.gcd(g),D=d.divide(A)[0];if(!D.equalsNumber(1)&&p>1){let b=D.clone();for(let C=1;C<p;C++)b.multiply(D.clone());D=b}S=S.multiply(D),p++,d=A,g=g.divide(A)[0]}return[S,d,p]},toSymbol(){let c=this.coeffs.length,{variable:p}=this;if(c===0)return new t.NerdamerSymbol(0);let r=c-1,g="";for(let d=0;d<c;d++){let S=d===r?"":"+",A=this.coeffs[d];A.equals(0)||(g+=`${A}*${p}^${d}${S}`)}return e.parse(g)},equalsNumber(c){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(c)},toString(){return this.toSymbol().toString()}},Z.prototype.coeffs=function(p,r){r&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),p||=[];let g=this.clone().distributeMultiplier();if(g.isComposite())for(let d in g.symbols){if(!Object.hasOwn(g.symbols,d))continue;let S=g.symbols[d];S.isComposite()?S.clone().distributeMultiplier().coeffs(p,r):r?p[S.isConstant()?0:S.power.toDecimal()]=S.multiplier:p.push(S.multiplier)}else if(r)p[g.isConstant(!0)?0:g.power.toDecimal()]=g.multiplier;else if(g.group===re&&g.isImaginary()){let d=new Z(g.multiplier);g.each(S=>{(S.isConstant(!0)||S.imaginary)&&(d=e.multiply(d,S))}),p.push(d)}else p.push(g.multiplier);if(r)for(let d=0;d<p.length;d++)p[d]===void 0&&(p[d]=new Z(0));return p},Z.prototype.tBase=function(p){if(typeof p>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let r=[],g=this.collectSymbols(null,null,null,!0),d=g.length;for(let S=0;S<d;S++){let A=g[S],D=A.group,b=new me(A.multiplier,[],p);if(D===re)for(let C in A.symbols){if(!Object.hasOwn(A.symbols,C))continue;let V=A.symbols[C];b.terms[p[C]]=V.power}else b.terms[p[A.value]]=A.power;r.push(b.fill()),b.updateCount()}return r},Z.prototype.altVar=function(p){let r=this.multiplier.toString(),g=this.power.toString();return(r==="1"?"":`${r}*`)+p+(g==="1"?"":`^${g}`)},Z.prototype.sameVars=function(p){if(!(this.symbols||this.group===p.group))return!1;for(let r in this.symbols){if(!Object.hasOwn(this.symbols,r))continue;let g=this.symbols[r],d=p.symbols[r];if(!d||g.value!==d.value)return!1}return!0},Z.prototype.groupTerms=function(p){p=String(p);let r,g,d,S=[];return this.each(A=>{if(A.group===W){d=A.groupTerms(p);for(let D=0;D<d.length;D++){let b=d[D];b&&(S[D]=b)}}else r=t.Utils.decompose_fn(A,p,!0),g=r.x.value===p?Number(r.x.power):0,S[g]=e.add(S[g]||new Z(0),r.a)}),S},Z.prototype.collectFactors=function(){let p=[];return this.group===re?this.each(r=>{p.push(r.clone())}):p.push(this.clone()),p};function qe(){this.factors={},this.length=0}qe.prototype.getNumberSymbolics=function(){let p=0;return this.each(r=>{r.isConstant(!0)||p++}),p},qe.prototype.add=function(p){if(p.equals(0))return this;if(p.equals(-1)&&this.length>0){let r=t.Utils.firstObject(this.factors,null,!0),g=e.symfunction(t.Settings.PARENTHESIS,[r.obj]).negate();return delete this.factors[r.key],this.add(g),this.length--,this}if(p.group===re){let r=this;p.multiplier.equals(1)||r.add(new Z(p.multiplier)),p.each(g=>{r.add(g)})}else{this.preAdd&&(p=this.preAdd(p)),this.pFactor&&(p=e.pow(p,new Z(this.pFactor)));let r=p.isConstant();if(r&&p.equals(1))return this;let g=r?p.value:p.text();g in this.factors?(this.factors[g]=e.multiply(this.factors[g],p),this.factors[g].equals(1)&&(delete this.factors[g],this.length--)):(this.factors[g]=p,this.length++)}return this},qe.prototype.toSymbol=function(){let p=new Z(1),r=Object.values(this.factors).sort((g,d)=>g.group>d.group);for(let g=0,d=r.length;g<d;g++){let S=r[g],A=S.power.equals(1)&&S.fname!==""?e.symfunction(t.PARENTHESIS,[S]):S;p=e.multiply(p,A)}return p.fname===""&&(p=Z.unwrapPARENS(p)),p},qe.prototype.merge=function(p){for(let r in p)r in this.factors?this.factors[r]=e.multiply(this.factors[r],p[r]):this.factors[r]=p[r];return this},qe.prototype.each=function(p){for(let r in this.factors){if(!Object.hasOwn(this.factors,r))continue;let g=this.factors[r];g.fname===t.PARENTHESIS&&g.isLinear()&&(g=g.args[0]),p.call(this,g,r)}return this},qe.prototype.count=function(){return j(this.factors).length},qe.prototype.clean=function(){try{let p=t.Settings.CONST_HASH;this.factors[p].lessThan(0)&&(this.factors[p].equals(-1)?delete this.factors[p]:this.factors[p].negate(),this.each(r=>{r.negate()}))}catch(p){if(p.message==="timeout")throw p}},qe.prototype.toString=function(){return this.toSymbol().toString()};function me(c,p,r){this.terms=p||[],this.coeff=c,this.map=r,this.sum=new t.Frac(0),this.image=void 0}me.prototype.updateCount=function(){this.count||=0;for(let p=0;p<this.terms.length;p++)this.terms[p].equals(0)||this.count++;return this},me.prototype.getVars=function(){let p=[];for(let r=0;r<this.terms.length;r++){let g=this.terms[r],d=this.getRevMap();g.equals(0)||p.push(this.revMap[r])}return p.join(" ")},me.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count},me.prototype.toSymbol=function(p){p||=this.getRevMap();let r=new Z(this.coeff);for(let g=0;g<this.terms.length;g++){let d=p[g],S=this.terms[g];if(S.equals(0)||d===Le)continue;let A=new Z(d);A.power=S,r=e.multiply(r,A)}return r},me.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let p={};for(let r in this.map)Object.hasOwn(this.map,r)&&(p[this.map[r]]=r);return this.revMap=p,p},me.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},me.prototype.getImg=function(){return this.image||this.generateImage(),this.image},me.prototype.fill=function(){let p=this.map.length;for(let r=0;r<p;r++)typeof this.terms[r]>"u"?this.terms[r]=new t.Frac(0):this.sum=this.sum.add(this.terms[r]);return this},me.prototype.divide=function(p){let r=this.coeff.divide(p.coeff),g=this.terms.length,d=new me(r,[],this.map);for(let S=0;S<g;S++)d.terms[S]=this.terms[S].subtract(p.terms[S]),d.sum=d.sum.add(d.terms[S]);return d},me.prototype.multiply=function(p){let r=this.coeff.multiply(p.coeff),g=this.terms.length,d=new me(r,[],this.map);for(let S=0;S<g;S++)d.terms[S]=this.terms[S].add(p.terms[S]),d.sum=d.sum.add(d.terms[S]);return d},me.prototype.isZero=function(){return this.coeff.equals(0)},me.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},t.Utils.toMapObj=function(p){let r=0,g={};for(let d=0;d<p.length;d++){let S=p[d];typeof g[S]>"u"&&(g[S]=r,r++)}return g.length=r,g},t.Utils.filledArray=function(p,r,g){let d=[];for(;r--;)d[r]=g?new g(p):p;return d},t.Utils.arrSum=function(p){let r=0,g=p.length;for(let d=0;d<g;d++)r+=p[d];return r},t.Utils.haveIntersection=function(p,r){return r.length>p.length&&([p,r]=[r,p]),p.some(g=>r.indexOf(g)>-1)},t.Utils.subFunctions=function(p,r){r||={};let g=[],d=new Set(_e(p));return p.each(S=>{if(S.group===H||S.previousGroup===H){let A=t.Utils.text(S,"hash"),D=r[A];if(D)g.push(S.altVar(D));else{let b=0,C;do C=S.fname+j(r).length+(b>0?String(b):""),b++;while(d.has(C));r[A]=C,g.push(S.altVar(C))}}else S.group===re||S.group===W||S.group===u?g.push(t.Utils.subFunctions(S,r)):g.push(S.text())}),p.group===u||p.group===W?p.altVar(t.Utils.inBrackets(g.join("+"))):p.group===re?p.altVar(t.Utils.inBrackets(g.join("*"))):p.text()},t.Utils.getFunctionsSubs=function(p){let r={};for(let g in p)Object.hasOwn(p,g)&&(r[p[g]]=e.parse(g));return r};let Q=t.Algebra={version:"1.4.6",proots(c,p){p||=7;let r=0,g=[],d=function(A,D,b){let C=S(A,D,b).concat(g);for(let V=0;V<r;V++)C.unshift(0);return C};if(c instanceof Z&&c.isPoly()){if(c.distributeMultiplier(),c.group===W){let ie=t.Utils.arrayMin(j(c.symbols)),fe=c.symbols[ie].clone().toUnitMultiplier();c=e.expand(e.divide(c,fe)),g.push(0)}if(c.group===t.groups.S)return[0];if(c.group===t.groups.PL){let ie=j(c.symbols),fe=t.Utils.arrayMin(ie);c=t.PARSER.divide(c,t.PARSER.parse(`${c.value}^${fe}`))}let A=j(c.symbols).sort().pop(),D=c.group===t.groups.PL?c.symbols:c.symbols[A],b=D.group,C=b===X?[D.power.toDecimal()]:j(D.symbols),V=[],J=t.Utils.arrayMax(C);for(let ie=1;ie<=J;ie++){let fe=0;C.indexOf(`${ie}`)!==-1&&(b===X?fe=D.multiplier:fe=D.symbols[ie].multiplier),V.unshift(fe)}return V.push(c.symbols[Le].multiplier),D.group===X&&(V[0]=D.multiplier),d(V,C,J)}if(t.Utils.isArray(c)){let A=c,D=[],b=[],C=0;for(let J=0;J<A.length;J++){let ie=A[J][0],fe=A[J][1],Oe=fe-C-1;for(let ge=0;ge<Oe;ge++)D.unshift(0);D.unshift(ie),fe!==0&&b.push(fe),C=fe}let V=Math.max.apply(void 0,b);return d(D,b,V)}throw new t.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function S(A,D,b){let V,J=A.slice(0);if(A.unshift(b),b>100)throw new t.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let ie=[],fe={};for(fe.Degree=b,V=0;V<b;V++)ie.push(0);let Oe=ie.slice(0);function ge(Te,F,G,h,R,Y){R[0]=Y.b=h[0],R[1]=Y.a=-(F*Y.b)+h[1];for(let U=2;U<Te;U++)R[U]=-(F*Y.a+G*Y.b)+h[U],Y.b=Y.a,Y.a=R[U]}function Ve(Te,F,G,h,R,Y,U,a,y){let n={},s=3;return n.b=n.a=0,ge(F,U,a,Y,y,n),R.c=n.a,R.d=n.b,Math.abs(R.c)<=100*Te*Math.abs(Y[F-1])&&Math.abs(R.d)<=100*Te*Math.abs(Y[F-2])||(R.h=a*h,Math.abs(R.d)>=Math.abs(R.c)?(s=2,R.e=G/R.d,R.f=R.c/R.d,R.g=U*h,R.a3=R.e*(R.g+G)+R.h*(h/R.d),R.a1=-G+R.f*h,R.a7=R.h+(R.f+U)*G):(s=1,R.e=G/R.c,R.f=R.d/R.c,R.g=R.e*U,R.a3=R.e*G+(R.g+R.h/R.c)*h,R.a1=-(G*(R.d/R.c))+h,R.a7=R.g*R.d+R.h*R.f+G)),s}function Qe(Te,F,G,h,R,Y,U,a,y){if(G===3){U[1]=U[0]=0;for(let s=2;s<F;s++)U[s]=a[s-2];return}let n=G===1?R:h;if(Math.abs(Y.a1)>10*Te*Math.abs(n)){Y.a7/=Y.a1,Y.a3/=Y.a1,U[0]=y[0],U[1]=-(y[0]*Y.a7)+y[1];for(let s=2;s<F;s++)U[s]=-(y[s-1]*Y.a7)+a[s-2]*Y.a3+y[s]}else{U[0]=0,U[1]=-(y[0]*Y.a7);for(let s=2;s<F;s++)U[s]=-(y[s-1]*Y.a7)+a[s-2]*Y.a3}}function Ae(Te,F,G,h,R,Y,U,a,y,n,s,w,N,I,P,B,x){let L,z,he,Se,Re,Fe,De,Ze,xe;F.b=F.a=0,Te===3||(Te===2?(L=(G+s)*n+w,z=(n+N)*a+I*y):(L=G+N*U+w*n,z=a+(N+I*n)*y),he=-(P[B-1]/x[B]),Se=-(P[B-2]+he*x[B-1])/x[B],Re=I*Se*h,Fe=he*Y,De=he*he*R,Ze=-(Fe+De)+Re,xe=-Ze+z+he*L,xe!==0&&(F.a=-((N*(De+Fe)+I*(he*h+Se*Y))/xe)+N,F.b=I*(1+Ze/xe)))}function Ge(Te,F,G,h){let R,Y;if(h.sr=h.si=h.lr=h.li=0,Te===0){h.sr=F===0?h.sr:-(G/F);return}if(G===0){h.lr=-(F/Te);return}let U=F/2;Math.abs(U)<Math.abs(G)?(Y=G>=0?Te:-Te,Y=-Y+U*(U/Math.abs(G)),R=Math.sqrt(Math.abs(Y))*Math.sqrt(Math.abs(G))):(Y=-(Te/U*(G/U))+1,R=Math.sqrt(Math.abs(Y))*Math.abs(U)),Y>=0?(R=U>=0?-R:R,h.lr=(-U+R)/Te,h.sr=h.lr===0?h.sr:G/h.lr/Te):(h.lr=h.sr=-(U/Te),h.si=Math.abs(R/Te),h.li=-h.si)}function je(Te,F,G,h,R,Y,U,a,y,n,s,w){let N={},I,P,B,x,L,z,he,Se,Re,Fe,De,Ze=0,xe,be=0;G.NZ=0,z=h,Se=R;do{if(N.li=N.lr=N.si=N.sr=0,Ge(1,z,Se,N),G.szr=N.sr,G.szi=N.si,G.lzr=N.lr,G.lzi=N.li,Math.abs(Math.abs(G.szr)-Math.abs(G.lzr))>.01*Math.abs(G.lzr))break;for(ge(U,z,Se,y,Y,a),P=Math.abs(-(G.szr*a.b)+a.a)+Math.abs(G.szi*a.b),Fe=Math.sqrt(Math.abs(Se)),I=2*Math.abs(Y[0]),L=-(G.szr*a.b),De=1;De<F;De++)I=I*Fe+Math.abs(Y[De]);if(I=I*Fe+Math.abs(L+a.a),I=(9*I+2*Math.abs(L)-7*(Math.abs(a.a+L)+Fe*Math.abs(a.b)))*Te,P<=20*I){G.NZ=2;break}if(Ze++,Ze>20)break;if(Ze>=2&&x<=.01&&P>=B&&!be){for(x=x<Te?Math.sqrt(Te):Math.sqrt(x),z-=z*x,Se+=Se*x,ge(U,z,Se,y,Y,a),De=0;De<5;De++)xe=Ve(Te,F,a.a,a.b,s,w,z,Se,n),Qe(Te,F,xe,a.a,a.b,s,w,n,Y);be=1,Ze=0}B=P,xe=Ve(Te,F,a.a,a.b,s,w,z,Se,n),Qe(Te,F,xe,a.a,a.b,s,w,n,Y),xe=Ve(Te,F,a.a,a.b,s,w,z,Se,n),Ae(xe,a,a.a,s.a1,s.a3,s.a7,a.b,s.c,s.d,s.f,s.g,s.h,z,Se,w,F,y),he=a.a,Re=a.b,Re!==0&&(x=Math.abs((-Se+Re)/Re),z=he,Se=Re)}while(Re!==0)}function tt(Te,F,G,h,R,Y,U,a,y){let n,s,w,N,I,P,B,x,L,z,he,Se=h-1;for(F.NZ=he=L=0,B=G.a;;){for(P=R[0],U[0]=P,z=1;z<Y;z++)U[z]=P=P*B+R[z];for(w=Math.abs(P),N=Math.abs(B),n=.5*Math.abs(U[0]),z=1;z<Y;z++)n=n*N+Math.abs(U[z]);if(w<=20*Te*(2*n-w)){F.NZ=1,F.szr=B,F.szi=0;break}if(he++,he>10)break;if(he>=2&&Math.abs(x)<=.001*Math.abs(-x+B)&&w>I){L=1,F.a=B;break}for(I=w,y[0]=s=a[0],z=1;z<h;z++)y[z]=s=s*B+a[z];if(Math.abs(s)>Math.abs(a[Se])*10*Te)for(x=-(P/s),a[0]=U[0],z=1;z<h;z++)a[z]=x*y[z-1]+U[z];else for(a[0]=0,z=1;z<h;z++)a[z]=y[z-1];for(s=a[0],z=1;z<h;z++)s=s*B+a[z];x=Math.abs(s)>Math.abs(a[Se])*10*Te?-(P/s):0,B+=x}return L}function Xe(Te,F,G,h,R,Y,U,a,y,n,s,w){let N={},I={},P=new Array(F),B=new Array(F),x,L,z,he,Se,Re,Fe,De,Ze,xe,be,lt,ut,mt,At,Ft,dt,_t,$t,Lt=1,Gt,c0,kt,a0,m0,u0;for(w.NZ=0,he=z=.25,Se=h,De=R,N.b=N.a=0,ge(y,s,R,a,n,N),x=N.a,L=N.b,I.h=I.g=I.f=I.e=I.d=I.c=I.a7=I.a3=I.a1=0,a0=Ve(Te,U,x,L,I,Y,s,R,P),Gt=0;Gt<G;Gt++){if(_t=1,Qe(Te,U,a0,x,L,I,Y,P,n),a0=Ve(Te,U,x,L,I,Y,s,R,P),Ae(a0,N,x,I.a1,I.a3,I.a7,L,I.c,I.d,I.f,I.g,I.h,s,R,Y,U,a),At=N.a,dt=Ft=N.b,xe=Y[U-1]===0?0:-(a[U]/Y[U-1]),be=ut=1,Gt!==0&&a0!==3&&(ut=dt===0?ut:Math.abs((dt-De)/dt),be=xe===0?be:Math.abs((xe-Se)/xe),mt=ut<Fe?ut*Fe:1,lt=be<Re?be*Re:1,m0=mt<he?1:0,c0=lt<z?1:0,c0||m0)){for($t=0;$t<U;$t++)B[$t]=Y[$t];for(Ze=xe,kt=u0=0;;){if(!(_t&&(_t=0)==0&&c0&&(!m0||lt<mt))){if(je(Te,U,w,At,Ft,n,y,N,a,P,I,Y),x=N.a,L=N.b,w.NZ>0)return;if(Lt=u0=1,he*=.25,kt||!c0)Lt=0;else for($t=0;$t<U;$t++)Y[$t]=B[$t]}if(Lt!==0){if(N.a=Ze,Lt=tt(Te,w,N,U,a,y,n,Y,P),Ze=N.a,w.NZ>0)return;if(kt=1,z*=.25,Lt!==0){At=-(Ze+Ze),Ft=Ze*Ze;continue}}for($t=0;$t<U;$t++)Y[$t]=B[$t];if(!m0||u0)break}ge(y,s,R,a,n,N),x=N.a,L=N.b,a0=Ve(Te,U,x,L,I,Y,s,R,P)}De=dt,Se=xe,Fe=ut,Re=be}}function Je(Te,F,G,h){let R=Te.Degree,Y=Math.PI/180,U=Math.LN2,a=Te.Degree+1,y=new Array(a),n=new Array(a),s=new Array(a),w=new Array(a),N={},I={},P,B,x,L,z,he,Se,Re,Fe,De,Ze,xe,be,lt,ut,mt,At,Ft,dt,_t,$t,Lt,Gt,c0;xe=1;do B=xe,xe/=2,be=1+xe;while(be>1);let kt=Number.MIN_VALUE/B,a0=Math.cos(94*Y),m0=Math.sin(94*Y),u0=Math.sqrt(.5),y0=-u0;for(I.NZ=dt=0,I.szr=I.szi=I.lzr=I.lzi=0;F[R]===0;)G[dt]=h[dt]=0,R--,dt++;for(Gt=R+1;R>=1;){if(R<=2){R<2?(G[Te.Degree-1]=-(F[1]/F[0]),h[Te.Degree-1]=0):(N.li=N.lr=N.si=N.sr=0,Ge(F[0],F[1],F[2],N),G[Te.Degree-2]=N.sr,h[Te.Degree-2]=N.si,G[Te.Degree-1]=N.lr,h[Te.Degree-1]=N.li);break}for(Se=0,Re=Number.MAX_VALUE,V=0;V<Gt;V++)De=Math.abs(F[V]),De>Se&&(Se=De),De!==0&&De<Re&&(Re=De);if(Fe=kt/Re,(Fe<=1&&Se>=10||Fe>1&&Number.MAX_VALUE/Fe>=Se)&&(Fe=Fe===0?Number.MIN_VALUE:Fe,$t=Math.floor(Math.log(Fe)/U+.5),z=2**$t,z!==1))for(V=0;V<Gt;V++)F[V]*=z;for(let ft=0;ft<Gt;ft++)n[ft]=Math.abs(F[ft]);n[R]=-n[R],Lt=R-1,De=Math.exp((Math.log(-n[R])-Math.log(n[0]))/R),n[Lt]!==0&&(Ze=-n[R]/n[Lt],De=Ze<De?Ze:De),Ze=De;do{De=Ze,Ze=.1*De,he=n[0];for(let ft=1;ft<Gt;ft++)he=he*Ze+n[ft]}while(he>0);L=De;do{x=he=n[0];for(let ft=1;ft<R;ft++)he=De*he+n[ft],x=De*x+he;he=De*he+n[R],L=he/x,De-=L}while(Math.abs(L/De)>.005);P=De;for(let ft=1;ft<R;ft++)y[ft]=(R-ft)*F[ft]/R;for(y[0]=F[0],xe=F[R],be=F[Lt],c0=y[Lt]===0?1:0,_t=0;_t<5;_t++)if(lt=y[Lt],c0){for(let ft=0;ft<Lt;ft++)dt=Lt-ft,y[dt]=y[dt-1];y[0]=0,c0=y[Lt]===0?1:0}else{mt=-xe/lt;for(let ft=0;ft<Lt;ft++)dt=Lt-ft,y[dt]=mt*y[dt-1]+F[dt];y[0]=F[0],c0=Math.abs(y[Lt])<=Math.abs(be)*B*10?1:0}for(let ft=0;ft<R;ft++)w[ft]=y[ft];for(_t=1;_t<=20;_t++)if(Ft=-(m0*y0)+a0*u0,y0=m0*u0+a0*y0,u0=Ft,ut=P*u0,At=-(2*ut),Xe(B,a,20*_t,ut,P,y,R,F,Gt,s,At,I),I.NZ===0)for(let ft=0;ft<R;ft++)y[ft]=w[ft];else{dt=Te.Degree-R,G[dt]=I.szr,h[dt]=I.szi,Gt-=I.NZ,R=Gt-1;for(let ft=0;ft<Gt;ft++)F[ft]=s[ft];I.NZ===1||(G[dt+1]=I.lzr,h[dt+1]=I.lzi);break}if(_t>20){Te.Degree-=R;break}}}Je(fe,J,Oe,ie);let nt=ie.length;for(V=0;V<nt;V++){let Te=te(ie[V],p+8),F=te(Oe[V],p+8);F=p-String(F).length>2?F:Oe[V];let G=Te<0?"-":"";F===0&&(F=""),Te===0&&(Te=""),Math.abs(Te)===1?Te=`${G}i`:Te?Te=`${Te}*i`:Te="";let h=F&&Te?`${F}+${Te}`:F+Te;Oe[V]=h.replace(/\+-/gu,"-")}return Oe}},roots(c){if(c.isConstant(!0,!0))return t.Utils.nroots(c);let p=Q.proots(c).map(r=>e.parse(r));return t.Vector.fromArray(p)},froot(c,p,r){return function(d){let A=r||t.Utils.build(t.Calculus.diff(c.clone())),D=c instanceof Function?c:t.Utils.build(c),b=1e4,C=!1,V=0;for(;!C;){let J=d-D(d)/A(d),ie=Math.abs(J)-Math.abs(d),fe=Math.abs(ie);d=J,fe<1e-12?C=!0:V>b&&(d=null,C=!0),V++}return d}(Number(p))},quad(c,p,r){let g=function(d,S,A,D){return e.parse(`-(${S}+${D}*sqrt((${S})^2-4*(${d})*(${A})))/(2*${d})`)};return[g(c,p,r,1),g(c,p,r,-1)]},sumProd(c,p){return Q.quad(-p,c,-1).map(r=>r.invert())},coeffs(c,p,r){c=e.expand(c),r||=[new Z(0)];let g=_e(c);p===void 0&&g.length===1&&(p=g[0]),p=String(p),c.group===K&&c.contains(p,!0)&&e.error(`Unable to get coefficients using expression ${c.toString()}`),g=_e(c);let d=c.contains("pi")||c.contains("e")||c.containsFunction("sqrt");if(g.length===1&&g[0]===p&&!c.isImaginary()&&!d){let S=new ve(c).coeffs.map(A=>new Z(A));for(let A=0,D=S.length;A<D;A++){let b=S[A],C=r[A];C&&(b=e.add(C,b)),r[A]=b}}else if(g.length===1&&g[0]===p&&!c.isImaginary()&&d&&c.group===u){let S=t.Utils.getCoeffs(c,p);for(let A=0,D=S.length;A<D;A++){let b=S[A],C=r[A];C&&(b=e.add(C,b)),r[A]=b}}else if(p||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),g.indexOf(p)===-1)r[0]=e.add(c,r[0]);else{r||=[new Z(0)];let S;if(c.group===re){let A=c.symbols[p];A||e.error("Expression is not a polynomial!");let D=Number(A.power);S=e.divide(c.clone(),A.clone()),(S.contains(p,!0)||D<0||!ce(D))&&e.error("Expression is not a polynomial!");let b=r[D];b&&(S=e.add(b,S)),r[D]=S}else c.group===u&&c.each(A=>{Q.coeffs(A.clone(),p,r)},!0)}for(let S=0,A=r.length;S<A;S++)typeof r[S]>"u"&&(r[S]=new Z(0));return r},polyPowers(c,p,r){r||=[];let g=c.group;if(g===W&&p===c.value)r=r.concat(j(c.symbols));else if(g===u)for(let d in c.symbols){if(!Object.hasOwn(c.symbols,d))continue;let S=c.symbols[d],A=S.group,D=S.value;if(A===X&&p===D)r.push(S.power);else if(A===W||A===u)r=Q.polyPowers(S,p,r);else if(A===re&&S.contains(p)){let b=S.symbols[p];b&&r.push(b.power)}else(A===v||p!==D)&&r.push(0)}else g===re&&c.contains(p)&&r.push(t.Utils.decompose_fn(c,p,!0).x.power);return t.Utils.arrayUnique(r).sort()},Factor:{split(c){let p=new Z(1),r=new Z(1);return Q.Factor.factorInner(c,new qe).each(g=>{let d=e.parse(g);g.isConstant(!0)?p=e.multiply(p,d):r=e.multiply(r,d)}),[p,r]},mix(c,p){let r=j(c),g=r.length,d=[];for(let S=0;S<g;S++){let A=r[S],D=c[A],b=d.length;for(let C=0;C<b;C++){let V=d[C]*A;d.push(V),p&&d.push(-V)}for(let C=1;C<=D;C++)d.push(A**C)}return d},common(c,p){try{if(c.group===u){let r=e.expand(c.clone(),!0).collectSymbols(null,null,(D,b)=>(b.length||1)-(D.length||1)),g={},d=[];for(let D=0;D<r.length;D++){let b=r[D];d.push(b.multiplier.clone()),b.each(C=>{let V=Number(C.power);if(isNaN(V))throw new Error("exiting");C.value in g?(V<g[C.value][0]&&(g[C.value][0]=V),g[C.value][1].push(C)):g[C.value]=[V,[C]]})}let S=new Z(1);for(let D in g)g[D][1].length===r.length&&(S=e.multiply(S,e.pow(new Z(D),new Z(g[D][0]))));let A=t.Math2.QGCD.apply(null,d);if(!A.equals(1)){p.add(new Z(A));for(let D=0;D<r.length;D++)r[D].multiplier=r[D].multiplier.divide(A)}if(!S.equals(1)){p.add(S),c=new Z(0);for(let D=0;D<r.length;D++)c=e.add(c,e.divide(r[D],S.clone()))}}}catch(r){if(r.message==="timeout")throw r}return c},zeroes(c,p){let r=function(){throw new t.exceptions.ValueLimitExceededError("Exiting")};try{let g,d,S;c=e.expand(c.clone());let A=c.toString(),D=_e(c);d=new Z(0);let b=[],C=[];for(let V=0,J=D.length;V<D.length;V++){let ie={};for(let Oe=0;Oe<J;Oe++)V!==Oe&&(ie[D[Oe]]=0);g=e.parse(A,ie);let fe=g.power;ce(fe)||r(),b.push(g),C.push(g.power)}if(t.Utils.allSame(C)){let V=c.length,J=b.length,ie=Math.round((Math.sqrt(8*V-1)-3)/2);J===2?S=new ue(C[0]/(V-1)):J===3&&ie!==0?S=new ue(C[0]/ie):S=t.Math2.QGCD.apply(null,C)}else S=t.Math2.QGCD.apply(null,C);if(!ce(S))return c;for(let V=0;V<b.length;V++){let J=b[V],ie=J.power.clone().divide(S);if((J.multiplier.num<0||J.multiplier.den<0)&&ie%2===0)return c;J.multiplier=new ue(J.multiplier**(1/ie)),J.power=S.clone(),d=e.add(d,J)}if(d.group!==u)return c;for(;;){let V=Q.div(c.clone(),d.clone());if(V[1].equals(0)){if(c=V[0],p.add(d.clone()),c.equals(1))break}else break}}catch(g){if(g.message==="timeout")throw g}return c},factor(c,p){t.Utils.checkTimeout();let r=p?[...p]:null;try{let g=Q.Factor.factorInner(c,p);return g=g.pushMinus(),g}catch(g){if(g.message==="timeout")throw g;return p&&p.splice(0,p.length,...r),c}},factorInner(c,p){if(t.Utils.checkTimeout(),c.isConstant()&&c.isInteger())return t.Math2.factor(c);let r=e.parse(c);if(r.isConstant())return r.isInteger()?t.Math2.factor(r):c;if(r.equals(0)||r.equals(1))return r;let g=Q.Factor._factor(r,p);if(g.equals(c)||g.equals(0)||g.equals(1))return g;if(g.group===re){let d=new Z(1),S=e.parse(g.power),A=e.parse(g.multiplier);g.toUnitMultiplier(),g.multiplier.lessThan(0)&&(d.negate(),g.negate()),g.each(b=>{let C=e.parse(Q.Factor._factor(b));if(A=e.multiply(A,Z.create(C.multiplier)),C.toUnitMultiplier(),C.group===re){let V=new Z(1);C.each(J=>{let ie=e.parse(Q.Factor._factor(J));ie.group===re&&(A=e.multiply(A,Z.create(ie.multiplier)),ie.toUnitMultiplier()),V=e.multiply(V,ie)}),V=e.pow(V,new Z(C.power)),d=e.multiply(d,V)}else d=e.multiply(d,C)});let D=e.pow(d,S);g=e.multiply(A,D)}return g},quadFactor(c,p){if(c.isPoly()&&Q.degree(c.equals(2))){let r=t.Utils.variables(c)[0],g=Q.coeffs(c,r);if(g.length<3)return c;let d=Q.Factor._factor(g[2].clone());if(d.group===re){let S=d.collectSymbols();if(S.length>2)return c;let A=e.multiply(e.parse(g[0]),e.parse(S[0])),D=e.parse(g[1]).negate(),b=e.parse(S[1]),C=Q.quad(b,D,A).filter(V=>t.Utils.isInt(V));if(C.length===1){let V=C[0],J=e.divide(g[0],e.parse(V));t.Utils.isInt(J)&&(p.add(e.parse(Ue("({0})*({1})+({2})",S[1],r,J))),p.add(e.parse(Ue("({0})*({1})+({2})",S[0],r,V))),c=new Z(1))}}}return c},cubeFactor(c,p){if(c.isComposite()){let r=c.collectSymbols();if(r.length===2){let g=r[0].sign(),d=r[0].clone().abs(),S=r[1].sign(),A=r[1].clone().abs();if(d.isCube()&&A.isCube()){g<S&&([g,S]=[S,g],[d,A]=[A,d]);let D=e.parse(d.getNth(3)),b=e.parse(A.getNth(3)),C=e.multiply(e.expand(e.pow(d.clone().toUnitMultiplier(),e.parse("1/3"))),D),V=e.multiply(e.expand(e.pow(A.clone().toUnitMultiplier(),e.parse("1/3"))),b);g===1&&S===-1?(p.add(e.parse(Ue("(({0})-({1}))",C,V))),p.add(e.parse(Ue("(({0})^2+({0})*({1})+({1})^2)",C,V))),c=Z(1)):g===1&&S===1&&(p.add(e.parse(Ue("(({0})+({1}))",C,V))),p.add(e.parse(Ue("(({0})^2-({0})*({1})+({1})^2)",C,V))),c=Z(1))}}}return c},_factor(c,p){t.Utils.checkTimeout();let r=c.group;if(c.group===H){let d=c.args[0];if(d.group===X&&d.isSimple())return c}else if(c.group===X&&c.isSimple())return c;if(c.group===u){c.distributeMultiplier(!0);let d=new Z(0);c.each(S=>{(S.group===u&&S.power.greaterThan(1)||S.group===re)&&(S=e.expand(S)),d=e.add(d,S)}),d.power=c.power,c=d}c.group===H&&c.fname!=="sqrt"&&(c=t.Utils.evaluate(c));let g=c.clone();try{if(c.group===re){let S=e.parse(c.power),A=Q.Simplify.strip(c.getDenom()),D=Q.Simplify.strip(c.getNum()),b=A.pop(),C=D.pop();if(C.equals(c))return c;let V=Q.Factor.factorInner(C),J=Q.Factor.factorInner(b),ie=Q.Simplify.unstrip(D,V),fe=Q.Simplify.unstrip(A,J);return e.divide(ie,fe)}if(c.group===X)return c;if(c.isConstant())return c.equals(1)||c.equals(0)||!c.isInteger()?c.clone():t.Math2.factor(c);let d=c.power.clone();if(ce(d)&&!(d.lessThan(0)&&c.group===H)){let S=d.sign();c.toLinear(),p||=new qe;let A={};c=e.parse(t.Utils.subFunctions(c,A)),j(A).length>0&&(p.preAdd=function(Oe){return e.parse(Oe,t.Utils.getFunctionsSubs(A))}),c.isLinear()||(p.pFactor=c.power.toString(),c.toLinear());let D=_e(c);c.isImaginary()&&D.push(t.Settings.IMAGINARY);let b=D.length>1;if(b){let fe=!0,Oe=!0;if(c.each(ge=>{ge.group!==X&&(fe=!1),ge.multiplier.equals(1)||(Oe=!1)}),fe&&Oe)return e.pow(e.parse(c,t.Utils.getFunctionsSubs(A)),e.parse(d))}let C=new qe;c=Q.Factor.coeffFactor(c,C),C.each(fe=>{de(d)&&fe.lessThan(0)&&fe.negate(),S<0&&fe.invert(),p.add(fe)});let V=new qe;if(c=Q.Factor.powerFactor(c,V),V.each(fe=>{S<0&&fe.invert(),p.add(fe)}),b)c=Q.Factor.cubeFactor(c,p),c=Q.Factor.mfactor(c,p),p.each(fe=>{S<0&&fe.power.negate()});else{let fe=D[0];c=Q.Factor.squareFree(c,p,fe);let Oe=new qe;c=Q.Factor.trialAndError(c,Oe,fe);let ge=Oe.toSymbol();if(ge.equals(g))return ge;for(let Ve in Oe.factors){if(!Object.hasOwn(Oe.factors,Ve))continue;let Qe=Oe.factors[Ve];p.add(e.pow(Qe,e.parse(d)))}c.equals(g)&&(c=Q.Factor.quadFactor(c,p))}c=e.parse(c,t.Utils.getFunctionsSubs(A));let J=p.length===1;p.add(e.pow(c,e.parse(d)));let ie=p.toSymbol();return J&&c.equals(1)&&ie.isLinear()&&(ie=e.pow(ie,e.parse(d))),ie}return c}catch(d){if(d?.message==="timeout")throw d;return g}},reduce(c,p){if(c.group===u&&c.length===2){let r=c.collectSymbols().sort((g,d)=>d.multiplier-g.multiplier);if(r[0].power.equals(r[1].power)){let g=e.parse(r[0].power),d=r[0].clone().toLinear(),S=r[1].clone().toLinear();p.add(e.add(d.clone(),S.clone())),S.negate();let A=Number(g),D=new Z(0);for(let b=1;b<=A;b++){let C=e.pow(d.clone(),e.subtract(g.clone(),new Z(b))),V=e.pow(S.clone(),e.subtract(new Z(b),new Z(1)));D=e.add(D,e.multiply(C,V))}return D}}return c},squareFree(c,p,r){if(c.isConstant()||c.group===X||!c.isPoly())return c;let d=new ve(c,r).squareFree(),S=d[2];if(S!==1){let A=d[1].toSymbol();return A.power=A.power.multiply(new ue(S)),p.add(Q.Factor.factorInner(A)),Q.Factor.squareFree(d[0].toSymbol(),p)}return c},powerFactor(c,p){if(c.group!==W||c.previousGroup===K)return c;let r=j(c.symbols);if(!t.Utils.allNumeric(r))return c;let g=t.Utils.arrayMin(r),d=new Z(0),S=e.parse(`${c.value}^${g}`);return c.each(A=>{A=e.divide(A,S.clone()),d=e.add(d,A)}),p.add(S),d},coeffFactor(c,p){if(c.isComposite()){let r=t.Math2.QGCD.apply(null,c.coeffs());if(r.equals(1)){let g=function(A){let D;return A.group===re?(D=0,A.each(b=>{D+=b.power})):D=Number(A.power),D},d=c.collectSymbols(null,null,null,!0).sort((A,D)=>A.isConstant(!0)?1:D.power-A.power),S=d[0];(g(S)>g(d[1])||d[1].isConstant(!0))&&S.multiplier.lessThan(0)&&(p.add(new Z(-1)),c.each(A=>{A.negate()},!0))}else c.each(g=>{g.isComposite()?g.each(d=>{d.multiplier=d.multiplier.divide(r)}):g.multiplier=g.multiplier.divide(r)}),c.updateHash();p&&p.add(new Z(r))}return c},trialAndError(c,p,r){let g=c.clone();try{let d=[];if(c.isConstant()||c.group===X||!c.isPoly())return c;let S=new ve(c,r),A=S.coeffs[0],D=t.Math2.ifactor(A),b=Q.proots(c);for(let C=0;C<b.length;C++){let V=b[C],J=1;if(!isNaN(V)){for(let Ve in D){if(!Object.hasOwn(D,Ve))continue;let Qe=t.Utils.round(Math.log(Ve)/Math.log(Math.abs(V)),8);if(ce(Qe)){V=Ve,J=Qe;break}}let ie=new ue(V),fe=[new ue(ie.num).negate()];fe[J]=new ue(ie.den);let Oe=ve.fromArray(fe,S.variable).fill(),ge=S.divide(Oe);ge[1].equalsNumber(0)&&(S=ge[0],d.push(Oe.toSymbol()))}}return S.equalsNumber(1)||(S=Q.Factor.search(S,p)),d.forEach(C=>{p.add(C)}),S.toSymbol()}catch(d){if(d.message==="timeout")throw d;return g}},search(c,p,r){r||=10;let g=c.variable,d=function(ge,Ve,Qe,Ae){let Ge=ve.fit(ge,Ve,Qe,r,Ae,g);if(Ge&&Ge.coeffs.length>1){let je=c.divide(Ge);if(je[1].equalsNumber(0))return p.add(Ge.toSymbol()),[je[0],Ge]}return null},S=c.coeffs[0],A=t.Math2.ifactor(S),D=c.lc(),b=t.Math2.ifactor(D),C=c.sub(r),V=t.Math2.ifactor(C),J=Q.Factor.mix(V,C<0),ie=Math.ceil(c.coeffs.length/2),fe=D.lessThan(0),Oe=S.lessThan(0);for(b[1]=1,A[1]=1;ie--;)for(let ge in b)if(Object.hasOwn(b,ge)){for(let Ve in A)if(Object.hasOwn(A,Ve))for(let Qe=0;Qe<J.length;Qe++){let Ae=d(ge,Ve,J[Qe],ie);if(Ae)return c=Ae[0],t.Utils.isPrime(c.sub(r))||(c=Q.Factor.search(c,p)),c;Ae||(fe&&Oe?Ae=d(-ge,-Ve,J[Qe],ie):fe?Ae=d(-ge,Ve,J[Qe],ie):Oe&&(Ae=d(ge,-Ve,J[Qe],ie)))}}return c},mSqfrFactor(c,p){if(c.group!==H){let r=_e(c).reverse();for(let g=0;g<r.length;g++){let d=!1;do{if(r[g]===c.value){p.add(c),c=new Z(1);continue}let S=t.Calculus.diff(c,r[g]),A=Q.Factor.coeffFactor(S);if(A.equals(0)||A.equals(1)||A.equals(-1))break;let D=!0;A.isConstant()&&c.isComposite()&&c.each(C=>{C.multiplier%A!==0&&(D=!1)},!0);let b;if(D){let C=c.clone();if(b=Q.divWithCheck(c,A.clone()),d=b[1].equals(0),c.equals(b[0])&&b[1].equals(0)){c=C;break}if(b[0].isConstant()){p.add(b[0]);break}}else d=!1;d&&(p.add(b[0]),c=A)}while(d)}}return c},sqdiff(c,p){if(c.isConstant("all"))return c;try{let r=function(S){return t.Utils.block("POSITIVE_MULTIPLIERS",()=>Z.unwrapPARENS(Be.sqrt(Be.abs(S))),!0)},g=t.Utils.separate(c.clone());if(!g)return c;let d=[];for(let S in g)S!=="constants"&&d.push(g[S]);if(d.sort((S,A)=>A.power-S.power),d.length===2){let S,A;if(S=d.pop(),A=d.pop(),de(S.power)&&de(A.power)&&S.sign()===A.sign()&&S.group===X&&A.group===X)throw new Error("Unable to factor");if(S.isComposite()&&A.power.equals(2)&&S.sign()!==A.sign()){A=r(A);let D=Q.Factor.factorInner(e.add(S,g.constants));D.power.equals(2)&&(D.toLinear(),p.add(e.subtract(D.clone(),A.clone())),p.add(e.add(D,A)),c=new Z(1))}else if(S=S.powSimp(),A=A.powSimp(),(S.group===X||S.fname==="")&&S.power.equals(2)&&(A.group===X||A.fname==="")&&A.power.equals(2)&&!g.constants){if(S.multiplier.lessThan(0)){let D=A;A=S,S=D}S.multiplier.greaterThan(0)&&(S=r(S),A=r(A)),p.add(e.subtract(S.clone(),A.clone())),p.add(e.add(S,A)),c=new Z(1)}}}catch(r){if(r.message==="timeout")throw r}return c},mfactor(c,p){if(c.group===H)if(c.fname==="sqrt"){let r=new qe,g=Q.Factor.common(c.args[0].clone(),r);g=Q.Factor.coeffFactor(g,null),c=e.multiply(e.symfunction("sqrt",[g]),e.parse(c.multiplier)),r.each(d=>{c=e.multiply(c,e.parse(t.Utils.format("sqrt({0})",d)))})}else p.add(c),c=new Z(1);else{c=Q.Factor.mSqfrFactor(c,p);let r=_e(c),g=c.collectSymbols().map(b=>Z.unwrapSQRT(b)),d={},S={},A=r.length,D=g.length;for(let b=0;b<A;b++){let C=r[b];d[C]=new Z(0);for(let V=0;V<D;V++){let J=g[V];if(J.contains(C)){let ie=J.value===C?J.power.toDecimal():J.symbols[C].power.toDecimal();(!S[C]||ie<S[C])&&(S[C]=ie),d[C]=e.add(d[C],J.clone())}}}for(let b in d){if(!Object.hasOwn(d,b))continue;let C=e.parse(`${b}^${S[b]}`),V=e.divide(d[b],C),J=e.expand(V);if(J.equals(1)||J.equals(-1))break;let ie=Q.div(c.clone(),J);if(ie[0].equals(0))break;if(ie[1].equals(0)){let Oe=!1;if(ie[0].each(ge=>{ce(ge.multiplier)||(Oe=!0)}),Oe){ie[1]=e.expand(e.multiply(ie[1],J));break}}let fe=ce(J)&&J.lessThan(0);if(ie[1].equals(0)&&!fe){let Oe=Q.divWithCheck(c.clone(),ie[0].clone()),ge=Oe[0];if(ge.equals(0)||(c=Oe[1],ge.equals(-1)&&!c.equals(0)))return c;let Ve=ie[0];if(c.equals(Ve)){let Qe=Q.Factor.reduce(Ve,p);return c.equals(Qe)?Qe:Q.Factor.mfactor(Qe,p)}return p.add(Ve),c.equals(0)?ge:ge.isConstant("all")?(p.add(ge),ge):(c=Q.Factor.mfactor(ge,p),c)}}}return c=Q.Factor.sqdiff(c,p),c=Q.Factor.zeroes(c,p),c}},allLinear(c){let p=c.length;for(let r=0;r<p;r++)if(!Q.isLinear(c[r]))return!1;return!0},isLinear(c){let p=!1,r=c.group;if(r===W||r===u){p=!0;for(let g in c.symbols){if(!Object.hasOwn(c.symbols,g))continue;let d=c.symbols[g],S=d.group;if((S===H||S===K)&&(p=!1),S===re)p=_e(d).length===1;else if(S===W||S===u)p=Q.isLinear(d);else if(d.group!==v&&d.power.toString()!=="1"){p=!1;break}}}else r===X&&c.power===1&&(p=!0);return p},gcd(...c){let p;if(c.length===1&&c[0]instanceof t.Vector?p=c[0].elements:p=c,p.length===0)return new Z(1);if(p.length===1)return p[0];let r=[],g=!1;for(let d=0;d<p.length;d++)if(p[d].group===H&&p[d].fname==="gcd")p=p.concat(p[d].args),p.splice(d,1);else{let S=_e(p[d]);if(t.Utils.haveIntersection(S,r)){g=!0;break}else r=r.concat(S)}if(g||r.length===0){if(p.every(d=>d.getDenom().equals(1))){let d=p[0];for(let S=1;S<p.length;S++)d=Q.gcd_(p[S],d);return d}return e.divide(Q.gcd.apply(null,p.map(d=>d.getNum())),Q.lcm.apply(null,p.map(d=>d.getDenom())))}return e.symfunction("gcd",p)},gcd_(c,p){if((c.group===H||c.group===q)&&(c=t.Utils.block("PARSE2NUMBER",()=>e.parse(c))),p.group===H&&(p=t.Utils.block("PARSE2NUMBER",()=>e.parse(p))),c.isConstant()&&p.isConstant())return new Z(t.Math2.QGCD(new ue(Number(c)),new ue(Number(p))));let r=e.multiply(c.getDenom()||new Z(1),p.getDenom()||new Z(1)).invert();if(c=e.multiply(c.clone(),r.clone()),p=e.multiply(p.clone(),r.clone()),c=e.expand(c),p=e.expand(p),c.group===re||p.group===re){let b=e.divide(c.clone(),p.clone()),C=e.multiply(p.clone(),b.getDenom().invert());if(!C.equals(1))return C}if(c.group===K||p.group===K){let b=new Z(t.Math2.GCD(c.multiplier,p.multiplier)),C=Q.gcd_(c.value===Le?new Z(1):e.parse(c.value),p.value===Le?new Z(1):e.parse(p.value)),V=Q.gcd_(e.parse(c.power),e.parse(p.power));return e.multiply(b,e.pow(C,V))}if(c.length<p.length){let b=c;c=p,p=b}let g=_e(c),d=_e(p);if(g.length===d.length&&g.length===1&&g[0]===d[0]||g.length===1&&d.length===0||g.length===0&&d.length===1)return c=new ve(c),p=new ve(p),e.divide(c.gcd(p).toSymbol(),r);let S=[];c.each(b=>{S.push(b.multiplier)}),p.each(b=>{S.push(b.multiplier)});let A;for(;!p.equals(0);){let b=p.clone();if(c=c.clone(),A=Q.div(c,b),p=A[1],A[0].equals(0))return e.divide(new Z(t.Math2.QGCD(c.multiplier,p.multiplier)),r);c=b}let D=t.Math2.QGCD.apply(void 0,S);return D.equals(1)||c.each(b=>{b.multiplier=b.multiplier.divide(D)}),c.equals(1)&&!c.isConstant()&&!p.isConstant()?e.divide(e.symfunction("gcd",[c,p]),r):e.divide(c,r)},lcm(...c){let p;c.length===1?c[0]instanceof t.Vector?p=c[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):p=c;let r=p.reduce((A,D)=>e.multiply(A,D.clone()),new Z(1)),g=(function(D,b){b=Number(b);let C=[],V,J,ie,fe=2**D.length;for(J=b;J<fe;J++){V=[],ie=D.length-1;do(J&1<<ie)!==0&&V.push(D[ie]);while(ie--);V.length===b&&C.push(V)}return C})(p,p.length-1).map(A=>A.reduce((D,b)=>e.multiply(D,b.clone()),new Z(1))),d;return p.every(A=>t.Utils.isVariableSymbol(A))?d=e.symfunction("gcd",t.Utils.arrayUnique(g)):d=Q.gcd.apply(null,g),e.divide(r,d)},divide(c,p){let r,g=t.Algebra.Factor.factorInner(c.clone());r=g.getDenom(),r.isConstant("all")?r=new Z(1):c=e.expand(Z.unwrapPARENS(e.multiply(g,r.clone())));let d=Q.div(c,p),S=e.divide(d[1],p);return e.divide(e.add(d[0],S),r)},divWithCheck(c,p){let r=[new Z(0),c.clone()],g=Q.div(c,p),d=c.clone(),S=e.multiply(g[0].clone(),p.clone());S=e.add(S,g[1].clone());let A=e.subtract(d,S);return A=e.expand(A),A.equals(0)?g:r},div(c,p){let r=[new Z(0),c.clone()];try{if(p.isConstant("all"))return c.each(J=>{J.multiplier=J.multiplier.divide(p.multiplier)}),[c,new Z(0)];if(c=e.expand(c),p=e.expand(p),c.group===X&&p.group===u){let J=c.value,ie=t.Utils.decompose_fn(p.clone(),J,!0);if(c.isLinear()&&ie.x&&ie.x.isLinear()&&p.isLinear()){let fe=Z.create(c.multiplier);return[e.divide(fe.clone(),ie.a.clone()),e.divide(e.multiply(fe,ie.b),ie.a).negate()]}}if(c.group===X&&p.group===X){let J=e.divide(c.clone(),p.clone());return J.isConstant()?[J,new Z(0)]:[new Z(0),c.clone()]}let g=c.hasFunc(),d=p.hasFunc(),S=!1,A;if(g||d){S=!0;let J={};c=e.parse(t.Utils.subFunctions(c,J)),p=e.parse(t.Utils.subFunctions(p,J)),A=t.Utils.getFunctionsSubs(J)}let D=t.Utils.arrayUnique(_e(c).concat(_e(p))),b,C,V;if((c.isImaginary()||p.isImaginary())&&D.push(t.Settings.IMAGINARY),D.length===1){let J=new ve(c).divide(new ve(p));b=J[0].toSymbol(),C=J[1].toSymbol()}else{D.push(Le);let J=function(Xe){let Je=new Z(0);for(let nt=0;nt<Xe.length;nt++){let Te=Xe[nt].toSymbol();Je=e.add(Je,Te)}return Je},ie=function(Xe,Je){let nt=Math.max.apply(null,Xe.terms),Te=0,F;if(!Je){for(let G=0;G<Xe.terms.length;G++)if(Xe.terms[G].equals(nt)&&(F=G,Te++),Te>1)return}if(Je){for(let G=0;G<Xe.terms.length;G++)if(Xe.terms[G].equals(nt)){F=G;break}}return[nt,F,Xe]},fe=t.Utils.toMapObj(D),Oe=function(Xe,Je){return Je.sum.subtract(Xe.sum)},ge=c.tBase(fe).sort(Oe),Ve=p.tBase(fe).sort(Oe),Qe=function(Xe,Je){Je||=0;let nt=Xe[Je],Te=Xe.length;if(!nt)return;let F=ie(nt);for(let R=Je+1;R<Te;R++){let Y=Xe[R],U=nt.sum.equals(Y.sum);if(!U&&F)break;if(U){let a,y,n,s,w=nt.terms.length;for(let P=0;P<w;P++){let B=nt.terms[P],x=Y.terms[P];(typeof a>"u"||B.greaterThan(a))&&(a=B,n=P),(typeof y>"u"||x.greaterThan(y))&&(y=x,s=P)}let N=a.subtract(Y.terms[n]),I=y.subtract(nt.terms[s]);if(I>N){F=[y,s,Y];break}if(N>I){F=[a,n,nt];break}}else if(F=ie(Y),F)break;F=ie(Y)}if(!F)return ie(Xe[0],!0);let G,h;for(let R=0;R<Ve.length;R++){let Y=Ve[R].terms;if(h=F[1],h===Y.length-1)return;if(G=Y[h],!G.equals(0))break}return G.equals(0)?Qe(Xe,++Je):F},Ae=function(Xe,Je){if(!Xe||!Je)return!1;for(let nt=0;nt<Xe.terms.length;nt++)if(Xe.terms[nt].lessThan(Je.terms[nt]))return!1;return!0},Ge=Ae(ge[0],Ve[0])&&ge[0].count>Ve[0].count?Ve:ge,je=Qe(Ge),tt=[];if(je){let Xe=je[1],Je=function(U,a){return U[0].sum.equals(a[0].sum)?U.length>=a.length:!0},nt=function(U,a,y){let n=[];for(let s=0;s<U.length;s++){let w=U[s];for(let N=0;N<w.terms.length;N++){let I=n[N],P=w.terms[N];s===0?n[N]=P:I&&!I.equals(P)&&(n[N]=void 0)}}for(let s=0;s<n.length;s++){let w=n[s];if(w&&!w.equals(0))return s}return y},Te=function(U,a){let y=U.len(),n=a.len(),s=a.terms[Xe],w=U.terms[Xe];return n>y&&s.greaterThan(w)?n-y:s.subtract(w)};Xe=nt(ge,Ve,Xe),ge.sort(Te),Ve.sort(Te);let F=Ve[0],G=ge[0];if(V=new me(new ue(1),[],G.map),F.sum.greaterThan(G.sum)&&G.len()>1)for(let U=0;U<G.terms.length;U++){let a=F.terms[U].subtract(G.terms[U]);if(a.equals(0))V.terms[U]=new ue(0);else{let y=a.add(new ue(1));V.terms[U]=a;for(let n=0;n<ge.length;n++)ge[n].terms[U]=ge[n].terms[U].add(y)}}let h=Ae(ge[0],Ve[0]),R=0,Y=200;for(;h&&Je(ge,Ve);){if(R++>Y)throw new t.exceptions.InfiniteLoopError("Unable to compute!");let U=ge[0].divide(Ve[0]);tt.push(U),ge.shift();for(let a=1;a<Ve.length;a++){let y=Ve[a].multiply(U).generateImage(),n=ge.length;n===0&&(y.coeff=y.coeff.neg(),ge.push(y),ge.sort(Te));for(let s=0;s<n;s++){let w=ge[s];if(w.getImg()===y.getImg()){w.coeff=w.coeff.subtract(y.coeff),w.coeff.equals(0)&&(t.Utils.remove(ge,s),s--);break}s===n-1&&(y.coeff=y.coeff.neg(),ge.push(y),ge.sort(Te))}}if(h=Ae(ge[0],Ve[0]),!h&&ge.length>=Ve.length){for(let a=1;a<ge.length;a++)if(h=Ae(ge[a],Ve[0]),h){ge.unshift(t.Utils.remove(ge,a));break}}}}b=J(tt),C=J(ge),typeof V<"u"&&(V=V.toSymbol(),b=e.divide(b,V.clone()),C=e.divide(C,V))}return S&&(b=e.parse(b.text(),A),C=e.parse(C.text(),A)),[b,C]}catch(g){if(g.message==="timeout")throw g;return r}},line(c,p,r){t.Utils.isArray(c)&&(c=t.Utils.convertToVector(c)),t.Utils.isArray(p)&&(p=t.Utils.convertToVector(p)),r=e.parse(r||"x"),(!t.Utils.isVector(c)||!t.Utils.isVector(p))&&e.error(`Line expects a vector! Received "${c}" & "${p}"`);let g=e.subtract(p.e(1).clone(),c.e(1).clone()),d=e.subtract(p.e(2).clone(),c.e(2).clone()),S=e.divide(d,g),A=e.multiply(r,S.clone()),D=e.multiply(c.e(1).clone(),S);return e.add(e.subtract(A,D),c.e(2).clone())},PartFrac:{createTemplate(c,p,r,g){c=Q.Factor.factorInner(c),c.each((J,ie)=>{if(J.group===H&&J.fname===""&&J.args[0].group===X){let fe=J.args[0];c.symbols?(delete c.symbols[ie],c.symbols[fe.value]=fe):c=J.args[0]}});let d,S,A,D=p.collectFactors(),b=[],C=[],V=new Z(1);for(let J=0;J<D.length;J++){let ie=Z.unwrapPARENS(D[J]);if(ie.power.greaterThan(1)){S=Number(ie.power),d=ie.clone().toLinear(),A=Number(Q.degree(d,g));for(let fe=0;fe<S;fe++){let Oe=e.pow(d.clone(),new Z(fe+1));r.push(Oe.clone());let ge=e.divide(c.clone(),Oe.clone());C.push(A),b.push(ge)}}else{A=Number(Q.degree(ie,g)),r.push(ie);let fe=e.divide(c.clone(),ie.clone());fe=e.expand(Z.unwrapPARENS(fe)),C.push(A),b.push(fe)}}return r=r.map(J=>e.multiply(J,V.clone())),[r,b,C]},partfrac(c,p,r){let g=_e(c);p||=e.parse(g[0]);try{let d,S,A,D=e.expand(c.getNum()),b=e.expand(c.getDenom().toUnitMultiplier());if(D.multiplier=c.multiplier,d=D.groupTerms(p),Number(Q.degree(D,p))>=Number(Q.degree(b,p))?(S=Q.div(D.clone(),e.expand(b.clone())),A=S[0],D=S[1],d=D.groupTerms(p)):A=new Z(0),Number(Q.degree(b,p))===1){let Te=e.divide(D,b);return r?[A,Te]:e.add(A,Te)}let C=Q.Factor.factorInner(b),V=Q.PartFrac.createTemplate(b.clone(),C,[],p),J=V[0],ie=V[1],fe=V[2],Oe=[d.length],ge=[],Ve=[],Qe=[],Ae,Ge;ie.forEach((Te,F)=>{Ae=J[F],Ge=fe[F];for(let G=0;G<Ge;G++){Ve.push(Ae.clone());let h=Z.create(p,G),R=e.expand(e.multiply(Te,h.clone())).groupTerms(p),Y=R.length;Oe.push(Y),ge.push(R),Qe.push(h.clone())}});let je=t.Utils.arrayMax(Oe),tt=new t.Matrix(t.Utils.fillHoles(d,je)).transpose(),Xe=new t.Matrix;for(let Te=0;Te<ge.length;Te++)Xe.elements.push(t.Utils.fillHoles(ge[Te],je));let Je=e.multiply(Xe.transpose().invert(),tt),nt=r?[A]:A;return Je.each((Te,F)=>{let G=e.multiply(Qe[F],e.divide(Te,Ve[F]));r?nt.push(G):nt=e.add(nt,G)}),nt}catch(d){if(d.message==="timeout")throw d;try{if(c.isComposite()){let S={};c.each(D=>{let b=D.getDenom(),C=D.getNum(),V=S[b];S[b]=V?e.add(V,C):C});let A=new Z(0);for(let D in S)Object.hasOwn(S,D)&&(A=e.add(A,e.divide(S[D],e.parse(D))));c=A}}catch(S){if(S.message==="timeout")throw S}}return c}},degree(c,p,r){if(r||={nd:[],sd:[],depth:0},!p){let S=_e(c);if(S.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(S.length===0)return new Z(0);p=e.parse(S[0])}let g=c.group;c.isComposite()?(c=c.clone(),c.distributeExponent(),c.each(S=>{r.depth++,Q.degree(S,p,r),r.depth--})):c.group===re?c.each(S=>{r.depth++,Q.degree(S,p,r),r.depth++}):g===K&&c.value===p.value?r.sd.push(c.power.clone()):g===X&&c.value===p.value?r.nd.push(e.parse(c.power)):r.nd.push(new Z(0));let d=r.nd.length>0?t.Utils.arrayMax(r.nd):void 0;return r.depth===0&&r.sd.length>0?(d!==void 0&&r.sd.unshift(d),e.symfunction("max",r.sd)):(t.Utils.isSymbol(d)||(d=e.parse(d)),d)},sqComplete(c,p,r){t.Utils.isSymbol(p)||(p=e.parse(p));let g=function(ge){throw ge||="Stopping",new t.exceptions.ValueLimitExceededError(ge)};c.isPoly(!0)||g("Must be a polynomial!");let d=t.Utils.inBrackets;c=c.clone();let S=t.Algebra.degree(c,p);S.equals(2)||g(`Cannot complete square for degree ${S}`);let A=t.Algebra.coeffs(c,p),D=A[2],b=A[1].sign(),C=e.divide(A[1],new Z(2)),V=e.pow(C.clone(),new Z(2)),J=Be.sqrt(D),ie=e.divide(Be.sqrt(V),J.clone()),fe=e.subtract(A[0],e.pow(ie.clone(),new Z(2)));if(r)return[D,C,fe];let Oe=e.parse(d(`${J.clone()}*${p}${b<0?"-":"+"}${ie}`));return{a:Oe,c:fe,f:e.add(e.pow(Oe.clone(),new Z(2)),fe.clone())}},Simplify:{strip(c){let p=e.parse(c.multiplier);c.toUnitMultiplier();let r=e.parse(c.power);return c.toLinear(),[p,r,c]},unstrip(c,p){let r=c[0],g=c[1];return e.multiply(r,e.pow(p,g))},complexSimp(c,p){let r=c.realpart(),g=c.imagpart(),d=p.realpart(),S=p.imagpart(),A=e.multiply(r.clone(),d.clone()),D=e.multiply(g.clone(),S.clone()),b=e.multiply(d.clone(),g),C=e.multiply(r,S.clone()),V=e.add(e.pow(d,new Z(2)),e.pow(S,new Z(2)));return e.divide(e.add(e.add(A,D),e.multiply(e.subtract(b,C),Z.imaginary())),V)},trigSimp(c){let p=!0,r=0;for(;p&&c.containsFunction(["cos","sin","tan"]);){r++,p=!1,c=c.clone();let g=Q.Simplify.strip(c);c=g.pop();let d=c.clone();if(c.group===u){let S=new Z(0);c.each(A=>{let D=Q.Simplify.trigSimp(A.fnTransform());S=e.add(S,D)},!0),d=e.pow(e.multiply(new Z(c.multiplier),S),new Z(c.power)),p=d.text()!==c.text()}else if(c.group===re){let S=c.getNum(),A=c.getDenom();if(S.fname==="sin"&&A.fname==="cos"&&S.args[0].equals(A.args[0])&&S.power.equals(A.power))d=e.parse(t.Utils.format("(({1})/({0}))*tan({2})^({3})",A.multiplier,S.multiplier,S.args[0],S.power)),p=!0;else if(S.fname==="tan"&&A.fname==="sin"&&S.args[0].equals(A.args[0])&&S.power.equals(A.power))d=e.parse(t.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",A.multiplier,S.multiplier,S.args[0],S.power)),p=!0;else{let D=new Z(1),b={workDone:p};d.each(C=>{if(C.fname==="tan")C=e.parse(t.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",C.multiplier,Q.Simplify._simplify(C.args[0]),C.power)),b.workDone=!0;else if(C.containsFunction(["cos","sin","tan"])){let V=Q.Simplify.trigSimp(C);C.equals(V)||(C=V,b.workDone=!0)}D=e.multiply(D,C)}),p=b.workDone,d=D}}else if((c.fname==="cos"||c.fname==="sin")&&c.args[0].group===u){let S=0,A=new Z(0),D=e.parse("pi/2");if(c.args[0].each(b=>{let C=e.divide(b.clone(),D.clone());C=Q.Simplify._simplify(C),C=t.Utils.evaluate(C),ce(C)?S+=C.multiplier.num.toJSNumber():A=e.add(A,b)}),S){S+=c.fname==="cos"?1:0,S%=4,S+=S<0?4:0;let b=["sin({0})","cos({0})","-sin({0})","-cos({0})"],C=t.Utils.format(b[S],A);d=e.parse(C),p=!0}else if(Object.keys(c.args[0].symbols).length>1){let b=c.args[0].clone(),C=Object.values(b.symbols),V=C[0],ie=C.slice(1).map(Oe=>`(${Oe.text()})`).join("+"),fe;c.fname==="sin"?fe=t.Utils.format("sin({0})cos({1})+sin({1})cos({0})",V,ie):fe=t.Utils.format("cos({0})cos({1})-sin({1})sin({0})",V,ie),d=e.parse(fe),p=!0}}else if((c.fname==="cos"||c.fname==="sin")&&c.args[0].multiplier.sign()===-1){let S=c.args[0].clone().negate(),A=t.Utils.format(`${c.fname}({0})`,S);c.fname==="sin"&&(A=`-${A}`),d=e.parse(A),p=!0}if(c.fname==="sin"&&c.args[0].multiplier.equals(2)&&!c.args[0].equals(2)){let S=c.args[0].clone().toUnitMultiplier(),A=t.Utils.format("2sin({0})cos({0})",S);d=e.parse(A),p=!0}if(d=Q.Simplify.unstrip(g,d).distributeMultiplier(),c=d,r>10)break}return c},logArgSimp(c,p){if(p.value==="1"||p.value===1)return new Z(0);let r=new Z(0),g=p.multiplier.clone();if(p.toUnitMultiplier(),!g.equals(1)){let d=t.Utils.format("({0}({1}))",c,g);r=e.add(r,e.parse(d))}if(p.group===re)p.each(d=>{d=d.clone();let S=d.power.clone();Q.Simplify.strip(d);let A=t.Utils.format("(({1})*{0}({2}))",c,S,d);r=e.add(r,e.parse(A))});else{let d=p.clone(),S=d.power.clone();Q.Simplify.strip(d);let A=t.Utils.format("(({1})*{0}({2}))",c,S,d);r=e.add(r,e.parse(A))}return r},logSimp(c){if(c.group===H&&(c.fname==="log"||c.fname==="log10")){let p=c.clone(),r=Q.Simplify.strip(c);c=r.pop();let g=c.args[0].clone(),d=g.getNum().clone(),S=g.getDenom().clone(),A=c.fname,D=Q.Simplify.logArgSimp(A,d);if(!S.equals(1)){let b=Q.Simplify.logArgSimp(A,S);D=e.subtract(D,b)}D=Q.Simplify.unstrip(r,D).distributeMultiplier(),c=D}else if(c.containsFunction(["log","log10"]))for(let p in c.symbols){if(!Object.hasOwn(c.symbols,p))continue;let r=c.symbols[p];c.symbols[p]=Q.Simplify.logSimp(r)}return c},_sqrtCompression(c,p,r){let g=Q.Simplify.strip(c),d=Oe=>Oe.fname==="abs",S=Oe=>Oe.args[0],A=Oe=>d(Oe)?S(Oe):null,D=Oe=>Oe.type===X&&Oe.value.startsWith("baseunit_"),b=(Oe,ge)=>{let Ve=S(ge);return Ve.equals(A(Oe))?[ge,null]:Ve.equals(Oe)&&D(Oe)?[ge,null]:[null,ge]},C,V=!1,J=(Oe,ge)=>{for(let Ve=0;Ve<Oe.length;Ve++){let Qe=Oe[Ve];if(Qe.isSQRT()){for(let Ae=0;Ae<ge.length;Ae++){let Ge=ge[Ae];if([Ge,Qe]=b(Ge,Qe),Ge!==null){ge[Ae]=Ge,C=!0,V=!0;break}}Oe[Ve]=Qe,Oe=Oe.filter(Ae=>Ae),ge=ge.filter(Ae=>Ae)}}return[Oe,ge]},ie=p.collectFactors(),fe=r.collectFactors();do C=!1,[ie,fe]=J(ie,fe),[fe,ie]=J(fe,ie);while(C);return V&&(c=ie.reduce((Oe,ge)=>Oe=e.multiply(Oe,ge),new Z(1)),c=fe.reduce((Oe,ge)=>Oe=e.divide(Oe,ge),c)),c=Q.Simplify.unstrip(g,c),c},fracSimp(c){let p=c.getDenom(),r=c.getNum();if(r.isImaginary()&&p.isImaginary()&&(c=Q.Simplify.complexSimp(r,p)),c.isComposite()){c.power>1&&(c=e.expand(c));let g=c.collectSymbols(),d,S,A,D,b,C,V,J,ie,fe,Oe;for(S=g.pop();g.length;)A=g.pop(),D=e.parse(S.getDenom()),b=e.parse(A.getDenom()),C=S.getNum(),V=A.getNum(),Oe=e.multiply(D.clone(),b.clone()),ie=e.multiply(C,b),fe=e.multiply(V,D),J=e.add(ie,fe),S=e.divide(J,Oe);return p=e.expand(S.getDenom()),r=e.expand(S.getNum()),r.isImaginary()&&p.isImaginary()?d=Q.Simplify.complexSimp(r,p):d=e.divide(r,p),d.equals(c)?c:Q.Simplify._simplify(d)}return c=Q.Simplify._sqrtCompression(c,r,p),c=Q.Simplify.simpleFracSimp(c),c},simpleFracSimp(c){let p=c.getDenom(),r=c.getNum(),g;return p=e.expand(p),r=e.expand(r),r.isImaginary()&&p.isImaginary()?g=Q.Simplify.complexSimp(r,p):g=e.divide(r,p),g.equals(c)?c:g},ratSimp(c){if(c.group===re){let p=c.getDenom(),r=c.getNum().distributeMultiplier(),g=Q.Simplify.fracSimp(p),d=Q.Simplify.fracSimp(r);c=e.divide(d,g)}return c},sqrtSimp(c,p){let r,g=!1,d=c.clone();try{if(c.isSQRT()){let S=c.multiplier.clone(),A=c.args[0].clone(),D=Q.Factor.factorInner(A),b=e.parse(D.multiplier),C=b.sign();r=new Z(1);let V;if(D.group===re){let J=new Z(1);D.each(fe=>{if(fe=e.parse(fe),fe.group===v){let Oe=e.sqrt(fe.clone());ce(Oe)?r=e.multiply(r,Oe):J=e.multiply(J,fe)}else J=e.multiply(J,fe)});let ie=e.multiply(J,e.parse(C));V=e.sqrt(ie.clone()),V.isImaginary()&&(V=e.sqrt(e.expand(ie.clone())))}else V=D.clone().toUnitMultiplier(),V=e.multiply(V,new Z(C)),V=e.sqrt(V);r=e.multiply(r,V),r=e.pow(r,e.parse(c.power)),r=e.multiply(r,e.sqrt(b.abs())),r=e.multiply(r,e.parse(S)),g=!0}else c.isComposite()&&c.isLinear()?(r=new Z(0),c.each(S=>{r=e.add(r,Q.Simplify.sqrtSimp(S))},!0),r=e.pow(r,e.parse(c.power)),r=e.multiply(r,e.parse(c.multiplier)),g=!0):c.group===re&&(r=new Z(1),c.each(S=>{let A=Q.Simplify.sqrtSimp(S);r=e.multiply(r,A)}),r=e.pow(r,e.parse(c.power)),r=e.multiply(r,e.parse(c.multiplier)),g=!0);return g||r&&!ce(r)&&(r=null),r||=e.parse(c),r}catch(S){if(S.message==="timeout")throw S;return d}},patternSub(c){let p={},r=function(d){let S=!1;return d.each(A=>{A.group===u?S=!0:A.symbols&&(S=r(A))}),S},g=function(d){d.each(S=>{if(!(!S.symbols&&S.group!==H)){if(r(S))g(S);else if(!p[S.value]){let A=t.Utils.getU(c);p[S.value]=A,c=c.sub(S.value,A)}}},!0)};return g(c),[c,p]},simplify(c){if(c.simplify)return c.simplify();let p=Q.Simplify._simplify(c);return p=p.pushMinus(),p=e.parse(p),p},_simplify(c){let p=Q.Simplify.strip(c.clone());if(c=p.pop(),c=Q.Simplify.fracSimp(c),c.isConstant()||c.group===t.groups.S)return p.push(c),Q.Simplify.unstrip(p,c);let r=c.clone();if(r=Q.Simplify.sqrtSimp(r,p),r=Q.Simplify.trigSimp(r),r=Q.Simplify.logSimp(r),r=Q.Simplify.ratSimp(r),r=Q.Factor.factorInner(r),r.group===t.groups.CP&&r.isLinear()){let g=r.multiplier.clone();r.toUnitMultiplier();let d=new Z(0);return r.each(S=>{let A=Q.Simplify._simplify(S);d=e.add(d,A)}),r=d,r=e.multiply(r,new Z(g)),r.multiplier.equals(-1)&&r.distributeMultiplier(),r=Q.Simplify.unstrip(p,r),r}return r=Q.Simplify.unstrip(p,r),r}},Classes:{Polynomial:ve,Factors:qe,MVTerm:me}};t.Expression.prototype.simplify=function(){t.Utils.armTimeout();try{let p;if(typeof this.symbol.LHS>"u")p=new t.Expression(Q.Simplify.simplify(this.symbol));else{let r=this.symbol.clone();r.LHS=Q.Simplify.simplify(r.LHS),r.RHS=Q.Simplify.simplify(r.RHS),p=r}return p}catch(p){if(p.message==="timeout")throw p;return this}finally{t.Utils.disarmTimeout()}},t.Collection.prototype.simplify=function(){return this.elements=this.elements.map(p=>Q.Simplify.simplify(p)),this},t.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(p=>p.map(r=>Q.Simplify.simplify(r))),this},T0.useAlgebraDiv=function(){let p=Q.divideFn=e.divide,r=0;e.divide=function g(d,S){r++;let A;return r===1?A=t.Algebra.divide(d,S):A=g(d,S),r=0,A}},T0.useParserDiv=function(){Q.divideFn&&(e.divide=Q.divideFn),delete Q.divideFn},T0.register([{name:"factor",visible:!0,numargs:1,build(){return Q.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return Q.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return Q.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return Q.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return Q.roots}},{name:"divide",visible:!0,numargs:2,build(){return Q.divide}},{name:"div",visible:!0,numargs:2,build(){return Q.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return Q.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return Q.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...p){let r=Q.coeffs(...p);return new t.Vector(r)}}}]),T0.coeffs=function(...p){let r=t.PARSER;for(let d=0;d<p.length;d++)typeof p[d]=="string"?p[d]=r.parse(p[d]):p[d]&&p[d].symbol?p[d]=p[d].symbol.clone():t.Utils.isSymbol(p[d])&&(p[d]=p[d].clone());let g=Q.coeffs(...p);return new t.Expression(new t.Vector(g))},T0.register([{name:"line",visible:!0,numargs:[2,3],build(){return Q.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(p,r){try{return r||=_e(p)[0],Q.sqComplete(p.clone(),r).f}catch(g){if(g.message==="timeout")throw g;return p}}}}]),T0.updateAPI()})()});var An=E0((Wi,Mn)=>{"use strict";var i1;typeof Mn<"u"&&(i1=G0(),t1(),n1());(function(){let t=i1.getCore(),e=t.PARSER,v=t.Algebra,q=t.Calculus,X=q.integration.decompose_arg,{evaluate:K}=t.Utils,{remove:H}=t.Utils,{format:W}=t.Utils,{build:u}=t.Utils,{knownVariable:re}=t.Utils,{NerdamerSymbol:j}=t,{isSymbol:de}=t.Utils,{variables:_e}=t.Utils,{S:Ue}=t.groups,{PL:te}=t.groups,{CB:ue}=t.groups,{CP:ce}=t.groups,{FN:Z}=t.groups,{Settings:Le}=t,{range:Be}=t.Utils,{isArray:$e}=t.Utils;t.Settings.SOLVE_RADIUS=1e3,t.Settings.ROOTS_PER_SIDE=10,t.Settings.make_pi_conversions=!1,t.Settings.STEP_SIZE=.1,t.Settings.EPSILON=2e-13,t.Settings.MAX_NEWTON_ITERATIONS=200,t.Settings.NEWTON_EPSILON=2e-15,t.Settings.MAX_NON_LINEAR_TRIES=12,t.Settings.NON_LINEAR_JUMP_AT=50,t.Settings.NON_LINEAR_JUMP_SIZE=100,t.Settings.NON_LINEAR_START=.01,t.Settings.NEWTON_SLICES=200,t.Settings.SOLUTION_PROXIMITY=1e-14,t.Settings.FILTER_SOLUTIONS=!0,t.Settings.MAX_SOLVE_DEPTH=10,t.Settings.ZERO_EPSILON=1e-9,t.Settings.MAX_BISECTION_ITER=2e3,t.Settings.BI_SECTION_EPSILON=1e-12,t.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},t.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let g in this.symbols){if(!Object.hasOwn(this.symbols,g))continue;let d=this.symbols[g];if(d.group===te&&d.hasNegativeTerms()||this.symbols[g].power.lessThan(0))return!0}return!1};function ve(r,g){if(g.isConstant()&&r.isConstant()&&!r.equals(g)||r.equals(t.Settings.IMAGINARY)&&g.isConstant(!0)||g.equals(t.Settings.IMAGINARY)&&r.isConstant(!0))throw new t.exceptions.NerdamerValueError(`${r.toString()} does not equal ${g.toString()}`);this.LHS=r,this.RHS=g}ve.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(r){return`${this.LHS.text(r)}=${this.RHS.text(r)}`},toLHS(r){r=!!r;let g=this.removeDenom(),d=g.LHS,S=g.RHS;d.isConstant(!0)&&!S.isConstant(!0)&&([d,S]=[S,d]);let A=e.subtract(d,S),D=r?e.expand(A):A;return D=new ve(D,new j(0)).removeDenom().LHS,D},removeDenom(){let r=this.LHS.clone(),g=this.RHS.clone(),d=e.multiply(r.getDenom(),g.getDenom());if(r=e.expand(e.multiply(r,d.clone())),g=e.expand(e.multiply(g,d)),g.group===ce&&g.group!==ce){let S=r;r=g,g=S}if(r.group===ue){let S=new j(r.multiplier),A=g.clone();r.each(D=>{D.power.lessThan(0)?A=e.divide(A,D):S=e.multiply(S,D)}),r=S,g=A}else if(r.group===ce)for(let S in r.symbols){if(!Object.hasOwn(r.symbols,S))continue;let A=r.symbols[S];if(A.group===ue)for(let D in A.symbols){if(!Object.hasOwn(A.symbols,D))continue;let b=A.symbols[D];if(b.power.lessThan(0))return new ve(e.expand(e.multiply(b.clone().toLinear(),r)),e.expand(e.multiply(b.clone().toLinear(),g)))}}return new ve(r,g)},clone(){return new ve(this.LHS.clone(),this.RHS.clone())},sub(r,g){let d=this.clone();return d.LHS=d.LHS.sub(r.clone(),g.clone()),d.RHS=d.RHS.sub(r.clone(),g.clone()),d},isZero(){return t.Utils.evaluate(this.toLHS()).equals(0)},latex(r){return[this.LHS.latex(r),this.RHS.latex(r)].join("=")}},e.equals=function(g,d){return new ve(g,d)},(function(){let g=e.functions.simplify[0];e.functions.simplify[0]=function(S){return S instanceof ve?(S.LHS=g(S.LHS),S.RHS=g(S.RHS),S):g(S)}})(),t.Expression.prototype.equals=function(g){return g instanceof t.Expression&&(g=g.symbol),new ve(this.symbol,g)},t.Expression.prototype.solveFor=function(g){t.Utils.armTimeout();try{let{symbol:d}=this;if(this.symbol instanceof ve){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(g))return[new t.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(g))return[new t.Expression(this.symbol.RHS)]}return p(d,g).map(D=>(D=t.Algebra.Simplify.simplify(e.parse(D)),new t.Expression(D)))}finally{t.Utils.disarmTimeout()}},t.Expression.prototype.expand=function(){if(this.symbol instanceof ve){let g=this.symbol.clone();return g.RHS=e.expand(g.RHS),g.LHS=e.expand(g.LHS),new t.Expression(g)}return new t.Expression(e.expand(this.symbol))},t.Expression.prototype.variables=function(){return this.symbol instanceof ve?t.Utils.arrayUnique(t.Utils.variables(this.symbol.LHS).concat(t.Utils.variables(this.symbol.RHS))):t.Utils.variables(this.symbol)};let qe=function(g,d){return e.equals(g,d)};t.Equation=ve;let me=t.Utils.checkAll=function(g,d){for(let S=0;S<g.length;S++)if(d(g[S]))return!1;return!0},Q=t.Solve={version:"2.0.3",solutions:[],solve(r,g){let d=Le.PARSE2NUMBER;Le.PARSE2NUMBER=!1;let S=p(r,String(g));return Le.PARSE2NUMBER=d,new t.Vector(S)},toLHS(r,g){if(de(r))return r;if(!(r instanceof ve)){let d=r.split("=");d[1]||="0",r=new ve(e.parse(d[0]),e.parse(d[1]))}return r.toLHS(g)},solveCircle(r,g){let d=g.map(C=>e.parse(C)),S=[],A=[];for(let C=0;C<r.length;C++){let V=[];for(let J=0;J<d.length;J++)V.push(Number(t.Algebra.degree(r[C],d[J])));V.push(t.Utils.arraySum(V,!0)),S.push(V)}let D=r[0],b=r[1];if(S[0][2]>S[1][2]&&([b,D]=[D,b],[S[1],S[0]]=[S[0],S[1]]),S[0][0]===1&&S[0][2]===2&&S[1][0]===2&&S[1][2]===4){let C=g[0],V=g[1],J=p(e.parse(b,re(C,p(e.parse(D),C)[0])),V).map(fe=>fe.toString()),ie=[p(e.parse(D,re(V,J[0])))[0].toString()];J[1]&&ie.push(p(e.parse(D,re(V,J[1])))[0].toString()),Le.SOLUTIONS_AS_OBJECT?(A={},A[C]=ie,A[V]=J):(J.unshift(V),ie.unshift(C),A=[ie,J])}return A},solveNonLinearSystem(r,g,d){if(g<0)return[];d=typeof d>"u"?t.Settings.NON_LINEAR_START:d;let S=t.Settings.MAX_NON_LINEAR_TRIES,A=Math.floor(S/2);g=typeof g>"u"?S:g;let D=t.Settings.NON_LINEAR_JUMP_AT,b=t.Settings.NON_LINEAR_JUMP_SIZE,C=!0,V=function(Te,F){return Te.map((G,h)=>Number(F.get(h,0)))},J=t.Utils.arrayGetVariables(r),ie=t.Matrix.jacobian(r,J,Te=>u(Te,J),!0),fe=t.Settings.MAX_NEWTON_ITERATIONS,Oe,ge,Ve,Qe,Ae,Ge,je,tt,Xe=r.map(Te=>u(Te,J)),Je=ie.map(Te=>u(Te,J),!0);Qe=t.Matrix.cMatrix(0,J);let nt=t.Matrix.cMatrix(d,J);Ve=0;do{if(Ve>fe){C=!1;break}Oe=V(J,nt),je=nt.clone();let Te=Oe,F=nt;Xe.forEach((h,R)=>{F.set(R,0,h(...Te))});let G=new t.Matrix;if(Je.each((h,R,Y)=>{let U=h(...Te);G.set(R,Y,U)}),G=G.invert(),ge=e.multiply(G,nt).negate(),tt=ge.subtract(Qe,h=>e.parse(Number(h))),Qe=je.add(ge,h=>e.parse(Number(h))),nt=Qe,Ve>=D&&Ae>1){g===A&&(d=0);let h=g>A?1:-1,R=g%Math.floor(A)+1;return d+=h*R*b,Q.solveNonLinearSystem(r,--g,d)}if(Ge=Ae,Ve++,Ae=tt.max(),Number(Ae)===Number(Ge))break}while(Number(Ae)>=Number.EPSILON);return C?Q.systemSolutions(nt,J,!0,Te=>t.Utils.round(Number(Te),14)):[]},systemSolutions(r,g,d,S){let A=t.Settings.SOLUTIONS_AS_OBJECT?{}:[];return r.each((D,b)=>{let C=(d?e.expand(D):D).valueOf();S&&(C=S.call(D,C));let V=g[b];t.Settings.SOLUTIONS_AS_OBJECT?A[V]=C:A.push([V,C])}),A},solveSystemBySubstitution(r){let g=_e(r[0]),d=_e(r[1]);return r.length===2&&g.length===2&&t.Utils.arrayEqual(g,d)?Q.solveCircle(r,g):[]},solveSystem(r,g){for(let V=0;V<r.length;V++)r[V]=Q.toLHS(r[V]);let d=r.length,S=new t.Matrix,A=new t.Matrix,D=!1,b;if(typeof g>"u"){if(!v.allLinear(r))try{return Q.solveNonLinearSystem(r)}catch(V){if(V.message==="timeout")throw V;if(V instanceof t.exceptions.DivisionByZero)return Q.solveSystemBySubstitution(r)}if(b=t.Utils.arrayGetVariables(r),b.length===1){let V=0,J,ie;do ie=r[V].clone(),V>0&&(ie=ie.sub(b[0],J[0])),J=p(ie,b[0]);while(++V<r.length);let fe;return Le.SOLUTIONS_AS_OBJECT?(fe={},fe[b[0]]=J):J.length===0?fe=J:fe=[b[0],J],fe}if(b.length<r.length){let V=[],J=r.length;for(let ge=0;ge<J-1;ge++)V.push(e.parse(r[ge]));let ie={},fe=Q.solveSystem(V,b);Array.isArray(fe)?fe.forEach(ge=>{ie[ge[0]]=ge[1]}):ie=fe;let Oe=!0;for(let ge=J-1;ge<J;ge++)e.parse(r[ge],ie).equals(0)||(Oe=!1);if(Oe)return fe}for(let V=0;V<b.length;V++)i1.setVar(b[V],"delete");for(let V=0;V<d;V++){let J=r[V];for(let fe=0;fe<b.length;fe++){let Oe=b[fe],ge=[];J.each(Qe=>{Qe.contains(Oe)&&(ge=ge.concat(Qe.coeffs()))});let Ve=t.Utils.arraySum(ge);S.set(V,fe,Ve)}let ie=J.clone();b.forEach(fe=>{ie=ie.stripVar(fe,!0)}),A.set(V,0,ie.negate())}}else{b=g,D=!0;for(let V=0;V<d;V++){A.set(V,0,new j(0));let J=e.expand(r[V]).collectSummandSymbols();for(let ie=0;ie<g.length;ie++){S.set(V,ie,new j(0));let fe=g[ie];for(let Oe=0;Oe<J.length;Oe++){let ge=J[Oe],Ve=!1;for(let Qe=0;Qe<g.length;Qe++)ge.contains(g[Qe])&&(Ve&&t.err(`Multiple variables found for term ${ge}`),Ve=!0);if(ge.contains(fe)){let Qe=X(H(J,Oe),fe);Oe--,S.set(V,ie,e.add(S.get(V,ie),Qe[0]))}}}for(let ie=0;ie<J.length;ie++)A.set(V,0,e.add(A.get(V,0),J[ie]))}}if(b.length!==r.length||S.determinant().equals(0))throw new t.exceptions.SolveError("System does not have a distinct solution");S=S.invert();let C=S.multiply(A);return t.Utils.isArray(g)&&C.each(V=>V.negate()),Q.systemSolutions(C,b,D)},quad(r,g,d){let S=e.subtract(e.pow(g.clone(),j(2)),e.multiply(e.multiply(d.clone(),r.clone()),j(4)));S=e.expand(S);let A=e.pow(S,j(.5)),D=e.parse(e.multiply(new j(2),d.clone()));return[e.parse(W("(-({0})+({1}))/({2})",g,A,D)),e.parse(W("(-({0})-({1}))/({2})",g,A,D))]},cubic(r,g,d,S){let A=S.text(),D=d.text(),b=g.text(),C=r.text(),V=`(-(${D})^3/(27*(${A})^3)+(${D})*(${b})/(6*(${A})^2)-(${C})/(2*(${A})))`,J=`((${b})/(3*(${A}))-(${D})^2/(9*(${A})^2))`,ie=`(${D})/(3*(${A}))`,fe=`((${V})+sqrt((${V})^2+(${J})^3))^(1/3)+((${V})-sqrt((${V})^2+(${J})^3))^(1/3)-(${ie})`,Oe="1/2+sqrt(3)/2*i";return[e.parse(fe),e.parse(`(${fe})(${Oe})`),e.parse(`(${fe})(${Oe})^2`)]},quartic(r,g,d,S,A){let D={};t.Utils.arrayUnique(_e(A).concat(_e(S)).concat(_e(d)).concat(_e(g)).concat(_e(r))).forEach(Ge=>{D[Ge]=1}),A=A.toString(),S=S.toString(),d=d.toString(),g=g.toString(),r=r.toString();let b,C=e.parse(W("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",A,S,d)).toString(),V=e.parse(W("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",A,S,d,g)).toString(),J=e.parse(W("12*({0})*({4})-3*({1})*({3})+({2})^2",A,S,d,g,r)).toString(),ie=e.parse(W("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",A,S,d,g,r)).toString(),fe=e.parse(W("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",J,ie)).toString(),Oe=e.parse(W("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",A,C,fe,J)).toString(),ge=e.parse(W("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",A,S,C,V,Oe)),Ve=e.parse(W("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",A,S,C,V,Oe)),Qe=e.parse(W("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",A,S,C,V,Oe)),Ae=e.parse(W("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",A,S,C,V,Oe));return[ge,Ve,Qe,Ae]},divideAndConquer(r,g){let d=[],S=t.Algebra.Factor.factorInner(r);return S.group===ue&&S.each(A=>{A=j.unwrapPARENS(A),d=d.concat(p(A,g))}),d},csolve(r,g){return t.Utils.block("IGNORE_E",()=>{let d,S,A,D,b,C,V,J,ie=[],fe=t.Utils.decompose_fn(r,g,!0);if(fe.x.group===Ue){d=e.parse(fe.x.power),S=Number(d),A=e.pow(e.divide(fe.b.negate(),fe.a),d.invert()),D=j.toPolarFormArray(A),b=D[0],C=D[1],V=b.toString(),J=d.toString();let Oe,ge,Ve;for(let Qe=0;Qe<S;Qe++)Oe=Qe,Ve=W("({0})*e^(2*{1}*pi*{2}*{3})",V,Oe,d,t.Settings.IMAGINARY),ge=e.parse(Ve),ie.push(ge)}return ie},!0)},getPoints(r,g,d){g||=.01;let S=[],A=u(r),b=Math.round(0),C=A(b),V=t.Settings.ROOTS_PER_SIDE,J=V;S.push(Math.floor(b/2)),S.push(Math.abs(b)),S.push(b),r.each(ge=>{ge.containsFunction(t.Settings.LOG)&&S.push(.1)});let ie=Be(-t.Settings.SOLVE_RADIUS,b,g),fe=Be(b,t.Settings.SOLVE_RADIUS,g),Oe=function(ge,Ve){let Qe,Ae,Ge,je=[],tt=ge[0],Xe=Math.sign(A(tt));for(let Je=0,nt=ge.length;Je<nt&&je.length<Ve;Je++)Qe=ge[Je],Ae=A(Qe),Ge=Math.sign(Ae),!isNaN(Ge)&&(Ge!==Xe&&(je.push(Qe),je.push(ge[Je-1])),Xe=Ge);S=S.concat(je)};if(Oe(ie,J),Oe(fe,V),d){let ge=t.Settings.SOLVE_RADIUS;Oe([ge,ge*ge],1),Oe([-ge*ge,-ge],1)}return S},bisection(r,g){let d=r-1,S=r+1;if(Math.sign(g(d))!==Math.sign(g(S))){let A=0,D,b;do{if(D=Math.abs(S-d),A++>t.Settings.MAX_BISECTION_ITER||isNaN(D))return;b=(d+S)/2,g(d)*g(b)>0?d=b:S=b}while(D>=Le.EPSILON);let C=(d+S)/2,V=g(C);return!isNaN(V)&&Math.abs(V)<=t.Settings.BI_SECTION_EPSILON?t.Utils.round(C,13):void 0}},bSearch(r,g,d){let S=d(r),A=d(g);if(Math.sign(S)===Math.sign(A)||isNaN(S)||isNaN(A))return;let D=80,b=0;do{let C=(r+g)/2,V=Math.sign(S),J=Math.sign(d(C));if(V===J){if(C===r)break;r=C,S=d(r)}else{if(C===g)break;g=C,A=d(g)}b++}while(r!==g&&b<D);if(!(!isFinite(d(r))||!isFinite(d(g))))return r},Newton(r,g,d,S){let A=t.Settings.MAX_NEWTON_ITERATIONS,D=0,b=r,C,V,J;do{let ie=g(b);if(b===0&&ie===0){C=0;break}if(D++,D>A)return;let fe=d(b);if(isNaN(fe)||isNaN(ie))return;if(fe===0)C+=J;else{if(!isFinite(ie)||!isFinite(fe)||Math.abs(ie)>1e25)return Q.bSearch(S,b,g);C=b-ie/fe}if(J=C-b,J===0&&!isFinite(fe))return;V=Math.abs(J),b=C}while(V>Le.NEWTON_EPSILON);return C},rewrite(r,g,d){if(g||=new j(0),r.isComposite()&&r.isLinear()){let D=[],b=[];r.each(C=>{C=C.clone(),C.fname==="sqrt"&&C.contains(d)?D.push(C):b.push(C)},!0),D.length===1&&(g=e.expand(e.pow(e.subtract(g,t.Utils.arraySum(b)),new j(2))),r=e.expand(e.pow(j.unwrapSQRT(D[0]),new j(2))))}else r=j.unwrapSQRT(e.expand(r));let S=0,A=r.length;if(r.group===ce&&r.contains(d)&&r.isLinear()){r.distributeMultiplier();let D=new j(0);return r.each(b=>{b.contains(d)?(S++,D=e.add(D,b.clone())):g=e.subtract(g,b.clone())}),r=D,S!==A?Q.rewrite(r,g,d):[r,g]}if(r.group===ue&&r.contains(d)&&r.isLinear()){if(r.multiplier.lessThan(0)&&(r.multiplier=r.multiplier.multiply(new t.Frac(-1)),g.multiplier=g.multiplier.multiply(new t.Frac(-1))),g.equals(0))return new j(0);let D=new j(1);return r.each(b=>{b.contains(d)?D=e.multiply(D,b.clone()):g=e.divide(g,b.clone())}),r=D,Q.rewrite(r,g,d)}if(!r.isLinear()&&r.contains(d)){let D=e.parse(r.power.clone().invert());return r=e.pow(r,D.clone()),g=e.pow(e.expand(g),D.clone()),Q.rewrite(r,g,d)}return r.group===Z||r.group===Ue||r.group===te?[r,g]:[r,g]},sqrtSolve(r,g){let d=new j(0),S=new j(0);if(r.isComposite()&&(r.each(A=>{A.fname==="sqrt"&&A.contains(g)?d=e.add(d,A.clone()):S=e.add(S,A.clone())}),!d.equals(0))){let A=e.expand(e.multiply(e.parse(r.multiplier),e.subtract(e.pow(S,new j(2)),e.pow(d,new j(2))))),D=p(A,g);return D=D.filter(b=>{if(b.isImaginary())return!0;let C={};return C[g]=b,!!K(r,C).equals(0)}),D}}},c=function(r,g,d,S){let A=r.toString(),D=A.match(/(?<![a-z])abs/gu);if(!D||D.length>2||r.LHS.group!==Z&&r.RHS.group!==Z)return null;let b=r.constructor(A.replace(/(?<![a-z])abs/u,"")),C=r.constructor(A.replace(/(?<![a-z])abs/u,"(-1)")),V=p(b,g,null,d,S);return[p(C,g,null,d,S),V]};function p(r,g,d,S,A){if(S||=0,S++>Le.MAX_SOLVE_DEPTH)return d;d||=[];let D={},b={};b[g]=0;let C=function(Ae,Ge){let je=de(Ae);if(!(Ae===void 0||typeof Ae=="number"&&isNaN(Ae))){if($e(Ae))Ae.forEach(tt=>{C(tt)});else if(Ae.valueOf()!=="null"){if(typeof t.Settings.PRE_ADD_SOLUTION=="function"&&(Ae=t.Settings.PRE_ADD_SOLUTION(Ae)),je||(Ae=e.parse(Ae)),t.Settings.make_pi_conversions&&Ge){let Xe=e.divide(Ae.clone(),new j(Math.PI)),Je=Xe.multiplier,nt=Math.abs(Je.num),Te=Math.abs(Je.den);nt<10&&Te<10&&(Ae=e.multiply(Xe,new j("pi")))}let tt=Ae.toString();D[tt]||d.push(Ae),D[tt]=!0}}};if(r instanceof ve){let Ae=c(r,g,d,S,A);if(Ae)return C(Ae),d;if(r.isZero())return[new j(0)];if(r.LHS.equals(g)&&!r.RHS.contains(g,!0))return[r.RHS];if(r.RHS.equals(g)&&!r.LHS.contains(g,!0))return[r.LHS]}if(r instanceof t.Vector&&(r=r.elements),$e(r))return Q.solveSystem(r,g);if(g||="x",de(r)&&K(r.getDenom(),b).equals(0)===!0)return d;if(r.group===Ue&&r.contains(g)){try{let Ae={};Ae[g]=0,K(A,Ae,"numer"),C(new j(0))}catch(Ae){if(Ae.message==="timeout")throw Ae}return d}if(r.group===ue){let Ae=r.getNum();if(Ae.group===ue){let Ge=String(g);return Ae.each(je=>{je.contains(Ge)&&p(je,g,d,S,r)}),d}return p(Ae,g,d,S,A)}r.group===Z&&r.fname==="sqrt"&&(r=e.pow(j.unwrapSQRT(r),new j(2)));let V=(t.Utils.isSymbol(r)?r:Q.toLHS(r,!1)).getNum(),J=t.Utils.variables(V),ie=J.length;if(t.Utils.isInt(V.power)&&V.power>1&&(V=e.parse(V).toLinear()),(V.group===Ue||V.group===ue)&&V.contains(g))return[new j(0)];let fe={},Oe,ge=function(Ae){Ae=e.expand(Ae,{expand_denominator:!0,expand_functions:!0});let Ge=Ae.clone();if(Ae.symbols)for(let je in Ae.symbols){if(!Object.hasOwn(Ae.symbols,je))continue;let tt=Ae.symbols[je],Xe=tt.getDenom();if(!Xe.isConstant(!0)&&Ae.isComposite()){let G=new j(0);return Ae.each(h=>{G=e.add(G,e.multiply(h,Xe.clone()))}),ge(e.multiply(e.parse(Ae.multiplier),G))}let Je=X(tt,g),nt=Je[1].fname===t.Settings.SQRT,Te=j.unwrapSQRT(Je[1]),F=Te.power.clone();if(!de(F)&&!F.equals(1/2)){if(F.den.gt(1)){if(nt)return Ae=e.subtract(Ae,tt.clone()),Ae=e.add(Ae,e.multiply(Je[0].clone(),Te)),ge(Ae);let G=fe[F.den];fe[F.den]=G?G++:1}else if(F.sign()===-1){let G=e.parse(`${g}^${Math.abs(F)}`),h=Ae;return h.each((R,Y)=>{R.contains(g)&&(h.symbols[Y]=e.multiply(R,G.clone()))}),fe={},ge(e.parse(h))}else if(tt.group===te){let G=t.Utils.arrayMin(t.Utils.keys(tt.symbols));if(G<0){let h=e.parse(`${g}^${Math.abs(G)}`),R=new j(0);return Ge.each(Y=>{R=e.add(R,e.multiply(Y.clone(),h.clone()))},!0),R}}}}return Ae},Ve=function(Ae){let Ge=new j(0),je=new j(0);return Ae.each(tt=>{tt.contains(g,!0)?Ge=e.add(Ge,tt.clone()):je=e.subtract(je,tt.clone())}),[Ge,je]};if(Q.inverseFunctionSolve=function(Ge,je,tt){let Xe=X(je.args[0],g);if(Xe[1].group===Ue)return e.divide(e.symfunction(Ge,[e.divide(tt,e.parse(je.multiplier))]),Xe[0])},V=ge(V),V.equals(0))return[V];let Qe=t.Utils.keys(fe);if(Qe.length===1&&(Oe=Qe[0],V.each((Ae,Ge)=>{if(Ae.contains(g)){let je=X(Ae,g),tt=je[1],Xe=tt.power;Xe.den.gt(1)&&(tt.power=Xe.multiply(new t.Frac(Oe)),V.symbols[Ge]=e.multiply(tt,je[0]))}}),V=e.parse(V)),C(Q.sqrtSolve(V,g)),ie===1)if(V.isPoly(!0)){let Ae=new t.Algebra.Classes.Factors;if(t.Algebra.Factor.factorInner(V,Ae),Ae.getNumberSymbolics()>1)for(let Ge in Ae.factors)Object.hasOwn(Ae.factors,Ge)&&C(p(Ae.factors[Ge],g));else{let Ge=t.Utils.getCoeffs(V,g),je=Ge.length-1,tt=!1;if(J[0]===g){if(me(Ge,Xe=>Xe.group!==t.groups.N)){let Xe=t.Algebra.proots(V);me(Xe,Je=>!t.Utils.isInt(Je))&&(tt=!0,Xe.forEach(Je=>{C(new j(Je))}))}if(!tt)if(r=e.parse(r),r instanceof t.Equation&&(r=r.toLHS()),je===1)C(e.divide(Ge[0],Ge[1].negate()));else if(je===2)C(e.expand(Q.quad.apply(void 0,Ge)));else if(je===3){let Xe=[],Je=t.Algebra.Factor.factorInner(r);Xe=[],Xe.length>0?C(Xe):C(Q.cubic.apply(void 0,Ge))}else v.proots(V).map(C)}}}else{let Ae=V.hasTrig(),Ge=Q.getPoints(V,.1),je=Q.getPoints(V,.05),tt=Q.getPoints(V,.01,!0),Xe=t.Utils.arrayUnique(Ge.concat(je).concat(tt)).sort((U,a)=>U-a),Je,nt,Te,F=u(V.clone()),G=[];for(Je=0;Je<Xe.length;Je++){if(nt=Xe[Je],Te=Q.bisection(nt,F),typeof Te>"u"){G.push(nt);continue}C(Te,Ae)}Xe=G;let h=q.diff(V.clone()),R=u(h),Y=Xe[0];for(Je=0;Je<Xe.length;Je++)nt=Xe[Je],C(Q.Newton(nt,F,R,Y),Ae),Y=nt;d.sort((U,a)=>{let y=U.text("decimals"),n=a.text("decimals"),s=Number(y),w=Number(n);return isNaN(s)&&isNaN(w)?y.localeCompare(n):isNaN(s)&&!isNaN(w)?-1:!isNaN(s)&&isNaN(w)?1:s-w}),d=d.map(U=>U.isConstant()?new j(Number(Number(U).toPrecision(15))):U),d=d.filter((U,a,y)=>{let n=Number(Number(U).toPrecision(15)),s=Number(y[a-1]);return a===0||isNaN(n)||isNaN(s)?!0:Math.abs(n-s)>=Le.EPSILON})}else if(!V.hasFunc(g)&&V.isComposite())try{let Ae=t.Algebra.Factor.factorInner(V.clone()),Ge=e.expand(e.parse(Ae)),je=e.expand(V.clone()),tt=e.subtract(Ge,je),Xe=!0;if(tt.equals(0)||(Xe=!1),Xe&&Ae.group===ue)Ae.each(Je=>{C(p(Je,g))});else{let Je=t.Utils.getCoeffs(V,g);switch(Je.length-1){case 0:{let F=Ve(V),G=F[0],h=F[1];if(G.group===t.groups.EX){let R=t.Settings.LOG,Y=`${R}((${h})/(${G.multiplier}))/(${R}(${G.value})*${G.power.multiplier})`,U=e.parse(Y);C(U)}break}case 1:C(e.divide(Je[0],Je[1].negate()));break;case 2:C(Q.quad.apply(void 0,Je));break;case 3:C(Q.cubic.apply(void 0,Je));break;case 4:C(Q.quartic.apply(void 0,Je));break;default:C(Q.csolve(V,g)),d.length===0&&C(Q.divideAndConquer(V,g))}d.length===0&&C(p(Ae,g,d,S))}}catch(Ae){if(Ae.message==="timeout")throw Ae}else try{let Ae=Q.rewrite(V,null,g),Ge=Ae[0],je=Ae[1];if(Ge.group===Z)if(Ge.fname==="abs")Ge.args[0].toString()===g&&C([je.clone(),je.negate()]);else if(Ge.fname==="sin")C(Q.inverseFunctionSolve("asin",Ge,je));else if(Ge.fname==="cos")C(Q.inverseFunctionSolve("acos",Ge,je));else if(Ge.fname==="tan")C(Q.inverseFunctionSolve("atan",Ge,je));else if(Ge.fname===t.Settings.LOG){let tt=X(Ge.args[0],g),Xe=tt[1];if(Xe.group===Ue){je=e.divide(e.subtract(e.pow(Ge.args.length>1?Ge.args[1]:new j("e"),e.divide(je,e.parse(Ge.multiplier))),tt[3]),tt[0]);let Je=new ve(Xe,je).toLHS();C(p(Je,g))}}else C(e.subtract(Ge,je));else{let tt=new ve(Ge,je).toLHS();if(tt.equals(V))throw new Error("Stopping. No stop condition exists");C(p(tt,g))}}catch(Ae){if(Ae.message==="timeout")throw Ae;if(V.group===ue)C(0);else if(V.group===ce){let Ge=Ve(V),je=Ge[0],tt=Ge[1];if(je.group===t.groups.EX&&je.value===g){let Xe=je.power.clone().invert();C(e.pow(tt,Xe))}}}if(Oe&&(d=d.map(Ae=>e.pow(Ae,new j(Oe)))),de(r)){let Ae={};d=d.filter(Ge=>{try{Ae[g]=Ge;let je=Number(K(r,Ae));return isNaN(je),!0}catch(je){if(je.message==="timeout")throw je;return!1}})}return d}i1.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return p}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return t.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return qe}}]),i1.updateAPI()})()});var _n=E0((Qi,y1)=>{"use strict";var r1;typeof y1<"u"&&(r1=G0(),t1(),n1());(function(){let t=r1.getCore(),e=t.PARSER,{NerdamerSymbol:v}=t,{format:q}=t.Utils,{isVector:X}=t.Utils,{isArray:K}=t.Utils,H=t.Vector,{S:W}=t.groups,u=t.groups.EX,{CP:re}=t.groups,{PL:j}=t.groups,{CB:de}=t.groups,{FN:_e}=t.groups;t.Settings.Laplace_integration_depth=40,v.prototype.findFunction=function(ue){if(this.group===_e&&this.fname===ue)return this.clone();let ce;if(this.symbols){for(let Z in this.symbols)if(Object.hasOwn(this.symbols,Z)&&(ce=this.symbols[Z].findFunction(ue),ce))break}return ce};let Ue=t.Extra={version:"1.4.2",LaPlace:{transform(te,ue,ce){te=te.clone(),ue=ue.toString(),te=v.unwrapSQRT(te,!0);let Z,Le=te.stripVar(ue),Be=te.group;if(te=e.divide(te,Le.clone()),te.isConstant()||!te.contains(ue,!0))Z=e.parse(q("({0})/({1})",te,ce));else if(Be===W&&t.Utils.isInt(te.power)){let $e=String(te.power);Z=e.parse(q("factorial({0})/({1})^({0}+1)",$e,ce))}else if(te.group===W&&te.power.equals(1/2))Z=e.parse(q("sqrt(pi)/(2*({0})^(3/2))",ce));else if(te.isComposite())Z=new v(0),te.each($e=>{Z=e.add(Z,Ue.LaPlace.transform($e,ue,ce))},!0);else if(te.isE()&&(te.power.group===W||te.power.group===de)){let $e=te.power.stripVar(ue);Z=e.parse(q("1/(({1})-({0}))",$e,ce))}else{let $e=["sin","cos","sinh","cosh"];if(te.group===_e&&$e.indexOf(te.fname)!==-1&&(te.args[0].group===W||te.args[0].group===de)){let ve=te.args[0].stripVar(ue);switch(te.fname){case"sin":Z=e.parse(q("({0})/(({1})^2+({0})^2)",ve,ce));break;case"cos":Z=e.parse(q("({1})/(({1})^2+({0})^2)",ve,ce));break;case"sinh":Z=e.parse(q("({0})/(({1})^2-({0})^2)",ve,ce));break;case"cosh":Z=e.parse(q("({1})/(({1})^2-({0})^2)",ve,ce));break}}else{let ve=t.Settings.integration_depth<t.Settings.Laplace_integration_depth,qe;ve&&(qe=t.Settings.integration_depth,t.Settings.integration_depth=t.Settings.Laplace_integration_depth),t.Utils.block("PARSE2NUMBER",()=>{let me=ue,Q=te.sub(ue,me),c=e.parse(`e^(-${ce}*${me})*${Q}`);if(Z=t.Calculus.integrate(c,me),Z.hasIntegral()){Z=e.symfunction("laplace",[te,ue,ce]);return}Z=Z.sub(ue,0),Z=e.expand(e.multiply(Z,new v(-1))),Z=Z.sub(me,ue)},!1),Z=t.Utils.block("PARSE2NUMBER",()=>e.parse(Z),!0),ve&&(t.Settings.integration_depth=qe)}}return e.multiply(Z,Le)},inverse(te,ue,ce){let Z=te.clone();return t.Utils.block("POSITIVE_MULTIPLIERS",()=>{let Le;if(te.group===de&&(te=t.Algebra.PartFrac.partfrac(e.expand(te),ue)),te.group===W||te.group===de||te.isComposite()){let Be,$e,ve,qe,me,Q,c,p,r=te.multiplier.clone();te.toUnitMultiplier();let g=te.getNum(),d=te.getDenom().toUnitMultiplier();d.group===re||d.group===j?($e=d.power.clone(),d.toLinear()):$e=new t.Frac(1);let S=ue.toString(),A=t.Utils.decompose_fn(d,S,!0),D=t.Utils.decompose_fn(e.expand(g.clone()),S,!0);g.multiplier=g.multiplier.multiply(r);let b=function(){Le=e.multiply(Le,g),Le.multiplier=Le.multiplier.multiply(te.multiplier),Le=e.divide(Le,A.a)};if((d.group===W||d.group===de)&&A.x.value===S&&A.b.equals(0)&&t.Utils.isInt(A.x.power))Be=A.x.power-1,p=t.Math2.factorial(Be),Le=e.divide(e.pow(ce,new v(Be)),new v(p)),b();else if(d.group===re&&$e.equals(1)){if(A.x.group===t.groups.PL&&t.Algebra.degree(d).equals(2)){let C=t.Algebra.sqComplete(d,S),V=t.Utils.getU(d);ve=t.Utils.decompose_fn(C.a,S,!0).b;let J=Ue.LaPlace.inverse(e.parse(`1/((${V})^2+(${C.c}))`),V,ce);Le=e.multiply(J,e.parse(`(${r})*e^(-(${ve})*(${ce}))`))}else if(A.x.isLinear()&&!g.contains(S))ce=e.divide(ce,A.a.clone()),Be=$e-1,p=Be===0||Be===1?"1":`(${$e}-1)!`,Le=e.parse(q("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",ce,A.a,A.b,$e,p)),b();else if(A.x.group===W&&A.x.power.equals(2))if(g.contains(S)){if(ve=new v(1),g.group===de){let ge=new v(1);g.each(Ve=>{Ve.contains(S)?ge=e.multiply(ge,Ve):ve=e.multiply(ve,Ve)}),g=ge}c=t.Utils.decompose_fn(g,S,!0);let C=c.a,V=c.b,J=C.containsFunction("sin"),ie=C.containsFunction("cos"),fe=V.containsFunction("cos"),Oe=V.containsFunction("sin");if(c.x.value===S&&c.x.isLinear()&&!(J&&fe||ie||Oe))Le=e.parse(q("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",ce,c.a,A.a,A.b));else if(J&&fe){let ge=C.findFunction("sin"),Ve=V.findFunction("cos");if(ge.args[0].equals(Ve.args[0])&&!ge.args[0].contains(S)){qe=e.divide(V,Ve.toUnitMultiplier()).toString();let Qe=ge.args[0].toString();me=A.b;let Ae=e.divide(C,ge.toUnitMultiplier());Q="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",Le=e.parse(q(Q,ce,ve,qe,Qe,me,Ae))}}}else Le=e.parse(q("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",ce,g,A.a,A.b))}else if(A.x.power.num&&A.x.power.num.equals(3)&&A.x.power.den.equals(2)&&g.contains("sqrt(pi)")&&!g.contains(S)&&g.isLinear())qe=e.divide(g.clone(),e.parse("sqrt(pi)")),Le=e.parse(q("(2*({2})*sqrt({0}))/({1})",ce,A.a,qe,g));else if($e.equals(2)&&A.x.power.equals(2))if(g.contains(S))if(c=t.Utils.decompose_fn(e.expand(g.clone()),S,!0),c.x.isComposite()){let C=[],V=g.collectSymbols(J=>{J=v.unwrapPARENS(J);let ie=t.Utils.decompose_fn(J,S,!0);return ie.symbol=J,ie}).sort((J,ie)=>{let fe=J.x.value===S?J.x.power:0;return(ie.x.value===S?ie.x.power:0)-fe});ve=new v(-1);for(let J=0;J<V.length;J++){let ie=V[J];ie.x.value===S?C.push(ie):ve=e.multiply(ve,ie.symbol)}C[0].x.power.equals(2)&&C[1].x.power.equals(1)&&C[1].b.equals(0)&&!C[0].b.equals(0)&&(qe=C[0].a.negate(),Q="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",Le=e.parse(q(Q,ce,ve,qe,C[0].b,A.a,A.b)))}else c.x.isLinear()?(ve=e.divide(c.a,new v(2)),Q="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",Le=e.parse(q(Q,ce,ve,A.a,A.b))):c.x.power.equals(2)&&(c.b.equals(0)?(ve=e.divide(c.a,new v(2)),Q="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Le=e.parse(q(Q,ce,ve,A.a,A.b))):(ve=e.divide(c.a,new v(2)),me=c.b.negate(),Q="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Le=e.parse(q(Q,ce,ve,A.a,A.b,me))));else ve=e.divide(g,new v(2)),Q="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",Le=e.parse(q(Q,ce,ve,A.a,A.b));else te.isComposite()&&($e.equals(2)&&A.x.group===W?Le=e.parse(`(${r})*(${ce})*e^(-(${A.b})*(${ce}))`):(Le=new v(0),te=t.Algebra.PartFrac.partfrac(e.expand(te),ue),te.each(C=>{Le=e.add(Le,Ue.LaPlace.inverse(C,ue,ce))},!0)))}return Le||=e.symfunction("ilt",[Z,ue,ce]),Le},!0)}},Statistics:{frequencyMap(te){let ue={};for(let ce=0,Z=te.length;ce<Z;ce++){let Be=te[ce].toString();ue[Be]||=0,ue[Be]++}return ue},sort(te){return te.sort((ue,ce)=>((!ue.isConstant()||!ce.isConstant())&&e.error("Unable to sort! All values must be numeric"),ue.multiplier.subtract(ce.multiplier)))},count(te){return new v(te.length)},sum(te,ue){let ce=new v(0);for(let Z=0,Le=te.length;Z<Le;Z++){let Be=te[Z].clone();ue?ce=e.add(e.pow(e.subtract(Be,ue.clone()),new v(2)),ce):ce=e.add(Be,ce)}return ce},mean(...te){return X(te[0])?Ue.Statistics.mean(...te[0].elements):e.divide(Ue.Statistics.sum(te),Ue.Statistics.count(te))},median(...te){let ue;if(X(te[0]))return Ue.Statistics.median(...te[0].elements);try{let ce=Ue.Statistics.sort(te),Z=te.length;if(t.Utils.even(Z)){let Le=Z/2;ue=Ue.Statistics.mean(ce[Le-1],ce[Le])}else ue=ce[Math.floor(Z/2)]}catch(ce){if(ce.message==="timeout")throw ce;ue=e.symfunction("median",te)}return ue},mode(...te){let ue;if(X(te[0]))return Ue.Statistics.mode(...te[0].elements);let ce=Ue.Statistics.frequencyMap(te);if(t.Utils.keys(ce).length===1)ue=te[0];else{let Z={};for(let Be in ce){if(!Object.hasOwn(ce,Be))continue;let $e=ce[Be];if($e in Z){let ve=Z[$e];K(ve)?ve.push(Be):Z[$e]=[Be,Z[$e]]}else Z[$e]=Be}let Le=Z[Math.max.apply(null,t.Utils.keys(Z))];K(Le)?ue=e.symfunction("mode",Le.sort()):ue=e.parse(Le)}return ue},gVariance(te,ue){let ce=Ue.Statistics.mean(...ue),Z=Ue.Statistics.sum(ue,ce);return e.multiply(te,Z)},variance(...te){if(X(te[0]))return Ue.Statistics.variance(...te[0].elements);let ue=e.divide(new v(1),Ue.Statistics.count(te));return Ue.Statistics.gVariance(ue,te)},sampleVariance(...te){if(X(te[0]))return Ue.Statistics.sampleVariance(...te[0].elements);let ue=e.divide(new v(1),e.subtract(Ue.Statistics.count(te),new v(1)));return Ue.Statistics.gVariance(ue,te)},standardDeviation(...te){return X(te[0])?Ue.Statistics.standardDeviation(...te[0].elements):e.pow(Ue.Statistics.variance(...te),new v(1/2))},sampleStandardDeviation(...te){return X(te[0])?Ue.Statistics.sampleStandardDeviation(...te[0].elements):e.pow(Ue.Statistics.sampleVariance(...te),new v(1/2))},zScore(te,ue,ce){return e.divide(e.subtract(te,ue),ce)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};r1.register([{name:"laplace",visible:!0,numargs:3,build(){return Ue.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Ue.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Ue.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Ue.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Ue.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Ue.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Ue.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Ue.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Ue.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Ue.Statistics.zScore}}]),r1.updateAPI()})();typeof y1<"u"&&(y1.exports=r1)});var Vi=E0((Ji,In)=>{var Bi=G0();n1();t1();An();_n();In.exports=Bi});return Vi();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
