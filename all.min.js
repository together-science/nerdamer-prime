"use strict";var nerdamer=(()=>{var f0=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var qn=f0((zi,H0)=>{var Ft=(function(s){"use strict";var t=1e7,e=7,o=9007199254740992,g=de(o),y="0123456789abcdefghijklmnopqrstuvwxyz",L=typeof BigInt=="function";function C(c,p,I,P){return typeof c>"u"?C[0]:typeof p<"u"?+p==10&&!I?O(c):Ye(c,p,I,P):O(c)}function D(c,p){this.value=c,this.sign=p,this.isSmall=!1}D.prototype=Object.create(C.prototype);function Z(c){this.value=c,this.sign=c<0,this.isSmall=!0}Z.prototype=Object.create(C.prototype);function G(c){this.value=c}G.prototype=Object.create(C.prototype);function V(c){return-o<c&&c<o}function de(c){return c<1e7?[c]:c<1e14?[c%1e7,Math.floor(c/1e7)]:[c%1e7,Math.floor(c/1e7)%1e7,Math.floor(c/1e14)]}function Ee(c){Me(c);var p=c.length;if(p<4&&b(c,g)<0)switch(p){case 0:return 0;case 1:return c[0];case 2:return c[0]+c[1]*t;default:return c[0]+(c[1]+c[2]*t)*t}return c}function Me(c){for(var p=c.length;c[--p]===0;);c.length=p+1}function ae(c){for(var p=new Array(c),I=-1;++I<c;)p[I]=0;return p}function ce(c){return c>0?Math.floor(c):Math.ceil(c)}function ue(c,p){var I=c.length,P=p.length,k=new Array(I),j=0,H=t,$,F;for(F=0;F<P;F++)$=c[F]+p[F]+j,j=$>=H?1:0,k[F]=$-j*H;for(;F<I;)$=c[F]+j,j=$===H?1:0,k[F++]=$-j*H;return j>0&&k.push(j),k}function u(c,p){return c.length>=p.length?ue(c,p):ue(p,c)}function Ne(c,p){var I=c.length,P=new Array(I),k=t,j,H;for(H=0;H<I;H++)j=c[H]-k+p,p=Math.floor(j/k),P[H]=j-p*k,p+=1;for(;p>0;)P[H++]=p%k,p=Math.floor(p/k);return P}D.prototype.add=function(c){var p=O(c);if(this.sign!==p.sign)return this.subtract(p.negate());var I=this.value,P=p.value;return p.isSmall?new D(Ne(I,Math.abs(P)),this.sign):new D(u(I,P),this.sign)},D.prototype.plus=D.prototype.add,Z.prototype.add=function(c){var p=O(c),I=this.value;if(I<0!==p.sign)return this.subtract(p.negate());var P=p.value;if(p.isSmall){if(V(I+P))return new Z(I+P);P=de(Math.abs(P))}return new D(Ne(P,Math.abs(I)),I<0)},Z.prototype.plus=Z.prototype.add,G.prototype.add=function(c){return new G(this.value+O(c).value)},G.prototype.plus=G.prototype.add;function Oe(c,p){var I=c.length,P=p.length,k=new Array(I),j=0,H=t,$,F;for($=0;$<P;$++)F=c[$]-j-p[$],F<0?(F+=H,j=1):j=0,k[$]=F;for($=P;$<I;$++){if(F=c[$]-j,F<0)F+=H;else{k[$++]=F;break}k[$]=F}for(;$<I;$++)k[$]=c[$];return Me(k),k}function Pe(c,p,I){var P;return b(c,p)>=0?P=Oe(c,p):(P=Oe(p,c),I=!I),P=Ee(P),typeof P=="number"?(I&&(P=-P),new Z(P)):new D(P,I)}function ye(c,p,I){var P=c.length,k=new Array(P),j=-p,H=t,$,F;for($=0;$<P;$++)F=c[$]+j,j=Math.floor(F/H),F%=H,k[$]=F<0?F+H:F;return k=Ee(k),typeof k=="number"?(I&&(k=-k),new Z(k)):new D(k,I)}D.prototype.subtract=function(c){var p=O(c);if(this.sign!==p.sign)return this.add(p.negate());var I=this.value,P=p.value;return p.isSmall?ye(I,Math.abs(P),this.sign):Pe(I,P,this.sign)},D.prototype.minus=D.prototype.subtract,Z.prototype.subtract=function(c){var p=O(c),I=this.value;if(I<0!==p.sign)return this.add(p.negate());var P=p.value;return p.isSmall?new Z(I-P):ye(P,Math.abs(I),I>=0)},Z.prototype.minus=Z.prototype.subtract,G.prototype.subtract=function(c){return new G(this.value-O(c).value)},G.prototype.minus=G.prototype.subtract,D.prototype.negate=function(){return new D(this.value,!this.sign)},Z.prototype.negate=function(){var c=this.sign,p=new Z(-this.value);return p.sign=!c,p},G.prototype.negate=function(){return new G(-this.value)},D.prototype.abs=function(){return new D(this.value,!1)},Z.prototype.abs=function(){return new Z(Math.abs(this.value))},G.prototype.abs=function(){return new G(this.value>=0?this.value:-this.value)};function $e(c,p){var I=c.length,P=p.length,k=I+P,j=ae(k),H=t,$,F,ie,me,Ae;for(ie=0;ie<I;++ie){me=c[ie];for(var ve=0;ve<P;++ve)Ae=p[ve],$=me*Ae+j[ie+ve],F=Math.floor($/H),j[ie+ve]=$-F*H,j[ie+ve+1]+=F}return Me(j),j}function he(c,p){var I=c.length,P=new Array(I),k=t,j=0,H,$;for($=0;$<I;$++)H=c[$]*p+j,j=Math.floor(H/k),P[$]=H-j*k;for(;j>0;)P[$++]=j%k,j=Math.floor(j/k);return P}function Se(c,p){for(var I=[];p-- >0;)I.push(0);return I.concat(c)}function be(c,p){var I=Math.max(c.length,p.length);if(I<=30)return $e(c,p);I=Math.ceil(I/2);var P=c.slice(I),k=c.slice(0,I),j=p.slice(I),H=p.slice(0,I),$=be(k,H),F=be(P,j),ie=be(u(k,P),u(H,j)),me=u(u($,Se(Oe(Oe(ie,$),F),I)),Se(F,2*I));return Me(me),me}function se(c,p){return-.012*c-.012*p+15e-6*c*p>0}D.prototype.multiply=function(c){var p=O(c),I=this.value,P=p.value,k=this.sign!==p.sign,j;if(p.isSmall){if(P===0)return C[0];if(P===1)return this;if(P===-1)return this.negate();if(j=Math.abs(P),j<t)return new D(he(I,j),k);P=de(j)}return se(I.length,P.length)?new D(be(I,P),k):new D($e(I,P),k)},D.prototype.times=D.prototype.multiply;function i(c,p,I){return c<t?new D(he(p,c),I):new D($e(p,de(c)),I)}Z.prototype._multiplyBySmall=function(c){return V(c.value*this.value)?new Z(c.value*this.value):i(Math.abs(c.value),de(Math.abs(this.value)),this.sign!==c.sign)},D.prototype._multiplyBySmall=function(c){return c.value===0?C[0]:c.value===1?this:c.value===-1?this.negate():i(Math.abs(c.value),this.value,this.sign!==c.sign)},Z.prototype.multiply=function(c){return O(c)._multiplyBySmall(this)},Z.prototype.times=Z.prototype.multiply,G.prototype.multiply=function(c){return new G(this.value*O(c).value)},G.prototype.times=G.prototype.multiply;function a(c){var p=c.length,I=ae(p+p),P=t,k,j,H,$,F;for(H=0;H<p;H++){$=c[H],j=0-$*$;for(var ie=H;ie<p;ie++)F=c[ie],k=2*($*F)+I[H+ie]+j,j=Math.floor(k/P),I[H+ie]=k-j*P;I[H+p]=j}return Me(I),I}D.prototype.square=function(){return new D(a(this.value),!1)},Z.prototype.square=function(){var c=this.value*this.value;return V(c)?new Z(c):new D(a(de(Math.abs(this.value))),!1)},G.prototype.square=function(c){return new G(this.value*this.value)};function f(c,p){var I=c.length,P=p.length,k=t,j=ae(p.length),H=p[P-1],$=Math.ceil(k/(2*H)),F=he(c,$),ie=he(p,$),me,Ae,ve,De,Fe,We,Qe;for(F.length<=I&&F.push(0),ie.push(0),H=ie[P-1],Ae=I-P;Ae>=0;Ae--){for(me=k-1,F[Ae+P]!==H&&(me=Math.floor((F[Ae+P]*k+F[Ae+P-1])/H)),ve=0,De=0,We=ie.length,Fe=0;Fe<We;Fe++)ve+=me*ie[Fe],Qe=Math.floor(ve/k),De+=F[Ae+Fe]-(ve-Qe*k),ve=Qe,De<0?(F[Ae+Fe]=De+k,De=-1):(F[Ae+Fe]=De,De=0);for(;De!==0;){for(me-=1,ve=0,Fe=0;Fe<We;Fe++)ve+=F[Ae+Fe]-k+ie[Fe],ve<0?(F[Ae+Fe]=ve+k,ve=0):(F[Ae+Fe]=ve,ve=1);De+=ve}j[Ae]=me}return F=d(F,$)[0],[Ee(j),Ee(F)]}function w(c,p){for(var I=c.length,P=p.length,k=[],j=[],H=t,$,F,ie,me,Ae;I;){if(j.unshift(c[--I]),Me(j),b(j,p)<0){k.push(0);continue}F=j.length,ie=j[F-1]*H+j[F-2],me=p[P-1]*H+p[P-2],F>P&&(ie=(ie+1)*H),$=Math.ceil(ie/me);do{if(Ae=he(p,$),b(Ae,j)<=0)break;$--}while($);k.push($),j=Oe(j,Ae)}return k.reverse(),[Ee(k),Ee(j)]}function d(c,p){var I=c.length,P=ae(I),k=t,j,H,$,F;for($=0,j=I-1;j>=0;--j)F=$*k+c[j],H=ce(F/p),$=F-H*p,P[j]=H|0;return[P,$|0]}function v(c,p){var I,P=O(p);if(L)return[new G(c.value/P.value),new G(c.value%P.value)];var k=c.value,j=P.value,H;if(j===0)throw new Error("Cannot divide by zero");if(c.isSmall)return P.isSmall?[new Z(ce(k/j)),new Z(k%j)]:[C[0],c];if(P.isSmall){if(j===1)return[c,C[0]];if(j==-1)return[c.negate(),C[0]];var $=Math.abs(j);if($<t){I=d(k,$),H=Ee(I[0]);var F=I[1];return c.sign&&(F=-F),typeof H=="number"?(c.sign!==P.sign&&(H=-H),[new Z(H),new Z(F)]):[new D(H,c.sign!==P.sign),new Z(F)]}j=de($)}var ie=b(k,j);if(ie===-1)return[C[0],c];if(ie===0)return[C[c.sign===P.sign?1:-1],C[0]];k.length+j.length<=200?I=f(k,j):I=w(k,j),H=I[0];var me=c.sign!==P.sign,Ae=I[1],ve=c.sign;return typeof H=="number"?(me&&(H=-H),H=new Z(H)):H=new D(H,me),typeof Ae=="number"?(ve&&(Ae=-Ae),Ae=new Z(Ae)):Ae=new D(Ae,ve),[H,Ae]}D.prototype.divmod=function(c){var p=v(this,c);return{quotient:p[0],remainder:p[1]}},G.prototype.divmod=Z.prototype.divmod=D.prototype.divmod,D.prototype.divide=function(c){return v(this,c)[0]},G.prototype.over=G.prototype.divide=function(c){return new G(this.value/O(c).value)},Z.prototype.over=Z.prototype.divide=D.prototype.over=D.prototype.divide,D.prototype.mod=function(c){return v(this,c)[1]},G.prototype.mod=G.prototype.remainder=function(c){return new G(this.value%O(c).value)},Z.prototype.remainder=Z.prototype.mod=D.prototype.remainder=D.prototype.mod,D.prototype.pow=function(c){var p=O(c),I=this.value,P=p.value,k,j,H;if(P===0)return C[1];if(I===0)return C[0];if(I===1)return C[1];if(I===-1)return p.isEven()?C[1]:C[-1];if(p.sign)return C[0];if(!p.isSmall)throw new Error("The exponent "+p.toString()+" is too large.");if(this.isSmall&&V(k=Math.pow(I,P)))return new Z(ce(k));for(j=this,H=C[1];P&!0&&(H=H.times(j),--P),P!==0;)P/=2,j=j.square();return H},Z.prototype.pow=D.prototype.pow,G.prototype.pow=function(c){var p=O(c),I=this.value,P=p.value,k=BigInt(0),j=BigInt(1),H=BigInt(2);if(P===k)return C[1];if(I===k)return C[0];if(I===j)return C[1];if(I===BigInt(-1))return p.isEven()?C[1]:C[-1];if(p.isNegative())return new G(k);for(var $=this,F=C[1];(P&j)===j&&(F=F.times($),--P),P!==k;)P/=H,$=$.square();return F},D.prototype.modPow=function(c,p){if(c=O(c),p=O(p),p.isZero())throw new Error("Cannot take modPow with modulus 0");var I=C[1],P=this.mod(p);for(c.isNegative()&&(c=c.multiply(C[-1]),P=P.modInv(p));c.isPositive();){if(P.isZero())return C[0];c.isOdd()&&(I=I.multiply(P).mod(p)),c=c.divide(2),P=P.square().mod(p)}return I},G.prototype.modPow=Z.prototype.modPow=D.prototype.modPow;function b(c,p){if(c.length!==p.length)return c.length>p.length?1:-1;for(var I=c.length-1;I>=0;I--)if(c[I]!==p[I])return c[I]>p[I]?1:-1;return 0}D.prototype.compareAbs=function(c){var p=O(c),I=this.value,P=p.value;return p.isSmall?1:b(I,P)},Z.prototype.compareAbs=function(c){var p=O(c),I=Math.abs(this.value),P=p.value;return p.isSmall?(P=Math.abs(P),I===P?0:I>P?1:-1):-1},G.prototype.compareAbs=function(c){var p=this.value,I=O(c).value;return p=p>=0?p:-p,I=I>=0?I:-I,p===I?0:p>I?1:-1},D.prototype.compare=function(c){if(c===1/0)return-1;if(c===-1/0)return 1;var p=O(c),I=this.value,P=p.value;return this.sign!==p.sign?p.sign?1:-1:p.isSmall?this.sign?-1:1:b(I,P)*(this.sign?-1:1)},D.prototype.compareTo=D.prototype.compare,Z.prototype.compare=function(c){if(c===1/0)return-1;if(c===-1/0)return 1;var p=O(c),I=this.value,P=p.value;return p.isSmall?I==P?0:I>P?1:-1:I<0!==p.sign?I<0?-1:1:I<0?1:-1},Z.prototype.compareTo=Z.prototype.compare,G.prototype.compare=function(c){if(c===1/0)return-1;if(c===-1/0)return 1;var p=this.value,I=O(c).value;return p===I?0:p>I?1:-1},G.prototype.compareTo=G.prototype.compare,D.prototype.equals=function(c){return this.compare(c)===0},G.prototype.eq=G.prototype.equals=Z.prototype.eq=Z.prototype.equals=D.prototype.eq=D.prototype.equals,D.prototype.notEquals=function(c){return this.compare(c)!==0},G.prototype.neq=G.prototype.notEquals=Z.prototype.neq=Z.prototype.notEquals=D.prototype.neq=D.prototype.notEquals,D.prototype.greater=function(c){return this.compare(c)>0},G.prototype.gt=G.prototype.greater=Z.prototype.gt=Z.prototype.greater=D.prototype.gt=D.prototype.greater,D.prototype.lesser=function(c){return this.compare(c)<0},G.prototype.lt=G.prototype.lesser=Z.prototype.lt=Z.prototype.lesser=D.prototype.lt=D.prototype.lesser,D.prototype.greaterOrEquals=function(c){return this.compare(c)>=0},G.prototype.geq=G.prototype.greaterOrEquals=Z.prototype.geq=Z.prototype.greaterOrEquals=D.prototype.geq=D.prototype.greaterOrEquals,D.prototype.lesserOrEquals=function(c){return this.compare(c)<=0},G.prototype.leq=G.prototype.lesserOrEquals=Z.prototype.leq=Z.prototype.lesserOrEquals=D.prototype.leq=D.prototype.lesserOrEquals,D.prototype.isEven=function(){return(this.value[0]&1)===0},Z.prototype.isEven=function(){return(this.value&1)===0},G.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},D.prototype.isOdd=function(){return(this.value[0]&1)===1},Z.prototype.isOdd=function(){return(this.value&1)===1},G.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},D.prototype.isPositive=function(){return!this.sign},Z.prototype.isPositive=function(){return this.value>0},G.prototype.isPositive=Z.prototype.isPositive,D.prototype.isNegative=function(){return this.sign},Z.prototype.isNegative=function(){return this.value<0},G.prototype.isNegative=Z.prototype.isNegative,D.prototype.isUnit=function(){return!1},Z.prototype.isUnit=function(){return Math.abs(this.value)===1},G.prototype.isUnit=function(){return this.abs().value===BigInt(1)},D.prototype.isZero=function(){return!1},Z.prototype.isZero=function(){return this.value===0},G.prototype.isZero=function(){return this.value===BigInt(0)},D.prototype.isDivisibleBy=function(c){var p=O(c);return p.isZero()?!1:p.isUnit()?!0:p.compareAbs(2)===0?this.isEven():this.mod(p).isZero()},G.prototype.isDivisibleBy=Z.prototype.isDivisibleBy=D.prototype.isDivisibleBy;function R(c){var p=c.abs();if(p.isUnit())return!1;if(p.equals(2)||p.equals(3)||p.equals(5))return!0;if(p.isEven()||p.isDivisibleBy(3)||p.isDivisibleBy(5))return!1;if(p.lesser(49))return!0}function U(c,p){for(var I=c.prev(),P=I,k=0,j,H,$,F;P.isEven();)P=P.divide(2),k++;e:for($=0;$<p.length;$++)if(!c.lesser(p[$])&&(F=Ft(p[$]).modPow(P,c),!(F.isUnit()||F.equals(I)))){for(j=k-1;j!=0;j--){if(F=F.square().mod(c),F.isUnit())return!1;if(F.equals(I))continue e}return!1}return!0}D.prototype.isPrime=function(c){var p=R(this);if(p!==s)return p;var I=this.abs(),P=I.bitLength();if(P<=64)return U(I,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var k=Math.log(2)*P.toJSNumber(),j=Math.ceil(c===!0?2*Math.pow(k,2):k),H=[],$=0;$<j;$++)H.push(Ft($+2));return U(I,H)},G.prototype.isPrime=Z.prototype.isPrime=D.prototype.isPrime,D.prototype.isProbablePrime=function(c,p){var I=R(this);if(I!==s)return I;for(var P=this.abs(),k=c===s?5:c,j=[],H=0;H<k;H++)j.push(Ft.randBetween(2,P.minus(2),p));return U(P,j)},G.prototype.isProbablePrime=Z.prototype.isProbablePrime=D.prototype.isProbablePrime,D.prototype.modInv=function(c){for(var p=Ft.zero,I=Ft.one,P=O(c),k=this.abs(),j,H,$;!k.isZero();)j=P.divide(k),H=p,$=P,p=I,P=k,I=H.subtract(j.multiply(I)),k=$.subtract(j.multiply(k));if(!P.isUnit())throw new Error(this.toString()+" and "+c.toString()+" are not co-prime");return p.compare(0)===-1&&(p=p.add(c)),this.isNegative()?p.negate():p},G.prototype.modInv=Z.prototype.modInv=D.prototype.modInv,D.prototype.next=function(){var c=this.value;return this.sign?ye(c,1,this.sign):new D(Ne(c,1),this.sign)},Z.prototype.next=function(){var c=this.value;return c+1<o?new Z(c+1):new D(g,!1)},G.prototype.next=function(){return new G(this.value+BigInt(1))},D.prototype.prev=function(){var c=this.value;return this.sign?new D(Ne(c,1),!0):ye(c,1,this.sign)},Z.prototype.prev=function(){var c=this.value;return c-1>-o?new Z(c-1):new D(g,!0)},G.prototype.prev=function(){return new G(this.value-BigInt(1))};for(var B=[1];2*B[B.length-1]<=t;)B.push(2*B[B.length-1]);var te=B.length,re=B[te-1];function we(c){return Math.abs(c)<=t}D.prototype.shiftLeft=function(c){var p=O(c).toJSNumber();if(!we(p))throw new Error(String(p)+" is too large for shifting.");if(p<0)return this.shiftRight(-p);var I=this;if(I.isZero())return I;for(;p>=te;)I=I.multiply(re),p-=te-1;return I.multiply(B[p])},G.prototype.shiftLeft=Z.prototype.shiftLeft=D.prototype.shiftLeft,D.prototype.shiftRight=function(c){var p,I=O(c).toJSNumber();if(!we(I))throw new Error(String(I)+" is too large for shifting.");if(I<0)return this.shiftLeft(-I);for(var P=this;I>=te;){if(P.isZero()||P.isNegative()&&P.isUnit())return P;p=v(P,re),P=p[1].isNegative()?p[0].prev():p[0],I-=te-1}return p=v(P,B[I]),p[1].isNegative()?p[0].prev():p[0]},G.prototype.shiftRight=Z.prototype.shiftRight=D.prototype.shiftRight;function pe(c,p,I){p=O(p);for(var P=c.isNegative(),k=p.isNegative(),j=P?c.not():c,H=k?p.not():p,$=0,F=0,ie=null,me=null,Ae=[];!j.isZero()||!H.isZero();)ie=v(j,re),$=ie[1].toJSNumber(),P&&($=re-1-$),me=v(H,re),F=me[1].toJSNumber(),k&&(F=re-1-F),j=ie[0],H=me[0],Ae.push(I($,F));for(var ve=I(P?1:0,k?1:0)!==0?Ft(-1):Ft(0),De=Ae.length-1;De>=0;De-=1)ve=ve.multiply(re).add(Ft(Ae[De]));return ve}D.prototype.not=function(){return this.negate().prev()},G.prototype.not=Z.prototype.not=D.prototype.not,D.prototype.and=function(c){return pe(this,c,function(p,I){return p&I})},G.prototype.and=Z.prototype.and=D.prototype.and,D.prototype.or=function(c){return pe(this,c,function(p,I){return p|I})},G.prototype.or=Z.prototype.or=D.prototype.or,D.prototype.xor=function(c){return pe(this,c,function(p,I){return p^I})},G.prototype.xor=Z.prototype.xor=D.prototype.xor;var Ie=1<<30,Ce=(t&-t)*(t&-t)|Ie;function ge(c){var p=c.value,I=typeof p=="number"?p|Ie:typeof p=="bigint"?p|BigInt(Ie):p[0]+p[1]*t|Ce;return I&-I}function Le(c,p){if(p.compareTo(c)<=0){var I=Le(c,p.square(p)),P=I.p,k=I.e,j=P.multiply(p);return j.compareTo(c)<=0?{p:j,e:k*2+1}:{p:P,e:k*2}}return{p:Ft(1),e:0}}D.prototype.bitLength=function(){var c=this;return c.compareTo(Ft(0))<0&&(c=c.negate().subtract(Ft(1))),c.compareTo(Ft(0))===0?Ft(0):Ft(Le(c,Ft(2)).e).add(Ft(1))},G.prototype.bitLength=Z.prototype.bitLength=D.prototype.bitLength;function xe(c,p){return c=O(c),p=O(p),c.greater(p)?c:p}function He(c,p){return c=O(c),p=O(p),c.lesser(p)?c:p}function Ze(c,p){if(c=O(c).abs(),p=O(p).abs(),c.equals(p))return c;if(c.isZero())return p;if(p.isZero())return c;for(var I=C[1],P,k;c.isEven()&&p.isEven();)P=He(ge(c),ge(p)),c=c.divide(P),p=p.divide(P),I=I.multiply(P);for(;c.isEven();)c=c.divide(ge(c));do{for(;p.isEven();)p=p.divide(ge(p));c.greater(p)&&(k=p,p=c,c=k),p=p.subtract(c)}while(!p.isZero());return I.isUnit()?c:c.multiply(I)}function Ge(c,p){return c=O(c).abs(),p=O(p).abs(),c.divide(Ze(c,p)).multiply(p)}function ze(c,p,I){c=O(c),p=O(p);var P=I||Math.random,k=He(c,p),j=xe(c,p),H=j.subtract(k).add(1);if(H.isSmall)return k.add(Math.floor(P()*H));for(var $=z(H,t).value,F=[],ie=!0,me=0;me<$.length;me++){var Ae=ie?$[me]+(me+1<$.length?$[me+1]/t:0):t,ve=ce(P()*Ae);F.push(ve),ve<$[me]&&(ie=!1)}return k.add(C.fromArray(F,t,!1))}var Ye=function(c,p,I,P){I=I||y,c=String(c),P||(c=c.toLowerCase(),I=I.toLowerCase());var k=c.length,j,H=Math.abs(p),$={};for(j=0;j<I.length;j++)$[I[j]]=j;for(j=0;j<k;j++){var F=c[j];if(F!=="-"&&F in $&&$[F]>=H){if(F==="1"&&H===1)continue;throw new Error(F+" is not a valid digit in base "+p+".")}}p=O(p);var ie=[],me=c[0]==="-";for(j=me?1:0;j<c.length;j++){var F=c[j];if(F in $)ie.push(O($[F]));else if(F==="<"){var Ae=j;do j++;while(c[j]!==">"&&j<c.length);ie.push(O(c.slice(Ae+1,j)))}else throw new Error(F+" is not a valid character")}return J(ie,p,me)};function J(c,p,I){var P=C[0],k=C[1],j;for(j=c.length-1;j>=0;j--)P=P.add(c[j].times(k)),k=k.times(p);return I?P.negate():P}function ne(c,p){return p=p||y,c<p.length?p[c]:"<"+c+">"}function z(c,p){if(p=Ft(p),p.isZero()){if(c.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(p.equals(-1)){if(c.isZero())return{value:[0],isNegative:!1};if(c.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-c.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var I=Array.apply(null,Array(c.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return I.unshift([1]),{value:[].concat.apply([],I),isNegative:!1}}var P=!1;if(c.isNegative()&&p.isPositive()&&(P=!0,c=c.abs()),p.isUnit())return c.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(c.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:P};for(var k=[],j=c,H;j.isNegative()||j.compareAbs(p)>=0;){H=j.divmod(p),j=H.quotient;var $=H.remainder;$.isNegative()&&($=p.minus($).abs(),j=j.next()),k.push($.toJSNumber())}return k.push(j.toJSNumber()),{value:k.reverse(),isNegative:P}}function x(c,p,I){var P=z(c,p);return(P.isNegative?"-":"")+P.value.map(function(k){return ne(k,I)}).join("")}D.prototype.toArray=function(c){return z(this,c)},Z.prototype.toArray=function(c){return z(this,c)},G.prototype.toArray=function(c){return z(this,c)},D.prototype.toString=function(c,p){if(c===s&&(c=10),c!==10||p)return x(this,c,p);for(var I=this.value,P=I.length,k=String(I[--P]),j="0000000",H;--P>=0;)H=String(I[P]),k+=j.slice(H.length)+H;var $=this.sign?"-":"";return $+k},Z.prototype.toString=function(c,p){return c===s&&(c=10),c!=10||p?x(this,c,p):String(this.value)},G.prototype.toString=Z.prototype.toString,G.prototype.toJSON=D.prototype.toJSON=Z.prototype.toJSON=function(){return this.toString()},D.prototype.valueOf=function(){return parseInt(this.toString(),10)},D.prototype.toJSNumber=D.prototype.valueOf,Z.prototype.valueOf=function(){return this.value},Z.prototype.toJSNumber=Z.prototype.valueOf,G.prototype.valueOf=G.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Y(c){if(V(+c)){var p=+c;if(p===ce(p))return L?new G(BigInt(p)):new Z(p);throw new Error("Invalid integer: "+c)}var I=c[0]==="-";I&&(c=c.slice(1));var P=c.split(/e/i);if(P.length>2)throw new Error("Invalid integer: "+P.join("e"));if(P.length===2){var k=P[1];if(k[0]==="+"&&(k=k.slice(1)),k=+k,k!==ce(k)||!V(k))throw new Error("Invalid integer: "+k+" is not a valid exponent.");var j=P[0],H=j.indexOf(".");if(H>=0&&(k-=j.length-H-1,j=j.slice(0,H)+j.slice(H+1)),k<0)throw new Error("Cannot include negative exponent part for integers");j+=new Array(k+1).join("0"),c=j}var $=/^([0-9][0-9]*)$/.test(c);if(!$)throw new Error("Invalid integer: "+c);if(L)return new G(BigInt(I?"-"+c:c));for(var F=[],ie=c.length,me=e,Ae=ie-me;ie>0;)F.push(+c.slice(Ae,ie)),Ae-=me,Ae<0&&(Ae=0),ie-=me;return Me(F),new D(F,I)}function X(c){if(L)return new G(BigInt(c));if(V(c)){if(c!==ce(c))throw new Error(c+" is not an integer.");return new Z(c)}return Y(c.toString())}function O(c){return typeof c=="number"?X(c):typeof c=="string"?Y(c):typeof c=="bigint"?new G(c):c}for(var fe=0;fe<1e3;fe++)C[fe]=O(fe),fe>0&&(C[-fe]=O(-fe));return C.one=C[1],C.zero=C[0],C.minusOne=C[-1],C.max=xe,C.min=He,C.gcd=Ze,C.lcm=Ge,C.isInstance=function(c){return c instanceof D||c instanceof Z||c instanceof G},C.randBetween=ze,C.fromArray=function(c,p,I){return J(c.map(O),O(p||10),I)},C})();typeof H0<"u"&&H0.hasOwnProperty("exports")&&(H0.exports=Ft);typeof define=="function"&&define.amd&&define(function(){return Ft})});var Rn=f0((Tn,j0)=>{(function(s){"use strict";var t=9e15,e=1e9,o="0123456789abcdef",g="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",y="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",L={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-t,maxE:t,crypto:!1},C,D,Z,G,V=!0,de="[DecimalError] ",Ee=de+"Invalid argument: ",Me=de+"Precision limit exceeded",ae=de+"crypto unavailable",ce="[object Decimal]",ue=Math.floor,u=Math.pow,Ne=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Oe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Pe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,ye=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$e=1e7,he=7,Se=9007199254740991,be=g.length-1,se=y.length-1,i={toStringTag:ce};i.absoluteValue=i.abs=function(){var h=new this.constructor(this);return h.s<0&&(h.s=1),R(h)},i.ceil=function(){return R(new this.constructor(this),this.e+1,2)},i.clampedTo=i.clamp=function(h,N){var M,A=this,T=A.constructor;if(h=new T(h),N=new T(N),!h.s||!N.s)return new T(NaN);if(h.gt(N))throw Error(Ee+N);return M=A.cmp(h),M<0?h:A.cmp(N)>0?N:new T(A)},i.comparedTo=i.cmp=function(h){var N,M,A,T,n=this,r=n.d,l=(h=new n.constructor(h)).d,S=n.s,m=h.s;if(!r||!l)return!S||!m?NaN:S!==m?S:r===l?0:!r^S<0?1:-1;if(!r[0]||!l[0])return r[0]?S:l[0]?-m:0;if(S!==m)return S;if(n.e!==h.e)return n.e>h.e^S<0?1:-1;for(A=r.length,T=l.length,N=0,M=A<T?A:T;N<M;++N)if(r[N]!==l[N])return r[N]>l[N]^S<0?1:-1;return A===T?0:A>T^S<0?1:-1},i.cosine=i.cos=function(){var h,N,M=this,A=M.constructor;return M.d?M.d[0]?(h=A.precision,N=A.rounding,A.precision=h+Math.max(M.e,M.sd())+he,A.rounding=1,M=v(A,ne(A,M)),A.precision=h,A.rounding=N,R(G==2||G==3?M.neg():M,h,N,!0)):new A(1):new A(NaN)},i.cubeRoot=i.cbrt=function(){var h,N,M,A,T,n,r,l,S,m,q=this,E=q.constructor;if(!q.isFinite()||q.isZero())return new E(q);for(V=!1,n=q.s*u(q.s*q,1/3),!n||Math.abs(n)==1/0?(M=a(q.d),h=q.e,(n=(h-M.length+1)%3)&&(M+=n==1||n==-2?"0":"00"),n=u(M,1/3),h=ue((h+1)/3)-(h%3==(h<0?-1:2)),n==1/0?M="5e"+h:(M=n.toExponential(),M=M.slice(0,M.indexOf("e")+1)+h),A=new E(M),A.s=q.s):A=new E(n.toString()),r=(h=E.precision)+3;;)if(l=A,S=l.times(l).times(l),m=S.plus(q),A=b(m.plus(q).times(l),m.plus(S),r+2,1),a(l.d).slice(0,r)===(M=a(A.d)).slice(0,r))if(M=M.slice(r-3,r+1),M=="9999"||!T&&M=="4999"){if(!T&&(R(l,h+1,0),l.times(l).times(l).eq(q))){A=l;break}r+=4,T=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(R(A,h+1,1),N=!A.times(A).times(A).eq(q));break}return V=!0,R(A,h,E.rounding,N)},i.decimalPlaces=i.dp=function(){var h,N=this.d,M=NaN;if(N){if(h=N.length-1,M=(h-ue(this.e/he))*he,h=N[h],h)for(;h%10==0;h/=10)M--;M<0&&(M=0)}return M},i.dividedBy=i.div=function(h){return b(this,new this.constructor(h))},i.dividedToIntegerBy=i.divToInt=function(h){var N=this,M=N.constructor;return R(b(N,new M(h),0,1,1),M.precision,M.rounding)},i.equals=i.eq=function(h){return this.cmp(h)===0},i.floor=function(){return R(new this.constructor(this),this.e+1,3)},i.greaterThan=i.gt=function(h){return this.cmp(h)>0},i.greaterThanOrEqualTo=i.gte=function(h){var N=this.cmp(h);return N==1||N===0},i.hyperbolicCosine=i.cosh=function(){var h,N,M,A,T,n=this,r=n.constructor,l=new r(1);if(!n.isFinite())return new r(n.s?1/0:NaN);if(n.isZero())return l;M=r.precision,A=r.rounding,r.precision=M+Math.max(n.e,n.sd())+4,r.rounding=1,T=n.d.length,T<32?(h=Math.ceil(T/3),N=(1/J(4,h)).toString()):(h=16,N="2.3283064365386962890625e-10"),n=Ye(r,1,n.times(N),new r(1),!0);for(var S,m=h,q=new r(8);m--;)S=n.times(n),n=l.minus(S.times(q.minus(S.times(q))));return R(n,r.precision=M,r.rounding=A,!0)},i.hyperbolicSine=i.sinh=function(){var h,N,M,A,T=this,n=T.constructor;if(!T.isFinite()||T.isZero())return new n(T);if(N=n.precision,M=n.rounding,n.precision=N+Math.max(T.e,T.sd())+4,n.rounding=1,A=T.d.length,A<3)T=Ye(n,2,T,T,!0);else{h=1.4*Math.sqrt(A),h=h>16?16:h|0,T=T.times(1/J(5,h)),T=Ye(n,2,T,T,!0);for(var r,l=new n(5),S=new n(16),m=new n(20);h--;)r=T.times(T),T=T.times(l.plus(r.times(S.times(r).plus(m))))}return n.precision=N,n.rounding=M,R(T,N,M,!0)},i.hyperbolicTangent=i.tanh=function(){var h,N,M=this,A=M.constructor;return M.isFinite()?M.isZero()?new A(M):(h=A.precision,N=A.rounding,A.precision=h+7,A.rounding=1,b(M.sinh(),M.cosh(),A.precision=h,A.rounding=N)):new A(M.s)},i.inverseCosine=i.acos=function(){var h=this,N=h.constructor,M=h.abs().cmp(1),A=N.precision,T=N.rounding;return M!==-1?M===0?h.isNeg()?re(N,A,T):new N(0):new N(NaN):h.isZero()?re(N,A+4,T).times(.5):(N.precision=A+6,N.rounding=1,h=new N(1).minus(h).div(h.plus(1)).sqrt().atan(),N.precision=A,N.rounding=T,h.times(2))},i.inverseHyperbolicCosine=i.acosh=function(){var h,N,M=this,A=M.constructor;return M.lte(1)?new A(M.eq(1)?0:NaN):M.isFinite()?(h=A.precision,N=A.rounding,A.precision=h+Math.max(Math.abs(M.e),M.sd())+4,A.rounding=1,V=!1,M=M.times(M).minus(1).sqrt().plus(M),V=!0,A.precision=h,A.rounding=N,M.ln()):new A(M)},i.inverseHyperbolicSine=i.asinh=function(){var h,N,M=this,A=M.constructor;return!M.isFinite()||M.isZero()?new A(M):(h=A.precision,N=A.rounding,A.precision=h+2*Math.max(Math.abs(M.e),M.sd())+6,A.rounding=1,V=!1,M=M.times(M).plus(1).sqrt().plus(M),V=!0,A.precision=h,A.rounding=N,M.ln())},i.inverseHyperbolicTangent=i.atanh=function(){var h,N,M,A,T=this,n=T.constructor;return T.isFinite()?T.e>=0?new n(T.abs().eq(1)?T.s/0:T.isZero()?T:NaN):(h=n.precision,N=n.rounding,A=T.sd(),Math.max(A,h)<2*-T.e-1?R(new n(T),h,N,!0):(n.precision=M=A-T.e,T=b(T.plus(1),new n(1).minus(T),M+h,1),n.precision=h+4,n.rounding=1,T=T.ln(),n.precision=h,n.rounding=N,T.times(.5))):new n(NaN)},i.inverseSine=i.asin=function(){var h,N,M,A,T=this,n=T.constructor;return T.isZero()?new n(T):(N=T.abs().cmp(1),M=n.precision,A=n.rounding,N!==-1?N===0?(h=re(n,M+4,A).times(.5),h.s=T.s,h):new n(NaN):(n.precision=M+6,n.rounding=1,T=T.div(new n(1).minus(T.times(T)).sqrt().plus(1)).atan(),n.precision=M,n.rounding=A,T.times(2)))},i.inverseTangent=i.atan=function(){var h,N,M,A,T,n,r,l,S,m=this,q=m.constructor,E=q.precision,_=q.rounding;if(m.isFinite()){if(m.isZero())return new q(m);if(m.abs().eq(1)&&E+4<=se)return r=re(q,E+4,_).times(.25),r.s=m.s,r}else{if(!m.s)return new q(NaN);if(E+4<=se)return r=re(q,E+4,_).times(.5),r.s=m.s,r}for(q.precision=l=E+10,q.rounding=1,M=Math.min(28,l/he+2|0),h=M;h;--h)m=m.div(m.times(m).plus(1).sqrt().plus(1));for(V=!1,N=Math.ceil(l/he),A=1,S=m.times(m),r=new q(m),T=m;h!==-1;)if(T=T.times(S),n=r.minus(T.div(A+=2)),T=T.times(S),r=n.plus(T.div(A+=2)),r.d[N]!==void 0)for(h=N;r.d[h]===n.d[h]&&h--;);return M&&(r=r.times(2<<M-1)),V=!0,R(r,q.precision=E,q.rounding=_,!0)},i.isFinite=function(){return!!this.d},i.isInteger=i.isInt=function(){return!!this.d&&ue(this.e/he)>this.d.length-2},i.isNaN=function(){return!this.s},i.isNegative=i.isNeg=function(){return this.s<0},i.isPositive=i.isPos=function(){return this.s>0},i.isZero=function(){return!!this.d&&this.d[0]===0},i.lessThan=i.lt=function(h){return this.cmp(h)<0},i.lessThanOrEqualTo=i.lte=function(h){return this.cmp(h)<1},i.logarithm=i.log=function(h){var N,M,A,T,n,r,l,S,m=this,q=m.constructor,E=q.precision,_=q.rounding,W=5;if(h==null)h=new q(10),N=!0;else{if(h=new q(h),M=h.d,h.s<0||!M||!M[0]||h.eq(1))return new q(NaN);N=h.eq(10)}if(M=m.d,m.s<0||!M||!M[0]||m.eq(1))return new q(M&&!M[0]?-1/0:m.s!=1?NaN:M?0:1/0);if(N)if(M.length>1)n=!0;else{for(T=M[0];T%10===0;)T/=10;n=T!==1}if(V=!1,l=E+W,r=xe(m,l),A=N?te(q,l+10):xe(h,l),S=b(r,A,l,1),w(S.d,T=E,_))do if(l+=10,r=xe(m,l),A=N?te(q,l+10):xe(h,l),S=b(r,A,l,1),!n){+a(S.d).slice(T+1,T+15)+1==1e14&&(S=R(S,E+1,0));break}while(w(S.d,T+=10,_));return V=!0,R(S,E,_)},i.minus=i.sub=function(h){var N,M,A,T,n,r,l,S,m,q,E,_,W=this,ee=W.constructor;if(h=new ee(h),!W.d||!h.d)return!W.s||!h.s?h=new ee(NaN):W.d?h.s=-h.s:h=new ee(h.d||W.s!==h.s?W:NaN),h;if(W.s!=h.s)return h.s=-h.s,W.plus(h);if(m=W.d,_=h.d,l=ee.precision,S=ee.rounding,!m[0]||!_[0]){if(_[0])h.s=-h.s;else if(m[0])h=new ee(W);else return new ee(S===3?-0:0);return V?R(h,l,S):h}if(M=ue(h.e/he),q=ue(W.e/he),m=m.slice(),n=q-M,n){for(E=n<0,E?(N=m,n=-n,r=_.length):(N=_,M=q,r=m.length),A=Math.max(Math.ceil(l/he),r)+2,n>A&&(n=A,N.length=1),N.reverse(),A=n;A--;)N.push(0);N.reverse()}else{for(A=m.length,r=_.length,E=A<r,E&&(r=A),A=0;A<r;A++)if(m[A]!=_[A]){E=m[A]<_[A];break}n=0}for(E&&(N=m,m=_,_=N,h.s=-h.s),r=m.length,A=_.length-r;A>0;--A)m[r++]=0;for(A=_.length;A>n;){if(m[--A]<_[A]){for(T=A;T&&m[--T]===0;)m[T]=$e-1;--m[T],m[A]+=$e}m[A]-=_[A]}for(;m[--r]===0;)m.pop();for(;m[0]===0;m.shift())--M;return m[0]?(h.d=m,h.e=B(m,M),V?R(h,l,S):h):new ee(S===3?-0:0)},i.modulo=i.mod=function(h){var N,M=this,A=M.constructor;return h=new A(h),!M.d||!h.s||h.d&&!h.d[0]?new A(NaN):!h.d||M.d&&!M.d[0]?R(new A(M),A.precision,A.rounding):(V=!1,A.modulo==9?(N=b(M,h.abs(),0,3,1),N.s*=h.s):N=b(M,h,0,A.modulo,1),N=N.times(h),V=!0,M.minus(N))},i.naturalExponential=i.exp=function(){return Le(this)},i.naturalLogarithm=i.ln=function(){return xe(this)},i.negated=i.neg=function(){var h=new this.constructor(this);return h.s=-h.s,R(h)},i.plus=i.add=function(h){var N,M,A,T,n,r,l,S,m,q,E=this,_=E.constructor;if(h=new _(h),!E.d||!h.d)return!E.s||!h.s?h=new _(NaN):E.d||(h=new _(h.d||E.s===h.s?E:NaN)),h;if(E.s!=h.s)return h.s=-h.s,E.minus(h);if(m=E.d,q=h.d,l=_.precision,S=_.rounding,!m[0]||!q[0])return q[0]||(h=new _(E)),V?R(h,l,S):h;if(n=ue(E.e/he),A=ue(h.e/he),m=m.slice(),T=n-A,T){for(T<0?(M=m,T=-T,r=q.length):(M=q,A=n,r=m.length),n=Math.ceil(l/he),r=n>r?n+1:r+1,T>r&&(T=r,M.length=1),M.reverse();T--;)M.push(0);M.reverse()}for(r=m.length,T=q.length,r-T<0&&(T=r,M=q,q=m,m=M),N=0;T;)N=(m[--T]=m[T]+q[T]+N)/$e|0,m[T]%=$e;for(N&&(m.unshift(N),++A),r=m.length;m[--r]==0;)m.pop();return h.d=m,h.e=B(m,A),V?R(h,l,S):h},i.precision=i.sd=function(h){var N,M=this;if(h!==void 0&&h!==!!h&&h!==1&&h!==0)throw Error(Ee+h);return M.d?(N=we(M.d),h&&M.e+1>N&&(N=M.e+1)):N=NaN,N},i.round=function(){var h=this,N=h.constructor;return R(new N(h),h.e+1,N.rounding)},i.sine=i.sin=function(){var h,N,M=this,A=M.constructor;return M.isFinite()?M.isZero()?new A(M):(h=A.precision,N=A.rounding,A.precision=h+Math.max(M.e,M.sd())+he,A.rounding=1,M=ze(A,ne(A,M)),A.precision=h,A.rounding=N,R(G>2?M.neg():M,h,N,!0)):new A(NaN)},i.squareRoot=i.sqrt=function(){var h,N,M,A,T,n,r=this,l=r.d,S=r.e,m=r.s,q=r.constructor;if(m!==1||!l||!l[0])return new q(!m||m<0&&(!l||l[0])?NaN:l?r:1/0);for(V=!1,m=Math.sqrt(+r),m==0||m==1/0?(N=a(l),(N.length+S)%2==0&&(N+="0"),m=Math.sqrt(N),S=ue((S+1)/2)-(S<0||S%2),m==1/0?N="5e"+S:(N=m.toExponential(),N=N.slice(0,N.indexOf("e")+1)+S),A=new q(N)):A=new q(m.toString()),M=(S=q.precision)+3;;)if(n=A,A=n.plus(b(r,n,M+2,1)).times(.5),a(n.d).slice(0,M)===(N=a(A.d)).slice(0,M))if(N=N.slice(M-3,M+1),N=="9999"||!T&&N=="4999"){if(!T&&(R(n,S+1,0),n.times(n).eq(r))){A=n;break}M+=4,T=1}else{(!+N||!+N.slice(1)&&N.charAt(0)=="5")&&(R(A,S+1,1),h=!A.times(A).eq(r));break}return V=!0,R(A,S,q.rounding,h)},i.tangent=i.tan=function(){var h,N,M=this,A=M.constructor;return M.isFinite()?M.isZero()?new A(M):(h=A.precision,N=A.rounding,A.precision=h+10,A.rounding=1,M=M.sin(),M.s=1,M=b(M,new A(1).minus(M.times(M)).sqrt(),h+10,0),A.precision=h,A.rounding=N,R(G==2||G==4?M.neg():M,h,N,!0)):new A(NaN)},i.times=i.mul=function(h){var N,M,A,T,n,r,l,S,m,q=this,E=q.constructor,_=q.d,W=(h=new E(h)).d;if(h.s*=q.s,!_||!_[0]||!W||!W[0])return new E(!h.s||_&&!_[0]&&!W||W&&!W[0]&&!_?NaN:!_||!W?h.s/0:h.s*0);for(M=ue(q.e/he)+ue(h.e/he),S=_.length,m=W.length,S<m&&(n=_,_=W,W=n,r=S,S=m,m=r),n=[],r=S+m,A=r;A--;)n.push(0);for(A=m;--A>=0;){for(N=0,T=S+A;T>A;)l=n[T]+W[A]*_[T-A-1]+N,n[T--]=l%$e|0,N=l/$e|0;n[T]=(n[T]+N)%$e|0}for(;!n[--r];)n.pop();return N?++M:n.shift(),h.d=n,h.e=B(n,M),V?R(h,E.precision,E.rounding):h},i.toBinary=function(h,N){return z(this,2,h,N)},i.toDecimalPlaces=i.toDP=function(h,N){var M=this,A=M.constructor;return M=new A(M),h===void 0?M:(f(h,0,e),N===void 0?N=A.rounding:f(N,0,8),R(M,h+M.e+1,N))},i.toExponential=function(h,N){var M,A=this,T=A.constructor;return h===void 0?M=U(A,!0):(f(h,0,e),N===void 0?N=T.rounding:f(N,0,8),A=R(new T(A),h+1,N),M=U(A,!0,h+1)),A.isNeg()&&!A.isZero()?"-"+M:M},i.toFixed=function(h,N){var M,A,T=this,n=T.constructor;return h===void 0?M=U(T):(f(h,0,e),N===void 0?N=n.rounding:f(N,0,8),A=R(new n(T),h+T.e+1,N),M=U(A,!1,h+A.e+1)),T.isNeg()&&!T.isZero()?"-"+M:M},i.toFraction=function(h){var N,M,A,T,n,r,l,S,m,q,E,_,W=this,ee=W.d,oe=W.constructor;if(!ee)return new oe(W);if(m=M=new oe(1),A=S=new oe(0),N=new oe(A),n=N.e=we(ee)-W.e-1,r=n%he,N.d[0]=u(10,r<0?he+r:r),h==null)h=n>0?N:m;else{if(l=new oe(h),!l.isInt()||l.lt(m))throw Error(Ee+l);h=l.gt(N)?n>0?N:m:l}for(V=!1,l=new oe(a(ee)),q=oe.precision,oe.precision=n=ee.length*he*2;E=b(l,N,0,1,1),T=M.plus(E.times(A)),T.cmp(h)!=1;)M=A,A=T,T=m,m=S.plus(E.times(T)),S=T,T=N,N=l.minus(E.times(T)),l=T;return T=b(h.minus(M),A,0,1,1),S=S.plus(T.times(m)),M=M.plus(T.times(A)),S.s=m.s=W.s,_=b(m,A,n,1).minus(W).abs().cmp(b(S,M,n,1).minus(W).abs())<1?[m,A]:[S,M],oe.precision=q,V=!0,_},i.toHexadecimal=i.toHex=function(h,N){return z(this,16,h,N)},i.toNearest=function(h,N){var M=this,A=M.constructor;if(M=new A(M),h==null){if(!M.d)return M;h=new A(1),N=A.rounding}else{if(h=new A(h),N===void 0?N=A.rounding:f(N,0,8),!M.d)return h.s?M:h;if(!h.d)return h.s&&(h.s=M.s),h}return h.d[0]?(V=!1,M=b(M,h,0,N,1).times(h),V=!0,R(M)):(h.s=M.s,M=h),M},i.toNumber=function(){return+this},i.toOctal=function(h,N){return z(this,8,h,N)},i.toPower=i.pow=function(h){var N,M,A,T,n,r,l=this,S=l.constructor,m=+(h=new S(h));if(!l.d||!h.d||!l.d[0]||!h.d[0])return new S(u(+l,m));if(l=new S(l),l.eq(1))return l;if(A=S.precision,n=S.rounding,h.eq(1))return R(l,A,n);if(N=ue(h.e/he),N>=h.d.length-1&&(M=m<0?-m:m)<=Se)return T=Ie(S,l,M,A),h.s<0?new S(1).div(T):R(T,A,n);if(r=l.s,r<0){if(N<h.d.length-1)return new S(NaN);if((h.d[N]&1)==0&&(r=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=r,l}return M=u(+l,m),N=M==0||!isFinite(M)?ue(m*(Math.log("0."+a(l.d))/Math.LN10+l.e+1)):new S(M+"").e,N>S.maxE+1||N<S.minE-1?new S(N>0?r/0:0):(V=!1,S.rounding=l.s=1,M=Math.min(12,(N+"").length),T=Le(h.times(xe(l,A+M)),A),T.d&&(T=R(T,A+5,1),w(T.d,A,n)&&(N=A+10,T=R(Le(h.times(xe(l,N+M)),N),N+5,1),+a(T.d).slice(A+1,A+15)+1==1e14&&(T=R(T,A+1,0)))),T.s=r,V=!0,S.rounding=n,R(T,A,n))},i.toPrecision=function(h,N){var M,A=this,T=A.constructor;return h===void 0?M=U(A,A.e<=T.toExpNeg||A.e>=T.toExpPos):(f(h,1,e),N===void 0?N=T.rounding:f(N,0,8),A=R(new T(A),h,N),M=U(A,h<=A.e||A.e<=T.toExpNeg,h)),A.isNeg()&&!A.isZero()?"-"+M:M},i.toSignificantDigits=i.toSD=function(h,N){var M=this,A=M.constructor;return h===void 0?(h=A.precision,N=A.rounding):(f(h,1,e),N===void 0?N=A.rounding:f(N,0,8)),R(new A(M),h,N)},i.toString=function(){var h=this,N=h.constructor,M=U(h,h.e<=N.toExpNeg||h.e>=N.toExpPos);return h.isNeg()&&!h.isZero()?"-"+M:M},i.truncated=i.trunc=function(){return R(new this.constructor(this),this.e+1,1)},i.valueOf=i.toJSON=function(){var h=this,N=h.constructor,M=U(h,h.e<=N.toExpNeg||h.e>=N.toExpPos);return h.isNeg()?"-"+M:M};function a(h){var N,M,A,T=h.length-1,n="",r=h[0];if(T>0){for(n+=r,N=1;N<T;N++)A=h[N]+"",M=he-A.length,M&&(n+=pe(M)),n+=A;r=h[N],A=r+"",M=he-A.length,M&&(n+=pe(M))}else if(r===0)return"0";for(;r%10===0;)r/=10;return n+r}function f(h,N,M){if(h!==~~h||h<N||h>M)throw Error(Ee+h)}function w(h,N,M,A){var T,n,r,l;for(n=h[0];n>=10;n/=10)--N;return--N<0?(N+=he,T=0):(T=Math.ceil((N+1)/he),N%=he),n=u(10,he-N),l=h[T]%n|0,A==null?N<3?(N==0?l=l/100|0:N==1&&(l=l/10|0),r=M<4&&l==99999||M>3&&l==49999||l==5e4||l==0):r=(M<4&&l+1==n||M>3&&l+1==n/2)&&(h[T+1]/n/100|0)==u(10,N-2)-1||(l==n/2||l==0)&&(h[T+1]/n/100|0)==0:N<4?(N==0?l=l/1e3|0:N==1?l=l/100|0:N==2&&(l=l/10|0),r=(A||M<4)&&l==9999||!A&&M>3&&l==4999):r=((A||M<4)&&l+1==n||!A&&M>3&&l+1==n/2)&&(h[T+1]/n/1e3|0)==u(10,N-3)-1,r}function d(h,N,M){for(var A,T=[0],n,r=0,l=h.length;r<l;){for(n=T.length;n--;)T[n]*=N;for(T[0]+=o.indexOf(h.charAt(r++)),A=0;A<T.length;A++)T[A]>M-1&&(T[A+1]===void 0&&(T[A+1]=0),T[A+1]+=T[A]/M|0,T[A]%=M)}return T.reverse()}function v(h,N){var M,A,T;if(N.isZero())return N;A=N.d.length,A<32?(M=Math.ceil(A/3),T=(1/J(4,M)).toString()):(M=16,T="2.3283064365386962890625e-10"),h.precision+=M,N=Ye(h,1,N.times(T),new h(1));for(var n=M;n--;){var r=N.times(N);N=r.times(r).minus(r).times(8).plus(1)}return h.precision-=M,N}var b=(function(){function h(A,T,n){var r,l=0,S=A.length;for(A=A.slice();S--;)r=A[S]*T+l,A[S]=r%n|0,l=r/n|0;return l&&A.unshift(l),A}function N(A,T,n,r){var l,S;if(n!=r)S=n>r?1:-1;else for(l=S=0;l<n;l++)if(A[l]!=T[l]){S=A[l]>T[l]?1:-1;break}return S}function M(A,T,n,r){for(var l=0;n--;)A[n]-=l,l=A[n]<T[n]?1:0,A[n]=l*r+A[n]-T[n];for(;!A[0]&&A.length>1;)A.shift()}return function(A,T,n,r,l,S){var m,q,E,_,W,ee,oe,Te,Ue,_e,Ve,st,At,je,Re,et,Xe,Je,lt,ht,ct=A.constructor,tt=A.s==T.s?1:-1,nt=A.d,it=T.d;if(!nt||!nt[0]||!it||!it[0])return new ct(!A.s||!T.s||(nt?it&&nt[0]==it[0]:!it)?NaN:nt&&nt[0]==0||!it?tt*0:tt/0);for(S?(W=1,q=A.e-T.e):(S=$e,W=he,q=ue(A.e/W)-ue(T.e/W)),lt=it.length,Xe=nt.length,Ue=new ct(tt),_e=Ue.d=[],E=0;it[E]==(nt[E]||0);E++);if(it[E]>(nt[E]||0)&&q--,n==null?(je=n=ct.precision,r=ct.rounding):l?je=n+(A.e-T.e)+1:je=n,je<0)_e.push(1),ee=!0;else{if(je=je/W+2|0,E=0,lt==1){for(_=0,it=it[0],je++;(E<Xe||_)&&je--;E++)Re=_*S+(nt[E]||0),_e[E]=Re/it|0,_=Re%it|0;ee=_||E<Xe}else{for(_=S/(it[0]+1)|0,_>1&&(it=h(it,_,S),nt=h(nt,_,S),lt=it.length,Xe=nt.length),et=lt,Ve=nt.slice(0,lt),st=Ve.length;st<lt;)Ve[st++]=0;ht=it.slice(),ht.unshift(0),Je=it[0],it[1]>=S/2&&++Je;do _=0,m=N(it,Ve,lt,st),m<0?(At=Ve[0],lt!=st&&(At=At*S+(Ve[1]||0)),_=At/Je|0,_>1?(_>=S&&(_=S-1),oe=h(it,_,S),Te=oe.length,st=Ve.length,m=N(oe,Ve,Te,st),m==1&&(_--,M(oe,lt<Te?ht:it,Te,S))):(_==0&&(m=_=1),oe=it.slice()),Te=oe.length,Te<st&&oe.unshift(0),M(Ve,oe,st,S),m==-1&&(st=Ve.length,m=N(it,Ve,lt,st),m<1&&(_++,M(Ve,lt<st?ht:it,st,S))),st=Ve.length):m===0&&(_++,Ve=[0]),_e[E++]=_,m&&Ve[0]?Ve[st++]=nt[et]||0:(Ve=[nt[et]],st=1);while((et++<Xe||Ve[0]!==void 0)&&je--);ee=Ve[0]!==void 0}_e[0]||_e.shift()}if(W==1)Ue.e=q,D=ee;else{for(E=1,_=_e[0];_>=10;_/=10)E++;Ue.e=E+q*W-1,R(Ue,l?n+Ue.e+1:n,r,ee)}return Ue}})();function R(h,N,M,A){var T,n,r,l,S,m,q,E,_,W=h.constructor;e:if(N!=null){if(E=h.d,!E)return h;for(T=1,l=E[0];l>=10;l/=10)T++;if(n=N-T,n<0)n+=he,r=N,q=E[_=0],S=q/u(10,T-r-1)%10|0;else if(_=Math.ceil((n+1)/he),l=E.length,_>=l)if(A){for(;l++<=_;)E.push(0);q=S=0,T=1,n%=he,r=n-he+1}else break e;else{for(q=l=E[_],T=1;l>=10;l/=10)T++;n%=he,r=n-he+T,S=r<0?0:q/u(10,T-r-1)%10|0}if(A=A||N<0||E[_+1]!==void 0||(r<0?q:q%u(10,T-r-1)),m=M<4?(S||A)&&(M==0||M==(h.s<0?3:2)):S>5||S==5&&(M==4||A||M==6&&(n>0?r>0?q/u(10,T-r):0:E[_-1])%10&1||M==(h.s<0?8:7)),N<1||!E[0])return E.length=0,m?(N-=h.e+1,E[0]=u(10,(he-N%he)%he),h.e=-N||0):E[0]=h.e=0,h;if(n==0?(E.length=_,l=1,_--):(E.length=_+1,l=u(10,he-n),E[_]=r>0?(q/u(10,T-r)%u(10,r)|0)*l:0),m)for(;;)if(_==0){for(n=1,r=E[0];r>=10;r/=10)n++;for(r=E[0]+=l,l=1;r>=10;r/=10)l++;n!=l&&(h.e++,E[0]==$e&&(E[0]=1));break}else{if(E[_]+=l,E[_]!=$e)break;E[_--]=0,l=1}for(n=E.length;E[--n]===0;)E.pop()}return V&&(h.e>W.maxE?(h.d=null,h.e=NaN):h.e<W.minE&&(h.e=0,h.d=[0])),h}function U(h,N,M){if(!h.isFinite())return He(h);var A,T=h.e,n=a(h.d),r=n.length;return N?(M&&(A=M-r)>0?n=n.charAt(0)+"."+n.slice(1)+pe(A):r>1&&(n=n.charAt(0)+"."+n.slice(1)),n=n+(h.e<0?"e":"e+")+h.e):T<0?(n="0."+pe(-T-1)+n,M&&(A=M-r)>0&&(n+=pe(A))):T>=r?(n+=pe(T+1-r),M&&(A=M-T-1)>0&&(n=n+"."+pe(A))):((A=T+1)<r&&(n=n.slice(0,A)+"."+n.slice(A)),M&&(A=M-r)>0&&(T+1===r&&(n+="."),n+=pe(A))),n}function B(h,N){var M=h[0];for(N*=he;M>=10;M/=10)N++;return N}function te(h,N,M){if(N>be)throw V=!0,M&&(h.precision=M),Error(Me);return R(new h(g),N,1,!0)}function re(h,N,M){if(N>se)throw Error(Me);return R(new h(y),N,M,!0)}function we(h){var N=h.length-1,M=N*he+1;if(N=h[N],N){for(;N%10==0;N/=10)M--;for(N=h[0];N>=10;N/=10)M++}return M}function pe(h){for(var N="";h--;)N+="0";return N}function Ie(h,N,M,A){var T,n=new h(1),r=Math.ceil(A/he+4);for(V=!1;;){if(M%2&&(n=n.times(N),x(n.d,r)&&(T=!0)),M=ue(M/2),M===0){M=n.d.length-1,T&&n.d[M]===0&&++n.d[M];break}N=N.times(N),x(N.d,r)}return V=!0,n}function Ce(h){return h.d[h.d.length-1]&1}function ge(h,N,M){for(var A,T,n=new h(N[0]),r=0;++r<N.length;){if(T=new h(N[r]),!T.s){n=T;break}A=n.cmp(T),(A===M||A===0&&n.s===M)&&(n=T)}return n}function Le(h,N){var M,A,T,n,r,l,S,m=0,q=0,E=0,_=h.constructor,W=_.rounding,ee=_.precision;if(!h.d||!h.d[0]||h.e>17)return new _(h.d?h.d[0]?h.s<0?0:1/0:1:h.s?h.s<0?0:h:NaN);for(N==null?(V=!1,S=ee):S=N,l=new _(.03125);h.e>-2;)h=h.times(l),E+=5;for(A=Math.log(u(2,E))/Math.LN10*2+5|0,S+=A,M=n=r=new _(1),_.precision=S;;){if(n=R(n.times(h),S,1),M=M.times(++q),l=r.plus(b(n,M,S,1)),a(l.d).slice(0,S)===a(r.d).slice(0,S)){for(T=E;T--;)r=R(r.times(r),S,1);if(N==null)if(m<3&&w(r.d,S-A,W,m))_.precision=S+=10,M=n=l=new _(1),q=0,m++;else return R(r,_.precision=ee,W,V=!0);else return _.precision=ee,r}r=l}}function xe(h,N){var M,A,T,n,r,l,S,m,q,E,_,W=1,ee=10,oe=h,Te=oe.d,Ue=oe.constructor,_e=Ue.rounding,Ve=Ue.precision;if(oe.s<0||!Te||!Te[0]||!oe.e&&Te[0]==1&&Te.length==1)return new Ue(Te&&!Te[0]?-1/0:oe.s!=1?NaN:Te?0:oe);if(N==null?(V=!1,q=Ve):q=N,Ue.precision=q+=ee,M=a(Te),A=M.charAt(0),Math.abs(n=oe.e)<15e14){for(;A<7&&A!=1||A==1&&M.charAt(1)>3;)oe=oe.times(h),M=a(oe.d),A=M.charAt(0),W++;n=oe.e,A>1?(oe=new Ue("0."+M),n++):oe=new Ue(A+"."+M.slice(1))}else return m=te(Ue,q+2,Ve).times(n+""),oe=xe(new Ue(A+"."+M.slice(1)),q-ee).plus(m),Ue.precision=Ve,N==null?R(oe,Ve,_e,V=!0):oe;for(E=oe,S=r=oe=b(oe.minus(1),oe.plus(1),q,1),_=R(oe.times(oe),q,1),T=3;;){if(r=R(r.times(_),q,1),m=S.plus(b(r,new Ue(T),q,1)),a(m.d).slice(0,q)===a(S.d).slice(0,q))if(S=S.times(2),n!==0&&(S=S.plus(te(Ue,q+2,Ve).times(n+""))),S=b(S,new Ue(W),q,1),N==null)if(w(S.d,q-ee,_e,l))Ue.precision=q+=ee,m=r=oe=b(E.minus(1),E.plus(1),q,1),_=R(oe.times(oe),q,1),T=l=1;else return R(S,Ue.precision=Ve,_e,V=!0);else return Ue.precision=Ve,S;S=m,T+=2}}function He(h){return String(h.s*h.s/0)}function Ze(h,N){var M,A,T;for((M=N.indexOf("."))>-1&&(N=N.replace(".","")),(A=N.search(/e/i))>0?(M<0&&(M=A),M+=+N.slice(A+1),N=N.substring(0,A)):M<0&&(M=N.length),A=0;N.charCodeAt(A)===48;A++);for(T=N.length;N.charCodeAt(T-1)===48;--T);if(N=N.slice(A,T),N){if(T-=A,h.e=M=M-A-1,h.d=[],A=(M+1)%he,M<0&&(A+=he),A<T){for(A&&h.d.push(+N.slice(0,A)),T-=he;A<T;)h.d.push(+N.slice(A,A+=he));N=N.slice(A),A=he-N.length}else A-=T;for(;A--;)N+="0";h.d.push(+N),V&&(h.e>h.constructor.maxE?(h.d=null,h.e=NaN):h.e<h.constructor.minE&&(h.e=0,h.d=[0]))}else h.e=0,h.d=[0];return h}function Ge(h,N){var M,A,T,n,r,l,S,m,q;if(N.indexOf("_")>-1){if(N=N.replace(/(\d)_(?=\d)/g,"$1"),ye.test(N))return Ze(h,N)}else if(N==="Infinity"||N==="NaN")return+N||(h.s=NaN),h.e=NaN,h.d=null,h;if(Oe.test(N))M=16,N=N.toLowerCase();else if(Ne.test(N))M=2;else if(Pe.test(N))M=8;else throw Error(Ee+N);for(n=N.search(/p/i),n>0?(S=+N.slice(n+1),N=N.substring(2,n)):N=N.slice(2),n=N.indexOf("."),r=n>=0,A=h.constructor,r&&(N=N.replace(".",""),l=N.length,n=l-n,T=Ie(A,new A(M),n,n*2)),m=d(N,M,$e),q=m.length-1,n=q;m[n]===0;--n)m.pop();return n<0?new A(h.s*0):(h.e=B(m,q),h.d=m,V=!1,r&&(h=b(h,T,l*4)),S&&(h=h.times(Math.abs(S)<54?u(2,S):C.pow(2,S))),V=!0,h)}function ze(h,N){var M,A=N.d.length;if(A<3)return N.isZero()?N:Ye(h,2,N,N);M=1.4*Math.sqrt(A),M=M>16?16:M|0,N=N.times(1/J(5,M)),N=Ye(h,2,N,N);for(var T,n=new h(5),r=new h(16),l=new h(20);M--;)T=N.times(N),N=N.times(n.plus(T.times(r.times(T).minus(l))));return N}function Ye(h,N,M,A,T){var n,r,l,S,m=1,q=h.precision,E=Math.ceil(q/he);for(V=!1,S=M.times(M),l=new h(A);;){if(r=b(l.times(S),new h(N++*N++),q,1),l=T?A.plus(r):A.minus(r),A=b(r.times(S),new h(N++*N++),q,1),r=l.plus(A),r.d[E]!==void 0){for(n=E;r.d[n]===l.d[n]&&n--;);if(n==-1)break}n=l,l=A,A=r,r=n,m++}return V=!0,r.d.length=E+1,r}function J(h,N){for(var M=h;--N;)M*=h;return M}function ne(h,N){var M,A=N.s<0,T=re(h,h.precision,1),n=T.times(.5);if(N=N.abs(),N.lte(n))return G=A?4:1,N;if(M=N.divToInt(T),M.isZero())G=A?3:2;else{if(N=N.minus(M.times(T)),N.lte(n))return G=Ce(M)?A?2:3:A?4:1,N;G=Ce(M)?A?1:4:A?3:2}return N.minus(T).abs()}function z(h,N,M,A){var T,n,r,l,S,m,q,E,_,W=h.constructor,ee=M!==void 0;if(ee?(f(M,1,e),A===void 0?A=W.rounding:f(A,0,8)):(M=W.precision,A=W.rounding),!h.isFinite())q=He(h);else{for(q=U(h),r=q.indexOf("."),ee?(T=2,N==16?M=M*4-3:N==8&&(M=M*3-2)):T=N,r>=0&&(q=q.replace(".",""),_=new W(1),_.e=q.length-r,_.d=d(U(_),10,T),_.e=_.d.length),E=d(q,10,T),n=S=E.length;E[--S]==0;)E.pop();if(!E[0])q=ee?"0p+0":"0";else{if(r<0?n--:(h=new W(h),h.d=E,h.e=n,h=b(h,_,M,A,0,T),E=h.d,n=h.e,m=D),r=E[M],l=T/2,m=m||E[M+1]!==void 0,m=A<4?(r!==void 0||m)&&(A===0||A===(h.s<0?3:2)):r>l||r===l&&(A===4||m||A===6&&E[M-1]&1||A===(h.s<0?8:7)),E.length=M,m)for(;++E[--M]>T-1;)E[M]=0,M||(++n,E.unshift(1));for(S=E.length;!E[S-1];--S);for(r=0,q="";r<S;r++)q+=o.charAt(E[r]);if(ee){if(S>1)if(N==16||N==8){for(r=N==16?4:3,--S;S%r;S++)q+="0";for(E=d(q,T,N),S=E.length;!E[S-1];--S);for(r=1,q="1.";r<S;r++)q+=o.charAt(E[r])}else q=q.charAt(0)+"."+q.slice(1);q=q+(n<0?"p":"p+")+n}else if(n<0){for(;++n;)q="0"+q;q="0."+q}else if(++n>S)for(n-=S;n--;)q+="0";else n<S&&(q=q.slice(0,n)+"."+q.slice(n))}q=(N==16?"0x":N==2?"0b":N==8?"0o":"")+q}return h.s<0?"-"+q:q}function x(h,N){if(h.length>N)return h.length=N,!0}function Y(h){return new this(h).abs()}function X(h){return new this(h).acos()}function O(h){return new this(h).acosh()}function fe(h,N){return new this(h).plus(N)}function c(h){return new this(h).asin()}function p(h){return new this(h).asinh()}function I(h){return new this(h).atan()}function P(h){return new this(h).atanh()}function k(h,N){h=new this(h),N=new this(N);var M,A=this.precision,T=this.rounding,n=A+4;return!h.s||!N.s?M=new this(NaN):!h.d&&!N.d?(M=re(this,n,1).times(N.s>0?.25:.75),M.s=h.s):!N.d||h.isZero()?(M=N.s<0?re(this,A,T):new this(0),M.s=h.s):!h.d||N.isZero()?(M=re(this,n,1).times(.5),M.s=h.s):N.s<0?(this.precision=n,this.rounding=1,M=this.atan(b(h,N,n,1)),N=re(this,n,1),this.precision=A,this.rounding=T,M=h.s<0?M.minus(N):M.plus(N)):M=this.atan(b(h,N,n,1)),M}function j(h){return new this(h).cbrt()}function H(h){return R(h=new this(h),h.e+1,2)}function $(h,N,M){return new this(h).clamp(N,M)}function F(h){if(!h||typeof h!="object")throw Error(de+"Object expected");var N,M,A,T=h.defaults===!0,n=["precision",1,e,"rounding",0,8,"toExpNeg",-t,0,"toExpPos",0,t,"maxE",0,t,"minE",-t,0,"modulo",0,9];for(N=0;N<n.length;N+=3)if(M=n[N],T&&(this[M]=L[M]),(A=h[M])!==void 0)if(ue(A)===A&&A>=n[N+1]&&A<=n[N+2])this[M]=A;else throw Error(Ee+M+": "+A);if(M="crypto",T&&(this[M]=L[M]),(A=h[M])!==void 0)if(A===!0||A===!1||A===0||A===1)if(A)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[M]=!0;else throw Error(ae);else this[M]=!1;else throw Error(Ee+M+": "+A);return this}function ie(h){return new this(h).cos()}function me(h){return new this(h).cosh()}function Ae(h){var N,M,A;function T(n){var r,l,S,m=this;if(!(m instanceof T))return new T(n);if(m.constructor=T,Qe(n)){m.s=n.s,V?!n.d||n.e>T.maxE?(m.e=NaN,m.d=null):n.e<T.minE?(m.e=0,m.d=[0]):(m.e=n.e,m.d=n.d.slice()):(m.e=n.e,m.d=n.d?n.d.slice():n.d);return}if(S=typeof n,S==="number"){if(n===0){m.s=1/n<0?-1:1,m.e=0,m.d=[0];return}if(n<0?(n=-n,m.s=-1):m.s=1,n===~~n&&n<1e7){for(r=0,l=n;l>=10;l/=10)r++;V?r>T.maxE?(m.e=NaN,m.d=null):r<T.minE?(m.e=0,m.d=[0]):(m.e=r,m.d=[n]):(m.e=r,m.d=[n]);return}if(n*0!==0){n||(m.s=NaN),m.e=NaN,m.d=null;return}return Ze(m,n.toString())}if(S==="string")return(l=n.charCodeAt(0))===45?(n=n.slice(1),m.s=-1):(l===43&&(n=n.slice(1)),m.s=1),ye.test(n)?Ze(m,n):Ge(m,n);if(S==="bigint")return n<0?(n=-n,m.s=-1):m.s=1,Ze(m,n.toString());throw Error(Ee+n)}if(T.prototype=i,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=F,T.clone=Ae,T.isDecimal=Qe,T.abs=Y,T.acos=X,T.acosh=O,T.add=fe,T.asin=c,T.asinh=p,T.atan=I,T.atanh=P,T.atan2=k,T.cbrt=j,T.ceil=H,T.clamp=$,T.cos=ie,T.cosh=me,T.div=ve,T.exp=De,T.floor=Fe,T.hypot=We,T.ln=ke,T.log=rt,T.log10=at,T.log2=Ke,T.max=Et,T.min=It,T.mod=bt,T.mul=Ot,T.pow=Qt,T.random=vt,T.round=$t,T.sign=qt,T.sin=Tt,T.sinh=Bt,T.sqrt=Jt,T.sub=c0,T.sum=Yt,T.tan=r0,T.tanh=Kt,T.trunc=v0,h===void 0&&(h={}),h&&h.defaults!==!0)for(A=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],N=0;N<A.length;)h.hasOwnProperty(M=A[N++])||(h[M]=this[M]);return T.config(h),T}function ve(h,N){return new this(h).div(N)}function De(h){return new this(h).exp()}function Fe(h){return R(h=new this(h),h.e+1,3)}function We(){var h,N,M=new this(0);for(V=!1,h=0;h<arguments.length;)if(N=new this(arguments[h++]),N.d)M.d&&(M=M.plus(N.times(N)));else{if(N.s)return V=!0,new this(1/0);M=N}return V=!0,M.sqrt()}function Qe(h){return h instanceof C||h&&h.toStringTag===ce||!1}function ke(h){return new this(h).ln()}function rt(h,N){return new this(h).log(N)}function Ke(h){return new this(h).log(2)}function at(h){return new this(h).log(10)}function Et(){return ge(this,arguments,-1)}function It(){return ge(this,arguments,1)}function bt(h,N){return new this(h).mod(N)}function Ot(h,N){return new this(h).mul(N)}function Qt(h,N){return new this(h).pow(N)}function vt(h){var N,M,A,T,n=0,r=new this(1),l=[];if(h===void 0?h=this.precision:f(h,1,e),A=Math.ceil(h/he),this.crypto)if(crypto.getRandomValues)for(N=crypto.getRandomValues(new Uint32Array(A));n<A;)T=N[n],T>=429e7?N[n]=crypto.getRandomValues(new Uint32Array(1))[0]:l[n++]=T%1e7;else if(crypto.randomBytes){for(N=crypto.randomBytes(A*=4);n<A;)T=N[n]+(N[n+1]<<8)+(N[n+2]<<16)+((N[n+3]&127)<<24),T>=214e7?crypto.randomBytes(4).copy(N,n):(l.push(T%1e7),n+=4);n=A/4}else throw Error(ae);else for(;n<A;)l[n++]=Math.random()*1e7|0;for(A=l[--n],h%=he,A&&h&&(T=u(10,he-h),l[n]=(A/T|0)*T);l[n]===0;n--)l.pop();if(n<0)M=0,l=[0];else{for(M=-1;l[0]===0;M-=he)l.shift();for(A=1,T=l[0];T>=10;T/=10)A++;A<he&&(M-=he-A)}return r.e=M,r.d=l,r}function $t(h){return R(h=new this(h),h.e+1,this.rounding)}function qt(h){return h=new this(h),h.d?h.d[0]?h.s:0*h.s:h.s||NaN}function Tt(h){return new this(h).sin()}function Bt(h){return new this(h).sinh()}function Jt(h){return new this(h).sqrt()}function c0(h,N){return new this(h).sub(N)}function Yt(){var h=0,N=arguments,M=new this(N[h]);for(V=!1;M.s&&++h<N.length;)M=M.plus(N[h]);return V=!0,R(M,this.precision,this.rounding)}function r0(h){return new this(h).tan()}function Kt(h){return new this(h).tanh()}function v0(h){return R(h=new this(h),h.e+1,1)}C=Ae(L),C.prototype.constructor=C,C.default=C.Decimal=C,g=new C(g),y=new C(y),typeof define=="function"&&define.amd?define(function(){return C}):typeof j0<"u"&&j0.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(i[Symbol.for("nodejs.util.inspect.custom")]=i.toString,i[Symbol.toStringTag]="Decimal"),j0.exports=C):(s||(s=typeof self<"u"&&self&&self.self==self?self:window),Z=s.Decimal,C.noConflict=function(){return s.Decimal=Z,C},s.Decimal=C)})(Tn)});var Pn=f0((Wi,ln)=>{"use strict";var Ln=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],Un={};for(let s of Ln)Un[s]=!0;var g1="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",m1="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",d1=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof ln<"u"&&(ln.exports={PRIMES:Ln,PRIMES_SET:Un,LONG_PI:g1,LONG_E:m1,BIG_LOG_CACHE:d1})});var T0=f0((Qi,vn)=>{"use strict";var Nn=typeof globalThis.nerdamerBigInt>"u"?qn():globalThis.nerdamerBigInt,rn=typeof globalThis.nerdamerBigDecimal>"u"?Rn():globalThis.nerdamerBigDecimal;rn.set({precision:250});var P0=typeof globalThis.nerdamerConstants>"u"?Pn():globalThis.nerdamerConstants,w1={},S1=[],v1={},N1=[],y1=[],E1=[],sn={Settings:null,Math2:null},K={ext:{bigInt:Nn,bigDec:rn,PRIMES:P0.PRIMES,PRIMES_SET:P0.PRIMES_SET,LONG_PI:P0.LONG_PI,LONG_E:P0.LONG_E,BIG_LOG_CACHE:P0.BIG_LOG_CACHE},groups:{N:1,P:2,S:3,EX:4,FN:5,PL:6,CB:7,CP:8},fnNames:{SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",PARENTHESIS:"parens",LOG:"log",CONST_HASH:"#"},get settings(){return sn.Settings},state:{get EXPRESSIONS(){return S1},get VARS(){return v1},CONSTANTS:{},get RESERVED(){return N1},get WARNINGS(){return y1},get USER_FUNCTIONS(){return E1},get CUSTOM_OPERATORS(){return w1}},classes:{Frac:null,Fraction:null,NerdamerSymbol:null,Vector:null,Matrix:null,Expression:null,Collection:null,NerdamerSet:null,Scientific:null,Parser:null,LaTeX:null,Math2:null,Build:null},utils:{get isSymbol(){return ft},get isVector(){return dt},get isMatrix(){return mt},get isExpression(){return r1},get isNumericSymbol(){return q0},get isFraction(){return bn},get isArray(){return Dt},get isInt(){return pt},get text(){return Vt},get variables(){return n0},get scientificToDecimal(){return F0},get err(){return xt},get block(){return kt},get evaluate(){return wt},get reserveNames(){return k0},get nround(){return m0},get remove(){return d0},get _setFunction(){return On},get _clearFunctions(){return $i},symfunction:null,callfunction:null},exceptions:null,parser:null,core:null,libExports:null,version:"1.1.16"},M1={N:K.groups.N,P:K.groups.P,S:K.groups.S,EX:K.groups.EX,FN:K.groups.FN,PL:K.groups.PL,CB:K.groups.CB,CP:K.groups.CP};Math.sign||=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1};Math.cosh||=function(t){let e=Math.exp(t);return(e+1/e)/2};Math.sech||=function(t){return 1/Math.cosh(t)};Math.csch||=function(t){return 1/Math.sinh(t)};Math.coth||=function(t){return 1/Math.tanh(t)};Math.sinh||=function(t){let e=Math.exp(t);return(e-1/e)/2};Math.tanh||=function(t){if(t===1/0)return 1;if(t===-1/0)return-1;let e=Math.exp(2*t);return(e-1)/(e+1)};Math.asinh||=function(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))};Math.acosh||=function(t){return Math.log(t+Math.sqrt(t*t-1))};Math.atanh||=function(t){return Math.log((1+t)/(1-t))/2};Math.trunc||=function(t){return isNaN(t)?NaN:t>0?Math.floor(t):Math.ceil(t)};function Vn(s){return/\d+\.?\d*e[+-]*\d+/iu.test(s)}var Xn={convert(s,t){let e=Number(s),o;if(e===0)o=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let g=this.quickConversion(e);if(g[1]<=1e16){let y=Math.abs(e),L=e/y;o=this.fullConversion(y.toFixed(`${g[1]}`.length-1)),o[0]*=L}else o=g}else o=this.fullConversion(e);return o},quickConversion(s){let t=function(o){typeof o!="string"&&(o=o.toString());let g="",y=o.charAt(0);return y==="-"?(o=o.substr(1,o.length),g="-"):y==="+"&&(o=o.substr(1,o.length)),{sign:g,value:o}};function e(o){Vn(o)&&(o=F0(o));let g=t(o),y=g.value.split("."),L;y.length===1?L=y[0]:L=y[0]+y[1];let C=y[1]?y[1].length:0,D=`1${"0".repeat(C)}`;return L!=="0"&&(L=L.replace(/^0+/u,"")),[g.sign+L,D]}return e(s)},fullConversion(s){let t=Number(s),e=Math.abs(t)>1e10?1e-16:1e-30,o=!1,g=0,y=1,L=1,C=0,D=0,Z=t,G,V,de=1e-14;for(;!o;){D++;let Ee;if(Math.abs(Z)>1e10){let ae=Math.round(Z);Ee=Math.abs(Z-ae)/Math.abs(ae)<de?ae:Math.floor(Z)}else Ee=Math.floor(Z);G=g+Ee*L,V=y+Ee*C;let Me=Z-Ee;Me<e&&(o=!0),Z=1/Me,g=L,y=C,L=G,C=V,(Math.abs(G/V-t)<e||D>30)&&(o=!0)}return[G,V]}};K.classes.Fraction=Xn;function Ht(s){let t=function(e){this.name=s,this.message=e===void 0?"":e;let o=new Error(this.message);o.name=this.name,this.stack=o.stack};return t.prototype=Object.create(Error.prototype),t}var yn=Ht("DivisionByZero"),Gn=Ht("ParseError"),Gt=Ht("UndefinedError"),hn=Ht("OutOfFunctionDomainError"),A1=Ht("MaximumIterationsReached"),En=Ht("NerdamerTypeError"),W0=Ht("ParityError"),b0=Ht("OperatorError"),C1=Ht("OutOfRangeError"),gn=Ht("DimensionError"),Hn=Ht("InvalidVariableNameError"),I1=Ht("ValueLimitExceededError"),jn=Ht("NerdamerValueError"),_1=Ht("SolveError"),b1=Ht("InfiniteLoopError"),Zn=Ht("UnexpectedTokenError");K.exceptions={DivisionByZero:yn,ParseError:Gn,OutOfFunctionDomainError:hn,UndefinedError:Gt,MaximumIterationsReached:A1,NerdamerTypeError:En,ParityError:W0,OperatorError:b0,OutOfRangeError:C1,DimensionError:gn,InvalidVariableNameError:Hn,ValueLimitExceededError:I1,NerdamerValueError:jn,SolveError:_1,InfiniteLoopError:b1,UnexpectedTokenError:Zn};var Rt={get bigInt(){return K.ext.bigInt},get bigDec(){return K.ext.bigDec},get isInt(){return K.utils.isInt},get scientificToDecimal(){return K.utils.scientificToDecimal},get DivisionByZero(){return yn},get Settings(){return K.settings},get Fraction(){return Xn}},Be=class s{num;den;constructor(t){if(t instanceof s)return t;if(t===void 0)return this;try{if(Rt.isInt(t))try{this.num=Rt.bigInt(t),this.den=Rt.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return s.simple(t)}else{let e=t instanceof Rt.bigDec?Rt.Fraction.quickConversion(t):Rt.Fraction.convert(t);this.num=new Rt.bigInt(e[0]),this.den=new Rt.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return s.simple(t)}}static create(t){if(t instanceof s)return t;t=t.toString();let e=t.charAt(0)==="-";e&&(t=t.substr(1,t.length-1));let o=new s(t);return e&&o.negate(),o}static isFrac(t){return t instanceof s}static quick(t,e){let o=new s;return o.num=new Rt.bigInt(t),o.den=new Rt.bigInt(e),o}static simple(t){let o=String(Rt.scientificToDecimal(t)).split("."),g=o.join(""),y="1",L=(o[1]||"").length;for(let D=0;D<L;D++)y+="0";return s.quick(g,y).simplify()}multiply(t){if(this.isOne())return t.clone();if(t.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(t.num),e.den=e.den.multiply(t.den),e.simplify()}divide(t){if(t.equals(0))throw new Rt.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(t.clone().invert()).simplify()}subtract(t){return this.clone().add(t.clone().neg())}sub(t){return this.subtract(t)}neg(){return this.num=this.num.multiply(-1),this}add(t){let e=this.den,o=t.den,g=this.clone(),y=g.num,L=t.num;return e.equals(o)?g.num=y.add(L):(g.num=y.multiply(o).add(L.multiply(e)),g.den=e.multiply(o)),g.simplify()}mod(t){let e=this.clone(),o=t.clone();return e.num=e.num.multiply(o.den),e.den=e.den.multiply(o.den),o.num=o.num.multiply(this.den),o.den=o.den.multiply(this.den),e.num=e.num.mod(o.num),e.simplify()}simplify(){let t=Rt.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(t),this.den=this.den.divide(t),this}clone(){let t=new s;return t.num=new Rt.bigInt(this.num),t.den=new Rt.bigInt(this.den),t}decimal(t){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";t||=Rt.Settings.PRECISION,t+=2;let o=[],g=this.num.abs(),y=this.den,L;for(L=0;L<t;L++){let Z=g.divide(y),G=g.subtract(Z.multiply(y));if(o.push(Z),G.equals(0))break;g=G.times(10)}let C=o.shift();if(o.length===0)return e+C.toString();if(L===t){let Z=[];for(let G=0;G<2;G++)Z.unshift(o.pop());o.push(Math.round(Number(Z.join("."))))}let D=`${C.toString()}.${o.join("")}`;return e+D}toDecimal(t){return t||=Rt.Settings.PRECISION,t?this.decimal(t):this.num.valueOf()/this.den.valueOf()}qcompare(t){return[this.num.multiply(t.den),t.num.multiply(this.den)]}equals(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].equals(e[1])}absEquals(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].abs().equals(e[1])}greaterThan(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].gt(e[1])}gt(t){return this.greaterThan(t)}gte(t){return this.greaterThan(t)||this.equals(t)}lte(t){return this.lessThan(t)||this.equals(t)}lessThan(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].lt(e[1])}lt(t){return this.lessThan(t)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let t=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=t,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(t){return s.quick(Rt.bigInt.gcd(t.num,this.num),Rt.bigInt.lcm(t.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Rt.Settings.USE_BIG?new Rt.bigDec(this.num.toString()).div(new Rt.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(t){let e=typeof t=="number"?new s(t):t;return this.mod(e).equals(0)}};K.classes.Frac=Be;var an={get isVector(){return K.utils.isVector},get Vector(){return K.classes.Vector},get remove(){return d0}},g0=class s{elements=[];constructor(t,...e){if(typeof t>"u")return;let o=t;if(an.isVector(t)||(o=an.Vector.fromArray([t,...e])),o){let{elements:g}=o;for(let y=0,L=g.length;y<L;y++)this.add(g[y])}}static fromArray(t){let e=new s;for(let o of t)e.add(o);return e}add(t){this.contains(t)||this.elements.push(t.clone())}contains(t){for(let e=0;e<this.elements.length;e++){let o=this.elements[e];if(t.equals(o))return!0}return!1}each(t){let{elements:e}=this,o=new s;for(let g=0,y=e.length;g<y;g++){let L=e[g];t.call(this,L,o,g)}return o}clone(){let t=new s;return this.each(e=>{t.add(e.clone())}),t}union(t){let e=this.clone();return t.each(o=>{e.add(o)}),e}difference(t){let e=this.clone();return t.each(o=>{e.remove(o)}),e}remove(t){for(let e=0,o=this.elements.length;e<o;e++)if(this.elements[e].equals(t))return an.remove(this.elements,e),!0;return!1}intersection(t){let e=new s,o=this;return t.each(g=>{o.contains(g)&&e.add(g)}),e}intersects(t){return this.intersection(t).elements.length>0}isSubset(t){let{elements:e}=t;for(let o=0,g=e.length;o<g;o++)if(!this.contains(e[o]))return!1;return!0}toString(){return`{${this.elements.join(",")}}`}};K.classes.NerdamerSet=g0;var N0={get _(){return K.parser},get block(){return K.utils.block}},t0=class s{elements=[];constructor(t){t&&this.elements.push(t)}static create(t){return new s(t)}append(t){this.elements.push(t)}getItems(){return this.elements}toString(){return N0._.prettyPrint(this.elements)}dimensions(){return this.elements.length}text(t){return`(${this.elements.map(e=>e.text(t)).join(",")})`}clone(){let t=s.create();return t.elements=this.elements.map(e=>e.clone()),t}expand(t){return this.elements=this.elements.map(e=>N0._.expand(e,t)),this}evaluate(t){return this.elements=this.elements.map(e=>N0._.evaluate(e,t)),this}map(t){let e=this.clone();return e.elements=e.elements.map((o,g)=>t(o,g+1)),e}add(t){return N0.block("SAFE",()=>{let e=t.elements;return this.elements.length!==e.length?null:this.map((o,g)=>N0._.add(o,e[g-1]))},void 0,this)}subtract(t){return N0.block("SAFE",()=>{let e=t.elements;return this.elements.length!==e.length?null:this.map((o,g)=>N0._.subtract(o,e[g-1]))},void 0,this)}};K.classes.Collection=t0;var xn={get Settings(){return K.settings},get nround(){return K.utils.nround}},D0=class s{sign;coeff;exponent;wholes;dec;decp;constructor(t){t=String(typeof t>"u"?0:t),t.startsWith("-")?(this.sign=-1,t=t.substr(1,t.length)):this.sign=1,s.isScientific(t)?this.fromScientific(t):this.convert(t)}static isScientific(t){return Vn(t)}static leadingZeroes(t){let e=t.match(/^(?<zeros>0*).*$/u);return e?e[1]:""}static removeLeadingZeroes(t){let e=t.match(/^0*(?<rest>.*)$/u);return e?e[1]:""}static removeTrailingZeroes(t){let e=t.match(/0*$/u);return e?t.substring(0,t.length-e[0].length):""}static round(t,e){let o=String(xn.nround(t,e)),g=o.includes(".")?o.split(".").pop():"",y=e-g.length;return y>0&&(o.includes(".")||(o+="."),o+=new Array(y+1).join("0")),o}fromScientific(t){let e=String(t).toLowerCase().split("e");this.coeff=e[0],this.exponent=Number(e[1]);let o=this.coeff.split(".");this.wholes=o[0]||"",this.dec=o[1]||"";let{dec:g}=this;return this.decp=g==="0"?0:g.length,this}convert(t){let e=t.split("."),o=e[0]||"",g=e[1]||"";o=s.removeLeadingZeroes(o),g=s.removeTrailingZeroes(g);let y=o.length,L=o+g,C=s.leadingZeroes(L).length;this.exponent=y-(C+1);let D=s.removeLeadingZeroes(L);this.coeff=`${D.charAt(0)}.${s.removeTrailingZeroes(D.substr(1,D.length))||"0"}`;let Z=this.coeff.split(".")[1]||"";return this.decp=Z==="0"?0:Z.length,this.dec=g,this.wholes=o,this}round(t){let e=this.copy();if(t=Number(t),t===0)e.coeff=e.coeff.charAt(0);else{let o=this.coeff.substring(0,t+1),g=this.coeff.substring(t+1,t+3),y=Number(g.charAt(0));Number(g.charAt(1))>4&&y++,e.coeff=o+y}return e}copy(){let t=new s(0);return t.coeff=this.coeff,t.exponent=this.exponent,t.sign=this.sign,t}toString(t){let e;if(xn.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<t)this.decp===0&&this.wholes!==void 0?e=this.wholes:e=this.coeff;else{let o=typeof t>"u"?this.coeff:s.round(this.coeff,Math.min(t,this.decp||1)),g=this.exponent;o.startsWith("10.")&&(o=typeof t>"u"?o.replace(/^10\./u,"1.0"):s.round(o.replace(/^10\./u,"1.0"),Math.min(t,this.decp||1)),g=Number(g)+1),e=this.exponent===0?o:`${o}e${g}`}return(this.sign===-1?"-":"")+e}};K.classes.Scientific=D0;function Dt(s){return Array.isArray(s)}function yt(s){return`(${s})`}function O1(s,t){return s<0==t<0}function _t(...s){return s.shift().replace(/\{(?<idx>\d+)\}/gu,(o,g)=>{let y=s[g];return typeof y=="function"?y():y})}function q1(s,t,e){let o=[];e||=1;for(let g=s;g<=t;g++)o.push(g*e);return o}function T1(s){return s?String(s):""}function R1(s,t,e,o){return s.substr(0,t)+o+s.substr(e,s.length)}function L1(s){return s!==void 0&&s.custom}function U1(s){return Math.max.apply(void 0,s)}function Mn(s){return Math.min.apply(void 0,s)}function Ut(s){return Number(s)%2===0}function mn(s){return 1/(s%1)%2===0}function An(s){let t=s.length,e=[];for(let o=0;o<t;o++){let g=s[o];e.indexOf(g)===-1&&e.push(g)}return e}function P1(s){return[].slice.call(s)}function pt(s){return typeof s=="number"?Number.isInteger(s):typeof s<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(s.toString())}function x1(s,t){if(s.sort(),t.sort(),s.length===t.length){for(let e=0;e<s.length;e++)if(s[e]!==t[e])return!1;return!0}return!1}function $1(s){let t=[],e=s.length;for(let o=0;o<e;o++)t[o]=s[o].clone();return t}function zn(s){return/^\d+\.?\d*$/u.test(String(s))}function m0(s,t=14){return pt(s)?Number(s)>=Number.MAX_VALUE?s.toString():Number(s):Math.round(s*10**t)/10**t}function D1(s,t){t||=20;let e=[],o,g,y;e.push(s[0]);for(let L=0;L<s.length-1;L++){o=s[L],g=s[L+1]-o,y=g/t;for(let C=0;C<t;C++)o+=y,e.push(o)}return e}function Wn(s,t){if(Dt(s)){let e=s.length;for(let o=0;o<e;o++)t.call(s,o)}else for(let e in s)Object.hasOwn(s,e)&&t.call(s,e)}function d0(s,t){let e;return Dt(s)?e=s.splice(t,1)[0]:(e=s[t],delete s[t]),e}function F1(s,t){let e={};return e[s]=t,e}function k1(s){for(let t=0;t<s.length;t++)if(!zn(s[t]))return!1;return!0}function F0(s){let t=Math.sign(s),e=Math.abs(s);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let g=String(e).toLowerCase().split("e"),y=g.pop(),L=Math.abs(Number(y)),C=Math.sign(Number(y)),D=g[0].split(".");if(C===-1)L-=D[0].length,L<0?e=`${D[0].slice(0,L)}.${D[0].slice(L)}${D.length===2?D[1]:""}`:e=`0.${new Array(L+1).join("0")}${D.join("")}`;else{let Z=D[1];Z&&(L-=Z.length),L<0?e=`${D[0]+Z.slice(0,L)}.${Z.slice(L)}`:e=D.join("")+new Array(L+1).join("0")}}return t<0?`-${e}`:String(e)}function Q0(s){let t=s[0];for(let e=1,o=s.length;e<o;e++)if(!s[e].equals(t))return!1;return!0}function B1(s,t){typeof t!=="function"&&(t=function(g,y){return g===y});let o=[];for(;s.length;){let g=s[0];if(s.length===1){o.push(g);break}let y=[];o.push(g);for(let L=1;L<s.length;L++){let C=s[L];t(g,C)||y.push(C)}s=y}return o}function V1(s,t){let e=s.length,o=[];for(let L=0;L<s.length;L++)o.push([s[L],t[L]]);o.sort((L,C)=>Number(L[0])-Number(C[0]));let g=[],y=[];for(let L=0;L<e;L++)g.push(o[L][0]),y.push(o[L][1]);return[g,y]}function dn(s){return s instanceof t0}function Cn(s){return s instanceof g0}function J0(s,t,e){let g=Object.keys(s)[0];return t?g:e?{key:g,obj:s[g]}:s[g]}var{keys:In}=Object,Y0={get N(){return K.groups.N},get P(){return K.groups.P},get S(){return K.groups.S},get EX(){return K.groups.EX},get FN(){return K.groups.FN},get PL(){return K.groups.PL},get CB(){return K.groups.CB},get CP(){return K.groups.CP}},Mt={get _(){return K.parser},get N(){return K.groups.N},get P(){return K.groups.P},get S(){return K.groups.S},get EX(){return K.groups.EX},get FN(){return K.groups.FN},get PL(){return K.groups.PL},get CB(){return K.groups.CB},get CP(){return K.groups.CP},get SQRT(){return K.fnNames.SQRT},get ABS(){return K.fnNames.ABS},get FACTORIAL(){return K.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return K.fnNames.DOUBLEFACTORIAL},get PARENTHESIS(){return K.fnNames.PARENTHESIS},get bigDec(){return K.ext.bigDec},get PRIMES(){return K.ext.PRIMES},get VARS(){return K.state.VARS}};function q0(s){return s.group===Y0.N||s.group===Y0.P}function Qn(s){return s.group===Y0.S&&s.multiplier.equals(1)&&s.power.equals(1)}function un(s){for(let t=0;t<s.length;t++)if(s[t].group!==Y0.N)return!1;return!0}var i0={get RESERVED(){return K.state.RESERVED}};function k0(s){let t=function(e){i0.RESERVED.indexOf(e)===-1&&i0.RESERVED.push(e)};typeof s=="string"?t(s):Wn(s,e=>{t(e)})}function X1(s){let t=i0.RESERVED.indexOf(s);t!==-1&&(i0.RESERVED[t]=void 0)}var $n={get ALLOW_CHARS(){return K.settings?.ALLOW_CHARS??[]},VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function w0(s,t="variable"){if($n.ALLOW_CHARS.indexOf(s)!==-1)return;if(!$n.VALIDATION_REGEX.test(s))throw new Hn(`${s} is not a valid ${t} name`)}function K0(s){return i0.RESERVED.indexOf(s)!==-1}var wn={get WARNINGS(){return K.state.WARNINGS},get SHOW_WARNINGS(){return!(K.settings?.SILENCE_WARNINGS??!0)}};function _n(s){wn.WARNINGS.push(s),wn.SHOW_WARNINGS&&console&&console.warn&&console.warn(s)}function G1(){return wn.WARNINGS}var H1={get EXPRESSIONS(){return K.state.EXPRESSIONS}};function j1(){return H1.EXPRESSIONS.length}var Z1={get Settings(){return K.settings}};function z1(s){return Z1.Settings[s]}function W1(s){try{return w0(s),i0.RESERVED.indexOf(s)===-1}catch(t){if(t.message==="timeout")throw t;return!1}}function Q1(s){return s?i0.RESERVED:i0.RESERVED.join(", ")}var Jn={get _version(){return K.version},get C(){return K.core}};function J1(s){if(s)try{return Jn.C[s].version}catch(t){if(t.message==="timeout")throw t;return`No module named ${s} found!`}return K.version}function Y1(){return Jn.C}var K1={get functions(){return K.parser?.functions}};function ei(){return In(K1.functions)}var ti={get CONSTANTS(){return K.parser?.CONSTANTS}};function ni(s){return String(ti.CONSTANTS[s])}var O0={get VARS(){return K.state.VARS}};function ii(s){return O0.VARS[s]}function ri(s,t){s||="text";let e={};if(s==="object")e=O0.VARS;else for(let o in O0.VARS)Object.hasOwn(O0.VARS,o)&&(s==="latex"?e[o]=O0.VARS[o].latex(t):s==="text"&&(e[o]=O0.VARS[o].text(t)));return e}var jt={get _(){return K.parser},get C(){return K.core}};function si(s,t){return jt._.toTeX(s,t)}function oi(s){return jt._.getOperator(s)}function li(s,t){jt._.aliasOperator(s,t)}function ai(s,t,e){jt._.setOperator(s,t,e)}function ui(s,t){jt._.peekers[s]&&jt._.peekers[s].push(t)}function ci(s,t){let e=jt._.peekers[s];if(e){let o=e.indexOf(t);o!==-1&&d0(e,o)}}function Yn(s){let t=jt._.toRPN(jt._.tokenize(s));return jt._.tree(t)}function fi(s){return String(s).split(";").map(t=>jt._.parse(t))}function pi(s){return jt._.toRPN(jt._.tokenize(s))}function hi(s,t){return`<div class="tree">
    <ul>
        <li>
${Yn(s).toHTML(3,t)}
        </li>
    </ul>
</div>`}function gi(s,t,e){let o=jt._.functions[s],g=typeof e>"u"?o[1]:e;jt._.functions[s]=[t(o[0],jt.C),g]}var Wt={get EXPRESSIONS(){return K.state.EXPRESSIONS},get USER_FUNCTIONS(){return K.state.USER_FUNCTIONS},get LaTeX(){return K.classes.LaTeX},get text(){return K.utils.text},get functions(){return K.parser?.functions??{}},get Math2(){return K.classes.Math2},get _(){return K.parser},get Expression(){return K.classes.Expression}};function mi(s,t,e){let o=s?{}:[];for(let g=0;g<Wt.EXPRESSIONS.length;g++){let y=t?Wt.LaTeX.latex(Wt.EXPRESSIONS[g],e):Wt.text(Wt.EXPRESSIONS[g],e);s?o[g+1]=y:o.push(y)}return o}function di(s,t){let e=s?{}:[];for(let o=0;o<Wt.USER_FUNCTIONS.length;o++){let g,y,L=Wt.USER_FUNCTIONS[o],C=Wt.functions[L][2];if(C)({params:g,body:y}=C);else{let G=Wt.Math2[L].toString();[,g]=/\((?<params>.*?)\)/u.exec(G),g=g.split(",").map(V=>V.trim()),y="{JavaScript}"}let D=`${L}(${g.join(", ")})=${y}`,Z=Wt.text(D,t);s?e[o+1]=Z:e.push(Z)}return e}function wi(s){s=s.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),s=s.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),s=s.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),s=s.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let t=Wt.LaTeX.parse(Wt._.tokenize(s));return new Wt.Expression(Wt._.parse(t))}var l0={get libExports(){return K.libExports},get VARS(){return K.state.VARS},get _clearFunctions(){return K.utils._clearFunctions},get _initConstants(){return K.parser?.initConstants??(()=>{})},get clear(){return Kn}};function Si(){for(let s in l0.VARS)Object.hasOwn(l0.VARS,s)&&delete l0.VARS[s];return l0.libExports}function vi(){return l0._clearFunctions(),l0.libExports}function Ni(){return l0.libExports}function yi(){return l0.clear("all"),l0.libExports}function Ei(s){return s.call(l0.libExports),l0.libExports}var cn={get libExports(){return K.libExports},get CONSTANTS(){return K.state.CONSTANTS}};function Mi(s,t){if(w0(s),!K0(s))if(t==="delete"||t==="")delete cn.CONSTANTS[s];else{if(isNaN(t))throw new En("Constant must be a number!");cn.CONSTANTS[s]=t}return cn.libExports}var I0={get libExports(){return K.libExports},get VARS(){return K.state.VARS},get CONSTANTS(){return K.state.CONSTANTS},get parse(){let{parser:s}=K;return s?.parse?.bind(s)??(()=>null)},get isSymbol(){return K.utils.isSymbol}};function Ai(s,t){return w0(s),s in I0.CONSTANTS&&xt(`Cannot set value for constant ${s}`),t==="delete"||t===""?delete I0.VARS[s]:I0.VARS[s]=I0.isSymbol(t)?t:I0.parse(t),I0.libExports}var Dn={get libExports(){return K.libExports},get _setFunction(){return K.utils._setFunction}};function Ci(s,t,e){if(!Dn._setFunction(s,t,e))throw new Error("Failed to set function!");return Dn.libExports}var y0={get libExports(){return K.libExports},get EXPRESSIONS(){return K.state.EXPRESSIONS}};function Kn(s,t=!1){if(s==="all")y0.EXPRESSIONS.length=0;else if(s==="last")y0.EXPRESSIONS.pop();else if(s==="first")y0.EXPRESSIONS.shift();else{let e=s?s-1:y0.EXPRESSIONS.length;t===!0?y0.EXPRESSIONS[e]=void 0:d0(y0.EXPRESSIONS,e)}return y0.libExports}var Z0={get libExports(){return K.libExports},get Settings(){return K.settings},get functions(){return K.parser?.functions??{}}};function e1(s){let t=Z0.libExports.getCore();if(Dt(s))for(let e=0;e<s.length;e++)s&&e1(s[e]);else if(s&&Z0.Settings.exclude.indexOf(s.name)===-1){if(s.dependencies){for(let g=0;g<s.dependencies.length;g++)if(!t[s.dependencies[g]])throw new Error(_t("{0} requires {1} to be loaded!",s.name,s.dependencies[g]))}let e=s.parent,o=s.build.call(t);if(e){t[e]||(t[s.parent]={});let g=e==="nerdamer"?Z0.libExports:t[e];g[s.name]=o}s.visible&&(Z0.functions[s.name]=[o,s.numargs])}}var zt={get bigDec(){return K.ext.bigDec},get Settings(){return K.settings},get functions(){return K.parser?.functions??{}},get symfunction(){return K.utils.symfunction},get NerdamerSymbol(){return K.classes.NerdamerSymbol}};function Sn(s,t){if(typeof s=="object"&&s!==null){let o=s;for(let g in o)Object.hasOwn(o,g)&&Sn(g,o[g])}["SAFE"].indexOf(s)!==-1&&xt(`Cannot modify setting: ${s}`),s==="PRECISION"?(zt.bigDec.set({precision:t}),zt.Settings.PRECISION=t,t>21&&Sn("USE_BIG",!0)):s==="USE_LN"&&t===!0?(zt.Settings.LOG="LN",zt.Settings.LOG10="log",zt.functions.log=zt.Settings.LOG_FNS.log10,zt.functions.log[0]=function(g){return g.isConstant()?new zt.NerdamerSymbol(Math.log10(g)):zt.symfunction(zt.Settings.LOG10,[g])},zt.functions.LN=zt.Settings.LOG_FNS.log,delete zt.functions.log10):zt.Settings[s]=t}var _0={get libExports(){return K.libExports},get functions(){return K.parser?.functions??{}},get parse(){let{parser:s}=K;return s?.parse?.bind(s)??(()=>null)},get callfunction(){return K.utils.callfunction},get Expression(){return K.classes.Expression}};function Ii(s=!1){let t=function(o){return function(...y){for(let L=0;L<y.length;L++)y[L]=_0.parse(y[L]);return new _0.Expression(kt("PARSE2NUMBER",()=>_0.callfunction(o,y)))}};for(let e in _0.functions)(!(e in _0.libExports)||s)&&(_0.libExports[e]=t(e))}var _i={get suppress_errors(){return K.settings?.suppress_errors??!1}};function xt(s,t=void 0){if(!_i.suppress_errors)throw t?new t(s):new Error(s)}var bi={get PRIMES_SET(){return K.ext.PRIMES_SET}};function $0(s){if(s in bi.PRIMES_SET)return!0;let t=Math.floor(Math.sqrt(s));for(let e=2;e<=t;e++)if(s%e===0)return!1;return!0}var A0={starttime:0,timeout:0,get TIMEOUT(){return K.settings?.TIMEOUT??800}};function t1(){A0.starttime=Date.now(),A0.timeout=A0.TIMEOUT}function n1(){A0.starttime=0}function en(){if(A0.starttime!==0&&Date.now()>A0.starttime+A0.timeout)throw new Error("timeout")}var M0={get PRIMES(){return K.ext.PRIMES},get PRIMES_SET(){return K.ext.PRIMES_SET}};function Oi(s){if(en(),$0(s))return[s];let t=s,e=1,o=[],g=2220446049250313e-31;for(;e<t;){en();let y=s/e,L=Math.floor(y);if(y-L<=g&&e>1){if($0(e)&&(M0.PRIMES_SET[e]||(M0.PRIMES.push(e),M0.PRIMES_SET[e]=!0),o.push(e)),$0(L)){o.push(L);break}t=L}e++}return o.sort((y,L)=>y-L)}function i1(s){let t=M0.PRIMES[M0.PRIMES.length-1]||2;for(let e=t;e<s;e++)$0(e)&&M0.PRIMES.push(e),M0.PRIMES_SET[e]=!0}var fn={get Settings(){return K.settings}};function kt(s,t,e=void 0,o=void 0){let g=fn.Settings[s];fn.Settings[s]=e===void 0?!0:!!e;let y=t.call(o);return fn.Settings[s]=g,y}function wt(s,t=void 0){return kt("PARSE2NUMBER",()=>Mt._.parse(s,t),!0)}var gt={get EXPRESSIONS(){return K.state.EXPRESSIONS},get Settings(){return K.settings},get LaTeX(){return K.classes.LaTeX},get text(){return K.utils.text},get variables(){return K.utils.variables},get isVector(){return K.utils.isVector},get isSymbol(){return K.utils.isSymbol},get isExpression(){return K.utils.isExpression},get isNumericSymbol(){return K.utils.isNumericSymbol},get isFraction(){return K.utils.isFraction},get isArray(){return K.utils.isArray},get _(){return K.parser},get Build(){return K.classes.Build}},S0=class s{symbol;constructor(t){this.symbol=t}static getExpression(t,e=void 0){(t==="last"||!t)&&(t=gt.EXPRESSIONS.length),t==="first"&&(t=1);let o=Number(t)-1,g=gt.EXPRESSIONS[o];return g&&new s(g.symbol)}text(t="decimals",e=void 0){e||=gt.Settings.EXPRESSION_DECP;let o=this.symbol;return o.text_?o.text_(t):gt.text(this.symbol,t,void 0,e)}latex(t){return this.symbol.latex?this.symbol.latex(t):gt.LaTeX.latex(this.symbol,t)}valueOf(){return this.symbol.valueOf()}evaluate(...t){if(gt.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let e=t[0],o,g=1;typeof e=="string"?o=e.charAt(0)==="%"?s.getExpression(e.substr(1)).text():e:e instanceof s||gt.isSymbol(e)?o=e.text():(o=this.symbol.text(),g--);let y=t[g]||{};return new s(kt("PARSE2NUMBER",()=>gt._.parse(o,y),!0))}buildFunction(t){return gt.Build.build(this.symbol,t)}isNumber(){return gt.isNumericSymbol(this.symbol)}isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0}isImaginary(){return wt(gt._.parse(this.symbol)).isImaginary()}variables(){return gt.variables(this.symbol)}toString(){try{return gt.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(t){if(t.message==="timeout")throw t;return""}}toDecimal(t){gt.Settings.precision=t;let e=gt.text(this.symbol,"decimals");return gt.Settings.precision=void 0,e}isFraction(){return gt.isFraction(this.symbol)}isPolynomial(){return this.symbol.isPoly()}sub(t,e){return new s(this.symbol.sub(gt._.parse(t),gt._.parse(e)))}operation(t,e){let o;return gt.isExpression(e)?o=e.symbol:gt.isSymbol(e)?o=e:o=gt._.parse(e),new s(gt._[t](this.symbol.clone(),o.clone()))}add(t){return this.operation("add",t)}subtract(t){return this.operation("subtract",t)}multiply(t){return this.operation("multiply",t)}divide(t){return this.operation("divide",t)}pow(t){return this.operation("pow",t)}expand(){return new s(gt._.expand(this.symbol))}each(t,e){if(this.symbol.each)this.symbol.each(t,e);else if(gt.isArray(this.symbol))for(let o=0;o<this.symbol.length;o++)t.call(this.symbol,this.symbol[o],o);else t.call(this.symbol)}eq(t){gt.isSymbol(t)||(t=gt._.parse(t));try{return gt._.subtract(this.symbol.clone(),t).equals(0)}catch(e){if(e.message==="timeout")throw e;return!1}}lt(t){gt.isSymbol(t)||(t=gt._.parse(t));try{return wt(gt._.subtract(this.symbol.clone(),t)).lessThan(0)}catch(e){if(e.message==="timeout")throw e;return!1}}gt(t){gt.isSymbol(t)||(t=gt._.parse(t));try{return wt(gt._.subtract(this.symbol.clone(),t)).greaterThan(0)}catch(e){if(e.message==="timeout")throw e;return!1}}gte(t){return this.gt(t)||this.eq(t)}lte(t){return this.lt(t)||this.eq(t)}numerator(){return new s(this.symbol.getNum())}denominator(){return new s(this.symbol.getDenom())}hasFunction(t){return this.symbol.containsFunction(t)}contains(t){return this.symbol.contains(t)}toTeX(t){return this.latex(t)}};K.classes.Expression=S0;var ot={get _(){return K.parser},get Settings(){return K.settings},get LaTeX(){return K.classes.LaTeX},get NerdamerSymbol(){return K.classes.NerdamerSymbol}},Ct=class s{multiplier;elements;rowVector;custom=!0;constructor(t,...e){this.multiplier=new Be(1),dt(t)?this.elements=t.elements?.slice(0)??[]:Dt(t)?this.elements=t.slice(0):mt(t)?t.elements.length===1?(this.elements=[...t.elements[0]],this.rowVector=!0):t.elements.length>1&&Array.isArray(t.elements[0])&&t.elements[0].length===1&&(this.elements=t.elements.map(o=>o[0]),this.rowVector=!1):typeof t>"u"?this.elements=[]:this.elements=[t,...e]}static arrayPrefill(t,e){let o=[];e||=0;for(let g=0;g<t;g++)o[g]=e;return o}static fromArray(t){let e=new s;return e.elements=t,e}static fromSet(t){return s.fromArray(t.elements)}e(t){return t<1||t>this.elements.length?null:this.elements[t-1]}set(t,e){ft(e)?this.elements[t]=e:this.elements[t]=new ot.NerdamerSymbol(e)}dimensions(){return this.elements.length}modulus(){return kt("SAFE",()=>ot._.pow(this.dot(this.clone()),new ot.NerdamerSymbol(.5)),void 0,this)}eql(t){let e=this.elements.length,o=t.elements||t;if(e!==o.length)return!1;do if(Math.abs(ot._.subtract(this.elements[e-1],o[e-1]).valueOf())>ot.Settings.PRECISION)return!1;while(--e);return!0}clone(){let t=new s,e=this.elements.length;for(let o=0;o<e;o++)t.elements.push(this.elements[o].clone());return t.rowVector=this.rowVector,t}expand(t){return this.elements=this.elements.map(e=>ot._.expand(e,t)),this}map(t){let e=[];return this.each((o,g)=>{e.push(t(o,g))}),new s(e)}each(t){let e=this.elements.length,o=e,g;do g=o-e,t(this.elements[g],g+1);while(--e)}toUnitVector(){return kt("SAFE",()=>{let t=this.modulus();return t.valueOf()===0?this.clone():this.map(e=>ot._.divide(e,t))},void 0,this)}angleFrom(t){return kt("SAFE",()=>{let e=t.elements||t;if(this.elements.length!==e.length)return null;let g=new ot.NerdamerSymbol(0),y=new ot.NerdamerSymbol(0),L=new ot.NerdamerSymbol(0);this.each((G,V)=>{g=ot._.add(g,ot._.multiply(G,e[V-1])),y=ot._.add(y,ot._.multiply(G,G)),L=ot._.add(L,ot._.multiply(e[V-1],e[V-1]))}),y=ot._.pow(y,new ot.NerdamerSymbol(.5)),L=ot._.pow(L,new ot.NerdamerSymbol(.5));let C=ot._.multiply(y,L);if(C.valueOf()===0)return null;let D=ot._.divide(g,C),Z=D.valueOf();return Z<-1&&(D=-1),Z>1&&(D=1),new ot.NerdamerSymbol(Math.acos(D))},void 0,this)}isParallelTo(t){let e=this.angleFrom(t).valueOf();return e===null?null:e<=ot.Settings.PRECISION}isAntiparallelTo(t){let e=this.angleFrom(t).valueOf();return e===null?null:Math.abs(e-Math.PI)<=ot.Settings.PRECISION}isPerpendicularTo(t){let e=this.dot(t);return e===null?null:Math.abs(e)<=ot.Settings.PRECISION}add(t){return kt("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((o,g)=>ot._.add(o,e[g-1]))},void 0,this)}subtract(t){return kt("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((o,g)=>ot._.subtract(o,e[g-1]))},void 0,this)}multiply(t){return this.map(e=>ot._.multiply(e.clone(),t.clone()))}x(t){return this.multiply(t)}dot(t){return kt("SAFE",()=>{let e=t.elements||t,o=new ot.NerdamerSymbol(0),g=this.elements.length;if(g!==e.length)return null;do o=ot._.add(o,ot._.multiply(this.elements[g-1],e[g-1]));while(--g);return o},void 0,this)}cross(t){let e=t.elements||t;if(this.elements.length!==3||e.length!==3)return null;let o=this.rowVector&&t.rowVector,g=this.elements;return kt("SAFE",()=>{let y=new s([ot._.subtract(ot._.multiply(g[1],e[2]),ot._.multiply(g[2],e[1])),ot._.subtract(ot._.multiply(g[2],e[0]),ot._.multiply(g[0],e[2])),ot._.subtract(ot._.multiply(g[0],e[1]),ot._.multiply(g[1],e[0]))]);return y.rowVector=o,y},void 0,this)}toUnitMultiplier(){return this}max(){let t=0,e=this.elements.length,o=e,g;do{g=o-e;let y=this.elements[g],L=y.valueOf(),C=typeof t=="number"?t:t.valueOf();Math.abs(L)>Math.abs(C)&&(t=y)}while(--e);return t}magnitude(){let t=new ot.NerdamerSymbol(0);return this.each(e=>{t=ot._.add(t,ot._.pow(e,new ot.NerdamerSymbol(2)))}),ot._.sqrt(t)}indexOf(t){let e=null,o=this.elements.length,g=o,y;do y=g-o,e===null&&this.elements[y].valueOf()===t.valueOf()&&(e=y+1);while(--o);return e}text_(t,e){let o=Vt(this,e);return(this.rowVector?"[":"")+o+(this.rowVector?"]":"")}text(t,e){let o=Vt(this,e);return(this.rowVector?"[":"")+o+(this.rowVector?"]":"")}toString(){return this.text()}latex(t){let e=[];for(let o=0;o<this.elements.length;o++)e.push(ot.LaTeX.latex(this.elements[o],t));return`[${e.join(", ")}]`}};K.classes.Vector=Ct;var Lt={get _(){return K.parser},get LaTeX(){return K.classes.LaTeX},get NerdamerSymbol(){return K.classes.NerdamerSymbol}},Pt=class s{multiplier;elements;custom=!0;constructor(...t){this.multiplier=new Be(1);let e=t,o=e.length,g,y=[];if(mt(e))for(g=0;g<o;g++)y.push(e[g].slice(0));else{let L,C,D;for(g=0;g<o;g++)L=e[g],dt(L)&&(L=L.elements),Dt(L)||(L=[L]),D=L.length,C&&C!==D&&xt("Unable to create Matrix. Row dimensions do not match!"),y.push(L),C=D}this.elements=y}static identity(t){let e=new s;for(let o=0;o<t;o++){e.elements.push([]);for(let g=0;g<t;g++)e.set(o,g,o===g?new Lt.NerdamerSymbol(1):new Lt.NerdamerSymbol(0))}return e}static fromArray(t){return new s(...t)}static zeroMatrix(t,e){let o=new s;for(let g=0;g<t;g++)o.elements.push(Ct.arrayPrefill(e,new Lt.NerdamerSymbol(0)));return o}get(t,e){if(this.elements[t])return this.elements[t][e]}map(t,e){let o=new s;return this.each((g,y,L)=>{o.set(y,L,t.call(o,g),e)}),o}set(t,e,o,g){this.elements[t]||=[],g||ft(o)?this.elements[t][e]=o:this.elements[t][e]=new Lt.NerdamerSymbol(o)}cols(){return this.elements[0].length}rows(){return this.elements.length}row(t){return!t||t>this.cols()?[]:this.elements[t-1]}col(t){let e=this.rows(),o=[];if(t>this.cols()||!t)return o;for(let g=0;g<e;g++)o.push(this.elements[g][t-1]);return o}eachElement(t){let e=this.rows(),o=this.cols(),g,y;for(g=0;g<e;g++)for(y=0;y<o;y++)t.call(this,this.elements[g][y],g,y)}each(t){this.eachElement(t)}determinant(){if(!this.isSquare())return null;let t=this.toRightTriangular(),e=t.elements[0][0],o=t.elements.length-1,g=o,y;do y=g-o+1,e=Lt._.multiply(e,t.elements[y][y]);while(--o);return e}isSquare(){return this.elements.length===this.elements[0].length}isSingular(){let t=this.determinant();return this.isSquare()&&t!==null&&t.multiplier.equals(0)}augment(t){let e=this.rows(),o=t.rows();e!==o&&xt("Cannot augment matrix. Rows don't match.");for(let g=0;g<e;g++)this.elements[g]=this.elements[g].concat(t.elements[g]);return this}clone(){let t=this.rows(),e=this.cols(),o=new s;for(let g=0;g<t;g++){o.elements[g]=[];for(let y=0;y<e;y++){let L=this.elements[g][y];o.elements[g][y]=ft(L)?L.clone():L}}return o}toUnitMultiplier(){return this}expand(t){return this.eachElement(e=>Lt._.expand(e,t)),this}evaluate(t){return this.eachElement(e=>Lt._.evaluate(e,t)),this}invert(){return this.isSquare()||xt("Matrix is not square!"),kt("SAFE",()=>{let t=this.elements.length,e=t,o,g,y=s.identity(t),L=this.augment(y).toRightTriangular(),C,D=L.elements[0].length,Z,G,V,de=[],Ee;do{o=t-1,G=[],C=D,de[o]=[],V=L.elements[o][o];do Z=D-C,Ee=Lt._.divide(L.elements[o][Z],V.clone()),G.push(Ee),Z>=e&&de[o].push(Ee);while(--C);for(L.elements[o]=G,g=0;g<o;g++){G=[],C=D;do Z=D-C,G.push(Lt._.subtract(L.elements[g][Z].clone(),Lt._.multiply(L.elements[o][Z].clone(),L.elements[g][o].clone())));while(--C);L.elements[g]=G}}while(--t);return s.fromArray(de)},void 0,this)}toRightTriangular(){return kt("SAFE",()=>{let t=this.clone(),e,o,g,y=this.elements.length,L=y,C,D,Z=this.elements[0].length,G;do{if(C=L-y,o=t.elements[C][C],o.valueOf()===0){for(let V=C+1;V<L;V++)if(g=t.elements[V][C],g&&g.valueOf()!==0){e=[],D=Z;do G=Z-D,e.push(Lt._.add(t.elements[C][G].clone(),t.elements[V][G].clone()));while(--D);t.elements[C]=e;break}}if(o=t.elements[C][C],o.valueOf()!==0)for(let V=C+1;V<L;V++){let de=Lt._.divide(t.elements[V][C].clone(),t.elements[C][C].clone());e=[],D=Z;do G=Z-D,e.push(G<=C?new Lt.NerdamerSymbol(0):Lt._.subtract(t.elements[V][G].clone(),Lt._.multiply(t.elements[C][G].clone(),de.clone())));while(--D);t.elements[V]=e}}while(--y);return t},void 0,this)}transpose(){let t=this.elements.length,e=this.elements[0].length,o=new s,g=e,y,L,C;do{y=e-g,o.elements[y]=[],L=t;do C=t-L,o.elements[y][C]=this.elements[C][y].clone();while(--L)}while(--g);return o}canMultiplyFromLeft(t){let e=mt(t)?t.elements.length:t.length;return this.elements[0].length===e}sameSize(t){return this.rows()===t.rows()&&this.cols()===t.cols()}multiply(t){return kt("SAFE",()=>{let e=t.elements||t;if(!this.canMultiplyFromLeft(e)){let Me=t;if(this.sameSize(Me)){let ae=new s,ce=this.rows();for(let ue=0;ue<ce;ue++){let u=Lt._.multiply(new Ct(this.elements[ue]),new Ct(Me.elements[ue]));ae.elements[ue]=u.elements}return ae}return null}let o=this.elements.length,g=o,y,L,C=e[0].length,D,Z=this.elements[0].length,G=[],V,de,Ee;do{y=g-o,G[y]=[],L=C;do{D=C-L,V=new Lt.NerdamerSymbol(0),de=Z;do Ee=Z-de,V=Lt._.add(V,Lt._.multiply(this.elements[y][Ee],e[Ee][D]));while(--de);G[y][D]=V}while(--L)}while(--o);return s.fromArray(G)},void 0,this)}add(t,e){let o=new s;return this.sameSize(t)&&this.eachElement((g,y,L)=>{let C=Lt._.add(g.clone(),t.elements[y][L].clone());e&&(C=e.call(o,C,g,t.elements[y][L])),o.set(y,L,C)}),o}subtract(t,e){let o=new s;return this.sameSize(t)&&this.eachElement((g,y,L)=>{let C=Lt._.subtract(g.clone(),t.elements[y][L].clone());e&&(C=e.call(o,C,g,t.elements[y][L])),o.set(y,L,C)}),o}negate(){return this.each(t=>t.negate()),this}toVector(){if(this.rows()===1||this.cols()===1){let t=new Ct;return t.elements=this.elements.flat(),t}return this}toString(t,e){let o=this.rows(),g=[];t=t===void 0?`
`:t;for(let y=0;y<o;y++)g.push(`[${this.elements[y].map(L=>{let C=e?L.multiplier.toDecimal():L.toString();return L===void 0?"":C}).join(",")}]`);return`matrix${yt(g.join(","))}`}text(){return`matrix(${this.elements.map(t=>`[${t.join(",")}]`)})`}latex(t){let e=this.cols(),{elements:o}=this;return _t("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let g=[];for(let y in o){if(!Object.hasOwn(o,y))continue;let L=[];for(let C=0;C<e;C++)L.push(Lt.LaTeX.latex(o[y][C],t));g.push(L.join(" & "))}return g.join(" \\cr ")})}};K.classes.Matrix=Pt;var x0={get _(){return K.parser},get N(){return K.groups.N},get P(){return K.groups.P},get S(){return K.groups.S},get EX(){return K.groups.EX},get FN(){return K.groups.FN},get CB(){return K.groups.CB},get Math2(){return sn.Math2},get NerdamerSymbol(){return K.classes.NerdamerSymbol}},e0={dependencies:{},reformat:{},initDependencies(){let{Math2:s}=x0;this.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":s.gamma},gamma_incomplete:{"Math2.factorial":s.factorial},Li:{"Math2.Ei":s.Ei,"Math2.bigLog":s.bigLog,Frac:Be},Ci:{"Math2.factorial":s.factorial},Ei:{"Math2.factorial":s.factorial},Si:{"Math2.factorial":s.factorial},Shi:{"Math2.factorial":s.factorial},Chi:{isInt:pt,nround:m0,"Math2.num_integrate":s.num_integrate},factor:{"Math2.ifactor":s.ifactor,NerdamerSymbol:x0.NerdamerSymbol},num_integrate:{"Math2.simpson":s.simpson,nround:m0},fib:{even:Ut}},this.reformat={diff(t,e){let o=t.args[1].toString(),g=`let f = ${e0.build(t.args[0].toString(),[o])};`,y=s.diff.toString();return!y.startsWith("function")&&!y.startsWith("(")&&!y.startsWith("async")&&(y=`function ${y}`),e[1]+=`let diff = ${y};`,e[1]+=g,[`diff(f)(${o})`,e]}}},getProperName(s){return{continuedFraction:"continuedFraction"}[s]||s},compileDependencies(s,t){let e=e0.dependencies[s],o=t&&t[1]?t[1]:"",g=t&&t[0]?t[0]:{};for(let y in e){if(typeof e[y]=="object")continue;let L=y.split("."),C=e[y];if(typeof C=="function"){let D=C.toString();!D.startsWith("function")&&!D.startsWith("(")&&!D.startsWith("async")&&(D=`function ${D}`),C=D}o+=`let ${L.length>1?L[1]:L[0]}=${C};`,g[y]=L.pop()}return[g,o]},getArgsDeps(s,t){let{args:e}=s,o=t,g=function(y){y.group===x0.FN&&(o=e0.compileDependencies(y.fname,o))};for(let y=0;y<e.length;y++)s.args[y].each(g);return o},build(s,t){let{_:e,FN:o,N:g,S:y,P:L,EX:C,CB:D,NerdamerSymbol:Z}=x0;s=kt("PARSE2NUMBER",()=>e.parse(s),!0);let G=n0(s),V=[],de=[{},""],Ee=function(ce,ue){ce.fname===""&&(ce=Z.unwrapPARENS(ce)),ue||=[];let u=[],{group:Ne}=ce,Oe="",Pe=function(he){let Se=he===D?"*":"+",be=[];for(let i in ce.symbols){if(!Object.hasOwn(ce.symbols,i))continue;let a=ce.symbols[i],f=Ee(a,ue)[0];a.isComposite()&&(f=yt(f)),be.push(f)}let se=be.join(Se);return se=se&&!ce.multiplier.equals(1)?yt(se):se,se},ye=function(he){let Se;if(he in Math)Se=`Math.${he}`;else{if(he=e0.getProperName(he),V.indexOf(he)===-1){let be=x0.Math2[he].toString();!be.startsWith("function")&&!be.startsWith("(")&&!be.startsWith("async")&&(be=`function ${be}`),ue.push(`let ${he} = ${be}; `),V.push(he)}Se=he}return Se+=yt(ce.args.map(be=>Ee(be,ue)[0]).join(",")),Se};Ne===g?u.push(ce.multiplier.toDecimal()):ce.multiplier.equals(-1)?Oe="-":ce.multiplier.equals(1)||u.push(ce.multiplier.toDecimal());let $e;if(Ne===y||Ne===L)$e=ce.value;else if(Ne===o)if(de=e0.compileDependencies(ce.fname,de),de=e0.getArgsDeps(ce,de),e0.reformat[ce.fname]){let he=e0.reformat[ce.fname](ce,de);de=he[1],$e=he[0]}else $e=ye(ce.fname);else if(Ne===C){let he=ce.previousGroup;he===g||he===y?$e=ce.value:he===o?($e=ye(ce.fname),de=e0.compileDependencies(ce.fname,de),de=e0.getArgsDeps(ce,de)):$e=Pe(ce.previousGroup)}else $e=Pe(ce.group);if(ce.group!==g&&!ce.power.equals(1)){let he=Ee(e.parse(ce.power));ue.push(he[1]),$e=`Math.pow${yt(`${$e},${he[0]}`)}`}return $e&&u.push(Oe+$e),[u.join("*"),ue.join("").replace(/\n+\s+/gu," ")]};t&&(G=t);let Me=Ee(s);for(let ce in de[0]){if(!Object.hasOwn(de[0],ce))continue;let ue=de[0][ce];Me[1]=Me[1].replace(ce,ue),de[1]=de[1].replace(ce,ue)}return new Function(...G,`${(de[1]||"")+Me[1]} return ${Me[0]};`)}};K.classes.Build=e0;var s0={get _(){return K.parser},get Settings(){return K.settings},get SQRT(){return K.fnNames.SQRT},get ABS(){return K.fnNames.ABS},get PARENTHESIS(){return K.fnNames.PARENTHESIS},get FACTORIAL(){return K.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return K.fnNames.DOUBLEFACTORIAL},get N(){return K.groups.N},get P(){return K.groups.P},get S(){return K.groups.S},get EX(){return K.groups.EX},get FN(){return K.groups.FN},get CB(){return K.groups.CB},get CP(){return K.groups.CP},get Parser(){return K.classes.Parser}},St={parser:null,space:"~",dot:" \\cdot ",latex(s,t){let{_:e,P:o,CB:g}=s0;if(s&&typeof s=="object"&&"clone"in s&&typeof s.clone=="function"&&(s=s.clone()),s instanceof e.classes.Collection&&(s=s.elements),Dt(s)){let ae=[];for(let ce=0;ce<s.length;ce++){let ue=s[ce];ft(ue)||(ue=e.parse(ue)),ae.push(this.latex(ue,t))}return this.brackets(ae.join(", "),"square")}if(mt(s)){let ae=`\\begin{pmatrix}
`;for(let ce=0;ce<s.elements.length;ce++){let ue=[],u=s.elements[ce];for(let Ne=0;Ne<u.length;Ne++)ue.push(this.latex(u[Ne],t));ae+=ue.join(" & "),ce<s.elements.length-1&&(ae+=`\\\\
`)}return ae+="\\end{pmatrix}",ae}if(dt(s)){let ae="\\left[";for(let ce=0;ce<s.elements.length;ce++)ae+=`${this.latex(s.elements[ce],t)} ${ce===s.elements.length-1?"":",\\,"}`;return ae+="\\right]",ae}if(Cn(s)){let ae="\\{";for(let ce=0;ce<s.elements.length;ce++)ae+=`${this.latex(s.elements[ce],t)} ${ce===s.elements.length-1?"":",\\,"}`;return ae+="\\}",ae}s=s.clone();let y=t==="decimal"||t==="decimals",{power:L}=s,C=tn(L),D=s.multiplier.lessThan(0);if(s.group===o&&y){let ae=Number(s.value),ce=Number(s.power.toDecimal()),ue=Number(s.multiplier.toDecimal());return String(ue*ae**ce)}s.multiplier=s.multiplier.abs();let Z;y?Z=[String(s.multiplier.toDecimal()),""]:Z=[s.multiplier.num,s.multiplier.den];let G=this.value(s,C,t,D),V;C&&L.negate(),y?(V=ft(L)?St.latex(L,t):String(L.toDecimal()),String(V)==="1"&&(V="")):ft(L)?V=this.latex(L,t):V=this.formatFrac(L,!0);let de=["",""],Ee=C?1:0;return de[Ee]=V,((D?"-":"")+this.set(Z,G,de,s.group===g)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(s,t,e,o){let{SQRT:g,ABS:y,PARENTHESIS:L,FACTORIAL:C,DOUBLEFACTORIAL:D,FN:Z,S:G,P:V,N:de,CB:Ee,CP:Me,EX:ae}=s0,{group:ce}=s,{previousGroup:ue}=s,u=["",""],Ne=t?1:0;if(s.isInfinity)u[Ne]="\\infty";else if(ce===G||ce===V||ue===G||ue===V||ue===de){let Oe=this.formatSubscripts(s.value);Oe.replace&&(Oe=Oe.replace(/(?<prefix>.+)_$/u,"$1\\_"));let Pe=String(Oe).split("_"),ye=this.greek[Pe[0]];ye&&(Pe[0]=ye,Oe=Pe.join("_"));let $e=this.symbols[Pe[0]];$e&&(Pe[0]=$e,Oe=Pe.join("_")),u[Ne]=Oe}else if(ce===Z||ue===Z){let Oe=[],{fname:Pe}=s;for(let ye=0;ye<s.args.length;ye++){let $e=s.args[ye],he;typeof $e=="string"?he=$e:he=this.latex($e,e),Oe.push(he)}if(Pe===g)u[Ne]=`\\sqrt${this.braces(Oe.join(","))}`;else if(Pe===y)u[Ne]=this.brackets(Oe.join(","),"abs");else if(Pe===L)u[Ne]=this.brackets(Oe.join(","),"parens");else if(Pe==="limit")u[Ne]=` \\lim\\limits_{${Oe[1]} \\to ${Oe[2]}} ${Oe[0]}`;else if(Pe==="integrate")u[Ne]=`\\int${this.braces(Oe[0])}${this.braces(`d${Oe[1]}`)}`;else if(Pe==="defint")u[Ne]=`\\int\\limits_${this.braces(Oe[1])}^${this.braces(Oe[2])} ${Oe[0]} d${Oe[3]}`;else if(Pe===C||Pe===D){let ye=s.args[0];ye.power.equals(1)&&(ye.isComposite()||ye.isCombination())&&(Oe[0]=this.brackets(Oe[0])),u[Ne]=Oe[0]+(Pe===C?"!":"!!")}else if(Pe==="floor")u[Ne]=`\\left \\lfloor${this.braces(Oe[0])}\\right \\rfloor`;else if(Pe==="ceil")u[Ne]=`\\left \\lceil${this.braces(Oe[0])}\\right \\rceil`;else if(Pe===s0.Settings.LOG&&Oe.length>1)u[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces(Oe[1])}${this.brackets(Oe[0])}`;else if(Pe===s0.Settings.LOG10)u[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("10")}${this.brackets(Oe[0])}`;else if(Pe===s0.Settings.LOG2)u[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("2")}${this.brackets(Oe[0])}`;else if(Pe===s0.Settings.LOG1P)u[Ne]=`\\ln${this.brackets(`1 + ${Oe[0]}`)}`;else if(Pe==="sum"){let ye=Oe[0],$e=Oe[1],he=Oe[2],Se=Oe[3];u[Ne]=`\\sum\\limits_{${this.braces($e)}=${this.braces(he)}}^${this.braces(Se)} ${this.braces(ye)}`}else if(Pe==="product"){let ye=Oe[0],$e=Oe[1],he=Oe[2],Se=Oe[3];u[Ne]=`\\prod\\limits_{${this.braces($e)}=${this.braces(he)}}^${this.braces(Se)} ${this.braces(ye)}`}else if(Pe==="nthroot")u[Ne]=`\\sqrt[${Oe[1]}]${this.braces(Oe[0])}`;else if(Pe==="mod")u[Ne]=`${Oe[0]} \\bmod ${Oe[1]}`;else if(Pe==="realpart")u[Ne]=`\\operatorname{Re}${this.brackets(Oe[0])}`;else if(Pe==="imagpart")u[Ne]=`\\operatorname{Im}${this.brackets(Oe[0])}`;else{let ye=Pe===""?"":`\\mathrm${this.braces(Pe.replace(/_/gu,"\\_"))}`;s.isConversion?u[Ne]=ye+this.brackets(Oe.join(""),"parens"):u[Ne]=ye+this.brackets(Oe.join(","),"parens")}}else if(s.isComposite()){let Oe=s.collectSymbols().sort(ce===Me||ue===Me?(Se,be)=>be.group-Se.group:(Se,be)=>{let se=ft(Se.power)?-1:Number(Se.power);return(ft(be.power)?-1:Number(be.power))-se}),Pe=[],ye=Oe.length;for(let Se=0;Se<ye;Se++)Pe.push(St.latex(Oe[Se],e));let $e=Pe.join("+"),he=s;u[Ne]=!(he.isLinear()&&he.multiplier.equals(1))||o?this.brackets($e,"parens"):$e}else if(ce===Ee||ue===ae||ue===Ee){ce===Ee&&s.distributeExponent();let Oe=[],Pe=[],ye=[],$e=[],he=0,Se=0,be=function(se,i,a){if(a>1&&i.length>0){let f=i.length;for(let w=0;w<f;w++){let d=i[w],v=se[d];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(v)||/^\\left\(.+\\right\)$/gu.test(v)||(se[d]=St.brackets(v,"parens"))}}return se};s.each(se=>{let i=tn(se.power),a;i?(a=St.latex(se.invert(),e),Se++,se.isComposite()&&(!s.multiplier.den.equals(1)&&Math.abs(Number(se.power))===1&&(a=St.brackets(a,"parens")),ye.push(Oe.length)),Oe.push(a)):(a=St.latex(se,e),he++,se.isComposite()&&(!s.multiplier.num.equals(1)&&Math.abs(Number(se.power))===1&&(a=St.brackets(a,"parens")),$e.push(Pe.length)),Pe.push(a))}),be(Pe,$e,he),u[0]=Pe.join(this.dot),be(Oe,ye,Se),u[1]=Oe.join(this.dot)}return u},set(s,t,e,o){let g=function(de){return/^\\left\(.+\\right\)$/u.test(de)};e&&=this.formatP(e);let y;o&&(y=e[0],e[0]=""),t=this.merge(t,e);let L=s[0],C=s[1],D=t[0],Z=t[1];D&&Number(L)===1&&(L=""),Number(C)===1&&(C="");let G=this.join(L,D,g(D)?"":this.dot),V=this.join(C,Z,g(Z)?"":this.dot);if(G&&V){let de=this.frac(G,V);return o&&y&&(de=this.brackets(de)+y),de}return G},merge(s,t){let e=[];for(let o=0;o<2;o++)e[o]=s[o]+t[o];return e},join(s,t,e){return!s&&!t?"":s&&!t?s:t&&!s?t:s+e+t},formatSubscripts(s){let t=s.toString().split("_"),e="";for(;t.length>1;)t.length>0&&(e=`_${this.braces(t.pop()+e)}`);return t[0]+e},formatP(s){for(let t=0;t<2;t++){let e=s[t];e&&(s[t]=`^${this.braces(e)}`)}return s},formatFrac(s,t){let e=s.num.toString(),o=s.den.toString();return t&&e==="1"&&o==="1"?"":o==="1"?e:this.frac(e,o)},frac(s,t){return`\\frac${this.braces(s)}${this.braces(t)}`},braces(s){return`{${s}}`},brackets(s,t){t||="parens";let o={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[t];return`\\left${o[0]}${s}\\right${o[1]}`},filterTokens(s){let t=[];Dt(s)&&(t.type=s.type);let e=["\\","left","right","big","Big","large","Large"];for(let o=0,g=s.length;o<g;o++){let y=s[o],L=s[o+1];y.value==="\\"&&L.value==="\\"?t.push(y):Dt(y)?t.push(St.filterTokens(y)):e.indexOf(y.value)===-1&&t.push(y)}return t},parse(s){let{SQRT:t}=s0,e,o,g="",y=this.filterTokens(s),L={cdot:"",times:"",infty:"Infinity"},C=function(G){return y[typeof G>"u"?++e:e+=G]},D=function(){return St.parse(C())},Z=function(G){return G in L?L[G]:G==="*"&&y[e+1].value==="&"?(C(2),","):G==="&"?(C(),","):G==="\\"?"],[":G};for(e=0,o=y.length;e<o;e++){let G=y[e];if(G.value==="frac"){let V=D(),de=D();g+=`${V}/${de}`}else if(G.value in St.symbols)if(G.value===t&&y[e+1].type==="vector"&&y[e+2].type==="NerdamerSet"){let V=D(),de=D();g+=`${de}^${yt(`1/${V}`)}`}else g+=G.value+D();else if(G.value==="int"){let V=D();e++;let de=C().value;de=Z(de.substring(1,de.length)),g+=`integrate${yt(`${V},${de}`)}`}else if(G.value==="int_"){let V=D();e++;let de=C().value;de===void 0&&(e--,de=D());let Ee=D(),Me=C().value;Me===","&&(Me=C().value),Me==="differentialD"&&(e++,Me=C().value),Me==="mathrm"&&(e++,Me=C().value),g+=`defint${yt(`${Ee},${V},${de},${Me}`)}`}else if(G.value&&G.value.startsWith("int_")){let V=G.value.replace("int_","");e++;let de=C().value;de===void 0&&(e--,de=D());let Ee=D(),Me=C().value;Me===","&&(Me=C().value),Me==="differentialD"&&(e++,Me=C().value),Me==="mathrm"&&(e++,Me=C().value),g+=`defint${yt(`${Ee},${V},${de},${Me}`)}`}else if(G.value==="mathrm"){let V=y[++e][0].value;g+=V+D()}else if(G.value==="sum_"||G.value==="prod_"){let V=G.value==="sum_"?"sum":"product",de=C();e++;let Ee=D(),Me=D();g+=V+yt([Me,Z(de[0]),Z(de[2]),Z(Ee)].join(","))}else if(G.value==="lim_"){let V=C();g+=`limit${yt([D(),Z(V[0]),Z(V[2])].join(","))}`}else if(G.value==="begin"){let V=C();Array.isArray(V)&&V[0].value==="matrix"&&(g+="matrix([")}else if(G.value==="end"){let V=C();Array.isArray(V)&&V[0].value==="matrix"&&(g+="])")}else Array.isArray(G)?g+=Z(St.parse(G)):g+=Z(G.value.toString())}return yt(g)},initParser(){let s=s0.Parser,t=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],e=new s;for(let g in e)t.indexOf(g)===-1&&delete e[g];e.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(g){return g}}),e.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(g){return g}});let o=e.getBrackets();o["{"].maps_to=void 0,this.parser=e}};K.classes.LaTeX=St;var Fn={get LONG_PI(){return K.ext.LONG_PI},get LONG_E(){return K.ext.LONG_E}},qe={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",get LONG_PI(){return Fn.LONG_PI},get LONG_E(){return Fn.LONG_E},PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800,initCache(){this.CACHE.roots={};let s=40,t=40;for(let e=2;e<=s;e++)for(let o=2;o<=t;o++){let g=Nn(e).pow(o);this.CACHE.roots[`${g}-${o}`]=e}}};qe.CONST_HASH=K.fnNames.CONST_HASH;qe.initCache();sn.Settings=qe;var u0={get bigInt(){return K.ext.bigInt},get BIG_LOG_CACHE(){return K.ext.BIG_LOG_CACHE},get PRIMES(){return K.ext.PRIMES},get NerdamerSymbol(){return K.classes.NerdamerSymbol},get CB(){return K.groups.CB},get P(){return K.groups.P}},ut={csc(s){return 1/Math.sin(s)},sec(s){return 1/Math.cos(s)},cot(s){return 1/Math.tan(s)},acsc(s){return Math.asin(1/s)},asec(s){return Math.acos(1/s)},acot(s){return Math.PI/2-Math.atan(s)},erf(s){let t=1/(1+.5*Math.abs(s)),e=1-t*Math.exp(-s*s-1.26551223+t*(1.00002368+t*(.37409196+t*(.09678418+t*(-.18628806+t*(.27886807+t*(-1.13520398+t*(1.48851587+t*(-.82215223+t*.17087277)))))))));return s>=0?e:-e},diff(s){return function(o){return(s(o+.001)-s(o-.001))/.002}},median(...s){s.sort((e,o)=>e-o);let t=Math.floor(s.length/2);return s.length%2?s[t]:(s[t-1]+s[t])/2},fromContinued(s){let t=s.fractions.slice(),e=1/t.pop();for(let o=0,g=t.length;o<g;o++)e=1/(t.pop()+e);return s.sign*(s.whole+e)},continuedFraction(s,t){t||=20;let e=Math.sign(s),o=Math.abs(s),g=Math.floor(o),y=o-g,L=0,C=!1,D=1e-14,Z=1e7,G,V,de={whole:g,sign:e,fractions:[]};for(;!C&&y!==0&&(G=1/y,V=Math.floor(G),!(V>Z&&ut.fromContinued(de)-s<=Number.EPSILON));)de.fractions.push(V),y=G-V,(y<=D||L>=t-1)&&(C=!0),L++;let Ee=de.fractions.length-1;return de.fractions[Ee]===1&&(de.fractions.pop(),de.fractions[--Ee]++),de},bigpow(s,t){s instanceof Be||(s=Be.create(s)),t instanceof Be||(t=Be.create(t));let e=new Be(0);if(t.isInteger())e.num=s.num.pow(t.toString()),e.den=s.den.pow(t.toString());else{let o=Be.create(s.num**t.num),g=Be.create(s.den**t.num);e.num=ut.nthroot(o,t.den.toString()),e.den=ut.nthroot(g,t.den)}return e},gamma(s){let e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(s<.5)return Math.PI/(Math.sin(Math.PI*s)*ut.gamma(1-s));s-=1;let o=e[0];for(let y=1;y<9;y++)o+=e[y]/(s+y);let g=s+7+.5;return Math.sqrt(2*Math.PI)*g**(s+.5)*Math.exp(-g)*o},bigfactorial(s){let t=new u0.bigInt(1);for(let e=2;e<=s;e++)t=t.times(e);return new Be(t)},bigLog(s){let t=u0.BIG_LOG_CACHE;if(t[s])return Be.quick.apply(null,t[s].split("/"));s=new Be(s);let e=80,o=new Be(0),g=s.subtract(new Be(1)),y=s.add(new Be(1));for(let L=0;L<e;L++){let C=new Be(2*L+1),D=ut.bigpow(g.divide(y),C),Z=C.clone().invert().multiply(D);o=o.add(Z)}return o.multiply(new Be(2))},factorial(s){let t=s%1===0;if(t&&s<0)return NaN;if(!t)return ut.gamma(s+1);let e=1;for(let o=2;o<=s;o++)e*=o;return e},dfactorial(s){let t=new Be(1);if(pt(s)){let e=s%2===0,o=e?s/2:(s+1)/2;if(e)for(let g=1;g<=o;g++)t=t.multiply(new Be(2).multiply(new Be(g)));else for(let g=1;g<=o;g++)t=t.multiply(new Be(2).multiply(new Be(g)).subtract(new Be(1)))}else t=2**((1+2*s-Math.cos(Math.PI*s))/4)*Math.PI**((Math.cos(Math.PI*s)-1)/4)*ut.gamma(1+s/2);return t},GCD(...s){let t=An(s.map(g=>Math.abs(g))).sort(),e=Math.abs(t.shift()),o=t.length;for(;o-- >0;){let g=Math.abs(t.shift());for(;;){if(e%=g,e===0){e=g;break}if(g%=e,g===0)break}}return e},QGCD(...s){let t=s[0];for(let e=1;e<s.length;e++){let o=s[e],g=t.isNegative()&&o.isNegative()?-1:1;t=o.gcd(t),g<0&&t.negate()}return t},LCM(s,t){return s*t/ut.GCD(s,t)},pow(s,t){return s<0&&Math.abs(t)<1?1/t%2===0?NaN:-(Math.abs(s)**t):s**t},factor(s){s=Number(s);let t=Math.sign(s);s=Math.abs(s);let e=ut.ifactor(s),o=new u0.NerdamerSymbol;o.symbols={},o.group=u0.CB;for(let g in e){if(!Object.hasOwn(e,g))continue;let y=new u0.NerdamerSymbol(1);y.group=u0.P,y.value=g;let L=new u0.NerdamerSymbol(e[g]);y.power=L,o.symbols[g]=y}return o.updateHash(),s===1&&(o=new u0.NerdamerSymbol(s)),t<0&&o.negate(),o},sfactor(s,t){t||={};let e=Math.floor(Math.sqrt(s)),{PRIMES:o}=u0,g=o[o.length-1];e>g&&s<1e6&&i1(e);let y=o.length;for(let L=0;L<y;L++){let C=o[L];for(;s%C===0;)s/=C,t[C]=(t[C]||0)+1}return s>1&&(t[s]=1),t},ifactor(s){let{bigInt:t}=u0,e=new t(s),o=new t(String(s));if(o.equals(0))return{0:1};let g=o.isNegative()?-1:1;o=o.abs();let y={};if(o.lt("65536"))y=ut.sfactor(o,y);else{let L=function(C){C.isPrime()?y[C]=(y[C]||0)+1:y=ut.sfactor(C,y)};try{let D={value:0},Z=function(G,V,de){let Ee=new t(G),Me=2,ae=new t(G),ce=new t(1);for(;ce.equals(1);){for(let ue=0;ue<=Me&&ce.equals(1);ue++){if(de.value++>1e3)throw new Error("stopping");ae=ae.pow(2).add(1).mod(V),ce=t.gcd(ae.minus(Ee).abs(),V)}Me*=2,Ee=ae}return ce.equals(V)?Z(G+1,V,de):ce};for(;!o.abs().equals(1);)if(o.isPrime()){L(o);break}else{let G=Z(2,o,D);L(G),o=o.divide(G)}}catch(C){if(C.message==="timeout")throw C;y={},L(e)}}if(g===-1){let L=Mn(In(y).map(Number));y[`-${L}`]=y[L],delete y[L]}return y},boxfactor(s,t){t||=200;let e,o,g=Math.floor(5/12*s),y=0,L=!1;for(;e=Math.floor(s/g),o=s%g,o!==0;){if(L)return[s,1];g=Math.max(o,g-o),y++,L=y>t}return[e,g,y]},fib(s){let t=Math.sign(s);s=Math.abs(s),t=Ut(s)?t:Math.abs(t);let e=0,o=1,g=1;for(let y=2;y<=s;y++)g=e+o,e=o,o=g;return g*t},mod(s,t){return s%t},integer_part(s){return Math.sign(s)*Math.floor(Math.abs(s))},simpson(s,t,e,o){let g=function(de,Ee,Me){let ae=de(Ee),ce=1e-12;return isNaN(ae)&&(ae=de(Me===1?Ee+ce:Ee-ce)),ae};o||=1e-4;let y=Math.abs(Math.floor((e-t)/o));y%2!==0&&y++;let L=(e-t)/y,C=g(s,t,1),D=!1,Z=t+L,G,V;for(let de=1;de<y;de++)G=D?2:4,V=G*g(s,Z,1),C+=V,D=!D,Z+=L;return(C+g(s,Z,2))*(L/3)},num_integrate(s,t,e,o,g){if(g<0)throw new Error("max depth cannot be negative");function y(D,Z,G,V,de,Ee,Me,ae,ce,ue,u){if(u.nanEncountered)return NaN;let Ne=G-Z,Oe=D(Z+Ne*.25),Pe=D(G-Ne*.25);if(isNaN(Oe)){u.nanEncountered=!0;return}if(isNaN(Pe)){u.nanEncountered=!0;return}let ye=Ne*(V+4*Oe+de)/12,$e=Ne*(de+4*Pe+Ee)/12,he=ye+$e,Se=(he-Me)/15;if(u.maxDepthCount>1e3*ce)return;if(ue>ce)return u.maxDepthCount++,he+Se;if(Math.abs(Se)<ae)return he+Se;let be=Z+Ne*.5,se=y(D,Z,be,V,Oe,de,ye,ae*.5,ce,ue+1,u);if(isNaN(se))return u.nanEncountered=!0,NaN;let i=y(D,be,G,de,Pe,Ee,$e,ae*.5,ce,ue+1,u);return isNaN(i)?(u.nanEncountered=!0,NaN):se+i}function L(D,Z,G,V,de){let Ee={maxDepthCount:0,nanEncountered:!1};V===void 0&&(V=1e-9),de===void 0&&(de=45);let Me=D(Z),ae=D(.5*(Z+G)),ce=D(G),ue=(Me+4*ae+ce)*(G-Z)/6,u=y(D,Z,G,Me,ae,ce,ue,V,de,1,Ee);if(Ee.maxDepthCount>0&&_n(`integrate-adaptive-simpson: Warning: maximum recursion depth (${de}) reached ${Ee.maxDepthCount} times`),Ee.nanEncountered)throw new Error("Function does not converge over interval!");return u}let C;try{C=L(s,t,e,o,g)}catch(D){if(D.message==="timeout")throw D;return ut.simpson(s,t,e)}return m0(C,12)},Ci(s){let e=.5772156649015329,o=0;for(let g=1;g<20;g++){let y=2*g;o+=(-1)**g*s**y/(y*ut.factorial(y))}return Math.log(s)+e+o},Si(s){let e=0;for(let o=0;o<20;o++){let g=2*o;e+=(-1)**o*s**(g+1)/((g+1)*ut.factorial(g+1))}return e},Ei(s){if(Number(s)===0)return-1/0;let t=30,e=.5772156649015329,o=0;for(let g=1;g<t;g++)o+=s**g/(g*ut.factorial(g));return e+Math.abs(Math.log(s))+o},Shi(s){let e=0,o,g;for(let y=0;y<30;y++)o=2*y,g=o+1,e+=s**g/(g*g*ut.factorial(o));return e},Chi(s){let e=.5772156649015329,o=function(g){return(Math.cosh(g)-1)/g};return Math.log(s)+e+ut.num_integrate(o,.002,s,.001)},Li(s){return ut.Ei(ut.bigLog(s))},gamma_incomplete(s,t){let e=s-1,o=0,g=t||0;for(let y=0;y<e;y++)o+=g**y/ut.factorial(y);return ut.factorial(e)*Math.exp(-g)*o},step(s){return s>0?1:s<0?0:.5},rect(s){let t=Math.abs(s);return t===.5?t:t>.5?0:1},sinc(s){return s.equals(0)?1:Math.sin(s)/s},tri(s){return s=Math.abs(s),s>=1?0:1-s},nthroot(s,t){if(s instanceof Be||(s=new Be(s.toString())),t instanceof Be||(t=new Be(t.toString())),t.equals(1))return s;let e=s.divide(new Be(2)),o=new Be(1e-15),g,y,L,C=t.clone().invert(),D=t.subtract(new Be(1));do{let Z=ut.bigpow(e,D),G=C.multiply(s.divide(Z).subtract(e)).toDecimal(25);if(g=Be.create(G),L)break;e=e.add(g),G=g.toDecimal(),L=y?y===G:!1,y=G}while(g.abs().gte(o));return e},sqrt(s){s instanceof Be||(s=new Be(s));let t,e,o,g,y=0,L=!1,C=new Be(1e-20);t=s.divide(new Be(2));let D=1e3;do{if(y>D)throw new Error(`Unable to calculate square root for ${s}`);t=t.add(s.divide(t)).divide(new Be(2)),t=new Be(t.decimal(30)),e=s.subtract(t.multiply(t)),g=o?o.equals(e):!1,(e.clone().abs().lessThan(C)||g)&&(L=!0),o=e,y++}while(!L);return t}};qe.FUNCTION_MODULES.push(ut);k0(ut);sn.Math2=ut;function ft(s){return s instanceof K.classes.NerdamerSymbol}function dt(s){return s instanceof Ct}function mt(s){return s instanceof Pt}function r1(s){return s instanceof S0}var o0={get EX(){return K.groups.EX},get CP(){return K.groups.CP},get CB(){return K.groups.CB},get S(){return K.groups.S},get PL(){return K.groups.PL},get FN(){return K.groups.FN}};function n0(s,t=null,e=null){if(e||={c:[],add(o){this.c.indexOf(o)===-1&&isNaN(o)&&this.c.push(o)}},ft(s)){let{group:o}=s,g=s.previousGroup;if(o===o0.EX&&n0(s.power,t,e),o===o0.CP||o===o0.CB||g===o0.CP||g===o0.CB)for(let y in s.symbols)Object.hasOwn(s.symbols,y)&&n0(s.symbols[y],t,e);else if(o===o0.S||g===o0.S)s.value==="e"||s.value==="pi"||s.value===qe.IMAGINARY||e.add(s.value);else if(o===o0.PL||g===o0.PL)n0(J0(s.symbols),t,e);else if(o===o0.EX)isNaN(Number(s.value))||e.add(s.value),n0(s.power,t,e);else if(o===o0.FN&&!t&&s.args)for(let y=0;y<s.args.length;y++)n0(s.args[y],t,e)}return e.c.sort()}function qi(s,t,e){let o=[];s.each(g=>{let y,L;g.contains(t)?(y=g.stripVar(t),L=Mt._.divide(g.clone(),y.clone()).power.toDecimal()):(y=g,L=0);let C=o[L];o[L]=C?Mt._.add(C,y):y},!0);for(let g=0;g<o.length;g++)o[g]||=new K.classes.NerdamerSymbol(0);return o}var Xt={get _(){return K.parser},get FN(){return K.groups.FN},get P(){return K.groups.P},get N(){return K.groups.N},get NerdamerSymbol(){return K.classes.NerdamerSymbol}};function Ti(s){let t,e,o;if(s.group===Xt.FN&&s.fname===""?(t=Xt.NerdamerSymbol.unwrapPARENS(Xt._.parse(s).toLinear()),e=Xt._.parse(s.power)):s.group===Xt.P&&(t=Xt._.parse(s.value),e=Xt._.parse(s.power)),t&&e&&t.group===Xt.N&&e.group===Xt.N&&t.multiplier.isNegative()){o=[];let y=Xt.NerdamerSymbol.toPolarFormArray(wt(s))[0],L=Xt._.arg(t),C=e.multiplier.den.toString(),D=e.multiplier.num.toString(),Z="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let G=0;G<Number(C);G++){let V=wt(Xt._.parse(_t("(({0})+2*pi*({1}))/({2})",L,G,C))).multiplier.toDecimal();o.push(wt(Xt._.parse(_t(Z,y,C,qe.IMAGINARY,V,D))))}return Ct.fromArray(o)}if(s.isConstant(!0,!0)){let g=s.sign(),y=wt(s.abs()),L=Xt._.sqrt(y);o=[L.clone(),L.negate()],g<0&&(o=o.map(C=>Xt._.multiply(C,Xt.NerdamerSymbol.imaginary())))}else o=[Xt._.parse(s)];return Ct.fromArray(o)}function Ri(s,t,e){let g={},y;for(let L=0;L<e.length;L++)g[e[L]]=new K.classes.NerdamerSymbol(Math.floor(Math.random()*5)+1);return kt("PARSE2NUMBER",()=>{y=Mt._.parse(s,g).equals(Mt._.parse(t,g))}),y}function bn(s){return ft(s)?bn(s.multiplier.toDecimal()):Number(s)%1!==0}function Li(s,t){let e=new K.classes.NerdamerSymbol(0);for(let o=0;o<s.length;o++){let g=s[o];e=Mt._.add(e,ft(g)?g:Mt._.parse(g))}return t?Number(e):e}function kn(s){for(let t=0;t<s.length;t++)if(!(s[t].isPi()||s[t].isE())&&!s[t].isConstant(!0))return!1;return!0}function Ui(s,t){t||=s.length;for(let e=0;e<t;e++)s[e]||(s[e]=new K.classes.NerdamerSymbol(0));return s}function tn(s){return ft(s)?s.multiplier.lessThan(0):typeof s=="object"&&"lessThan"in s?s.lessThan(0):s<0}var E0={get _(){return K.parser},get S(){return K.groups.S},get FN(){return K.groups.FN},get EX(){return K.groups.EX},get ABS(){return K.fnNames.ABS}};function s1(s,t){s=E0._.expand(s),t||={};let e=function(o,g){t[o]||=new K.classes.NerdamerSymbol(0),t[o]=E0._.add(t[o],g.clone())};return s.each(o=>{o.isConstant("all")?e("constants",o):o.group===E0.S?e(o.value,o):o.group===E0.FN&&(o.fname===E0.ABS||o.fname==="")?s1(o.args[0]):o.group===E0.EX||o.group===E0.FN||e(n0(o).join(" "),o)}),t}var z0={get _(){return K.parser},get CP(){return K.groups.CP}};function o1(s,t,e){t=String(t);let o,g;if(s.group===z0.CP){let C=z0._.expand(s.clone()).stripVar(t);o=z0._.subtract(s.clone(),C.clone()),g=C}else o=s.clone();let y=o.stripVar(t),L=z0._.divide(o.clone(),y.clone());return g||=new K.classes.NerdamerSymbol(0),e?{a:y,x:L,ax:o,b:g}:[y,L,o,g]}function Bn(s,t,e){(t.isComposite()&&!s.isComposite()||t.isLinear()&&!s.isLinear())&&([s,t]=[t,s]);let o=new K.classes.NerdamerSymbol(0);return s.isLinear()?s.each(g=>{if(t.isComposite())t.isLinear()?t.each(y=>{let L=Mt._.multiply(Mt._.parse(g),Mt._.parse(y)),C=Mt._.expand(Mt._.parse(L),e);o=Mt._.add(o,C)},!0):o=Mt._.add(o,Mt._.multiply(g,Mt._.parse(t)));else{let y=Mt._.multiply(Mt._.parse(g),Mt._.parse(t));o=Mt._.add(o,Mt._.expand(y,e))}},!0):o=Mt._.multiply(s,t),o}function l1(s){if(Dt(s)){let t=new Ct([]);for(let e=0;e<s.length;e++)t.elements.push(l1(s[e]));return t}return ft(s)?s:Mt._.parse(s)}function Pi(s){let t=n0(s[0],null,null);for(let e=1,o=s.length;e<o;e++)t=t.concat(n0(s[e]));return t=An(t).sort(),t}function xi(s){let e="u",o=0,g=n0(s);for(;!(i0.RESERVED.indexOf(e)===-1&&g.indexOf(e)===-1);)e="u"+o++;for(let y=0,L=i0.RESERVED.length;y<=L;y++)if(!i0.RESERVED[y]){i0.RESERVED[y]=e;break}return e}var p0={get _(){return K.parser},get C(){return K.core},get USER_FUNCTIONS(){return K.state.USER_FUNCTIONS}};function On(s,t,e){if(!t){let o=typeof s;if(o==="string"){let g=s;if(!/:?=/u.test(g))return!1;let y=qe.FUNCTION_REGEX.exec(g);if(!y)return!1;let[,L,C,D]=y;s=L,t=C.split(",").map(Z=>Z.trim()),e=D}else if(o==="function"){let g=s,y=g.name;return w0(y),K0(y)?!1:(p0.C.Math2[y]=g,p0._.functions[y]=[void 0,g.length],p0.USER_FUNCTIONS.includes(y)||p0.USER_FUNCTIONS.push(y),!0)}else return!1}return s=s.trim(),w0(s),K0(s)?!1:(t||=n0(p0._.parse(e)),t=t.map(o=>o.trim()),p0._.functions[s]=[p0._.mappedFunction,t.length,{name:s,params:t,body:e}],p0.USER_FUNCTIONS.includes(s)||p0.USER_FUNCTIONS.push(s),!0)}var pn={get _(){return K.parser},get C(){return K.core},get USER_FUNCTIONS(){return K.state.USER_FUNCTIONS}};function $i(){for(let s of pn.USER_FUNCTIONS)delete pn.C.Math2[s],delete pn._.functions[s]}function Di(){let s={};for(let t in Mt._.functions)Object.hasOwn(Mt._.functions,t)&&(s[t]=Mt._.functions[t][0]);return s}var Nt={get bigInt(){return K.ext.bigInt},get isSymbol(){return K.utils.isSymbol},get isVector(){return K.utils.isVector},get N(){return K.groups.N},get P(){return K.groups.P},get S(){return K.groups.S},get FN(){return K.groups.FN},get PL(){return K.groups.PL},get CB(){return K.groups.CB},get CP(){return K.groups.CP},get EX(){return K.groups.EX},get CUSTOM_OPERATORS(){return K.state.CUSTOM_OPERATORS}};function Vt(s,t=void 0,e=void 0,o=void 0){let g=t==="hash",y,L=g?void 0:t,C=L==="decimal"||L==="decimals"||L==="decimals_or_scientific";L==="decimals_or_scientific"&&typeof o>"u"&&(o=qe.DEFAULT_DECP);function D(Z,G){switch(t){case"decimals":case"decimal":return y||=function(V){return!1},G?Z.toDecimal(G):Z.valueOf();case"recurring":{y||=function(ye){return ye.indexOf("'")!==-1};let V=Z.toString(),de=/^-?\d+(?:\/\d+)?$/u.exec(V);if(de.length===0)return V;let Ee=de[0].split("/"),Me=!1,ae=Number(Ee[0]);ae<0&&(ae=-ae,Me=!0);let ce=Number(Ee[1]);ce||=1;let ue=Math.floor(ae/ce),u=10*(ae-ue*ce);for(ue=`${ue.toString()}.`;u&&u<ce;)u*=10,ue+="0";let Ne="",Oe=[],Pe=0;for(;;){if(typeof Oe[u]<"u"){let he=Ne.slice(0,Oe[u]),Se=Ne.slice(Oe[u]),be=`${ue+he}'${Se}'`;return(Me?"-":"")+be.replace("'0'","").replace(/\.$/u,"")}let ye=Math.floor(u/ce),$e=u-ye*ce;Oe[u]=Pe,Ne+=ye.toString(),Pe+=1,u=10*$e}}case"mixed":{y||=function(Oe){return Oe.indexOf("/")!==-1};let V=Z.toString(),de=/^-?\d+(?:\/\d+)?$/u.exec(V);if(de.length===0)return V;let Ee=de[0].split("/"),Me=new Nt.bigInt(Ee[0]),ae=new Nt.bigInt(Ee[1]);ae.equals(0)&&(ae=new Nt.bigInt(1));let ce=Me.divmod(ae),{quotient:ue}=ce,{remainder:u}=ce,Ne=Ee[0][0]==="-"||ue.equals(0)||u.equals(0)?"":"+";return(ue.equals(0)?"":ue.toString())+Ne+(u.equals(0)?"":`${u.toString()}/${Ee[1]}`)}case"scientific":return y||=function(V){return!1},new D0(Z.valueOf()).toString(qe.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{y||=function(Ee){return!1};let V=Z.valueOf(),de=new D0(V);return Math.abs(de.exponent)>=qe.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?de.toString(qe.SCIENTIFIC_MAX_DECIMAL_PLACES):G?Z.toDecimal(G):V}default:return y||=function(V){return V.indexOf("/")!==-1},Z.toString()}}if(Nt.isSymbol(s)){let Z="",G="",V="",de=s.group||e,{value:Ee}=s;if(!g){let u=D(s.multiplier);String(u)==="-1"&&String(s.multiplier)==="-1"&&(V="-",u="1"),String(u)!=="1"&&(Z=u);let Ne=s.power?D(s.power):"";String(Ne)!=="1"&&(ft(Ne)?G=Vt(Ne,L):G=Ne)}switch(de){case Nt.N:{Z="";let u;L==="decimals_or_scientific"?u=D(s.multiplier,o):o&&C?u=s.multiplier.toDecimal(o):u=D(s.multiplier),Ee=String(s.multiplier)==="-1"?"1":u,G="";break}case Nt.PL:Ee=s.collectSymbols().map(u=>{let Ne=Vt(u,L,e,o);return Ne==="0"&&(Ne=""),Ne}).sort().join("+").replace(/\+-/gu,"-");break;case Nt.CP:Ee=s.collectSymbols().map(u=>{let Ne=Vt(u,L,e,o);return Ne==="0"&&(Ne=""),Ne}).sort().join("+").replace(/\+-/gu,"-");break;case Nt.CB:Ee=s.collectSymbols(u=>{let Ne=u.group;return(Ne===Nt.PL||Ne===Nt.CP)&&u.power.equals(1)&&u.multiplier.equals(1)?yt(Vt(u,L)):Vt(u,L)}).join("*");break;case Nt.EX:{let u=s.previousGroup,Ne=s.power.group;u===Nt.PL&&(Ee=s.collectSymbols(Vt,L).join("+").replace("+-","-")),!(u===Nt.N||u===Nt.S||u===Nt.FN)&&!g&&(Ee=yt(Ee)),(Ne===Nt.CP||Ne===Nt.CB||Ne===Nt.PL||s.power.multiplier.toString()!=="1")&&G&&(G=yt(G));break}}if(de===Nt.FN&&(Ee=s.fname+yt(s.args.map(u=>Vt(u,L)).join(","))),de===Nt.FN&&s.fname in Nt.CUSTOM_OPERATORS){let u=Vt(s.args[0]),Ne=Vt(s.args[1]);s.args[0].isComposite()&&(u=yt(u)),s.args[1].isComposite()&&(Ne=yt(Ne)),Ee=u+Nt.CUSTOM_OPERATORS[s.fname]+Ne}let Me=typeof y=="function"?y(G):!1;if(G&&de!==Nt.EX&&Me&&(G=yt(G)),((de===Nt.CP||de===Nt.PL)&&(Z&&String(Z)!=="1"||V==="-")||(de===Nt.CB||de===Nt.CP||de===Nt.PL)&&G&&String(G)!=="1"||!g&&de===Nt.P&&String(Ee)==="-1"||s.fname===qe.PARENTHESIS)&&(Ee=yt(Ee)),o&&(t==="decimal"||(t==="decimals"||t==="decimals_or_scientific")&&Z))if(Z.toString().includes("e")){if(t!=="decimals_or_scientific"){let u=Number(Z),Ne=u.toExponential(),Oe=u.toPrecision(o);Z=Ne.length<Oe.length?Ne:Oe}}else Z=m0(Number(Z),o);let ae=V+Z,ce=typeof y=="function"?y(Z):!1;if(Z&&ce&&(ae=yt(ae)),Number(G)<0&&(G=yt(G)),Z&&(ae=`${ae}*`),G){if(Ee==="e"&&qe.E_TO_EXP)return`${ae}exp${yt(G)}`;G=qe.POWER_OPERATOR+G}de===Nt.EX&&Ee.charAt(0)==="-"&&(Ee=yt(Ee));let ue=ae+Ee;return s.parens&&(ue=yt(ue)),ue+G}if(Nt.isVector(s)){let Z=s.elements.length,G=[];for(let V=0;V<Z;V++)G.push(s.elements[V].text(t));return`[${G.join(",")}]`}try{return s.toString()}catch(Z){if(Z.message==="timeout")throw Z;return""}}var le={get bigDec(){return K.ext.bigDec},get bigInt(){return K.ext.bigInt},get _(){return K.parser},get N(){return K.groups.N},get P(){return K.groups.P},get S(){return K.groups.S},get FN(){return K.groups.FN},get PL(){return K.groups.PL},get CB(){return K.groups.CB},get CP(){return K.groups.CP},get EX(){return K.groups.EX},get CONST_HASH(){return K.fnNames.CONST_HASH},get isSymbol(){return K.utils.isSymbol},get text(){return K.utils.text},get variables(){return K.utils.variables},get SQRT(){return K.fnNames.SQRT},get PARENTHESIS(){return K.fnNames.PARENTHESIS}},Q=class s{group;value;multiplier;power;args=void 0;fname=void 0;isImgSymbol=void 0;imaginary=void 0;isInfinity=void 0;constructor(t){en();let e=t==="Infinity";typeof t=="object"&&t!==null&&t instanceof le.bigDec&&(t=t.toString());let o=String(t);/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(o)||typeof t=="object"&&t!==null&&t instanceof le.bigDec?(this.group=le.N,this.value=le.CONST_HASH,this.multiplier=new Be(t)):(this.group=le.S,w0(t),this.value=t,this.multiplier=new Be(1),this.imaginary=t===qe.IMAGINARY,this.isInfinity=e),this.power=new Be(1)}static imaginary(){let t=new s(qe.IMAGINARY);return t.imaginary=!0,t}static infinity(t=void 0){let e=new s("Infinity");return t===-1&&e.negate(),e}static shell(t,e){let o=new s(e);return o.group=t,o.symbols={},o.length=0,o}static unwrapSQRT(t,e){let o=t.power;if(t.fname===qe.SQRT&&(t.isLinear()||e)){let g=t.args[0].clone();g.power=g.power.multiply(new Be(1/2)),g.multiplier=g.multiplier.multiply(t.multiplier),t=g,e&&(t.power=o.multiply(new Be(1/2)))}return t}static hyp(t,e){t||=new s(0),e||=new s(0);let{_:o}=le;return o.sqrt(o.add(o.pow(t.clone(),new s(2)),o.pow(e.clone(),new s(2))))}static toPolarFormArray(t){let e=t.realpart(),o=t.imagpart(),g=s.hyp(e,o),y=e.equals(0)?le._.parse("pi/2"):le._.trig.atan(le._.divide(o,e));return[g,y]}static unwrapPARENS(t){if(t.fname===""){let e=t.args[0];return e.power=e.power.multiply(t.power),e.multiplier=e.multiplier.multiply(t.multiplier),t.fname===""?s.unwrapPARENS(e):e}return t}static create(t,e){e=e===void 0?1:e;let{_:o}=le;return o.parse(`(${t})^(${e})`)}pushMinus(){let{_:t}=le,e=this;if((this.group===le.CB||this.group===le.CP||this.group===le.PL)&&this.multiplier.lessThan(0)&&!Ut(this.power)){e=this.clone();let o=e.multiplier.clone();o.negate(),e.toUnitMultiplier();for(let g in e.symbols)if(Object.hasOwn(e.symbols,g)&&(e.symbols[g]=e.symbols[g].clone().negate(),e.group===le.CB))break;e.length>0&&e.each(g=>g.pushMinus()),e=t.parse(e),e=t.multiply(t.parse(o),e)}return e}getNth(t){let{_:e}=le,o=e.parse(String(t)),g=wt(e.pow(e.parse(this.multiplier),o.clone().invert())),y=e.parse(m0(g));return wt(e.pow(y,o.clone())).equals(e.parse(this.multiplier))?y:g}isToNth(t){let{_:e}=le,o=this.getNth(t),g=pt(o.multiplier.toDecimal()),y;return this.group===le.CB?(y=!0,this.each(L=>{L.isToNth(t)||(y=!1)})):y=this.group===le.N?!0:pt(e.divide(e.parse(this.power),e.parse(t))),g&&y}isSquare(){return this.isToNth(2)}isCube(){return this.isToNth(3)}isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)}powSimp(){let{_:t}=le;if(this.group===le.CB){let e=[],o=this.multiplier.sign();if(this.each(V=>{let de=V.power;le.isSymbol(de)||de.equals(1)||e.push(de)}),e.length===0)return this.clone();let g=new Be(Mn(e)),y=this.multiplier.clone().abs(),L=ut.ifactor(y.valueOf()),C=new Be(1),D=new Be(1);for(let V in L){if(!Object.hasOwn(L,V))continue;let de=new Be(L[V]);de.lessThan(g)||(de=de.divide(g).subtract(new Be(1)),D=D.multiply(new Be(V))),C=C.multiply(t.parse(`${yt(V)}^${yt(de)}`).multiplier)}let Z=new s(D);this.each(V=>{V=V.clone(),V.power=V.power.divide(g),Z=t.multiply(Z,V)});let G=t.symfunction(le.PARENTHESIS,[Z]);return G.power=g,G.multiplier=o<0?C.negate():C,G}return this.clone()}equals(t){let e;return le.isSymbol(t)?e=t:e=new s(t),this.value===e.value&&this.power.equals(e.power)&&this.multiplier.equals(e.multiplier)&&this.group===e.group}abs(){let t=this.clone();return t.multiplier.abs(),t}gt(t){le.isSymbol(t)||(t=new s(t));let e=t;return this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)}gte(t){le.isSymbol(t)||(t=new s(t));let e=t;return this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)}lt(t){le.isSymbol(t)||(t=new s(t));let e=t;return this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)}lte(t){le.isSymbol(t)||(t=new s(t));let e=t;return this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)}isPoly(t=!1){let e=this.group,o=this.power;if(!pt(o)||Number(o)<0)return!1;if(e===le.N||e===le.S||this.isConstant(!0))return!0;let g=le.variables(this);if(e===le.CB&&g.length===1){let y=g[0];if(!y)return!0;for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let C=this.symbols[L];if(C.group===le.FN&&!C.args[0].isConstant()||!C.contains(y)&&!C.isConstant(!0))return!1}return!0}if(this.isComposite()||e===le.CB&&t){if(!t&&g.length>1)return!1;for(let y in this.symbols)if(!this.symbols[y].isPoly(t))return!1;return!0}return!1}stripVar(t,e=!1){let{_:o}=le,g;return(this.group===le.PL||this.group===le.S)&&this.value===t?g=new s(e?0:this.multiplier):this.group===le.CB&&this.isLinear()?(g=new s(1),this.each(y=>{y.contains(t,!0)||(g=o.multiply(g,y.clone()))}),g.multiplier=g.multiplier.multiply(this.multiplier)):this.group===le.CP&&!this.isLinear()?g=new s(this.multiplier):this.group===le.CP&&this.isLinear()?(g=new s(0),this.each(y=>{if(!y.contains(t)){let L=y.clone();L.multiplier=L.multiplier.multiply(this.multiplier),g=o.add(g,L)}}),g.equals(0)&&(g=new s(this.multiplier))):this.group===le.EX&&this.power.contains(t,!0)?g=new s(this.multiplier):this.group===le.FN&&this.contains(t)?g=new s(this.multiplier):g=this.clone(),g}toArray(t,e){let{_:o}=le;e||={arr:[],add(y,L){let C=this.arr[L];this.arr[L]=C?o.add(C,y):y}};let g=this.group;if(g===le.S&&this.contains(t))e.add(new s(this.multiplier),this.power);else if(g===le.CB){let y=this.stripVar(t),L=o.divide(this.clone(),y.clone()),C=L.isConstant()?0:L.power;e.add(y,C)}else if(g===le.PL&&this.value===t)this.each((y,L)=>{e.add(y.stripVar(t),L)});else if(g===le.CP)this.each(y=>{y.toArray(t,e)});else{if(this.contains(t))throw new En("Cannot convert to array! Exiting");e.add(this.clone(),0)}e=e.arr;for(let y=0;y<e.length;y++)e[y]||=new s(0);return e}hasFunc(t){let e=this.group===le.FN||this.group===le.EX;if(e&&!t||e&&this.contains(t))return!0;if(this.symbols){for(let o in this.symbols)if(this.symbols[o].hasFunc(t))return!0}return!1}sub(t,e){let{_:o}=le;t=le.isSymbol(t)?t.clone():o.parse(t),e=le.isSymbol(e)?e.clone():o.parse(e),(t.group===le.N||t.group===le.P)&&xt("Cannot substitute a number. Must be a variable");let g=!1,y=t.multiplier.equals(1),L=this.multiplier.clone(),C;if(this.value===t.value&&(this.group!==le.PL&&t.group!==le.PL||this.group===le.PL&&t.group===le.PL))(y||t.multiplier.equals(this.multiplier))&&(t.isLinear()?C=e:t.power.equals(this.power)&&(C=e,g=!0),t.multiplier.equals(this.multiplier)&&(L=new Be(1)));else if(this.group===le.CB||this.previousGroup===le.CB)C=new s(1),this.each(D=>{let Z=o.parse(D.sub(t,e));C=o.multiply(C,Z)});else if(this.isComposite()){let D=this.clone();if(t.isComposite()&&D.isComposite()&&D.isLinear()&&t.isLinear()){let Z=function(G,V){for(let de in G.symbols){if(!Object.hasOwn(G.symbols,de))continue;let Ee=G.symbols[de];if(Ee.isComposite()&&Z(Ee,V)||Ee.equals(V))return!0}return!1};for(let G in t.symbols)if(Object.hasOwn(t.symbols,G)&&!Z(D,t.symbols[G]))return D.clone();C=o.add(o.subtract(D.clone(),t),e)}else C=new s(0),D.each(Z=>{C=o.add(C,Z.sub(t,e))})}else if(this.group===le.EX)C=o.parse(this.value).sub(t,e);else if(this.group===le.FN){let D=[];for(let Z=0;Z<this.args.length;Z++){let G=this.args[Z];le.isSymbol(G)||(G=o.parse(G)),D.push(G.sub(t,e))}C=o.symfunction(this.fname,D)}if(C){if(!g){let D=this.group===le.EX?this.power.sub(t,e):o.parse(this.power);C=o.pow(C,D)}return C.multiplier=C.multiplier.multiply(L),C}return this.clone()}isMonomial(){if(this.group===le.S)return!0;if(this.group===le.CB){for(let t in this.symbols)if(this.symbols[t].group!==le.S)return!1}else return!1;return!0}isPi(){return this.group===le.S&&this.value==="pi"}sign(){return this.multiplier.sign()}isE(){return this.value==="e"}isSQRT(){return this.fname===le.SQRT}isConstant(t,e){if(e&&this.group===le.CB){for(let o in this.symbols)if(this.symbols[o].isConstant(!0))return!0}if(t==="functions"&&this.isComposite()){let o=!0;return this.each(g=>{g.isConstant(t,e)||(o=!1)},!0),o}if(t==="all"&&(this.isPi()||this.isE()))return!0;if(t&&this.group===le.FN){for(let o=0;o<this.args.length;o++)if(!this.args[o].isConstant(t))return!1;return!0}return t?q0(this):this.value===le.CONST_HASH}isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let t in this.symbols)if(this.symbols[t].isImaginary())return!0}return!1}realpart(){let{_:t}=le;if(this.isConstant())return this.clone();if(this.imaginary)return new s(0);if(this.isComposite()){let e=new s(0);return this.each(o=>{e=t.add(e,o.realpart())}),e}return this.isImaginary()?new s(0):this.clone()}imagpart(){let{_:t}=le;if(this.group===le.S&&this.isImaginary()){let e=this;return this.power.isNegative()&&(e=this.clone(),e.power.negate(),e.multiplier.negate()),new s(e.multiplier)}if(this.isComposite()){let e=new s(0);return this.each(o=>{e=t.add(e,o.imagpart())}),e}return this.group===le.CB?this.stripVar(qe.IMAGINARY):new s(0)}isInteger(){return this.isConstant()&&this.multiplier.isInteger()}isLinear(t){if(t){if(this.isConstant()||!this.contains(t,!0))return!0;if(this.group===le.S)return this.value===t?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let e in this.symbols)if(!this.symbols[e].isLinear(t))return!1;return!0}return this.group===le.CB?this.symbols[t]?this.symbols[t].isLinear(t):!0:!1}return this.power.equals(1)}containsFunction(t){if(typeof t=="string"&&(t=[t]),this.group===le.FN&&t.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let e in this.symbols)if(this.symbols[e].containsFunction(t))return!0}return!1}multiplyPower(t){let{_:e}=le;if(this.group===le.N&&this.multiplier.equals(1))return this;let o=this.power;if(this.group!==le.EX&&le.isSymbol(t)&&t.group===le.N){let g=t.multiplier;this.group===le.N&&!g.isInteger()&&this.convert(le.P),this.power=o.equals(1)?g.clone():o.multiply(g),this.group===le.P&&pt(this.power)&&(this.value=String(Number(this.value)**Number(this.power)),this.toLinear(),this.convert(le.N))}else{this.group!==le.EX&&(o=new s(o),this.convert(le.EX));let g=e.multiply(o,t);this.power=g}return this}setPower(t,e=!1){if(this.group===le.N&&this.multiplier.equals(1))return this;if(this.group===le.EX&&!le.isSymbol(t))this.group=this.previousGroup,delete this.previousGroup,this.group===le.N?(this.multiplier=new Be(this.value),this.value=le.CONST_HASH):this.power=t;else{let o=!1;le.isSymbol(t)&&(t.group===le.N?t=t.multiplier:o=!0);let g=o?le.EX:le.P;this.power=t,this.group===le.N&&g&&this.convert(g,e)}return this}isInverse(){return this.group===le.EX?this.power.multiplier.lessThan(0):Number(this.power)<0}clone(t=void 0){let e=this,o=t||new s(0),g=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],y=g.length,L;if(e.symbols){o.symbols={};for(let Z in e.symbols)Object.hasOwn(e.symbols,Z)&&(o.symbols[Z]=e.symbols[Z].clone())}for(L=0;L<y;L++)e[g[L]]!==void 0&&(o[g[L]]=e[g[L]]);o.power=e.power.clone(),o.multiplier=e.multiplier.clone();let C=e,D=o;return C.isConversion&&(D.isConversion=C.isConversion),C.isUnit&&(D.isUnit=C.isUnit),o}toUnitMultiplier(t=!1){return this.multiplier.num=new le.bigInt(this.multiplier.num.isNegative()&&t?-1:1),this.multiplier.den=new le.bigInt(1),this}toLinear(){return this.power.equals(1)?this:(this.setPower(new Be(1)),this)}each(t,e=!1){if(this.symbols)for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let g=this.symbols[o];if(g.group===le.PL&&e)for(let y in g.symbols)Object.hasOwn(g.symbols,y)&&t.call(o,g.symbols[y],y);else t.call(this,g,o)}else t.call(this,this,this.value)}valueOf(){return this.group===le.N?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:le.text(this,"decimals")}contains(t,e=!1){t=String(t);let o=this.group;if(this.value===t)return!0;if(this.symbols){for(let g in this.symbols)if(this.symbols[g].contains(t,e))return!0}if(o===le.FN||this.previousGroup===le.FN){for(let g=0;g<this.args.length;g++)if(this.args[g].contains(t,e))return!0}return o===le.EX&&(e&&this.power.contains(t,e)||this.value===t)?!0:this.value===t}negate(){return this.multiplier.negate(),(this.group===le.CP||this.group===le.PL)&&this.distributeMultiplier(),this}invert(t=!1,e=!1){return t||(this.multiplier=this.multiplier.invert()),le.isSymbol(this.power)?this.power.negate():this.group===le.CB&&e?this.each(o=>o.invert()):this.power&&this.group!==le.N&&this.power.negate(),this}distributeMultiplier(t=!1){let e=t?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&e&&this.group!==le.CB&&!this.multiplier.equals(1)){for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let g=this.symbols[o];g.multiplier=g.multiplier.multiply(this.multiplier),g.distributeMultiplier()}this.toUnitMultiplier()}return this}distributeExponent(){let{_:t}=le;if(!this.power.equals(1)){let e=this.power;for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let g=this.symbols[o];g.group===le.EX?g.power=t.multiply(g.power,new s(e)):le.isSymbol(this.symbols[o].power)?this.symbols[o].power=t.multiply(this.symbols[o].power,new s(e)):this.symbols[o].power=this.symbols[o].power.multiply(e)}this.toLinear()}return this}convert(t,e=void 0){if(t>le.FN){let o=this.clone();this.symbols={},t===le.CB?o.toUnitMultiplier():this.toUnitMultiplier(),this.group===le.FN&&(o.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[o.keyForGroup(t)]=o,this.group=t,this.length=1}else if(t===le.EX)this.group===le.N&&this.multiplier.equals(1)||(this.group!==le.EX&&(this.previousGroup=this.group),this.group===le.N?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=le.text(this,"hash"),this.group=le.EX);else if(t===le.N){let o=this.multiplier.toDecimal();this.symbols&&=void 0,new s(this.group===le.P?Number(o)*Number(this.value)**Number(this.power):o).clone(this)}else t===le.P&&this.group===le.N&&(this.value=e?this.multiplier.num.toString():String(Math.abs(Number(this.multiplier.num.toString()))),this.toUnitMultiplier(!e),this.group=le.P);return this}insert(t,e){let{_:o}=le;if(le.isSymbol(t)||xt(`Object ${t} is not of type NerdamerSymbol!`),this.symbols){let{group:g}=this;if(g>le.FN){let y=t.keyForGroup(g),L=y in this.symbols?this.symbols[y]:!1;if(e==="add"){let C=y;L?(this.symbols[C]=o.add(L,t),this.symbols[C].multiplier.equals(0)&&(delete this.symbols[C],this.length--,this.length===0&&(this.convert(le.N),this.multiplier=new Be(0)))):(this.symbols[y]=t,this.length++)}else t.group===le.P&&pt(t.power)&&t.convert(le.N),t.group===le.EX?(t.parens=t.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(t.multiplier.clone().abs()),t.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(t.multiplier),t.toUnitMultiplier()),L&&(t=o.multiply(d0(this.symbols,y),t),t.isConstant()&&(this.multiplier=this.multiplier.multiply(t.multiplier),t=new s(1)),this.length--),t.isOne(!0)?t.multiplier.lessThan(0)&&this.negate():(this.symbols[y]=t,this.length++);this.length===0&&this.convert(le.N),(this.group===le.CP||this.group===le.CB)&&this.updateHash()}}return this}attach(t){if(Dt(t)){for(let e=0;e<t.length;e++)this.insert(t[e],"add");return this}return this.insert(t,"add")}combine(t){if(Dt(t)){for(let e=0;e<t.length;e++)this.insert(t[e],"multiply");return this}return this.insert(t,"multiply")}updateHash(){if(this.group!==le.N)if(this.group===le.FN){let t="",{args:e}=this,o=this.fname===le.PARENTHESIS;for(let y=0;y<e.length;y++)t+=(y===0?"":",")+le.text(e[y]);let g=o?"":this.fname;this.value=g+(o?t:yt(t))}else this.group===le.S||this.group===le.PL||(this.value=le.text(this,"hash"))}keyForGroup(t){let e=this.group,o;if(e===le.N)o=this.value;else if(e===le.S||e===le.P)t===le.PL?o=this.power.toDecimal():o=this.value;else if(e===le.FN)t===le.PL?o=this.power.toDecimal():o=le.text(this,"hash");else{if(e===le.PL)return t===le.CB?o=le.text(this,"hash"):t===le.CP?this.power.equals(1)?o=this.value:o=yt(le.text(this,"hash"))+qe.POWER_OPERATOR+this.power.toDecimal():t===le.PL?o=this.power.toString():o=this.value,o;e===le.CP?(t===le.CP&&(o=le.text(this,"hash")),t===le.PL?o=this.power.toDecimal():o=this.value):e===le.CB?t===le.PL?o=this.power.toDecimal():o=le.text(this,"hash"):e===le.EX&&(t===le.PL?o=le.text(this.power):o=le.text(this,"hash"))}return o}collectSymbols(t,e,o,g){let y=[];if(this.symbols)for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let C=this.symbols[L];g&&(C.group===le.PL||C.group===le.CP)?y=y.concat(C.collectSymbols()):y.push(t?t(C,e):C)}else y.push(this);return o===null&&(o=void 0),y.sort(o)}collectSummandSymbols(t,e,o,g){let y=[];if(!this.symbols||this.group===le.CB)y.push(this);else for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let C=this.symbols[L];g&&(C.group===le.PL||C.group===le.CP)?y=y.concat(C.collectSymbols()):y.push(t?t(C,e):C)}return o===null&&(o=void 0),y.sort(o)}latex(t){return St.latex(this,t)}text(t=void 0){return le.text(this,t)}isOne(t=!1){let e=t?"absEquals":"equals";return this.group===le.N?this.multiplier[e](1):this.power.equals(0)}isComposite(){let t=this.group,e=this.previousGroup;return t===le.CP||t===le.PL||e===le.PL||e===le.CP}isCombination(){let t=this.group,e=this.previousGroup;return t===le.CB||e===le.CB}lessThan(t){return this.multiplier.lessThan(t)}greaterThan(t){return le.isSymbol(t)||(t=new s(t)),!this.isConstant(!0)||!t.isConstant(!0)?!1:this.multiplier.greaterThan(t.multiplier)}getDenom(){let{_:t}=le,e,o;if(o=this.clone(),this.group===le.CB&&this.power.lessThan(0)&&(o=t.expand(o)),o.power.lessThan(0)||o.group===le.EX&&o.power.multiplier.lessThan(0)){let g=t.parse(o.multiplier.den);e=o.toUnitMultiplier(),e.power.negate(),e=t.multiply(g,e)}else if(o.group===le.CB){e=t.parse(o.multiplier.den);for(let g in o.symbols){if(!Object.hasOwn(o.symbols,g))continue;let y=o.symbols[g];(Number(y.power)<0||y.group===le.EX&&y.power.multiplier.lessThan(0))&&(e=t.multiply(e,o.symbols[g].clone().invert()))}}else e=t.parse(o.multiplier.den);return e}getNum(){let{_:t}=le,e,o;return o=this.clone(),o.group===le.CB&&o.power.lessThan(0)&&(o=t.expand(o)),o.power.greaterThan(0)&&o.group!==le.CB||o.group===le.EX&&o.power.multiplier.greaterThan(0)?e=t.multiply(t.parse(o.multiplier.num),o.toUnitMultiplier()):o.group===le.CB?(e=t.parse(o.multiplier.num),o.each(g=>{(Number(g.power)>0||g.group===le.EX&&g.power.multiplier.greaterThan(0))&&(e=t.multiply(e,g.clone()))})):e=t.parse(o.multiplier.num),e}toString(){return this.text()}};K.classes.NerdamerSymbol=Q;var nn=class{constructor(){let{N:t,P:e,S:o,EX:g,FN:y,PL:L,CB:C,CP:D}=Mt,{SQRT:Z,ABS:G,FACTORIAL:V,DOUBLEFACTORIAL:de,PARENTHESIS:Ee}=Mt,{bigDec:Me,PRIMES:ae,VARS:ce}=Mt,ue=this,u=ue,Ne={},Oe={names:[],actions:[]};class Pe{upper;lower;constructor(r,l){this.upper=r,this.lower=l}isConstant(){let r=this.upper,l=this.lower;return r.isConstant()&&l.isConstant()}text(){return`${Vt(this.upper)}:${Vt(this.lower)}`}}class ye{static OPERATOR="OPERATOR";static VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL";static FUNCTION="FUNCTION";static UNIT="UNIT";static KEYWORD="KEYWORD";static MAX_PRECEDENCE=999;constructor(r,l,S){if(this.type=l,this.value=r,S!==void 0&&(this.column=S+1),l===ye.OPERATOR){let m=be[r];for(let q in m)Object.hasOwn(m,q)&&(this[q]=m[q])}else l===ye.FUNCTION&&(this.precedence=ye.MAX_PRECEDENCE,this.leftAssoc=!1)}toString(){return this.is_prefix?`\`${this.value}`:this.value}}this.classes={Collection:t0,Slice:Pe,Token:ye};let $e={prec:void 0,cos(n,r){let l=u.parse(String(Math.cos(n)*Math.cosh(r))),S=u.parse(String(Math.sin(n)*Math.sinh(r)));return u.subtract(l,u.multiply(S,Q.imaginary()))},sin(n,r){let l=u.parse(String(Math.sin(n)*Math.cosh(r))),S=u.parse(String(Math.cos(n)*Math.sinh(r)));return u.subtract(l,u.multiply(S,Q.imaginary()))},tan(n,r){let l=u.parse(String(Math.sin(2*n)/(Math.cos(2*n)+Math.cosh(2*r)))),S=u.parse(String(Math.sinh(2*r)/(Math.cos(2*n)+Math.cosh(2*r))));return u.add(l,u.multiply(S,Q.imaginary()))},sec(n,r){let l=this.removeDen(this.cos(n,r));return u.subtract(l[0],u.multiply(l[1],Q.imaginary()))},csc(n,r){let l=this.removeDen(this.sin(n,r));return u.add(l[0],u.multiply(l[1],Q.imaginary()))},cot(n,r){let l=this.removeDen(this.tan(n,r));return u.subtract(l[0],u.multiply(l[1],Q.imaginary()))},acos(n,r){let l=this.fromArray([n,r]),S=u.pow(l.clone(),new Q(2)),m=u.expand(S),q=u.multiply(Ge(u.subtract(new Q(1),m)),Q.imaginary()),E=u.expand(u.add(l.clone(),q)),_=j(E);return u.expand(u.multiply(Q.imaginary().negate(),_))},asin(n,r){return u.subtract(u.parse("pi/2"),this.acos(n,r))},atan(n,r){if(n.equals(0)&&(r.equals(1)||r.equals(-1)))return u.parse(`${Q.infinity()}*${qe.IMAGINARY}*${r}`);let l=$e.fromArray([n,r]),S=u.expand(u.multiply(Q.imaginary(),l.clone())),m=j(u.expand(u.subtract(new Q(1),S.clone()))),q=j(u.expand(u.add(new Q(1),S.clone())));return u.expand(u.multiply(u.divide(Q.imaginary(),new Q(2)),u.subtract(m,q)))},asec(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.acos(...l)},acsc(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.asin(...l)},acot(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.atan(...l)},cosh(n,r){let l=u.parse(String(Math.cosh(n)*Math.cos(r))),S=u.parse(String(Math.sinh(n)*Math.sin(r)));return u.add(l,u.multiply(S,Q.imaginary()))},sinh(n,r){let l=u.parse(String(Math.sinh(n)*Math.cos(r))),S=u.parse(String(Math.cosh(n)*Math.sin(r)));return u.add(l,u.multiply(S,Q.imaginary()))},tanh(n,r){let l=u.parse(String(Math.sinh(2*n)/(Math.cos(2*r)+Math.cosh(2*n)))),S=u.parse(String(Math.sin(2*r)/(Math.cos(2*r)+Math.cosh(2*n))));return u.subtract(l,u.multiply(S,Q.imaginary()))},sech(n,r){let l=this.removeDen(this.cosh(n,r));return u.subtract(l[0],u.multiply(l[1],Q.imaginary()))},csch(n,r){let l=this.removeDen(this.sinh(n,r));return u.subtract(l[0],u.multiply(l[1],Q.imaginary()))},coth(n,r){let l=this.removeDen(this.tanh(n,r));return u.add(l[0],u.multiply(l[1],Q.imaginary()))},acosh(n,r){let l=this.fromArray([n,r]),S=Ge(u.add(l.clone(),new Q(1))),m=Ge(u.subtract(l.clone(),new Q(1)));return u.expand(j(u.add(l,u.expand(u.multiply(S,m)))))},asinh(n,r){let l=this.fromArray([n,r]),S=Ge(u.add(new Q(1),u.expand(u.pow(l.clone(),new Q(2)))));return u.expand(j(u.add(l,S)))},atanh(n,r){let l=this.fromArray([n,r]),S=j(u.add(l.clone(),new Q(1))),m=j(u.subtract(new Q(1),l));return u.expand(u.divide(u.subtract(S,m),new Q(2)))},asech(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.acosh(...l)},acsch(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.asinh(...l)},acoth(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.atanh(...l)},sqrt(n){let r=n.realpart(),l=n.imagpart(),S=Q.hyp(r,l),m=u.add(r.clone(),S),q=Ge(u.multiply(new Q(2),m.clone()));return u.add(u.divide(m.clone(),q.clone()),u.multiply(u.divide(l,q),Q.imaginary()))},log(n,r){let l=j(Q.hyp(n,r)),S=qe.USE_BIG?new Q(Me.atan2(r.multiplier.toDecimal(),n.multiplier.toDecimal())):Math.atan2(r,n),m=u.parse(S);return u.add(l,u.multiply(Q.imaginary(),m))},erf(n,r){return u.symfunction("erf",[n])},removeDen(n){let r,l;Dt(n)?(r=n[0],l=n[1]):(r=n.realpart(),l=n.imagpart());let S=r**2+l**2,m=u.parse(String(r/S)),q=u.parse(String(l/S));return[m,q]},fromArray(n){return u.add(n[0],u.multiply(Q.imaginary(),n[1]))},evaluate(n,r){let l,S,m=n.power.sign();if(n.power=n.power.abs(),n.power.greaterThan(1)&&(n=u.expand(n)),m<0){let q=this.removeDen(n);l=q[0],S=q[1]}else l=n.realpart(),S=n.imagpart();return l.isConstant("all")&&S.isConstant("all")?this[r](l,S):u.symfunction(r,[n])}},he=this.trig={cos(n){if(n.equals("pi")&&n.multiplier.den.equals(2))return new Q(0);if(qe.PARSE2NUMBER){if(n.equals(new Q(qe.PI/2)))return new Q(0);if(n.isConstant())return qe.USE_BIG?new Q(Me.cos(n.multiplier.toDecimal())):new Q(Math.cos(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"cos")}if(n.equals(0))return new Q(1);let r,l=!1,S=$(n.multiplier.toDecimal()),m=n.multiplier.abs();if(n.multiplier=m,n.isPi()&&n.isLinear())if(pt(m))r=new Q(Ut(m)?1:-1);else{let q=Number(m.num),E=Number(m.den);E===2?r=new Q(0):E===3?(r=u.parse("1/2"),l=!0):E===4?(r=u.parse("1/sqrt(2)"),l=!0):E===6?(r=u.parse("sqrt(3)/2"),l=!0):r=u.symfunction("cos",[n])}return l&&(S===2||S===3)&&r.negate(),r||=u.symfunction("cos",[n]),r},sin(n){if(qe.PARSE2NUMBER){if(n.isConstant())return Number(n.multiplier.toDecimal())%Math.PI===0?new Q(0):qe.USE_BIG?new Q(Me.sin(n.multiplier.toDecimal())):new Q(Math.sin(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"sin")}if(n.equals(0))return new Q(0);let r,l=!1,S=$(n.multiplier.toDecimal()),m=n.multiplier.sign(),q=n.multiplier.abs();if(n.multiplier=q,n.equals("pi"))r=new Q(0);else if(n.isPi()&&n.isLinear())if(pt(q))r=new Q(0);else{let E=q.num,_=q.den;_.equals(2)?(r=new Q(1),l=!0):_.equals(3)?(r=u.parse("sqrt(3)/2"),l=!0):_.equals(4)?(r=u.parse("1/sqrt(2)"),l=!0):_.equals(6)?(r=u.parse("1/2"),l=!0):r=u.multiply(new Q(m),u.symfunction("sin",[n]))}return r||=u.multiply(new Q(m),u.symfunction("sin",[n])),l&&(S===3||S===4)&&r.negate(),r},tan(n){if(qe.PARSE2NUMBER){if(Number(n.multiplier.toDecimal())%Math.PI===0&&n.isLinear())return new Q(0);if(n.isConstant())return qe.USE_BIG?new Q(Me.tan(n.multiplier.toDecimal())):new Q(Math.tan(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"tan")}let r,l=!1,S=$(n.multiplier.toDecimal()),m=n.multiplier;if(n.multiplier=m,n.isPi()&&n.isLinear())if(pt(m))r=new Q(0);else{let q=m.num,E=m.den;if(E.equals(2))throw new Gt(`tan is undefined for ${n.toString()}`);E.equals(3)?(r=u.parse("sqrt(3)"),l=!0):E.equals(4)?(r=new Q(1),l=!0):E.equals(6)?(r=u.parse("1/sqrt(3)"),l=!0):r=u.symfunction("tan",[n])}return r||=u.symfunction("tan",[n]),l&&(S===2||S===4)&&r.negate(),r},sec(n){if(qe.PARSE2NUMBER)return n.isConstant()?qe.USE_BIG?new Q(new Me(1).dividedBy(Me.cos(n.multiplier.toDecimal()))):new Q(ut.sec(n.valueOf())):n.isImaginary()?$e.evaluate(n,"sec"):u.parse(_t("1/cos({0})",n));let r,l=!1,S=$(n.multiplier.toDecimal()),m=n.multiplier.abs();if(n.multiplier=m,n.isPi()&&n.isLinear())if(pt(m))r=new Q(Ut(m)?1:-1);else{let q=m.num,E=m.den;if(E.equals(2))throw new Gt(`sec is undefined for ${n.toString()}`);E.equals(3)?(r=new Q(2),l=!0):E.equals(4)?(r=u.parse("sqrt(2)"),l=!0):E.equals(6)?(r=u.parse("2/sqrt(3)"),l=!0):r=u.symfunction("sec",[n])}return l&&(S===2||S===3)&&r.negate(),r||=u.symfunction("sec",[n]),r},csc(n){if(qe.PARSE2NUMBER)return n.isConstant()?qe.USE_BIG?new Q(new Me(1).dividedBy(Me.sin(n.multiplier.toDecimal()))):new Q(ut.csc(n.valueOf())):n.isImaginary()?$e.evaluate(n,"csc"):u.parse(_t("1/sin({0})",n));let r,l=!1,S=$(n.multiplier.toDecimal()),m=n.multiplier.sign(),q=n.multiplier.abs();if(n.multiplier=q,n.isPi()&&n.isLinear()){if(pt(q))throw new Gt(`csc is undefined for ${n.toString()}`);{let E=q.num,_=q.den;_.equals(2)?(r=new Q(1),l=!0):_.equals(3)?(r=u.parse("2/sqrt(3)"),l=!0):_.equals(4)?(r=u.parse("sqrt(2)"),l=!0):_.equals(6)?(r=new Q(2),l=!0):r=u.multiply(new Q(m),u.symfunction("csc",[n]))}}return r||=u.multiply(new Q(m),u.symfunction("csc",[n])),l&&(S===3||S===4)&&r.negate(),r},cot(n){if(qe.PARSE2NUMBER)return Number(n.multiplier.toDecimal())%(Math.PI/2)===0?new Q(0):n.isConstant()?qe.USE_BIG?new Q(new Me(1).dividedBy(Me.tan(n.multiplier.toDecimal()))):new Q(ut.cot(n.valueOf())):n.isImaginary()?$e.evaluate(n,"cot"):u.parse(_t("1/tan({0})",n));let r,l=!1,S=$(n.multiplier.toDecimal()),m=n.multiplier;if(n.multiplier=m,n.isPi()&&n.isLinear()){if(pt(m))throw new Gt(`cot is undefined for ${n.toString()}`);{let q=m.num,E=m.den;E.equals(2)?r=new Q(0):E.equals(3)?(r=u.parse("1/sqrt(3)"),l=!0):E.equals(4)?(r=new Q(1),l=!0):E.equals(6)?(r=u.parse("sqrt(3)"),l=!0):r=u.symfunction("cot",[n])}}return r||=u.symfunction("cot",[n]),l&&(S===2||S===4)&&r.negate(),r},acos(n){if(qe.PARSE2NUMBER){if(n.isConstant()){if(n.gt(1)||n.lt(-1)){let r=n.toString();return Ae(wt(`pi/2-asin(${r})`))}return qe.USE_BIG?new Q(Me.acos(n.multiplier.toDecimal())):new Q(Math.acos(n.valueOf()))}if(n.isImaginary())return $e.evaluate(n,"acos")}return u.symfunction("acos",[n])},asin(n){if(qe.PARSE2NUMBER){if(n.isConstant()){if(n.gt(1)||n.lt(-1)){let r=qe.IMAGINARY,l=n.multiplier.toDecimal();return Ae(wt(`${r}*log(sqrt(1-${l}^2)-${r}*${l})`))}return qe.USE_BIG?new Q(Me.asin(n.multiplier.toDecimal())):new Q(Math.asin(n.valueOf()))}if(n.isImaginary())return $e.evaluate(n,"asin")}return u.symfunction("asin",[n])},atan(n){let r;if(n.equals(0))r=new Q(0);else{if(qe.PARSE2NUMBER)return n.isConstant()?qe.USE_BIG?new Q(Me.atan(n.multiplier.toDecimal())):new Q(Math.atan(n.valueOf())):n.isImaginary()?$e.evaluate(n,"atan"):u.symfunction("atan",[n]);n.equals(-1)?r=u.parse("-pi/4"):r=u.symfunction("atan",[n])}return r},asec(n){if(qe.PARSE2NUMBER){if(n.equals(0))throw new hn("Input is out of the domain of sec!");if(n.isConstant())return he.acos(n.invert());if(n.isImaginary())return $e.evaluate(n,"asec")}return u.symfunction("asec",[n])},acsc(n){if(qe.PARSE2NUMBER){if(n.isConstant())return he.asin(n.invert());if(n.isImaginary())return $e.evaluate(n,"acsc")}return u.symfunction("acsc",[n])},acot(n){if(qe.PARSE2NUMBER){if(n.isConstant())return u.add(u.parse("pi/2"),he.atan(n).negate());if(n.isImaginary())return $e.evaluate(n,"acot")}return u.symfunction("acot",[n])},atan2(n,r){if(n.equals(0)&&r.equals(0))throw new Gt("atan2 is undefined for 0, 0");return qe.PARSE2NUMBER&&n.isConstant()&&r.isConstant()?new Q(Math.atan2(n,r)):u.symfunction("atan2",[n,r])}},Se=this.trigh={cosh(n){if(qe.PARSE2NUMBER){if(n.isConstant())return new Q(Math.cosh(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"cosh")}return u.symfunction("cosh",[n])},sinh(n){if(qe.PARSE2NUMBER){if(n.isConstant())return new Q(Math.sinh(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"sinh")}return u.symfunction("sinh",[n])},tanh(n){if(qe.PARSE2NUMBER){if(n.isConstant())return new Q(Math.tanh(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"tanh")}return u.symfunction("tanh",[n])},sech(n){return qe.PARSE2NUMBER?n.isConstant()?new Q(Math.sech(n.valueOf())):n.isImaginary()?$e.evaluate(n,"sech"):u.parse(_t("1/cosh({0})",n)):u.symfunction("sech",[n])},csch(n){return qe.PARSE2NUMBER?n.isConstant()?new Q(Math.csch(n.valueOf())):n.isImaginary()?$e.evaluate(n,"csch"):u.parse(_t("1/sinh({0})",n)):u.symfunction("csch",[n])},coth(n){return qe.PARSE2NUMBER?n.isConstant()?new Q(Math.coth(n.valueOf())):n.isImaginary()?$e.evaluate(n,"coth"):u.parse(_t("1/tanh({0})",n)):u.symfunction("coth",[n])},acosh(n){let r;return qe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"acosh"):qe.PARSE2NUMBER?r=wt(u.parse(_t(`${qe.LOG}(({0})+sqrt(({0})^2-1))`,n.toString()))):r=u.symfunction("acosh",[n]),r},asinh(n){let r;return qe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"asinh"):qe.PARSE2NUMBER?r=wt(u.parse(_t(`${qe.LOG}(({0})+sqrt(({0})^2+1))`,n.toString()))):r=u.symfunction("asinh",[n]),r},atanh(n){let r;return qe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"atanh"):qe.PARSE2NUMBER?r=wt(u.parse(_t(`(1/2)*${qe.LOG}((1+({0}))/(1-({0})))`,n.toString()))):r=u.symfunction("atanh",[n]),r},asech(n){let r;return qe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"asech"):qe.PARSE2NUMBER?r=wt(j(u.add(n.clone().invert(),Ge(u.subtract(u.pow(n,new Q(-2)),new Q(1)))))):r=u.symfunction("asech",[n]),r},acsch(n){let r;return qe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"acsch"):qe.PARSE2NUMBER?r=wt(u.parse(_t(`${qe.LOG}((1+sqrt(1+({0})^2))/({0}))`,n.toString()))):r=u.symfunction("acsch",[n]),r},acoth(n){let r;if(qe.PARSE2NUMBER&&n.isImaginary())r=$e.evaluate(n,"acoth");else if(qe.PARSE2NUMBER)if(n.equals(1))r=Q.infinity();else{let l=j(u.divide(u.add(n.clone(),new Q(1)),u.subtract(n.clone(),new Q(1))));r=wt(u.divide(l,new Q(2)))}else r=u.symfunction("acoth",[n]);return r}};this.units={};let be={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(n){return n}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(n){return u.symfunction(qe.DOUBLEFACTORIAL,[n])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(n){return B(n)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(n){return u.divide(n,new Q(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},se={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},i=this.functions={cos:[he.cos,1],sin:[he.sin,1],tan:[he.tan,1],sec:[he.sec,1],csc:[he.csc,1],cot:[he.cot,1],acos:[he.acos,1],asin:[he.asin,1],atan:[he.atan,1],arccos:[he.acos,1],arcsin:[he.asin,1],arctan:[he.atan,1],asec:[he.asec,1],acsc:[he.acsc,1],acot:[he.acot,1],atan2:[he.atan2,2],acoth:[Se.acoth,1],asech:[Se.asech,1],acsch:[Se.acsch,1],sinh:[Se.sinh,1],cosh:[Se.cosh,1],tanh:[Se.tanh,1],asinh:[Se.asinh,1],sech:[Se.sech,1],csch:[Se.csch,1],coth:[Se.coth,1],acosh:[Se.acosh,1],atanh:[Se.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[ge,1],radians:[Le,1],degrees:[xe,1],min:[I,-1],max:[p,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[Ce,1],tri:[void 0,1],sign:[P,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[B,1],factorial:[B,1],continuedFraction:[te,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[H,[1,2]],scientific:[Ye,[1,2]],mod:[we,2],pfactor:[ne,1],vector:[It,-1],matrix:[bt,-1],NerdamerSet:[Ot,-1],imatrix:[ve,-1],parens:[R,-1],sqrt:[Ge,1],cbrt:[ze,1],nthroot:[J,2],log:[j,[1,2]],expand:[me,1],abs:[U,1],invert:[Bt,1],determinant:[Qt,1],size:[vt,1],transpose:[Tt,1],dot:[$t,2],cross:[qt,2],vecget:[De,2],vecset:[We,3],vectrim:[Fe,[1,2]],matget:[Qe,3],matset:[Et,4],matgetrow:[ke,2],matsetrow:[rt,3],matgetcol:[Ke,2],matsetcol:[at,3],rationalize:[Ze,1],IF:[pe,3],isIn:[Ie,2],realpart:[z,1],imagpart:[x,1],conjugate:[Y,1],arg:[X,1],polarform:[O,1],rectform:[fe,1],sort:[k,[1,2]],integer_part:[void 0,1],union:[Jt,2],contains:[Yt,2],intersection:[c0,2],difference:[r0,2],intersects:[Kt,2],isSubset:[v0,2],primes:[h,2],print:[N,-1]};this.error=xt;let a=function(n){let r=qe.FUNCTION_MODULES,l=r.length;for(let S=0;S<l;S++){let m=r[S];if(n in m)return m[n]}return xt(`The function ${n} is undefined!`)};this.override=function(r,l){Ne[r]||=[],Ne[r].push(this[r]),this[r]=l},this.restore=function(r){this[r]&&=Ne[r].pop()},this.extend=function(r,l,S){let m=this;if(typeof this[r]=="function"&&typeof l=="function"){let E=this[r];this[r]=function(W,ee){return ft(W)&&ft(ee)&&!S?E.call(m,W,ee):l.call(m,W,ee,E)}}},this.symfunction=function(r,l){let S=new Q(r);return S.group=y,typeof l=="object"&&(l=[].slice.call(l)),S.args=l,S.fname=r===Ee?"":r,S.updateHash(),S},this.callfunction=function(r,l,S=void 0){let m=i[r];m||xt(`Nerdamer currently does not support the function ${r}`);let q=m[1]||S,E=m[0],_;if(l instanceof Array||(l=l===void 0?[]:[l]),q!==-1){let ee=Dt(q),oe=ee?q[0]:q,Te=ee?q[1]:q,Ue=l.length,_e=`${r} requires a {0} of {1} arguments. {2} provided!`;Ue<oe&&xt(_t(_e,"minimum",oe,Ue)),Ue>Te&&xt(_t(_e,"maximum",Te,Ue))}let W=un(l);return E?_=E.apply(m[2],l):(E=a(r),qe.PARSE2NUMBER&&W?_=F(E.apply(E,l)):_=u.symfunction(r,l)),_},this.operator_filter_regex=(function(){let r=`^\\${Object.keys(be).filter(l=>l.length===1).join("\\")}`;return new RegExp(`([${r}])\\s+([${r}])`)})(),this.setOperator=function(r,l=void 0,S=void 0){let m=r.operator;if(be[m]=r,l&&(this[r.action]=l),ue[m]=r.operation,!r.action&&!(r.prefix||r.postif)&&(r.action=m),S==="over"||S==="under"){let{precedence:q}=r;for(let E in be){if(!Object.hasOwn(be,E))continue;let _=be[E];(S==="over"?_.precedence>=q:_.precedence>q)&&_.precedence++}}},this.getOperator=function(r){return be[r]},this.aliasOperator=function(r,l){let S={},m=be[r];for(let q in m)Object.hasOwn(m,q)&&(S[q]=m[q]);S.operator=l,this.setOperator(S)},this.getOperators=function(){return be},this.getBrackets=function(){return se};let f=function(r,l){r=String(r);for(let S=0;S<Oe.actions.length;S++)r=Oe.actions[S].call(l,r);for(r=r.replace(/\s+/gu," "),/e/giu.test(r)&&(r=r.replace(/-+\d+\.?\d*e\+?-?\d+/giu,S=>F0(S)),r=r.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,S=>F0(S))),r=r.replace(qe.IMPLIED_MULTIPLICATION_REGEX,(S,m,q,E,_)=>{let W=_.charAt(E),ee="",oe="*";return W.match(/[+\-/*]/u)||(ee=_.charAt(E-1)),ee.match(/[a-z]/iu)&&(oe=""),m+oe+q}).replace(/(?<varname>[a-z0-9_]+)/giu,(S,m)=>qe.USE_MULTICHARACTER_VARS===!1&&!(m in i)&&isNaN(m)?m.split("").join("*"):m).replace(/\)\(/gu,")*(")||"0";;){let S=r;if(r=r.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,(m,q,E,_,W)=>{let ee=q||_,oe=E||W;return ee in i?ee+oe:`${ee}*${oe}`}),S===r)break}return r};this.initConstants=function(){this.CONSTANTS={E:new Q(qe.E),PI:new Q(qe.PI)}},this.prettyPrint=function(r){if(Array.isArray(r)){let l=r,S=l.map(m=>u.prettyPrint(m)).join(", ");return l.type==="vector"?`vector<${S}>`:`(${S})`}return r.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(r,...l){if(qe.callPeekers){let S=this.peekers[r],m=l.map(T1);for(let q=0;q<S.length;q++)S[q].apply(null,m)}},this.tokenize=function(r){r=String(r),r=r.trim().replace(/\s+/gu," ");for(let tt in se){if(!Object.hasOwn(se,tt))continue;let nt=new RegExp(se[tt].is_close?`\\s+\\${tt}`:`\\${tt}\\s+`,"gu");r=r.replace(nt,tt)}let l=0,S=r.length,m=0,q=[],E=[q],_=E[0],W=0,ee=[],oe=!1,Te,Ue=" ",_e="",Ve=",",st="-",At="*",je=function(tt=void 0,nt=void 0){let it=[];tt!==void 0&&(it.type=tt),it.column=nt,E.push(it),_.push(it),_=it,W++},Re=function(){E.pop(),_=E[--W]},et=function(tt){tt=tt===void 0?l:tt;let nt=tt+1;for(;r.charAt(nt++)in be;);return r.substring(tt,nt-1)},Xe=function(tt){let nt=l-tt.length,it=[],Zt=tt.charAt(0),U0=tt.length,a0;for(a0=1;a0<U0;a0++){let C0=tt.charAt(a0),G0=Zt+C0;G0 in be?Zt=G0:(it.push(new ye(Zt,ye.OPERATOR,nt+a0)),Zt=C0)}return it.push(new ye(Zt,ye.OPERATOR,nt+a0)),it},Je=function(tt,nt=void 0){nt===void 0&&(nt=r.substring(m,tt)),nt in u.units?_.push(new ye(nt,ye.UNIT,m)):nt!==""&&_.push(new ye(nt,ye.VARIABLE_OR_LITERAL,m))},lt=function(tt){_.push(new ye(tt,ye.FUNCTION,m))},ht=function(tt){m=tt+1},ct=function(){m=m+Te.length-2,l=m-1};for(;l<S;l++){let tt=r.charAt(l);if(tt in be){Je(l);let it=_[0]&&zn(_[0])&&tt===At;oe&&m<l&&!(tt===Ve||it)&&(oe=!1,Re()),ht(l+1),Te=et(l),ct(),_.push(...Xe(Te))}else if(tt in se){let nt=se[tt];if(nt.is_open){ee.push([nt,m]);let it=r.substring(m,l);it in i?lt(it):it!==""&&_.push(new ye(it,ye.VARIABLE_OR_LITERAL,m)),je(nt.maps_to,l)}else if(nt.is_close){let it=ee.pop();if(it){if(it[0].id!==nt.id-1)throw new W0("Parity error")}else throw new W0(`Missing open bracket for bracket at: ${l+1}`);Je(l),Re()}ht(l)}else if(tt===Ue){let nt=r.substring(m,l),it=r.charAt(l+1);if(oe){if(nt in be)_.push(new ye(nt,ye.OPERATOR,l));else{Je(void 0,nt),Re();let Zt=it in be;(Zt&&be[it].value===st||!Zt)&&_.push(new ye(At,ye.OPERATOR,l))}oe=!1}else{let Zt=r.substring(m,l);Zt in i?(oe=!0,lt(Zt),je()):Zt in be?_.push(new ye(Zt,ye.OPERATOR,l)):(Je(void 0,Zt),it=r.charAt(l+1),nt!==_e&&it!==_e&&!(nt in be)&&!(it in be)&&_.push(new ye(At,ye.OPERATOR,l)))}ht(l)}}if(ee.length){let tt=ee.pop();throw new W0(`Missing closed bracket for bracket at ${tt[1]+1}`)}return Je(l),q},this.toRPN=function(r){let l=r.type,S=r.length,m,q,E=[],_=[],W=[],ee=function(Te,Ue){for(;Te.length;)Ue.push(Te.pop())};for(m=0;m<S;m++){let oe=r[m];if(oe.type!==ye.OPERATOR)break;if(!oe.prefix)throw new b0("Not a prefix operator");oe.is_prefix=!0,_.push(oe)}for(;m<S;m++){if(q=r[m],q.type===ye.OPERATOR){let oe=q;if(oe.overloaded){let Te=r[m+1];Te&&Te.type===ye.VARIABLE_OR_LITERAL&&(oe.postfix=!1,oe.action=oe.overloadAction,oe.leftAssoc=oe.overloadLeftAssoc)}for(;_.length;){let Te=_[_.length-1];if(!(Te.precedence>oe.precedence||!oe.leftAssoc&&Te.precedence===oe.precedence))break;E.push(_.pop())}if((l==="vector"||l==="set")&&"vectorFn"in oe&&(oe.action=oe.vectorFn),oe.postfix){let Te=r[m-1];if(Te){if(Te.type===ye.OPERATOR&&!Te.postfix)throw new b0(`Unexpected prefix operator '${Te.value}'! at ${Te.column}`)}else throw new b0(`Unexpected prefix operator '${q.value}'! at ${q.column}`)}else{let Te;do{let Ue=r[m+1];if(Te=Ue?Ue.type===ye.OPERATOR:!1,Te){if(!Ue.prefix)throw new b0(`A prefix operator was expected at ${Ue.column}`);Ue.is_prefix=!0,W.push(Ue),m++}}while(Te)}for(oe.is_prefix?W.push(oe):_.push(oe);W.length&&(oe.leftAssoc||!oe.leftAssoc&&W[W.length-1].precedence>=oe.precedence);)_.push(W.pop())}else if(q.type===ye.VARIABLE_OR_LITERAL){E.length===0&&ee(W,_),E.push(q);let oe=_[_.length-1];(!oe||!oe.leftAssoc)&&ee(W,E)}else q.type===ye.FUNCTION?_.push(q):q.type===ye.UNIT&&E.push(q);if(Array.isArray(q)){let oe=q;E.push(this.toRPN(q)),oe.type&&E.push(new ye(oe.type,ye.FUNCTION,oe.column))}}return ee(_,E),ee(W,E),E},this.parseRPN=function(r,l){try{l||={};for(let E in l)Object.hasOwn(l,E)&&(l[E]=u.parse(l[E],{}));qe.PARSE2NUMBER&&("e"in l||(l.e=new Q(qe.E)),"pi"in l||(l.pi=new Q(qe.PI)));let S=[],m;for(let E=0,_=r.length;E<_;E++)if(m=r[E],Array.isArray(m)&&(m=this.parseRPN(m,l)),m)if(m.type===ye.OPERATOR)if(m.is_prefix||m.postfix)S.push(m.operation(S.pop()));else{let W=S.pop(),ee=S.pop();if(typeof ee>"u")throw new b0(`${m} is not a valid postfix operator at ${m.column}`);let oe=m.action==="comma";ee instanceof g0&&!oe&&(ee=Ct.fromSet(ee)),W instanceof g0&&!oe&&(W=Ct.fromSet(W)),this.callPeekers("pre_operator",ee,W,m);let Te=u[m.action](ee,W);this.callPeekers("post_operator",Te,ee,W,m),S.push(Te)}else if(m.type===ye.FUNCTION){let W=S.pop(),{parent:ee}=W;W instanceof t0||(W=t0.create(W));let oe=m.value,Te=W.getItems();this.callPeekers("pre_function",oe,Te);let Ue=u.callfunction(oe,Te);this.callPeekers("post_function",Ue,oe,Te);let _e=S[S.length-1],Ve=r[E+1],st=Ve&&Ve.type===ye.OPERATOR&&Ve.value===",";ee&&(Ue.parent=ee),S.push(Ue)}else{let W,ee=m.value;if(ee in qe.ALIASES)m=u.parse(qe.ALIASES[m]);else if(m.type===ye.VARIABLE_OR_LITERAL)m=new Q(ee);else if(m.type===ye.UNIT){let oe=new Q(ee);oe.isUnit=!0,m=oe}ee in u.CONSTANTS?(W=m,m=new Q(u.CONSTANTS[ee])):ee in l&&ee!==l[ee].toString()?(W=m,m=l[ee].clone()):ee in ce&&(W=m,m=ce[ee].clone()),W&&(m.subbed=W),S.push(m)}let q=S[0];if(["undefined","string","number"].indexOf(typeof q)!==-1)throw new Zn("Unexpected token!");return q}catch(S){if(S.message==="timeout"||S instanceof TypeError||S instanceof ReferenceError||S instanceof RangeError)throw S;[hn].forEach(E=>{if(S instanceof E){let _=S.column;throw new E(`${S.message}${_?`: ${_}`:""}`)}});let q=S.column;throw new Gn(`${S.message}${q?`: ${q}`:""}`)}};class w{constructor(r){this.type=r.type,this.value=r.value,this.left=r.left,this.right=r.right}toString(){let r=this.left?`${this.left.toString()}---`:"",l=this.right?`---${this.right.toString()}`:"";return`${r}(${this.value})${l}`}toHTML(r,l){r||=0,l=typeof l>"u"?4:l;let S=function(W){return" ".repeat(l*W)},m="",q=this.left?`${S(r+1)}<li>
${this.left.toHTML(r+2,l)}${S(r+1)}</li> 
`:"",E=this.right?`${S(r+1)}<li>
${this.right.toHTML(r+2,l)}${S(r+1)}</li>
`:"";return m=`${S(r)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${S(r)}
`,(q||E)&&(m+=`${S(r)}<ul>
${q}${E}${S(r)}</ul>
`),m}}this.tree=function(r){let l=[];for(let S=0;S<r.length;S++){let m=r[S];if(Array.isArray(m)){m=this.tree(m),l.push(m);continue}if(m.type===ye.OPERATOR)if(m.is_prefix||m.postfix){let q=m.is_prefix?"left":"right",E=l.pop();m=new w(m),m[q]=E,l.push(m)}else m=new w(m),m.right=l.pop(),m.left=l.pop(),l.push(m);else if(m.type===ye.FUNCTION){m=new w(m);let q=l.pop();if(m.right=q,m.value==="object"){let E=l[l.length-1];if(E){for(;E.right;)E=E.right;E.right=m;continue}}l.push(m)}else l.push(new w(m))}return l[0]},this.parse=function(r,l){r=f(r,this),l||={};let S=this.tokenize(r),m=this.toRPN(S);return this.parseRPN(m,l)},this.toObject=function(r){return function S(m){let q=[];for(let E=0,_=m.length;E<_;E++){let W=m[E],ee=W.value;if(W.type===ye.VARIABLE_OR_LITERAL)q.push(new Q(ee));else if(W.type===ye.FUNCTION){E++;let oe=u.symfunction(ee,S(m[E]));oe.isConversion=!0,q.push(oe)}else W.type===ye.OPERATOR?q.push(ee):q.push(S(W))}return q}(u.tokenize(r))};let d=function(r){let l=0,S=[[]];for(let m=0,q=r.length;m<q;m++)r[m]===","?(l++,S[l]=[]):S[l].push(r[m]);return S},v=function(n){return n.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(r,l)=>l||r)},b=function(n){let r=[];for(;n.length;){let l=n.shift(),S=n[0],m=Dt(S),q=S==="-";if(l==="^"&&(S==="+"?n.shift():m&&S[0]==="+"&&S.shift(),m&&S.length===1&&n.unshift(n.shift()[0])),l==="^"&&(m&&S[0]==="-"||q)){let E=r.pop(),_=r[r.length-1],W="1";_==="*"?(r.pop(),W=r.pop()):Dt(_)&&(W=r.pop()),r.push(W,"/",E,l),m?S.shift():n.shift(),m&&S.length===1&&r.push(n.shift()[0])}else r.push(l)}return r};this.toTeX=function(r,l){l||={};let S=l.decimals===!0?"decimals":void 0,m=typeof r=="string"?this.toObject(r):r,q=[],E=typeof l.cdot>"u"?"\\cdot":l.cdot;if(m=b(m),Dt(m)){let _=[],W,ee;for(let oe=0;oe<m.length;oe++)W=m[oe],m[oe+1]==="^"?(ee=m[oe+2],_.push(`${St.braces(this.toTeX([W]))}^${St.braces(this.toTeX([ee]))}`),oe+=2):_.push(W);m=_}for(let _=0,W=m.length;_<W;_++){let ee=m[_];if(ee==="*"&&(ee=E),ft(ee))if(ee.group===y){let{fname:oe}=ee,Te;if(oe===Z)Te=`\\sqrt${St.braces(this.toTeX(ee.args))}`;else if(oe===G)Te=St.brackets(this.toTeX(ee.args),"abs");else if(oe===Ee)Te=St.brackets(this.toTeX(ee.args),"parens");else if(oe===qe.LOG10)Te=`\\${qe.LOG10_LATEX}\\left( ${this.toTeX(ee.args)}\\right)`;else if(oe===qe.LOG2)Te=`\\${qe.LOG2_LATEX}\\left( ${this.toTeX(ee.args)}\\right)`;else if(oe===qe.LOG1P)Te=`\\${_t(qe.LOG1P_LATEX,this.toTeX(ee.args))}`;else if(oe==="integrate"){let Ue=d(ee.args),_e=St.braces(this.toTeX(Ue[0])),Ve=this.toTeX(Ue[1]);Te=`\\int ${_e}\\, d${Ve}`}else if(oe==="defint"){let Ue=d(ee.args),_e=St.braces(this.toTeX(Ue[0])),Ve=this.toTeX(Ue[3]),st=this.toTeX(Ue[1]),At=this.toTeX(Ue[2]);Te=`\\int\\limits_{${st}}^{${At}} ${_e}\\, d${Ve}`}else if(oe==="diff"){let Ue=d(ee.args),_e="",Ve=St.braces(this.toTeX(Ue[0]));if(Ue.length===1){let st=[];for(let At=0;At<Ue[0].length;At++)Ue[0][At].group===3&&st.push(Ue[0][At].value);st.sort(),_e=st.length>0?`\\frac{d}{d ${st[0]}}`:"\\frac{d}{d x}"}else Ue.length===2?_e=`\\frac{d}{d ${Ue[1]}}`:_e=`\\frac{d^{${Ue[2]}}}{d ${this.toTeX(Ue[1])}^{${Ue[2]}}}`;Te=`${_e}\\left(${Ve}\\right)`}else if(oe==="sum"||oe==="product"){let Ue=[[],[],[],[]],_e=0;for(let Ve=0;Ve<ee.args.length;Ve++){if(ee.args[Ve]===","){_e++;continue}Ue[_e].push(ee.args[Ve])}Te=(oe==="sum"?"\\sum_":"\\prod_")+St.braces(`${this.toTeX(Ue[1])} = ${this.toTeX(Ue[2])}`),Te+=`^${St.braces(this.toTeX(Ue[3]))}${St.braces(this.toTeX(Ue[0]))}`}else if(oe==="limit"){let Ue=this.toTeX.bind(this),_e=u,Ve=d(ee.args).map(st=>Array.isArray(st)?_e.toTeX(st.join("")):Ue(String(st)));Te=`\\lim_${St.braces(`${Ve[1]}\\to ${Ve[2]}`)} ${St.braces(Ve[0])}`}else oe===V||oe===de?Te=this.toTeX(ee.args)+(oe===V?"!":"!!"):Te=St.latex(ee,S);q.push(Te)}else q.push(St.latex(ee,S));else Dt(ee)?q.push(St.brackets(this.toTeX(ee))):ee==="/"?q.push(St.frac(v(q.pop()),v(this.toTeX([m[++_]])))):q.push(ee)}return q.join(" ")};function R(n){return qe.PARSE2NUMBER?n:u.symfunction("parens",[n])}function U(n){if(n.isInfinity)return Q.infinity();if(n.multiplier.lessThan(0)&&n.multiplier.negate(),n.isImaginary()){let l=n.realpart(),S=n.imagpart();if(l.isConstant()&&S.isConstant())return Ge(u.add(u.pow(l,new Q(2)),u.pow(S,new Q(2))))}else{if(q0(n)||Ut(n.power))return n;if(Qn(n)&&typeof n.value=="string"&&n.value.startsWith("baseunit_"))return n}if(n.isComposite()){let l=[];n.each(m=>{l.push(m.multiplier)}),ut.QGCD.apply(null,l).lessThan(0)&&(n.multiplier=n.multiplier.multiply(new Be(-1)),n.distributeMultiplier())}let r=u.parse(n.multiplier);return n.toUnitMultiplier(),u.multiply(r,u.symfunction(G,[n]))}function B(n){let r;if(dt(n)){let l=new Ct;return n.each((S,m)=>{l.set(m-1,B(S))}),l}if(mt(n)){let l=new Pt;return n.each((S,m,q)=>{l.set(m,q,B(S))}),l}if(qe.PARSE2NUMBER&&n.isConstant())return pt(n)?r=ut.bigfactorial(n):r=ut.gamma(n.multiplier.add(new Be(1)).toDecimal()),r=F(r),r;if(n.isConstant()&&n.getDenom().equals(2)){let S=n.getNum(),m,q,E;n.multiplier.isNegative()?(E=u.subtract(S.negate(),new Q(1)).multiplier.divide(new Be(2)),m=u.pow(new Q(-4),new Q(E)).multiplier.multiply(ut.bigfactorial(E)),q=ut.bigfactorial(new Be(2).multiply(E))):(E=u.add(S,new Q(1)).multiplier.divide(new Be(2)),m=ut.bigfactorial(new Be(2).multiply(E)),q=u.pow(new Q(4),new Q(E)).multiplier.multiply(ut.bigfactorial(E)));let _=m.divide(q);return u.multiply(u.parse("sqrt(pi)"),new Q(_))}return u.symfunction(V,[n])}function te(n,r){let l=wt(n);if(l.isConstant()){let S=ut.continuedFraction(l,r),m=Ct.fromArray(S.fractions.map(q=>new Q(q)));return Ct.fromArray([new Q(S.sign),new Q(S.whole),m])}return u.symfunction("continuedFraction",[n,r])}function re(n){let r=wt(n);return r.isConstant()?new Q(ut.erf(r)):r.isImaginary()?$e.erf(n):u.symfunction("erf",[n])}function we(n,r){if(n.isConstant()&&r.isConstant()){let S=new Q(1);return S.multiplier=S.multiplier.multiply(n.multiplier.mod(r.multiplier)),S}let l=u.divide(n.clone(),r.clone());return pt(l)?new Q(0):u.symfunction("mod",[n,r])}function pe(n,r,l){return typeof n!="boolean"&&q0(n)&&(n=!!Number(n)),n?r:l}function Ie(n,r){if(mt(n)){for(let l=0,S=n.rows();l<S;l++)for(let m=0,q=n.cols();m<q;m++)if(n.elements[l][m].equals(r))return new Q(1)}else if(n.elements){for(let l=0,S=n.elements.length;l<S;l++)if(n.elements[l].equals(r))return new Q(1)}return new Q(0)}function Ce(n){return qe.PARSE2NUMBER?n.isConstant()?new Q(ut.sinc(n)):u.parse(_t("sin({0})/({0})",n)):u.symfunction("sinc",[n])}function ge(n){return n.fname===qe.LOG&&n.isLinear()?u.pow(n.args[0],Q.create(n.multiplier.toString())):u.parse(_t("e^({0})",n))}function Le(n){return u.parse(_t("({0})*pi/180",n))}function xe(n){return u.parse(_t("({0})*180/pi",n))}function He(n){let r,l,S;if(n.group===y&&n.fname===""?(r=Q.unwrapPARENS(u.parse(n).toLinear()),l=u.parse(n.power)):n.group===e&&(r=u.parse(n.value),l=u.parse(n.power)),r&&l&&r.group===t&&l.group===t){S=[];let m=Q.toPolarFormArray(n),q=u.parse(r).abs().toString(),E=X(r).toString(),_=l.multiplier.den.toString(),W=l.multiplier.num.toString(),ee="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let oe=0;oe<Number(_);oe++){let Te=wt(u.parse(_t("(({0})+2*pi*({1}))/({2})",E,oe,_))).multiplier.toDecimal();S.push(wt(u.parse(_t(ee,q,_,qe.IMAGINARY,Te,W))))}return Ct.fromArray(S)}if(n.isConstant(!0)){let m=n.sign(),q=wt(n.abs()),E=u.sqrt(q);S=[E.clone(),E.negate()],m<0&&(S=S.map(_=>u.multiply(_,Q.imaginary())))}else S=[u.parse(n)];return Ct.fromArray(S)}function Ze(n){if(n.isComposite()){let r=new Q(0),l,S,m,q,E,_,W,ee;return n.each(oe=>{l=oe.getNum(),S=oe.getDenom(),m=r.getNum(),q=r.getDenom(),E=u.multiply(S,m),_=u.multiply(l,q),W=u.expand(u.add(E,_)),ee=u.multiply(q,S),r=u.divide(W,ee)},!0),r}return n}function Ge(n){ft(n)||(n=u.parse(n));let r=u.symfunction("sqrt",[n]);if(n.group===g)return u.symfunction(Z,[n]);n.fname===""&&n.power.equals(1)&&(n=n.args[0]);let l=n.multiplier.sign()<0;if(qe.PARSE2NUMBER){if(n.isConstant()&&!l)return new Q(Me.sqrt(n.multiplier.toDecimal()));if(n.isImaginary())return $e.sqrt(n);if(n.group===o)return u.symfunction("sqrt",[n])}let S,m,q=n.isConstant();if(n.group===C&&n.isLinear()){let E=Ge(new Q(n.multiplier));for(let _ in n.symbols){if(!Object.hasOwn(n.symbols,_))continue;let W=n.symbols[_];E=u.multiply(E,Ge(W))}m=E}else if(n.fname===Z){let E=n.args[0],_=n.multiplier;E.setPower(n.power.multiply(new Be(.25))),m=E,_.equals(1)||(m=u.multiply(Ge(u.parse(_)),m))}else if(!n.power.isInteger())n.setPower(n.power.multiply(new Be(.5))),m=n;else if(Number(n.multiplier)<0&&n.group===o){let E=u.parse(n.multiplier).negate(),_=u.parse(n).toUnitMultiplier().negate();m=u.multiply(u.symfunction(qe.SQRT,[_]),Ge(E))}else{let E=n.power.sign();n.power=n.power.abs(),q&&n.multiplier.lessThan(0)&&(S=Q.imaginary(),n.multiplier=n.multiplier.abs());let _=Number(n.multiplier.toDecimal()),W=Math.abs(_),ee=Math.sqrt(W),oe;if(pt(ee))oe=new Q(ee);else if(pt(_)){let Te=ut.ifactor(_),Ue=1;for(let _e in Te){if(!Object.hasOwn(Te,_e))continue;let Ve=Te[_e],st=Ve-Ve%2;if(st){let At=Number(_e)**st;Ue*=Number(_e)**(st/2),_/=At}}oe=u.multiply(u.symfunction(Z,[new Q(_)]),new Q(Ue))}else{let Te=[new Q(n.multiplier.num),new Q(n.multiplier.den)],Ue=[new Q(1),new Q(1)],_e=[new Q(1),new Q(1)],Ve=u;for(let st=0;st<2;st++){let At=Te[st];ne(At).each(je=>{je=Q.unwrapPARENS(je);let Re=je.clone().toLinear(),et=Number(je.power),Xe=et%2,Je=(et-Xe)/2;Ue[st]=Ve.multiply(Ue[st],Ve.pow(Re,new Q(Je))),_e[st]=Ve.multiply(_e[st],Ge(Ve.pow(Re,new Q(Xe))))})}oe=u.divide(u.multiply(Ue[0],_e[0]),u.multiply(Ue[1],_e[1]))}n=n.toUnitMultiplier(!0),n.isOne()?m=n:Ut(n.power.toString())?m=u.pow(n.clone(),new Q(.5)):m=u.symfunction(Z,[n]),E<0&&m.power.negate(),oe&&(m=u.multiply(oe,m)),S&&(m=u.multiply(S,m))}return tn&&qe.PARSE2NUMBER&&m.text()!==r.text()?u.parse(m):m}function ze(n){if(!n.isConstant(!0)){let r,l=Number(n.power)/3,S=u.pow(u.parse(n.multiplier),new Q(1/3)),m=n.toUnitMultiplier();return pt(l)?r=u.pow(m.toLinear(),u.parse(String(l))):m.group===C?(r=new Q(1),m.each(q=>{r=u.multiply(r,ze(q))})):r=u.symfunction("cbrt",[m]),u.multiply(S,r)}return J(n,new Q(3))}function Ye(n,r){return n.scientific=r||10,n}function J(n,r,l=void 0,S=void 0){if(r=wt(u.parse(r)),r.equals(0))throw new Gt("Unable to calculate nthroots of zero");if(Number(n)<0&&Ut(r))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!n.isConstant(!0)){let _=[n,r];return typeof l<"u"&&_.push(new Q(l)),typeof S<"u"&&_.push(new Q(S?1:0)),u.symfunction("nthroot",_)}n.group!==t&&(n=wt(n)),typeof S>"u"&&(S=!0),l||=25;let m=n.sign(),q,E;if(m<0&&(n=U(n)),pt(n)&&r.isConstant())return Number(n)<18446744073709552e3?E=Be.create(Number(n)**(1/Number(r))):E=ut.nthroot(n,r),S?q=new Q(E):q=new Q(E.toDecimal(l)),u.multiply(new Q(m),q)}function ne(n){if(n.greaterThan(9999999999998891e26)||n.equals(-1))return n;if(n.equals(Math.PI))return new Q(Math.PI);n=wt(n.clone());let r;if(n.isConstant()){r=new Q(1);let l=n.toString();if(pt(l)){let S=ut.ifactor(l);for(let m in S){if(!Object.hasOwn(S,m))continue;let q=S[m];r=u.multiply(r,u.symfunction("parens",[new Q(m).setPower(new Be(q))]))}}else{let S=ne(new Q(n.multiplier.num)),m=ne(new Q(n.multiplier.den));r=u.multiply(u.symfunction("parens",[S]),u.symfunction("parens",[m]).invert())}}else r=u.symfunction("pfactor",[n]);return r}function z(n){return n.realpart()}function x(n){return n.imagpart()}function Y(n){let r=n.realpart(),l=n.imagpart();return u.add(r,u.multiply(l.negate(),Q.imaginary()))}function X(n){let r=n.realpart(),l=n.imagpart();return r.isConstant()&&l.isConstant()?l.equals(0)&&r.equals(1)?u.parse("0"):l.equals(1)&&r.equals(0)?u.parse("pi/2"):l.equals(0)&&r.equals(-1)?u.parse("pi"):l.equals(-1)&&r.equals(0)?u.parse("-pi/2"):l.equals(1)&&r.equals(1)?u.parse("pi/4"):l.equals(1)&&r.equals(-1)?u.parse("pi*3/4"):l.equals(-1)&&r.equals(1)?u.parse("-pi/4"):l.equals(-1)&&r.equals(-1)?u.parse("-pi*3/4"):new Q(Math.atan2(Number(l),Number(r))):u.symfunction("atan2",[l,r])}function O(n){let r=Q.toPolarFormArray(n),l=r[1],S=r[0],m=u.parse(_t("e^({0}*({1}))",qe.IMAGINARY,l));return u.multiply(S,m)}function fe(n){let r=n.clone();try{let l=o1(n,"e",!0),S=le.isSymbol(l.x.power)?l.x.power:u.parse(l.x.power),m=u.divide(S,Q.imaginary()),q=wt(he.tan(m)),E=u.pow(l.a,new Q(2)),_=q.getDenom(),W=q.getNum();return Q.hyp(W,_).equals(l.a)?u.add(_,u.multiply(Q.imaginary(),W)):r}catch(l){if(l.message==="timeout")throw l;return r}}function c(n,r){r.forEach(_=>{_.numVal=wt(_).multiplier});let l,S,m,q,E;for(;;){if(l=r.length,l<2)return r[0];S=r.pop(),m=r[l-2],(n==="min"?S.numVal<m.numVal:S.numVal>m.numVal)&&(r.pop(),r.push(S))}}function p(...n){return Q0(n)?n[0]:un(n)?new Q(Math.max.apply(null,n)):qe.SYMBOLIC_MIN_MAX&&kn(n)?c("max",n):u.symfunction("max",n)}function I(...n){return Q0(n)?n[0]:un(n)?new Q(Math.min.apply(null,n)):qe.SYMBOLIC_MIN_MAX&&kn(n)?c("min",n):u.symfunction("min",n)}function P(n){return n.isConstant(!0)?new Q(Math.sign(wt(n))):u.symfunction("sign",[n])}function k(n,r){r=r?r.toString():"asc";let l=function(m){return m.group===t?m.multiplier:m.group===y?m.fname===""?l(m.args[0]):m.fname:m.group===o?m.power:m.value},S=dt(n)?n.elements:n.collectSymbols();return new Ct(S.sort((m,q)=>{let E=l(m),_=l(q);return r==="desc"?_-E:E-_}))}function j(n,r=void 0){let l=n,S=r===void 0?void 0:r;if(l.equals(1))return new Q(0);let m;if(l.fname===Z&&l.multiplier.equals(1))return m=u.divide(j(l.args[0]),new Q(2)),l.power.sign()<0&&m.negate(),m;if(l.equals(0))throw new Gt(`${qe.LOG}(0) is undefined!`);if(l.isImaginary())return $e.evaluate(l,qe.LOG);if(l.isConstant()&&typeof S<"u"&&S.isConstant()){let q=Math.log(l),E=Math.log(S);m=new Q(q/E)}else if(l.group===g&&l.power.multiplier.lessThan(0)||l.power.toString()==="-1")l.power.negate(),m=j(l).negate();else if(l.value==="e"&&l.multiplier.equals(1)){let q=l.power;m=ft(q)?q:new Q(q)}else if(l.group===y&&l.fname==="exp"){let q=l.args[0];l.multiplier.equals(1)?m=u.multiply(q,new Q(l.power)):m=u.symfunction(qe.LOG,[l])}else if(qe.PARSE2NUMBER&&q0(l)){let q=u.parse(l),E;q.multiplier.lessThan(0)&&(q.negate(),E=u.multiply(new Q(Math.PI),new Q("i"))),m=new Q(Math.log(q.multiplier.toDecimal())),E&&(m=u.add(m,E))}else{let q;!l.power.equals(1)&&!l.contains("e")&&l.multiplier.isOne()&&(q=l.group===g?l.power:new Q(l.power),l.toLinear());let E=typeof S>"u"?[l]:[l,S];E.length>1&&Q0(E)?m=new Q(1):m=u.symfunction(qe.LOG,E),q&&(m=u.multiply(q,m))}return m}function H(n,r){typeof r=="number"&&(r=new Q(r));let l=r&&r.isConstant()||typeof r>"u";if(n.isConstant()&&l){let m,q,E;m=n,r&&r.lessThan(0)&&(r=U(r),q=Number(n).toExponential().toString().split("e"),m=q[0],E=q[1]);let _=new Q(m0(Number(m),Number(r)||0));return u.multiply(_,u.pow(new Q(10),new Q(E||0)))}let S=[n];return typeof r<"u"&&S.push(r),u.symfunction("round",S)}function $(n){let r=Number(n)%2,l;return r<0&&(r=2+r),r>=0&&r<=.5?l=1:r>.5&&r<=1?l=2:r>1&&r<=1.5?l=3:l=4,l}function F(n){if(!isFinite(n)){let l=Math.sign(n),S=new Q(String(Math.abs(n)));return S.multiplier=S.multiplier.multiply(new Be(l)),S}if(ft(n))return n;if(typeof n=="number")try{n=Be.simple(n)}catch(l){if(l.message==="timeout")throw l;n=new Be(n)}let r=new Q(0);return r.multiplier=n,r}function ie(n){let r=n.group,l;if(r===D){let S=n.getNum(),m=n.getDenom()||new Q(1),q=Number(n.power),E=new Q(1);if(Math.abs(q)===1){m.each(ee=>{ee.group===C?E=u.multiply(E,ie(ee.getDenom())):ee.power.lessThan(0)&&(E=u.multiply(E,ie(ee.clone().toUnitMultiplier())))});let _=new Q(0);m.each(ee=>{_=u.add(u.divide(ee,E.clone()),_)}),E.invert();let W;S.isComposite()?(W=new Q(0),S.each(ee=>{W=u.add(u.multiply(ie(ee),E.clone()),W)})):W=u.multiply(E,S),l=u.divide(W,_)}}else r===C?(l=new Q(1),n.each(S=>{l=u.multiply(l,u.clean(S))})):r===y&&n.args.length===1&&n.args[0].isConstant()&&(l=kt("PARSE2NUMBER",()=>u.parse(n),!0));return l||=n,l}function me(n,r){return r||={expand_denominator:!0,expand_functions:!0},Ae(n,r)}function Ae(n,r){if(Array.isArray(n))return n.map(m=>Ae(m,r));if("expand"in n&&typeof n.expand=="function")return n.expand(r);let l=n;if(r||={},l.group===y&&l.fname===""){let m=Ae(l.args[0],r),q=Ae(u.pow(m,u.parse(l.power)),r);return u.multiply(u.parse(l.multiplier),q).distributeMultiplier()}if([t,e,o].indexOf(l.group)!==-1)return l;let S=l.clone();try{let m=l.multiplier.toString(),q=Number(l.power),E=l;if(l.isComposite()&&pt(l.power)&&q>0){let _=q-1,W=new Q(0);l.each(oe=>{W=u.add(W,Ae(u.parse(oe),r))});let ee=u.parse(W);for(let oe=0;oe<_;oe++)ee=Bn(ee,W,r);E=u.multiply(u.parse(m),ee).distributeMultiplier()}else if(l.group===y&&r.expand_functions===!0){let _=[];l.args.forEach(W=>{_.push(Ae(W,r))}),E=u.pow(u.symfunction(l.fname,_),u.parse(l.power)),E=u.multiply(E,u.parse(l.multiplier))}else if(l.isComposite()&&pt(l.power)&&q<0&&r.expand_denominator===!0){let _=l.invert();E=Ae(_,r),E.invert()}else if(l.group===C){let _=function(oe){switch(oe.group){case D:return 0;case L:return 1;case C:return 2;case y:return 3;default:return 4}},W=l.collectSymbols().sort((oe,Te)=>_(Te)-_(oe)).map(oe=>{let Te=u.pow(oe,u.parse(String(q)));return Ae(Te,r)}),ee=W.pop();ee.isComposite()&&ee.isLinear()?(W.forEach(oe=>{ee=Bn(ee,oe,r)}),ee.isComposite()?(Number(ee.power)>1&&(ee=Ae(u.pow(ee,u.parse(ee.power)),r)),E=u.multiply(u.parse(m),ee).distributeMultiplier()):E=ee):(E=ee,W.forEach(oe=>{E=u.multiply(E,oe)}),E=u.multiply(E,u.parse(m)).distributeMultiplier()),E.group===C&&(E=u.parse(E))}else E=l;return E}catch(m){if(m.message==="timeout")throw m;return S}}function ve(n){return Pt.identity(n)}function De(n,r){return r.isConstant()&&pt(r)?n.elements[Number(r)]:u.symfunction("vecget",[n,r])}function Fe(n,r){return r=typeof r>"u"?1e-14:r,n=n.clone(),r=Number(r),n.elements.sort((l,S)=>S.group-l.group),n.elements=B1(n.elements,(l,S)=>Number(u.subtract(wt(l),wt(S)).abs())<=r),n}function We(n,r,l){return r.isConstant?(n.elements[Number(r)]=l,n):u.symfunction("vecset",[n,r,l])}function Qe(n,r,l){return r.isConstant()&&l.isConstant()?n.elements[Number(r)][Number(l)]:u.symfunction("matget",[n,r,l])}function ke(n,r){return r.isConstant()?Ct.fromArray(n.elements[Number(r)]):u.symfunction("matgetrow",[n,r])}function rt(n,r,l){if(!r.isConstant())return u.symfunction("matsetrow",[n,r,l]);if(n.elements[Number(r)].length!==l.elements.length)throw new gn("Matrix row must match row dimensions!");let S=n.clone();return S.elements[Number(r)]=l.clone().elements,S}function Ke(n,r){if(!r.isConstant())return u.symfunction("matgetcol",[n,r]);let l=Number(r),S=Pt.fromArray([]);return n.each((m,q,E)=>{E===l&&S.elements.push([m.clone()])}),S}function at(n,r,l){if(!r.isConstant())return u.symfunction("matsetcol",[n,r,l]);let S=Number(r);if(n.rows()!==l.elements.length)throw new gn("Matrix column length must match number of rows!");return l.each(((m,q)=>{n.set(q-1,S,m.elements[0].clone())})),n}function Et(n,r,l,S){return n.elements[r][l]=S,n}function It(...n){return new Ct(n)}function bt(...n){return Pt.fromArray(n)}function Ot(...n){return g0.fromArray(n)}function Qt(n){return mt(n)?n.determinant():n}function vt(n){let r;return mt(n)?r=[new Q(n.cols()),new Q(n.rows())]:dt(n)||Cn(n)?r=new Q(n.elements.length):xt("size expects a matrix or a vector"),r}function $t(n,r){return mt(n)&&(n=new Ct(n)),mt(r)&&(r=new Ct(r)),dt(n)&&dt(r)?n.dot(r):u.multiply(n.clone(),r.clone())}function qt(n,r){return mt(n)&&(n=new Ct(n)),mt(r)&&(r=new Ct(r)),dt(n)&&dt(r)?n.cross(r):u.multiply(n.clone(),r.clone())}function Tt(n){return mt(n)?n.transpose():xt("function transpose expects a matrix")}function Bt(n){return mt(n)?n.invert():xt("invert expects a matrix")}function Jt(n,r){return n.union(r)}function c0(n,r){return n.intersection(r)}function Yt(n,r){return n.contains(r)}function r0(n,r){return n.difference(r)}function Kt(n,r){return new Q(Number(n.intersects(r)))}function v0(n,r){return new Q(Number(n.isSubset(r)))}function h(n,r){r??=n;let l=ae.slice(n,r).map(S=>new Q(S));return l.length===1?l[0]:l.length===0?new Q(0):new Ct(l)}function N(...n){n.forEach(r=>{console.log(r.toString())})}function M(n){if(!ft(n.power)&&n.power.absEquals(.5)){let r=n.power.sign(),l=Ge(n.group===e?new Q(n.value):n.toLinear());return r<0&&l.invert(),l}return n}function A(n){if(n.group===e){let r=n.value,l=Oi(r)[0];if(!l)return _n("Unable to compute prime factors. This should not happen. Please review and report."),n;let m=new Be(Math.log(r)/Math.log(l)).multiply(n.power);if(m.den>n.power.den)return n;pt(m)?n=new Q(l**Number(m)):n=new Q(l).setPower(m)}return n}this.expand=Ae,this.round=H,this.clean=ie,this.sqrt=Ge,this.cbrt=ze,this.abs=U,this.log=j,this.rationalize=Ze,this.nthroot=J,this.arg=X,this.conjugate=Y,this.imagpart=x,this.realpart=z,this.getFunction=function(r){return i[r][0]},this.addPreprocessor=function(r,l,S,m){let{names:q}=Oe,{actions:E}=Oe;if(typeof l!="function")throw new Error("Incorrect parameters. Function expected!");S?m?(q.splice(S,0,r),E.splice(S,0,l)):(q[S]=r,E[S]=l):(q.push(r),E.push(l))},this.getPreprocessors=function(){let r={};for(let l=0,S=Oe.names.length;l<S;l++){let m=Oe.names[l];r[m]={order:l,action:Oe.actions[l]}}return r},this.removePreprocessor=function(r,l){let S=Oe.names.indexOf(r);l?(d0(Oe.names,S),d0(Oe.actions,S)):(Oe.names[S]=void 0,Oe.actions[S]=void 0)},this.mappedFunction=function(...r){let l={},{params:S}=this;for(let m=0;m<S.length;m++)l[S[m]]=String(r[m]);return u.parse(this.body,l)},this.add=function(r,l){let S=ft(r),m=ft(l);if(S&&m){let E=r,_=l;if(E.unit||_.unit)return u.Unit.add(E,_);if(E.isInfinity||_.isInfinity){let ct=E.multiplier.lessThan(0),tt=_.multiplier.lessThan(0);if(E.isInfinity&&_.isInfinity&&ct!==tt)throw new Gt(`(${E})+(${_}) is not defined!`);let nt=Q.infinity();return tt&&nt.negate(),nt}if(E.isComposite()&&E.isLinear()&&_.isComposite()&&_.isLinear()&&(E.distributeMultiplier(),_.distributeMultiplier(),_.length>E.length&&E.group===_.group&&([E,_]=[_,E])),E.multiplier.equals(0))return _;if(_.multiplier.equals(0))return E;if(E.isConstant()&&_.isConstant()&&qe.PARSE2NUMBER)return new Q(E.multiplier.add(_.multiplier).toDecimal(qe.PRECISION));let W=E.group,ee=_.group,oe=E.power.toString(),Te=_.power.toString();if(W<ee||W===ee&&Number(oe)>Number(Te)&&Number(Te)>0)return this.add(_,E);if(W===C&&ee===L&&E.value===_.value){let ct=E;E=_,_=ct,W=E.group,ee=_.group,oe=E.power.toString(),Te=_.power.toString()}let Ue=oe===Te,_e=E.value,Ve=_.value,st=E.isComposite(),At=_.isComposite(),je,Re,et;if(st&&(je=Vt(E,"hash")),At&&(Re=Vt(_,"hash")),W===D&&ee===D&&_.isLinear()&&!E.isLinear()&&je!==Re)return this.add(_,E);W===L&&ee===L&&(_e=je,Ve=Re);let Xe=W===e&&ee===t,Je=E.value===_.multiplier.toString(),lt=_e===Ve||je===Re&&je!==void 0||Xe&&Je;if(lt&&Ue&&W===ee)if(Xe&&(_=_.convert(e)),W===L&&(ee===o||ee===e))E.distributeMultiplier(),et=E.attach(_);else if(et=E,E.multiplier.isOne()&&_.multiplier.isOne()&&W===D&&E.isLinear()&&_.isLinear())for(let ct in _.symbols){if(!Object.hasOwn(_.symbols,ct))continue;let tt=_.symbols[ct];et.attach(tt)}else et.multiplier=et.multiplier.add(_.multiplier);else if(lt&&W!==L)W===D&&ee===L?(_.insert(E,"add"),et=_):(et=Q.shell(L).attach([E,_]),et.value=W===L?je:_e);else if(st&&E.isLinear()){let ct=W===ee,tt=W===L&&ee===L;if(tt&&(ct=E.value===_.value),E.distributeMultiplier(),_.isComposite()&&_.isLinear()&&ct){_.distributeMultiplier();for(let nt in _.symbols){if(!Object.hasOwn(_.symbols,nt))continue;let it=_.symbols[nt];E.attach(it)}et=E}else tt&&E.value!==Re||W===L&&!lt?(et=Q.shell(D).attach([E,_]),et.updateHash()):et=E.attach(_)}else{if(W===y&&E.fname===Z&&ee!==g&&_.power.equals(.5)){let ct=_.multiplier.clone();_=Ge(_.toUnitMultiplier().toLinear()),_.multiplier=ct}E.length===2&&_.length===2&&Ut(E.power)&&Ut(_.power)?et=u.add(Ae(E),Ae(_)):(et=Q.shell(D).attach([E,_]),et.updateHash())}et.multiplier.equals(0)&&(et=new Q(0));let ht=et;if(ht.length===1){let ct=ht.multiplier,tt=J0(ht.symbols);return tt.multiplier=tt.multiplier.multiply(ct),tt}return et}if(m&&!S){let E=r;r=l,l=E;let _=m;m=S,S=_}let q=mt(l);if(S&&q){let E=new Pt;l.eachElement((W,ee,oe)=>{E.set(ee,oe,u.add(r.clone(),W))}),l=E}else if(mt(r)&&q)l=r.add(l);else if(S&&dt(l)){let E=l;E.each((_,W)=>{W--,E.elements[W]=u.add(r.clone(),E.elements[W])})}else if(dt(r)&&dt(l)){let E=r,_=l;_.each((W,ee)=>{ee--,_.elements[ee]=u.add(E.elements[ee],_.elements[ee])})}else{if(dt(r)&&mt(l))return u.add(l,r);if(mt(r)&&dt(l)){if(l.elements.length===r.rows()){let E=new Pt,_=r.cols();return l.each((W,ee)=>{let oe=[];if(dt(W))for(let Te=0;Te<_;Te++)oe.push(u.add(r.elements[ee-1][Te].clone(),W.elements[Te].clone()));else for(let Te=0;Te<_;Te++)oe.push(u.add(r.elements[ee-1][Te].clone(),W.clone()));E.elements.push(oe)}),E}xt("Dimensions must match!")}}return l},this.subtract=function(r,l){let S=ft(r),m=ft(l),q;if(S&&m){let E=r,_=l;return E.unit||_.unit?u.Unit.subtract(E,_):this.add(E,_.negate())}if(m&&dt(r))l=r.map(E=>u.subtract(E,l.clone()));else if(S&&dt(l))l=l.map(E=>u.subtract(r.clone(),E));else if(dt(r)&&dt(l)||dn(r)&&dn(l))r.dimensions()===l.dimensions()?l=r.subtract(l):u.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(mt(r)&&dt(l)){if(l.elements.length===r.rows()){let E=new Pt,_=r.cols();return l.each((W,ee)=>{let oe=[];for(let Te=0;Te<_;Te++)oe.push(u.subtract(r.elements[ee-1][Te].clone(),W.clone()));E.elements.push(oe)}),E}xt("Dimensions must match!")}else if(dt(r)&&mt(l)){let E=l.clone().negate();return u.add(E,r)}else if(mt(r)&&mt(l))l=r.subtract(l);else if(mt(r)&&m){let E=new Pt;r.each((_,W,ee)=>{E.set(W,ee,u.subtract(_,l.clone()))}),l=E}else if(S&&mt(l)){let E=new Pt;l.each((_,W,ee)=>{E.set(W,ee,u.subtract(r.clone(),_))}),l=E}return l},this.multiply=function(r,l){let S=ft(r),m=ft(l);if(S&&l instanceof t0)return l.elements.push(r),l;if(S&&m){let _=r,W=l;if(W.isUnit){let Xe=_.clone();return _.unit=W,Xe}if(_.unit||W.unit)return u.Unit.multiply(_,W);if(_.isInfinity||W.isInfinity){if(_.equals(0)||W.equals(0))throw new Gt(`${_}*${W} is undefined!`);if(W.power.lessThan(0)){if(!_.isInfinity)return new Q(0);throw new Gt("Infinity/Infinity is not defined!")}let Xe=_.multiplier.multiply(W.multiplier).sign(),Je=Q.infinity();if(_.isConstant()||W.isConstant()||_.isInfinity&&W.isInfinity)return Xe<0&&Je.negate(),Je}if(_.multiplier.equals(0)||W.multiplier.equals(0))return new Q(0);if(_.isOne())return W.clone();if(W.isOne())return _.clone();if(_.isConstant()&&W.isConstant()&&qe.PARSE2NUMBER){let Xe,Je=_.multiplier.num.abs().toString().length,lt=_.multiplier.den.toString().length,ht=Je-lt,ct=W.multiplier.num.abs().toString().length,tt=W.multiplier.den.toString().length,nt=ct-tt,it=qe.PRECISION-5;if(ht<-it||ht>it||nt<-it||nt>it){let U0=new Me(String(_.multiplier.num)),a0=new Me(String(_.multiplier.den)),C0=new Me(String(W.multiplier.num)),G0=new Me(String(W.multiplier.den));Xe=new Q(U0.times(C0).dividedBy(a0).dividedBy(G0).toFixed())}else{let U0=new Me(_.multiplier.toDecimal()),a0=new Me(W.multiplier.toDecimal()),C0=U0.times(a0).toFixed();Xe=new Q(C0)}return Xe}if(W.group>_.group&&W.group!==D)return this.multiply(W,_);if(_.group===C&&W.group===L&&_.value===W.value){let Xe=_;_=W,W=Xe}let ee=_.group,oe=W.group,Te=W.multiplier.num,Ue=W.multiplier.den;if(ee===y&&_.fname===Z&&!W.isConstant()&&_.args[0].value===W.value&&!_.args[0].multiplier.lessThan(0)){let Xe=_.power,Je=u.parse(_.multiplier);_=u.multiply(Je,_.args[0].clone()),_.setPower(new Be(.5).multiply(Xe)),ee=_.group}else ee===y&&_.fname===Z&&_.multiplier.equals(1)&&_.power.equals(-1)&&W.isConstant()&&_.args[0].equals(W)&&(_=u.symfunction(Z,[W.clone()]),W=new Q(1));let _e=_.value,Ve=W.value,st=new Be(_.sign()),At=ee===e&&oe===t&&W.multiplier.equals(_.value),je=At?new Be(1).multiply(_.multiplier).abs():_.multiplier.multiply(W.multiplier).abs(),Re=_.clone().toUnitMultiplier();if(W=W.clone().toUnitMultiplier(!0),ee===y&&oe===y){let Xe=_.args[0].clone(),Je=W.args[0].clone();if(_.fname===Z&&W.fname===Z&&_.isLinear()&&W.isLinear()){let lt=u.divide(Xe,Je).invert();lt.gt(1)&&pt(lt)&&(Re=u.multiply(_.args[0].clone(),Ge(lt.clone())),W=new Q(1))}else if(_.fname===V&&W.fname===V&&!Xe.isConstant()&&!Je.isConstant()&&Number(W.power)<0){let lt=u.subtract(Xe.clone(),Je.clone());if(lt.isConstant()){let ht=new Q(1);if(Number(lt)<0){for(let ct=0,tt=Math.abs(Number(lt));ct<=tt;ct++){let nt=u.add(Xe.clone(),new Q(ct));ht=u.multiply(ht,nt)}Re=u.multiply(u.pow(Xe,new Q(_.power)),u.pow(ht,new Q(W.power))),W=new Q(1)}else{for(let ct=0,tt=Math.abs(Number(lt));ct<=tt;ct++){let nt=u.add(Je.clone(),new Q(ct));ht=u.multiply(ht,nt)}Re=u.multiply(u.pow(ht,new Q(_.power)),u.pow(Je,new Q(W.power))),W=new Q(1)}}}}if(_e===Ve&&ee===L&&ee===oe&&(_e=_.text("hash"),Ve=W.text("hash")),oe===g&&W.previousGroup===L&&ee===L&&(_e=Vt(_,"hash",g)),(_e===Ve||At)&&!(ee===L&&(oe===o||oe===e||oe===y))&&!(ee===L&&oe===C)){let Xe=_.power,Je=W.power,lt=ft(Xe),ht=ft(Je),ct=lt||ht;ee===L&&oe!==L&&W.previousGroup!==L&&Xe.equals(1)?(Re=new Q(0),_.each(tt=>{Re=u.add(Re,u.multiply(tt,W.clone()))},!0)):(ct?Re.power=u.add(ft(Xe)?Xe:new Q(Xe),ft(Je)?Je:new Q(Je)):ee===t?Re.power=Xe:Re.power=Xe.add(Je),Re.power.equals(0)&&(Re=Re.convert(t)),ct&&Re.convert(g),_.imaginary&&W.imaginary&&Ut(Number(Re.power)%2)&&(Re=new Q(1),je.negate()),Re.group!==g&&Re.previousGroup&&(Re.previousGroup=void 0),Re.multiplier=Re.multiplier.multiply(W.multiplier))}else if(ee===C&&_.isLinear())if(oe===C&&W.distributeExponent(),oe===C&&W.isLinear()){for(let Xe in W.symbols){if(!Object.hasOwn(W.symbols,Xe))continue;let Je=W.symbols[Xe];Re=Re.combine(Je)}Re.multiplier=Re.multiplier.multiply(W.multiplier)}else Re.combine(W);else if(ee===t)Re=W.clone().toUnitMultiplier(!0);else if(ee===C)Re.distributeExponent(),Re.combine(W);else if(!W.isOne()){let Xe=W.multiplier.clone();W.toUnitMultiplier(),Re=Q.shell(C).combine([Re,W]),Re.multiplier=Re.multiplier.multiply(Xe)}if(Re.group===e){let Xe=Math.log(Number(Re.value)),Je=Math.log(Number(Te))/Xe,lt=Math.log(Number(Ue))/Xe,ht=Number(je.num)/Number(Te),ct=Number(je.den)/Number(Ue);Je!==0&&pt(Je)&&pt(ht)&&(Re.power=Re.power.add(new Be(Je)),je.num=je.num.divide(Te)),lt!==0&&pt(lt)&&pt(ct)&&(Re.power=Re.power.subtract(new Be(lt)),je.den=je.den.divide(Ue))}if(Re.length===1){let Xe=Re.multiplier;Re=J0(Re.symbols),Re.multiplier=Re.multiplier.multiply(Xe)}let et=Re.power.toString();if(Ut(et)&&Re.fname===Z){st=st.multiply(new Be(Re.sign()));let Xe=Re.power;Re=Re.args[0],Re=u.multiply(new Q(je),u.pow(Re,new Q(Xe.divide(new Be(2))))),st.lessThan(0)&&Re.negate()}else Re.multiplier=Re.multiplier.multiply(je).multiply(st),Re.group===D&&Re.isImaginary()&&Re.distributeMultiplier();return Re.group===e&&pt(Re.power.toDecimal())&&(Re=Re.convert(t)),Re}if(m&&!S){let _=r;r=l,l=_;let W=m;m=S,S=W}let q=mt(l),E=mt(r);if(S&&q){let _=new Pt;l.eachElement((ee,oe,Te)=>{_.set(oe,Te,u.multiply(r.clone(),ee))}),l=_}else if(E&&q)l=r.multiply(l);else if(S&&dt(l)){let _=l;_.each((W,ee)=>{ee--,_.elements[ee]=u.multiply(r.clone(),_.elements[ee])})}else if(dt(r)&&dt(l)){let _=r,W=l;W.each((ee,oe)=>{oe--,W.elements[oe]=u.multiply(_.elements[oe],W.elements[oe])})}else{if(dt(r)&&mt(l))return this.multiply(l,r);if(mt(r)&&dt(l)){let _=r,W=l;if(W.elements.length===_.rows()){let ee=new Pt,oe=_.cols();return W.each((Te,Ue)=>{let _e=[];for(let Ve=0;Ve<oe;Ve++)_e.push(u.multiply(_.elements[Ue-1][Ve].clone(),Te.clone()));ee.elements.push(_e)}),ee}xt("Dimensions must match!")}}return l},this.divide=function(r,l){let S=ft(r),m=ft(l);if(S&&m){let _=r,W=l;if(_.unit||W.unit)return u.Unit.divide(_,W);let ee;if(W.equals(0))throw new yn("Division by zero not allowed!");return _.isConstant()&&W.isConstant()?(ee=_.clone(),ee.multiplier=ee.multiplier.divide(W.multiplier)):(W.invert(),ee=u.multiply(_,W)),ee}let q=dt(r),E=dt(l);if(S&&E)l=l.map(_=>u.divide(r.clone(),_));else if(q&&m)l=r.map(_=>u.divide(_,l.clone()));else if(q&&E){let _=r;_.dimensions()===l.dimensions()?l=l.map((W,ee)=>u.divide(_.elements[--ee],W)):u.error("Cannot divide vectors. Dimensions do not match!")}else{let _=mt(r),W=mt(l);if(_&&m){let ee=new Pt;r.eachElement((oe,Te,Ue)=>{ee.set(Te,Ue,u.divide(oe,l.clone()))}),l=ee}else if(S&&W){let ee=new Pt;l.eachElement((oe,Te,Ue)=>{ee.set(Te,Ue,u.divide(r.clone(),oe))}),l=ee}else if(_&&W){let ee=new Pt,oe=r,Te=l;oe.rows()===Te.rows()&&oe.cols()===Te.cols()?(oe.eachElement((Ue,_e,Ve)=>{ee.set(_e,Ve,u.divide(Ue,Te.elements[_e][Ve]))}),l=ee):u.error("Dimensions do not match!")}else if(_&&E){let ee=r,oe=l;if(ee.cols()===oe.dimensions()){let Te=new Pt;ee.eachElement((Ue,_e,Ve)=>{Te.set(_e,Ve,u.divide(Ue,oe.elements[_e].clone()))}),l=Te}else u.error("Unable to divide matrix by vector.")}}return l},this.pow=function(r,l){let S=ft(r),m=ft(l);if(S&&m){let q=r,E=l;if(q.unit||E.unit)return u.Unit.pow(q,E);if(q.group===y&&q.fname===G&&Ut(E)){let je=q.multiplier.clone(),Re=u.pow(q.args[0],E);return Re.multiplier=je,Re}if(q.isInfinity||E.isInfinity){if(q.isInfinity&&E.isInfinity)throw new Gt(`(${q})^(${E}) is undefined!`);if(q.isConstant()&&E.isInfinity){if(q.equals(0)){if(E.lessThan(0))throw new Gt("0^Infinity is undefined!");return new Q(0)}if(q.equals(1))throw new Gt(`1^${E.toString()} is undefined!`);if(E.lessThan(0))return new Q(0);if(!q.lessThan(0))return Q.infinity()}if(q.isInfinity&&E.isConstant()){if(E.equals(0))throw new Gt(`${q}^0 is undefined!`);return E.lessThan(0)?new Q(0):u.multiply(Q.infinity(),u.pow(new Q(q.sign()),E.clone()))}}let _=q.equals(0),W=E.equals(0);if(_&&W)throw new Gt("0^0 is undefined!");if(_&&E.isConstant()&&E.multiplier.greaterThan(0))return new Q(0);if(W)return new Q(1);let ee=E.isConstant(),oe=q.isConstant(),Te=E.isInteger(),Ue=q.multiplier,_e=q.clone();if(oe&&ee&&q.equals(0)&&E.lessThan(0))throw new Gt("Division by zero is not allowed!");if(qe.PARSE2NUMBER&&oe&&ee&&q.sign()<0&&mn(E)){let je=Math.PI*Number(E.multiplier.toDecimal()),Re=new Q(Math.cos(je)),et=u.multiply(Q.imaginary(),new Q(Math.sin(je)));return u.add(Re,et)}if(qe.PARSE2NUMBER&&q.isImaginary()&&ee&&pt(E)&&!E.lessThan(0)){let je,Re,et,Xe,Je,lt=q.realpart(),ht=q.imagpart();if(lt.isConstant("all")&&ht.isConstant("all"))return Je=qe.USE_BIG?new Q(rn.atan2(ht.multiplier.toDecimal(),lt.multiplier.toDecimal()).times(E.toString())):Math.atan2(Number(ht.multiplier.toDecimal()),Number(lt.multiplier.toDecimal()))*Number(E.multiplier.toDecimal()),Re=new Q(Je),je=u.pow(Q.hyp(lt,ht),E),et=u.multiply(je.clone(),u.trig.cos(Re.clone())),Xe=u.multiply(je,u.trig.sin(Re)),u.add(et,u.multiply(Q.imaginary(),Xe))}_e.toUnitMultiplier();let Ve;if(_e.group===y&&_e.fname===Z&&!ee){let je=_e.args[0];je.multiplyPower(new Q(.5)),je.multiplier.multiply(_e.multiplier),je.multiplyPower(E),_e=je}else Ve=Ue.sign(),mn(E)&&Ve<0&&(_e.negate(),_e=u.symfunction(Ee,[_e]),_e.negate()),_e.multiplyPower(E);let st,At;if(oe&&ee&&qe.PARSE2NUMBER){let je;Ve<0&&(q.negate(),E.multiplier.den.equals(2)?je=new Q(qe.IMAGINARY):pt(E.multiplier)?Ut(E.multiplier)?je=new Q(1):je=new Q(-1):Ut(E.multiplier.den)?je=u.pow(u.symfunction(Ee,[new Q(Ve)]),E.clone()):je=new Q(Ve**E.multiplier.num));let Re=Number(q.multiplier.toDecimal())**Number(E.multiplier.toDecimal());if(Re!==0||q.multiplier.equals(0))_e=new Q(Re);else{let et=new Me(q.multiplier.toDecimal()),Xe=new Me(E.multiplier.toDecimal());_e=new Q(et.pow(Xe).toFixed())}je&&(_e=u.multiply(_e,je))}else if(Te&&!Ue.equals(1)){if(E.abs().gt(qe.MAX_EXP))return E.sign()<0?new Q(0):Q.infinity();let Re=E.multiplier.toDecimal(),et=Math.sign(Number(Re)),Xe=Math.abs(Number(Re)),Je=new Be(1);Je.num=Ue.num.pow(Number(Xe)),Je.den=Ue.den.pow(Number(Xe)),et<0&&Je.invert(),_e.multiplier=_e.multiplier.multiply(Je)}else{let je=q.sign();if(E.isConstant()&&q.isConstant()&&!E.multiplier.den.equals(1)&&je<0)if(E.multiplier.den.equals(2)){let Re=new Q(qe.IMAGINARY);q.negate(),E.lessThan(0)&&(Re.negate(),E.negate()),_e=u.multiply(u.pow(q,E),Re)}else{let Re=q.clone();Re.multiplier.negate(),_e=u.pow(u.symfunction(Ee,[new Q(Ve)]),E.clone());let et=u.pow(new Q(Re.multiplier.num),E.clone()),Xe=u.pow(new Q(Re.multiplier.den),E.clone()),Je=u.divide(et,Xe);_e=u.multiply(_e,Je)}else if(qe.PARSE2NUMBER&&E.isImaginary()){let Re=E.realpart(),et=E.imagpart(),Xe=q.clone().toLinear(),Je=u.pow(Xe.clone(),Re),lt=j(Xe.clone()),ht=he.cos(u.multiply(et.clone(),lt)),ct=u.multiply(he.sin(u.multiply(et,j(Xe))),Q.imaginary());_e=u.multiply(Je,u.add(ht,ct)),_e=u.expand(u.parse(_e))}else{let Re=q.group===t&&je<0;if(st=M(new Q(Re?Number(Ue.num):Math.abs(Number(Ue.num))).setPower(E.clone())),At=M(new Q(Number(Ue.den)).setPower(E.clone()).invert()),q.imaginary)if(Te){let et=Math.sign(E),Je=U(E)%4;_e=new Q(Ut(Je)?-1:qe.IMAGINARY),(Je===0||et<0&&Je===1||et>0&&Je===3)&&_e.negate()}else{let et=l.multiplier.multiply(Be.quick(1,2)),Xe=(-1)**et.num;_e=Ut(et.den)?new Q(-1).setPower(et,!0):new Q(Xe)}if(je<0&&!Re&&_e.negate(),ee&&q.group!==g){let et=Ut(E.multiplier.den),Xe=Ut(q.power),Je=_e.power.toDecimal(),lt=Ut(Je);if(et&&Xe&&!lt){if(Je==="1"||Je==="1")typeof _e.value=="string"&&_e.value.startsWith("baseunit_")||(_e=u.symfunction(G,[_e]));else if(pt(Je))_e=u.multiply(u.symfunction(G,[_e.clone().toLinear()]),_e.clone().setPower(new Be(Number(Je)-1)));else{let ht=_e.power;_e=u.symfunction(G,[_e.toLinear()]).setPower(ht)}qe.POSITIVE_MULTIPLIERS&&_e.fname===G&&(_e=_e.args[0])}}if(E.equals(2)&&_e.group===C){let et=new Q(1);_e.each(Xe=>{et=u.multiply(et,u.pow(Xe,E))}),_e=et}}}if(_e=M(_e),st&&At&&(_e=u.multiply(_e,A(u.multiply(st,At)))),_e.fname===Z){let je=_e.group===g,Re=je?_e.power.multiplier.toString():_e.power.toString();if(Ut(Re)){let et=je?u.divide(_e.power,new Q(2)):new Q(_e.power.divide(new Be(2))),Xe=_e.multiplier;_e=u.pow(_e.args[0],et),_e.multiplier=_e.multiplier.multiply(Xe)}}else if(!qe.IGNORE_E&&_e.isE()&&_e.group===g&&_e.power.contains("pi")&&_e.power.contains(qe.IMAGINARY)&&E.group===C){let je=E.stripVar(qe.IMAGINARY);_e=u.add(he.cos(je),u.multiply(Q.imaginary(),he.sin(je)))}return _e}if(dt(r)&&m)r=r.map(q=>u.pow(q,l.clone()));else if(mt(r)&&m){let q=new Pt;r.eachElement((E,_,W)=>{q.set(_,W,u.pow(E,l.clone()))}),r=q}else if(S&&mt(l)){let q=new Pt;l.eachElement((E,_,W)=>{q.set(_,W,u.pow(r.clone(),E))}),r=q}return r},this.comma=function(r,l){return r instanceof t0||(r=t0.create(r)),r.append(l),r},this.mod=function(r,l){return we(r,l)},this.slice=function(r,l){return new Pe(r,l)},this.equals=function(r,l){return r.group!==o&&!r.isLinear()&&xt(`Cannot set equality for ${r.toString()}`),ce[r.value]=l.clone(),l},this.percent=function(r){return u.divide(r,new Q(100))},this.assign=function(r,l){if(r instanceof t0&&l instanceof t0)return r.elements.map((S,m)=>u.assign(S,l.elements[m])),Ct.fromArray(l.elements);if(r.parent){let S=r.parent;return S.elements[S.getter]=l,delete S.getter,S}if(r.group!==o)throw new jn(`Cannot complete operation. Incorrect LH value for ${r}`);return ce[r.value]=l,l},this.functionAssign=function(r,l){let S=r.elements.pop();return On(S,r.elements,l)};let T=function(r){return new Q(r===!0?1:0)};this.eq=function(r,l){return T(r.equals(l))},this.gt=function(r,l){return T(r.gt(l))},this.gte=function(r,l){return T(r.gte(l))},this.lt=function(r,l){return T(r.lt(l))},this.lte=function(r,l){return T(r.lte(l))},this.factorial=function(r){return this.symfunction(V,[r])},this.dfactorial=function(r){return this.symfunction(de,[r])}}},Fi={allSame:Q0,allNumeric:k1,arguments2Array:P1,armTimeout:t1,arrayAddSlices:D1,arrayClone:$1,arrayMax:U1,arrayMin:Mn,arrayEqual:x1,arrayUnique:An,err:xt,arrayGetVariables:Pi,arraySum:Li,block:kt,checkTimeout:en,clearU:X1,comboSort:V1,compare:Ri,convertToVector:l1,customError:Ht,customType:L1,decompose_fn:o1,disarmTimeout:n1,each:Wn,evaluate:wt,even:Ut,evenFraction:mn,fillHoles:Ui,firstObject:J0,format:_t,generatePrimes:i1,getCoeffs:qi,getU:xi,importFunctions:Di,inBrackets:yt,isArray:Dt,isCollection:dn,isExpression:r1,isFraction:bn,isInt:pt,isMatrix:mt,isNegative:tn,isNumericSymbol:q0,isPrime:$0,isReserved:K0,isSet:Cn,isSymbol:ft,isVariableSymbol:Qn,isVector:dt,keys:In,knownVariable:F1,nroots:Ti,remove:d0,reserveNames:k0,range:q1,round:m0,sameSign:O1,scientificToDecimal:F0,separate:s1,stringReplace:R1,text:Vt,validateName:w0,variables:n0,warn:_n};function ki(){return(function(t,e,o,g){t1();try{let y=K.parser,L=K.state.EXPRESSIONS,C=!1;if((typeof t=="string"||typeof t=="function")&&On(t))return K.libExports;t!==null&&typeof t=="object"&&t instanceof S0&&(t=t.toString()),t!==null&&typeof t=="object"&&"text"in t&&typeof t.text=="function"&&(t=t.text()),Dt(o)||(o=typeof o>"u"?[]:[o]),o.forEach(G=>{if(G==="numer"){C=!0;return}let V=y.functions[G];V&&V[1]===1&&(t=`${G}(${t})`)});let D=kt("PARSE2NUMBER",()=>y.parse(t,e),C||qe.PARSE2NUMBER),Z=new S0(D);return g?L[g-1]=Z:L.push(Z),Z}finally{n1()}})}function Bi(){let s=K.parser;return{groups:M1,NerdamerSymbol:Q,Expression:S0,Collection:t0,Frac:Be,Vector:Ct,Matrix:Pt,NerdamerSet:g0,Math2:ut,LaTeX:St,Build:e0,Utils:Fi,PARSER:s,Settings:qe,bigInt:Nn,bigDec:rn,exceptions:K.exceptions,Solve:{},Calculus:{},Algebra:{},Extra:{}}}function Vi(){let s=K.parser;k0(s.CONSTANTS),k0(s.functions),s.initConstants(),s.error||=xt,qe.LOG_FNS={log:s.functions.log,log10:s.functions.log10}}function Xi(s){s.rpn=pi,s.convertToLaTeX=si,s.convertFromLaTeX=wi,s.version=J1,s.getWarnings=G1,s.setConstant=Mi,s.getConstant=ni,s.clearConstants=Ni,s.setFunction=Ci,s.clearFunctions=vi,s.getCore=Y1,s.getExpression=s.getEquation=S0.getExpression,s.reserved=Q1,s.clear=Kn,s.flush=yi,s.expressions=mi,s.functions=di,s.register=e1,s.validateName=w0,s.validVarName=W1,s.supported=ei,s.numEquations=s.numExpressions=j1,s.setVar=Ai,s.getVar=ii,s.clearVars=Si,s.load=Ei,s.getVars=ri,s.set=Sn,s.get=z1,s.updateAPI=Ii,s.replaceFunction=gi,s.setOperator=ai,s.getOperator=oi,s.aliasOperator=li,s.tree=Yn,s.htmlTree=hi,s.addPeeker=ui,s.removePeeker=ci,s.parse=fi}var Gi=(function(){let t=new nn;K.parser=t,K.classes.Parser=nn,St.initParser(),e0.initDependencies(),Vi();let e=Bi();K.core=e,K.classes.Math2=e.Math2,K.utils.symfunction=t.symfunction.bind(t),K.utils.callfunction=t.callfunction.bind(t),K.state.CONSTANTS=t.CONSTANTS;let o=ki();return K.libExports=o,Xi(o),o.updateAPI(),o})();typeof vn<"u"&&(vn.exports=Gi)});var V0=f0((Ji,a1)=>{"use strict";var B0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof a1<"u"&&B0===void 0&&(B0=T0(),X0());(function(){let t=B0.getCore(),e=t.PARSER,{Frac:o}=t,{Settings:g}=t,{isSymbol:y}=t.Utils,{FN:L}=t.groups,{NerdamerSymbol:C}=t,{text:D}=t.Utils,{inBrackets:Z}=t.Utils,{isInt:G}=t.Utils,{format:V}=t.Utils,{even:de}=t.Utils,{evaluate:Ee}=t.Utils,{N:Me}=t.groups,{S:ae}=t.groups,{PL:ce}=t.groups,{CP:ue}=t.groups,{CB:u}=t.groups,{EX:Ne}=t.groups,{P:Oe}=t.groups,{LOG:Pe}=g,ye="exp",$e="abs",he="sqrt",Se="sin",be="cos",se="tan",i="sec",a="csc",f="cot",w="asin",d="acos",v="atan",b="asec",R="acsc",U="acot",B="sinh",te="cosh",re="tanh",we="csch",pe="sech",Ie="coth",Ce="asech",ge="acsch",Le="acoth";function xe(ne){this.message=ne||""}xe.prototype=new Error,C.prototype.hasIntegral=function(){return this.containsFunction("integrate")},C.prototype.fnTransform=function(){if(this.group!==L)return this;let z,x=this.args[0],Y=new C(this.multiplier),X=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case B:z=e.parse(V("(e^({0})-e^(-({0})))/2",x));break;case te:z=e.parse(V("(e^({0})+e^(-({0})))/2",x));break;case re:z=e.parse(V("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",x));break;case se:z=e.parse(V("sin({0})/cos({0})",x));break;case a:z=e.parse(V("1/sin({0})",x));break;case i:z=e.parse(V("1/cos({0})",x));break;default:z=X}else if(this.power.equals(2))switch(this.fname){case Se:z=e.parse(V("1/2-cos(2*({0}))/2",x));break;case be:z=e.parse(V("1/2+cos(2*({0}))/2",x));break;case se:z=e.parse(V("sin({0})^2/cos({0})^2",x));break;case te:z=e.parse(V("1/2+cosh(2*({0}))/2",x));break;case B:z=e.parse(V("-1/2+cosh(2*({0}))/2",x));break;case re:z=e.parse(V("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",x));break;case i:z=e.parse(V("(1-cos(2*({0})))/(1+cos(2*({0})))+1",x));break;default:z=X}else if(this.fname===i)z=e.parse(V("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===a)z=e.parse(V("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===se)this.power.lessThan(0)?z=e.parse(V("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):z=e.parse(V("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===Se&&this.power.lessThan(0))z=e.parse(V("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===be&&this.power.lessThan(0))z=e.parse(V("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===Se&&this.power.equals(3))z=e.parse(V("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===be&&this.power.equals(3))z=e.parse(V("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===be||this.fname===Se)&&de(this.power)){let O=this.power/2,fe=e.pow(this.clone().toLinear(),e.parse(2)).fnTransform(),c=e.expand(e.pow(fe,e.parse(O)));z=new C(0),c.each(p=>{let I=p.fnTransform();z=e.add(z,I)},!0)}else z=X;return e.multiply(z,Y)},C.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===ae)return!1;if(this.fname&&(t.Utils.inTrig(this.fname)||t.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let z in this.symbols)if(this.symbols[z].hasTrig())return!0}return!1},t.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},t.Utils.toCommonDenominator=function(z){if(z.isComposite()&&z.isLinear()){let x=new C(z.multiplier),Y=new C(1),X=new C(0);return z.each(fe=>{Y=e.multiply(Y,fe.getDenom())},!0),z.each(fe=>{let c=fe.getNum(),p=fe.getDenom(),I=e.multiply(c,e.divide(Y.clone(),p));X=e.add(X,I)}),e.multiply(x,t.Algebra.divide(e.expand(X),e.expand(Y)))}return z},t.Utils.inInverseTrig=function(z){return[w,d,v,R,b,U].indexOf(z)!==-1},t.Utils.inTrig=function(z){return[be,Se,se,i,a,f].indexOf(z)!==-1},t.Utils.inHtrig=function(z){return[B,te,re,ge,Ce,Le].indexOf(z)!==-1},t.Matrix.jacobian=function(z,x){let Y=new t.Matrix;return x||=t.Utils.arrayGetVariables(z),x.forEach((X,O)=>{z.forEach((fe,c)=>{let p=t.Calculus.diff(fe.clone(),X);Y.set(c,O,p)})}),Y},t.Matrix.prototype.max=function(){let z=new C(0);return this.each(x=>{let Y=x.abs();Y.gt(z)&&(z=Y)}),z},t.Matrix.cMatrix=function(z,x){let Y=new t.Matrix;return x.forEach((X,O)=>{Y.set(O,0,e.parse(z))}),Y};let He=t.Utils.allFunctions=function(z){for(let x=0,Y=z.length;x<Y;x++)if(z[x].group!==L)return!1;return!0},Ze=t.Utils.cosAsinBtranform=function(z,x){let Y=z.args[0],X=x.args[0];return e.parse(V("(sin(({0})+({1}))-sin(({0})-({1})))/2",Y,X))},Ge=t.Utils.cosAsinAtranform=function(z,x){if(Number(x.power)!==1)return e.multiply(z,x);let Y=z.args[0];return e.parse(V("(sin(2*({0})))/2",Y))},ze=t.Utils.cosAsinBtranform=function(z,x){let Y=z.args[0],X=x.args[0];return e.parse(V("(cos(({0})+({1}))-cos(({0})-({1})))/2",Y,X))},Ye=t.Utils.trigTransform=function(z){let x={},Y,X,O=new C(1);for(let fe=0,c=z.length;fe<c;fe++)if(Y=z[fe],Y.group===L){let{fname:p}=Y;p===be&&x[Se]?(x[Se].args[0].toString()===Y.args[0].toString()?X=Ge(Y,x[Se]):X=Ze(Y,x[Se]),delete x[Se],O=e.multiply(O,X)):p===Se&&x[be]?(x[be].args[0].toString()===Y.args[0].toString()?X=Ge(Y,x[be]):X=Ze(Y,x[be]),delete x[be],O=e.multiply(O,X)):p===Se&&x[Se]?(x[Se].args[0].toString()===Y.args[0].toString()?(X=e.multiply(Y,x[Se]),delete x[Se]):(X=ze(Y,x[Se]),delete x[Se]),O=X):x[p]=Y}else O=e.multiply(O,Y);for(let fe in x)Object.hasOwn(x,fe)&&(O=e.multiply(O,x[fe]));return O};t.Settings.integration_depth=10,t.Settings.max_lim_depth=10;let J=t.Calculus={version:"1.4.6",sum(ne,z,x,Y){if(z.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${D(z)} provided`);z=z.value;let X;if(t.Utils.isNumericSymbol(x)&&t.Utils.isNumericSymbol(Y)){let O=Y-x<200?"":"PARSE2NUMBER";x=Number(x),Y=Number(Y),X=t.Utils.block(O,()=>{let fe=ne.text(),c={"~":!0},p=new t.NerdamerSymbol(0);for(let I=x;I<=Y;I++){c[z]=new C(I);let P=e.parse(fe,c);p=e.add(p,P)}return p})}else X=e.symfunction("sum",[ne,z,x,Y]);return X},product(ne,z,x,Y){if(z.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${D(z)} provided`);z=z.value;let X;if(t.Utils.isNumericSymbol(x)&&t.Utils.isNumericSymbol(Y)){let O=Y-x<200?"":"PARSE2NUMBER";X=t.Utils.block(O,()=>{x=Number(x),Y=Number(Y.multiplier);let fe=ne.text(),c={},p=new t.NerdamerSymbol(1);for(let I=x;I<=Y;I++)c[z]=new C(I),p=e.multiply(p,e.parse(fe,c));return p})}else X=e.symfunction("product",[ne,z,x,Y]);return X},diff(ne,z,x){if(t.Utils.isVector(ne)){let p=new t.Vector([]);return ne.each(I=>{p.elements.push(J.diff(I,z,x))}),p}if(t.Utils.isMatrix(ne)){let p=new t.Matrix;return ne.each((I,P,k)=>{p.set(P,k,J.diff(I,z,x))}),p}if(ne.LHS&&ne.RHS)return new t.Equation(J.diff(ne.LHS.clone(),z,x),J.diff(ne.RHS.clone(),z,x));let Y=y(z)?z.text():z;if(x=y(x)?x.multiplier:x||1,Y===void 0&&(Y=t.Utils.variables(ne)[0]),ne.group===L&&ne.fname===he){let p=ne.args[0],I=ne.power.clone();(p.group!==Me||p.group!==Oe)&&(p.power=y(p.power)?e.multiply(p.power,e.multiply(new C(1/2)),I):p.power.multiply(new o(.5)).multiply(I),p.multiplier=p.multiplier.multiply(ne.multiplier)),ne=p}if(ne.group===L&&!y(ne.power)){let p=O(e.parse(ne)),I=J.diff(ne.args[0].clone(),Y);ne=e.multiply(p,I)}else ne=O(ne);return x>1&&(x--,ne=J.diff(ne,z,x)),ne;function X(p){return(p.value===Y||p.contains(Y,!0))&&(p.multiplier=p.multiplier.multiply(p.power),p.power=p.power.subtract(new o(1)),p.power.equals(0)&&(p=new C(p.multiplier))),p}function O(p){let I=p.group,P,k,j;if(I===Me||I===ae&&p.value!==Y||I===Oe)p=new C(0);else if(I===ae)p=X(p);else if(I===u){let H=p.multiplier.clone();p.toUnitMultiplier();let $=e.multiply(c(p),X(p));return $.multiplier=$.multiplier.multiply(H),$}else if(I===L&&p.power.equals(1)){let H=p.multiplier.clone();switch(p.toUnitMultiplier(),p.fname){case Pe:j=p.clone(),p=p.args[0].clone(),p.power=p.power.negate(),p.multiplier=j.multiplier.divide(p.multiplier);break;case be:p.fname=Se,p.multiplier.negate();break;case Se:p.fname=be;break;case se:p.fname=i,p.power=new o(2);break;case i:p=fe(p,se);break;case a:p=fe(p,"-cot");break;case f:p.fname=a,p.multiplier.negate(),p.power=new o(2);break;case w:p=e.parse(`(sqrt(1-(${D(p.args[0])})^2))^(-1)`);break;case d:p=e.parse(`-(sqrt(1-(${D(p.args[0])})^2))^(-1)`);break;case v:p=e.parse(`(1+(${D(p.args[0])})^2)^(-1)`);break;case $e:k=p.args[0].clone(),k.toUnitMultiplier(),p=e.parse(`${Z(D(p.args[0]))}/abs${Z(D(k))}`);break;case"parens":p=new C(1);break;case"cosh":p.fname="sinh";break;case"sinh":p.fname="cosh";break;case re:p.fname=pe,p.power=new o(2);break;case pe:p=fe(p,"-tanh");break;case we:{let $=String(p.args[0]);p=e.parse(`-coth(${$})*csch(${$})`);break}case Ie:{let $=String(p.args[0]);p=e.parse(`-csch(${$})^2`);break}case"asinh":p=e.parse(`(sqrt(1+(${D(p.args[0])})^2))^(-1)`);break;case"acosh":p=e.parse(`(sqrt(-1+(${D(p.args[0])})^2))^(-1)`);break;case"atanh":p=e.parse(`(1-(${D(p.args[0])})^2)^(-1)`);break;case Ce:{let $=String(p.args[0]);p=e.parse(`-1/(sqrt(1/(${$})^2-1)*(${$})^2)`);break}case Le:p=e.parse(`-1/((${p.args[0]})^2-1)`);break;case ge:{let $=String(p.args[0]);p=e.parse(`-1/(sqrt(1/(${$})^2+1)*(${$})^2)`);break}case b:{let $=String(p.args[0]);p=e.parse(`1/(sqrt(1-1/(${$})^2)*(${$})^2)`);break}case R:{let $=String(p.args[0]);p=e.parse(`-1/(sqrt(1-1/(${$})^2)*(${$})^2)`);break}case U:p=e.parse(`-1/((${p.args[0]})^2+1)`);break;case"S":{let $=String(p.args[0]);p=e.parse(`sin((pi*(${$})^2)/2)`);break}case"C":{let $=String(p.args[0]);p=e.parse(`cos((pi*(${$})^2)/2)`);break}case"Si":{let $=p.args[0];p=e.parse(`sin(${$})/(${$})`);break}case"Shi":{let $=p.args[0];p=e.parse(`sinh(${$})/(${$})`);break}case"Ci":{let $=p.args[0];p=e.parse(`cos(${$})/(${$})`);break}case"Chi":{let $=p.args[0];p=e.parse(`cosh(${$})/(${$})`);break}case"Ei":{let $=p.args[0];p=e.parse(`e^(${$})/(${$})`);break}case"Li":{let $=p.args[0];p=e.parse(`1/${g.LOG}(${$})`);break}case"erf":p=e.parse(`(2*e^(-(${p.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let $=String(p.args[0]),F=String(p.args[1]);p=e.parse(`(${F})/((${F})^2+(${$})^2)`);break}case"sign":p=new C(0);break;case"sinc":p=e.parse(V("(({0})*cos({0})-sin({0}))*({0})^(-2)",p.args[0]));break;case g.LOG10:p=e.parse(`1/((${p.args[0]})*${g.LOG}(10))`);break;default:p=e.symfunction("diff",[p,z])}p.multiplier=p.multiplier.multiply(H)}else if(I===Ne||I===L&&y(p.power)){let H;I===Ne?H=p.value:I===L&&p.contains(Y)?H=p.fname+Z(D(p.args[0])):H=p.value+Z(D(p.args[0])),k=J.diff(e.multiply(e.parse(Pe+Z(H)),p.power.clone()),Y),p=e.multiply(p,k)}else if(I===L&&!p.power.equals(1))k=p.clone(),k.toLinear(),k.toUnitMultiplier(),p=e.multiply(X(p.clone()),O(k));else if(I===ue||I===ce){let H=p.clone(),$=new C(0);for(let F in p.symbols)Object.hasOwn(p.symbols,F)&&($=e.add($,J.diff(p.symbols[F].clone(),Y)));p=e.multiply(X(H),$)}return p.updateHash(),p}function fe(p,I,P){return e.multiply(p,e.parse(I+Z(P||D(p.args[0]))))}function c(p){let I=p.collectSymbols(),P=new C(0),k=I.length;for(let j=0;j<k;j++){let H=J.diff(I[j].clone(),Y);for(let $=0;$<k;$++)j!==$&&(H=e.multiply(H,I[$].clone()));P=e.add(P,H)}return P}},integration:{u_substitution(ne,z){let x="__u__";function Y(P,k,j){let H=J.diff(k,z),$=j?j(P,k):e.divide(P.clone(),H);return $.contains(z,!0)?null:$}function X(P,k){let j=J.integrate(e.symfunction(P,[new C(x)]),x,0);return j=j.sub(new C(x),k),j.updateHash(),j}let O=ne[0].clone(),fe=ne[1].clone(),c=O.group,p=fe.group,I;if(c===L&&p!==L){let P=O.args[0];if(I=Y(fe,P.clone()),I)return e.multiply(I,X(O.fname,P));if(I=Y(fe,O),I)return J.integration.poly_integrate(O)}else if(p===L&&c!==L){let P=fe.args[0];if(I=Y(O,P.clone()),I)return e.multiply(I,X(fe.fname,P))}else if(c===L&&p===L){if(I=Y(O.clone(),fe.clone()),I||(I=Y(fe.clone(),O.clone()),I))return e.multiply(J.integration.poly_integrate(fe),I)}else if(c===Ne&&p!==Ne){let P=O.power;if(I=Y(fe,P.clone()),!I){let H=J.integration.decompose_arg(P.clone(),z),$=J.diff(H[2].clone(),z),F=J.integration.decompose_arg($.clone(),z);if(e.multiply(H[1],F[1]).power.equals(fe.power)){let ie=e.divide(H[0].clone(),F[0].clone()),me=e.multiply(ie.clone(),e.pow(new C(O.value),e.multiply(H[0],new C(x))));return me=e.multiply(me,new C(x)),J.integration.by_parts(me,x,0,{}).sub(x,H[1].clone())}}let k=J.integrate(O.sub(P.clone(),new C(x)),x,0);return e.multiply(k.sub(new C(x),P),I)}else if(p===Ne&&c!==Ne){let P=fe.power;I=Y(O,P.clone());let k=J.integrate(fe.sub(P,new C(x)),x,0);return e.multiply(k.sub(new C(x),P),I)}else if(O.isComposite()||fe.isComposite()){let P=function(H,$){let F=J.diff($,z),ie=t.Algebra.Factor.factorInner(H),me=t.Algebra.Factor.factorInner(F);return e.divide(ie,me)},k=O.isComposite()?O.clone().toLinear():O.clone(),j=fe.isComposite()?fe.clone().toLinear():fe.clone();if(I=Y(k.clone(),j.clone(),P),I)return e.multiply(J.integration.poly_integrate(fe),I);if(I=Y(j.clone(),k.clone(),P),I)return e.multiply(J.integration.poly_integrate(O),I)}},poly_integrate(ne){let z=ne.power.toString(),x=ne.multiplier.toDecimal(),Y=ne.toUnitMultiplier().toLinear();return Number(z)===-1?e.multiply(new C(x),e.symfunction(Pe,[Y])):e.parse(V("({0})*({1})^(({2})+1)/(({2})+1)",x,Y,z))},stop(ne){throw ne||="Unable to compute integral!",t.Utils.warn(ne),new xe(ne)},partial_fraction(ne,z,x,Y){y(z)||(z=e.parse(z));let X;X=new C(0);let O=t.Algebra.PartFrac.partfrac(ne,z);return O.group===u&&O.isLinear()?(O.each(fe=>{fe.isLinear()||J.integration.stop()}),O.each(fe=>{X=e.add(X,J.integrate(fe,z,x,Y))})):X=e.add(X,J.integrate(O,z,x,Y)),X},get_udv(ne){let z=[[],[],[],[],[]],x=function(O){let fe=O.group;if(fe===L){let{fname:c}=O;t.Utils.inTrig(c)||t.Utils.inHtrig(c)?z[3].push(O):t.Utils.inInverseTrig(c)?z[1].push(O):c===Pe?z[0].push(O):J.integration.stop()}else fe===ae||O.isComposite()&&O.isLinear()||fe===u&&O.isLinear()?z[2].push(O):fe===Ne||O.isComposite()&&!O.isLinear()?z[4].push(O):J.integration.stop()};ne.group===u?ne.each(O=>{x(C.unwrapSQRT(O,!0))}):x(ne);let Y,X=new C(1);for(let O=0;O<5;O++){let fe=z[O],c,p=fe.length;if(p>0){if(p>1){c=new C(1);for(let I=0;I<p;I++)c=e.multiply(c,fe[I].clone())}else c=fe[0].clone();Y?X=e.multiply(X,c):(Y=c,Y.multiplier=Y.multiplier.multiply(ne.multiplier))}}return[Y,X]},trig_sub(ne,z,x,Y,X,O){X||=J.integration.decompose_arg(ne.clone().toLinear(),z);let fe=X[3],c=X[2],p=X[0],I=X[1];if(I.power.equals(2)&&p.greaterThan(0)){let P=t.Utils.getU(ne),k=e.parse(se+Z(P)),j=e.parse(`${i+Z(P)}^2`),H=e.multiply(ne.sub(I,k),j),$=J.integrate(H,P,x,Y).sub(k,I);return t.Utils.clearU(k),$}},by_parts(ne,z,x,Y){Y.previous||=[];let X,O=J.integration.get_udv(ne),fe=O[0],c=O[1],p=C.unwrapSQRT(e.expand(J.diff(fe.clone(),z)),!0),I=p.clone().stripVar(z);p=e.divide(p,I.clone());let P=J.integrate(c.clone(),z,x||0),k=e.multiply(P.clone(),p),j=k.toString();if(Y.previous.indexOf(j)!==-1&&t.Utils.inTrig(fe.fname)&&c.isE())return Y.is_cyclic=!0,new C(1);Y.previous.push(j);let H=e.multiply(fe,P),$=k.multiplier.clone();k.toUnitMultiplier();let F=e.multiply(J.integrate(k.clone(),z,x,Y),I);if(F.multiplier=F.multiplier.multiply($),X=e.subtract(H,F),Y.is_cyclic&&(Y.previous.pop(),Y.previous.length===0)){X=e.expand(X);let ie=new C(0);X.each(me=>{me.contains(z)||(ie=e.add(ie,me.clone()))}),X=e.divide(e.subtract(X,ie.clone()),e.subtract(new C(1),ie))}return X},decompose_arg:t.Utils.decompose_fn},integrate(ne,z,x,Y){if(!z){let X=t.Utils.variables(ne);X.length===1&&(z=X[0]),z||="x"}if(t.Utils.isVector(ne)){let X=new t.Vector([]);return ne.each(O=>{X.elements.push(J.integrate(O,z))}),X}return isNaN(z)||e.error(`variable expected but received ${z}`),ne.isConstant(!0)?e.multiply(ne.clone(),e.parse(z)):(Y||={},t.Utils.block("PARSE2NUMBER",()=>{x||=0;let X=y(z)?z.toString():z,O=C.unwrapSQRT(ne.clone(),!0),fe=O.group,c;try{if(++x>t.Settings.integration_depth&&J.integration.stop("Maximum depth reached. Exiting!"),!O.contains(X,!0))c=e.multiply(O.clone(),e.parse(X));else if(fe===ae)c=J.integration.poly_integrate(O,X,x);else if(fe===Ne)if(O.previousGroup===L&&!(O.fname==="sqrt"||O.fname===g.PARENTHESIS)&&J.integration.stop(),O.contains(X)&&O.previousGroup!==L)O.power.contains(X)?J.integration.stop():(J.diff(O.clone().toLinear(),X).contains(X)&&J.integration.stop(),c=J.integration.poly_integrate(O,X,x));else{let p=J.diff(O.power.clone(),X);if(p.contains(X)){let I=p.stripVar(X),P=e.divide(p.clone(),I.clone());if(P.group===ae&&P.isLinear())return I.multiplier=I.multiplier.divide(new o(2)),e.parse(V("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",I,X,O.multiplier));J.integration.stop()}if(O.isE())p.isLinear()?c=O:p.isE()&&p.power.group===ae&&p.power.power.equals(1)?c=e.multiply(e.symfunction("Ei",[O.power.clone()]),O.power):J.integration.stop();else{let I=e.symfunction(Pe,[e.parse(O.value)]);c=e.divide(O,I)}c=e.divide(c,p)}else if(O.isComposite()&&O.isLinear()){let p=e.parse(O.multiplier);O.toUnitMultiplier(),c=new C(0),O.each(I=>{c=e.add(c,J.integrate(I,X,x))}),c=e.multiply(p,c)}else if(fe===ue)if(O.power.greaterThan(1)&&(O=e.expand(O)),O.power.equals(1))c=new C(0),O.each(p=>{c=e.add(c,J.integrate(p,X,x))},!0);else{let p=Number(O.power),I=O.multiplier.clone();O.toUnitMultiplier();let P=O.clone().toLinear(),k=J.integration.decompose_arg(P,X),j=k[3],H=k[2],$=k[0],F=k[1];if(p===-1&&F.group!==ce&&F.power.equals(2)){let ie=G(j)?j>0:!0;if(F.group===ae&&F.power.equals(2)&&ie){let me=function(We){let Qe=new C(1);return We.each(ke=>{Qe=e.multiply(Qe,ke.fname==="abs"?ke.args[0]:ke)}),Qe},Ae=$.clone(),ve=j.clone();Ae=e.pow(Ae,new C(1/2)),ve=e.pow(ve,new C(1/2));let De=e.multiply(me(ve),me(Ae)),Fe=e.symfunction(v,[e.divide(e.multiply($,F.toLinear()),De.clone())]);c=e.divide(Fe,De)}else if(F.group===ae&&F.isLinear())c=e.divide(J.integration.poly_integrate(O),$);else if(F.power.equals(4)){let me=Z,Ae=e.parse(`${he+me($)}*${X}^2`),ve=e.parse(`${he+me(2)}*${me($)}^${me("1/4")}*${me(j)}^${me("1/4")}*${X}`),De=e.parse(he+me(j)),Fe=e.add(e.add(Ae.clone(),ve.clone()),De.clone()),We=e.add(e.subtract(Ae,ve),De),Qe=e.parse(`${he+me(2)}*${me(j)}^${me("3/4")}`),ke=e.parse(`${he+me(j)}*${me(j)}^${me("1/4")}*${X}`),rt=e.parse(`2*${me(j)}*${he}${me(2)}*${me(j)}^${me("1/4")}`),Ke=e.divide(e.subtract(Qe.clone(),ke.clone()),e.multiply(rt.clone(),We)),at=e.divide(e.add(Qe,ke),e.multiply(rt,Fe.clone()));c=e.add(J.integrate(Ke,X,x,Y),J.integrate(at,X,x,Y))}else c=J.integration.partial_fraction(O,X,x)}else if(p===-1/2)if(F.group===ae&&F.power.equals(2))if(H.multiplier.lessThan(0)&&!j.multiplier.lessThan(0))if($.negate(),j.isConstant()&&$.isConstant()){let ie=e.symfunction(he,[$.clone()]),me=e.symfunction(he,[e.multiply($.clone(),j)]);c=e.divide(e.symfunction(w,[e.divide(H.toLinear(),me)]),ie)}else{let ie=e.symfunction(he,[$]),me=e.multiply(ie.clone(),F.clone().toLinear());c=e.divide(e.symfunction(v,[e.divide(me,e.symfunction(he,[P.clone()]))]),ie)}else J.integration.stop();else J.integration.stop();else if(p===1/2&&F.power.equals(2)&&$.greaterThan(0))J.integration.stop();else if(F.isLinear()&&F.group!==ce)c=e.divide(J.integration.poly_integrate(O),$);else if(F.power.equals(2)&&$.greaterThan(0)){let ie=e.parse(he+Z($)),me=e.parse(he+Z(j)),Ae=e.multiply(ie.clone(),me.clone()).invert(),ve=e.pow(j,new C(O.power)),De=t.Utils.getU(O),Fe=e.multiply(Ae,F.clone().toLinear()),We=e.symfunction(v,[Fe]),Qe=(Math.abs(O.power)-1)*2,ke=J.integrate(e.parse(`${be+Z(De)}^${Qe}`));return t.Utils.clearU(De),e.multiply(ke.sub(De,We),ve)}else if(O.group!==u&&!O.power.lessThan(0))c=J.integration.by_parts(O,X,x,Y);else{let ie=O.clone().toLinear(),Ae=t.Algebra.Factor.factorInner(ie).toString()!==ie.toString();if(t.Algebra.degree(ie,e.parse(X)).equals(2)&&!Ae)try{let ve=t.Algebra.sqComplete(ie,X),De=t.Utils.getU(ie),Fe=ve.f.sub(ve.a,De),We=e.pow(Fe,e.parse(O.power));c=J.integrate(We,De).sub(De,ve.a)}catch(ve){if(ve.message==="timeout")throw ve;J.integration.stop()}else c=J.integration.partial_fraction(O,X,x,Y)}c.multiplier=c.multiplier.multiply(I)}else if(fe===L){let p=O.args[0],I=O.multiplier.clone();O.toUnitMultiplier();let P=J.integration.decompose_arg(p,X),k=P[0],j=P[1],{fname:H}=O;if(H===Pe||H===w||H===d||H===v&&j.isLinear()){let $=O.power.toString();if(G($)&&(x-=$),p.isComposite()){let F=t.Utils.getU(O),ie=e.pow(e.parse(Pe+Z(F)),new C($)),me=J.diff(p,X),Ae=e.multiply(ie,me),ve=J.integrate(Ae,F,x,Y);c=e.multiply(e.parse(I),ve.sub(F,p))}else c=e.multiply(e.parse(I),J.integration.by_parts(O,X,x,Y))}else if(H===se&&O.power.lessThan(0)){let $=O.clone();return $.power.negate(),$.fname=f,e.multiply(e.parse(I),J.integrate($,X,x))}else{if(!k.contains(X,!0)&&O.isLinear())if(H===$e){let $=e.divide(p.clone(),k.clone());if($.group===ae&&!$.power.lessThan(0))if(t.Utils.even($.power))c=J.integrate(p,X,x);else{let F=J.integrate($,X,x);F.power=F.power.subtract(new o(1)),c=e.multiply(e.multiply(e.symfunction($e,[$.toLinear()]),F),k)}else J.integration.stop()}else{let $=O.args[0].group,F=J.integration.decompose_arg(p,X);switch((!($===ue||$===ae||$===u)||!F[1].power.equals(1)||p.hasFunc())&&J.integration.stop(),H){case be:c=e.symfunction(Se,[p]);break;case Se:c=e.symfunction(be,[p]),c.negate();break;case se:c=e.parse(V(`${g.LOG}(sec({0}))`,p));break;case i:c=e.parse(V(`${g.LOG}(tan({0})+sec({0}))`,p));break;case a:c=e.parse(V(`-${g.LOG}(csc({0})+cot({0}))`,p));break;case f:c=e.parse(V(`${g.LOG}(sin({0}))`,p));break;case B:c=e.symfunction(te,[p]);break;case te:c=e.symfunction(B,[p]);break;case re:c=e.parse(V(`${g.LOG}(cosh({0}))`,p));break;case b:c=J.integration.by_parts(O,X,x,Y);break;case R:c=J.integration.by_parts(O,X,x,Y);break;case U:c=J.integration.by_parts(O,X,x,Y);break;case Ce:c=J.integration.by_parts(O,X,x,Y);break;case ge:c=J.integration.by_parts(O,X,x,Y);break;case Le:c=J.integration.by_parts(O,X,x,Y);break;case pe:c=e.parse(V("atan(sinh({0}))",p));break;case we:c=e.parse(V(`${g.LOG}(tanh(({0})/2))`,p));break;case Ie:c=e.parse(V(`${g.LOG}(sinh({0}))`,p));break;case ye:c=J.integrate(e.parse(V("e^({0})",p)),X,x);break;case"S":{let ie=O.args[0].clone(),me=J.integration.decompose_arg(ie,X),Ae=me[1],ve=me[0],De=me[3];c=e.parse(V("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",ve,De,j));break}case"C":{let ie=O.args[0].clone(),me=J.integration.decompose_arg(ie,X),Ae=me[1],ve=me[0],De=me[3];c=e.parse(V("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",ve,De,Ae));break}case"erf":{let ie=O.args[0].clone(),me=J.integration.decompose_arg(ie,X),Ae=me[1],ve=me[0];c=e.parse(V("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",ve,Ae,ie));break}case"sign":c=e.multiply(O.clone(),p.clone());break;default:J.integration.stop()}c=e.divide(c,k)}else if(j.isLinear())if(H===be||H===Se){let $=Number(O.power);if($<0)O.fname=H===Se?a:i,O.invert().updateHash(),c=J.integrate(O,X,x);else{let F=O.args[0],ie=O.clone(),me=O.clone(),Ae=new C(($-1)/$),ve=e.multiply(k.clone(),new C($)).invert();ie.power=ie.power.subtract(new o(1)),me.power=me.power.subtract(new o(2));let De=e.symfunction(H===be?Se:be,[p.clone()]);H===Se&&De.negate(),c=e.add(e.multiply(e.multiply(ve,ie),De),e.multiply(Ae,J.integrate(e.parse(me),X,x)))}}else if(H===se||H===f){if(O.args[0].isLinear(X)){let $=O.power.subtract(new o(1)).toString(),F=O.clone().toUnitMultiplier(),ie=e.parse(V(`${H===f?"-":""}1/({2}*{0})*{3}({1})^({0})`,$,p,k,H));F.power=F.power.subtract(new o(2)),F.power.equals(0)&&(F=e.parse(F)),c=e.subtract(ie,J.integrate(F,X,x))}}else if(H===i||H===a){let $=O.power.subtract(new o(1)).toString(),F=O.power.subtract(new o(2)).toString(),ie=H===i?se:f,me=O.clone().toUnitMultiplier(),Ae=V(`${H===a?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,k,$,F,p,H,ie),ve=e.parse(Ae);me.power=me.power.subtract(new o(2)),me.power.equals(0)&&(me=e.parse(me)),c=e.add(ve,e.multiply(new C(F/$),J.integrate(me,X,x)))}else(H===te||H===B)&&O.power.equals(2)?c=J.integrate(O.fnTransform(),X,x):J.integration.stop();else J.integration.stop();c.multiplier=c.multiplier.multiply(I)}}else if(fe===ce)c=J.integration.partial_fraction(O,X,x);else if(fe===u){O.getDenom().group===ae&&(O=e.expand(O));let I=O.stripVar(X),P=e.divide(O.clone(),I.clone());if(I.contains(X)&&(P=e.multiply(P,I),I=new C(1)),P.group===u){let k=P.collectSymbols().sort((H,$)=>H.group===$.group?Number(H.power)===Number($.power)?H<$?1:-1:$.power-H.power:$.group-H.group).map(H=>{let $=C.unwrapSQRT(H,!0);return $.fname===ye?e.parse(V("({1})*e^({0})",$.args[0],$.multiplier)):$}),j=k.length;if(O.power<0){if(j===2)return J.integrate(e.expand(O),X,x,Y)}else if(j===2){try{c=J.integration.u_substitution(k,X)}catch(H){if(H.message==="timeout")throw H}if(!c){let H=k[0].group,$=k[1].group,F=k[0],ie=k[1],me=F.fname,Ae=ie.fname;if(O=e.multiply(F.clone(),ie.clone()),H===L&&$===L)if(me===Pe||Ae===Pe)c=J.integration.by_parts(O.clone(),X,x,Y);else{k.sort((ke,rt)=>rt.fname>ke.fname);let ve=F.args[0];(!ve.isLinear()||!(ve.group===ue||ve.group===u||ve.group===ae))&&J.integration.stop();let De=J.integration.decompose_arg(ve,X),Fe=De[1],We=De[0];Fe.isLinear()||J.integration.stop();let Qe=ie.args[0];if(ve.equals(Qe))if(me===Se&&Ae===be||me===be&&Ae===Se)if(F.power.lessThan(0)&&J.integration.stop(),me===Se&&F.power.add(ie.power).equals(0))F.fname=se,F.updateHash(),c=J.integrate(F,X,x);else if(de(F.power)&&Ae===be&&ie.power.lessThan(0)){let ke=Number(F.power)/2,rt=e.parse(V("(1-cos({0})^2)^({1})",F.args[0],ke));c=J.integrate(e.expand(e.multiply(rt,ie.clone())),X,x,Y)}else if(de(F.power)&&Ae===Se&&ie.power.lessThan(0)){let ke=Number(F.power)/2,rt=e.parse(V("(1-sin({0})^2)^({1})",F.args[0],ke));c=J.integrate(e.expand(e.multiply(rt,ie.clone())),X,x,Y)}else{let ke=t.Utils.even(F.power),rt=t.Utils.even(ie.power);if(c=new C(0),!ke||!rt){let Ke,at;ke?(Ke=F,at=ie):(Ke=ie,at=F);let Et=Ke.fname===be?-1:1,bt=(at.power-1)/2,Ot=e.parse(`(1-${Ke.fname}${t.Utils.inBrackets(ve)}^2)^${bt}`);e.expand(e.multiply(new C(Et),e.multiply(Ke.clone(),Ot))).each(vt=>{c=e.add(c,J.integration.poly_integrate(vt.clone()))})}else{let Ke=function(Ot){let vt=Ot.power/2,$t;return Ot.fname===be?$t=`((1/2)+(cos(2*(${Ot.args[0]}))/2))^${vt}`:$t=`((1/2)-(cos(2*(${Ot.args[0]}))/2))^${vt}`,e.parse($t)},at=Ke(F),Et=Ke(ie),It=e.multiply(at,Et);return e.expand(It).each(Ot=>{c=e.add(c,J.integrate(Ot,X,x))}),e.multiply(c,I)}}else if(me===i&&Ae===se&&Fe.isLinear()&&ie.isLinear())c=e.parse(V("sec({0})^({1})/({1})",F.args[0],F.power));else if(me===se&&Ae===i&&Fe.isLinear())if(F.isLinear()&&ie.isLinear())c=e.divide(e.symfunction(i,[ve.clone()]),We);else if(de(F.power)){let ke=Number(F.power)/2,rt=e.parse(V("(sec({0})^2-1)^({1})",F.args[0],ke));c=J.integrate(e.expand(e.multiply(rt,ie)),X,x)}else J.integration.stop();else if(me===i&&Ae===be)F.fname=be,F.invert().updateHash(),c=J.integrate(e.multiply(F,ie),X,x);else if(me===Se&&Ae===a)ie.fname=Se,ie.invert().updateHash(),c=J.integrate(e.multiply(F,ie),X,x);else if(me===se&&(Ae===be||Ae===Se)&&ie.power.lessThan(0)){let ke=e.multiply(F.fnTransform(),ie);c=J.integrate(e.expand(ke),X,x)}else{let ke=e.multiply(F.fnTransform(),ie.fnTransform());c=J.integrate(e.expand(ke),X,x)}else if((me===Se||me===be)&&(Ae===Se||Ae===be))if(F.isLinear()&&ie.isLinear())if(F.args[0].isLinear()&&ie.args[0].isLinear()){let ke,rt;Ae===Se?(ke=F.args[0],rt=ie.args[0]):(rt=F.args[0],ke=ie.args[0]);let Ke=e.parse(V("(sin(({1})+({0}))+sin(({1})-({0})))/2",ke.toString(),rt.toString()));c=J.integrate(Ke,X,x)}else{let ke=Ye(k);c=J.integrate(e.expand(ke),X,x)}else{let ke=new C(1);k.forEach(Ke=>{let at=Ke.fnTransform();ke=e.multiply(ke,at)});let rt=e.expand(ke);c=J.integrate(rt,X,x),c.hasIntegral()&&(c=J.integrate(Ye(ke.collectSymbols()),X,x))}else J.integration.stop()}else if(H===L&&$===ae){let ve=F.isLinear();if(F.fname===be&&ve&&ie.power.equals(-1))c=e.symfunction("Ci",[F.args[0]]);else if(F.fname===be&&ie.power.equals(-1))c=J.integrate(e.multiply(F.fnTransform(),ie.clone()),X,x);else if(F.fname===te&&ve&&ie.power.equals(-1))c=e.symfunction("Chi",[F.args[0]]);else if(F.fname===te&&ie.power.equals(-1))c=J.integrate(e.multiply(F.fnTransform(),ie.clone()),X,x);else if(F.fname===Se&&ve&&ie.power.equals(-1))c=e.symfunction("Si",[F.args[0]]);else if(F.fname===Se&&ie.power.equals(-1))c=J.integrate(e.multiply(F.fnTransform(),ie.clone()),X,x);else if(F.fname===B&&ve&&ie.power.equals(-1))c=e.symfunction("Shi",[F.args[0]]);else if(F.fname===B&&ie.power.equals(-1))c=J.integrate(e.multiply(F.fnTransform(),ie.clone()),X,x);else if(F.fname===Pe&&ie.power.equals(-1))c=J.integration.poly_integrate(F,X,x);else if(F.fname==="erf"){if(ie.power.equals(1)){let De=J.integration.decompose_arg(F.args[0],X),Fe=De[0],We=De[1],Qe=F.args[0].toString();c=e.parse(V("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",Fe,We,Qe))}}else c=J.integration.by_parts(O,X,x,Y)}else if(H===Ne&&$===ae){let ve=me===Pe?J.integration.decompose_arg(F.args[0],X)[1]:null;F.isE()&&(F.power.group===ae||F.power.group===u)&&ie.power.equals(-1)?c=e.symfunction("Ei",[F.power.clone()]):me===Pe&&ve.value===ie.value?c=J.integration.poly_integrate(F,X,x):c=J.integration.by_parts(O,X,x,Y)}else if(H===ce&&$===ae){if(ie.value===F.value&&F.power.equals(-1)){let ve=Math.min.apply(null,t.Utils.keys(F.symbols)),De=Math.min(ve,ie.power),Fe=ie.clone();Fe.power=new o(De),ie=e.divide(ie,Fe.clone());let We=new C(0);F.each(Qe=>{We=e.add(We,e.divide(Qe.clone(),Fe.clone()))}),We.multiplier=F.multiplier,O=e.divide(ie,We)}else O=e.expand(O);c=J.integration.partial_fraction(O,X,x)}else if(H===ue&&$===ae){let ve=F.clone().toLinear(),De=t.Algebra.degree(ve,e.parse(X)).equals(1);if(F.power.equals(-1/2)){let Fe=J.integration.decompose_arg(F.clone().toLinear(),X),We=Fe[0].negate(),Qe=Fe[1],ke=Fe[3],rt=Number(F.power),Ke=Number(ie.power);if(G(Ke)&&t.Utils.even(Ke)&&Qe.power.equals(2)){let at=e.divide(e.multiply(e.pow(ke.clone(),new C(2)),e.symfunction(he,[e.divide(ke.clone(),We.clone())])),e.pow(We.clone(),new C(2)));at=e.multiply(at,e.symfunction(he,[ke]).invert());let Et=e.parse("sin(u)");Et.power=Et.power.multiply(ie.power);let It=J.integrate(Et,"u",x),bt=e.parse(`${w}(${he}(${We}/${ke})*${X})`);c=e.multiply(at,It.sub(new C("u"),bt))}else if(rt===-1/2){let at=function(Et,It){let bt=e.parse(J.integrate(Et,X,x,Y).sub(X,V(It,X)));if(!bt.hasIntegral())return bt};Ke===-1?c=at(e.expand(e.expand(e.pow(e.multiply(F.invert(),ie.invert()),new C(2)))).invert(),"sqrt(1-1/({0})^2)"):Ke===-2&&(c=at(e.sqrt(e.expand(e.divide(e.pow(O,new C(2)).invert(),e.pow(new C(X),new C(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(F.power.equals(-1)&&ie.isLinear()&&De)c=J.integration.partial_fraction(O,X,x);else if(!F.power.lessThan(0)&&G(F.power)){let Fe=e.expand(F);c=new C(0),Fe.each(We=>{We.group===ce?We.each(Qe=>{c=e.add(c,J.integrate(e.multiply(ie.clone(),Qe),X,x))}):c=e.add(c,J.integrate(e.multiply(ie.clone(),We),X,x))})}else if(F.power.lessThan(-2))c=J.integration.by_parts(O,X,x,Y);else if(F.power.lessThan(0)&&ie.power.greaterThan(1)){let Fe=J.integration.decompose_arg(F.clone().toLinear(),X),We=Fe[0].negate(),Qe=Fe[1],ke=Fe[3],rt=F.clone().toLinear();if(Qe.group!==ce&&Qe.isLinear()){let Ke=Number(ie.power),at="_u_",Et=new C(at),It=e.expand(e.divide(e.pow(e.subtract(Et.clone(),ke.clone()),new C(Ke)),Et.clone())),bt={};bt[at]=rt;let Ot=e.parse(It,bt);c=J.integrate(Ot,X,0)}else if(ie.power.greaterThan(Qe.power)||ie.power.equals(Qe.power)){let Ke=new t.Algebra.Classes.Factors;F=t.Algebra.Factor.coeffFactor(F.invert(),Ke);let at=t.Algebra.divide(ie,F);at.group===u?c=J.integration.by_parts(O,X,x,Y):(c=new C(0),at.each(Et=>{c=e.add(c,J.integrate(Et,X,x))}),Ke.each(Et=>{c=e.divide(c,Et)}),c=e.expand(c))}else c=J.integration.partial_fraction(O,X,x)}else if(F.power.den.equals(2)){let Fe=J.integration.decompose_arg(F.clone().toLinear(),X),We=Fe[3],Qe=Fe[1],ke=Fe[0],rt=Fe[2];if(Qe.power.equals(2)&&ke.lessThan(0)){We.equals(1)||(I=e.multiply(I,e.pow(We,new C(2))));let Ke=X,at=e.divide(e.pow(ke.clone().negate(),new C(1/2)),e.pow(We,new C(1/2))),Et=e.symfunction(be,[new C(Ke)]),It=e.pow(e.symfunction(be,[new C(Ke)]),new C(F.power.num)),bt=e.pow(e.symfunction(Se,[new C(Ke)]),new C(ie.power)),Ot=e.multiply(e.multiply(It,Et),bt);c=J.integrate(Ot,Ke,x).sub(Ke,e.symfunction(w,[e.multiply(new C(X),at)]))}else c=J.integration.partial_fraction(O,X,x,Y)}else De&&(c=J.integration.partial_fraction(O,X,x))}else if(F.isComposite()&&ie.isComposite())if(c=new C(0),F.power.greaterThan(0)&&ie.power.greaterThan(0))e.expand(O).each(De=>{c=e.add(c,J.integrate(De,X,x))},!0);else{let ve=Number(F.power),De=Number(ie.power);if(ve<0&&De>0){let Fe=F;F=ie,ie=Fe}ve===-1&&De===-1?c=J.integration.partial_fraction(O,X):F.each(Fe=>{let We=e.multiply(Fe,ie.clone()),Qe=J.integrate(We,X,x);c=e.add(c,Qe)})}else if(H===ue&&k[0].power.greaterThan(0))F=e.expand(F),c=new C(0),F.each(ve=>{c=e.add(c,J.integrate(e.multiply(ve,ie.clone()),X,x))},!0);else if(H===L&&$===Ne&&t.Utils.inHtrig(F.fname))F=F.fnTransform(),c=J.integrate(e.expand(e.multiply(F,ie)),X,x);else if(H===L&&$===ue||$===L&&H===ue){if($===L&&H===ue){let rt=F;F=ie,ie=rt}let ve,De,Fe,We,Qe=C.unwrapSQRT(J.diff(F.clone(),X),!0),ke=C.unwrapSQRT(ie,!0);if(Qe.power.equals(ke.power)){if(ve=new C(ie.power),Fe=Qe.clone().toLinear(),We=ie.clone().toLinear(),De=t.Algebra.divide(Fe.toLinear(),We),De.isConstant()){let rt=e.pow(De,ve.negate());c=e.multiply(rt,J.integration.poly_integrate(F.clone()))}}else c=J.integration.by_parts(O,X,x,Y)}else{let ve=F.clone().toLinear(),De=ie.clone().toLinear();H===Ne&&$===Ne&&F.power.contains(X)&&ie.power.contains(X)&&!ve.contains(X)&&!De.contains(X)?c=e.parse(V("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",ve.toString(),De.toString(),F.power.multiplier.toString(),ie.power.multiplier.toString(),X)):c=J.integration.by_parts(O,X,x,Y)}}}else if(j===3&&(k[2].group===ae&&k[2].power.lessThan(2)||k[0].group===ue)){let H=k[0];if(H.group===ue){H.power.greaterThan(1)&&(H=e.expand(H));let $=e.multiply(k[1],k[2]);c=new C(0),H.each(F=>{let ie=e.multiply(F,$.clone()),me=J.integrate(ie,X,x);c=e.add(c,me)},!0)}else c=J.integration.by_parts(O,X,x,Y)}else if(He(k)){let H=new C(1);for(let $=0,F=k.length;$<F;$++)H=e.multiply(H,k[$].fnTransform());H=e.expand(H),c=J.integrate(H,X,x)}else{let H=Ye(k);c=J.integrate(e.expand(H),X,x)}}else{if(P.equals(1))return J.integrate(e.expand(O),X,x);P.clone().toLinear().isPoly(!0)&&t.Utils.variables(P).length>1&&(P=t.Algebra.Factor.factorInner(P)),c=J.integrate(P,X,x)}c=e.multiply(c,I)}if(c)return c}catch(p){if(p.message==="timeout"||!(p instanceof xe||p instanceof t.exceptions.DivisionByZero))throw p}return e.symfunction("integrate",[ne,z])},!1))},defint(ne,z,x,Y){Y||="x";let X=function(I,P,k){try{return e.parse(I,P)}catch(j){if(j.message==="timeout")throw j;return J.Limit.limit(I,Y,k)}},O=t.Utils.variables(ne),fe=ne.hasTrig(),c,p;if(O.length===1&&!Y&&(Y=O[0]),fe||(p=J.integrate(ne,Y)),!fe&&!p.hasIntegral()){let I={},P={};I[Y]=x,P[Y]=z;let k=X(p,I,x,Y),j=X(p,P,z,Y);c=e.subtract(k,j)}else if(O.length===1&&z.isConstant()&&x.isConstant()){let I=t.Build.build(ne);c=new C(t.Math2.num_integrate(I,Number(z),Number(x)))}else c=e.symfunction("defint",[ne,z,x,Y]);return c},Limit:{interval(ne,z){return e.parse(V("[{0}, {1}]",ne,z))},diverges(){return J.Limit.interval("-Infinity","Infinity")},divide(ne,z,x,Y,X){if(X++>g.max_lim_depth)return;let O=ne.clone(),fe=z.clone();if(z.fname===$e){let ie=ne.sign(),me=Y.sign();if(Y.isInfinity)return e.multiply(new C(ie),new C(me));if(Y.equals(0)){let Ae=e.parse(ne.multiplier),ve=e.parse(z.multiplier);return e.divide(e.multiply(Ae,J.Limit.interval("-1","1")),ve)}return J.Limit.diverges()}let c=function(ie){if(t.Utils.isVector(ie)){for(let me=0;me<ie.elements.length;me++)if(!ie.elements[me].isInfinity)return!1;return!0}return ie.isInfinity},p=function(ie,me){return t.Utils.isVector(ie)?!1:ie.equals(me)},I,P=0,k,j,H;do if(k=Ee(J.Limit.limit(ne.clone(),x,Y,X)),j=Ee(J.Limit.limit(z.clone(),x,Y,X)),H=c(k)&&c(j)||p(k,0)&&p(j,0),H){let ie=J.diff(ne.clone(),x),me=J.diff(z.clone(),x),Ae=e.divide(ie,me);ne=Ae.getNum(),z=Ae.getDenom()}while(H&&++P<g.max_lim_depth);if(P>=g.max_lim_depth)return;let $=j.equals(0),F=Number(fe.power);return Y.isConstant(!0)&&$?I=C.infinity(k.lessThan(0)?-1:void 0):$?I=J.Limit.diverges():I=e.divide(k,j),I},rewriteToLog(ne){let z=ne.power.clone();return ne.toLinear(),e.pow(new C("e"),e.multiply(z,e.symfunction(`${g.LOG}`,[ne])))},getSubbed(ne,z,x){let Y;ne.group===Ne&&(ne=J.rewriteToLog(ne));try{Y=ne.sub(z,x)}catch(X){if(X.message==="timeout")throw X;Y=ne}return Y},isInterval(ne){return t.Utils.isVector(ne)},isConvergent(ne){return!(J.Limit.isInterval(ne)&&ne.elements[0].isInfinity&&ne.elements[1].isInfinity||ne.containsFunction("limit"))},limit(ne,z,x,Y){if(ne.isLinear()&&ne.isComposite()){let fe=new C(0);return ne.each(c=>{fe=e.add(fe,J.Limit.limit(c,z,x,Y))},!0),fe}if(ne=t.Algebra.Simplify.simplify(ne),Y||=1,Y++>g.max_lim_depth)return;let X=e.parse(ne.multiplier);ne.toUnitMultiplier();let O;try{if(ne.isConstant(!0))O=ne;else{let fe={};fe[z]=x;try{let c=e.parse(ne.sub(z,x),fe);(c.isConstant(!0)||c.isInfinity)&&(O=c)}catch(c){if(c.message==="timeout")throw c}if(!O){let c=ne.getNum(),p=ne.getDenom();if(p.isConstant(!0)){if(ne.group===Ne){let I=ne.clone().toLinear(),P=ne.power.clone(),k=I.getNum(),j=I.getDenom(),H=t.Utils.decompose_fn(j,z,!0);if(k.group===ae&&k.multiplier.isOne()&&H.ax.group===ae&&H.b.isConstant(!0)&&H.a.isOne()&&H.b.isConstant(!0))O=e.parse(V("(1/e^({0}))",H.b));else{let $=J.Limit.rewriteToLog(ne.clone()),F=$.power.clone(),ie=$.clone().toLinear(),me=J.Limit.limit(ie,z,x,Y),Ae=J.Limit.limit(F,z,x,Y);O=e.pow(me,Ae)}}else if(ne.group===L&&ne.args.length===1){let I,P=J.Limit.limit(ne.args[0],z,x,Y);if(t.Utils.isVector(P))return O=P.map(j=>{let H=ne.clone();return H.args[0]=j,J.Limit.limit(e.symfunction(ne.fname,[j]),z,x,Y)}),e.multiply(X,O);let k;if(P.isConstant(!0)){k=e.symfunction(ne.fname,[P]);try{Ee(k),I=!0}catch(j){if(j.message==="timeout")throw j;I=!1}}if(I)O=k;else if(J.Limit.isConvergent(P)){if(ne.fname===Pe)switch(P.toString()){case"0":O=C.infinity().negate();break;case"Infinity":O=C.infinity();break;case"-Infinity":O=C.infinity();break}else if((ne.fname===be||ne.fname===Se)&&x.isInfinity)O=J.Limit.interval(-1,1);else if(ne.fname===se){let j=ne.args[0],H=j.getNum(),$=j.getDenom(),F=H.toUnitMultiplier();(x.isInfinity||F.equals("pi")&&$.equals(2))&&(O=J.Limit.diverges())}else if(ne.fname===g.FACTORIAL&&P.isInfinity)return C.infinity()}}else if(ne.group===ae){if(ne.power>0)return e.parse(ne,fe);t.Utils.even(ne.power)?O=C.infinity():O=J.Limit.diverges()}else if(ne.group===u){let I,P,k=ne.collectSymbols().sort((H,$)=>H.group-$.group),j=k.pop();for(I=Ee(J.Limit.limit(j,z,x,Y));k.length;){let H=k.pop();P=Ee(J.Limit.limit(H,z,x,Y)),I.isInfinity||!J.Limit.isConvergent(I)&&P.equals(0)||I.equals(0)&&J.Limit.isConvergent(P)?(H.containsFunction(Pe)&&(H=[j,j=H][0]),H.invert(),I.isInfinity&&P.isInfinity?I=C.infinity():I=J.Limit.divide(j,H,z,x,Y)):(I=e.multiply(I,P),j=e.multiply(j,H))}O=I}else if(ne.isComposite()){let I;ne.isLinear()||(ne=e.expand(ne)),O=new C(0);let P=ne.collectSymbols().sort((H,$)=>$.group-H.group),k=[],j=new C(0);for(let H=0,$=P.length;H<$;H++){let F=P[H].clone();F.group===L||F.group===u&&F.hasFunc()?j=e.add(j,F):k.push(F)}k.unshift(j),k.length!==1&&(P=k);for(let H=0,$=P.length;H<$;H++){let F=P[H];try{I=J.Limit.limit(F,z,x,Y)}catch(ie){if(ie.message==="timeout")throw ie;I=J.Limit.diverges()}try{O=e.add(O,I)}catch(ie){if(ie.message==="timeout")throw ie;if(Y++>g.max_lim_depth)return;O=J.Limit.limit(J.diff(ne,z),z,x,Y)}}}}else O=J.Limit.divide(c,p,z,x,Y)}}O||=e.symfunction("limit",[ne,z,x])}catch(fe){if(fe.message==="timeout")throw fe;O=e.symfunction("limit",[ne,z,x])}return e.multiply(X,O)}},Fresnel:{S(ne){return ne.isConstant(!0)?J.defint(e.parse("sin(pi*x^2/2)"),new C(0),ne,"x"):e.symfunction("S",[ne])},C(ne){return ne.isConstant(!0)?J.defint(e.parse("cos(pi*x^2/2)"),new C(0),ne,"x"):e.symfunction("C",[ne])}}};B0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return J.diff}},{name:"sum",visible:!0,numargs:4,build(){return J.sum}},{name:"product",visible:!0,numargs:4,build(){return J.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return J.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return J.defint}},{name:"S",visible:!0,numargs:1,build(){return J.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return J.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return J.Limit.limit}}]),B0.updateAPI()})()});var X0=f0((Yi,u1)=>{"use strict";var h0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof u1<"u"&&h0===void 0&&(h0=T0(),V0());(function(){let t=h0.getCore(),e=t.PARSER,{N:o,P:g,S:y,EX:L,FN:C,PL:D,CP:Z,CB:G}=t.groups,{keys:V,even:de,variables:Ee,format:Me,round:ae,isInt:ce}=t.Utils,{Frac:ue,NerdamerSymbol:u,Vector:Ne,Expression:Oe}=t,{CONST_HASH:Pe}=t.Settings,ye=t.Utils.importFunctions(),$e=t.Utils.evaluate;function he(i,a,f){if(this.coeffs=[],this.variable="",t.Utils.isSymbol(i))this.parse(i),this.variable||=a||"";else if(typeof i=="number"&&!isNaN(i)){if(f||=0,a===void 0)throw new t.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[f]=new ue(i),this.fill(i)}else typeof i=="string"&&this.parse(e.parse(i))}he.fromArray=function(a,f){if(typeof f>"u")throw new t.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let w=new he;return w.coeffs=a,w.variable=f,w},he.fit=function(a,f,w,d,v,b){let R=new Array(v+1),U=w-f;R[0]=f,R[v]=a,U-=a*d**v;for(let B=v-1;B>0;B--){let te=d**B,re=U/te,pe=Math.sign(re)*Math.floor(Math.abs(re));U-=pe*te,R[B]=pe}if(U!==0)return null;for(let B=0;B<R.length;B++)R[B]=new ue(R[B]);return he.fromArray(R,b)},he.prototype={parse(i,a){if(this.variable=Ee(i)[0],!i.isPoly())throw new t.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${t.Utils.text(i)}`);if(a||=[],i.power.absEquals(1)||(i=e.expand(i)),i.group===t.groups.N)a[0]=i.multiplier;else if(i.group===t.groups.S)a[Number(i.power.toDecimal())]=i.multiplier;else for(let f in i.symbols){if(!Object.hasOwn(i.symbols,f))continue;let w=i.symbols[f],d=w.power;if(t.Utils.isSymbol(d))throw new t.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");let v=w.group===o?0:Number(d.toDecimal());w.symbols?this.parse(w,a):a[v]=w.multiplier}this.coeffs=a,this.fill()},fill(i){i=Number(i)||0;let a=this.coeffs.length;for(let f=0;f<a;f++)this.coeffs[f]===void 0&&(this.coeffs[f]=new ue(i));return this},trim(){let i=this.coeffs.length;for(;i--;){let a=this.coeffs[i],f=a.equals(0);if(a&&f){if(i===0)break;this.coeffs.pop()}else break}return this},modP(i){let a=this.coeffs.length;for(let f=0;f<a;f++){let w=this.coeffs[f],d;if(w.lessThan(0)){let R;for(d=f;d<a;d++)if(this.coeffs[d].greaterThan(0)){R=this.coeffs[d];break}if(R){for(;d>f;d--)this.coeffs[d]=this.coeffs[d].subtract(new ue(1)),this.coeffs[d-1]=this.coeffs[d-1].add(new ue(i));w=this.coeffs[f]}}let v=w.mod(new ue(i)),b=w.subtract(v).divide(new ue(i));if(!b.equals(0)){let R=f+1,U=this.coeffs[R]||new ue(0);U=U.add(b),this.coeffs[R]=U,this.coeffs[f]=v}}return this},add(i){let a=Math.max(this.coeffs.length,i.coeffs.length);for(let f=0;f<a;f++){let w=this.coeffs[f]||new ue(0),d=i.coeffs[f]||new ue(0);this.coeffs[f]=w.add(d)}return this},subtract(i){let a=Math.max(this.coeffs.length,i.coeffs.length);for(let f=0;f<a;f++){let w=this.coeffs[f]||new ue(0),d=i.coeffs[f]||new ue(0);this.coeffs[f]=w.subtract(d)}return this},divide(i){let{variable:a}=this,f=t.Utils.arrayClone(this.coeffs),w=t.Utils.arrayClone(i.coeffs),d=f.length,v=w.length-1,b=[];for(let B=0;B<d;B++){let te=d-(B+1),re=te-v,we=f[te].divide(w[v]);if(re<0)break;b[re]=we;for(let pe=0;pe<=v;pe++)f[pe+re]=f[pe+re].subtract(w[pe].multiply(we))}let R=he.fromArray(f,a||"x").trim();return[he.fromArray(b,a||"x"),R]},multiply(i){let a=this.coeffs.length,f=i.coeffs.length,w=[];for(let d=0;d<a;d++){let v=this.coeffs[d];for(let b=0;b<f;b++){let R=d+b,U=i.coeffs[b],B=w[R]||new ue(0);w[R]=B.add(v.multiply(U))}}return this.coeffs=w,this},isZero(){let i=this.coeffs.length;for(let a=0;a<i;a++)if(!this.coeffs[a].equals(0))return!1;return!0},sub(i){let a=new ue(0),f=this.coeffs.length;for(let w=0;w<f;w++){let d=this.coeffs[w];d.equals(0)||(a=a.add(d.multiply(new ue(i**w))))}return a},clone(){let i=new he;return i.coeffs=this.coeffs.slice(),i.variable=this.variable,i},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let i=this.lc(),a=this.coeffs.length;for(let f=0;f<a;f++)this.coeffs[f]=this.coeffs[f].divide(i);return this},gcd(i){let a=this.coeffs.length-1,f=i.coeffs.length-1,w;if(a<f)return i.gcd(this);let d=this;for(;!i.isZero();){let b=i.clone();d=d.clone(),w=d.divide(b),i=w[1],d=b}let v=t.Math2.QGCD.apply(null,d.coeffs);if(!v.equals(1)){let b=d.coeffs.length;for(let R=0;R<b;R++)d.coeffs[R]=d.coeffs[R].divide(v)}return d},diff(){let i=[],a=this.coeffs.length;for(let f=1;f<a;f++)i.push(this.coeffs[f].multiply(new ue(f)));return this.coeffs=i,this},integrate(){let i=[new ue(0)],a=this.coeffs.length;for(let f=0;f<a;f++){let w=new ue(f+1);i[f+1]=this.coeffs[f].divide(w)}return this.coeffs=i,this},gcf(i){let a=function(d){for(let v=0;v<d.length;v++)if(!d[v].equals(0))return v},f=[];for(let d=0;d<this.coeffs.length;d++){let v=this.coeffs[d];!v.equals(0)&&f.indexOf(v)===-1&&f.push(v)}let w=[t.Math2.QGCD.apply(void 0,f),a(this.coeffs)||0];if(i){let d=[];d[w[1]-1]=w[0],w=he.fromArray(d,this.variable).fill()}return w},quad(i){let a=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let f=this.coeffs[2]?Number(this.coeffs[2].toDecimal()):0,w=this.coeffs[1]?Number(this.coeffs[1].toDecimal()):0,d=Number(this.coeffs[0].toDecimal()),v=w*w-4*f*d;return v<0&&!i||(a[0]=(-w+Math.sqrt(v))/(2*f),a[1]=(-w-Math.sqrt(v))/(2*f)),a},squareFree(){let i=this.clone(),a=1,f=i.clone().diff(),w=i.clone().gcd(f),d=i.divide(w)[0],v=he.fromArray([new ue(1)],i.variable);for(;!w.equalsNumber(1);){let b=d.gcd(w),R=d.divide(b)[0];if(!R.equalsNumber(1)&&a>1){let U=R.clone();for(let B=1;B<a;B++)U.multiply(R.clone());R=U}v=v.multiply(R),a++,d=b,w=w.divide(b)[0]}return[v,d,a]},toSymbol(){let i=this.coeffs.length,{variable:a}=this;if(i===0)return new u(0);if(!a)throw new t.exceptions.NerdamerTypeError("Polynomial.toSymbol requires a variable. Constants should not be converted to Polynomial.");let f=[];for(let w=0;w<i;w++){let d=this.coeffs[w];d.equals(0)||f.push(`${d}*${a}^${w}`)}return f.length===0?new u(0):e.parse(f.join("+"))},equalsNumber(i){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(i)},toString(){return this.toSymbol().toString()}},u.prototype.coeffs=function(a,f){f&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),a||=[];let w=this.clone().distributeMultiplier();if(w.isComposite())for(let d in w.symbols){if(!Object.hasOwn(w.symbols,d))continue;let v=w.symbols[d];v.isComposite()?v.clone().distributeMultiplier().coeffs(a,f):f?a[v.isConstant()?0:Number(v.power.toDecimal())]=v.multiplier:a.push(v.multiplier)}else if(f)a[w.isConstant(!0)?0:Number(w.power.toDecimal())]=w.multiplier;else if(w.group===G&&w.isImaginary()){let d=new u(w.multiplier);w.each(v=>{(v.isConstant(!0)||v.imaginary)&&(d=e.multiply(d,v))}),a.push(d)}else a.push(w.multiplier);if(f)for(let d=0;d<a.length;d++)a[d]===void 0&&(a[d]=new u(0));return a},u.prototype.tBase=function(a){if(typeof a>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let f=[],w=this.collectSymbols(null,null,null,!0),d=w.length;for(let v=0;v<d;v++){let b=w[v],R=b.group,U=new be(b.multiplier,[],a);if(R===G)for(let B in b.symbols){if(!Object.hasOwn(b.symbols,B))continue;let te=b.symbols[B];U.terms[a[B]]=te.power}else U.terms[a[b.value]]=b.power;f.push(U.fill()),U.updateCount()}return f},u.prototype.altVar=function(a){let f=this.multiplier.toString(),w=this.power.toString();return(f==="1"?"":`${f}*`)+a+(w==="1"?"":`^${w}`)},u.prototype.sameVars=function(a){if(!(this.symbols||this.group===a.group))return!1;for(let f in this.symbols){if(!Object.hasOwn(this.symbols,f))continue;let w=this.symbols[f],d=a.symbols[f];if(!d||w.value!==d.value)return!1}return!0},u.prototype.groupTerms=function(a){a=String(a);let f,w,d,v=[];return this.each(b=>{if(b.group===D){d=b.groupTerms(a);for(let R=0;R<d.length;R++){let U=d[R];U&&(v[R]=U)}}else f=t.Utils.decompose_fn(b,a,!0),w=f.x.value===a?Number(f.x.power):0,v[w]=e.add(v[w]||new u(0),f.a)}),v},u.prototype.collectFactors=function(){let a=[];return this.group===G?this.each(f=>{a.push(f.clone())}):a.push(this.clone()),a};function Se(){this.factors={},this.length=0,this.preAdd=void 0,this.pFactor=void 0}Se.prototype.getNumberSymbolics=function(){let a=0;return this.each(f=>{f.isConstant(!0)||a++}),a},Se.prototype.add=function(a){if(a.equals(0))return this;if(a.equals(-1)&&this.length>0){let f=t.Utils.firstObject(this.factors,null,!0),w=e.symfunction(t.Settings.PARENTHESIS,[f.obj]).negate();return delete this.factors[f.key],this.add(w),this.length--,this}if(a.group===G){let f=this;a.multiplier.equals(1)||f.add(new u(a.multiplier)),a.each(w=>{f.add(w)})}else{this.preAdd&&(a=this.preAdd(a)),this.pFactor&&(a=e.pow(a,new u(this.pFactor)));let f=a.isConstant();if(f&&a.equals(1))return this;let w=f?a.value:a.text();w in this.factors?(this.factors[w]=e.multiply(this.factors[w],a),this.factors[w].equals(1)&&(delete this.factors[w],this.length--)):(this.factors[w]=a,this.length++)}return this},Se.prototype.toSymbol=function(){let a=new u(1),f=Object.values(this.factors).sort((w,d)=>w.group>d.group?1:-1);for(let w=0,d=f.length;w<d;w++){let v=f[w],b=v.power.equals(1)&&v.fname!==""?e.symfunction(t.Settings.PARENTHESIS,[v]):v;a=e.multiply(a,b)}return a.fname===""&&(a=u.unwrapPARENS(a)),a},Se.prototype.merge=function(a){for(let f in a)f in this.factors?this.factors[f]=e.multiply(this.factors[f],a[f]):this.factors[f]=a[f];return this},Se.prototype.each=function(a){for(let f in this.factors){if(!Object.hasOwn(this.factors,f))continue;let w=this.factors[f];w.fname===t.Settings.PARENTHESIS&&w.isLinear()&&(w=w.args[0]),a.call(this,w,f)}return this},Se.prototype.count=function(){return V(this.factors).length},Se.prototype.clean=function(){try{let a=t.Settings.CONST_HASH;this.factors[a].lessThan(0)&&(this.factors[a].equals(-1)?delete this.factors[a]:this.factors[a].negate(),this.each(f=>{f.negate()}))}catch(a){if(a.message==="timeout")throw a}},Se.prototype.toString=function(){return this.toSymbol().toString()};function be(i,a,f){this.terms=a||[],this.coeff=i,this.map=f,this.sum=new ue(0),this.image=void 0,this.revMap=void 0,this.count=void 0}be.prototype.updateCount=function(){this.count||=0;for(let a=0;a<this.terms.length;a++)this.terms[a].equals(0)||this.count++;return this},be.prototype.getVars=function(){let a=[];for(let f=0;f<this.terms.length;f++){let w=this.terms[f];this.getRevMap(),!w.equals(0)&&this.revMap&&a.push(this.revMap[f])}return a.join(" ")},be.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count||0},be.prototype.toSymbol=function(a){a||=this.getRevMap();let f=new u(this.coeff);for(let w=0;w<this.terms.length;w++){let d=a[w],v=this.terms[w];if(v.equals(0)||d===Pe)continue;let b=new u(d);b.power=v,f=e.multiply(f,b)}return f},be.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let a={};if(this.map)for(let f in this.map)Object.hasOwn(this.map,f)&&(a[this.map[f]]=f);return this.revMap=a,a},be.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},be.prototype.getImg=function(){return this.image||this.generateImage(),this.image||""},be.prototype.fill=function(){let a=this.map?this.map.length:0;for(let f=0;f<a;f++)typeof this.terms[f]>"u"?this.terms[f]=new ue(0):this.sum=this.sum.add(this.terms[f]);return this},be.prototype.divide=function(a){let f=this.coeff.divide(a.coeff),w=this.terms.length,d=new be(f,[],this.map);for(let v=0;v<w;v++)d.terms[v]=this.terms[v].subtract(a.terms[v]),d.sum=d.sum.add(d.terms[v]);return d},be.prototype.multiply=function(a){let f=this.coeff.multiply(a.coeff),w=this.terms.length,d=new be(f,[],this.map);for(let v=0;v<w;v++)d.terms[v]=this.terms[v].add(a.terms[v]),d.sum=d.sum.add(d.terms[v]);return d},be.prototype.isZero=function(){return this.coeff.equals(0)},be.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},t.Utils.toMapObj=function(a){let f=0,w={length:0};for(let d=0;d<a.length;d++){let v=a[d];typeof w[v]>"u"&&(w[v]=f,f++)}return w.length=f,w},t.Utils.filledArray=function(a,f,w){let d=[];for(;f--;)d[f]=w?new w(a):a;return d},t.Utils.arrSum=function(a){let f=0,w=a.length;for(let d=0;d<w;d++)f+=a[d];return f},t.Utils.haveIntersection=function(a,f){return f.length>a.length&&([a,f]=[f,a]),a.some(w=>f.indexOf(w)>-1)},t.Utils.subFunctions=function(a,f){f||={};let w=[],d=new Set(Ee(a));return a.each(v=>{if(v.group===C||v.previousGroup===C){let b=t.Utils.text(v,"hash"),R=f[b];if(R)w.push(v.altVar(R));else{let U=0,B;do B=v.fname+V(f).length+(U>0?String(U):""),U++;while(d.has(B));f[b]=B,w.push(v.altVar(B))}}else v.group===G||v.group===D||v.group===Z?w.push(t.Utils.subFunctions(v,f)):w.push(v.text())}),a.group===Z||a.group===D?a.altVar(t.Utils.inBrackets(w.join("+"))):a.group===G?a.altVar(t.Utils.inBrackets(w.join("*"))):a.text()},t.Utils.getFunctionsSubs=function(a){let f={};for(let w in a)Object.hasOwn(a,w)&&(f[a[w]]=e.parse(w));return f};let se=t.Algebra={version:"1.4.6",proots(i,a){a||=7;let f=0,w=[],d=function(b,R,U){let B=v(b,R,U).concat(w);for(let te=0;te<f;te++)B.unshift(0);return B};if(t.Utils.isSymbol(i)&&i.isPoly()){let b=i;if(b.distributeMultiplier(),b.group===D){let pe=t.Utils.arrayMin(V(b.symbols)),Ie=b.symbols[pe].clone().toUnitMultiplier();b=e.expand(e.divide(b,Ie)),w.push(0)}if(b.group===t.groups.S)return["0"];if(b.group===t.groups.PL){let pe=V(b.symbols),Ie=t.Utils.arrayMin(pe);b=t.PARSER.divide(b,t.PARSER.parse(`${b.value}^${Ie}`))}let R=V(b.symbols).sort().pop(),U=b.group===t.groups.PL?b.symbols:b.symbols[R||""],B=U.group,te=B===y?[U.power.toDecimal()]:V(U.symbols),re=[],we=t.Utils.arrayMax(te);for(let pe=1;pe<=we;pe++){let Ie=0;te.indexOf(`${pe}`)!==-1&&(B===y?Ie=U.multiplier:Ie=U.symbols[pe].multiplier),re.unshift(Ie)}return re.push(i.symbols[Pe].multiplier),b.group===y&&(re[0]=b.multiplier),d(re,te,we)}if(t.Utils.isArray(i)){let b=i,R=[],U=[],B=0;for(let re=0;re<b.length;re++){let we=b[re][0],pe=b[re][1],Ie=pe-B-1;for(let Ce=0;Ce<Ie;Ce++)R.unshift(0);R.unshift(we),pe!==0&&U.push(pe),B=pe}let te=Math.max.apply(void 0,U);return d(R,U,te)}throw new t.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function v(b,R,U){let te,re=b.slice(0);if(b.unshift(U),U>100)throw new t.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let we=[],pe={};for(pe.Degree=U,te=0;te<U;te++)we.push(0);let Ie=we.slice(0);function Ce(z,x,Y,X,O,fe){O[0]=fe.b=X[0],O[1]=fe.a=-(x*fe.b)+X[1];for(let c=2;c<z;c++)O[c]=-(x*fe.a+Y*fe.b)+X[c],fe.b=fe.a,fe.a=O[c]}function ge(z,x,Y,X,O,fe,c,p,I){let P={},k=3;return P.b=P.a=0,Ce(x,c,p,fe,I,P),O.c=P.a,O.d=P.b,Math.abs(O.c)<=100*z*Math.abs(fe[x-1])&&Math.abs(O.d)<=100*z*Math.abs(fe[x-2])||(O.h=p*X,Math.abs(O.d)>=Math.abs(O.c)?(k=2,O.e=Y/O.d,O.f=O.c/O.d,O.g=c*X,O.a3=O.e*(O.g+Y)+O.h*(X/O.d),O.a1=-Y+O.f*X,O.a7=O.h+(O.f+c)*Y):(k=1,O.e=Y/O.c,O.f=O.d/O.c,O.g=O.e*c,O.a3=O.e*Y+(O.g+O.h/O.c)*X,O.a1=-(Y*(O.d/O.c))+X,O.a7=O.g*O.d+O.h*O.f+Y)),k}function Le(z,x,Y,X,O,fe,c,p,I){if(Y===3){c[1]=c[0]=0;for(let k=2;k<x;k++)c[k]=p[k-2];return}let P=Y===1?O:X;if(Math.abs(fe.a1)>10*z*Math.abs(P)){fe.a7/=fe.a1,fe.a3/=fe.a1,c[0]=I[0],c[1]=-(I[0]*fe.a7)+I[1];for(let k=2;k<x;k++)c[k]=-(I[k-1]*fe.a7)+p[k-2]*fe.a3+I[k]}else{c[0]=0,c[1]=-(I[0]*fe.a7);for(let k=2;k<x;k++)c[k]=-(I[k-1]*fe.a7)+p[k-2]*fe.a3}}function xe(z,x,Y,X,O,fe,c,p,I,P,k,j,H,$,F,ie,me){let Ae,ve,De,Fe,We,Qe,ke,rt,Ke;x.b=x.a=0,z===3||(z===2?(Ae=(Y+k)*P+j,ve=(P+H)*p+$*I):(Ae=Y+H*c+j*P,ve=p+(H+$*P)*I),De=-(F[ie-1]/me[ie]),Fe=-(F[ie-2]+De*me[ie-1])/me[ie],We=$*Fe*X,Qe=De*fe,ke=De*De*O,rt=-(Qe+ke)+We,Ke=-rt+ve+De*Ae,Ke!==0&&(x.a=-((H*(ke+Qe)+$*(De*X+Fe*fe))/Ke)+H,x.b=$*(1+rt/Ke)))}function He(z,x,Y,X){let O,fe;if(X.sr=X.si=X.lr=X.li=0,z===0){X.sr=x===0?X.sr:-(Y/x);return}if(Y===0){X.lr=-(x/z);return}let c=x/2;Math.abs(c)<Math.abs(Y)?(fe=Y>=0?z:-z,fe=-fe+c*(c/Math.abs(Y)),O=Math.sqrt(Math.abs(fe))*Math.sqrt(Math.abs(Y))):(fe=-(z/c*(Y/c))+1,O=Math.sqrt(Math.abs(fe))*Math.abs(c)),fe>=0?(O=c>=0?-O:O,X.lr=(-c+O)/z,X.sr=X.lr===0?X.sr:Y/X.lr/z):(X.lr=X.sr=-(c/z),X.si=Math.abs(O/z),X.li=-X.si)}function Ze(z,x,Y,X,O,fe,c,p,I,P,k,j){let H={},$,F,ie,me=0,Ae,ve,De,Fe,We,Qe,ke,rt=0,Ke,at=0;Y.NZ=0,ve=X,Fe=O;do{if(H.li=H.lr=H.si=H.sr=0,He(1,ve,Fe,H),Y.szr=H.sr,Y.szi=H.si,Y.lzr=H.lr,Y.lzi=H.li,Math.abs(Math.abs(Y.szr)-Math.abs(Y.lzr))>.01*Math.abs(Y.lzr))break;for(Ce(c,ve,Fe,I,fe,p),F=Math.abs(-(Y.szr*p.b)+p.a)+Math.abs(Y.szi*p.b),Qe=Math.sqrt(Math.abs(Fe)),$=2*Math.abs(fe[0]),Ae=-(Y.szr*p.b),ke=1;ke<x;ke++)$=$*Qe+Math.abs(fe[ke]);if($=$*Qe+Math.abs(Ae+p.a),$=(9*$+2*Math.abs(Ae)-7*(Math.abs(p.a+Ae)+Qe*Math.abs(p.b)))*z,F<=20*$){Y.NZ=2;break}if(rt++,rt>20)break;if(rt>=2&&me<=.01&&F>=ie&&!at){for(me=me<z?Math.sqrt(z):Math.sqrt(me),ve-=ve*me,Fe+=Fe*me,Ce(c,ve,Fe,I,fe,p),ke=0;ke<5;ke++)Ke=ge(z,x,p.a,p.b,k,j,ve,Fe,P),Le(z,x,Ke,p.a,p.b,k,j,P,fe);at=1,rt=0}ie=F,Ke=ge(z,x,p.a,p.b,k,j,ve,Fe,P),Le(z,x,Ke,p.a,p.b,k,j,P,fe),Ke=ge(z,x,p.a,p.b,k,j,ve,Fe,P),xe(Ke,p,p.a,k.a1,k.a3,k.a7,p.b,k.c,k.d,k.f,k.g,k.h,ve,Fe,j,x,I),De=p.a,We=p.b,We!==0&&(me=Math.abs((-Fe+We)/We),ve=De,Fe=We)}while(We!==0)}function Ge(z,x,Y,X,O,fe,c,p,I){let P,k,j,H,$,F,ie,me,Ae,ve,De,Fe=X-1;for(x.NZ=De=Ae=0,ie=Y.a;;){for(F=O[0],c[0]=F,ve=1;ve<fe;ve++)c[ve]=F=F*ie+O[ve];for(j=Math.abs(F),H=Math.abs(ie),P=.5*Math.abs(c[0]),ve=1;ve<fe;ve++)P=P*H+Math.abs(c[ve]);if(j<=20*z*(2*P-j)){x.NZ=1,x.szr=ie,x.szi=0;break}if(De++,De>10)break;if(De>=2&&Math.abs(me)<=.001*Math.abs(-me+ie)&&j>$){Ae=1,x.a=ie;break}for($=j,I[0]=k=p[0],ve=1;ve<X;ve++)I[ve]=k=k*ie+p[ve];if(Math.abs(k)>Math.abs(p[Fe])*10*z)for(me=-(F/k),p[0]=c[0],ve=1;ve<X;ve++)p[ve]=me*I[ve-1]+c[ve];else for(p[0]=0,ve=1;ve<X;ve++)p[ve]=I[ve-1];for(k=p[0],ve=1;ve<X;ve++)k=k*ie+p[ve];me=Math.abs(k)>Math.abs(p[Fe])*10*z?-(F/k):0,ie+=me}return Ae}function ze(z,x,Y,X,O,fe,c,p,I,P,k,j){let H={},$={},F=new Array(x),ie=new Array(x),me,Ae,ve,De,Fe,We,Qe,ke,rt,Ke,at,Et,It,bt,Ot,Qt,vt,$t,qt,Tt=1,Bt,Jt,c0,Yt,r0,Kt;for(j.NZ=0,De=ve=.25,Fe=X,ke=O,H.b=H.a=0,Ce(I,k,O,p,P,H),me=H.a,Ae=H.b,$.h=$.g=$.f=$.e=$.d=$.c=$.a7=$.a3=$.a1=0,Yt=ge(z,c,me,Ae,$,fe,k,O,F),Bt=0;Bt<Y;Bt++){if($t=1,Le(z,c,Yt,me,Ae,$,fe,F,P),Yt=ge(z,c,me,Ae,$,fe,k,O,F),xe(Yt,H,me,$.a1,$.a3,$.a7,Ae,$.c,$.d,$.f,$.g,$.h,k,O,fe,c,p),Ot=H.a,vt=Qt=H.b,Ke=fe[c-1]===0?0:-(p[c]/fe[c-1]),at=It=1,Bt!==0&&Yt!==3&&(It=vt===0?It:Math.abs((vt-ke)/vt),at=Ke===0?at:Math.abs((Ke-Fe)/Ke),bt=It<Qe?It*Qe:1,Et=at<We?at*We:1,r0=bt<De?1:0,Jt=Et<ve?1:0,Jt||r0)){for(qt=0;qt<c;qt++)ie[qt]=fe[qt];for(rt=Ke,c0=Kt=0;;){if(!($t&&($t=0)==0&&Jt&&(!r0||Et<bt))){if(Ze(z,c,j,Ot,Qt,P,I,H,p,F,$,fe),me=H.a,Ae=H.b,j.NZ>0)return;if(Tt=Kt=1,De*=.25,c0||!Jt)Tt=0;else for(qt=0;qt<c;qt++)fe[qt]=ie[qt]}if(Tt!==0){if(H.a=rt,Tt=Ge(z,j,H,c,p,I,P,fe,F),rt=H.a,j.NZ>0)return;if(c0=1,ve*=.25,Tt!==0){Ot=-(rt+rt),Qt=rt*rt;continue}}for(qt=0;qt<c;qt++)fe[qt]=ie[qt];if(!r0||Kt)break}Ce(I,k,O,p,P,H),me=H.a,Ae=H.b,Yt=ge(z,c,me,Ae,$,fe,k,O,F)}ke=vt,Fe=Ke,Qe=It,We=at}}function Ye(z,x,Y,X){let O=z.Degree,fe=Math.PI/180,c=Math.LN2,p=z.Degree+1,I=new Array(p),P=new Array(p),k=new Array(p),j=new Array(p),H={},$={},F,ie,me,Ae,ve,De,Fe,We,Qe,ke,rt,Ke,at,Et,It,bt,Ot,Qt,vt,$t,qt,Tt,Bt,Jt;Ke=1;do ie=Ke,Ke/=2,at=1+Ke;while(at>1);let c0=Number.MIN_VALUE/ie,Yt=Math.cos(94*fe),r0=Math.sin(94*fe),Kt=Math.sqrt(.5),v0=-Kt;for($.NZ=vt=0,$.szr=$.szi=$.lzr=$.lzi=0;x[O]===0;)Y[vt]=X[vt]=0,O--,vt++;for(Bt=O+1;O>=1;){if(O<=2){O<2?(Y[z.Degree-1]=-(x[1]/x[0]),X[z.Degree-1]=0):(H.li=H.lr=H.si=H.sr=0,He(x[0],x[1],x[2],H),Y[z.Degree-2]=H.sr,X[z.Degree-2]=H.si,Y[z.Degree-1]=H.lr,X[z.Degree-1]=H.li);break}for(Fe=0,We=Number.MAX_VALUE,te=0;te<Bt;te++)ke=Math.abs(x[te]),ke>Fe&&(Fe=ke),ke!==0&&ke<We&&(We=ke);if(Qe=c0/We,(Qe<=1&&Fe>=10||Qe>1&&Number.MAX_VALUE/Qe>=Fe)&&(Qe=Qe===0?Number.MIN_VALUE:Qe,qt=Math.floor(Math.log(Qe)/c+.5),ve=2**qt,ve!==1))for(te=0;te<Bt;te++)x[te]*=ve;for(let h=0;h<Bt;h++)P[h]=Math.abs(x[h]);P[O]=-P[O],Tt=O-1,ke=Math.exp((Math.log(-P[O])-Math.log(P[0]))/O),P[Tt]!==0&&(rt=-P[O]/P[Tt],ke=rt<ke?rt:ke),rt=ke;do{ke=rt,rt=.1*ke,De=P[0];for(let h=1;h<Bt;h++)De=De*rt+P[h]}while(De>0);Ae=ke;do{me=De=P[0];for(let h=1;h<O;h++)De=ke*De+P[h],me=ke*me+De;De=ke*De+P[O],Ae=De/me,ke-=Ae}while(Math.abs(Ae/ke)>.005);F=ke;for(let h=1;h<O;h++)I[h]=(O-h)*x[h]/O;for(I[0]=x[0],Ke=x[O],at=x[Tt],Jt=I[Tt]===0?1:0,$t=0;$t<5;$t++)if(Et=I[Tt],Jt){for(let h=0;h<Tt;h++)vt=Tt-h,I[vt]=I[vt-1];I[0]=0,Jt=I[Tt]===0?1:0}else{bt=-Ke/Et;for(let h=0;h<Tt;h++)vt=Tt-h,I[vt]=bt*I[vt-1]+x[vt];I[0]=x[0],Jt=Math.abs(I[Tt])<=Math.abs(at)*ie*10?1:0}for(let h=0;h<O;h++)j[h]=I[h];for($t=1;$t<=20;$t++)if(Qt=-(r0*v0)+Yt*Kt,v0=r0*Kt+Yt*v0,Kt=Qt,It=F*Kt,Ot=-(2*It),ze(ie,p,20*$t,It,F,I,O,x,Bt,k,Ot,$),$.NZ===0)for(let h=0;h<O;h++)I[h]=j[h];else{vt=z.Degree-O,Y[vt]=$.szr,X[vt]=$.szi,Bt-=$.NZ,O=Bt-1;for(let h=0;h<Bt;h++)x[h]=k[h];$.NZ===1||(Y[vt+1]=$.lzr,X[vt+1]=$.lzi);break}if($t>20){z.Degree-=O;break}}}Ye(pe,re,Ie,we);let J=we.length,ne=[];for(te=0;te<J;te++){let z=ae(we[te],a+8),x=ae(Number(Ie[te]),a+8);x=a-String(x).length>2?x:Number(Ie[te]);let Y=Number(z)<0?"-":"",X=x,O=z;x===0&&(X=""),z===0&&(O=""),Math.abs(Number(z))===1?O=`${Y}i`:z?O=`${z}*i`:O="";let fe=X&&O?`${X}+${O}`:String(X)+String(O);ne[te]=fe.replace(/\+-/gu,"-")}return ne}},roots(i){if(i.isConstant(!0,!0))return t.Utils.nroots(i);let a=se.proots(i).map(f=>e.parse(f));return t.Vector.fromArray(a)},froot(i,a,f){return function(d){let b=f||t.Build.build(t.Calculus.diff(i.clone())),R=i instanceof Function?i:t.Build.build(i),U=1e4,B=!1,te=0;for(;!B;){let re=d-R(d)/b(d),we=Math.abs(re)-Math.abs(d),pe=Math.abs(we);d=re,pe<1e-12?B=!0:te>U&&(d=null,B=!0),te++}return d}(Number(a))},quad(i,a,f){let w=function(d,v,b,R){return e.parse(`-(${v}+${R}*sqrt((${v})^2-4*(${d})*(${b})))/(2*${d})`)};return[w(i,a,f,1),w(i,a,f,-1)]},sumProd(i,a){return se.quad(-a,i,-1).map(f=>f.invert())},coeffs(i,a,f){i=e.expand(i),f||=[new u(0)];let w=Ee(i);a===void 0&&w.length===1&&(a=w[0]),a=String(a),i.group===L&&i.contains(a,!0)&&e.error(`Unable to get coefficients using expression ${i.toString()}`),w=Ee(i);let d=i.contains("pi")||i.contains("e")||i.containsFunction("sqrt");if(w.length===1&&w[0]===a&&!i.isImaginary()&&!d){let v=new he(i).coeffs.map(b=>new u(b));for(let b=0,R=v.length;b<R;b++){let U=v[b],B=f[b];B&&(U=e.add(B,U)),f[b]=U}}else if(w.length===1&&w[0]===a&&!i.isImaginary()&&d&&i.group===Z){let v=t.Utils.getCoeffs(i,a);for(let b=0,R=v.length;b<R;b++){let U=v[b],B=f[b];B&&(U=e.add(B,U)),f[b]=U}}else if(a||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),w.indexOf(a)===-1)f[0]=e.add(i,f[0]);else{f||=[new u(0)];let v;if(i.group===G){let b=i.symbols[a];b||e.error("Expression is not a polynomial!");let R=Number(b.power);v=e.divide(i.clone(),b.clone()),(v.contains(a,!0)||R<0||!ce(R))&&e.error("Expression is not a polynomial!");let U=f[R];U&&(v=e.add(U,v)),f[R]=v}else i.group===Z&&i.each(b=>{se.coeffs(b.clone(),a,f)},!0)}for(let v=0,b=f.length;v<b;v++)typeof f[v]>"u"&&(f[v]=new u(0));return f},polyPowers(i,a,f){f||=[];let w=i.group;if(w===D&&a===i.value)f=f.concat(V(i.symbols));else if(w===Z)for(let d in i.symbols){if(!Object.hasOwn(i.symbols,d))continue;let v=i.symbols[d],b=v.group,R=v.value;if(b===y&&a===R)f.push(v.power);else if(b===D||b===Z)f=se.polyPowers(v,a,f);else if(b===G&&v.contains(a)){let U=v.symbols[a];U&&f.push(U.power)}else(b===o||a!==R)&&f.push(0)}else if(w===G&&i.contains(a)){let d=t.Utils.decompose_fn(i,a,!0);f.push(d.x.power)}return t.Utils.arrayUnique(f).sort()},Factor:{split(i){let a=new u(1),f=new u(1);return se.Factor.factorInner(i,new Se).each(w=>{let d=e.parse(w);w.isConstant(!0)?a=e.multiply(a,d):f=e.multiply(f,d)}),[a,f]},mix(i,a){let f=V(i),w=f.length,d=[];for(let v=0;v<w;v++){let b=Number(f[v]),R=i[f[v]],U=d.length;for(let B=0;B<U;B++){let te=d[B]*b;d.push(te),a&&d.push(-te)}for(let B=1;B<=R;B++)d.push(b**B)}return d},common(i,a){try{if(i.group===Z){let f=e.expand(i.clone(),{expand_denominator:!0}),w=B=>B.length||1,d=f.collectSymbols(null,null,(B,te)=>w(te)-w(B)),v={},b=[];for(let B=0;B<d.length;B++){let te=d[B];b.push(te.multiplier.clone()),te.each(re=>{let we=Number(re.power);if(isNaN(we))throw new Error("exiting");re.value in v?(we<v[re.value][0]&&(v[re.value][0]=we),v[re.value][1].push(re)):v[re.value]=[we,[re]]})}let R=new u(1);for(let B in v)v[B][1].length===d.length&&(R=e.multiply(R,e.pow(new u(B),new u(v[B][0]))));let U=t.Math2.QGCD.apply(null,b);if(!U.equals(1)){a.add(new u(U));for(let B=0;B<d.length;B++)d[B].multiplier=d[B].multiplier.divide(U)}if(!R.equals(1)){a.add(R),i=new u(0);for(let B=0;B<d.length;B++)i=e.add(i,e.divide(d[B],R.clone()))}}}catch(f){if(f.message==="timeout")throw f}return i},zeroes(i,a){let f=function(){throw new t.exceptions.ValueLimitExceededError("Exiting")};try{let w,d,v;i=e.expand(i.clone());let b=i.toString(),R=Ee(i);d=new u(0);let U=[],B=[];for(let te=0,re=R.length;te<R.length;te++){let we={};for(let Ie=0;Ie<re;Ie++)te!==Ie&&(we[R[Ie]]=0);w=e.parse(b,we);let pe=w.power;ce(pe)||f(),U.push(w),B.push(w.power)}if(t.Utils.allSame(B)){let te=i.length,re=U.length,we=Math.round((Math.sqrt(8*te-1)-3)/2);re===2?v=new ue(Number(B[0])/(te-1)):re===3&&we!==0?v=new ue(Number(B[0])/we):v=t.Math2.QGCD.apply(null,B)}else v=t.Math2.QGCD.apply(null,B);if(!ce(v))return i;for(let te=0;te<U.length;te++){let re=U[te],we=re.power.clone().divide(v),pe=Number(we);if((Number(re.multiplier.num)<0||Number(re.multiplier.den)<0)&&pe%2===0)return i;re.multiplier=new ue(Number(re.multiplier)**(1/pe)),re.power=v.clone(),d=e.add(d,re)}if(d.group!==Z)return i;for(;;){let te=se.div(i.clone(),d.clone());if(te[1].equals(0)){if(i=te[0],a.add(d.clone()),i.equals(1))break}else break}}catch(w){if(w.message==="timeout")throw w}return i},factor(i,a){t.Utils.checkTimeout();let f=a?[...a]:null;try{let w=se.Factor.factorInner(i,a);return w=w.pushMinus(),w}catch(w){if(w.message==="timeout")throw w;return a&&a.splice(0,a.length,...f),i}},factorInner(i,a){if(t.Utils.checkTimeout(),i.isConstant()&&i.isInteger())return t.Math2.factor(Number(i.multiplier));let f=e.parse(i);if(f.isConstant())return f.isInteger()?t.Math2.factor(Number(f.multiplier)):i;if(f.equals(0)||f.equals(1))return f;let w=se.Factor._factor(f,a);if(w.equals(i)||w.equals(0)||w.equals(1))return w;if(w.group===G){let d=new u(1),v=e.parse(w.power),b=e.parse(w.multiplier);w.toUnitMultiplier(),w.multiplier.lessThan(0)&&(d.negate(),w.negate()),w.each(U=>{let B=e.parse(se.Factor._factor(U));if(b=e.multiply(b,u.create(B.multiplier.toString())),B.toUnitMultiplier(),B.group===G){let te=new u(1);B.each(re=>{let we=e.parse(se.Factor._factor(re));we.group===G&&(b=e.multiply(b,u.create(we.multiplier.toString())),we.toUnitMultiplier()),te=e.multiply(te,we)}),te=e.pow(te,new u(B.power.toString())),d=e.multiply(d,te)}else d=e.multiply(d,B)});let R=e.pow(d,v);w=e.multiply(b,R)}return w},quadFactor(i,a){if(i.isPoly()&&se.degree(i.equals(2))){let f=t.Utils.variables(i)[0],w=se.coeffs(i,f);if(w.length<3)return i;let d=se.Factor._factor(w[2].clone());if(d.group===G){let v=d.collectSymbols();if(v.length>2)return i;let b=e.multiply(e.parse(w[0]),e.parse(v[0])),R=e.parse(w[1]).negate(),U=e.parse(v[1]),B=se.quad(U,R,b).filter(te=>t.Utils.isInt(te));if(B.length===1){let te=B[0],re=e.divide(w[0],e.parse(te));t.Utils.isInt(re)&&(a.add(e.parse(Me("({0})*({1})+({2})",String(v[1]),f,String(re)))),a.add(e.parse(Me("({0})*({1})+({2})",String(v[0]),f,te))),i=new u(1))}}}return i},cubeFactor(i,a){if(i.isComposite()){let f=i.collectSymbols();if(f.length===2){let w=f[0].sign(),d=f[0].clone().abs(),v=f[1].sign(),b=f[1].clone().abs();if(d.isCube()&&b.isCube()){w<v&&([w,v]=[v,w],[d,b]=[b,d]);let R=e.parse(d.getNth(3)),U=e.parse(b.getNth(3)),B=e.multiply(e.expand(e.pow(d.clone().toUnitMultiplier(),e.parse("1/3"))),R),te=e.multiply(e.expand(e.pow(b.clone().toUnitMultiplier(),e.parse("1/3"))),U);w===1&&v===-1?(a.add(e.parse(Me("(({0})-({1}))",String(B),String(te)))),a.add(e.parse(Me("(({0})^2+({0})*({1})+({1})^2)",String(B),String(te)))),i=new u(1)):w===1&&v===1&&(a.add(e.parse(Me("(({0})+({1}))",String(B),String(te)))),a.add(e.parse(Me("(({0})^2-({0})*({1})+({1})^2)",String(B),String(te)))),i=new u(1))}}}return i},_factor(i,a){t.Utils.checkTimeout();let f=i.group;if(i.group===C){let d=i.args[0];if(d.group===y&&d.isSimple())return i}else if(i.group===y&&i.isSimple())return i;if(i.group===Z){i.distributeMultiplier(!0);let d=new u(0);i.each(v=>{(v.group===Z&&v.power.greaterThan(1)||v.group===G)&&(v=e.expand(v)),d=e.add(d,v)}),d.power=i.power,i=d}i.group===C&&i.fname!=="sqrt"&&(i=t.Utils.evaluate(i));let w=i.clone();try{if(i.group===G){let v=e.parse(i.power),b=se.Simplify.strip(i.getDenom()),R=se.Simplify.strip(i.getNum()),U=b.pop(),B=R.pop();if(B.equals(i))return i;let te=se.Factor.factorInner(B),re=se.Factor.factorInner(U),we=se.Simplify.unstrip(R,te),pe=se.Simplify.unstrip(b,re);return e.divide(we,pe)}if(i.group===y)return i;if(i.isConstant())return i.equals(1)||i.equals(0)||!i.isInteger()?i.clone():t.Math2.factor(i);let d=i.power.clone();if(ce(d)&&!(d.lessThan(0)&&i.group===C)){let v=d.sign();i.toLinear(),a||=new Se;let b={};i=e.parse(t.Utils.subFunctions(i,b)),V(b).length>0&&(a.preAdd=function(Ie){return e.parse(Ie,t.Utils.getFunctionsSubs(b))}),i.isLinear()||(a.pFactor=i.power.toString(),i.toLinear());let R=Ee(i);i.isImaginary()&&R.push(t.Settings.IMAGINARY);let U=R.length>1;if(U){let pe=!0,Ie=!0;if(i.each(Ce=>{Ce.group!==y&&(pe=!1),Ce.multiplier.equals(1)||(Ie=!1)}),pe&&Ie)return e.pow(e.parse(i,t.Utils.getFunctionsSubs(b)),e.parse(d))}let B=new Se;i=se.Factor.coeffFactor(i,B),B.each(pe=>{de(d)&&pe.lessThan(0)&&pe.negate(),v<0&&pe.invert(),a.add(pe)});let te=new Se;if(i=se.Factor.powerFactor(i,te),te.each(pe=>{v<0&&pe.invert(),a.add(pe)}),U)i=se.Factor.cubeFactor(i,a),i=se.Factor.mfactor(i,a),a.each(pe=>{v<0&&pe.power.negate()});else{let pe=R[0];i=se.Factor.squareFree(i,a,pe);let Ie=new Se;i=se.Factor.trialAndError(i,Ie,pe);let Ce=Ie.toSymbol();if(Ce.equals(w))return Ce;for(let ge in Ie.factors){if(!Object.hasOwn(Ie.factors,ge))continue;let Le=Ie.factors[ge];a.add(e.pow(Le,e.parse(d)))}i.equals(w)&&(i=se.Factor.quadFactor(i,a))}i=e.parse(i,t.Utils.getFunctionsSubs(b));let re=a.length===1;a.add(e.pow(i,e.parse(d)));let we=a.toSymbol();return re&&i.equals(1)&&we.isLinear()&&(we=e.pow(we,e.parse(d))),we}return i}catch(d){if(d?.message==="timeout")throw d;return w}},reduce(i,a){if(i.group===Z&&i.length===2){let f=i.collectSymbols().sort((w,d)=>Number(d.multiplier)-Number(w.multiplier));if(f[0].power.equals(f[1].power)){let w=e.parse(f[0].power),d=f[0].clone().toLinear(),v=f[1].clone().toLinear();a.add(e.add(d.clone(),v.clone())),v.negate();let b=Number(w),R=new u(0);for(let U=1;U<=b;U++){let B=e.pow(d.clone(),e.subtract(w.clone(),new u(U))),te=e.pow(v.clone(),e.subtract(new u(U),new u(1)));R=e.add(R,e.multiply(B,te))}return R}}return i},squareFree(i,a,f){if(i.isConstant()||i.group===y||!i.isPoly())return i;let d=new he(i,f).squareFree(),v=d[2];if(v!==1){let b=d[1].toSymbol();return b.power=b.power.multiply(new ue(v)),a.add(se.Factor.factorInner(b)),se.Factor.squareFree(d[0].toSymbol(),a)}return i},powerFactor(i,a){if(i.group!==D||i.previousGroup===L)return i;let f=V(i.symbols);if(!t.Utils.allNumeric(f))return i;let w=t.Utils.arrayMin(f),d=new u(0),v=e.parse(`${i.value}^${w}`);return i.each(b=>{b=e.divide(b,v.clone()),d=e.add(d,b)}),a.add(v),d},coeffFactor(i,a){if(i.isComposite()){let f=t.Math2.QGCD.apply(null,i.coeffs());if(f.equals(1)){let w=function(b){let R;return b.group===G?(R=0,b.each(U=>{R+=U.power})):R=Number(b.power),R},d=i.collectSymbols(null,null,null,!0).sort((b,R)=>b.isConstant(!0)?1:Number(R.power)-Number(b.power)),v=d[0];(w(v)>w(d[1])||d[1].isConstant(!0))&&v.multiplier.lessThan(0)&&(a.add(new u(-1)),i.each(b=>{b.negate()},!0))}else i.each(w=>{w.isComposite()?w.each(d=>{d.multiplier=d.multiplier.divide(f)}):w.multiplier=w.multiplier.divide(f)}),i.updateHash();a&&a.add(new u(f))}return i},trialAndError(i,a,f){let w=i.clone();try{let d=[];if(i.isConstant()||i.group===y||!i.isPoly())return i;let v=new he(i,f),b=v.coeffs[0],R=t.Math2.ifactor(Number(b)),U=se.proots(i);for(let B=0;B<U.length;B++){let te=U[B],re=1;if(!isNaN(Number(te))){for(let ge in R){if(!Object.hasOwn(R,ge))continue;let Le=t.Utils.round(Math.log(Number(ge))/Math.log(Math.abs(Number(te))),8);if(ce(Le)){te=ge,re=Number(Le);break}}let we=new ue(Number(te)),pe=[new ue(Number(we.num)).negate()];pe[re]=new ue(Number(we.den));let Ie=he.fromArray(pe,v.variable).fill(),Ce=v.divide(Ie);Ce[1].equalsNumber(0)&&(v=Ce[0],d.push(Ie.toSymbol()))}}return v.equalsNumber(1)||(v=se.Factor.search(v,a)),d.forEach(B=>{a.add(B)}),v.toSymbol()}catch(d){if(d.message==="timeout")throw d;return w}},search(i,a,f){f||=10;let w=i.variable,d=function(Ce,ge,Le,xe){let He=he.fit(Ce,ge,Le,f,xe,w);if(He&&He.coeffs.length>1){let Ze=i.divide(He);if(Ze[1].equalsNumber(0))return a.add(He.toSymbol()),[Ze[0],He]}return null},v=i.coeffs[0],b=t.Math2.ifactor(Number(v)),R=i.lc(),U=t.Math2.ifactor(Number(R)),B=i.sub(f),te=t.Math2.ifactor(B),re=se.Factor.mix(te,B<0),we=Math.ceil(i.coeffs.length/2),pe=R.lessThan(0),Ie=v.lessThan(0);for(U[1]=1,b[1]=1;we--;)for(let Ce in U)if(Object.hasOwn(U,Ce)){for(let ge in b)if(Object.hasOwn(b,ge))for(let Le=0;Le<re.length;Le++){let xe=d(Number(Ce),Number(ge),re[Le],we);if(xe)return i=xe[0],t.Utils.isPrime(i.sub(f))||(i=se.Factor.search(i,a)),i;xe||(pe&&Ie?xe=d(-Number(Ce),-Number(ge),re[Le],we):pe?xe=d(-Number(Ce),Number(ge),re[Le],we):Ie&&(xe=d(Number(Ce),-Number(ge),re[Le],we)))}}return i},mSqfrFactor(i,a){if(i.group!==C){let f=Ee(i).reverse();for(let w=0;w<f.length;w++){let d=!1;do{if(f[w]===i.value){a.add(i),i=new u(1);continue}let v=t.Calculus.diff(i,f[w]),b=se.Factor.coeffFactor(v);if(b.equals(0)||b.equals(1)||b.equals(-1))break;let R=!0;b.isConstant()&&i.isComposite()&&i.each(B=>{Number(B.multiplier)%Number(b.multiplier)!==0&&(R=!1)},!0);let U;if(R){let B=i.clone();if(U=se.divWithCheck(i,b.clone()),d=U[1].equals(0),i.equals(U[0])&&U[1].equals(0)){i=B;break}if(U[0].isConstant()){a.add(U[0]);break}}else d=!1;d&&(a.add(U[0]),i=b)}while(d)}}return i},sqdiff(i,a){if(i.isConstant("all"))return i;try{let f=function(v){return t.Utils.block("POSITIVE_MULTIPLIERS",()=>u.unwrapPARENS(ye.sqrt(ye.abs(v))),!0)},w=t.Utils.separate(i.clone());if(!w)return i;let d=[];for(let v in w)v!=="constants"&&d.push(w[v]);if(d.sort((v,b)=>Number(b.power)-Number(v.power)),d.length===2){let v,b;if(v=d.pop(),b=d.pop(),de(Number(v.power))&&de(Number(b.power))&&v.sign()===b.sign()&&v.group===y&&b.group===y)throw new Error("Unable to factor");if(v.isComposite()&&b.power.equals(2)&&v.sign()!==b.sign()){b=f(b);let R=se.Factor.factorInner(e.add(v,w.constants));R.power.equals(2)&&(R.toLinear(),a.add(e.subtract(R.clone(),b.clone())),a.add(e.add(R,b)),i=new u(1))}else if(v=v.powSimp(),b=b.powSimp(),(v.group===y||v.fname==="")&&v.power.equals(2)&&(b.group===y||b.fname==="")&&b.power.equals(2)&&!w.constants){if(v.multiplier.lessThan(0)){let R=b;b=v,v=R}v.multiplier.greaterThan(0)&&(v=f(v),b=f(b)),a.add(e.subtract(v.clone(),b.clone())),a.add(e.add(v,b)),i=new u(1)}}}catch(f){if(f.message==="timeout")throw f}return i},mfactor(i,a){if(i.group===C)if(i.fname==="sqrt"){let f=new Se,w=se.Factor.common(i.args[0].clone(),f);w=se.Factor.coeffFactor(w,null),i=e.multiply(e.symfunction("sqrt",[w]),e.parse(i.multiplier)),f.each(d=>{i=e.multiply(i,e.parse(t.Utils.format("sqrt({0})",String(d))))})}else a.add(i),i=new u(1);else{i=se.Factor.mSqfrFactor(i,a);let f=Ee(i),w=i.collectSymbols().map(U=>u.unwrapSQRT(U)),d={},v={},b=f.length,R=w.length;for(let U=0;U<b;U++){let B=f[U];d[B]=new u(0);for(let te=0;te<R;te++){let re=w[te];if(re.contains(B)){let we=re.value===B?re.power.toDecimal():re.symbols[B].power.toDecimal();(!v[B]||we<v[B])&&(v[B]=we),d[B]=e.add(d[B],re.clone())}}}for(let U in d){if(!Object.hasOwn(d,U))continue;let B=e.parse(`${U}^${v[U]}`),te=e.divide(d[U],B),re=e.expand(te);if(re.equals(1)||re.equals(-1))break;let we=se.div(i.clone(),re);if(we[0].equals(0))break;if(we[1].equals(0)){let Ie=!1;if(we[0].each(Ce=>{ce(Ce.multiplier)||(Ie=!0)}),Ie){we[1]=e.expand(e.multiply(we[1],re));break}}let pe=ce(re)&&re.lessThan(0);if(we[1].equals(0)&&!pe){let Ie=se.divWithCheck(i.clone(),we[0].clone()),Ce=Ie[0];if(Ce.equals(0)||(i=Ie[1],Ce.equals(-1)&&!i.equals(0)))return i;let ge=we[0];if(i.equals(ge)){let Le=se.Factor.reduce(ge,a);return i.equals(Le)?Le:se.Factor.mfactor(Le,a)}return a.add(ge),i.equals(0)?Ce:Ce.isConstant("all")?(a.add(Ce),Ce):(i=se.Factor.mfactor(Ce,a),i)}}}return i=se.Factor.sqdiff(i,a),i=se.Factor.zeroes(i,a),i}},allLinear(i){let a=i.length;for(let f=0;f<a;f++)if(!se.isLinear(i[f]))return!1;return!0},isLinear(i){let a=!1,f=i.group;if(f===D||f===Z){a=!0;for(let w in i.symbols){if(!Object.hasOwn(i.symbols,w))continue;let d=i.symbols[w],v=d.group;if((v===C||v===L)&&(a=!1),v===G)a=Ee(d).length===1;else if(v===D||v===Z)a=se.isLinear(d);else if(d.group!==o&&d.power.toString()!=="1"){a=!1;break}}}else f===y&&i.power===1&&(a=!0);return a},gcd(...i){let a;if(i.length===1&&i[0]instanceof t.Vector?a=i[0].elements:a=i,a.length===0)return new u(1);if(a.length===1)return a[0];let f=[],w=!1;for(let d=0;d<a.length;d++)if(a[d].group===C&&a[d].fname==="gcd")a=a.concat(a[d].args),a.splice(d,1);else{let v=Ee(a[d]);if(t.Utils.haveIntersection(v,f)){w=!0;break}else f=f.concat(v)}if(w||f.length===0){if(a.every(d=>d.getDenom().equals(1))){let d=a[0];for(let v=1;v<a.length;v++)d=se.gcd_(a[v],d);return d}return e.divide(se.gcd.apply(null,a.map(d=>d.getNum())),se.lcm.apply(null,a.map(d=>d.getDenom())))}return e.symfunction("gcd",a)},gcd_(i,a){if((i.group===C||i.group===g)&&(i=t.Utils.block("PARSE2NUMBER",()=>e.parse(i))),a.group===C&&(a=t.Utils.block("PARSE2NUMBER",()=>e.parse(a))),i.isConstant()&&a.isConstant())return new u(t.Math2.QGCD(new ue(Number(i)),new ue(Number(a))));let f=e.multiply(i.getDenom()||new u(1),a.getDenom()||new u(1)).invert();if(i=e.multiply(i.clone(),f.clone()),a=e.multiply(a.clone(),f.clone()),i=e.expand(i),a=e.expand(a),i.group===G||a.group===G){let U=e.divide(i.clone(),a.clone()),B=e.multiply(a.clone(),U.getDenom().invert());if(!B.equals(1))return B}if(i.group===L||a.group===L){let U=new u(t.Math2.GCD(i.multiplier,a.multiplier)),B=se.gcd_(i.value===Pe?new u(1):e.parse(i.value),a.value===Pe?new u(1):e.parse(a.value)),te=se.gcd_(e.parse(i.power),e.parse(a.power));return e.multiply(U,e.pow(B,te))}if(i.length<a.length){let U=i;i=a,a=U}let w=Ee(i),d=Ee(a);if(w.length===1&&d.length===0||w.length===0&&d.length===1){let U=w.length===1?i:a,B=w.length===0?i:a;return B.equals(0)?U:new u(t.Math2.QGCD(U.multiplier,B.multiplier))}if(w.length===d.length&&w.length===1&&w[0]===d[0])return i=new he(i),a=new he(a),e.divide(i.gcd(a).toSymbol(),f);let v=[];i.each(U=>{v.push(U.multiplier)}),a.each(U=>{v.push(U.multiplier)});let b;for(;!a.equals(0);){let U=a.clone();if(i=i.clone(),b=se.div(i,U),a=b[1],b[0].equals(0))return e.divide(new u(t.Math2.QGCD(i.multiplier,a.multiplier)),f);i=U}let R=t.Math2.QGCD.apply(void 0,v);return R.equals(1)||i.each(U=>{U.multiplier=U.multiplier.divide(R)}),i.equals(1)&&!i.isConstant()&&!a.isConstant()?e.divide(e.symfunction("gcd",[i,a]),f):e.divide(i,f)},lcm(...i){let a;i.length===1?i[0]instanceof t.Vector?a=i[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):a=i;let f=a.reduce((b,R)=>e.multiply(b,R.clone()),new u(1)),w=(function(R,U){U=Number(U);let B=[],te,re,we,pe=2**R.length;for(re=U;re<pe;re++){te=[],we=R.length-1;do(re&1<<we)!==0&&te.push(R[we]);while(we--);te.length===U&&B.push(te)}return B})(a,a.length-1).map(b=>b.reduce((R,U)=>e.multiply(R,U.clone()),new u(1))),d;return a.every(b=>t.Utils.isVariableSymbol(b))?d=e.symfunction("gcd",t.Utils.arrayUnique(w)):d=se.gcd.apply(null,w),e.divide(f,d)},divide(i,a){let f,w=se.Factor.factorInner(i.clone());f=w.getDenom(),f.isConstant("all")?f=new u(1):i=e.expand(u.unwrapPARENS(e.multiply(w,f.clone())));let d=se.div(i,a),v=e.divide(d[1],a);return e.divide(e.add(d[0],v),f)},divWithCheck(i,a){let f=[new u(0),i.clone()],w=se.div(i,a),d=i.clone(),v=e.multiply(w[0].clone(),a.clone());v=e.add(v,w[1].clone());let b=e.subtract(d,v);return b=e.expand(b),b.equals(0)?w:f},div(i,a){let f=[new u(0),i.clone()];try{if(a.isConstant("all"))return i.each(re=>{re.multiplier=re.multiplier.divide(a.multiplier)}),[i,new u(0)];if(i=e.expand(i),a=e.expand(a),i.group===y&&a.group===Z){let re=i.value,we=t.Utils.decompose_fn(a.clone(),re,!0);if(i.isLinear()&&we.x&&we.x.isLinear()&&a.isLinear()){let pe=u.create(i.multiplier);return[e.divide(pe.clone(),we.a.clone()),e.divide(e.multiply(pe,we.b),we.a).negate()]}}if(i.group===y&&a.group===y){let re=e.divide(i.clone(),a.clone());return re.isConstant()?[re,new u(0)]:[new u(0),i.clone()]}let w=i.hasFunc(),d=a.hasFunc(),v=!1,b;if(w||d){v=!0;let re={};i=e.parse(t.Utils.subFunctions(i,re)),a=e.parse(t.Utils.subFunctions(a,re)),b=t.Utils.getFunctionsSubs(re)}let R=t.Utils.arrayUnique(Ee(i).concat(Ee(a))),U,B,te;if((i.isImaginary()||a.isImaginary())&&R.push(t.Settings.IMAGINARY),R.length===1){let re=new he(i).divide(new he(a));U=re[0].toSymbol(),B=re[1].toSymbol()}else{R.push(Pe);let re=function(ze){let Ye=new u(0);for(let J=0;J<ze.length;J++){let ne=ze[J].toSymbol();Ye=e.add(Ye,ne)}return Ye},we=function(ze,Ye){let J=Math.max.apply(null,ze.terms),ne=0,z;if(!Ye){for(let x=0;x<ze.terms.length;x++)if(ze.terms[x].equals(J)&&(z=x,ne++),ne>1)return}if(Ye){for(let x=0;x<ze.terms.length;x++)if(ze.terms[x].equals(J)){z=x;break}}return[J,z,ze]},pe=t.Utils.toMapObj(R),Ie=function(ze,Ye){return Ye.sum.subtract(ze.sum)},Ce=i.tBase(pe).sort(Ie),ge=a.tBase(pe).sort(Ie),Le=function(ze,Ye){Ye||=0;let J=ze[Ye],ne=ze.length;if(!J)return;let z=we(J);for(let X=Ye+1;X<ne;X++){let O=ze[X],fe=J.sum.equals(O.sum);if(!fe&&z)break;if(fe){let c,p,I,P,k=J.terms.length;for(let $=0;$<k;$++){let F=J.terms[$],ie=O.terms[$];(typeof c>"u"||F.greaterThan(c))&&(c=F,I=$),(typeof p>"u"||ie.greaterThan(p))&&(p=ie,P=$)}let j=c.subtract(O.terms[I]),H=p.subtract(J.terms[P]);if(H>j){z=[p,P,O];break}if(j>H){z=[c,I,J];break}}else if(z=we(O),z)break;z=we(O)}if(!z)return we(ze[0],!0);let x,Y;for(let X=0;X<ge.length;X++){let O=ge[X].terms;if(Y=z[1],Y===O.length-1)return;if(x=O[Y],!x.equals(0))break}return x.equals(0)?Le(ze,++Ye):z},xe=function(ze,Ye){if(!ze||!Ye)return!1;for(let J=0;J<ze.terms.length;J++)if(ze.terms[J].lessThan(Ye.terms[J]))return!1;return!0},He=xe(Ce[0],ge[0])&&Ce[0].count>ge[0].count?ge:Ce,Ze=Le(He),Ge=[];if(Ze){let ze=Ze[1],Ye=function(fe,c){return fe[0].sum.equals(c[0].sum)?fe.length>=c.length:!0},J=function(fe,c,p){let I=[];for(let P=0;P<fe.length;P++){let k=fe[P];for(let j=0;j<k.terms.length;j++){let H=I[j],$=k.terms[j];P===0?I[j]=$:H&&!H.equals($)&&(I[j]=void 0)}}for(let P=0;P<I.length;P++){let k=I[P];if(k&&!k.equals(0))return P}return p},ne=function(fe,c){let p=fe.len(),I=c.len(),P=c.terms[ze],k=fe.terms[ze];return I>p&&P.greaterThan(k)?I-p:P.subtract(k)};ze=J(Ce,ge,ze),Ce.sort(ne),ge.sort(ne);let z=ge[0],x=Ce[0];if(te=new be(new ue(1),[],x.map),z.sum.greaterThan(x.sum)&&x.len()>1)for(let fe=0;fe<x.terms.length;fe++){let c=z.terms[fe].subtract(x.terms[fe]);if(c.equals(0))te.terms[fe]=new ue(0);else{let p=c.add(new ue(1));te.terms[fe]=c;for(let I=0;I<Ce.length;I++)Ce[I].terms[fe]=Ce[I].terms[fe].add(p)}}let Y=xe(Ce[0],ge[0]),X=0,O=200;for(;Y&&Ye(Ce,ge);){if(X++>O)throw new t.exceptions.InfiniteLoopError("Unable to compute!");let fe=Ce[0].divide(ge[0]);Ge.push(fe),Ce.shift();for(let c=1;c<ge.length;c++){let p=ge[c].multiply(fe).generateImage(),I=Ce.length;I===0&&(p.coeff=p.coeff.neg(),Ce.push(p),Ce.sort(ne));for(let P=0;P<I;P++){let k=Ce[P];if(k.getImg()===p.getImg()){k.coeff=k.coeff.subtract(p.coeff),k.coeff.equals(0)&&(t.Utils.remove(Ce,P),P--);break}P===I-1&&(p.coeff=p.coeff.neg(),Ce.push(p),Ce.sort(ne))}}if(Y=xe(Ce[0],ge[0]),!Y&&Ce.length>=ge.length){for(let c=1;c<Ce.length;c++)if(Y=xe(Ce[c],ge[0]),Y){Ce.unshift(t.Utils.remove(Ce,c));break}}}}U=re(Ge),B=re(Ce),typeof te<"u"&&(te=te.toSymbol(),U=e.divide(U,te.clone()),B=e.divide(B,te))}return v&&(U=e.parse(U.text(),b),B=e.parse(B.text(),b)),[U,B]}catch(w){if(w.message==="timeout")throw w;return f}},line(i,a,f){t.Utils.isArray(i)&&(i=t.Utils.convertToVector(i)),t.Utils.isArray(a)&&(a=t.Utils.convertToVector(a)),f=e.parse(f||"x"),(!t.Utils.isVector(i)||!t.Utils.isVector(a))&&e.error(`Line expects a vector! Received "${i}" & "${a}"`);let w=e.subtract(a.e(1).clone(),i.e(1).clone()),d=e.subtract(a.e(2).clone(),i.e(2).clone()),v=e.divide(d,w),b=e.multiply(f,v.clone()),R=e.multiply(i.e(1).clone(),v);return e.add(e.subtract(b,R),i.e(2).clone())},PartFrac:{createTemplate(i,a,f,w){i=se.Factor.factorInner(i),i.each((re,we)=>{if(re.group===C&&re.fname===""&&re.args[0].group===y){let pe=re.args[0];i.symbols?(delete i.symbols[we],i.symbols[pe.value]=pe):i=re.args[0]}});let d,v,b,R=a.collectFactors(),U=[],B=[],te=new u(1);for(let re=0;re<R.length;re++){let we=u.unwrapPARENS(R[re]);if(we.power.greaterThan(1)){v=Number(we.power),d=we.clone().toLinear(),b=Number(se.degree(d,w));for(let pe=0;pe<v;pe++){let Ie=e.pow(d.clone(),new u(pe+1));f.push(Ie.clone());let Ce=e.divide(i.clone(),Ie.clone());B.push(b),U.push(Ce)}}else{b=Number(se.degree(we,w)),f.push(we);let pe=e.divide(i.clone(),we.clone());pe=e.expand(u.unwrapPARENS(pe)),B.push(b),U.push(pe)}}return f=f.map(re=>e.multiply(re,te.clone())),[f,U,B]},partfrac(i,a,f){let w=Ee(i);a||=e.parse(w[0]);try{let d,v,b,R=e.expand(i.getNum()),U=e.expand(i.getDenom().toUnitMultiplier());if(R.multiplier=i.multiplier,d=R.groupTerms(a),Number(se.degree(R,a))>=Number(se.degree(U,a))?(v=se.div(R.clone(),e.expand(U.clone())),b=v[0],R=v[1],d=R.groupTerms(a)):b=new u(0),Number(se.degree(U,a))===1){let ne=e.divide(R,U);return f?[b,ne]:e.add(b,ne)}let B=se.Factor.factorInner(U),te=se.PartFrac.createTemplate(U.clone(),B,[],a),re=te[0],we=te[1],pe=te[2],Ie=[d.length],Ce=[],ge=[],Le=[],xe,He;we.forEach((ne,z)=>{xe=re[z],He=pe[z];for(let x=0;x<He;x++){ge.push(xe.clone());let Y=u.create(a,x),X=e.expand(e.multiply(ne,Y.clone())).groupTerms(a),O=X.length;Ie.push(O),Ce.push(X),Le.push(Y.clone())}});let Ze=t.Utils.arrayMax(Ie),Ge=new t.Matrix(t.Utils.fillHoles(d,Ze)).transpose(),ze=new t.Matrix;for(let ne=0;ne<Ce.length;ne++)ze.elements.push(t.Utils.fillHoles(Ce[ne],Ze));let Ye=e.multiply(ze.transpose().invert(),Ge),J=f?[b]:b;return Ye.each((ne,z)=>{let x=e.multiply(Le[z],e.divide(ne,ge[z]));f?J.push(x):J=e.add(J,x)}),J}catch(d){if(d.message==="timeout")throw d;try{if(i.isComposite()){let v={};i.each(R=>{let U=R.getDenom(),B=R.getNum(),te=v[U];v[U]=te?e.add(te,B):B});let b=new u(0);for(let R in v)Object.hasOwn(v,R)&&(b=e.add(b,e.divide(v[R],e.parse(R))));i=b}}catch(v){if(v.message==="timeout")throw v}}return i}},degree(i,a,f){if(f||={nd:[],sd:[],depth:0},!a){let v=Ee(i);if(v.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(v.length===0)return new u(0);a=e.parse(v[0])}let w=i.group;i.isComposite()?(i=i.clone(),i.distributeExponent(),i.each(v=>{f.depth++,se.degree(v,a,f),f.depth--})):i.group===G?i.each(v=>{f.depth++,se.degree(v,a,f),f.depth++}):w===L&&i.value===a.value?f.sd.push(i.power.clone()):w===y&&i.value===a.value?f.nd.push(e.parse(i.power)):f.nd.push(new u(0));let d=f.nd.length>0?t.Utils.arrayMax(f.nd):void 0;return f.depth===0&&f.sd.length>0?(d!==void 0&&f.sd.unshift(d),e.symfunction("max",f.sd)):(t.Utils.isSymbol(d)||(d=e.parse(d)),d)},sqComplete(i,a,f){t.Utils.isSymbol(a)||(a=e.parse(a));let w=function(Ce){throw Ce||="Stopping",new t.exceptions.ValueLimitExceededError(Ce)};i.isPoly(!0)||w("Must be a polynomial!");let d=t.Utils.inBrackets;i=i.clone();let v=t.Algebra.degree(i,a);v.equals(2)||w(`Cannot complete square for degree ${v}`);let b=t.Algebra.coeffs(i,a),R=b[2],U=b[1].sign(),B=e.divide(b[1],new u(2)),te=e.pow(B.clone(),new u(2)),re=ye.sqrt(R),we=e.divide(ye.sqrt(te),re.clone()),pe=e.subtract(b[0],e.pow(we.clone(),new u(2)));if(f)return[R,B,pe];let Ie=e.parse(d(`${re.clone()}*${a}${U<0?"-":"+"}${we}`));return{a:Ie,c:pe,f:e.add(e.pow(Ie.clone(),new u(2)),pe.clone())}},Simplify:{strip(i){let a=e.parse(i.multiplier);i.toUnitMultiplier();let f=e.parse(i.power);return i.toLinear(),[a,f,i]},unstrip(i,a){let f=i[0],w=i[1];return e.multiply(f,e.pow(a,w))},complexSimp(i,a){let f=i.realpart(),w=i.imagpart(),d=a.realpart(),v=a.imagpart(),b=e.multiply(f.clone(),d.clone()),R=e.multiply(w.clone(),v.clone()),U=e.multiply(d.clone(),w),B=e.multiply(f,v.clone()),te=e.add(e.pow(d,new u(2)),e.pow(v,new u(2)));return e.divide(e.add(e.add(b,R),e.multiply(e.subtract(U,B),u.imaginary())),te)},trigSimp(i){let a=!0,f=0;for(;a&&i.containsFunction(["cos","sin","tan"]);){f++,a=!1,i=i.clone();let w=se.Simplify.strip(i);i=w.pop();let d=i.clone();if(i.group===Z){let v=new u(0);i.each(b=>{let R=se.Simplify.trigSimp(b.fnTransform());v=e.add(v,R)},!0),d=e.pow(e.multiply(new u(i.multiplier),v),new u(i.power)),a=d.text()!==i.text()}else if(i.group===G){let v=i.getNum(),b=i.getDenom();if(v.fname==="sin"&&b.fname==="cos"&&v.args[0].equals(b.args[0])&&v.power.equals(b.power))d=e.parse(t.Utils.format("(({1})/({0}))*tan({2})^({3})",b.multiplier,v.multiplier,v.args[0],v.power)),a=!0;else if(v.fname==="tan"&&b.fname==="sin"&&v.args[0].equals(b.args[0])&&v.power.equals(b.power))d=e.parse(t.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",b.multiplier,v.multiplier,v.args[0],v.power)),a=!0;else{let R=new u(1),U={workDone:a};d.each(B=>{if(B.fname==="tan")B=e.parse(t.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",B.multiplier,se.Simplify._simplify(B.args[0]),B.power)),U.workDone=!0;else if(B.containsFunction(["cos","sin","tan"])){let te=se.Simplify.trigSimp(B);B.equals(te)||(B=te,U.workDone=!0)}R=e.multiply(R,B)}),a=U.workDone,d=R}}else if((i.fname==="cos"||i.fname==="sin")&&i.args[0].group===Z){let v=0,b=new u(0),R=e.parse("pi/2");if(i.args[0].each(U=>{let B=e.divide(U.clone(),R.clone());B=se.Simplify._simplify(B),B=t.Utils.evaluate(B),ce(B)?v+=B.multiplier.num.toJSNumber():b=e.add(b,U)}),v){v+=i.fname==="cos"?1:0,v%=4,v+=v<0?4:0;let U=["sin({0})","cos({0})","-sin({0})","-cos({0})"],B=t.Utils.format(U[v],String(b));d=e.parse(B),a=!0}else if(Object.keys(i.args[0].symbols).length>1){let U=i.args[0].clone(),B=Object.values(U.symbols),te=B[0],we=B.slice(1).map(Ie=>`(${Ie.text()})`).join("+"),pe;i.fname==="sin"?pe=t.Utils.format("sin({0})cos({1})+sin({1})cos({0})",te,we):pe=t.Utils.format("cos({0})cos({1})-sin({1})sin({0})",te,we),d=e.parse(pe),a=!0}}else if((i.fname==="cos"||i.fname==="sin")&&i.args[0].multiplier.sign()===-1){let v=i.args[0].clone().negate(),b=t.Utils.format(`${i.fname}({0})`,v);i.fname==="sin"&&(b=`-${b}`),d=e.parse(b),a=!0}if(i.fname==="sin"&&i.args[0].multiplier.equals(2)&&!i.args[0].equals(2)){let v=i.args[0].clone().toUnitMultiplier(),b=t.Utils.format("2sin({0})cos({0})",v);d=e.parse(b),a=!0}if(d=se.Simplify.unstrip(w,d).distributeMultiplier(),i=d,f>10)break}return i},logArgSimp(i,a){if(a.value==="1"||a.value===1)return new u(0);let f=new u(0),w=a.multiplier.clone();if(a.toUnitMultiplier(),!w.equals(1)){let d=t.Utils.format("({0}({1}))",i,w);f=e.add(f,e.parse(d))}if(a.group===G)a.each(d=>{d=d.clone();let v=d.power.clone();se.Simplify.strip(d);let b=t.Utils.format("(({1})*{0}({2}))",i,v,d);f=e.add(f,e.parse(b))});else{let d=a.clone(),v=d.power.clone();se.Simplify.strip(d);let b=t.Utils.format("(({1})*{0}({2}))",i,v,d);f=e.add(f,e.parse(b))}return f},logSimp(i){if(i.group===C&&(i.fname==="log"||i.fname==="log10")){let a=i.clone(),f=se.Simplify.strip(i);i=f.pop();let w=i.args[0].clone(),d=w.getNum().clone(),v=w.getDenom().clone(),b=i.fname,R=se.Simplify.logArgSimp(b,d);if(!v.equals(1)){let U=se.Simplify.logArgSimp(b,v);R=e.subtract(R,U)}R=se.Simplify.unstrip(f,R).distributeMultiplier(),i=R}else if(i.containsFunction(["log","log10"]))for(let a in i.symbols){if(!Object.hasOwn(i.symbols,a))continue;let f=i.symbols[a];i.symbols[a]=se.Simplify.logSimp(f)}return i},_sqrtCompression(i,a,f){let w=se.Simplify.strip(i),d=Ie=>Ie.fname==="abs",v=Ie=>Ie.args[0],b=Ie=>d(Ie)?v(Ie):null,R=Ie=>Ie.type===y&&Ie.value.startsWith("baseunit_"),U=(Ie,Ce)=>{let ge=v(Ce);return ge.equals(b(Ie))?[Ce,null]:ge.equals(Ie)&&R(Ie)?[Ce,null]:[null,Ce]},B,te=!1,re=(Ie,Ce)=>{for(let ge=0;ge<Ie.length;ge++){let Le=Ie[ge];if(Le.isSQRT()){for(let xe=0;xe<Ce.length;xe++){let He=Ce[xe];if([He,Le]=U(He,Le),He!==null){Ce[xe]=He,B=!0,te=!0;break}}Ie[ge]=Le,Ie=Ie.filter(xe=>xe),Ce=Ce.filter(xe=>xe)}}return[Ie,Ce]},we=a.collectFactors(),pe=f.collectFactors();do B=!1,[we,pe]=re(we,pe),[pe,we]=re(pe,we);while(B);return te&&(i=we.reduce((Ie,Ce)=>Ie=e.multiply(Ie,Ce),new u(1)),i=pe.reduce((Ie,Ce)=>Ie=e.divide(Ie,Ce),i)),i=se.Simplify.unstrip(w,i),i},fracSimp(i){let a=i.getDenom(),f=i.getNum();if(f.isImaginary()&&a.isImaginary()&&(i=se.Simplify.complexSimp(f,a)),i.isComposite()){i.power>1&&(i=e.expand(i));let w=i.collectSymbols(),d,v,b,R,U,B,te,re,we,pe,Ie;for(v=w.pop();w.length;)b=w.pop(),R=e.parse(v.getDenom()),U=e.parse(b.getDenom()),B=v.getNum(),te=b.getNum(),Ie=e.multiply(R.clone(),U.clone()),we=e.multiply(B,U),pe=e.multiply(te,R),re=e.add(we,pe),v=e.divide(re,Ie);return a=e.expand(v.getDenom()),f=e.expand(v.getNum()),f.isImaginary()&&a.isImaginary()?d=se.Simplify.complexSimp(f,a):d=e.divide(f,a),d.equals(i)?i:se.Simplify._simplify(d)}return i=se.Simplify._sqrtCompression(i,f,a),i=se.Simplify.simpleFracSimp(i),i},simpleFracSimp(i){let a=i.getDenom(),f=i.getNum(),w;return a=e.expand(a),f=e.expand(f),f.isImaginary()&&a.isImaginary()?w=se.Simplify.complexSimp(f,a):w=e.divide(f,a),w.equals(i)?i:w},ratSimp(i){if(i.group===G){let a=i.getDenom(),f=i.getNum().distributeMultiplier(),w=se.Simplify.fracSimp(a),d=se.Simplify.fracSimp(f);i=e.divide(d,w)}return i},sqrtSimp(i,a){let f,w=!1,d=i.clone();try{if(i.isSQRT()){let v=i.multiplier.clone(),b=i.args[0].clone(),R=se.Factor.factorInner(b),U=e.parse(R.multiplier),B=U.sign();f=new u(1);let te;if(R.group===G){let re=new u(1);R.each(pe=>{if(pe=e.parse(pe),pe.group===o){let Ie=e.sqrt(pe.clone());ce(Ie)?f=e.multiply(f,Ie):re=e.multiply(re,pe)}else re=e.multiply(re,pe)});let we=e.multiply(re,e.parse(B));te=e.sqrt(we.clone()),te.isImaginary()&&(te=e.sqrt(e.expand(we.clone())))}else te=R.clone().toUnitMultiplier(),te=e.multiply(te,new u(B)),te=e.sqrt(te);f=e.multiply(f,te),f=e.pow(f,e.parse(i.power)),f=e.multiply(f,e.sqrt(U.abs())),f=e.multiply(f,e.parse(v)),w=!0}else i.isComposite()&&i.isLinear()?(f=new u(0),i.each(v=>{f=e.add(f,se.Simplify.sqrtSimp(v))},!0),f=e.pow(f,e.parse(i.power)),f=e.multiply(f,e.parse(i.multiplier)),w=!0):i.group===G&&(f=new u(1),i.each(v=>{let b=se.Simplify.sqrtSimp(v);f=e.multiply(f,b)}),f=e.pow(f,e.parse(i.power)),f=e.multiply(f,e.parse(i.multiplier)),w=!0);return w||f&&!ce(f)&&(f=null),f||=e.parse(i),f}catch(v){if(v.message==="timeout")throw v;return d}},patternSub(i){let a={},f=function(d){let v=!1;return d.each(b=>{b.group===Z?v=!0:b.symbols&&(v=f(b))}),v},w=function(d){d.each(v=>{if(!(!v.symbols&&v.group!==C)){if(f(v))w(v);else if(!a[v.value]){let b=t.Utils.getU(i);a[v.value]=b,i=i.sub(v.value,b)}}},!0)};return w(i),[i,a]},simplify(i){if(i.simplify)return i.simplify();let a=se.Simplify._simplify(i);return a=a.pushMinus(),a=e.parse(a),a},_simplify(i){let a=se.Simplify.strip(i.clone());if(i=a.pop(),i=se.Simplify.fracSimp(i),i.isConstant()||i.group===t.groups.S)return a.push(i),se.Simplify.unstrip(a,i);let f=i.clone();if(f=se.Simplify.sqrtSimp(f,a),f=se.Simplify.trigSimp(f),f=se.Simplify.logSimp(f),f=se.Simplify.ratSimp(f),f=se.Factor.factorInner(f),f.group===t.groups.CP&&f.isLinear()){let w=f.multiplier.clone();f.toUnitMultiplier();let d=new u(0);return f.each(v=>{let b=se.Simplify._simplify(v);d=e.add(d,b)}),f=d,f=e.multiply(f,new u(w)),f.multiplier.equals(-1)&&f.distributeMultiplier(),f=se.Simplify.unstrip(a,f),f}return f=se.Simplify.unstrip(a,f),f}},Classes:{Polynomial:he,Factors:Se,MVTerm:be}};t.Expression.prototype.simplify=function(){t.Utils.armTimeout();try{let a;if(typeof this.symbol.LHS>"u")a=new t.Expression(se.Simplify.simplify(this.symbol));else{let f=this.symbol.clone();f.LHS=se.Simplify.simplify(f.LHS),f.RHS=se.Simplify.simplify(f.RHS),a=f}return a}catch(a){if(a.message==="timeout")throw a;return this}finally{t.Utils.disarmTimeout()}},t.Collection.prototype.simplify=function(){return this.elements=this.elements.map(a=>se.Simplify.simplify(a)),this},t.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(a=>a.map(f=>se.Simplify.simplify(f))),this},h0.useAlgebraDiv=function(){let a=se.divideFn=e.divide,f=0;e.divide=function w(d,v){f++;let b;return f===1?b=t.Algebra.divide(d,v):b=w(d,v),f=0,b}},h0.useParserDiv=function(){se.divideFn&&(e.divide=se.divideFn),delete se.divideFn},h0.register([{name:"factor",visible:!0,numargs:1,build(){return se.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return se.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return se.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return se.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return se.roots}},{name:"divide",visible:!0,numargs:2,build(){return se.divide}},{name:"div",visible:!0,numargs:2,build(){return se.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return se.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return se.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...a){let f=se.coeffs(...a);return new t.Vector(f)}}}]),h0.coeffs=function(...a){let f=t.PARSER;for(let d=0;d<a.length;d++)typeof a[d]=="string"?a[d]=f.parse(a[d]):a[d]&&a[d].symbol?a[d]=a[d].symbol.clone():t.Utils.isSymbol(a[d])&&(a[d]=a[d].clone());let w=se.coeffs(...a);return new t.Expression(new t.Vector(w))},h0.register([{name:"line",visible:!0,numargs:[2,3],build(){return se.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(a,f){try{return f||=Ee(a)[0],se.sqComplete(a.clone(),f).f}catch(w){if(w.message==="timeout")throw w;return a}}}}]),h0.updateAPI()})()});var f1=f0((Ki,c1)=>{"use strict";var R0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof c1<"u"&&R0===void 0&&(R0=T0(),V0(),X0());(function(){let t=R0.getCore(),e=t.PARSER,o=t.Algebra,g=t.Calculus,y=g.integration.decompose_arg,{evaluate:L}=t.Utils,{remove:C}=t.Utils,{format:D}=t.Utils,{build:Z}=t.Build,{knownVariable:G}=t.Utils,{NerdamerSymbol:V}=t,{isSymbol:de}=t.Utils,{variables:Ee}=t.Utils,{S:Me}=t.groups,{PL:ae}=t.groups,{CB:ce}=t.groups,{CP:ue}=t.groups,{FN:u}=t.groups,{Settings:Ne}=t,{range:Oe}=t.Utils,{isArray:Pe}=t.Utils;t.Settings.SOLVE_RADIUS=1e3,t.Settings.ROOTS_PER_SIDE=10,t.Settings.make_pi_conversions=!1,t.Settings.STEP_SIZE=.1,t.Settings.EPSILON=2e-13,t.Settings.MAX_NEWTON_ITERATIONS=200,t.Settings.NEWTON_EPSILON=2e-15,t.Settings.MAX_NON_LINEAR_TRIES=12,t.Settings.NON_LINEAR_JUMP_AT=50,t.Settings.NON_LINEAR_JUMP_SIZE=100,t.Settings.NON_LINEAR_START=.01,t.Settings.NEWTON_SLICES=200,t.Settings.SOLUTION_PROXIMITY=1e-14,t.Settings.FILTER_SOLUTIONS=!0,t.Settings.MAX_SOLVE_DEPTH=10,t.Settings.ZERO_EPSILON=1e-9,t.Settings.MAX_BISECTION_ITER=2e3,t.Settings.BI_SECTION_EPSILON=1e-12,t.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},t.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let a in this.symbols){if(!Object.hasOwn(this.symbols,a))continue;let f=this.symbols[a];if(f.group===ae&&f.hasNegativeTerms()||this.symbols[a].power.lessThan(0))return!0}return!1};function ye(i,a){if(a.isConstant()&&i.isConstant()&&!i.equals(a)||i.equals(t.Settings.IMAGINARY)&&a.isConstant(!0)||a.equals(t.Settings.IMAGINARY)&&i.isConstant(!0))throw new t.exceptions.NerdamerValueError(`${i.toString()} does not equal ${a.toString()}`);this.LHS=i,this.RHS=a}ye.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(i){return`${this.LHS.text(i)}=${this.RHS.text(i)}`},toLHS(i){i=!!i;let a=this.removeDenom(),f=a.LHS,w=a.RHS;f.isConstant(!0)&&!w.isConstant(!0)&&([f,w]=[w,f]);let d=e.subtract(f,w),v=i?e.expand(d):d;return v=new ye(v,new V(0)).removeDenom().LHS,v},removeDenom(){let i=this.LHS.clone(),a=this.RHS.clone(),f=e.multiply(i.getDenom(),a.getDenom());if(i=e.expand(e.multiply(i,f.clone())),a=e.expand(e.multiply(a,f)),a.group===ue&&a.group!==ue){let w=i;i=a,a=w}if(i.group===ce){let w=new V(i.multiplier),d=a.clone();i.each(v=>{v.power.lessThan(0)?d=e.divide(d,v):w=e.multiply(w,v)}),i=w,a=d}else if(i.group===ue)for(let w in i.symbols){if(!Object.hasOwn(i.symbols,w))continue;let d=i.symbols[w];if(d.group===ce)for(let v in d.symbols){if(!Object.hasOwn(d.symbols,v))continue;let b=d.symbols[v];if(b.power.lessThan(0))return new ye(e.expand(e.multiply(b.clone().toLinear(),i)),e.expand(e.multiply(b.clone().toLinear(),a)))}}return new ye(i,a)},clone(){return new ye(this.LHS.clone(),this.RHS.clone())},sub(i,a){let f=this.clone();return f.LHS=f.LHS.sub(i.clone(),a.clone()),f.RHS=f.RHS.sub(i.clone(),a.clone()),f},isZero(){return t.Utils.evaluate(this.toLHS()).equals(0)},latex(i){return[this.LHS.latex(i),this.RHS.latex(i)].join("=")}},e.equals=function(a,f){return new ye(a,f)},(function(){let a=e.functions.simplify[0];e.functions.simplify[0]=function(w){return w instanceof ye?(w.LHS=a(w.LHS),w.RHS=a(w.RHS),w):a(w)}})(),t.Expression.prototype.equals=function(a){return a instanceof t.Expression&&(a=a.symbol),new ye(this.symbol,a)},t.Expression.prototype.solveFor=function(a){t.Utils.armTimeout();try{let{symbol:f}=this;if(this.symbol instanceof ye){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(a))return[new t.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(a))return[new t.Expression(this.symbol.RHS)]}return se(f,a).map(v=>(v=t.Algebra.Simplify.simplify(e.parse(v)),new t.Expression(v)))}finally{t.Utils.disarmTimeout()}},t.Expression.prototype.expand=function(){if(this.symbol instanceof ye){let a=this.symbol.clone();return a.RHS=e.expand(a.RHS),a.LHS=e.expand(a.LHS),new t.Expression(a)}return new t.Expression(e.expand(this.symbol))},t.Expression.prototype.variables=function(){return this.symbol instanceof ye?t.Utils.arrayUnique(t.Utils.variables(this.symbol.LHS).concat(t.Utils.variables(this.symbol.RHS))):t.Utils.variables(this.symbol)};let $e=function(a,f){return e.equals(a,f)};t.Equation=ye;let he=t.Utils.checkAll=function(a,f){for(let w=0;w<a.length;w++)if(f(a[w]))return!1;return!0},Se=t.Solve={version:"2.0.3",solutions:[],solve(i,a){let f=Ne.PARSE2NUMBER;Ne.PARSE2NUMBER=!1;let w=se(i,String(a));return Ne.PARSE2NUMBER=f,new t.Vector(w)},toLHS(i,a){if(de(i))return i;if(!(i instanceof ye)){let f=i.split("=");f[1]||="0",i=new ye(e.parse(f[0]),e.parse(f[1]))}return i.toLHS(a)},solveCircle(i,a){let f=a.map(R=>e.parse(R)),w=[],d=[];for(let R=0;R<i.length;R++){let U=[];for(let B=0;B<f.length;B++)U.push(Number(t.Algebra.degree(i[R],f[B])));U.push(t.Utils.arraySum(U,!0)),w.push(U)}let v=i[0],b=i[1];if(w[0][2]>w[1][2]&&([b,v]=[v,b],[w[1],w[0]]=[w[0],w[1]]),w[0][0]===1&&w[0][2]===2&&w[1][0]===2&&w[1][2]===4){let R=a[0],U=a[1],B=se(e.parse(b,G(R,se(e.parse(v),R)[0])),U).map(re=>re.toString()),te=[se(e.parse(v,G(U,B[0])))[0].toString()];B[1]&&te.push(se(e.parse(v,G(U,B[1])))[0].toString()),Ne.SOLUTIONS_AS_OBJECT?(d={},d[R]=te,d[U]=B):(B.unshift(U),te.unshift(R),d=[te,B])}return d},solveNonLinearSystem(i,a,f){if(a<0)return[];f=typeof f>"u"?t.Settings.NON_LINEAR_START:f;let w=t.Settings.MAX_NON_LINEAR_TRIES,d=Math.floor(w/2);a=typeof a>"u"?w:a;let v=t.Settings.NON_LINEAR_JUMP_AT,b=t.Settings.NON_LINEAR_JUMP_SIZE,R=!0,U=function(Ye,J){return Ye.map((ne,z)=>Number(J.get(z,0)))},B=t.Utils.arrayGetVariables(i),te=t.Matrix.jacobian(i,B,Ye=>Z(Ye,B),!0),re=t.Settings.MAX_NEWTON_ITERATIONS,we,pe,Ie,Ce,ge,Le,xe,He,Ze=i.map(Ye=>Z(Ye,B)),Ge=te.map(Ye=>Z(Ye,B),!0);Ce=t.Matrix.cMatrix(0,B);let ze=t.Matrix.cMatrix(f,B);Ie=0;do{if(Ie>re){R=!1;break}we=U(B,ze),xe=ze.clone();let Ye=we,J=ze;Ze.forEach((z,x)=>{J.set(x,0,z(...Ye))});let ne=new t.Matrix;if(Ge.each((z,x,Y)=>{let X=z(...Ye);ne.set(x,Y,X)}),ne=ne.invert(),pe=e.multiply(ne,ze).negate(),He=pe.subtract(Ce,z=>e.parse(Number(z))),Ce=xe.add(pe,z=>e.parse(Number(z))),ze=Ce,Ie>=v&&ge>1){a===d&&(f=0);let z=a>d?1:-1,x=a%Math.floor(d)+1;return f+=z*x*b,Se.solveNonLinearSystem(i,--a,f)}if(Le=ge,Ie++,ge=He.max(),Number(ge)===Number(Le))break}while(Number(ge)>=Number.EPSILON);return R?Se.systemSolutions(ze,B,!0,Ye=>t.Utils.round(Number(Ye),14)):[]},systemSolutions(i,a,f,w){let d=t.Settings.SOLUTIONS_AS_OBJECT?{}:[];return i.each((v,b)=>{let R=(f?e.expand(v):v).valueOf();w&&(R=w.call(v,R));let U=a[b];t.Settings.SOLUTIONS_AS_OBJECT?d[U]=R:d.push([U,R])}),d},solveSystemBySubstitution(i){let a=Ee(i[0]),f=Ee(i[1]);return i.length===2&&a.length===2&&t.Utils.arrayEqual(a,f)?Se.solveCircle(i,a):[]},solveSystem(i,a){for(let U=0;U<i.length;U++)i[U]=Se.toLHS(i[U]);let f=i.length,w=new t.Matrix,d=new t.Matrix,v=!1,b;if(typeof a>"u"){if(!o.allLinear(i))try{return Se.solveNonLinearSystem(i)}catch(U){if(U.message==="timeout")throw U;if(U instanceof t.exceptions.DivisionByZero)return Se.solveSystemBySubstitution(i)}if(b=t.Utils.arrayGetVariables(i),b.length===1){let U=0,B,te;do te=i[U].clone(),U>0&&(te=te.sub(b[0],B[0])),B=se(te,b[0]);while(++U<i.length);let re;return Ne.SOLUTIONS_AS_OBJECT?(re={},re[b[0]]=B):B.length===0?re=B:re=[b[0],B],re}if(b.length<i.length){let U=[],B=i.length;for(let pe=0;pe<B-1;pe++)U.push(e.parse(i[pe]));let te={},re=Se.solveSystem(U,b);Array.isArray(re)?re.forEach(pe=>{te[pe[0]]=pe[1]}):te=re;let we=!0;for(let pe=B-1;pe<B;pe++)e.parse(i[pe],te).equals(0)||(we=!1);if(we)return re}for(let U=0;U<b.length;U++)R0.setVar(b[U],"delete");for(let U=0;U<f;U++){let B=i[U];for(let re=0;re<b.length;re++){let we=b[re],pe=[];B.each(Ce=>{Ce.contains(we)&&(pe=pe.concat(Ce.coeffs()))});let Ie=t.Utils.arraySum(pe);w.set(U,re,Ie)}let te=B.clone();b.forEach(re=>{te=te.stripVar(re,!0)}),d.set(U,0,te.negate())}}else{b=a,v=!0;for(let U=0;U<f;U++){d.set(U,0,new V(0));let B=e.expand(i[U]).collectSummandSymbols();for(let te=0;te<a.length;te++){w.set(U,te,new V(0));let re=a[te];for(let we=0;we<B.length;we++){let pe=B[we],Ie=!1;for(let Ce=0;Ce<a.length;Ce++)pe.contains(a[Ce])&&(Ie&&t.Utils.err(`Multiple variables found for term ${pe}`),Ie=!0);if(pe.contains(re)){let Ce=y(C(B,we),re);we--,w.set(U,te,e.add(w.get(U,te),Ce[0]))}}}for(let te=0;te<B.length;te++)d.set(U,0,e.add(d.get(U,0),B[te]))}}if(b.length!==i.length||w.determinant().equals(0))throw new t.exceptions.SolveError("System does not have a distinct solution");w=w.invert();let R=w.multiply(d);return t.Utils.isArray(a)&&R.each(U=>U.negate()),Se.systemSolutions(R,b,v)},quad(i,a,f){let w=e.subtract(e.pow(a.clone(),new V(2)),e.multiply(e.multiply(f.clone(),i.clone()),new V(4)));w=e.expand(w);let d=e.pow(w,new V(.5)),v=e.parse(e.multiply(new V(2),f.clone()));return[e.parse(D("(-({0})+({1}))/({2})",a,d,v)),e.parse(D("(-({0})-({1}))/({2})",a,d,v))]},cubic(i,a,f,w){let d=w.text(),v=f.text(),b=a.text(),R=i.text(),U=`(-(${v})^3/(27*(${d})^3)+(${v})*(${b})/(6*(${d})^2)-(${R})/(2*(${d})))`,B=`((${b})/(3*(${d}))-(${v})^2/(9*(${d})^2))`,te=`(${v})/(3*(${d}))`,re=`((${U})+sqrt((${U})^2+(${B})^3))^(1/3)+((${U})-sqrt((${U})^2+(${B})^3))^(1/3)-(${te})`,we="1/2+sqrt(3)/2*i";return[e.parse(re),e.parse(`(${re})(${we})`),e.parse(`(${re})(${we})^2`)]},quartic(i,a,f,w,d){let v={};t.Utils.arrayUnique(Ee(d).concat(Ee(w)).concat(Ee(f)).concat(Ee(a)).concat(Ee(i))).forEach(Le=>{v[Le]=1}),d=d.toString(),w=w.toString(),f=f.toString(),a=a.toString(),i=i.toString();let b,R=e.parse(D("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",d,w,f)).toString(),U=e.parse(D("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",d,w,f,a)).toString(),B=e.parse(D("12*({0})*({4})-3*({1})*({3})+({2})^2",d,w,f,a,i)).toString(),te=e.parse(D("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",d,w,f,a,i)).toString(),re=e.parse(D("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",B,te)).toString(),we=e.parse(D("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",d,R,re,B)).toString(),pe=e.parse(D("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",d,w,R,U,we)),Ie=e.parse(D("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",d,w,R,U,we)),Ce=e.parse(D("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",d,w,R,U,we)),ge=e.parse(D("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",d,w,R,U,we));return[pe,Ie,Ce,ge]},divideAndConquer(i,a){let f=[],w=t.Algebra.Factor.factorInner(i);return w.group===ce&&w.each(d=>{d=V.unwrapPARENS(d),f=f.concat(se(d,a))}),f},csolve(i,a){return t.Utils.block("IGNORE_E",()=>{let f,w,d,v,b,R,U,B,te=[],re=t.Utils.decompose_fn(i,a,!0);if(re.x.group===Me){f=e.parse(re.x.power),w=Number(f),d=e.pow(e.divide(re.b.negate(),re.a),f.invert()),v=V.toPolarFormArray(d),b=v[0],R=v[1],U=b.toString(),B=f.toString();let we,pe,Ie;for(let Ce=0;Ce<w;Ce++)we=Ce,Ie=D("({0})*e^(2*{1}*pi*{2}*{3})",U,we,f,t.Settings.IMAGINARY),pe=e.parse(Ie),te.push(pe)}return te},!0)},getPoints(i,a,f){a||=.01;let w=[],d=Z(i),b=Math.round(0),R=d(b),U=t.Settings.ROOTS_PER_SIDE,B=U;w.push(Math.floor(b/2)),w.push(Math.abs(b)),w.push(b),i.each(pe=>{pe.containsFunction(t.Settings.LOG)&&w.push(.1)});let te=Oe(-t.Settings.SOLVE_RADIUS,b,a),re=Oe(b,t.Settings.SOLVE_RADIUS,a),we=function(pe,Ie){let Ce,ge,Le,xe=[],He=pe[0],Ze=Math.sign(d(He));for(let Ge=0,ze=pe.length;Ge<ze&&xe.length<Ie;Ge++)Ce=pe[Ge],ge=d(Ce),Le=Math.sign(ge),!isNaN(Le)&&(Le!==Ze&&(xe.push(Ce),xe.push(pe[Ge-1])),Ze=Le);w=w.concat(xe)};if(we(te,B),we(re,U),f){let pe=t.Settings.SOLVE_RADIUS;we([pe,pe*pe],1),we([-pe*pe,-pe],1)}return w},bisection(i,a){let f=i-1,w=i+1;if(Math.sign(a(f))!==Math.sign(a(w))){let d=0,v,b;do{if(v=Math.abs(w-f),d++>t.Settings.MAX_BISECTION_ITER||isNaN(v))return;b=(f+w)/2,a(f)*a(b)>0?f=b:w=b}while(v>=Ne.EPSILON);let R=(f+w)/2,U=a(R);return!isNaN(U)&&Math.abs(U)<=t.Settings.BI_SECTION_EPSILON?t.Utils.round(R,13):void 0}},bSearch(i,a,f){let w=f(i),d=f(a);if(Math.sign(w)===Math.sign(d)||isNaN(w)||isNaN(d))return;let v=80,b=0;do{let R=(i+a)/2,U=Math.sign(w),B=Math.sign(f(R));if(U===B){if(R===i)break;i=R,w=f(i)}else{if(R===a)break;a=R,d=f(a)}b++}while(i!==a&&b<v);if(!(!isFinite(f(i))||!isFinite(f(a))))return i},Newton(i,a,f,w){let d=t.Settings.MAX_NEWTON_ITERATIONS,v=0,b=i,R,U,B;do{let te=a(b);if(b===0&&te===0){R=0;break}if(v++,v>d)return;let re=f(b);if(isNaN(re)||isNaN(te))return;if(re===0)R+=B;else{if(!isFinite(te)||!isFinite(re)||Math.abs(te)>1e25)return Se.bSearch(w,b,a);R=b-te/re}if(B=R-b,B===0&&!isFinite(re))return;U=Math.abs(B),b=R}while(U>Ne.NEWTON_EPSILON);return R},rewrite(i,a,f){if(a||=new V(0),i.isComposite()&&i.isLinear()){let v=[],b=[];i.each(R=>{R=R.clone(),R.fname==="sqrt"&&R.contains(f)?v.push(R):b.push(R)},!0),v.length===1&&(a=e.expand(e.pow(e.subtract(a,t.Utils.arraySum(b)),new V(2))),i=e.expand(e.pow(V.unwrapSQRT(v[0]),new V(2))))}else i=V.unwrapSQRT(e.expand(i));let w=0,d=i.length;if(i.group===ue&&i.contains(f)&&i.isLinear()){i.distributeMultiplier();let v=new V(0);return i.each(b=>{b.contains(f)?(w++,v=e.add(v,b.clone())):a=e.subtract(a,b.clone())}),i=v,w!==d?Se.rewrite(i,a,f):[i,a]}if(i.group===ce&&i.contains(f)&&i.isLinear()){if(i.multiplier.lessThan(0)&&(i.multiplier=i.multiplier.multiply(new t.Frac(-1)),a.multiplier=a.multiplier.multiply(new t.Frac(-1))),a.equals(0))return new V(0);let v=new V(1);return i.each(b=>{b.contains(f)?v=e.multiply(v,b.clone()):a=e.divide(a,b.clone())}),i=v,Se.rewrite(i,a,f)}if(!i.isLinear()&&i.contains(f)){let v=e.parse(i.power.clone().invert());return i=e.pow(i,v.clone()),a=e.pow(e.expand(a),v.clone()),Se.rewrite(i,a,f)}return i.group===u||i.group===Me||i.group===ae?[i,a]:[i,a]},sqrtSolve(i,a){let f=new V(0),w=new V(0);if(i.isComposite()&&(i.each(d=>{d.fname==="sqrt"&&d.contains(a)?f=e.add(f,d.clone()):w=e.add(w,d.clone())}),!f.equals(0))){let d=e.expand(e.multiply(e.parse(i.multiplier),e.subtract(e.pow(w,new V(2)),e.pow(f,new V(2))))),v=se(d,a);return v=v.filter(b=>{if(b.isImaginary())return!0;let R={};return R[a]=b,!!L(i,R).equals(0)}),v}}},be=function(i,a,f,w){let d=i.toString(),v=d.match(/(?<![a-z])abs/gu);if(!v||v.length>2||i.LHS.group!==u&&i.RHS.group!==u)return null;let b=i.constructor(d.replace(/(?<![a-z])abs/u,"")),R=i.constructor(d.replace(/(?<![a-z])abs/u,"(-1)")),U=se(b,a,null,f,w);return[se(R,a,null,f,w),U]};function se(i,a,f,w,d){if(w||=0,w++>Ne.MAX_SOLVE_DEPTH)return f;f||=[];let v={},b={};b[a]=0;let R=function(ge,Le){let xe=de(ge);if(!(ge===void 0||typeof ge=="number"&&isNaN(ge))){if(Pe(ge))ge.forEach(He=>{R(He)});else if(ge.valueOf()!=="null"){if(typeof t.Settings.PRE_ADD_SOLUTION=="function"&&(ge=t.Settings.PRE_ADD_SOLUTION(ge)),xe||(ge=e.parse(ge)),t.Settings.make_pi_conversions&&Le){let Ze=e.divide(ge.clone(),new V(Math.PI)),Ge=Ze.multiplier,ze=Math.abs(Ge.num),Ye=Math.abs(Ge.den);ze<10&&Ye<10&&(ge=e.multiply(Ze,new V("pi")))}let He=ge.toString();v[He]||f.push(ge),v[He]=!0}}};if(i instanceof ye){let ge=be(i,a,f,w,d);if(ge)return R(ge),f;if(i.isZero())return[new V(0)];if(i.LHS.equals(a)&&!i.RHS.contains(a,!0))return[i.RHS];if(i.RHS.equals(a)&&!i.LHS.contains(a,!0))return[i.LHS]}if(i instanceof t.Vector&&(i=i.elements),Pe(i))return Se.solveSystem(i,a);if(a||="x",de(i)&&L(i.getDenom(),b).equals(0)===!0)return f;if(i.group===Me&&i.contains(a)){try{let ge={};ge[a]=0,L(d,ge,"numer"),R(new V(0))}catch(ge){if(ge.message==="timeout")throw ge}return f}if(i.group===ce){let ge=i.getNum();if(ge.group===ce){let Le=String(a);return ge.each(xe=>{xe.contains(Le)&&se(xe,a,f,w,i)}),f}return se(ge,a,f,w,d)}i.group===u&&i.fname==="sqrt"&&(i=e.pow(V.unwrapSQRT(i),new V(2)));let U=(t.Utils.isSymbol(i)?i:Se.toLHS(i,!1)).getNum(),B=t.Utils.variables(U),te=B.length;if(t.Utils.isInt(U.power)&&U.power>1&&(U=e.parse(U).toLinear()),(U.group===Me||U.group===ce)&&U.contains(a))return[new V(0)];let re={},we,pe=function(ge){ge=e.expand(ge,{expand_denominator:!0,expand_functions:!0});let Le=ge.clone();if(ge.symbols)for(let xe in ge.symbols){if(!Object.hasOwn(ge.symbols,xe))continue;let He=ge.symbols[xe],Ze=He.getDenom();if(!Ze.isConstant(!0)&&ge.isComposite()){let ne=new V(0);return ge.each(z=>{ne=e.add(ne,e.multiply(z,Ze.clone()))}),pe(e.multiply(e.parse(ge.multiplier),ne))}let Ge=y(He,a),ze=Ge[1].fname===t.Settings.SQRT,Ye=V.unwrapSQRT(Ge[1]),J=Ye.power.clone();if(!de(J)&&!J.equals(1/2)){if(J.den.gt(1)){if(ze)return ge=e.subtract(ge,He.clone()),ge=e.add(ge,e.multiply(Ge[0].clone(),Ye)),pe(ge);let ne=re[J.den];re[J.den]=ne?ne++:1}else if(J.sign()===-1){let ne=e.parse(`${a}^${Math.abs(J)}`),z=ge;return z.each((x,Y)=>{x.contains(a)&&(z.symbols[Y]=e.multiply(x,ne.clone()))}),re={},pe(e.parse(z))}else if(He.group===ae){let ne=t.Utils.arrayMin(t.Utils.keys(He.symbols));if(ne<0){let z=e.parse(`${a}^${Math.abs(ne)}`),x=new V(0);return Le.each(Y=>{x=e.add(x,e.multiply(Y.clone(),z.clone()))},!0),x}}}}return ge},Ie=function(ge){let Le=new V(0),xe=new V(0);return ge.each(He=>{He.contains(a,!0)?Le=e.add(Le,He.clone()):xe=e.subtract(xe,He.clone())}),[Le,xe]};if(Se.inverseFunctionSolve=function(Le,xe,He){let Ze=y(xe.args[0],a);if(Ze[1].group===Me)return e.divide(e.symfunction(Le,[e.divide(He,e.parse(xe.multiplier))]),Ze[0])},U=pe(U),U.equals(0))return[U];let Ce=t.Utils.keys(re);if(Ce.length===1&&(we=Ce[0],U.each((ge,Le)=>{if(ge.contains(a)){let xe=y(ge,a),He=xe[1],Ze=He.power;Ze.den.gt(1)&&(He.power=Ze.multiply(new t.Frac(we)),U.symbols[Le]=e.multiply(He,xe[0]))}}),U=e.parse(U)),R(Se.sqrtSolve(U,a)),te===1)if(U.isPoly(!0)){let ge=new t.Algebra.Classes.Factors;if(t.Algebra.Factor.factorInner(U,ge),ge.getNumberSymbolics()>1)for(let Le in ge.factors)Object.hasOwn(ge.factors,Le)&&R(se(ge.factors[Le],a));else{let Le=t.Utils.getCoeffs(U,a),xe=Le.length-1,He=!1;if(B[0]===a){if(he(Le,Ze=>Ze.group!==t.groups.N)){let Ze=t.Algebra.proots(U);he(Ze,Ge=>!t.Utils.isInt(Ge))&&(He=!0,Ze.forEach(Ge=>{R(new V(Ge))}))}if(!He)if(i=e.parse(i),i instanceof t.Equation&&(i=i.toLHS()),xe===1)R(e.divide(Le[0],Le[1].negate()));else if(xe===2)R(e.expand(Se.quad.apply(void 0,Le)));else if(xe===3){let Ze=[],Ge=t.Algebra.Factor.factorInner(i);Ze=[],Ze.length>0?R(Ze):R(Se.cubic.apply(void 0,Le))}else o.proots(U).map(R)}}}else{let ge=U.hasTrig(),Le=Se.getPoints(U,.1),xe=Se.getPoints(U,.05),He=Se.getPoints(U,.01,!0),Ze=t.Utils.arrayUnique(Le.concat(xe).concat(He)).sort((X,O)=>X-O),Ge,ze,Ye,J=Z(U.clone()),ne=[];for(Ge=0;Ge<Ze.length;Ge++){if(ze=Ze[Ge],Ye=Se.bisection(ze,J),typeof Ye>"u"){ne.push(ze);continue}R(Ye,ge)}Ze=ne;let z=g.diff(U.clone()),x=Z(z),Y=Ze[0];for(Ge=0;Ge<Ze.length;Ge++)ze=Ze[Ge],R(Se.Newton(ze,J,x,Y),ge),Y=ze;f.sort((X,O)=>{let fe=X.text("decimals"),c=O.text("decimals"),p=Number(fe),I=Number(c);return isNaN(p)&&isNaN(I)?fe.localeCompare(c):isNaN(p)&&!isNaN(I)?-1:!isNaN(p)&&isNaN(I)?1:p-I}),f=f.map(X=>X.isConstant()?new V(Number(Number(X).toPrecision(15))):X),f=f.filter((X,O,fe)=>{let c=Number(Number(X).toPrecision(15)),p=Number(fe[O-1]);return O===0||isNaN(c)||isNaN(p)?!0:Math.abs(c-p)>=Ne.EPSILON})}else if(!U.hasFunc(a)&&U.isComposite())try{let ge=t.Algebra.Factor.factorInner(U.clone()),Le=e.expand(e.parse(ge)),xe=e.expand(U.clone()),He=e.subtract(Le,xe),Ze=!0;if(He.equals(0)||(Ze=!1),Ze&&ge.group===ce)ge.each(Ge=>{R(se(Ge,a))});else{let Ge=t.Utils.getCoeffs(U,a);switch(Ge.length-1){case 0:{let J=Ie(U),ne=J[0],z=J[1];if(ne.group===t.groups.EX){let x=t.Settings.LOG,Y=`${x}((${z})/(${ne.multiplier}))/(${x}(${ne.value})*${ne.power.multiplier})`,X=e.parse(Y);R(X)}break}case 1:R(e.divide(Ge[0],Ge[1].negate()));break;case 2:R(Se.quad.apply(void 0,Ge));break;case 3:R(Se.cubic.apply(void 0,Ge));break;case 4:R(Se.quartic.apply(void 0,Ge));break;default:R(Se.csolve(U,a)),f.length===0&&R(Se.divideAndConquer(U,a))}f.length===0&&R(se(ge,a,f,w))}}catch(ge){if(ge.message==="timeout")throw ge}else try{let ge=Se.rewrite(U,null,a),Le=ge[0],xe=ge[1];if(Le.group===u)if(Le.fname==="abs")Le.args[0].toString()===a&&R([xe.clone(),xe.negate()]);else if(Le.fname==="sin")R(Se.inverseFunctionSolve("asin",Le,xe));else if(Le.fname==="cos")R(Se.inverseFunctionSolve("acos",Le,xe));else if(Le.fname==="tan")R(Se.inverseFunctionSolve("atan",Le,xe));else if(Le.fname===t.Settings.LOG){let He=y(Le.args[0],a),Ze=He[1];if(Ze.group===Me){xe=e.divide(e.subtract(e.pow(Le.args.length>1?Le.args[1]:new V("e"),e.divide(xe,e.parse(Le.multiplier))),He[3]),He[0]);let Ge=new ye(Ze,xe).toLHS();R(se(Ge,a))}}else R(e.subtract(Le,xe));else{let He=new ye(Le,xe).toLHS();if(He.equals(U))throw new Error("Stopping. No stop condition exists");R(se(He,a))}}catch(ge){if(ge.message==="timeout")throw ge;if(U.group===ce)R(0);else if(U.group===ue){let Le=Ie(U),xe=Le[0],He=Le[1];if(xe.group===t.groups.EX&&xe.value===a){let Ze=xe.power.clone().invert();R(e.pow(He,Ze))}}}if(we&&(f=f.map(ge=>e.pow(ge,new V(we)))),de(i)){let ge={};f=f.filter(Le=>{try{ge[a]=Le;let xe=Number(L(i,ge));return isNaN(xe),!0}catch(xe){if(xe.message==="timeout")throw xe;return!1}})}return f}R0.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return se}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return t.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return $e}}]),R0.updateAPI()})()});var p1=f0((e2,on)=>{"use strict";var L0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof on<"u"&&L0===void 0&&(L0=T0(),V0(),X0());(function(){let t=L0.getCore(),e=t.PARSER,{NerdamerSymbol:o}=t,{format:g}=t.Utils,{isVector:y}=t.Utils,{isArray:L}=t.Utils,C=t.Vector,{S:D}=t.groups,Z=t.groups.EX,{CP:G}=t.groups,{PL:V}=t.groups,{CB:de}=t.groups,{FN:Ee}=t.groups;t.Settings.Laplace_integration_depth=40,o.prototype.findFunction=function(ce){if(this.group===Ee&&this.fname===ce)return this.clone();let ue;if(this.symbols){for(let u in this.symbols)if(Object.hasOwn(this.symbols,u)&&(ue=this.symbols[u].findFunction(ce),ue))break}return ue};let Me=t.Extra={version:"1.4.2",LaPlace:{transform(ae,ce,ue){ae=ae.clone(),ce=ce.toString(),ae=o.unwrapSQRT(ae,!0);let u,Ne=ae.stripVar(ce),Oe=ae.group;if(ae=e.divide(ae,Ne.clone()),ae.isConstant()||!ae.contains(ce,!0))u=e.parse(g("({0})/({1})",ae,ue));else if(Oe===D&&t.Utils.isInt(ae.power)){let Pe=String(ae.power);u=e.parse(g("factorial({0})/({1})^({0}+1)",Pe,ue))}else if(ae.group===D&&ae.power.equals(1/2))u=e.parse(g("sqrt(pi)/(2*({0})^(3/2))",ue));else if(ae.isComposite())u=new o(0),ae.each(Pe=>{u=e.add(u,Me.LaPlace.transform(Pe,ce,ue))},!0);else if(ae.isE()&&(ae.power.group===D||ae.power.group===de)){let Pe=ae.power.stripVar(ce);u=e.parse(g("1/(({1})-({0}))",Pe,ue))}else{let Pe=["sin","cos","sinh","cosh"];if(ae.group===Ee&&Pe.indexOf(ae.fname)!==-1&&(ae.args[0].group===D||ae.args[0].group===de)){let ye=ae.args[0].stripVar(ce);switch(ae.fname){case"sin":u=e.parse(g("({0})/(({1})^2+({0})^2)",ye,ue));break;case"cos":u=e.parse(g("({1})/(({1})^2+({0})^2)",ye,ue));break;case"sinh":u=e.parse(g("({0})/(({1})^2-({0})^2)",ye,ue));break;case"cosh":u=e.parse(g("({1})/(({1})^2-({0})^2)",ye,ue));break}}else{let ye=t.Settings.integration_depth<t.Settings.Laplace_integration_depth,$e;ye&&($e=t.Settings.integration_depth,t.Settings.integration_depth=t.Settings.Laplace_integration_depth),t.Utils.block("PARSE2NUMBER",()=>{let he=ce,Se=ae.sub(ce,he),be=e.parse(`e^(-${ue}*${he})*${Se}`);if(u=t.Calculus.integrate(be,he),u.hasIntegral()){u=e.symfunction("laplace",[ae,ce,ue]);return}u=u.sub(ce,0),u=e.expand(e.multiply(u,new o(-1))),u=u.sub(he,ce)},!1),u=t.Utils.block("PARSE2NUMBER",()=>e.parse(u),!0),ye&&(t.Settings.integration_depth=$e)}}return e.multiply(u,Ne)},inverse(ae,ce,ue){let u=ae.clone();return t.Utils.block("POSITIVE_MULTIPLIERS",()=>{let Ne;if(ae.group===de&&(ae=t.Algebra.PartFrac.partfrac(e.expand(ae),ce)),ae.group===D||ae.group===de||ae.isComposite()){let Oe,Pe,ye,$e,he,Se,be,se,i=ae.multiplier.clone();ae.toUnitMultiplier();let a=ae.getNum(),f=ae.getDenom().toUnitMultiplier();f.group===G||f.group===V?(Pe=f.power.clone(),f.toLinear()):Pe=new t.Frac(1);let w=ce.toString(),d=t.Utils.decompose_fn(f,w,!0),v=t.Utils.decompose_fn(e.expand(a.clone()),w,!0);a.multiplier=a.multiplier.multiply(i);let b=function(){Ne=e.multiply(Ne,a),Ne.multiplier=Ne.multiplier.multiply(ae.multiplier),Ne=e.divide(Ne,d.a)};if((f.group===D||f.group===de)&&d.x.value===w&&d.b.equals(0)&&t.Utils.isInt(d.x.power))Oe=d.x.power-1,se=t.Math2.factorial(Oe),Ne=e.divide(e.pow(ue,new o(Oe)),new o(se)),b();else if(f.group===G&&Pe.equals(1)){if(d.x.group===t.groups.PL&&t.Algebra.degree(f).equals(2)){let R=t.Algebra.sqComplete(f,w),U=t.Utils.getU(f);ye=t.Utils.decompose_fn(R.a,w,!0).b;let B=Me.LaPlace.inverse(e.parse(`1/((${U})^2+(${R.c}))`),U,ue);Ne=e.multiply(B,e.parse(`(${i})*e^(-(${ye})*(${ue}))`))}else if(d.x.isLinear()&&!a.contains(w))ue=e.divide(ue,d.a.clone()),Oe=Pe-1,se=Oe===0||Oe===1?"1":`(${Pe}-1)!`,Ne=e.parse(g("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",ue,d.a,d.b,Pe,se)),b();else if(d.x.group===D&&d.x.power.equals(2))if(a.contains(w)){if(ye=new o(1),a.group===de){let pe=new o(1);a.each(Ie=>{Ie.contains(w)?pe=e.multiply(pe,Ie):ye=e.multiply(ye,Ie)}),a=pe}be=t.Utils.decompose_fn(a,w,!0);let R=be.a,U=be.b,B=R.containsFunction("sin"),te=R.containsFunction("cos"),re=U.containsFunction("cos"),we=U.containsFunction("sin");if(be.x.value===w&&be.x.isLinear()&&!(B&&re||te||we))Ne=e.parse(g("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",ue,be.a,d.a,d.b));else if(B&&re){let pe=R.findFunction("sin"),Ie=U.findFunction("cos");if(pe.args[0].equals(Ie.args[0])&&!pe.args[0].contains(w)){$e=e.divide(U,Ie.toUnitMultiplier()).toString();let Ce=pe.args[0].toString();he=d.b;let ge=e.divide(R,pe.toUnitMultiplier());Se="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",Ne=e.parse(g(Se,ue,ye,$e,Ce,he,ge))}}}else Ne=e.parse(g("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",ue,a,d.a,d.b))}else if(d.x.power.num&&d.x.power.num.equals(3)&&d.x.power.den.equals(2)&&a.contains("sqrt(pi)")&&!a.contains(w)&&a.isLinear())$e=e.divide(a.clone(),e.parse("sqrt(pi)")),Ne=e.parse(g("(2*({2})*sqrt({0}))/({1})",ue,d.a,$e,a));else if(Pe.equals(2)&&d.x.power.equals(2))if(a.contains(w))if(be=t.Utils.decompose_fn(e.expand(a.clone()),w,!0),be.x.isComposite()){let R=[],U=a.collectSymbols(B=>{B=o.unwrapPARENS(B);let te=t.Utils.decompose_fn(B,w,!0);return te.symbol=B,te}).sort((B,te)=>{let re=B.x.value===w?B.x.power:0;return(te.x.value===w?te.x.power:0)-re});ye=new o(-1);for(let B=0;B<U.length;B++){let te=U[B];te.x.value===w?R.push(te):ye=e.multiply(ye,te.symbol)}R[0].x.power.equals(2)&&R[1].x.power.equals(1)&&R[1].b.equals(0)&&!R[0].b.equals(0)&&($e=R[0].a.negate(),Se="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",Ne=e.parse(g(Se,ue,ye,$e,R[0].b,d.a,d.b)))}else be.x.isLinear()?(ye=e.divide(be.a,new o(2)),Se="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",Ne=e.parse(g(Se,ue,ye,d.a,d.b))):be.x.power.equals(2)&&(be.b.equals(0)?(ye=e.divide(be.a,new o(2)),Se="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ne=e.parse(g(Se,ue,ye,d.a,d.b))):(ye=e.divide(be.a,new o(2)),he=be.b.negate(),Se="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ne=e.parse(g(Se,ue,ye,d.a,d.b,he))));else ye=e.divide(a,new o(2)),Se="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",Ne=e.parse(g(Se,ue,ye,d.a,d.b));else ae.isComposite()&&(Pe.equals(2)&&d.x.group===D?Ne=e.parse(`(${i})*(${ue})*e^(-(${d.b})*(${ue}))`):(Ne=new o(0),ae=t.Algebra.PartFrac.partfrac(e.expand(ae),ce),ae.each(R=>{Ne=e.add(Ne,Me.LaPlace.inverse(R,ce,ue))},!0)))}return Ne||=e.symfunction("ilt",[u,ce,ue]),Ne},!0)}},Statistics:{frequencyMap(ae){let ce={};for(let ue=0,u=ae.length;ue<u;ue++){let Oe=ae[ue].toString();ce[Oe]||=0,ce[Oe]++}return ce},sort(ae){return ae.sort((ce,ue)=>((!ce.isConstant()||!ue.isConstant())&&e.error("Unable to sort! All values must be numeric"),ce.multiplier.subtract(ue.multiplier)))},count(ae){return new o(ae.length)},sum(ae,ce){let ue=new o(0);for(let u=0,Ne=ae.length;u<Ne;u++){let Oe=ae[u].clone();ce?ue=e.add(e.pow(e.subtract(Oe,ce.clone()),new o(2)),ue):ue=e.add(Oe,ue)}return ue},mean(...ae){return y(ae[0])?Me.Statistics.mean(...ae[0].elements):e.divide(Me.Statistics.sum(ae),Me.Statistics.count(ae))},median(...ae){let ce;if(y(ae[0]))return Me.Statistics.median(...ae[0].elements);try{let ue=Me.Statistics.sort(ae),u=ae.length;if(t.Utils.even(u)){let Ne=u/2;ce=Me.Statistics.mean(ue[Ne-1],ue[Ne])}else ce=ue[Math.floor(u/2)]}catch(ue){if(ue.message==="timeout")throw ue;ce=e.symfunction("median",ae)}return ce},mode(...ae){let ce;if(y(ae[0]))return Me.Statistics.mode(...ae[0].elements);let ue=Me.Statistics.frequencyMap(ae);if(t.Utils.keys(ue).length===1)ce=ae[0];else{let u={};for(let Oe in ue){if(!Object.hasOwn(ue,Oe))continue;let Pe=ue[Oe];if(Pe in u){let ye=u[Pe];L(ye)?ye.push(Oe):u[Pe]=[Oe,u[Pe]]}else u[Pe]=Oe}let Ne=u[Math.max.apply(null,t.Utils.keys(u))];L(Ne)?ce=e.symfunction("mode",Ne.sort()):ce=e.parse(Ne)}return ce},gVariance(ae,ce){let ue=Me.Statistics.mean(...ce),u=Me.Statistics.sum(ce,ue);return e.multiply(ae,u)},variance(...ae){if(y(ae[0]))return Me.Statistics.variance(...ae[0].elements);let ce=e.divide(new o(1),Me.Statistics.count(ae));return Me.Statistics.gVariance(ce,ae)},sampleVariance(...ae){if(y(ae[0]))return Me.Statistics.sampleVariance(...ae[0].elements);let ce=e.divide(new o(1),e.subtract(Me.Statistics.count(ae),new o(1)));return Me.Statistics.gVariance(ce,ae)},standardDeviation(...ae){return y(ae[0])?Me.Statistics.standardDeviation(...ae[0].elements):e.pow(Me.Statistics.variance(...ae),new o(1/2))},sampleStandardDeviation(...ae){return y(ae[0])?Me.Statistics.sampleStandardDeviation(...ae[0].elements):e.pow(Me.Statistics.sampleVariance(...ae),new o(1/2))},zScore(ae,ce,ue){return e.divide(e.subtract(ae,ce),ue)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};L0.register([{name:"laplace",visible:!0,numargs:3,build(){return Me.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Me.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Me.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Me.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Me.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Me.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Me.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Me.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Me.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Me.Statistics.zScore}}]),L0.updateAPI()})();typeof on<"u"&&(on.exports=L0)});var ji=f0((t2,h1)=>{var Hi=T0();X0();V0();f1();p1();h1.exports=Hi});return ji();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
