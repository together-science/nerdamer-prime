"use strict";var nerdamer=(()=>{var f0=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var qn=f0((zi,H0)=>{var kt=(function(r){"use strict";var t=1e7,e=7,o=9007199254740992,h=we(o),y="0123456789abcdefghijklmnopqrstuvwxyz",L=typeof BigInt=="function";function b(g,p,P,w){return typeof g>"u"?b[0]:typeof p<"u"?+p==10&&!P?O(g):Xe(g,p,P,w):O(g)}function k(g,p){this.value=g,this.sign=p,this.isSmall=!1}k.prototype=Object.create(b.prototype);function G(g){this.value=g,this.sign=g<0,this.isSmall=!0}G.prototype=Object.create(b.prototype);function V(g){this.value=g}V.prototype=Object.create(b.prototype);function Y(g){return-o<g&&g<o}function we(g){return g<1e7?[g]:g<1e14?[g%1e7,Math.floor(g/1e7)]:[g%1e7,Math.floor(g/1e7)%1e7,Math.floor(g/1e14)]}function Ee(g){Me(g);var p=g.length;if(p<4&&M(g,h)<0)switch(p){case 0:return 0;case 1:return g[0];case 2:return g[0]+g[1]*t;default:return g[0]+(g[1]+g[2]*t)*t}return g}function Me(g){for(var p=g.length;g[--p]===0;);g.length=p+1}function se(g){for(var p=new Array(g),P=-1;++P<g;)p[P]=0;return p}function ge(g){return g>0?Math.floor(g):Math.ceil(g)}function fe(g,p){var P=g.length,w=p.length,U=new Array(P),B=0,Z=t,J,ie;for(ie=0;ie<w;ie++)J=g[ie]+p[ie]+B,B=J>=Z?1:0,U[ie]=J-B*Z;for(;ie<P;)J=g[ie]+B,B=J===Z?1:0,U[ie++]=J-B*Z;return B>0&&U.push(B),U}function a(g,p){return g.length>=p.length?fe(g,p):fe(p,g)}function Ne(g,p){var P=g.length,w=new Array(P),U=t,B,Z;for(Z=0;Z<P;Z++)B=g[Z]-U+p,p=Math.floor(B/U),w[Z]=B-p*U,p+=1;for(;p>0;)w[Z++]=p%U,p=Math.floor(p/U);return w}k.prototype.add=function(g){var p=O(g);if(this.sign!==p.sign)return this.subtract(p.negate());var P=this.value,w=p.value;return p.isSmall?new k(Ne(P,Math.abs(w)),this.sign):new k(a(P,w),this.sign)},k.prototype.plus=k.prototype.add,G.prototype.add=function(g){var p=O(g),P=this.value;if(P<0!==p.sign)return this.subtract(p.negate());var w=p.value;if(p.isSmall){if(Y(P+w))return new G(P+w);w=we(Math.abs(w))}return new k(Ne(w,Math.abs(P)),P<0)},G.prototype.plus=G.prototype.add,V.prototype.add=function(g){return new V(this.value+O(g).value)},V.prototype.plus=V.prototype.add;function be(g,p){var P=g.length,w=p.length,U=new Array(P),B=0,Z=t,J,ie;for(J=0;J<w;J++)ie=g[J]-B-p[J],ie<0?(ie+=Z,B=1):B=0,U[J]=ie;for(J=w;J<P;J++){if(ie=g[J]-B,ie<0)ie+=Z;else{U[J++]=ie;break}U[J]=ie}for(;J<P;J++)U[J]=g[J];return Me(U),U}function Le(g,p,P){var w;return M(g,p)>=0?w=be(g,p):(w=be(p,g),P=!P),w=Ee(w),typeof w=="number"?(P&&(w=-w),new G(w)):new k(w,P)}function Ae(g,p,P){var w=g.length,U=new Array(w),B=-p,Z=t,J,ie;for(J=0;J<w;J++)ie=g[J]+B,B=Math.floor(ie/Z),ie%=Z,U[J]=ie<0?ie+Z:ie;return U=Ee(U),typeof U=="number"?(P&&(U=-U),new G(U)):new k(U,P)}k.prototype.subtract=function(g){var p=O(g);if(this.sign!==p.sign)return this.add(p.negate());var P=this.value,w=p.value;return p.isSmall?Ae(P,Math.abs(w),this.sign):Le(P,w,this.sign)},k.prototype.minus=k.prototype.subtract,G.prototype.subtract=function(g){var p=O(g),P=this.value;if(P<0!==p.sign)return this.add(p.negate());var w=p.value;return p.isSmall?new G(P-w):Ae(w,Math.abs(P),P>=0)},G.prototype.minus=G.prototype.subtract,V.prototype.subtract=function(g){return new V(this.value-O(g).value)},V.prototype.minus=V.prototype.subtract,k.prototype.negate=function(){return new k(this.value,!this.sign)},G.prototype.negate=function(){var g=this.sign,p=new G(-this.value);return p.sign=!g,p},V.prototype.negate=function(){return new V(-this.value)},k.prototype.abs=function(){return new k(this.value,!1)},G.prototype.abs=function(){return new G(Math.abs(this.value))},V.prototype.abs=function(){return new V(this.value>=0?this.value:-this.value)};function xe(g,p){var P=g.length,w=p.length,U=P+w,B=se(U),Z=t,J,ie,le,te,ae;for(le=0;le<P;++le){te=g[le];for(var de=0;de<w;++de)ae=p[de],J=te*ae+B[le+de],ie=Math.floor(J/Z),B[le+de]=J-ie*Z,B[le+de+1]+=ie}return Me(B),B}function me(g,p){var P=g.length,w=new Array(P),U=t,B=0,Z,J;for(J=0;J<P;J++)Z=g[J]*p+B,B=Math.floor(Z/U),w[J]=Z-B*U;for(;B>0;)w[J++]=B%U,B=Math.floor(B/U);return w}function _e(g,p){for(var P=[];p-- >0;)P.push(0);return P.concat(g)}function ye(g,p){var P=Math.max(g.length,p.length);if(P<=30)return xe(g,p);P=Math.ceil(P/2);var w=g.slice(P),U=g.slice(0,P),B=p.slice(P),Z=p.slice(0,P),J=ye(U,Z),ie=ye(w,B),le=ye(a(U,w),a(Z,B)),te=a(a(J,_e(be(be(le,J),ie),P)),_e(ie,2*P));return Me(te),te}function he(g,p){return-.012*g-.012*p+15e-6*g*p>0}k.prototype.multiply=function(g){var p=O(g),P=this.value,w=p.value,U=this.sign!==p.sign,B;if(p.isSmall){if(w===0)return b[0];if(w===1)return this;if(w===-1)return this.negate();if(B=Math.abs(w),B<t)return new k(me(P,B),U);w=we(B)}return he(P.length,w.length)?new k(ye(P,w),U):new k(xe(P,w),U)},k.prototype.times=k.prototype.multiply;function s(g,p,P){return g<t?new k(me(p,g),P):new k(xe(p,we(g)),P)}G.prototype._multiplyBySmall=function(g){return Y(g.value*this.value)?new G(g.value*this.value):s(Math.abs(g.value),we(Math.abs(this.value)),this.sign!==g.sign)},k.prototype._multiplyBySmall=function(g){return g.value===0?b[0]:g.value===1?this:g.value===-1?this.negate():s(Math.abs(g.value),this.value,this.sign!==g.sign)},G.prototype.multiply=function(g){return O(g)._multiplyBySmall(this)},G.prototype.times=G.prototype.multiply,V.prototype.multiply=function(g){return new V(this.value*O(g).value)},V.prototype.times=V.prototype.multiply;function f(g){var p=g.length,P=se(p+p),w=t,U,B,Z,J,ie;for(Z=0;Z<p;Z++){J=g[Z],B=0-J*J;for(var le=Z;le<p;le++)ie=g[le],U=2*(J*ie)+P[Z+le]+B,B=Math.floor(U/w),P[Z+le]=U-B*w;P[Z+p]=B}return Me(P),P}k.prototype.square=function(){return new k(f(this.value),!1)},G.prototype.square=function(){var g=this.value*this.value;return Y(g)?new G(g):new k(f(we(Math.abs(this.value))),!1)},V.prototype.square=function(g){return new V(this.value*this.value)};function S(g,p){var P=g.length,w=p.length,U=t,B=se(p.length),Z=p[w-1],J=Math.ceil(U/(2*Z)),ie=me(g,J),le=me(p,J),te,ae,de,Be,Te,ze,We;for(ie.length<=P&&ie.push(0),le.push(0),Z=le[w-1],ae=P-w;ae>=0;ae--){for(te=U-1,ie[ae+w]!==Z&&(te=Math.floor((ie[ae+w]*U+ie[ae+w-1])/Z)),de=0,Be=0,ze=le.length,Te=0;Te<ze;Te++)de+=te*le[Te],We=Math.floor(de/U),Be+=ie[ae+Te]-(de-We*U),de=We,Be<0?(ie[ae+Te]=Be+U,Be=-1):(ie[ae+Te]=Be,Be=0);for(;Be!==0;){for(te-=1,de=0,Te=0;Te<ze;Te++)de+=ie[ae+Te]-U+le[Te],de<0?(ie[ae+Te]=de+U,de=0):(ie[ae+Te]=de,de=1);Be+=de}B[ae]=te}return ie=c(ie,J)[0],[Ee(B),Ee(ie)]}function _(g,p){for(var P=g.length,w=p.length,U=[],B=[],Z=t,J,ie,le,te,ae;P;){if(B.unshift(g[--P]),Me(B),M(B,p)<0){U.push(0);continue}ie=B.length,le=B[ie-1]*Z+B[ie-2],te=p[w-1]*Z+p[w-2],ie>w&&(le=(le+1)*Z),J=Math.ceil(le/te);do{if(ae=me(p,J),M(ae,B)<=0)break;J--}while(J);U.push(J),B=be(B,ae)}return U.reverse(),[Ee(U),Ee(B)]}function c(g,p){var P=g.length,w=se(P),U=t,B,Z,J,ie;for(J=0,B=P-1;B>=0;--B)ie=J*U+g[B],Z=ge(ie/p),J=ie-Z*p,w[B]=Z|0;return[w,J|0]}function m(g,p){var P,w=O(p);if(L)return[new V(g.value/w.value),new V(g.value%w.value)];var U=g.value,B=w.value,Z;if(B===0)throw new Error("Cannot divide by zero");if(g.isSmall)return w.isSmall?[new G(ge(U/B)),new G(U%B)]:[b[0],g];if(w.isSmall){if(B===1)return[g,b[0]];if(B==-1)return[g.negate(),b[0]];var J=Math.abs(B);if(J<t){P=c(U,J),Z=Ee(P[0]);var ie=P[1];return g.sign&&(ie=-ie),typeof Z=="number"?(g.sign!==w.sign&&(Z=-Z),[new G(Z),new G(ie)]):[new k(Z,g.sign!==w.sign),new G(ie)]}B=we(J)}var le=M(U,B);if(le===-1)return[b[0],g];if(le===0)return[b[g.sign===w.sign?1:-1],b[0]];U.length+B.length<=200?P=S(U,B):P=_(U,B),Z=P[0];var te=g.sign!==w.sign,ae=P[1],de=g.sign;return typeof Z=="number"?(te&&(Z=-Z),Z=new G(Z)):Z=new k(Z,te),typeof ae=="number"?(de&&(ae=-ae),ae=new G(ae)):ae=new k(ae,de),[Z,ae]}k.prototype.divmod=function(g){var p=m(this,g);return{quotient:p[0],remainder:p[1]}},V.prototype.divmod=G.prototype.divmod=k.prototype.divmod,k.prototype.divide=function(g){return m(this,g)[0]},V.prototype.over=V.prototype.divide=function(g){return new V(this.value/O(g).value)},G.prototype.over=G.prototype.divide=k.prototype.over=k.prototype.divide,k.prototype.mod=function(g){return m(this,g)[1]},V.prototype.mod=V.prototype.remainder=function(g){return new V(this.value%O(g).value)},G.prototype.remainder=G.prototype.mod=k.prototype.remainder=k.prototype.mod,k.prototype.pow=function(g){var p=O(g),P=this.value,w=p.value,U,B,Z;if(w===0)return b[1];if(P===0)return b[0];if(P===1)return b[1];if(P===-1)return p.isEven()?b[1]:b[-1];if(p.sign)return b[0];if(!p.isSmall)throw new Error("The exponent "+p.toString()+" is too large.");if(this.isSmall&&Y(U=Math.pow(P,w)))return new G(ge(U));for(B=this,Z=b[1];w&!0&&(Z=Z.times(B),--w),w!==0;)w/=2,B=B.square();return Z},G.prototype.pow=k.prototype.pow,V.prototype.pow=function(g){var p=O(g),P=this.value,w=p.value,U=BigInt(0),B=BigInt(1),Z=BigInt(2);if(w===U)return b[1];if(P===U)return b[0];if(P===B)return b[1];if(P===BigInt(-1))return p.isEven()?b[1]:b[-1];if(p.isNegative())return new V(U);for(var J=this,ie=b[1];(w&B)===B&&(ie=ie.times(J),--w),w!==U;)w/=Z,J=J.square();return ie},k.prototype.modPow=function(g,p){if(g=O(g),p=O(p),p.isZero())throw new Error("Cannot take modPow with modulus 0");var P=b[1],w=this.mod(p);for(g.isNegative()&&(g=g.multiply(b[-1]),w=w.modInv(p));g.isPositive();){if(w.isZero())return b[0];g.isOdd()&&(P=P.multiply(w).mod(p)),g=g.divide(2),w=w.square().mod(p)}return P},V.prototype.modPow=G.prototype.modPow=k.prototype.modPow;function M(g,p){if(g.length!==p.length)return g.length>p.length?1:-1;for(var P=g.length-1;P>=0;P--)if(g[P]!==p[P])return g[P]>p[P]?1:-1;return 0}k.prototype.compareAbs=function(g){var p=O(g),P=this.value,w=p.value;return p.isSmall?1:M(P,w)},G.prototype.compareAbs=function(g){var p=O(g),P=Math.abs(this.value),w=p.value;return p.isSmall?(w=Math.abs(w),P===w?0:P>w?1:-1):-1},V.prototype.compareAbs=function(g){var p=this.value,P=O(g).value;return p=p>=0?p:-p,P=P>=0?P:-P,p===P?0:p>P?1:-1},k.prototype.compare=function(g){if(g===1/0)return-1;if(g===-1/0)return 1;var p=O(g),P=this.value,w=p.value;return this.sign!==p.sign?p.sign?1:-1:p.isSmall?this.sign?-1:1:M(P,w)*(this.sign?-1:1)},k.prototype.compareTo=k.prototype.compare,G.prototype.compare=function(g){if(g===1/0)return-1;if(g===-1/0)return 1;var p=O(g),P=this.value,w=p.value;return p.isSmall?P==w?0:P>w?1:-1:P<0!==p.sign?P<0?-1:1:P<0?1:-1},G.prototype.compareTo=G.prototype.compare,V.prototype.compare=function(g){if(g===1/0)return-1;if(g===-1/0)return 1;var p=this.value,P=O(g).value;return p===P?0:p>P?1:-1},V.prototype.compareTo=V.prototype.compare,k.prototype.equals=function(g){return this.compare(g)===0},V.prototype.eq=V.prototype.equals=G.prototype.eq=G.prototype.equals=k.prototype.eq=k.prototype.equals,k.prototype.notEquals=function(g){return this.compare(g)!==0},V.prototype.neq=V.prototype.notEquals=G.prototype.neq=G.prototype.notEquals=k.prototype.neq=k.prototype.notEquals,k.prototype.greater=function(g){return this.compare(g)>0},V.prototype.gt=V.prototype.greater=G.prototype.gt=G.prototype.greater=k.prototype.gt=k.prototype.greater,k.prototype.lesser=function(g){return this.compare(g)<0},V.prototype.lt=V.prototype.lesser=G.prototype.lt=G.prototype.lesser=k.prototype.lt=k.prototype.lesser,k.prototype.greaterOrEquals=function(g){return this.compare(g)>=0},V.prototype.geq=V.prototype.greaterOrEquals=G.prototype.geq=G.prototype.greaterOrEquals=k.prototype.geq=k.prototype.greaterOrEquals,k.prototype.lesserOrEquals=function(g){return this.compare(g)<=0},V.prototype.leq=V.prototype.lesserOrEquals=G.prototype.leq=G.prototype.lesserOrEquals=k.prototype.leq=k.prototype.lesserOrEquals,k.prototype.isEven=function(){return(this.value[0]&1)===0},G.prototype.isEven=function(){return(this.value&1)===0},V.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},k.prototype.isOdd=function(){return(this.value[0]&1)===1},G.prototype.isOdd=function(){return(this.value&1)===1},V.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},k.prototype.isPositive=function(){return!this.sign},G.prototype.isPositive=function(){return this.value>0},V.prototype.isPositive=G.prototype.isPositive,k.prototype.isNegative=function(){return this.sign},G.prototype.isNegative=function(){return this.value<0},V.prototype.isNegative=G.prototype.isNegative,k.prototype.isUnit=function(){return!1},G.prototype.isUnit=function(){return Math.abs(this.value)===1},V.prototype.isUnit=function(){return this.abs().value===BigInt(1)},k.prototype.isZero=function(){return!1},G.prototype.isZero=function(){return this.value===0},V.prototype.isZero=function(){return this.value===BigInt(0)},k.prototype.isDivisibleBy=function(g){var p=O(g);return p.isZero()?!1:p.isUnit()?!0:p.compareAbs(2)===0?this.isEven():this.mod(p).isZero()},V.prototype.isDivisibleBy=G.prototype.isDivisibleBy=k.prototype.isDivisibleBy;function q(g){var p=g.abs();if(p.isUnit())return!1;if(p.equals(2)||p.equals(3)||p.equals(5))return!0;if(p.isEven()||p.isDivisibleBy(3)||p.isDivisibleBy(5))return!1;if(p.lesser(49))return!0}function F(g,p){for(var P=g.prev(),w=P,U=0,B,Z,J,ie;w.isEven();)w=w.divide(2),U++;e:for(J=0;J<p.length;J++)if(!g.lesser(p[J])&&(ie=kt(p[J]).modPow(w,g),!(ie.isUnit()||ie.equals(P)))){for(B=U-1;B!=0;B--){if(ie=ie.square().mod(g),ie.isUnit())return!1;if(ie.equals(P))continue e}return!1}return!0}k.prototype.isPrime=function(g){var p=q(this);if(p!==r)return p;var P=this.abs(),w=P.bitLength();if(w<=64)return F(P,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var U=Math.log(2)*w.toJSNumber(),B=Math.ceil(g===!0?2*Math.pow(U,2):U),Z=[],J=0;J<B;J++)Z.push(kt(J+2));return F(P,Z)},V.prototype.isPrime=G.prototype.isPrime=k.prototype.isPrime,k.prototype.isProbablePrime=function(g,p){var P=q(this);if(P!==r)return P;for(var w=this.abs(),U=g===r?5:g,B=[],Z=0;Z<U;Z++)B.push(kt.randBetween(2,w.minus(2),p));return F(w,B)},V.prototype.isProbablePrime=G.prototype.isProbablePrime=k.prototype.isProbablePrime,k.prototype.modInv=function(g){for(var p=kt.zero,P=kt.one,w=O(g),U=this.abs(),B,Z,J;!U.isZero();)B=w.divide(U),Z=p,J=w,p=P,w=U,P=Z.subtract(B.multiply(P)),U=J.subtract(B.multiply(U));if(!w.isUnit())throw new Error(this.toString()+" and "+g.toString()+" are not co-prime");return p.compare(0)===-1&&(p=p.add(g)),this.isNegative()?p.negate():p},V.prototype.modInv=G.prototype.modInv=k.prototype.modInv,k.prototype.next=function(){var g=this.value;return this.sign?Ae(g,1,this.sign):new k(Ne(g,1),this.sign)},G.prototype.next=function(){var g=this.value;return g+1<o?new G(g+1):new k(h,!1)},V.prototype.next=function(){return new V(this.value+BigInt(1))},k.prototype.prev=function(){var g=this.value;return this.sign?new k(Ne(g,1),!0):Ae(g,1,this.sign)},G.prototype.prev=function(){var g=this.value;return g-1>-o?new G(g-1):new k(h,!0)},V.prototype.prev=function(){return new V(this.value-BigInt(1))};for(var $=[1];2*$[$.length-1]<=t;)$.push(2*$[$.length-1]);var Q=$.length,K=$[Q-1];function ne(g){return Math.abs(g)<=t}k.prototype.shiftLeft=function(g){var p=O(g).toJSNumber();if(!ne(p))throw new Error(String(p)+" is too large for shifting.");if(p<0)return this.shiftRight(-p);var P=this;if(P.isZero())return P;for(;p>=Q;)P=P.multiply(K),p-=Q-1;return P.multiply($[p])},V.prototype.shiftLeft=G.prototype.shiftLeft=k.prototype.shiftLeft,k.prototype.shiftRight=function(g){var p,P=O(g).toJSNumber();if(!ne(P))throw new Error(String(P)+" is too large for shifting.");if(P<0)return this.shiftLeft(-P);for(var w=this;P>=Q;){if(w.isZero()||w.isNegative()&&w.isUnit())return w;p=m(w,K),w=p[1].isNegative()?p[0].prev():p[0],P-=Q-1}return p=m(w,$[P]),p[1].isNegative()?p[0].prev():p[0]},V.prototype.shiftRight=G.prototype.shiftRight=k.prototype.shiftRight;function pe(g,p,P){p=O(p);for(var w=g.isNegative(),U=p.isNegative(),B=w?g.not():g,Z=U?p.not():p,J=0,ie=0,le=null,te=null,ae=[];!B.isZero()||!Z.isZero();)le=m(B,K),J=le[1].toJSNumber(),w&&(J=K-1-J),te=m(Z,K),ie=te[1].toJSNumber(),U&&(ie=K-1-ie),B=le[0],Z=te[0],ae.push(P(J,ie));for(var de=P(w?1:0,U?1:0)!==0?kt(-1):kt(0),Be=ae.length-1;Be>=0;Be-=1)de=de.multiply(K).add(kt(ae[Be]));return de}k.prototype.not=function(){return this.negate().prev()},V.prototype.not=G.prototype.not=k.prototype.not,k.prototype.and=function(g){return pe(this,g,function(p,P){return p&P})},V.prototype.and=G.prototype.and=k.prototype.and,k.prototype.or=function(g){return pe(this,g,function(p,P){return p|P})},V.prototype.or=G.prototype.or=k.prototype.or,k.prototype.xor=function(g){return pe(this,g,function(p,P){return p^P})},V.prototype.xor=G.prototype.xor=k.prototype.xor;var Se=1<<30,ve=(t&-t)*(t&-t)|Se;function Ue(g){var p=g.value,P=typeof p=="number"?p|Se:typeof p=="bigint"?p|BigInt(Se):p[0]+p[1]*t|ve;return P&-P}function De(g,p){if(p.compareTo(g)<=0){var P=De(g,p.square(p)),w=P.p,U=P.e,B=w.multiply(p);return B.compareTo(g)<=0?{p:B,e:U*2+1}:{p:w,e:U*2}}return{p:kt(1),e:0}}k.prototype.bitLength=function(){var g=this;return g.compareTo(kt(0))<0&&(g=g.negate().subtract(kt(1))),g.compareTo(kt(0))===0?kt(0):kt(De(g,kt(2)).e).add(kt(1))},V.prototype.bitLength=G.prototype.bitLength=k.prototype.bitLength;function Je(g,p){return g=O(g),p=O(p),g.greater(p)?g:p}function rt(g,p){return g=O(g),p=O(p),g.lesser(p)?g:p}function qe(g,p){if(g=O(g).abs(),p=O(p).abs(),g.equals(p))return g;if(g.isZero())return p;if(p.isZero())return g;for(var P=b[1],w,U;g.isEven()&&p.isEven();)w=rt(Ue(g),Ue(p)),g=g.divide(w),p=p.divide(w),P=P.multiply(w);for(;g.isEven();)g=g.divide(Ue(g));do{for(;p.isEven();)p=p.divide(Ue(p));g.greater(p)&&(U=p,p=g,g=U),p=p.subtract(g)}while(!p.isZero());return P.isUnit()?g:g.multiply(P)}function Fe(g,p){return g=O(g).abs(),p=O(p).abs(),g.divide(qe(g,p)).multiply(p)}function $e(g,p,P){g=O(g),p=O(p);var w=P||Math.random,U=rt(g,p),B=Je(g,p),Z=B.subtract(U).add(1);if(Z.isSmall)return U.add(Math.floor(w()*Z));for(var J=j(Z,t).value,ie=[],le=!0,te=0;te<J.length;te++){var ae=le?J[te]+(te+1<J.length?J[te+1]/t:0):t,de=ge(w()*ae);ie.push(de),de<J[te]&&(le=!1)}return U.add(b.fromArray(ie,t,!1))}var Xe=function(g,p,P,w){P=P||y,g=String(g),w||(g=g.toLowerCase(),P=P.toLowerCase());var U=g.length,B,Z=Math.abs(p),J={};for(B=0;B<P.length;B++)J[P[B]]=B;for(B=0;B<U;B++){var ie=g[B];if(ie!=="-"&&ie in J&&J[ie]>=Z){if(ie==="1"&&Z===1)continue;throw new Error(ie+" is not a valid digit in base "+p+".")}}p=O(p);var le=[],te=g[0]==="-";for(B=te?1:0;B<g.length;B++){var ie=g[B];if(ie in J)le.push(O(J[ie]));else if(ie==="<"){var ae=B;do B++;while(g[B]!==">"&&B<g.length);le.push(O(g.slice(ae+1,B)))}else throw new Error(ie+" is not a valid character")}return ke(le,p,te)};function ke(g,p,P){var w=b[0],U=b[1],B;for(B=g.length-1;B>=0;B--)w=w.add(g[B].times(U)),U=U.times(p);return P?w.negate():w}function z(g,p){return p=p||y,g<p.length?p[g]:"<"+g+">"}function j(g,p){if(p=kt(p),p.isZero()){if(g.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(p.equals(-1)){if(g.isZero())return{value:[0],isNegative:!1};if(g.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-g.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var P=Array.apply(null,Array(g.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return P.unshift([1]),{value:[].concat.apply([],P),isNegative:!1}}var w=!1;if(g.isNegative()&&p.isPositive()&&(w=!0,g=g.abs()),p.isUnit())return g.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(g.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:w};for(var U=[],B=g,Z;B.isNegative()||B.compareAbs(p)>=0;){Z=B.divmod(p),B=Z.quotient;var J=Z.remainder;J.isNegative()&&(J=p.minus(J).abs(),B=B.next()),U.push(J.toJSNumber())}return U.push(B.toJSNumber()),{value:U.reverse(),isNegative:w}}function X(g,p,P){var w=j(g,p);return(w.isNegative?"-":"")+w.value.map(function(U){return z(U,P)}).join("")}k.prototype.toArray=function(g){return j(this,g)},G.prototype.toArray=function(g){return j(this,g)},V.prototype.toArray=function(g){return j(this,g)},k.prototype.toString=function(g,p){if(g===r&&(g=10),g!==10||p)return X(this,g,p);for(var P=this.value,w=P.length,U=String(P[--w]),B="0000000",Z;--w>=0;)Z=String(P[w]),U+=B.slice(Z.length)+Z;var J=this.sign?"-":"";return J+U},G.prototype.toString=function(g,p){return g===r&&(g=10),g!=10||p?X(this,g,p):String(this.value)},V.prototype.toString=G.prototype.toString,V.prototype.toJSON=k.prototype.toJSON=G.prototype.toJSON=function(){return this.toString()},k.prototype.valueOf=function(){return parseInt(this.toString(),10)},k.prototype.toJSNumber=k.prototype.valueOf,G.prototype.valueOf=function(){return this.value},G.prototype.toJSNumber=G.prototype.valueOf,V.prototype.valueOf=V.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function D(g){if(Y(+g)){var p=+g;if(p===ge(p))return L?new V(BigInt(p)):new G(p);throw new Error("Invalid integer: "+g)}var P=g[0]==="-";P&&(g=g.slice(1));var w=g.split(/e/i);if(w.length>2)throw new Error("Invalid integer: "+w.join("e"));if(w.length===2){var U=w[1];if(U[0]==="+"&&(U=U.slice(1)),U=+U,U!==ge(U)||!Y(U))throw new Error("Invalid integer: "+U+" is not a valid exponent.");var B=w[0],Z=B.indexOf(".");if(Z>=0&&(U-=B.length-Z-1,B=B.slice(0,Z)+B.slice(Z+1)),U<0)throw new Error("Cannot include negative exponent part for integers");B+=new Array(U+1).join("0"),g=B}var J=/^([0-9][0-9]*)$/.test(g);if(!J)throw new Error("Invalid integer: "+g);if(L)return new V(BigInt(P?"-"+g:g));for(var ie=[],le=g.length,te=e,ae=le-te;le>0;)ie.push(+g.slice(ae,le)),ae-=te,ae<0&&(ae=0),le-=te;return Me(ie),new k(ie,P)}function ee(g){if(L)return new V(BigInt(g));if(Y(g)){if(g!==ge(g))throw new Error(g+" is not an integer.");return new G(g)}return D(g.toString())}function O(g){return typeof g=="number"?ee(g):typeof g=="string"?D(g):typeof g=="bigint"?new V(g):g}for(var x=0;x<1e3;x++)b[x]=O(x),x>0&&(b[-x]=O(-x));return b.one=b[1],b.zero=b[0],b.minusOne=b[-1],b.max=Je,b.min=rt,b.gcd=qe,b.lcm=Fe,b.isInstance=function(g){return g instanceof k||g instanceof G||g instanceof V},b.randBetween=$e,b.fromArray=function(g,p,P){return ke(g.map(O),O(p||10),P)},b})();typeof H0<"u"&&H0.hasOwnProperty("exports")&&(H0.exports=kt);typeof define=="function"&&define.amd&&define(function(){return kt})});var Rn=f0((Tn,j0)=>{(function(r){"use strict";var t=9e15,e=1e9,o="0123456789abcdef",h="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",y="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",L={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-t,maxE:t,crypto:!1},b,k,G,V,Y=!0,we="[DecimalError] ",Ee=we+"Invalid argument: ",Me=we+"Precision limit exceeded",se=we+"crypto unavailable",ge="[object Decimal]",fe=Math.floor,a=Math.pow,Ne=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,be=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Le=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ae=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,xe=1e7,me=7,_e=9007199254740991,ye=h.length-1,he=y.length-1,s={toStringTag:ge};s.absoluteValue=s.abs=function(){var u=new this.constructor(this);return u.s<0&&(u.s=1),q(u)},s.ceil=function(){return q(new this.constructor(this),this.e+1,2)},s.clampedTo=s.clamp=function(u,N){var A,C=this,R=C.constructor;if(u=new R(u),N=new R(N),!u.s||!N.s)return new R(NaN);if(u.gt(N))throw Error(Ee+N);return A=C.cmp(u),A<0?u:C.cmp(N)>0?N:new R(C)},s.comparedTo=s.cmp=function(u){var N,A,C,R,n=this,i=n.d,l=(u=new n.constructor(u)).d,v=n.s,d=u.s;if(!i||!l)return!v||!d?NaN:v!==d?v:i===l?0:!i^v<0?1:-1;if(!i[0]||!l[0])return i[0]?v:l[0]?-d:0;if(v!==d)return v;if(n.e!==u.e)return n.e>u.e^v<0?1:-1;for(C=i.length,R=l.length,N=0,A=C<R?C:R;N<A;++N)if(i[N]!==l[N])return i[N]>l[N]^v<0?1:-1;return C===R?0:C>R^v<0?1:-1},s.cosine=s.cos=function(){var u,N,A=this,C=A.constructor;return A.d?A.d[0]?(u=C.precision,N=C.rounding,C.precision=u+Math.max(A.e,A.sd())+me,C.rounding=1,A=m(C,z(C,A)),C.precision=u,C.rounding=N,q(V==2||V==3?A.neg():A,u,N,!0)):new C(1):new C(NaN)},s.cubeRoot=s.cbrt=function(){var u,N,A,C,R,n,i,l,v,d,T=this,E=T.constructor;if(!T.isFinite()||T.isZero())return new E(T);for(Y=!1,n=T.s*a(T.s*T,1/3),!n||Math.abs(n)==1/0?(A=f(T.d),u=T.e,(n=(u-A.length+1)%3)&&(A+=n==1||n==-2?"0":"00"),n=a(A,1/3),u=fe((u+1)/3)-(u%3==(u<0?-1:2)),n==1/0?A="5e"+u:(A=n.toExponential(),A=A.slice(0,A.indexOf("e")+1)+u),C=new E(A),C.s=T.s):C=new E(n.toString()),i=(u=E.precision)+3;;)if(l=C,v=l.times(l).times(l),d=v.plus(T),C=M(d.plus(T).times(l),d.plus(v),i+2,1),f(l.d).slice(0,i)===(A=f(C.d)).slice(0,i))if(A=A.slice(i-3,i+1),A=="9999"||!R&&A=="4999"){if(!R&&(q(l,u+1,0),l.times(l).times(l).eq(T))){C=l;break}i+=4,R=1}else{(!+A||!+A.slice(1)&&A.charAt(0)=="5")&&(q(C,u+1,1),N=!C.times(C).times(C).eq(T));break}return Y=!0,q(C,u,E.rounding,N)},s.decimalPlaces=s.dp=function(){var u,N=this.d,A=NaN;if(N){if(u=N.length-1,A=(u-fe(this.e/me))*me,u=N[u],u)for(;u%10==0;u/=10)A--;A<0&&(A=0)}return A},s.dividedBy=s.div=function(u){return M(this,new this.constructor(u))},s.dividedToIntegerBy=s.divToInt=function(u){var N=this,A=N.constructor;return q(M(N,new A(u),0,1,1),A.precision,A.rounding)},s.equals=s.eq=function(u){return this.cmp(u)===0},s.floor=function(){return q(new this.constructor(this),this.e+1,3)},s.greaterThan=s.gt=function(u){return this.cmp(u)>0},s.greaterThanOrEqualTo=s.gte=function(u){var N=this.cmp(u);return N==1||N===0},s.hyperbolicCosine=s.cosh=function(){var u,N,A,C,R,n=this,i=n.constructor,l=new i(1);if(!n.isFinite())return new i(n.s?1/0:NaN);if(n.isZero())return l;A=i.precision,C=i.rounding,i.precision=A+Math.max(n.e,n.sd())+4,i.rounding=1,R=n.d.length,R<32?(u=Math.ceil(R/3),N=(1/ke(4,u)).toString()):(u=16,N="2.3283064365386962890625e-10"),n=Xe(i,1,n.times(N),new i(1),!0);for(var v,d=u,T=new i(8);d--;)v=n.times(n),n=l.minus(v.times(T.minus(v.times(T))));return q(n,i.precision=A,i.rounding=C,!0)},s.hyperbolicSine=s.sinh=function(){var u,N,A,C,R=this,n=R.constructor;if(!R.isFinite()||R.isZero())return new n(R);if(N=n.precision,A=n.rounding,n.precision=N+Math.max(R.e,R.sd())+4,n.rounding=1,C=R.d.length,C<3)R=Xe(n,2,R,R,!0);else{u=1.4*Math.sqrt(C),u=u>16?16:u|0,R=R.times(1/ke(5,u)),R=Xe(n,2,R,R,!0);for(var i,l=new n(5),v=new n(16),d=new n(20);u--;)i=R.times(R),R=R.times(l.plus(i.times(v.times(i).plus(d))))}return n.precision=N,n.rounding=A,q(R,N,A,!0)},s.hyperbolicTangent=s.tanh=function(){var u,N,A=this,C=A.constructor;return A.isFinite()?A.isZero()?new C(A):(u=C.precision,N=C.rounding,C.precision=u+7,C.rounding=1,M(A.sinh(),A.cosh(),C.precision=u,C.rounding=N)):new C(A.s)},s.inverseCosine=s.acos=function(){var u=this,N=u.constructor,A=u.abs().cmp(1),C=N.precision,R=N.rounding;return A!==-1?A===0?u.isNeg()?K(N,C,R):new N(0):new N(NaN):u.isZero()?K(N,C+4,R).times(.5):(N.precision=C+6,N.rounding=1,u=new N(1).minus(u).div(u.plus(1)).sqrt().atan(),N.precision=C,N.rounding=R,u.times(2))},s.inverseHyperbolicCosine=s.acosh=function(){var u,N,A=this,C=A.constructor;return A.lte(1)?new C(A.eq(1)?0:NaN):A.isFinite()?(u=C.precision,N=C.rounding,C.precision=u+Math.max(Math.abs(A.e),A.sd())+4,C.rounding=1,Y=!1,A=A.times(A).minus(1).sqrt().plus(A),Y=!0,C.precision=u,C.rounding=N,A.ln()):new C(A)},s.inverseHyperbolicSine=s.asinh=function(){var u,N,A=this,C=A.constructor;return!A.isFinite()||A.isZero()?new C(A):(u=C.precision,N=C.rounding,C.precision=u+2*Math.max(Math.abs(A.e),A.sd())+6,C.rounding=1,Y=!1,A=A.times(A).plus(1).sqrt().plus(A),Y=!0,C.precision=u,C.rounding=N,A.ln())},s.inverseHyperbolicTangent=s.atanh=function(){var u,N,A,C,R=this,n=R.constructor;return R.isFinite()?R.e>=0?new n(R.abs().eq(1)?R.s/0:R.isZero()?R:NaN):(u=n.precision,N=n.rounding,C=R.sd(),Math.max(C,u)<2*-R.e-1?q(new n(R),u,N,!0):(n.precision=A=C-R.e,R=M(R.plus(1),new n(1).minus(R),A+u,1),n.precision=u+4,n.rounding=1,R=R.ln(),n.precision=u,n.rounding=N,R.times(.5))):new n(NaN)},s.inverseSine=s.asin=function(){var u,N,A,C,R=this,n=R.constructor;return R.isZero()?new n(R):(N=R.abs().cmp(1),A=n.precision,C=n.rounding,N!==-1?N===0?(u=K(n,A+4,C).times(.5),u.s=R.s,u):new n(NaN):(n.precision=A+6,n.rounding=1,R=R.div(new n(1).minus(R.times(R)).sqrt().plus(1)).atan(),n.precision=A,n.rounding=C,R.times(2)))},s.inverseTangent=s.atan=function(){var u,N,A,C,R,n,i,l,v,d=this,T=d.constructor,E=T.precision,I=T.rounding;if(d.isFinite()){if(d.isZero())return new T(d);if(d.abs().eq(1)&&E+4<=he)return i=K(T,E+4,I).times(.25),i.s=d.s,i}else{if(!d.s)return new T(NaN);if(E+4<=he)return i=K(T,E+4,I).times(.5),i.s=d.s,i}for(T.precision=l=E+10,T.rounding=1,A=Math.min(28,l/me+2|0),u=A;u;--u)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(Y=!1,N=Math.ceil(l/me),C=1,v=d.times(d),i=new T(d),R=d;u!==-1;)if(R=R.times(v),n=i.minus(R.div(C+=2)),R=R.times(v),i=n.plus(R.div(C+=2)),i.d[N]!==void 0)for(u=N;i.d[u]===n.d[u]&&u--;);return A&&(i=i.times(2<<A-1)),Y=!0,q(i,T.precision=E,T.rounding=I,!0)},s.isFinite=function(){return!!this.d},s.isInteger=s.isInt=function(){return!!this.d&&fe(this.e/me)>this.d.length-2},s.isNaN=function(){return!this.s},s.isNegative=s.isNeg=function(){return this.s<0},s.isPositive=s.isPos=function(){return this.s>0},s.isZero=function(){return!!this.d&&this.d[0]===0},s.lessThan=s.lt=function(u){return this.cmp(u)<0},s.lessThanOrEqualTo=s.lte=function(u){return this.cmp(u)<1},s.logarithm=s.log=function(u){var N,A,C,R,n,i,l,v,d=this,T=d.constructor,E=T.precision,I=T.rounding,H=5;if(u==null)u=new T(10),N=!0;else{if(u=new T(u),A=u.d,u.s<0||!A||!A[0]||u.eq(1))return new T(NaN);N=u.eq(10)}if(A=d.d,d.s<0||!A||!A[0]||d.eq(1))return new T(A&&!A[0]?-1/0:d.s!=1?NaN:A?0:1/0);if(N)if(A.length>1)n=!0;else{for(R=A[0];R%10===0;)R/=10;n=R!==1}if(Y=!1,l=E+H,i=Je(d,l),C=N?Q(T,l+10):Je(u,l),v=M(i,C,l,1),_(v.d,R=E,I))do if(l+=10,i=Je(d,l),C=N?Q(T,l+10):Je(u,l),v=M(i,C,l,1),!n){+f(v.d).slice(R+1,R+15)+1==1e14&&(v=q(v,E+1,0));break}while(_(v.d,R+=10,I));return Y=!0,q(v,E,I)},s.minus=s.sub=function(u){var N,A,C,R,n,i,l,v,d,T,E,I,H=this,oe=H.constructor;if(u=new oe(u),!H.d||!u.d)return!H.s||!u.s?u=new oe(NaN):H.d?u.s=-u.s:u=new oe(u.d||H.s!==u.s?H:NaN),u;if(H.s!=u.s)return u.s=-u.s,H.plus(u);if(d=H.d,I=u.d,l=oe.precision,v=oe.rounding,!d[0]||!I[0]){if(I[0])u.s=-u.s;else if(d[0])u=new oe(H);else return new oe(v===3?-0:0);return Y?q(u,l,v):u}if(A=fe(u.e/me),T=fe(H.e/me),d=d.slice(),n=T-A,n){for(E=n<0,E?(N=d,n=-n,i=I.length):(N=I,A=T,i=d.length),C=Math.max(Math.ceil(l/me),i)+2,n>C&&(n=C,N.length=1),N.reverse(),C=n;C--;)N.push(0);N.reverse()}else{for(C=d.length,i=I.length,E=C<i,E&&(i=C),C=0;C<i;C++)if(d[C]!=I[C]){E=d[C]<I[C];break}n=0}for(E&&(N=d,d=I,I=N,u.s=-u.s),i=d.length,C=I.length-i;C>0;--C)d[i++]=0;for(C=I.length;C>n;){if(d[--C]<I[C]){for(R=C;R&&d[--R]===0;)d[R]=xe-1;--d[R],d[C]+=xe}d[C]-=I[C]}for(;d[--i]===0;)d.pop();for(;d[0]===0;d.shift())--A;return d[0]?(u.d=d,u.e=$(d,A),Y?q(u,l,v):u):new oe(v===3?-0:0)},s.modulo=s.mod=function(u){var N,A=this,C=A.constructor;return u=new C(u),!A.d||!u.s||u.d&&!u.d[0]?new C(NaN):!u.d||A.d&&!A.d[0]?q(new C(A),C.precision,C.rounding):(Y=!1,C.modulo==9?(N=M(A,u.abs(),0,3,1),N.s*=u.s):N=M(A,u,0,C.modulo,1),N=N.times(u),Y=!0,A.minus(N))},s.naturalExponential=s.exp=function(){return De(this)},s.naturalLogarithm=s.ln=function(){return Je(this)},s.negated=s.neg=function(){var u=new this.constructor(this);return u.s=-u.s,q(u)},s.plus=s.add=function(u){var N,A,C,R,n,i,l,v,d,T,E=this,I=E.constructor;if(u=new I(u),!E.d||!u.d)return!E.s||!u.s?u=new I(NaN):E.d||(u=new I(u.d||E.s===u.s?E:NaN)),u;if(E.s!=u.s)return u.s=-u.s,E.minus(u);if(d=E.d,T=u.d,l=I.precision,v=I.rounding,!d[0]||!T[0])return T[0]||(u=new I(E)),Y?q(u,l,v):u;if(n=fe(E.e/me),C=fe(u.e/me),d=d.slice(),R=n-C,R){for(R<0?(A=d,R=-R,i=T.length):(A=T,C=n,i=d.length),n=Math.ceil(l/me),i=n>i?n+1:i+1,R>i&&(R=i,A.length=1),A.reverse();R--;)A.push(0);A.reverse()}for(i=d.length,R=T.length,i-R<0&&(R=i,A=T,T=d,d=A),N=0;R;)N=(d[--R]=d[R]+T[R]+N)/xe|0,d[R]%=xe;for(N&&(d.unshift(N),++C),i=d.length;d[--i]==0;)d.pop();return u.d=d,u.e=$(d,C),Y?q(u,l,v):u},s.precision=s.sd=function(u){var N,A=this;if(u!==void 0&&u!==!!u&&u!==1&&u!==0)throw Error(Ee+u);return A.d?(N=ne(A.d),u&&A.e+1>N&&(N=A.e+1)):N=NaN,N},s.round=function(){var u=this,N=u.constructor;return q(new N(u),u.e+1,N.rounding)},s.sine=s.sin=function(){var u,N,A=this,C=A.constructor;return A.isFinite()?A.isZero()?new C(A):(u=C.precision,N=C.rounding,C.precision=u+Math.max(A.e,A.sd())+me,C.rounding=1,A=$e(C,z(C,A)),C.precision=u,C.rounding=N,q(V>2?A.neg():A,u,N,!0)):new C(NaN)},s.squareRoot=s.sqrt=function(){var u,N,A,C,R,n,i=this,l=i.d,v=i.e,d=i.s,T=i.constructor;if(d!==1||!l||!l[0])return new T(!d||d<0&&(!l||l[0])?NaN:l?i:1/0);for(Y=!1,d=Math.sqrt(+i),d==0||d==1/0?(N=f(l),(N.length+v)%2==0&&(N+="0"),d=Math.sqrt(N),v=fe((v+1)/2)-(v<0||v%2),d==1/0?N="5e"+v:(N=d.toExponential(),N=N.slice(0,N.indexOf("e")+1)+v),C=new T(N)):C=new T(d.toString()),A=(v=T.precision)+3;;)if(n=C,C=n.plus(M(i,n,A+2,1)).times(.5),f(n.d).slice(0,A)===(N=f(C.d)).slice(0,A))if(N=N.slice(A-3,A+1),N=="9999"||!R&&N=="4999"){if(!R&&(q(n,v+1,0),n.times(n).eq(i))){C=n;break}A+=4,R=1}else{(!+N||!+N.slice(1)&&N.charAt(0)=="5")&&(q(C,v+1,1),u=!C.times(C).eq(i));break}return Y=!0,q(C,v,T.rounding,u)},s.tangent=s.tan=function(){var u,N,A=this,C=A.constructor;return A.isFinite()?A.isZero()?new C(A):(u=C.precision,N=C.rounding,C.precision=u+10,C.rounding=1,A=A.sin(),A.s=1,A=M(A,new C(1).minus(A.times(A)).sqrt(),u+10,0),C.precision=u,C.rounding=N,q(V==2||V==4?A.neg():A,u,N,!0)):new C(NaN)},s.times=s.mul=function(u){var N,A,C,R,n,i,l,v,d,T=this,E=T.constructor,I=T.d,H=(u=new E(u)).d;if(u.s*=T.s,!I||!I[0]||!H||!H[0])return new E(!u.s||I&&!I[0]&&!H||H&&!H[0]&&!I?NaN:!I||!H?u.s/0:u.s*0);for(A=fe(T.e/me)+fe(u.e/me),v=I.length,d=H.length,v<d&&(n=I,I=H,H=n,i=v,v=d,d=i),n=[],i=v+d,C=i;C--;)n.push(0);for(C=d;--C>=0;){for(N=0,R=v+C;R>C;)l=n[R]+H[C]*I[R-C-1]+N,n[R--]=l%xe|0,N=l/xe|0;n[R]=(n[R]+N)%xe|0}for(;!n[--i];)n.pop();return N?++A:n.shift(),u.d=n,u.e=$(n,A),Y?q(u,E.precision,E.rounding):u},s.toBinary=function(u,N){return j(this,2,u,N)},s.toDecimalPlaces=s.toDP=function(u,N){var A=this,C=A.constructor;return A=new C(A),u===void 0?A:(S(u,0,e),N===void 0?N=C.rounding:S(N,0,8),q(A,u+A.e+1,N))},s.toExponential=function(u,N){var A,C=this,R=C.constructor;return u===void 0?A=F(C,!0):(S(u,0,e),N===void 0?N=R.rounding:S(N,0,8),C=q(new R(C),u+1,N),A=F(C,!0,u+1)),C.isNeg()&&!C.isZero()?"-"+A:A},s.toFixed=function(u,N){var A,C,R=this,n=R.constructor;return u===void 0?A=F(R):(S(u,0,e),N===void 0?N=n.rounding:S(N,0,8),C=q(new n(R),u+R.e+1,N),A=F(C,!1,u+C.e+1)),R.isNeg()&&!R.isZero()?"-"+A:A},s.toFraction=function(u){var N,A,C,R,n,i,l,v,d,T,E,I,H=this,oe=H.d,ue=H.constructor;if(!oe)return new ue(H);if(d=A=new ue(1),C=v=new ue(0),N=new ue(C),n=N.e=ne(oe)-H.e-1,i=n%me,N.d[0]=a(10,i<0?me+i:i),u==null)u=n>0?N:d;else{if(l=new ue(u),!l.isInt()||l.lt(d))throw Error(Ee+l);u=l.gt(N)?n>0?N:d:l}for(Y=!1,l=new ue(f(oe)),T=ue.precision,ue.precision=n=oe.length*me*2;E=M(l,N,0,1,1),R=A.plus(E.times(C)),R.cmp(u)!=1;)A=C,C=R,R=d,d=v.plus(E.times(R)),v=R,R=N,N=l.minus(E.times(R)),l=R;return R=M(u.minus(A),C,0,1,1),v=v.plus(R.times(d)),A=A.plus(R.times(C)),v.s=d.s=H.s,I=M(d,C,n,1).minus(H).abs().cmp(M(v,A,n,1).minus(H).abs())<1?[d,C]:[v,A],ue.precision=T,Y=!0,I},s.toHexadecimal=s.toHex=function(u,N){return j(this,16,u,N)},s.toNearest=function(u,N){var A=this,C=A.constructor;if(A=new C(A),u==null){if(!A.d)return A;u=new C(1),N=C.rounding}else{if(u=new C(u),N===void 0?N=C.rounding:S(N,0,8),!A.d)return u.s?A:u;if(!u.d)return u.s&&(u.s=A.s),u}return u.d[0]?(Y=!1,A=M(A,u,0,N,1).times(u),Y=!0,q(A)):(u.s=A.s,A=u),A},s.toNumber=function(){return+this},s.toOctal=function(u,N){return j(this,8,u,N)},s.toPower=s.pow=function(u){var N,A,C,R,n,i,l=this,v=l.constructor,d=+(u=new v(u));if(!l.d||!u.d||!l.d[0]||!u.d[0])return new v(a(+l,d));if(l=new v(l),l.eq(1))return l;if(C=v.precision,n=v.rounding,u.eq(1))return q(l,C,n);if(N=fe(u.e/me),N>=u.d.length-1&&(A=d<0?-d:d)<=_e)return R=Se(v,l,A,C),u.s<0?new v(1).div(R):q(R,C,n);if(i=l.s,i<0){if(N<u.d.length-1)return new v(NaN);if((u.d[N]&1)==0&&(i=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=i,l}return A=a(+l,d),N=A==0||!isFinite(A)?fe(d*(Math.log("0."+f(l.d))/Math.LN10+l.e+1)):new v(A+"").e,N>v.maxE+1||N<v.minE-1?new v(N>0?i/0:0):(Y=!1,v.rounding=l.s=1,A=Math.min(12,(N+"").length),R=De(u.times(Je(l,C+A)),C),R.d&&(R=q(R,C+5,1),_(R.d,C,n)&&(N=C+10,R=q(De(u.times(Je(l,N+A)),N),N+5,1),+f(R.d).slice(C+1,C+15)+1==1e14&&(R=q(R,C+1,0)))),R.s=i,Y=!0,v.rounding=n,q(R,C,n))},s.toPrecision=function(u,N){var A,C=this,R=C.constructor;return u===void 0?A=F(C,C.e<=R.toExpNeg||C.e>=R.toExpPos):(S(u,1,e),N===void 0?N=R.rounding:S(N,0,8),C=q(new R(C),u,N),A=F(C,u<=C.e||C.e<=R.toExpNeg,u)),C.isNeg()&&!C.isZero()?"-"+A:A},s.toSignificantDigits=s.toSD=function(u,N){var A=this,C=A.constructor;return u===void 0?(u=C.precision,N=C.rounding):(S(u,1,e),N===void 0?N=C.rounding:S(N,0,8)),q(new C(A),u,N)},s.toString=function(){var u=this,N=u.constructor,A=F(u,u.e<=N.toExpNeg||u.e>=N.toExpPos);return u.isNeg()&&!u.isZero()?"-"+A:A},s.truncated=s.trunc=function(){return q(new this.constructor(this),this.e+1,1)},s.valueOf=s.toJSON=function(){var u=this,N=u.constructor,A=F(u,u.e<=N.toExpNeg||u.e>=N.toExpPos);return u.isNeg()?"-"+A:A};function f(u){var N,A,C,R=u.length-1,n="",i=u[0];if(R>0){for(n+=i,N=1;N<R;N++)C=u[N]+"",A=me-C.length,A&&(n+=pe(A)),n+=C;i=u[N],C=i+"",A=me-C.length,A&&(n+=pe(A))}else if(i===0)return"0";for(;i%10===0;)i/=10;return n+i}function S(u,N,A){if(u!==~~u||u<N||u>A)throw Error(Ee+u)}function _(u,N,A,C){var R,n,i,l;for(n=u[0];n>=10;n/=10)--N;return--N<0?(N+=me,R=0):(R=Math.ceil((N+1)/me),N%=me),n=a(10,me-N),l=u[R]%n|0,C==null?N<3?(N==0?l=l/100|0:N==1&&(l=l/10|0),i=A<4&&l==99999||A>3&&l==49999||l==5e4||l==0):i=(A<4&&l+1==n||A>3&&l+1==n/2)&&(u[R+1]/n/100|0)==a(10,N-2)-1||(l==n/2||l==0)&&(u[R+1]/n/100|0)==0:N<4?(N==0?l=l/1e3|0:N==1?l=l/100|0:N==2&&(l=l/10|0),i=(C||A<4)&&l==9999||!C&&A>3&&l==4999):i=((C||A<4)&&l+1==n||!C&&A>3&&l+1==n/2)&&(u[R+1]/n/1e3|0)==a(10,N-3)-1,i}function c(u,N,A){for(var C,R=[0],n,i=0,l=u.length;i<l;){for(n=R.length;n--;)R[n]*=N;for(R[0]+=o.indexOf(u.charAt(i++)),C=0;C<R.length;C++)R[C]>A-1&&(R[C+1]===void 0&&(R[C+1]=0),R[C+1]+=R[C]/A|0,R[C]%=A)}return R.reverse()}function m(u,N){var A,C,R;if(N.isZero())return N;C=N.d.length,C<32?(A=Math.ceil(C/3),R=(1/ke(4,A)).toString()):(A=16,R="2.3283064365386962890625e-10"),u.precision+=A,N=Xe(u,1,N.times(R),new u(1));for(var n=A;n--;){var i=N.times(N);N=i.times(i).minus(i).times(8).plus(1)}return u.precision-=A,N}var M=(function(){function u(C,R,n){var i,l=0,v=C.length;for(C=C.slice();v--;)i=C[v]*R+l,C[v]=i%n|0,l=i/n|0;return l&&C.unshift(l),C}function N(C,R,n,i){var l,v;if(n!=i)v=n>i?1:-1;else for(l=v=0;l<n;l++)if(C[l]!=R[l]){v=C[l]>R[l]?1:-1;break}return v}function A(C,R,n,i){for(var l=0;n--;)C[n]-=l,l=C[n]<R[n]?1:0,C[n]=l*i+C[n]-R[n];for(;!C[0]&&C.length>1;)C.shift()}return function(C,R,n,i,l,v){var d,T,E,I,H,oe,ue,Oe,Pe,Ce,Ge,st,Ct,Qe,Re,Ke,Ze,Ye,at,dt,ht=C.constructor,tt=C.s==R.s?1:-1,nt=C.d,it=R.d;if(!nt||!nt[0]||!it||!it[0])return new ht(!C.s||!R.s||(nt?it&&nt[0]==it[0]:!it)?NaN:nt&&nt[0]==0||!it?tt*0:tt/0);for(v?(H=1,T=C.e-R.e):(v=xe,H=me,T=fe(C.e/H)-fe(R.e/H)),at=it.length,Ze=nt.length,Pe=new ht(tt),Ce=Pe.d=[],E=0;it[E]==(nt[E]||0);E++);if(it[E]>(nt[E]||0)&&T--,n==null?(Qe=n=ht.precision,i=ht.rounding):l?Qe=n+(C.e-R.e)+1:Qe=n,Qe<0)Ce.push(1),oe=!0;else{if(Qe=Qe/H+2|0,E=0,at==1){for(I=0,it=it[0],Qe++;(E<Ze||I)&&Qe--;E++)Re=I*v+(nt[E]||0),Ce[E]=Re/it|0,I=Re%it|0;oe=I||E<Ze}else{for(I=v/(it[0]+1)|0,I>1&&(it=u(it,I,v),nt=u(nt,I,v),at=it.length,Ze=nt.length),Ke=at,Ge=nt.slice(0,at),st=Ge.length;st<at;)Ge[st++]=0;dt=it.slice(),dt.unshift(0),Ye=it[0],it[1]>=v/2&&++Ye;do I=0,d=N(it,Ge,at,st),d<0?(Ct=Ge[0],at!=st&&(Ct=Ct*v+(Ge[1]||0)),I=Ct/Ye|0,I>1?(I>=v&&(I=v-1),ue=u(it,I,v),Oe=ue.length,st=Ge.length,d=N(ue,Ge,Oe,st),d==1&&(I--,A(ue,at<Oe?dt:it,Oe,v))):(I==0&&(d=I=1),ue=it.slice()),Oe=ue.length,Oe<st&&ue.unshift(0),A(Ge,ue,st,v),d==-1&&(st=Ge.length,d=N(it,Ge,at,st),d<1&&(I++,A(Ge,at<st?dt:it,st,v))),st=Ge.length):d===0&&(I++,Ge=[0]),Ce[E++]=I,d&&Ge[0]?Ge[st++]=nt[Ke]||0:(Ge=[nt[Ke]],st=1);while((Ke++<Ze||Ge[0]!==void 0)&&Qe--);oe=Ge[0]!==void 0}Ce[0]||Ce.shift()}if(H==1)Pe.e=T,k=oe;else{for(E=1,I=Ce[0];I>=10;I/=10)E++;Pe.e=E+T*H-1,q(Pe,l?n+Pe.e+1:n,i,oe)}return Pe}})();function q(u,N,A,C){var R,n,i,l,v,d,T,E,I,H=u.constructor;e:if(N!=null){if(E=u.d,!E)return u;for(R=1,l=E[0];l>=10;l/=10)R++;if(n=N-R,n<0)n+=me,i=N,T=E[I=0],v=T/a(10,R-i-1)%10|0;else if(I=Math.ceil((n+1)/me),l=E.length,I>=l)if(C){for(;l++<=I;)E.push(0);T=v=0,R=1,n%=me,i=n-me+1}else break e;else{for(T=l=E[I],R=1;l>=10;l/=10)R++;n%=me,i=n-me+R,v=i<0?0:T/a(10,R-i-1)%10|0}if(C=C||N<0||E[I+1]!==void 0||(i<0?T:T%a(10,R-i-1)),d=A<4?(v||C)&&(A==0||A==(u.s<0?3:2)):v>5||v==5&&(A==4||C||A==6&&(n>0?i>0?T/a(10,R-i):0:E[I-1])%10&1||A==(u.s<0?8:7)),N<1||!E[0])return E.length=0,d?(N-=u.e+1,E[0]=a(10,(me-N%me)%me),u.e=-N||0):E[0]=u.e=0,u;if(n==0?(E.length=I,l=1,I--):(E.length=I+1,l=a(10,me-n),E[I]=i>0?(T/a(10,R-i)%a(10,i)|0)*l:0),d)for(;;)if(I==0){for(n=1,i=E[0];i>=10;i/=10)n++;for(i=E[0]+=l,l=1;i>=10;i/=10)l++;n!=l&&(u.e++,E[0]==xe&&(E[0]=1));break}else{if(E[I]+=l,E[I]!=xe)break;E[I--]=0,l=1}for(n=E.length;E[--n]===0;)E.pop()}return Y&&(u.e>H.maxE?(u.d=null,u.e=NaN):u.e<H.minE&&(u.e=0,u.d=[0])),u}function F(u,N,A){if(!u.isFinite())return rt(u);var C,R=u.e,n=f(u.d),i=n.length;return N?(A&&(C=A-i)>0?n=n.charAt(0)+"."+n.slice(1)+pe(C):i>1&&(n=n.charAt(0)+"."+n.slice(1)),n=n+(u.e<0?"e":"e+")+u.e):R<0?(n="0."+pe(-R-1)+n,A&&(C=A-i)>0&&(n+=pe(C))):R>=i?(n+=pe(R+1-i),A&&(C=A-R-1)>0&&(n=n+"."+pe(C))):((C=R+1)<i&&(n=n.slice(0,C)+"."+n.slice(C)),A&&(C=A-i)>0&&(R+1===i&&(n+="."),n+=pe(C))),n}function $(u,N){var A=u[0];for(N*=me;A>=10;A/=10)N++;return N}function Q(u,N,A){if(N>ye)throw Y=!0,A&&(u.precision=A),Error(Me);return q(new u(h),N,1,!0)}function K(u,N,A){if(N>he)throw Error(Me);return q(new u(y),N,A,!0)}function ne(u){var N=u.length-1,A=N*me+1;if(N=u[N],N){for(;N%10==0;N/=10)A--;for(N=u[0];N>=10;N/=10)A++}return A}function pe(u){for(var N="";u--;)N+="0";return N}function Se(u,N,A,C){var R,n=new u(1),i=Math.ceil(C/me+4);for(Y=!1;;){if(A%2&&(n=n.times(N),X(n.d,i)&&(R=!0)),A=fe(A/2),A===0){A=n.d.length-1,R&&n.d[A]===0&&++n.d[A];break}N=N.times(N),X(N.d,i)}return Y=!0,n}function ve(u){return u.d[u.d.length-1]&1}function Ue(u,N,A){for(var C,R,n=new u(N[0]),i=0;++i<N.length;){if(R=new u(N[i]),!R.s){n=R;break}C=n.cmp(R),(C===A||C===0&&n.s===A)&&(n=R)}return n}function De(u,N){var A,C,R,n,i,l,v,d=0,T=0,E=0,I=u.constructor,H=I.rounding,oe=I.precision;if(!u.d||!u.d[0]||u.e>17)return new I(u.d?u.d[0]?u.s<0?0:1/0:1:u.s?u.s<0?0:u:NaN);for(N==null?(Y=!1,v=oe):v=N,l=new I(.03125);u.e>-2;)u=u.times(l),E+=5;for(C=Math.log(a(2,E))/Math.LN10*2+5|0,v+=C,A=n=i=new I(1),I.precision=v;;){if(n=q(n.times(u),v,1),A=A.times(++T),l=i.plus(M(n,A,v,1)),f(l.d).slice(0,v)===f(i.d).slice(0,v)){for(R=E;R--;)i=q(i.times(i),v,1);if(N==null)if(d<3&&_(i.d,v-C,H,d))I.precision=v+=10,A=n=l=new I(1),T=0,d++;else return q(i,I.precision=oe,H,Y=!0);else return I.precision=oe,i}i=l}}function Je(u,N){var A,C,R,n,i,l,v,d,T,E,I,H=1,oe=10,ue=u,Oe=ue.d,Pe=ue.constructor,Ce=Pe.rounding,Ge=Pe.precision;if(ue.s<0||!Oe||!Oe[0]||!ue.e&&Oe[0]==1&&Oe.length==1)return new Pe(Oe&&!Oe[0]?-1/0:ue.s!=1?NaN:Oe?0:ue);if(N==null?(Y=!1,T=Ge):T=N,Pe.precision=T+=oe,A=f(Oe),C=A.charAt(0),Math.abs(n=ue.e)<15e14){for(;C<7&&C!=1||C==1&&A.charAt(1)>3;)ue=ue.times(u),A=f(ue.d),C=A.charAt(0),H++;n=ue.e,C>1?(ue=new Pe("0."+A),n++):ue=new Pe(C+"."+A.slice(1))}else return d=Q(Pe,T+2,Ge).times(n+""),ue=Je(new Pe(C+"."+A.slice(1)),T-oe).plus(d),Pe.precision=Ge,N==null?q(ue,Ge,Ce,Y=!0):ue;for(E=ue,v=i=ue=M(ue.minus(1),ue.plus(1),T,1),I=q(ue.times(ue),T,1),R=3;;){if(i=q(i.times(I),T,1),d=v.plus(M(i,new Pe(R),T,1)),f(d.d).slice(0,T)===f(v.d).slice(0,T))if(v=v.times(2),n!==0&&(v=v.plus(Q(Pe,T+2,Ge).times(n+""))),v=M(v,new Pe(H),T,1),N==null)if(_(v.d,T-oe,Ce,l))Pe.precision=T+=oe,d=i=ue=M(E.minus(1),E.plus(1),T,1),I=q(ue.times(ue),T,1),R=l=1;else return q(v,Pe.precision=Ge,Ce,Y=!0);else return Pe.precision=Ge,v;v=d,R+=2}}function rt(u){return String(u.s*u.s/0)}function qe(u,N){var A,C,R;for((A=N.indexOf("."))>-1&&(N=N.replace(".","")),(C=N.search(/e/i))>0?(A<0&&(A=C),A+=+N.slice(C+1),N=N.substring(0,C)):A<0&&(A=N.length),C=0;N.charCodeAt(C)===48;C++);for(R=N.length;N.charCodeAt(R-1)===48;--R);if(N=N.slice(C,R),N){if(R-=C,u.e=A=A-C-1,u.d=[],C=(A+1)%me,A<0&&(C+=me),C<R){for(C&&u.d.push(+N.slice(0,C)),R-=me;C<R;)u.d.push(+N.slice(C,C+=me));N=N.slice(C),C=me-N.length}else C-=R;for(;C--;)N+="0";u.d.push(+N),Y&&(u.e>u.constructor.maxE?(u.d=null,u.e=NaN):u.e<u.constructor.minE&&(u.e=0,u.d=[0]))}else u.e=0,u.d=[0];return u}function Fe(u,N){var A,C,R,n,i,l,v,d,T;if(N.indexOf("_")>-1){if(N=N.replace(/(\d)_(?=\d)/g,"$1"),Ae.test(N))return qe(u,N)}else if(N==="Infinity"||N==="NaN")return+N||(u.s=NaN),u.e=NaN,u.d=null,u;if(be.test(N))A=16,N=N.toLowerCase();else if(Ne.test(N))A=2;else if(Le.test(N))A=8;else throw Error(Ee+N);for(n=N.search(/p/i),n>0?(v=+N.slice(n+1),N=N.substring(2,n)):N=N.slice(2),n=N.indexOf("."),i=n>=0,C=u.constructor,i&&(N=N.replace(".",""),l=N.length,n=l-n,R=Se(C,new C(A),n,n*2)),d=c(N,A,xe),T=d.length-1,n=T;d[n]===0;--n)d.pop();return n<0?new C(u.s*0):(u.e=$(d,T),u.d=d,Y=!1,i&&(u=M(u,R,l*4)),v&&(u=u.times(Math.abs(v)<54?a(2,v):b.pow(2,v))),Y=!0,u)}function $e(u,N){var A,C=N.d.length;if(C<3)return N.isZero()?N:Xe(u,2,N,N);A=1.4*Math.sqrt(C),A=A>16?16:A|0,N=N.times(1/ke(5,A)),N=Xe(u,2,N,N);for(var R,n=new u(5),i=new u(16),l=new u(20);A--;)R=N.times(N),N=N.times(n.plus(R.times(i.times(R).minus(l))));return N}function Xe(u,N,A,C,R){var n,i,l,v,d=1,T=u.precision,E=Math.ceil(T/me);for(Y=!1,v=A.times(A),l=new u(C);;){if(i=M(l.times(v),new u(N++*N++),T,1),l=R?C.plus(i):C.minus(i),C=M(i.times(v),new u(N++*N++),T,1),i=l.plus(C),i.d[E]!==void 0){for(n=E;i.d[n]===l.d[n]&&n--;);if(n==-1)break}n=l,l=C,C=i,i=n,d++}return Y=!0,i.d.length=E+1,i}function ke(u,N){for(var A=u;--N;)A*=u;return A}function z(u,N){var A,C=N.s<0,R=K(u,u.precision,1),n=R.times(.5);if(N=N.abs(),N.lte(n))return V=C?4:1,N;if(A=N.divToInt(R),A.isZero())V=C?3:2;else{if(N=N.minus(A.times(R)),N.lte(n))return V=ve(A)?C?2:3:C?4:1,N;V=ve(A)?C?1:4:C?3:2}return N.minus(R).abs()}function j(u,N,A,C){var R,n,i,l,v,d,T,E,I,H=u.constructor,oe=A!==void 0;if(oe?(S(A,1,e),C===void 0?C=H.rounding:S(C,0,8)):(A=H.precision,C=H.rounding),!u.isFinite())T=rt(u);else{for(T=F(u),i=T.indexOf("."),oe?(R=2,N==16?A=A*4-3:N==8&&(A=A*3-2)):R=N,i>=0&&(T=T.replace(".",""),I=new H(1),I.e=T.length-i,I.d=c(F(I),10,R),I.e=I.d.length),E=c(T,10,R),n=v=E.length;E[--v]==0;)E.pop();if(!E[0])T=oe?"0p+0":"0";else{if(i<0?n--:(u=new H(u),u.d=E,u.e=n,u=M(u,I,A,C,0,R),E=u.d,n=u.e,d=k),i=E[A],l=R/2,d=d||E[A+1]!==void 0,d=C<4?(i!==void 0||d)&&(C===0||C===(u.s<0?3:2)):i>l||i===l&&(C===4||d||C===6&&E[A-1]&1||C===(u.s<0?8:7)),E.length=A,d)for(;++E[--A]>R-1;)E[A]=0,A||(++n,E.unshift(1));for(v=E.length;!E[v-1];--v);for(i=0,T="";i<v;i++)T+=o.charAt(E[i]);if(oe){if(v>1)if(N==16||N==8){for(i=N==16?4:3,--v;v%i;v++)T+="0";for(E=c(T,R,N),v=E.length;!E[v-1];--v);for(i=1,T="1.";i<v;i++)T+=o.charAt(E[i])}else T=T.charAt(0)+"."+T.slice(1);T=T+(n<0?"p":"p+")+n}else if(n<0){for(;++n;)T="0"+T;T="0."+T}else if(++n>v)for(n-=v;n--;)T+="0";else n<v&&(T=T.slice(0,n)+"."+T.slice(n))}T=(N==16?"0x":N==2?"0b":N==8?"0o":"")+T}return u.s<0?"-"+T:T}function X(u,N){if(u.length>N)return u.length=N,!0}function D(u){return new this(u).abs()}function ee(u){return new this(u).acos()}function O(u){return new this(u).acosh()}function x(u,N){return new this(u).plus(N)}function g(u){return new this(u).asin()}function p(u){return new this(u).asinh()}function P(u){return new this(u).atan()}function w(u){return new this(u).atanh()}function U(u,N){u=new this(u),N=new this(N);var A,C=this.precision,R=this.rounding,n=C+4;return!u.s||!N.s?A=new this(NaN):!u.d&&!N.d?(A=K(this,n,1).times(N.s>0?.25:.75),A.s=u.s):!N.d||u.isZero()?(A=N.s<0?K(this,C,R):new this(0),A.s=u.s):!u.d||N.isZero()?(A=K(this,n,1).times(.5),A.s=u.s):N.s<0?(this.precision=n,this.rounding=1,A=this.atan(M(u,N,n,1)),N=K(this,n,1),this.precision=C,this.rounding=R,A=u.s<0?A.minus(N):A.plus(N)):A=this.atan(M(u,N,n,1)),A}function B(u){return new this(u).cbrt()}function Z(u){return q(u=new this(u),u.e+1,2)}function J(u,N,A){return new this(u).clamp(N,A)}function ie(u){if(!u||typeof u!="object")throw Error(we+"Object expected");var N,A,C,R=u.defaults===!0,n=["precision",1,e,"rounding",0,8,"toExpNeg",-t,0,"toExpPos",0,t,"maxE",0,t,"minE",-t,0,"modulo",0,9];for(N=0;N<n.length;N+=3)if(A=n[N],R&&(this[A]=L[A]),(C=u[A])!==void 0)if(fe(C)===C&&C>=n[N+1]&&C<=n[N+2])this[A]=C;else throw Error(Ee+A+": "+C);if(A="crypto",R&&(this[A]=L[A]),(C=u[A])!==void 0)if(C===!0||C===!1||C===0||C===1)if(C)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[A]=!0;else throw Error(se);else this[A]=!1;else throw Error(Ee+A+": "+C);return this}function le(u){return new this(u).cos()}function te(u){return new this(u).cosh()}function ae(u){var N,A,C;function R(n){var i,l,v,d=this;if(!(d instanceof R))return new R(n);if(d.constructor=R,We(n)){d.s=n.s,Y?!n.d||n.e>R.maxE?(d.e=NaN,d.d=null):n.e<R.minE?(d.e=0,d.d=[0]):(d.e=n.e,d.d=n.d.slice()):(d.e=n.e,d.d=n.d?n.d.slice():n.d);return}if(v=typeof n,v==="number"){if(n===0){d.s=1/n<0?-1:1,d.e=0,d.d=[0];return}if(n<0?(n=-n,d.s=-1):d.s=1,n===~~n&&n<1e7){for(i=0,l=n;l>=10;l/=10)i++;Y?i>R.maxE?(d.e=NaN,d.d=null):i<R.minE?(d.e=0,d.d=[0]):(d.e=i,d.d=[n]):(d.e=i,d.d=[n]);return}if(n*0!==0){n||(d.s=NaN),d.e=NaN,d.d=null;return}return qe(d,n.toString())}if(v==="string")return(l=n.charCodeAt(0))===45?(n=n.slice(1),d.s=-1):(l===43&&(n=n.slice(1)),d.s=1),Ae.test(n)?qe(d,n):Fe(d,n);if(v==="bigint")return n<0?(n=-n,d.s=-1):d.s=1,qe(d,n.toString());throw Error(Ee+n)}if(R.prototype=s,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=ie,R.clone=ae,R.isDecimal=We,R.abs=D,R.acos=ee,R.acosh=O,R.add=x,R.asin=g,R.asinh=p,R.atan=P,R.atanh=w,R.atan2=U,R.cbrt=B,R.ceil=Z,R.clamp=J,R.cos=le,R.cosh=te,R.div=de,R.exp=Be,R.floor=Te,R.hypot=ze,R.ln=je,R.log=et,R.log10=lt,R.log2=He,R.max=ct,R.min=ft,R.mod=At,R.mul=$t,R.pow=Tt,R.random=pt,R.round=Ft,R.sign=_t,R.sin=Ot,R.sinh=Vt,R.sqrt=Jt,R.sub=c0,R.sum=Yt,R.tan=r0,R.tanh=Kt,R.trunc=v0,u===void 0&&(u={}),u&&u.defaults!==!0)for(C=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],N=0;N<C.length;)u.hasOwnProperty(A=C[N++])||(u[A]=this[A]);return R.config(u),R}function de(u,N){return new this(u).div(N)}function Be(u){return new this(u).exp()}function Te(u){return q(u=new this(u),u.e+1,3)}function ze(){var u,N,A=new this(0);for(Y=!1,u=0;u<arguments.length;)if(N=new this(arguments[u++]),N.d)A.d&&(A=A.plus(N.times(N)));else{if(N.s)return Y=!0,new this(1/0);A=N}return Y=!0,A.sqrt()}function We(u){return u instanceof b||u&&u.toStringTag===ge||!1}function je(u){return new this(u).ln()}function et(u,N){return new this(u).log(N)}function He(u){return new this(u).log(2)}function lt(u){return new this(u).log(10)}function ct(){return Ue(this,arguments,-1)}function ft(){return Ue(this,arguments,1)}function At(u,N){return new this(u).mod(N)}function $t(u,N){return new this(u).mul(N)}function Tt(u,N){return new this(u).pow(N)}function pt(u){var N,A,C,R,n=0,i=new this(1),l=[];if(u===void 0?u=this.precision:S(u,1,e),C=Math.ceil(u/me),this.crypto)if(crypto.getRandomValues)for(N=crypto.getRandomValues(new Uint32Array(C));n<C;)R=N[n],R>=429e7?N[n]=crypto.getRandomValues(new Uint32Array(1))[0]:l[n++]=R%1e7;else if(crypto.randomBytes){for(N=crypto.randomBytes(C*=4);n<C;)R=N[n]+(N[n+1]<<8)+(N[n+2]<<16)+((N[n+3]&127)<<24),R>=214e7?crypto.randomBytes(4).copy(N,n):(l.push(R%1e7),n+=4);n=C/4}else throw Error(se);else for(;n<C;)l[n++]=Math.random()*1e7|0;for(C=l[--n],u%=me,C&&u&&(R=a(10,me-u),l[n]=(C/R|0)*R);l[n]===0;n--)l.pop();if(n<0)A=0,l=[0];else{for(A=-1;l[0]===0;A-=me)l.shift();for(C=1,R=l[0];R>=10;R/=10)C++;C<me&&(A-=me-C)}return i.e=A,i.d=l,i}function Ft(u){return q(u=new this(u),u.e+1,this.rounding)}function _t(u){return u=new this(u),u.d?u.d[0]?u.s:0*u.s:u.s||NaN}function Ot(u){return new this(u).sin()}function Vt(u){return new this(u).sinh()}function Jt(u){return new this(u).sqrt()}function c0(u,N){return new this(u).sub(N)}function Yt(){var u=0,N=arguments,A=new this(N[u]);for(Y=!1;A.s&&++u<N.length;)A=A.plus(N[u]);return Y=!0,q(A,this.precision,this.rounding)}function r0(u){return new this(u).tan()}function Kt(u){return new this(u).tanh()}function v0(u){return q(u=new this(u),u.e+1,1)}b=ae(L),b.prototype.constructor=b,b.default=b.Decimal=b,h=new b(h),y=new b(y),typeof define=="function"&&define.amd?define(function(){return b}):typeof j0<"u"&&j0.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(s[Symbol.for("nodejs.util.inspect.custom")]=s.toString,s[Symbol.toStringTag]="Decimal"),j0.exports=b):(r||(r=typeof self<"u"&&self&&self.self==self?self:window),G=r.Decimal,b.noConflict=function(){return r.Decimal=G,b},r.Decimal=b)})(Tn)});var xn=f0((Wi,ln)=>{"use strict";var Ln=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],Un={};for(let r of Ln)Un[r]=!0;var g1="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",m1="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",d1=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof ln<"u"&&(ln.exports={PRIMES:Ln,PRIMES_SET:Un,LONG_PI:g1,LONG_E:m1,BIG_LOG_CACHE:d1})});var T0=f0((Qi,vn)=>{"use strict";var Nn=typeof globalThis.nerdamerBigInt>"u"?qn():globalThis.nerdamerBigInt,rn=typeof globalThis.nerdamerBigDecimal>"u"?Rn():globalThis.nerdamerBigDecimal;rn.set({precision:250});var x0=typeof globalThis.nerdamerConstants>"u"?xn():globalThis.nerdamerConstants,w1={},S1=[],v1={},N1=[],y1=[],E1=[],sn={Settings:null,Math2:null},re={ext:{bigInt:Nn,bigDec:rn,PRIMES:x0.PRIMES,PRIMES_SET:x0.PRIMES_SET,LONG_PI:x0.LONG_PI,LONG_E:x0.LONG_E,BIG_LOG_CACHE:x0.BIG_LOG_CACHE},groups:{N:1,P:2,S:3,EX:4,FN:5,PL:6,CB:7,CP:8},fnNames:{SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",PARENTHESIS:"parens",LOG:"log",CONST_HASH:"#"},get settings(){return sn.Settings},state:{get EXPRESSIONS(){return S1},get VARS(){return v1},CONSTANTS:{},get RESERVED(){return N1},get WARNINGS(){return y1},get USER_FUNCTIONS(){return E1},get CUSTOM_OPERATORS(){return w1}},classes:{Frac:null,Fraction:null,NerdamerSymbol:null,Vector:null,Matrix:null,Expression:null,Collection:null,NerdamerSet:null,Scientific:null,Parser:null,LaTeX:null,Math2:null,Build:null},utils:{get isSymbol(){return gt},get isVector(){return vt},get isMatrix(){return St},get isExpression(){return r1},get isNumericSymbol(){return q0},get isFraction(){return _n},get isArray(){return Dt},get isInt(){return mt},get text(){return Xt},get variables(){return n0},get scientificToDecimal(){return F0},get err(){return Pt},get block(){return Bt},get evaluate(){return Nt},get reserveNames(){return k0},get nround(){return m0},get remove(){return d0},get _setFunction(){return On},get _clearFunctions(){return $i},symfunction:null,callfunction:null},exceptions:null,parser:null,core:null,libExports:null,version:"1.1.16"},M1={N:re.groups.N,P:re.groups.P,S:re.groups.S,EX:re.groups.EX,FN:re.groups.FN,PL:re.groups.PL,CB:re.groups.CB,CP:re.groups.CP};Math.sign||=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1};Math.cosh||=function(t){let e=Math.exp(t);return(e+1/e)/2};Math.sech||=function(t){return 1/Math.cosh(t)};Math.csch||=function(t){return 1/Math.sinh(t)};Math.coth||=function(t){return 1/Math.tanh(t)};Math.sinh||=function(t){let e=Math.exp(t);return(e-1/e)/2};Math.tanh||=function(t){if(t===1/0)return 1;if(t===-1/0)return-1;let e=Math.exp(2*t);return(e-1)/(e+1)};Math.asinh||=function(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))};Math.acosh||=function(t){return Math.log(t+Math.sqrt(t*t-1))};Math.atanh||=function(t){return Math.log((1+t)/(1-t))/2};Math.trunc||=function(t){return isNaN(t)?NaN:t>0?Math.floor(t):Math.ceil(t)};function Vn(r){return/\d+\.?\d*e[+-]*\d+/iu.test(r)}var Xn={convert(r,t){let e=Number(r),o;if(e===0)o=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let h=this.quickConversion(e);if(h[1]<=1e16){let y=Math.abs(e),L=e/y;o=this.fullConversion(y.toFixed(`${h[1]}`.length-1)),o[0]*=L}else o=h}else o=this.fullConversion(e);return o},quickConversion(r){let t=function(o){typeof o!="string"&&(o=o.toString());let h="",y=o.charAt(0);return y==="-"?(o=o.substr(1,o.length),h="-"):y==="+"&&(o=o.substr(1,o.length)),{sign:h,value:o}};function e(o){Vn(o)&&(o=F0(o));let h=t(o),y=h.value.split("."),L;y.length===1?L=y[0]:L=y[0]+y[1];let b=y[1]?y[1].length:0,k=`1${"0".repeat(b)}`;return L!=="0"&&(L=L.replace(/^0+/u,"")),[h.sign+L,k]}return e(r)},fullConversion(r){let t=Number(r),e=Math.abs(t)>1e10?1e-16:1e-30,o=!1,h=0,y=1,L=1,b=0,k=0,G=t,V,Y,we=1e-14;for(;!o;){k++;let Ee;if(Math.abs(G)>1e10){let se=Math.round(G);Ee=Math.abs(G-se)/Math.abs(se)<we?se:Math.floor(G)}else Ee=Math.floor(G);V=h+Ee*L,Y=y+Ee*b;let Me=G-Ee;Me<e&&(o=!0),G=1/Me,h=L,y=b,L=V,b=Y,(Math.abs(V/Y-t)<e||k>30)&&(o=!0)}return[V,Y]}};re.classes.Fraction=Xn;function jt(r){let t=function(e){this.name=r,this.message=e===void 0?"":e;let o=new Error(this.message);o.name=this.name,this.stack=o.stack};return t.prototype=Object.create(Error.prototype),t}var yn=jt("DivisionByZero"),Gn=jt("ParseError"),Ht=jt("UndefinedError"),hn=jt("OutOfFunctionDomainError"),A1=jt("MaximumIterationsReached"),En=jt("NerdamerTypeError"),W0=jt("ParityError"),_0=jt("OperatorError"),b1=jt("OutOfRangeError"),gn=jt("DimensionError"),Hn=jt("InvalidVariableNameError"),C1=jt("ValueLimitExceededError"),jn=jt("NerdamerValueError"),I1=jt("SolveError"),_1=jt("InfiniteLoopError"),Zn=jt("UnexpectedTokenError");re.exceptions={DivisionByZero:yn,ParseError:Gn,OutOfFunctionDomainError:hn,UndefinedError:Ht,MaximumIterationsReached:A1,NerdamerTypeError:En,ParityError:W0,OperatorError:_0,OutOfRangeError:b1,DimensionError:gn,InvalidVariableNameError:Hn,ValueLimitExceededError:C1,NerdamerValueError:jn,SolveError:I1,InfiniteLoopError:_1,UnexpectedTokenError:Zn};var Rt={get bigInt(){return re.ext.bigInt},get bigDec(){return re.ext.bigDec},get isInt(){return re.utils.isInt},get scientificToDecimal(){return re.utils.scientificToDecimal},get DivisionByZero(){return yn},get Settings(){return re.settings},get Fraction(){return Xn}},Ve=class r{num;den;constructor(t){if(t instanceof r)return t;if(t===void 0)return this;try{if(Rt.isInt(t))try{this.num=Rt.bigInt(t),this.den=Rt.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return r.simple(t)}else{let e=t instanceof Rt.bigDec?Rt.Fraction.quickConversion(t):Rt.Fraction.convert(t);this.num=new Rt.bigInt(e[0]),this.den=new Rt.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return r.simple(t)}}static create(t){if(t instanceof r)return t;t=t.toString();let e=t.charAt(0)==="-";e&&(t=t.substr(1,t.length-1));let o=new r(t);return e&&o.negate(),o}static isFrac(t){return t instanceof r}static quick(t,e){let o=new r;return o.num=new Rt.bigInt(t),o.den=new Rt.bigInt(e),o}static simple(t){let o=String(Rt.scientificToDecimal(t)).split("."),h=o.join(""),y="1",L=(o[1]||"").length;for(let k=0;k<L;k++)y+="0";return r.quick(h,y).simplify()}multiply(t){if(this.isOne())return t.clone();if(t.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(t.num),e.den=e.den.multiply(t.den),e.simplify()}divide(t){if(t.equals(0))throw new Rt.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(t.clone().invert()).simplify()}subtract(t){return this.clone().add(t.clone().neg())}sub(t){return this.subtract(t)}neg(){return this.num=this.num.multiply(-1),this}add(t){let e=this.den,o=t.den,h=this.clone(),y=h.num,L=t.num;return e.equals(o)?h.num=y.add(L):(h.num=y.multiply(o).add(L.multiply(e)),h.den=e.multiply(o)),h.simplify()}mod(t){let e=this.clone(),o=t.clone();return e.num=e.num.multiply(o.den),e.den=e.den.multiply(o.den),o.num=o.num.multiply(this.den),o.den=o.den.multiply(this.den),e.num=e.num.mod(o.num),e.simplify()}simplify(){let t=Rt.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(t),this.den=this.den.divide(t),this}clone(){let t=new r;return t.num=new Rt.bigInt(this.num),t.den=new Rt.bigInt(this.den),t}decimal(t){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";t||=Rt.Settings.PRECISION,t+=2;let o=[],h=this.num.abs(),y=this.den,L;for(L=0;L<t;L++){let G=h.divide(y),V=h.subtract(G.multiply(y));if(o.push(G),V.equals(0))break;h=V.times(10)}let b=o.shift();if(o.length===0)return e+b.toString();if(L===t){let G=[];for(let V=0;V<2;V++)G.unshift(o.pop());o.push(Math.round(Number(G.join("."))))}let k=`${b.toString()}.${o.join("")}`;return e+k}toDecimal(t){return t||=Rt.Settings.PRECISION,t?this.decimal(t):this.num.valueOf()/this.den.valueOf()}qcompare(t){return[this.num.multiply(t.den),t.num.multiply(this.den)]}equals(t){isNaN(t)||(t=new r(t));let e=this.qcompare(t);return e[0].equals(e[1])}absEquals(t){isNaN(t)||(t=new r(t));let e=this.qcompare(t);return e[0].abs().equals(e[1])}greaterThan(t){isNaN(t)||(t=new r(t));let e=this.qcompare(t);return e[0].gt(e[1])}gt(t){return this.greaterThan(t)}gte(t){return this.greaterThan(t)||this.equals(t)}lte(t){return this.lessThan(t)||this.equals(t)}lessThan(t){isNaN(t)||(t=new r(t));let e=this.qcompare(t);return e[0].lt(e[1])}lt(t){return this.lessThan(t)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let t=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=t,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(t){return r.quick(Rt.bigInt.gcd(t.num,this.num),Rt.bigInt.lcm(t.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Rt.Settings.USE_BIG?new Rt.bigDec(this.num.toString()).div(new Rt.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(t){let e=typeof t=="number"?new r(t):t;return this.mod(e).equals(0)}};re.classes.Frac=Ve;var an={get isVector(){return re.utils.isVector},get Vector(){return re.classes.Vector},get remove(){return d0}},g0=class r{elements=[];constructor(t,...e){if(typeof t>"u")return;let o=t;if(an.isVector(t)||(o=an.Vector.fromArray([t,...e])),o){let{elements:h}=o;for(let y=0,L=h.length;y<L;y++)this.add(h[y])}}static fromArray(t){let e=new r;for(let o of t)e.add(o);return e}add(t){this.contains(t)||this.elements.push(t.clone())}contains(t){for(let e=0;e<this.elements.length;e++){let o=this.elements[e];if(t.equals(o))return!0}return!1}each(t){let{elements:e}=this,o=new r;for(let h=0,y=e.length;h<y;h++){let L=e[h];t.call(this,L,o,h)}return o}clone(){let t=new r;return this.each(e=>{t.add(e.clone())}),t}union(t){let e=this.clone();return t.each(o=>{e.add(o)}),e}difference(t){let e=this.clone();return t.each(o=>{e.remove(o)}),e}remove(t){for(let e=0,o=this.elements.length;e<o;e++)if(this.elements[e].equals(t))return an.remove(this.elements,e),!0;return!1}intersection(t){let e=new r,o=this;return t.each(h=>{o.contains(h)&&e.add(h)}),e}intersects(t){return this.intersection(t).elements.length>0}isSubset(t){let{elements:e}=t;for(let o=0,h=e.length;o<h;o++)if(!this.contains(e[o]))return!1;return!0}toString(){return`{${this.elements.join(",")}}`}};re.classes.NerdamerSet=g0;var N0={get _(){return re.parser},get block(){return re.utils.block}},t0=class r{elements=[];constructor(t){t&&this.elements.push(t)}static create(t){return new r(t)}append(t){this.elements.push(t)}getItems(){return this.elements}toString(){return N0._.prettyPrint(this.elements)}dimensions(){return this.elements.length}text(t){return`(${this.elements.map(e=>e.text(t)).join(",")})`}clone(){let t=r.create();return t.elements=this.elements.map(e=>e.clone()),t}expand(t){return this.elements=this.elements.map(e=>N0._.expand(e,t)),this}evaluate(t){return this.elements=this.elements.map(e=>N0._.evaluate(e,t)),this}map(t){let e=this.clone();return e.elements=e.elements.map((o,h)=>t(o,h+1)),e}add(t){return N0.block("SAFE",()=>{let e=t.elements;return this.elements.length!==e.length?null:this.map((o,h)=>N0._.add(o,e[h-1]))},void 0,this)}subtract(t){return N0.block("SAFE",()=>{let e=t.elements;return this.elements.length!==e.length?null:this.map((o,h)=>N0._.subtract(o,e[h-1]))},void 0,this)}};re.classes.Collection=t0;var Pn={get Settings(){return re.settings},get nround(){return re.utils.nround}},D0=class r{sign;coeff;exponent;wholes;dec;decp;constructor(t){t=String(typeof t>"u"?0:t),t.startsWith("-")?(this.sign=-1,t=t.substr(1,t.length)):this.sign=1,r.isScientific(t)?this.fromScientific(t):this.convert(t)}static isScientific(t){return Vn(t)}static leadingZeroes(t){let e=t.match(/^(?<zeros>0*).*$/u);return e?e[1]:""}static removeLeadingZeroes(t){let e=t.match(/^0*(?<rest>.*)$/u);return e?e[1]:""}static removeTrailingZeroes(t){let e=t.match(/0*$/u);return e?t.substring(0,t.length-e[0].length):""}static round(t,e){let o=String(Pn.nround(t,e)),h=o.includes(".")?o.split(".").pop():"",y=e-h.length;return y>0&&(o.includes(".")||(o+="."),o+=new Array(y+1).join("0")),o}fromScientific(t){let e=String(t).toLowerCase().split("e");this.coeff=e[0],this.exponent=Number(e[1]);let o=this.coeff.split(".");this.wholes=o[0]||"",this.dec=o[1]||"";let{dec:h}=this;return this.decp=h==="0"?0:h.length,this}convert(t){let e=t.split("."),o=e[0]||"",h=e[1]||"";o=r.removeLeadingZeroes(o),h=r.removeTrailingZeroes(h);let y=o.length,L=o+h,b=r.leadingZeroes(L).length;this.exponent=y-(b+1);let k=r.removeLeadingZeroes(L);this.coeff=`${k.charAt(0)}.${r.removeTrailingZeroes(k.substr(1,k.length))||"0"}`;let G=this.coeff.split(".")[1]||"";return this.decp=G==="0"?0:G.length,this.dec=h,this.wholes=o,this}round(t){let e=this.copy();if(t=Number(t),t===0)e.coeff=e.coeff.charAt(0);else{let o=this.coeff.substring(0,t+1),h=this.coeff.substring(t+1,t+3),y=Number(h.charAt(0));Number(h.charAt(1))>4&&y++,e.coeff=o+y}return e}copy(){let t=new r(0);return t.coeff=this.coeff,t.exponent=this.exponent,t.sign=this.sign,t}toString(t){let e;if(Pn.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<t)this.decp===0&&this.wholes!==void 0?e=this.wholes:e=this.coeff;else{let o=typeof t>"u"?this.coeff:r.round(this.coeff,Math.min(t,this.decp||1)),h=this.exponent;o.startsWith("10.")&&(o=typeof t>"u"?o.replace(/^10\./u,"1.0"):r.round(o.replace(/^10\./u,"1.0"),Math.min(t,this.decp||1)),h=Number(h)+1),e=this.exponent===0?o:`${o}e${h}`}return(this.sign===-1?"-":"")+e}};re.classes.Scientific=D0;function Dt(r){return Array.isArray(r)}function Mt(r){return`(${r})`}function O1(r,t){return r<0==t<0}function qt(...r){return r.shift().replace(/\{(?<idx>\d+)\}/gu,(o,h)=>{let y=r[h];return typeof y=="function"?y():y})}function q1(r,t,e){let o=[];e||=1;for(let h=r;h<=t;h++)o.push(h*e);return o}function T1(r){return r?String(r):""}function R1(r,t,e,o){return r.substr(0,t)+o+r.substr(e,r.length)}function L1(r){return r!==void 0&&r.custom}function U1(r){return Math.max.apply(void 0,r)}function Mn(r){return Math.min.apply(void 0,r)}function Ut(r){return Number(r)%2===0}function mn(r){return 1/(r%1)%2===0}function An(r){let t=r.length,e=[];for(let o=0;o<t;o++){let h=r[o];e.indexOf(h)===-1&&e.push(h)}return e}function x1(r){return[].slice.call(r)}function mt(r){return typeof r=="number"?Number.isInteger(r):typeof r<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(r.toString())}function P1(r,t){if(r.sort(),t.sort(),r.length===t.length){for(let e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}return!1}function $1(r){let t=[],e=r.length;for(let o=0;o<e;o++)t[o]=r[o].clone();return t}function zn(r){return/^\d+\.?\d*$/u.test(String(r))}function m0(r,t=14){return mt(r)?Number(r)>=Number.MAX_VALUE?r.toString():Number(r):Math.round(r*10**t)/10**t}function D1(r,t){t||=20;let e=[],o,h,y;e.push(r[0]);for(let L=0;L<r.length-1;L++){o=r[L],h=r[L+1]-o,y=h/t;for(let b=0;b<t;b++)o+=y,e.push(o)}return e}function Wn(r,t){if(Dt(r)){let e=r.length;for(let o=0;o<e;o++)t.call(r,o)}else for(let e in r)Object.hasOwn(r,e)&&t.call(r,e)}function d0(r,t){let e;return Dt(r)?e=r.splice(t,1)[0]:(e=r[t],delete r[t]),e}function F1(r,t){let e={};return e[r]=t,e}function k1(r){for(let t=0;t<r.length;t++)if(!zn(r[t]))return!1;return!0}function F0(r){let t=Math.sign(r),e=Math.abs(r);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let h=String(e).toLowerCase().split("e"),y=h.pop(),L=Math.abs(Number(y)),b=Math.sign(Number(y)),k=h[0].split(".");if(b===-1)L-=k[0].length,L<0?e=`${k[0].slice(0,L)}.${k[0].slice(L)}${k.length===2?k[1]:""}`:e=`0.${new Array(L+1).join("0")}${k.join("")}`;else{let G=k[1];G&&(L-=G.length),L<0?e=`${k[0]+G.slice(0,L)}.${G.slice(L)}`:e=k.join("")+new Array(L+1).join("0")}}return t<0?`-${e}`:String(e)}function Q0(r){let t=r[0];for(let e=1,o=r.length;e<o;e++)if(!r[e].equals(t))return!1;return!0}function B1(r,t){typeof t!=="function"&&(t=function(h,y){return h===y});let o=[];for(;r.length;){let h=r[0];if(r.length===1){o.push(h);break}let y=[];o.push(h);for(let L=1;L<r.length;L++){let b=r[L];t(h,b)||y.push(b)}r=y}return o}function V1(r,t){let e=r.length,o=[];for(let L=0;L<r.length;L++)o.push([r[L],t[L]]);o.sort((L,b)=>Number(L[0])-Number(b[0]));let h=[],y=[];for(let L=0;L<e;L++)h.push(o[L][0]),y.push(o[L][1]);return[h,y]}function dn(r){return r instanceof t0}function bn(r){return r instanceof g0}function J0(r,t,e){let h=Object.keys(r)[0];return t?h:e?{key:h,obj:r[h]}:r[h]}var{keys:Cn}=Object,Y0={get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP}},bt={get _(){return re.parser},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get SQRT(){return re.fnNames.SQRT},get ABS(){return re.fnNames.ABS},get FACTORIAL(){return re.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return re.fnNames.DOUBLEFACTORIAL},get PARENTHESIS(){return re.fnNames.PARENTHESIS},get bigDec(){return re.ext.bigDec},get PRIMES(){return re.ext.PRIMES},get VARS(){return re.state.VARS}};function q0(r){return r.group===Y0.N||r.group===Y0.P}function Qn(r){return r.group===Y0.S&&r.multiplier.equals(1)&&r.power.equals(1)}function un(r){for(let t=0;t<r.length;t++)if(r[t].group!==Y0.N)return!1;return!0}var i0={get RESERVED(){return re.state.RESERVED}};function k0(r){let t=function(e){i0.RESERVED.indexOf(e)===-1&&i0.RESERVED.push(e)};typeof r=="string"?t(r):Wn(r,e=>{t(e)})}function X1(r){let t=i0.RESERVED.indexOf(r);t!==-1&&(i0.RESERVED[t]=void 0)}var $n={get ALLOW_CHARS(){return re.settings?.ALLOW_CHARS??[]},VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function w0(r,t="variable"){if($n.ALLOW_CHARS.indexOf(r)!==-1)return;if(!$n.VALIDATION_REGEX.test(r))throw new Hn(`${r} is not a valid ${t} name`)}function K0(r){return i0.RESERVED.indexOf(r)!==-1}var wn={get WARNINGS(){return re.state.WARNINGS},get SHOW_WARNINGS(){return!(re.settings?.SILENCE_WARNINGS??!0)}};function In(r){wn.WARNINGS.push(r),wn.SHOW_WARNINGS&&console&&console.warn&&console.warn(r)}function G1(){return wn.WARNINGS}var H1={get EXPRESSIONS(){return re.state.EXPRESSIONS}};function j1(){return H1.EXPRESSIONS.length}var Z1={get Settings(){return re.settings}};function z1(r){return Z1.Settings[r]}function W1(r){try{return w0(r),i0.RESERVED.indexOf(r)===-1}catch(t){if(t.message==="timeout")throw t;return!1}}function Q1(r){return r?i0.RESERVED:i0.RESERVED.join(", ")}var Jn={get _version(){return re.version},get C(){return re.core}};function J1(r){if(r)try{return Jn.C[r].version}catch(t){if(t.message==="timeout")throw t;return`No module named ${r} found!`}return re.version}function Y1(){return Jn.C}var K1={get functions(){return re.parser?.functions}};function ei(){return Cn(K1.functions)}var ti={get CONSTANTS(){return re.parser?.CONSTANTS}};function ni(r){return String(ti.CONSTANTS[r])}var O0={get VARS(){return re.state.VARS}};function ii(r){return O0.VARS[r]}function ri(r,t){r||="text";let e={};if(r==="object")e=O0.VARS;else for(let o in O0.VARS)Object.hasOwn(O0.VARS,o)&&(r==="latex"?e[o]=O0.VARS[o].latex(t):r==="text"&&(e[o]=O0.VARS[o].text(t)));return e}var Zt={get _(){return re.parser},get C(){return re.core}};function si(r,t){return Zt._.toTeX(r,t)}function oi(r){return Zt._.getOperator(r)}function li(r,t){Zt._.aliasOperator(r,t)}function ai(r,t,e){Zt._.setOperator(r,t,e)}function ui(r,t){Zt._.peekers[r]&&Zt._.peekers[r].push(t)}function ci(r,t){let e=Zt._.peekers[r];if(e){let o=e.indexOf(t);o!==-1&&d0(e,o)}}function Yn(r){let t=Zt._.toRPN(Zt._.tokenize(r));return Zt._.tree(t)}function fi(r){return String(r).split(";").map(t=>Zt._.parse(t))}function pi(r){return Zt._.toRPN(Zt._.tokenize(r))}function hi(r,t){return`<div class="tree">
    <ul>
        <li>
${Yn(r).toHTML(3,t)}
        </li>
    </ul>
</div>`}function gi(r,t,e){let o=Zt._.functions[r],h=typeof e>"u"?o[1]:e;Zt._.functions[r]=[t(o[0],Zt.C),h]}var Qt={get EXPRESSIONS(){return re.state.EXPRESSIONS},get USER_FUNCTIONS(){return re.state.USER_FUNCTIONS},get LaTeX(){return re.classes.LaTeX},get text(){return re.utils.text},get functions(){return re.parser?.functions??{}},get Math2(){return re.classes.Math2},get _(){return re.parser},get Expression(){return re.classes.Expression}};function mi(r,t,e){let o=r?{}:[];for(let h=0;h<Qt.EXPRESSIONS.length;h++){let y=t?Qt.LaTeX.latex(Qt.EXPRESSIONS[h],e):Qt.text(Qt.EXPRESSIONS[h],e);r?o[h+1]=y:o.push(y)}return o}function di(r,t){let e=r?{}:[];for(let o=0;o<Qt.USER_FUNCTIONS.length;o++){let h,y,L=Qt.USER_FUNCTIONS[o],b=Qt.functions[L][2];if(b)({params:h,body:y}=b);else{let V=Qt.Math2[L].toString();[,h]=/\((?<params>.*?)\)/u.exec(V),h=h.split(",").map(Y=>Y.trim()),y="{JavaScript}"}let k=`${L}(${h.join(", ")})=${y}`,G=Qt.text(k,t);r?e[o+1]=G:e.push(G)}return e}function wi(r){r=r.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),r=r.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),r=r.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),r=r.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let t=Qt.LaTeX.parse(Qt._.tokenize(r));return new Qt.Expression(Qt._.parse(t))}var l0={get libExports(){return re.libExports},get VARS(){return re.state.VARS},get _clearFunctions(){return re.utils._clearFunctions},get _initConstants(){return re.parser?.initConstants??(()=>{})},get clear(){return Kn}};function Si(){for(let r in l0.VARS)Object.hasOwn(l0.VARS,r)&&delete l0.VARS[r];return l0.libExports}function vi(){return l0._clearFunctions(),l0.libExports}function Ni(){return l0.libExports}function yi(){return l0.clear("all"),l0.libExports}function Ei(r){return r.call(l0.libExports),l0.libExports}var cn={get libExports(){return re.libExports},get CONSTANTS(){return re.state.CONSTANTS}};function Mi(r,t){if(w0(r),!K0(r))if(t==="delete"||t==="")delete cn.CONSTANTS[r];else{if(isNaN(t))throw new En("Constant must be a number!");cn.CONSTANTS[r]=t}return cn.libExports}var C0={get libExports(){return re.libExports},get VARS(){return re.state.VARS},get CONSTANTS(){return re.state.CONSTANTS},get parse(){let{parser:r}=re;return r?.parse?.bind(r)??(()=>null)},get isSymbol(){return re.utils.isSymbol}};function Ai(r,t){return w0(r),r in C0.CONSTANTS&&Pt(`Cannot set value for constant ${r}`),t==="delete"||t===""?delete C0.VARS[r]:C0.VARS[r]=C0.isSymbol(t)?t:C0.parse(t),C0.libExports}var Dn={get libExports(){return re.libExports},get _setFunction(){return re.utils._setFunction}};function bi(r,t,e){if(!Dn._setFunction(r,t,e))throw new Error("Failed to set function!");return Dn.libExports}var y0={get libExports(){return re.libExports},get EXPRESSIONS(){return re.state.EXPRESSIONS}};function Kn(r,t=!1){if(r==="all")y0.EXPRESSIONS.length=0;else if(r==="last")y0.EXPRESSIONS.pop();else if(r==="first")y0.EXPRESSIONS.shift();else{let e=r?r-1:y0.EXPRESSIONS.length;t===!0?y0.EXPRESSIONS[e]=void 0:d0(y0.EXPRESSIONS,e)}return y0.libExports}var Z0={get libExports(){return re.libExports},get Settings(){return re.settings},get functions(){return re.parser?.functions??{}}};function e1(r){let t=Z0.libExports.getCore();if(Dt(r))for(let e=0;e<r.length;e++)r&&e1(r[e]);else if(r&&Z0.Settings.exclude.indexOf(r.name)===-1){if(r.dependencies){for(let h=0;h<r.dependencies.length;h++)if(!t[r.dependencies[h]])throw new Error(qt("{0} requires {1} to be loaded!",r.name,r.dependencies[h]))}let e=r.parent,o=r.build.call(t);if(e){t[e]||(t[r.parent]={});let h=e==="nerdamer"?Z0.libExports:t[e];h[r.name]=o}r.visible&&(Z0.functions[r.name]=[o,r.numargs])}}var Wt={get bigDec(){return re.ext.bigDec},get Settings(){return re.settings},get functions(){return re.parser?.functions??{}},get symfunction(){return re.utils.symfunction},get NerdamerSymbol(){return re.classes.NerdamerSymbol}};function Sn(r,t){if(typeof r=="object"&&r!==null){let o=r;for(let h in o)Object.hasOwn(o,h)&&Sn(h,o[h])}["SAFE"].indexOf(r)!==-1&&Pt(`Cannot modify setting: ${r}`),r==="PRECISION"?(Wt.bigDec.set({precision:t}),Wt.Settings.PRECISION=t,t>21&&Sn("USE_BIG",!0)):r==="USE_LN"&&t===!0?(Wt.Settings.LOG="LN",Wt.Settings.LOG10="log",Wt.functions.log=Wt.Settings.LOG_FNS.log10,Wt.functions.log[0]=function(h){return h.isConstant()?new Wt.NerdamerSymbol(Math.log10(h)):Wt.symfunction(Wt.Settings.LOG10,[h])},Wt.functions.LN=Wt.Settings.LOG_FNS.log,delete Wt.functions.log10):Wt.Settings[r]=t}var I0={get libExports(){return re.libExports},get functions(){return re.parser?.functions??{}},get parse(){let{parser:r}=re;return r?.parse?.bind(r)??(()=>null)},get callfunction(){return re.utils.callfunction},get Expression(){return re.classes.Expression}};function Ci(r=!1){let t=function(o){return function(...y){for(let L=0;L<y.length;L++)y[L]=I0.parse(y[L]);return new I0.Expression(Bt("PARSE2NUMBER",()=>I0.callfunction(o,y)))}};for(let e in I0.functions)(!(e in I0.libExports)||r)&&(I0.libExports[e]=t(e))}var Ii={get suppress_errors(){return re.settings?.suppress_errors??!1}};function Pt(r,t=void 0){if(!Ii.suppress_errors)throw t?new t(r):new Error(r)}var _i={get PRIMES_SET(){return re.ext.PRIMES_SET}};function $0(r){if(r in _i.PRIMES_SET)return!0;let t=Math.floor(Math.sqrt(r));for(let e=2;e<=t;e++)if(r%e===0)return!1;return!0}var A0={starttime:0,timeout:0,get TIMEOUT(){return re.settings?.TIMEOUT??800}};function t1(){A0.starttime=Date.now(),A0.timeout=A0.TIMEOUT}function n1(){A0.starttime=0}function en(){if(A0.starttime!==0&&Date.now()>A0.starttime+A0.timeout)throw new Error("timeout")}var M0={get PRIMES(){return re.ext.PRIMES},get PRIMES_SET(){return re.ext.PRIMES_SET}};function Oi(r){if(en(),$0(r))return[r];let t=r,e=1,o=[],h=2220446049250313e-31;for(;e<t;){en();let y=r/e,L=Math.floor(y);if(y-L<=h&&e>1){if($0(e)&&(M0.PRIMES_SET[e]||(M0.PRIMES.push(e),M0.PRIMES_SET[e]=!0),o.push(e)),$0(L)){o.push(L);break}t=L}e++}return o.sort((y,L)=>y-L)}function i1(r){let t=M0.PRIMES[M0.PRIMES.length-1]||2;for(let e=t;e<r;e++)$0(e)&&M0.PRIMES.push(e),M0.PRIMES_SET[e]=!0}var fn={get Settings(){return re.settings}};function Bt(r,t,e=void 0,o=void 0){let h=fn.Settings[r];fn.Settings[r]=e===void 0?!0:!!e;let y=t.call(o);return fn.Settings[r]=h,y}function Nt(r,t=void 0){return Bt("PARSE2NUMBER",()=>bt._.parse(r,t),!0)}var wt={get EXPRESSIONS(){return re.state.EXPRESSIONS},get Settings(){return re.settings},get LaTeX(){return re.classes.LaTeX},get text(){return re.utils.text},get variables(){return re.utils.variables},get isVector(){return re.utils.isVector},get isSymbol(){return re.utils.isSymbol},get isExpression(){return re.utils.isExpression},get isNumericSymbol(){return re.utils.isNumericSymbol},get isFraction(){return re.utils.isFraction},get isArray(){return re.utils.isArray},get _(){return re.parser},get Build(){return re.classes.Build}},S0=class r{symbol;constructor(t){this.symbol=t}static getExpression(t,e=void 0){(t==="last"||!t)&&(t=wt.EXPRESSIONS.length),t==="first"&&(t=1);let o=Number(t)-1,h=wt.EXPRESSIONS[o];return h&&new r(h.symbol)}text(t="decimals",e=void 0){e||=wt.Settings.EXPRESSION_DECP;let o=this.symbol;return o.text_?o.text_(t):wt.text(this.symbol,t,void 0,e)}latex(t){return this.symbol.latex?this.symbol.latex(t):wt.LaTeX.latex(this.symbol,t)}valueOf(){return this.symbol.valueOf()}evaluate(...t){if(wt.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let e=t[0],o,h=1;typeof e=="string"?o=e.charAt(0)==="%"?r.getExpression(e.substr(1)).text():e:e instanceof r||wt.isSymbol(e)?o=e.text():(o=this.symbol.text(),h--);let y=t[h]||{};return new r(Bt("PARSE2NUMBER",()=>wt._.parse(o,y),!0))}buildFunction(t){return wt.Build.build(this.symbol,t)}isNumber(){return wt.isNumericSymbol(this.symbol)}isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0}isImaginary(){return Nt(wt._.parse(this.symbol)).isImaginary()}variables(){return wt.variables(this.symbol)}toString(){try{return wt.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(t){if(t.message==="timeout")throw t;return""}}toDecimal(t){wt.Settings.precision=t;let e=wt.text(this.symbol,"decimals");return wt.Settings.precision=void 0,e}isFraction(){return wt.isFraction(this.symbol)}isPolynomial(){return this.symbol.isPoly()}sub(t,e){return new r(this.symbol.sub(wt._.parse(t),wt._.parse(e)))}operation(t,e){let o;return wt.isExpression(e)?o=e.symbol:wt.isSymbol(e)?o=e:o=wt._.parse(e),new r(wt._[t](this.symbol.clone(),o.clone()))}add(t){return this.operation("add",t)}subtract(t){return this.operation("subtract",t)}multiply(t){return this.operation("multiply",t)}divide(t){return this.operation("divide",t)}pow(t){return this.operation("pow",t)}expand(){return new r(wt._.expand(this.symbol))}each(t,e){if(this.symbol.each)this.symbol.each(t,e);else if(wt.isArray(this.symbol))for(let o=0;o<this.symbol.length;o++)t.call(this.symbol,this.symbol[o],o);else t.call(this.symbol)}eq(t){wt.isSymbol(t)||(t=wt._.parse(t));try{return wt._.subtract(this.symbol.clone(),t).equals(0)}catch(e){if(e.message==="timeout")throw e;return!1}}lt(t){wt.isSymbol(t)||(t=wt._.parse(t));try{return Nt(wt._.subtract(this.symbol.clone(),t)).lessThan(0)}catch(e){if(e.message==="timeout")throw e;return!1}}gt(t){wt.isSymbol(t)||(t=wt._.parse(t));try{return Nt(wt._.subtract(this.symbol.clone(),t)).greaterThan(0)}catch(e){if(e.message==="timeout")throw e;return!1}}gte(t){return this.gt(t)||this.eq(t)}lte(t){return this.lt(t)||this.eq(t)}numerator(){return new r(this.symbol.getNum())}denominator(){return new r(this.symbol.getDenom())}hasFunction(t){return this.symbol.containsFunction(t)}contains(t){return this.symbol.contains(t)}toTeX(t){return this.latex(t)}};re.classes.Expression=S0;var ot={get _(){return re.parser},get Settings(){return re.settings},get LaTeX(){return re.classes.LaTeX},get NerdamerSymbol(){return re.classes.NerdamerSymbol}},It=class r{multiplier;elements;rowVector;custom=!0;constructor(t,...e){this.multiplier=new Ve(1),vt(t)?this.elements=t.elements?.slice(0)??[]:Dt(t)?this.elements=t.slice(0):St(t)?t.elements.length===1?(this.elements=[...t.elements[0]],this.rowVector=!0):t.elements.length>1&&Array.isArray(t.elements[0])&&t.elements[0].length===1&&(this.elements=t.elements.map(o=>o[0]),this.rowVector=!1):typeof t>"u"?this.elements=[]:this.elements=[t,...e]}static arrayPrefill(t,e){let o=[];e||=0;for(let h=0;h<t;h++)o[h]=e;return o}static fromArray(t){let e=new r;return e.elements=t,e}static fromSet(t){return r.fromArray(t.elements)}e(t){return t<1||t>this.elements.length?null:this.elements[t-1]}set(t,e){gt(e)?this.elements[t]=e:this.elements[t]=new ot.NerdamerSymbol(e)}dimensions(){return this.elements.length}modulus(){return Bt("SAFE",()=>ot._.pow(this.dot(this.clone()),new ot.NerdamerSymbol(.5)),void 0,this)}eql(t){let e=this.elements.length,o=t.elements||t;if(e!==o.length)return!1;do if(Math.abs(ot._.subtract(this.elements[e-1],o[e-1]).valueOf())>ot.Settings.PRECISION)return!1;while(--e);return!0}clone(){let t=new r,e=this.elements.length;for(let o=0;o<e;o++)t.elements.push(this.elements[o].clone());return t.rowVector=this.rowVector,t}expand(t){return this.elements=this.elements.map(e=>ot._.expand(e,t)),this}map(t){let e=[];return this.each((o,h)=>{e.push(t(o,h))}),new r(e)}each(t){let e=this.elements.length,o=e,h;do h=o-e,t(this.elements[h],h+1);while(--e)}toUnitVector(){return Bt("SAFE",()=>{let t=this.modulus();return t.valueOf()===0?this.clone():this.map(e=>ot._.divide(e,t))},void 0,this)}angleFrom(t){return Bt("SAFE",()=>{let e=t.elements||t;if(this.elements.length!==e.length)return null;let h=new ot.NerdamerSymbol(0),y=new ot.NerdamerSymbol(0),L=new ot.NerdamerSymbol(0);this.each((V,Y)=>{h=ot._.add(h,ot._.multiply(V,e[Y-1])),y=ot._.add(y,ot._.multiply(V,V)),L=ot._.add(L,ot._.multiply(e[Y-1],e[Y-1]))}),y=ot._.pow(y,new ot.NerdamerSymbol(.5)),L=ot._.pow(L,new ot.NerdamerSymbol(.5));let b=ot._.multiply(y,L);if(b.valueOf()===0)return null;let k=ot._.divide(h,b),G=k.valueOf();return G<-1&&(k=-1),G>1&&(k=1),new ot.NerdamerSymbol(Math.acos(k))},void 0,this)}isParallelTo(t){let e=this.angleFrom(t).valueOf();return e===null?null:e<=ot.Settings.PRECISION}isAntiparallelTo(t){let e=this.angleFrom(t).valueOf();return e===null?null:Math.abs(e-Math.PI)<=ot.Settings.PRECISION}isPerpendicularTo(t){let e=this.dot(t);return e===null?null:Math.abs(e)<=ot.Settings.PRECISION}add(t){return Bt("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((o,h)=>ot._.add(o,e[h-1]))},void 0,this)}subtract(t){return Bt("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((o,h)=>ot._.subtract(o,e[h-1]))},void 0,this)}multiply(t){return this.map(e=>ot._.multiply(e.clone(),t.clone()))}x(t){return this.multiply(t)}dot(t){return Bt("SAFE",()=>{let e=t.elements||t,o=new ot.NerdamerSymbol(0),h=this.elements.length;if(h!==e.length)return null;do o=ot._.add(o,ot._.multiply(this.elements[h-1],e[h-1]));while(--h);return o},void 0,this)}cross(t){let e=t.elements||t;if(this.elements.length!==3||e.length!==3)return null;let o=this.rowVector&&t.rowVector,h=this.elements;return Bt("SAFE",()=>{let y=new r([ot._.subtract(ot._.multiply(h[1],e[2]),ot._.multiply(h[2],e[1])),ot._.subtract(ot._.multiply(h[2],e[0]),ot._.multiply(h[0],e[2])),ot._.subtract(ot._.multiply(h[0],e[1]),ot._.multiply(h[1],e[0]))]);return y.rowVector=o,y},void 0,this)}toUnitMultiplier(){return this}max(){let t=0,e=this.elements.length,o=e,h;do{h=o-e;let y=this.elements[h],L=y.valueOf(),b=typeof t=="number"?t:t.valueOf();Math.abs(L)>Math.abs(b)&&(t=y)}while(--e);return t}magnitude(){let t=new ot.NerdamerSymbol(0);return this.each(e=>{t=ot._.add(t,ot._.pow(e,new ot.NerdamerSymbol(2)))}),ot._.sqrt(t)}indexOf(t){let e=null,o=this.elements.length,h=o,y;do y=h-o,e===null&&this.elements[y].valueOf()===t.valueOf()&&(e=y+1);while(--o);return e}text_(t,e){let o=Xt(this,e);return(this.rowVector?"[":"")+o+(this.rowVector?"]":"")}text(t,e){let o=Xt(this,e);return(this.rowVector?"[":"")+o+(this.rowVector?"]":"")}toString(){return this.text()}latex(t){let e=[];for(let o=0;o<this.elements.length;o++)e.push(ot.LaTeX.latex(this.elements[o],t));return`[${e.join(", ")}]`}};re.classes.Vector=It;var Lt={get _(){return re.parser},get LaTeX(){return re.classes.LaTeX},get NerdamerSymbol(){return re.classes.NerdamerSymbol}},xt=class r{multiplier;elements;custom=!0;constructor(...t){this.multiplier=new Ve(1);let e=t,o=e.length,h,y=[];if(St(e))for(h=0;h<o;h++)y.push(e[h].slice(0));else{let L,b,k;for(h=0;h<o;h++)L=e[h],vt(L)&&(L=L.elements),Dt(L)||(L=[L]),k=L.length,b&&b!==k&&Pt("Unable to create Matrix. Row dimensions do not match!"),y.push(L),b=k}this.elements=y}static identity(t){let e=new r;for(let o=0;o<t;o++){e.elements.push([]);for(let h=0;h<t;h++)e.set(o,h,o===h?new Lt.NerdamerSymbol(1):new Lt.NerdamerSymbol(0))}return e}static fromArray(t){return new r(...t)}static zeroMatrix(t,e){let o=new r;for(let h=0;h<t;h++)o.elements.push(It.arrayPrefill(e,new Lt.NerdamerSymbol(0)));return o}get(t,e){if(this.elements[t])return this.elements[t][e]}map(t,e){let o=new r;return this.each((h,y,L)=>{o.set(y,L,t.call(o,h),e)}),o}set(t,e,o,h){this.elements[t]||=[],h||gt(o)?this.elements[t][e]=o:this.elements[t][e]=new Lt.NerdamerSymbol(o)}cols(){return this.elements[0].length}rows(){return this.elements.length}row(t){return!t||t>this.cols()?[]:this.elements[t-1]}col(t){let e=this.rows(),o=[];if(t>this.cols()||!t)return o;for(let h=0;h<e;h++)o.push(this.elements[h][t-1]);return o}eachElement(t){let e=this.rows(),o=this.cols(),h,y;for(h=0;h<e;h++)for(y=0;y<o;y++)t.call(this,this.elements[h][y],h,y)}each(t){this.eachElement(t)}determinant(){if(!this.isSquare())return null;let t=this.toRightTriangular(),e=t.elements[0][0],o=t.elements.length-1,h=o,y;do y=h-o+1,e=Lt._.multiply(e,t.elements[y][y]);while(--o);return e}isSquare(){return this.elements.length===this.elements[0].length}isSingular(){let t=this.determinant();return this.isSquare()&&t!==null&&t.multiplier.equals(0)}augment(t){let e=this.rows(),o=t.rows();e!==o&&Pt("Cannot augment matrix. Rows don't match.");for(let h=0;h<e;h++)this.elements[h]=this.elements[h].concat(t.elements[h]);return this}clone(){let t=this.rows(),e=this.cols(),o=new r;for(let h=0;h<t;h++){o.elements[h]=[];for(let y=0;y<e;y++){let L=this.elements[h][y];o.elements[h][y]=gt(L)?L.clone():L}}return o}toUnitMultiplier(){return this}expand(t){return this.eachElement(e=>Lt._.expand(e,t)),this}evaluate(t){return this.eachElement(e=>Lt._.evaluate(e,t)),this}invert(){return this.isSquare()||Pt("Matrix is not square!"),Bt("SAFE",()=>{let t=this.elements.length,e=t,o,h,y=r.identity(t),L=this.augment(y).toRightTriangular(),b,k=L.elements[0].length,G,V,Y,we=[],Ee;do{o=t-1,V=[],b=k,we[o]=[],Y=L.elements[o][o];do G=k-b,Ee=Lt._.divide(L.elements[o][G],Y.clone()),V.push(Ee),G>=e&&we[o].push(Ee);while(--b);for(L.elements[o]=V,h=0;h<o;h++){V=[],b=k;do G=k-b,V.push(Lt._.subtract(L.elements[h][G].clone(),Lt._.multiply(L.elements[o][G].clone(),L.elements[h][o].clone())));while(--b);L.elements[h]=V}}while(--t);return r.fromArray(we)},void 0,this)}toRightTriangular(){return Bt("SAFE",()=>{let t=this.clone(),e,o,h,y=this.elements.length,L=y,b,k,G=this.elements[0].length,V;do{if(b=L-y,o=t.elements[b][b],o.valueOf()===0){for(let Y=b+1;Y<L;Y++)if(h=t.elements[Y][b],h&&h.valueOf()!==0){e=[],k=G;do V=G-k,e.push(Lt._.add(t.elements[b][V].clone(),t.elements[Y][V].clone()));while(--k);t.elements[b]=e;break}}if(o=t.elements[b][b],o.valueOf()!==0)for(let Y=b+1;Y<L;Y++){let we=Lt._.divide(t.elements[Y][b].clone(),t.elements[b][b].clone());e=[],k=G;do V=G-k,e.push(V<=b?new Lt.NerdamerSymbol(0):Lt._.subtract(t.elements[Y][V].clone(),Lt._.multiply(t.elements[b][V].clone(),we.clone())));while(--k);t.elements[Y]=e}}while(--y);return t},void 0,this)}transpose(){let t=this.elements.length,e=this.elements[0].length,o=new r,h=e,y,L,b;do{y=e-h,o.elements[y]=[],L=t;do b=t-L,o.elements[y][b]=this.elements[b][y].clone();while(--L)}while(--h);return o}canMultiplyFromLeft(t){let e=St(t)?t.elements.length:t.length;return this.elements[0].length===e}sameSize(t){return this.rows()===t.rows()&&this.cols()===t.cols()}multiply(t){return Bt("SAFE",()=>{let e=t.elements||t;if(!this.canMultiplyFromLeft(e)){let Me=t;if(this.sameSize(Me)){let se=new r,ge=this.rows();for(let fe=0;fe<ge;fe++){let a=Lt._.multiply(new It(this.elements[fe]),new It(Me.elements[fe]));se.elements[fe]=a.elements}return se}return null}let o=this.elements.length,h=o,y,L,b=e[0].length,k,G=this.elements[0].length,V=[],Y,we,Ee;do{y=h-o,V[y]=[],L=b;do{k=b-L,Y=new Lt.NerdamerSymbol(0),we=G;do Ee=G-we,Y=Lt._.add(Y,Lt._.multiply(this.elements[y][Ee],e[Ee][k]));while(--we);V[y][k]=Y}while(--L)}while(--o);return r.fromArray(V)},void 0,this)}add(t,e){let o=new r;return this.sameSize(t)&&this.eachElement((h,y,L)=>{let b=Lt._.add(h.clone(),t.elements[y][L].clone());e&&(b=e.call(o,b,h,t.elements[y][L])),o.set(y,L,b)}),o}subtract(t,e){let o=new r;return this.sameSize(t)&&this.eachElement((h,y,L)=>{let b=Lt._.subtract(h.clone(),t.elements[y][L].clone());e&&(b=e.call(o,b,h,t.elements[y][L])),o.set(y,L,b)}),o}negate(){return this.each(t=>t.negate()),this}toVector(){if(this.rows()===1||this.cols()===1){let t=new It;return t.elements=this.elements.flat(),t}return this}toString(t,e){let o=this.rows(),h=[];t=t===void 0?`
`:t;for(let y=0;y<o;y++)h.push(`[${this.elements[y].map(L=>{let b=e?L.multiplier.toDecimal():L.toString();return L===void 0?"":b}).join(",")}]`);return`matrix${Mt(h.join(","))}`}text(){return`matrix(${this.elements.map(t=>`[${t.join(",")}]`)})`}latex(t){let e=this.cols(),{elements:o}=this;return qt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let h=[];for(let y in o){if(!Object.hasOwn(o,y))continue;let L=[];for(let b=0;b<e;b++)L.push(Lt.LaTeX.latex(o[y][b],t));h.push(L.join(" & "))}return h.join(" \\cr ")})}};re.classes.Matrix=xt;var P0={get _(){return re.parser},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get CB(){return re.groups.CB},get Math2(){return sn.Math2},get NerdamerSymbol(){return re.classes.NerdamerSymbol}},e0={dependencies:{},reformat:{},initDependencies(){let{Math2:r}=P0;this.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":r.gamma},gamma_incomplete:{"Math2.factorial":r.factorial},Li:{"Math2.Ei":r.Ei,"Math2.bigLog":r.bigLog,Frac:Ve},Ci:{"Math2.factorial":r.factorial},Ei:{"Math2.factorial":r.factorial},Si:{"Math2.factorial":r.factorial},Shi:{"Math2.factorial":r.factorial},Chi:{isInt:mt,nround:m0,"Math2.num_integrate":r.num_integrate},factor:{"Math2.ifactor":r.ifactor,NerdamerSymbol:P0.NerdamerSymbol},num_integrate:{"Math2.simpson":r.simpson,nround:m0},fib:{even:Ut}},this.reformat={diff(t,e){let o=t.args[1].toString(),h=`let f = ${e0.build(t.args[0].toString(),[o])};`,y=r.diff.toString();return!y.startsWith("function")&&!y.startsWith("(")&&!y.startsWith("async")&&(y=`function ${y}`),e[1]+=`let diff = ${y};`,e[1]+=h,[`diff(f)(${o})`,e]}}},getProperName(r){return{continuedFraction:"continuedFraction"}[r]||r},compileDependencies(r,t){let e=e0.dependencies[r],o=t&&t[1]?t[1]:"",h=t&&t[0]?t[0]:{};for(let y in e){if(typeof e[y]=="object")continue;let L=y.split("."),b=e[y];if(typeof b=="function"){let k=b.toString();!k.startsWith("function")&&!k.startsWith("(")&&!k.startsWith("async")&&(k=`function ${k}`),b=k}o+=`let ${L.length>1?L[1]:L[0]}=${b};`,h[y]=L.pop()}return[h,o]},getArgsDeps(r,t){let{args:e}=r,o=t,h=function(y){y.group===P0.FN&&(o=e0.compileDependencies(y.fname,o))};for(let y=0;y<e.length;y++)r.args[y].each(h);return o},build(r,t){let{_:e,FN:o,N:h,S:y,P:L,EX:b,CB:k,NerdamerSymbol:G}=P0;r=Bt("PARSE2NUMBER",()=>e.parse(r),!0);let V=n0(r),Y=[],we=[{},""],Ee=function(ge,fe){ge.fname===""&&(ge=G.unwrapPARENS(ge)),fe||=[];let a=[],{group:Ne}=ge,be="",Le=function(me){let _e=me===k?"*":"+",ye=[];for(let s in ge.symbols){if(!Object.hasOwn(ge.symbols,s))continue;let f=ge.symbols[s],S=Ee(f,fe)[0];f.isComposite()&&(S=Mt(S)),ye.push(S)}let he=ye.join(_e);return he=he&&!ge.multiplier.equals(1)?Mt(he):he,he},Ae=function(me){let _e;if(me in Math)_e=`Math.${me}`;else{if(me=e0.getProperName(me),Y.indexOf(me)===-1){let ye=P0.Math2[me].toString();!ye.startsWith("function")&&!ye.startsWith("(")&&!ye.startsWith("async")&&(ye=`function ${ye}`),fe.push(`let ${me} = ${ye}; `),Y.push(me)}_e=me}return _e+=Mt(ge.args.map(ye=>Ee(ye,fe)[0]).join(",")),_e};Ne===h?a.push(ge.multiplier.toDecimal()):ge.multiplier.equals(-1)?be="-":ge.multiplier.equals(1)||a.push(ge.multiplier.toDecimal());let xe;if(Ne===y||Ne===L)xe=ge.value;else if(Ne===o)if(we=e0.compileDependencies(ge.fname,we),we=e0.getArgsDeps(ge,we),e0.reformat[ge.fname]){let me=e0.reformat[ge.fname](ge,we);we=me[1],xe=me[0]}else xe=Ae(ge.fname);else if(Ne===b){let me=ge.previousGroup;me===h||me===y?xe=ge.value:me===o?(xe=Ae(ge.fname),we=e0.compileDependencies(ge.fname,we),we=e0.getArgsDeps(ge,we)):xe=Le(ge.previousGroup)}else xe=Le(ge.group);if(ge.group!==h&&!ge.power.equals(1)){let me=Ee(e.parse(ge.power));fe.push(me[1]),xe=`Math.pow${Mt(`${xe},${me[0]}`)}`}return xe&&a.push(be+xe),[a.join("*"),fe.join("").replace(/\n+\s+/gu," ")]};t&&(V=t);let Me=Ee(r);for(let ge in we[0]){if(!Object.hasOwn(we[0],ge))continue;let fe=we[0][ge];Me[1]=Me[1].replace(ge,fe),we[1]=we[1].replace(ge,fe)}return new Function(...V,`${(we[1]||"")+Me[1]} return ${Me[0]};`)}};re.classes.Build=e0;var s0={get _(){return re.parser},get Settings(){return re.settings},get SQRT(){return re.fnNames.SQRT},get ABS(){return re.fnNames.ABS},get PARENTHESIS(){return re.fnNames.PARENTHESIS},get FACTORIAL(){return re.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return re.fnNames.DOUBLEFACTORIAL},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get Parser(){return re.classes.Parser}},yt={parser:null,space:"~",dot:" \\cdot ",latex(r,t){let{_:e,P:o,CB:h}=s0;if(r&&typeof r=="object"&&"clone"in r&&typeof r.clone=="function"&&(r=r.clone()),r instanceof e.classes.Collection&&(r=r.elements),Dt(r)){let se=[];for(let ge=0;ge<r.length;ge++){let fe=r[ge];gt(fe)||(fe=e.parse(fe)),se.push(this.latex(fe,t))}return this.brackets(se.join(", "),"square")}if(St(r)){let se=`\\begin{pmatrix}
`;for(let ge=0;ge<r.elements.length;ge++){let fe=[],a=r.elements[ge];for(let Ne=0;Ne<a.length;Ne++)fe.push(this.latex(a[Ne],t));se+=fe.join(" & "),ge<r.elements.length-1&&(se+=`\\\\
`)}return se+="\\end{pmatrix}",se}if(vt(r)){let se="\\left[";for(let ge=0;ge<r.elements.length;ge++)se+=`${this.latex(r.elements[ge],t)} ${ge===r.elements.length-1?"":",\\,"}`;return se+="\\right]",se}if(bn(r)){let se="\\{";for(let ge=0;ge<r.elements.length;ge++)se+=`${this.latex(r.elements[ge],t)} ${ge===r.elements.length-1?"":",\\,"}`;return se+="\\}",se}r=r.clone();let y=t==="decimal"||t==="decimals",{power:L}=r,b=tn(L),k=r.multiplier.lessThan(0);if(r.group===o&&y){let se=Number(r.value),ge=Number(r.power.toDecimal()),fe=Number(r.multiplier.toDecimal());return String(fe*se**ge)}r.multiplier=r.multiplier.abs();let G;y?G=[String(r.multiplier.toDecimal()),""]:G=[r.multiplier.num,r.multiplier.den];let V=this.value(r,b,t,k),Y;b&&L.negate(),y?(Y=gt(L)?yt.latex(L,t):String(L.toDecimal()),String(Y)==="1"&&(Y="")):gt(L)?Y=this.latex(L,t):Y=this.formatFrac(L,!0);let we=["",""],Ee=b?1:0;return we[Ee]=Y,((k?"-":"")+this.set(G,V,we,r.group===h)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(r,t,e,o){let{SQRT:h,ABS:y,PARENTHESIS:L,FACTORIAL:b,DOUBLEFACTORIAL:k,FN:G,S:V,P:Y,N:we,CB:Ee,CP:Me,EX:se}=s0,{group:ge}=r,{previousGroup:fe}=r,a=["",""],Ne=t?1:0;if(r.isInfinity)a[Ne]="\\infty";else if(ge===V||ge===Y||fe===V||fe===Y||fe===we){let be=this.formatSubscripts(r.value);be.replace&&(be=be.replace(/(?<prefix>.+)_$/u,"$1\\_"));let Le=String(be).split("_"),Ae=this.greek[Le[0]];Ae&&(Le[0]=Ae,be=Le.join("_"));let xe=this.symbols[Le[0]];xe&&(Le[0]=xe,be=Le.join("_")),a[Ne]=be}else if(ge===G||fe===G){let be=[],{fname:Le}=r;for(let Ae=0;Ae<r.args.length;Ae++){let xe=r.args[Ae],me;typeof xe=="string"?me=xe:me=this.latex(xe,e),be.push(me)}if(Le===h)a[Ne]=`\\sqrt${this.braces(be.join(","))}`;else if(Le===y)a[Ne]=this.brackets(be.join(","),"abs");else if(Le===L)a[Ne]=this.brackets(be.join(","),"parens");else if(Le==="limit")a[Ne]=` \\lim\\limits_{${be[1]} \\to ${be[2]}} ${be[0]}`;else if(Le==="integrate")a[Ne]=`\\int${this.braces(be[0])}${this.braces(`d${be[1]}`)}`;else if(Le==="defint")a[Ne]=`\\int\\limits_${this.braces(be[1])}^${this.braces(be[2])} ${be[0]} d${be[3]}`;else if(Le===b||Le===k){let Ae=r.args[0];Ae.power.equals(1)&&(Ae.isComposite()||Ae.isCombination())&&(be[0]=this.brackets(be[0])),a[Ne]=be[0]+(Le===b?"!":"!!")}else if(Le==="floor")a[Ne]=`\\left \\lfloor${this.braces(be[0])}\\right \\rfloor`;else if(Le==="ceil")a[Ne]=`\\left \\lceil${this.braces(be[0])}\\right \\rceil`;else if(Le===s0.Settings.LOG&&be.length>1)a[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces(be[1])}${this.brackets(be[0])}`;else if(Le===s0.Settings.LOG10)a[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("10")}${this.brackets(be[0])}`;else if(Le===s0.Settings.LOG2)a[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("2")}${this.brackets(be[0])}`;else if(Le===s0.Settings.LOG1P)a[Ne]=`\\ln${this.brackets(`1 + ${be[0]}`)}`;else if(Le==="sum"){let Ae=be[0],xe=be[1],me=be[2],_e=be[3];a[Ne]=`\\sum\\limits_{${this.braces(xe)}=${this.braces(me)}}^${this.braces(_e)} ${this.braces(Ae)}`}else if(Le==="product"){let Ae=be[0],xe=be[1],me=be[2],_e=be[3];a[Ne]=`\\prod\\limits_{${this.braces(xe)}=${this.braces(me)}}^${this.braces(_e)} ${this.braces(Ae)}`}else if(Le==="nthroot")a[Ne]=`\\sqrt[${be[1]}]${this.braces(be[0])}`;else if(Le==="mod")a[Ne]=`${be[0]} \\bmod ${be[1]}`;else if(Le==="realpart")a[Ne]=`\\operatorname{Re}${this.brackets(be[0])}`;else if(Le==="imagpart")a[Ne]=`\\operatorname{Im}${this.brackets(be[0])}`;else{let Ae=Le===""?"":`\\mathrm${this.braces(Le.replace(/_/gu,"\\_"))}`;r.isConversion?a[Ne]=Ae+this.brackets(be.join(""),"parens"):a[Ne]=Ae+this.brackets(be.join(","),"parens")}}else if(r.isComposite()){let be=r.collectSymbols().sort(ge===Me||fe===Me?(_e,ye)=>ye.group-_e.group:(_e,ye)=>{let he=gt(_e.power)?-1:Number(_e.power);return(gt(ye.power)?-1:Number(ye.power))-he}),Le=[],Ae=be.length;for(let _e=0;_e<Ae;_e++)Le.push(yt.latex(be[_e],e));let xe=Le.join("+"),me=r;a[Ne]=!(me.isLinear()&&me.multiplier.equals(1))||o?this.brackets(xe,"parens"):xe}else if(ge===Ee||fe===se||fe===Ee){ge===Ee&&r.distributeExponent();let be=[],Le=[],Ae=[],xe=[],me=0,_e=0,ye=function(he,s,f){if(f>1&&s.length>0){let S=s.length;for(let _=0;_<S;_++){let c=s[_],m=he[c];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(m)||/^\\left\(.+\\right\)$/gu.test(m)||(he[c]=yt.brackets(m,"parens"))}}return he};r.each(he=>{let s=tn(he.power),f;s?(f=yt.latex(he.invert(),e),_e++,he.isComposite()&&(!r.multiplier.den.equals(1)&&Math.abs(Number(he.power))===1&&(f=yt.brackets(f,"parens")),Ae.push(be.length)),be.push(f)):(f=yt.latex(he,e),me++,he.isComposite()&&(!r.multiplier.num.equals(1)&&Math.abs(Number(he.power))===1&&(f=yt.brackets(f,"parens")),xe.push(Le.length)),Le.push(f))}),ye(Le,xe,me),a[0]=Le.join(this.dot),ye(be,Ae,_e),a[1]=be.join(this.dot)}return a},set(r,t,e,o){let h=function(we){return/^\\left\(.+\\right\)$/u.test(we)};e&&=this.formatP(e);let y;o&&(y=e[0],e[0]=""),t=this.merge(t,e);let L=r[0],b=r[1],k=t[0],G=t[1];k&&Number(L)===1&&(L=""),Number(b)===1&&(b="");let V=this.join(L,k,h(k)?"":this.dot),Y=this.join(b,G,h(G)?"":this.dot);if(V&&Y){let we=this.frac(V,Y);return o&&y&&(we=this.brackets(we)+y),we}return V},merge(r,t){let e=[];for(let o=0;o<2;o++)e[o]=r[o]+t[o];return e},join(r,t,e){return!r&&!t?"":r&&!t?r:t&&!r?t:r+e+t},formatSubscripts(r){let t=r.toString().split("_"),e="";for(;t.length>1;)t.length>0&&(e=`_${this.braces(t.pop()+e)}`);return t[0]+e},formatP(r){for(let t=0;t<2;t++){let e=r[t];e&&(r[t]=`^${this.braces(e)}`)}return r},formatFrac(r,t){let e=r.num.toString(),o=r.den.toString();return t&&e==="1"&&o==="1"?"":o==="1"?e:this.frac(e,o)},frac(r,t){return`\\frac${this.braces(r)}${this.braces(t)}`},braces(r){return`{${r}}`},brackets(r,t){t||="parens";let o={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[t];return`\\left${o[0]}${r}\\right${o[1]}`},filterTokens(r){let t=[];Dt(r)&&(t.type=r.type);let e=["\\","left","right","big","Big","large","Large"];for(let o=0,h=r.length;o<h;o++){let y=r[o],L=r[o+1];y.value==="\\"&&L.value==="\\"?t.push(y):Dt(y)?t.push(yt.filterTokens(y)):e.indexOf(y.value)===-1&&t.push(y)}return t},parse(r){let{SQRT:t}=s0,e,o,h="",y=this.filterTokens(r),L={cdot:"",times:"",infty:"Infinity"},b=function(V){return y[typeof V>"u"?++e:e+=V]},k=function(){return yt.parse(b())},G=function(V){return V in L?L[V]:V==="*"&&y[e+1].value==="&"?(b(2),","):V==="&"?(b(),","):V==="\\"?"],[":V};for(e=0,o=y.length;e<o;e++){let V=y[e];if(V.value==="frac"){let Y=k(),we=k();h+=`${Y}/${we}`}else if(V.value in yt.symbols)if(V.value===t&&y[e+1].type==="vector"&&y[e+2].type==="NerdamerSet"){let Y=k(),we=k();h+=`${we}^${Mt(`1/${Y}`)}`}else h+=V.value+k();else if(V.value==="int"){let Y=k();e++;let we=b().value;we=G(we.substring(1,we.length)),h+=`integrate${Mt(`${Y},${we}`)}`}else if(V.value==="int_"){let Y=k();e++;let we=b().value;we===void 0&&(e--,we=k());let Ee=k(),Me=b().value;Me===","&&(Me=b().value),Me==="differentialD"&&(e++,Me=b().value),Me==="mathrm"&&(e++,Me=b().value),h+=`defint${Mt(`${Ee},${Y},${we},${Me}`)}`}else if(V.value&&V.value.startsWith("int_")){let Y=V.value.replace("int_","");e++;let we=b().value;we===void 0&&(e--,we=k());let Ee=k(),Me=b().value;Me===","&&(Me=b().value),Me==="differentialD"&&(e++,Me=b().value),Me==="mathrm"&&(e++,Me=b().value),h+=`defint${Mt(`${Ee},${Y},${we},${Me}`)}`}else if(V.value==="mathrm"){let Y=y[++e][0].value;h+=Y+k()}else if(V.value==="sum_"||V.value==="prod_"){let Y=V.value==="sum_"?"sum":"product",we=b();e++;let Ee=k(),Me=k();h+=Y+Mt([Me,G(we[0]),G(we[2]),G(Ee)].join(","))}else if(V.value==="lim_"){let Y=b();h+=`limit${Mt([k(),G(Y[0]),G(Y[2])].join(","))}`}else if(V.value==="begin"){let Y=b();Array.isArray(Y)&&Y[0].value==="matrix"&&(h+="matrix([")}else if(V.value==="end"){let Y=b();Array.isArray(Y)&&Y[0].value==="matrix"&&(h+="])")}else Array.isArray(V)?h+=G(yt.parse(V)):h+=G(V.value.toString())}return Mt(h)},initParser(){let r=s0.Parser,t=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],e=new r;for(let h in e)t.indexOf(h)===-1&&delete e[h];e.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(h){return h}}),e.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(h){return h}});let o=e.getBrackets();o["{"].maps_to=void 0,this.parser=e}};re.classes.LaTeX=yt;var Fn={get LONG_PI(){return re.ext.LONG_PI},get LONG_E(){return re.ext.LONG_E}},Ie={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",get LONG_PI(){return Fn.LONG_PI},get LONG_E(){return Fn.LONG_E},PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800,initCache(){this.CACHE.roots={};let r=40,t=40;for(let e=2;e<=r;e++)for(let o=2;o<=t;o++){let h=Nn(e).pow(o);this.CACHE.roots[`${h}-${o}`]=e}}};Ie.CONST_HASH=re.fnNames.CONST_HASH;Ie.initCache();sn.Settings=Ie;var u0={get bigInt(){return re.ext.bigInt},get BIG_LOG_CACHE(){return re.ext.BIG_LOG_CACHE},get PRIMES(){return re.ext.PRIMES},get NerdamerSymbol(){return re.classes.NerdamerSymbol},get CB(){return re.groups.CB},get P(){return re.groups.P}},ut={csc(r){return 1/Math.sin(r)},sec(r){return 1/Math.cos(r)},cot(r){return 1/Math.tan(r)},acsc(r){return Math.asin(1/r)},asec(r){return Math.acos(1/r)},acot(r){return Math.PI/2-Math.atan(r)},erf(r){let t=1/(1+.5*Math.abs(r)),e=1-t*Math.exp(-r*r-1.26551223+t*(1.00002368+t*(.37409196+t*(.09678418+t*(-.18628806+t*(.27886807+t*(-1.13520398+t*(1.48851587+t*(-.82215223+t*.17087277)))))))));return r>=0?e:-e},diff(r){return function(o){return(r(o+.001)-r(o-.001))/.002}},median(...r){r.sort((e,o)=>e-o);let t=Math.floor(r.length/2);return r.length%2?r[t]:(r[t-1]+r[t])/2},fromContinued(r){let t=r.fractions.slice(),e=1/t.pop();for(let o=0,h=t.length;o<h;o++)e=1/(t.pop()+e);return r.sign*(r.whole+e)},continuedFraction(r,t){t||=20;let e=Math.sign(r),o=Math.abs(r),h=Math.floor(o),y=o-h,L=0,b=!1,k=1e-14,G=1e7,V,Y,we={whole:h,sign:e,fractions:[]};for(;!b&&y!==0&&(V=1/y,Y=Math.floor(V),!(Y>G&&ut.fromContinued(we)-r<=Number.EPSILON));)we.fractions.push(Y),y=V-Y,(y<=k||L>=t-1)&&(b=!0),L++;let Ee=we.fractions.length-1;return we.fractions[Ee]===1&&(we.fractions.pop(),we.fractions[--Ee]++),we},bigpow(r,t){r instanceof Ve||(r=Ve.create(r)),t instanceof Ve||(t=Ve.create(t));let e=new Ve(0);if(t.isInteger())e.num=r.num.pow(t.toString()),e.den=r.den.pow(t.toString());else{let o=Ve.create(r.num**t.num),h=Ve.create(r.den**t.num);e.num=ut.nthroot(o,t.den.toString()),e.den=ut.nthroot(h,t.den)}return e},gamma(r){let e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(r<.5)return Math.PI/(Math.sin(Math.PI*r)*ut.gamma(1-r));r-=1;let o=e[0];for(let y=1;y<9;y++)o+=e[y]/(r+y);let h=r+7+.5;return Math.sqrt(2*Math.PI)*h**(r+.5)*Math.exp(-h)*o},bigfactorial(r){let t=new u0.bigInt(1);for(let e=2;e<=r;e++)t=t.times(e);return new Ve(t)},bigLog(r){let t=u0.BIG_LOG_CACHE;if(t[r])return Ve.quick.apply(null,t[r].split("/"));r=new Ve(r);let e=80,o=new Ve(0),h=r.subtract(new Ve(1)),y=r.add(new Ve(1));for(let L=0;L<e;L++){let b=new Ve(2*L+1),k=ut.bigpow(h.divide(y),b),G=b.clone().invert().multiply(k);o=o.add(G)}return o.multiply(new Ve(2))},factorial(r){let t=r%1===0;if(t&&r<0)return NaN;if(!t)return ut.gamma(r+1);let e=1;for(let o=2;o<=r;o++)e*=o;return e},dfactorial(r){let t=new Ve(1);if(mt(r)){let e=r%2===0,o=e?r/2:(r+1)/2;if(e)for(let h=1;h<=o;h++)t=t.multiply(new Ve(2).multiply(new Ve(h)));else for(let h=1;h<=o;h++)t=t.multiply(new Ve(2).multiply(new Ve(h)).subtract(new Ve(1)))}else t=2**((1+2*r-Math.cos(Math.PI*r))/4)*Math.PI**((Math.cos(Math.PI*r)-1)/4)*ut.gamma(1+r/2);return t},GCD(...r){let t=An(r.map(h=>Math.abs(h))).sort(),e=Math.abs(t.shift()),o=t.length;for(;o-- >0;){let h=Math.abs(t.shift());for(;;){if(e%=h,e===0){e=h;break}if(h%=e,h===0)break}}return e},QGCD(...r){let t=r[0];for(let e=1;e<r.length;e++){let o=r[e],h=t.isNegative()&&o.isNegative()?-1:1;t=o.gcd(t),h<0&&t.negate()}return t},LCM(r,t){return r*t/ut.GCD(r,t)},pow(r,t){return r<0&&Math.abs(t)<1?1/t%2===0?NaN:-(Math.abs(r)**t):r**t},factor(r){r=Number(r);let t=Math.sign(r);r=Math.abs(r);let e=ut.ifactor(r),o=new u0.NerdamerSymbol;o.symbols={},o.group=u0.CB;for(let h in e){if(!Object.hasOwn(e,h))continue;let y=new u0.NerdamerSymbol(1);y.group=u0.P,y.value=h;let L=new u0.NerdamerSymbol(e[h]);y.power=L,o.symbols[h]=y}return o.updateHash(),r===1&&(o=new u0.NerdamerSymbol(r)),t<0&&o.negate(),o},sfactor(r,t){t||={};let e=Math.floor(Math.sqrt(r)),{PRIMES:o}=u0,h=o[o.length-1];e>h&&r<1e6&&i1(e);let y=o.length;for(let L=0;L<y;L++){let b=o[L];for(;r%b===0;)r/=b,t[b]=(t[b]||0)+1}return r>1&&(t[r]=1),t},ifactor(r){let{bigInt:t}=u0,e=new t(r),o=new t(String(r));if(o.equals(0))return{0:1};let h=o.isNegative()?-1:1;o=o.abs();let y={};if(o.lt("65536"))y=ut.sfactor(o,y);else{let L=function(b){b.isPrime()?y[b]=(y[b]||0)+1:y=ut.sfactor(b,y)};try{let k={value:0},G=function(V,Y,we){let Ee=new t(V),Me=2,se=new t(V),ge=new t(1);for(;ge.equals(1);){for(let fe=0;fe<=Me&&ge.equals(1);fe++){if(we.value++>1e3)throw new Error("stopping");se=se.pow(2).add(1).mod(Y),ge=t.gcd(se.minus(Ee).abs(),Y)}Me*=2,Ee=se}return ge.equals(Y)?G(V+1,Y,we):ge};for(;!o.abs().equals(1);)if(o.isPrime()){L(o);break}else{let V=G(2,o,k);L(V),o=o.divide(V)}}catch(b){if(b.message==="timeout")throw b;y={},L(e)}}if(h===-1){let L=Mn(Cn(y).map(Number));y[`-${L}`]=y[L],delete y[L]}return y},boxfactor(r,t){t||=200;let e,o,h=Math.floor(5/12*r),y=0,L=!1;for(;e=Math.floor(r/h),o=r%h,o!==0;){if(L)return[r,1];h=Math.max(o,h-o),y++,L=y>t}return[e,h,y]},fib(r){let t=Math.sign(r);r=Math.abs(r),t=Ut(r)?t:Math.abs(t);let e=0,o=1,h=1;for(let y=2;y<=r;y++)h=e+o,e=o,o=h;return h*t},mod(r,t){return r%t},integer_part(r){return Math.sign(r)*Math.floor(Math.abs(r))},simpson(r,t,e,o){let h=function(we,Ee,Me){let se=we(Ee),ge=1e-12;return isNaN(se)&&(se=we(Me===1?Ee+ge:Ee-ge)),se};o||=1e-4;let y=Math.abs(Math.floor((e-t)/o));y%2!==0&&y++;let L=(e-t)/y,b=h(r,t,1),k=!1,G=t+L,V,Y;for(let we=1;we<y;we++)V=k?2:4,Y=V*h(r,G,1),b+=Y,k=!k,G+=L;return(b+h(r,G,2))*(L/3)},num_integrate(r,t,e,o,h){if(h<0)throw new Error("max depth cannot be negative");function y(k,G,V,Y,we,Ee,Me,se,ge,fe,a){if(a.nanEncountered)return NaN;let Ne=V-G,be=k(G+Ne*.25),Le=k(V-Ne*.25);if(isNaN(be)){a.nanEncountered=!0;return}if(isNaN(Le)){a.nanEncountered=!0;return}let Ae=Ne*(Y+4*be+we)/12,xe=Ne*(we+4*Le+Ee)/12,me=Ae+xe,_e=(me-Me)/15;if(a.maxDepthCount>1e3*ge)return;if(fe>ge)return a.maxDepthCount++,me+_e;if(Math.abs(_e)<se)return me+_e;let ye=G+Ne*.5,he=y(k,G,ye,Y,be,we,Ae,se*.5,ge,fe+1,a);if(isNaN(he))return a.nanEncountered=!0,NaN;let s=y(k,ye,V,we,Le,Ee,xe,se*.5,ge,fe+1,a);return isNaN(s)?(a.nanEncountered=!0,NaN):he+s}function L(k,G,V,Y,we){let Ee={maxDepthCount:0,nanEncountered:!1};Y===void 0&&(Y=1e-9),we===void 0&&(we=45);let Me=k(G),se=k(.5*(G+V)),ge=k(V),fe=(Me+4*se+ge)*(V-G)/6,a=y(k,G,V,Me,se,ge,fe,Y,we,1,Ee);if(Ee.maxDepthCount>0&&In(`integrate-adaptive-simpson: Warning: maximum recursion depth (${we}) reached ${Ee.maxDepthCount} times`),Ee.nanEncountered)throw new Error("Function does not converge over interval!");return a}let b;try{b=L(r,t,e,o,h)}catch(k){if(k.message==="timeout")throw k;return ut.simpson(r,t,e)}return m0(b,12)},Ci(r){let e=.5772156649015329,o=0;for(let h=1;h<20;h++){let y=2*h;o+=(-1)**h*r**y/(y*ut.factorial(y))}return Math.log(r)+e+o},Si(r){let e=0;for(let o=0;o<20;o++){let h=2*o;e+=(-1)**o*r**(h+1)/((h+1)*ut.factorial(h+1))}return e},Ei(r){if(Number(r)===0)return-1/0;let t=30,e=.5772156649015329,o=0;for(let h=1;h<t;h++)o+=r**h/(h*ut.factorial(h));return e+Math.abs(Math.log(r))+o},Shi(r){let e=0,o,h;for(let y=0;y<30;y++)o=2*y,h=o+1,e+=r**h/(h*h*ut.factorial(o));return e},Chi(r){let e=.5772156649015329,o=function(h){return(Math.cosh(h)-1)/h};return Math.log(r)+e+ut.num_integrate(o,.002,r,.001)},Li(r){return ut.Ei(ut.bigLog(r))},gamma_incomplete(r,t){let e=r-1,o=0,h=t||0;for(let y=0;y<e;y++)o+=h**y/ut.factorial(y);return ut.factorial(e)*Math.exp(-h)*o},step(r){return r>0?1:r<0?0:.5},rect(r){let t=Math.abs(r);return t===.5?t:t>.5?0:1},sinc(r){return r.equals(0)?1:Math.sin(r)/r},tri(r){return r=Math.abs(r),r>=1?0:1-r},nthroot(r,t){if(r instanceof Ve||(r=new Ve(r.toString())),t instanceof Ve||(t=new Ve(t.toString())),t.equals(1))return r;let e=r.divide(new Ve(2)),o=new Ve(1e-15),h,y,L,b=t.clone().invert(),k=t.subtract(new Ve(1));do{let G=ut.bigpow(e,k),V=b.multiply(r.divide(G).subtract(e)).toDecimal(25);if(h=Ve.create(V),L)break;e=e.add(h),V=h.toDecimal(),L=y?y===V:!1,y=V}while(h.abs().gte(o));return e},sqrt(r){r instanceof Ve||(r=new Ve(r));let t,e,o,h,y=0,L=!1,b=new Ve(1e-20);t=r.divide(new Ve(2));let k=1e3;do{if(y>k)throw new Error(`Unable to calculate square root for ${r}`);t=t.add(r.divide(t)).divide(new Ve(2)),t=new Ve(t.decimal(30)),e=r.subtract(t.multiply(t)),h=o?o.equals(e):!1,(e.clone().abs().lessThan(b)||h)&&(L=!0),o=e,y++}while(!L);return t}};Ie.FUNCTION_MODULES.push(ut);k0(ut);sn.Math2=ut;function gt(r){return r instanceof re.classes.NerdamerSymbol}function vt(r){return r instanceof It}function St(r){return r instanceof xt}function r1(r){return r instanceof S0}var o0={get EX(){return re.groups.EX},get CP(){return re.groups.CP},get CB(){return re.groups.CB},get S(){return re.groups.S},get PL(){return re.groups.PL},get FN(){return re.groups.FN}};function n0(r,t=null,e=null){if(e||={c:[],add(o){this.c.indexOf(o)===-1&&isNaN(o)&&this.c.push(o)}},gt(r)){let{group:o}=r,h=r.previousGroup;if(o===o0.EX&&n0(r.power,t,e),o===o0.CP||o===o0.CB||h===o0.CP||h===o0.CB)for(let y in r.symbols)Object.hasOwn(r.symbols,y)&&n0(r.symbols[y],t,e);else if(o===o0.S||h===o0.S)r.value==="e"||r.value==="pi"||r.value===Ie.IMAGINARY||e.add(r.value);else if(o===o0.PL||h===o0.PL)n0(J0(r.symbols),t,e);else if(o===o0.EX)isNaN(Number(r.value))||e.add(r.value),n0(r.power,t,e);else if(o===o0.FN&&!t&&r.args)for(let y=0;y<r.args.length;y++)n0(r.args[y],t,e)}return e.c.sort()}function qi(r,t,e){let o=[];r.each(h=>{let y,L;h.contains(t)?(y=h.stripVar(t),L=bt._.divide(h.clone(),y.clone()).power.toDecimal()):(y=h,L=0);let b=o[L];o[L]=b?bt._.add(b,y):y},!0);for(let h=0;h<o.length;h++)o[h]||=new re.classes.NerdamerSymbol(0);return o}var Gt={get _(){return re.parser},get FN(){return re.groups.FN},get P(){return re.groups.P},get N(){return re.groups.N},get NerdamerSymbol(){return re.classes.NerdamerSymbol}};function Ti(r){let t,e,o;if(r.group===Gt.FN&&r.fname===""?(t=Gt.NerdamerSymbol.unwrapPARENS(Gt._.parse(r).toLinear()),e=Gt._.parse(r.power)):r.group===Gt.P&&(t=Gt._.parse(r.value),e=Gt._.parse(r.power)),t&&e&&t.group===Gt.N&&e.group===Gt.N&&t.multiplier.isNegative()){o=[];let y=Gt.NerdamerSymbol.toPolarFormArray(Nt(r))[0],L=Gt._.arg(t),b=e.multiplier.den.toString(),k=e.multiplier.num.toString(),G="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let V=0;V<Number(b);V++){let Y=Nt(Gt._.parse(qt("(({0})+2*pi*({1}))/({2})",L,V,b))).multiplier.toDecimal();o.push(Nt(Gt._.parse(qt(G,y,b,Ie.IMAGINARY,Y,k))))}return It.fromArray(o)}if(r.isConstant(!0,!0)){let h=r.sign(),y=Nt(r.abs()),L=Gt._.sqrt(y);o=[L.clone(),L.negate()],h<0&&(o=o.map(b=>Gt._.multiply(b,Gt.NerdamerSymbol.imaginary())))}else o=[Gt._.parse(r)];return It.fromArray(o)}function Ri(r,t,e){let h={},y;for(let L=0;L<e.length;L++)h[e[L]]=new re.classes.NerdamerSymbol(Math.floor(Math.random()*5)+1);return Bt("PARSE2NUMBER",()=>{y=bt._.parse(r,h).equals(bt._.parse(t,h))}),y}function _n(r){return gt(r)?_n(r.multiplier.toDecimal()):Number(r)%1!==0}function Li(r,t){let e=new re.classes.NerdamerSymbol(0);for(let o=0;o<r.length;o++){let h=r[o];e=bt._.add(e,gt(h)?h:bt._.parse(h))}return t?Number(e):e}function kn(r){for(let t=0;t<r.length;t++)if(!(r[t].isPi()||r[t].isE())&&!r[t].isConstant(!0))return!1;return!0}function Ui(r,t){t||=r.length;for(let e=0;e<t;e++)r[e]||(r[e]=new re.classes.NerdamerSymbol(0));return r}function tn(r){return gt(r)?r.multiplier.lessThan(0):typeof r=="object"&&"lessThan"in r?r.lessThan(0):r<0}var E0={get _(){return re.parser},get S(){return re.groups.S},get FN(){return re.groups.FN},get EX(){return re.groups.EX},get ABS(){return re.fnNames.ABS}};function s1(r,t){r=E0._.expand(r),t||={};let e=function(o,h){t[o]||=new re.classes.NerdamerSymbol(0),t[o]=E0._.add(t[o],h.clone())};return r.each(o=>{o.isConstant("all")?e("constants",o):o.group===E0.S?e(o.value,o):o.group===E0.FN&&(o.fname===E0.ABS||o.fname==="")?s1(o.args[0]):o.group===E0.EX||o.group===E0.FN||e(n0(o).join(" "),o)}),t}var z0={get _(){return re.parser},get CP(){return re.groups.CP}};function o1(r,t,e){t=String(t);let o,h;if(r.group===z0.CP){let b=z0._.expand(r.clone()).stripVar(t);o=z0._.subtract(r.clone(),b.clone()),h=b}else o=r.clone();let y=o.stripVar(t),L=z0._.divide(o.clone(),y.clone());return h||=new re.classes.NerdamerSymbol(0),e?{a:y,x:L,ax:o,b:h}:[y,L,o,h]}function Bn(r,t,e){(t.isComposite()&&!r.isComposite()||t.isLinear()&&!r.isLinear())&&([r,t]=[t,r]);let o=new re.classes.NerdamerSymbol(0);return r.isLinear()?r.each(h=>{if(t.isComposite())t.isLinear()?t.each(y=>{let L=bt._.multiply(bt._.parse(h),bt._.parse(y)),b=bt._.expand(bt._.parse(L),e);o=bt._.add(o,b)},!0):o=bt._.add(o,bt._.multiply(h,bt._.parse(t)));else{let y=bt._.multiply(bt._.parse(h),bt._.parse(t));o=bt._.add(o,bt._.expand(y,e))}},!0):o=bt._.multiply(r,t),o}function l1(r){if(Dt(r)){let t=new It([]);for(let e=0;e<r.length;e++)t.elements.push(l1(r[e]));return t}return gt(r)?r:bt._.parse(r)}function xi(r){let t=n0(r[0],null,null);for(let e=1,o=r.length;e<o;e++)t=t.concat(n0(r[e]));return t=An(t).sort(),t}function Pi(r){let e="u",o=0,h=n0(r);for(;!(i0.RESERVED.indexOf(e)===-1&&h.indexOf(e)===-1);)e="u"+o++;for(let y=0,L=i0.RESERVED.length;y<=L;y++)if(!i0.RESERVED[y]){i0.RESERVED[y]=e;break}return e}var p0={get _(){return re.parser},get C(){return re.core},get USER_FUNCTIONS(){return re.state.USER_FUNCTIONS}};function On(r,t,e){if(!t){let o=typeof r;if(o==="string"){let h=r;if(!/:?=/u.test(h))return!1;let y=Ie.FUNCTION_REGEX.exec(h);if(!y)return!1;let[,L,b,k]=y;r=L,t=b.split(",").map(G=>G.trim()),e=k}else if(o==="function"){let h=r,y=h.name;return w0(y),K0(y)?!1:(p0.C.Math2[y]=h,p0._.functions[y]=[void 0,h.length],p0.USER_FUNCTIONS.includes(y)||p0.USER_FUNCTIONS.push(y),!0)}else return!1}return r=r.trim(),w0(r),K0(r)?!1:(t||=n0(p0._.parse(e)),t=t.map(o=>o.trim()),p0._.functions[r]=[p0._.mappedFunction,t.length,{name:r,params:t,body:e}],p0.USER_FUNCTIONS.includes(r)||p0.USER_FUNCTIONS.push(r),!0)}var pn={get _(){return re.parser},get C(){return re.core},get USER_FUNCTIONS(){return re.state.USER_FUNCTIONS}};function $i(){for(let r of pn.USER_FUNCTIONS)delete pn.C.Math2[r],delete pn._.functions[r]}function Di(){let r={};for(let t in bt._.functions)Object.hasOwn(bt._.functions,t)&&(r[t]=bt._.functions[t][0]);return r}var Et={get bigInt(){return re.ext.bigInt},get isSymbol(){return re.utils.isSymbol},get isVector(){return re.utils.isVector},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get EX(){return re.groups.EX},get CUSTOM_OPERATORS(){return re.state.CUSTOM_OPERATORS}};function Xt(r,t=void 0,e=void 0,o=void 0){let h=t==="hash",y,L=h?void 0:t,b=L==="decimal"||L==="decimals"||L==="decimals_or_scientific";L==="decimals_or_scientific"&&typeof o>"u"&&(o=Ie.DEFAULT_DECP);function k(G,V){switch(t){case"decimals":case"decimal":return y||=function(Y){return!1},V?G.toDecimal(V):G.valueOf();case"recurring":{y||=function(Ae){return Ae.indexOf("'")!==-1};let Y=G.toString(),we=/^-?\d+(?:\/\d+)?$/u.exec(Y);if(we.length===0)return Y;let Ee=we[0].split("/"),Me=!1,se=Number(Ee[0]);se<0&&(se=-se,Me=!0);let ge=Number(Ee[1]);ge||=1;let fe=Math.floor(se/ge),a=10*(se-fe*ge);for(fe=`${fe.toString()}.`;a&&a<ge;)a*=10,fe+="0";let Ne="",be=[],Le=0;for(;;){if(typeof be[a]<"u"){let me=Ne.slice(0,be[a]),_e=Ne.slice(be[a]),ye=`${fe+me}'${_e}'`;return(Me?"-":"")+ye.replace("'0'","").replace(/\.$/u,"")}let Ae=Math.floor(a/ge),xe=a-Ae*ge;be[a]=Le,Ne+=Ae.toString(),Le+=1,a=10*xe}}case"mixed":{y||=function(be){return be.indexOf("/")!==-1};let Y=G.toString(),we=/^-?\d+(?:\/\d+)?$/u.exec(Y);if(we.length===0)return Y;let Ee=we[0].split("/"),Me=new Et.bigInt(Ee[0]),se=new Et.bigInt(Ee[1]);se.equals(0)&&(se=new Et.bigInt(1));let ge=Me.divmod(se),{quotient:fe}=ge,{remainder:a}=ge,Ne=Ee[0][0]==="-"||fe.equals(0)||a.equals(0)?"":"+";return(fe.equals(0)?"":fe.toString())+Ne+(a.equals(0)?"":`${a.toString()}/${Ee[1]}`)}case"scientific":return y||=function(Y){return!1},new D0(G.valueOf()).toString(Ie.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{y||=function(Ee){return!1};let Y=G.valueOf(),we=new D0(Y);return Math.abs(we.exponent)>=Ie.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?we.toString(Ie.SCIENTIFIC_MAX_DECIMAL_PLACES):V?G.toDecimal(V):Y}default:return y||=function(Y){return Y.indexOf("/")!==-1},G.toString()}}if(Et.isSymbol(r)){let G="",V="",Y="",we=r.group||e,{value:Ee}=r;if(!h){let a=k(r.multiplier);String(a)==="-1"&&String(r.multiplier)==="-1"&&(Y="-",a="1"),String(a)!=="1"&&(G=a);let Ne=r.power?k(r.power):"";String(Ne)!=="1"&&(gt(Ne)?V=Xt(Ne,L):V=Ne)}switch(we){case Et.N:{G="";let a;L==="decimals_or_scientific"?a=k(r.multiplier,o):o&&b?a=r.multiplier.toDecimal(o):a=k(r.multiplier),Ee=String(r.multiplier)==="-1"?"1":a,V="";break}case Et.PL:Ee=r.collectSymbols().map(a=>{let Ne=Xt(a,L,e,o);return Ne==="0"&&(Ne=""),Ne}).sort().join("+").replace(/\+-/gu,"-");break;case Et.CP:Ee=r.collectSymbols().map(a=>{let Ne=Xt(a,L,e,o);return Ne==="0"&&(Ne=""),Ne}).sort().join("+").replace(/\+-/gu,"-");break;case Et.CB:Ee=r.collectSymbols(a=>{let Ne=a.group;return(Ne===Et.PL||Ne===Et.CP)&&a.power.equals(1)&&a.multiplier.equals(1)?Mt(Xt(a,L)):Xt(a,L)}).join("*");break;case Et.EX:{let a=r.previousGroup,Ne=r.power.group;a===Et.PL&&(Ee=r.collectSymbols(Xt,L).join("+").replace("+-","-")),!(a===Et.N||a===Et.S||a===Et.FN)&&!h&&(Ee=Mt(Ee)),(Ne===Et.CP||Ne===Et.CB||Ne===Et.PL||r.power.multiplier.toString()!=="1")&&V&&(V=Mt(V));break}}if(we===Et.FN&&(Ee=r.fname+Mt(r.args.map(a=>Xt(a,L)).join(","))),we===Et.FN&&r.fname in Et.CUSTOM_OPERATORS){let a=Xt(r.args[0]),Ne=Xt(r.args[1]);r.args[0].isComposite()&&(a=Mt(a)),r.args[1].isComposite()&&(Ne=Mt(Ne)),Ee=a+Et.CUSTOM_OPERATORS[r.fname]+Ne}let Me=typeof y=="function"?y(V):!1;if(V&&we!==Et.EX&&Me&&(V=Mt(V)),((we===Et.CP||we===Et.PL)&&(G&&String(G)!=="1"||Y==="-")||(we===Et.CB||we===Et.CP||we===Et.PL)&&V&&String(V)!=="1"||!h&&we===Et.P&&String(Ee)==="-1"||r.fname===Ie.PARENTHESIS)&&(Ee=Mt(Ee)),o&&(t==="decimal"||(t==="decimals"||t==="decimals_or_scientific")&&G))if(G.toString().includes("e")){if(t!=="decimals_or_scientific"){let a=Number(G),Ne=a.toExponential(),be=a.toPrecision(o);G=Ne.length<be.length?Ne:be}}else G=m0(Number(G),o);let se=Y+G,ge=typeof y=="function"?y(G):!1;if(G&&ge&&(se=Mt(se)),Number(V)<0&&(V=Mt(V)),G&&(se=`${se}*`),V){if(Ee==="e"&&Ie.E_TO_EXP)return`${se}exp${Mt(V)}`;V=Ie.POWER_OPERATOR+V}we===Et.EX&&Ee.charAt(0)==="-"&&(Ee=Mt(Ee));let fe=se+Ee;return r.parens&&(fe=Mt(fe)),fe+V}if(Et.isVector(r)){let G=r.elements.length,V=[];for(let Y=0;Y<G;Y++)V.push(r.elements[Y].text(t));return`[${V.join(",")}]`}try{return r.toString()}catch(G){if(G.message==="timeout")throw G;return""}}var ce={get bigDec(){return re.ext.bigDec},get bigInt(){return re.ext.bigInt},get _(){return re.parser},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get EX(){return re.groups.EX},get CONST_HASH(){return re.fnNames.CONST_HASH},get isSymbol(){return re.utils.isSymbol},get text(){return re.utils.text},get variables(){return re.utils.variables},get SQRT(){return re.fnNames.SQRT},get PARENTHESIS(){return re.fnNames.PARENTHESIS}},W=class r{group;value;multiplier;power;args=void 0;fname=void 0;isImgSymbol=void 0;imaginary=void 0;isInfinity=void 0;constructor(t){en();let e=t==="Infinity";typeof t=="object"&&t!==null&&t instanceof ce.bigDec&&(t=t.toString());let o=String(t);/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(o)||typeof t=="object"&&t!==null&&t instanceof ce.bigDec?(this.group=ce.N,this.value=ce.CONST_HASH,this.multiplier=new Ve(t)):(this.group=ce.S,w0(t),this.value=t,this.multiplier=new Ve(1),this.imaginary=t===Ie.IMAGINARY,this.isInfinity=e),this.power=new Ve(1)}static imaginary(){let t=new r(Ie.IMAGINARY);return t.imaginary=!0,t}static infinity(t=void 0){let e=new r("Infinity");return t===-1&&e.negate(),e}static shell(t,e){let o=new r(e);return o.group=t,o.symbols={},o.length=0,o}static unwrapSQRT(t,e){let o=t.power;if(t.fname===Ie.SQRT&&(t.isLinear()||e)){let h=t.args[0].clone();h.power=h.power.multiply(new Ve(1/2)),h.multiplier=h.multiplier.multiply(t.multiplier),t=h,e&&(t.power=o.multiply(new Ve(1/2)))}return t}static hyp(t,e){t||=new r(0),e||=new r(0);let{_:o}=ce;return o.sqrt(o.add(o.pow(t.clone(),new r(2)),o.pow(e.clone(),new r(2))))}static toPolarFormArray(t){let e=t.realpart(),o=t.imagpart(),h=r.hyp(e,o),y=e.equals(0)?ce._.parse("pi/2"):ce._.trig.atan(ce._.divide(o,e));return[h,y]}static unwrapPARENS(t){if(t.fname===""){let e=t.args[0];return e.power=e.power.multiply(t.power),e.multiplier=e.multiplier.multiply(t.multiplier),t.fname===""?r.unwrapPARENS(e):e}return t}static create(t,e){e=e===void 0?1:e;let{_:o}=ce;return o.parse(`(${t})^(${e})`)}pushMinus(){let{_:t}=ce,e=this;if((this.group===ce.CB||this.group===ce.CP||this.group===ce.PL)&&this.multiplier.lessThan(0)&&!Ut(this.power)){e=this.clone();let o=e.multiplier.clone();o.negate(),e.toUnitMultiplier();for(let h in e.symbols)if(Object.hasOwn(e.symbols,h)&&(e.symbols[h]=e.symbols[h].clone().negate(),e.group===ce.CB))break;e.length>0&&e.each(h=>h.pushMinus()),e=t.parse(e),e=t.multiply(t.parse(o),e)}return e}getNth(t){let{_:e}=ce,o=e.parse(String(t)),h=Nt(e.pow(e.parse(this.multiplier),o.clone().invert())),y=e.parse(m0(h));return Nt(e.pow(y,o.clone())).equals(e.parse(this.multiplier))?y:h}isToNth(t){let{_:e}=ce,o=this.getNth(t),h=mt(o.multiplier.toDecimal()),y;return this.group===ce.CB?(y=!0,this.each(L=>{L.isToNth(t)||(y=!1)})):y=this.group===ce.N?!0:mt(e.divide(e.parse(this.power),e.parse(t))),h&&y}isSquare(){return this.isToNth(2)}isCube(){return this.isToNth(3)}isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)}powSimp(){let{_:t}=ce;if(this.group===ce.CB){let e=[],o=this.multiplier.sign();if(this.each(Y=>{let we=Y.power;ce.isSymbol(we)||we.equals(1)||e.push(we)}),e.length===0)return this.clone();let h=new Ve(Mn(e)),y=this.multiplier.clone().abs(),L=ut.ifactor(y.valueOf()),b=new Ve(1),k=new Ve(1);for(let Y in L){if(!Object.hasOwn(L,Y))continue;let we=new Ve(L[Y]);we.lessThan(h)||(we=we.divide(h).subtract(new Ve(1)),k=k.multiply(new Ve(Y))),b=b.multiply(t.parse(`${Mt(Y)}^${Mt(we)}`).multiplier)}let G=new r(k);this.each(Y=>{Y=Y.clone(),Y.power=Y.power.divide(h),G=t.multiply(G,Y)});let V=t.symfunction(ce.PARENTHESIS,[G]);return V.power=h,V.multiplier=o<0?b.negate():b,V}return this.clone()}equals(t){let e;return ce.isSymbol(t)?e=t:e=new r(t),this.value===e.value&&this.power.equals(e.power)&&this.multiplier.equals(e.multiplier)&&this.group===e.group}abs(){let t=this.clone();return t.multiplier.abs(),t}gt(t){ce.isSymbol(t)||(t=new r(t));let e=t;return this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)}gte(t){ce.isSymbol(t)||(t=new r(t));let e=t;return this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)}lt(t){ce.isSymbol(t)||(t=new r(t));let e=t;return this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)}lte(t){ce.isSymbol(t)||(t=new r(t));let e=t;return this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)}isPoly(t=!1){let e=this.group,o=this.power;if(!mt(o)||Number(o)<0)return!1;if(e===ce.N||e===ce.S||this.isConstant(!0))return!0;let h=ce.variables(this);if(e===ce.CB&&h.length===1){let y=h[0];if(!y)return!0;for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let b=this.symbols[L];if(b.group===ce.FN&&!b.args[0].isConstant()||!b.contains(y)&&!b.isConstant(!0))return!1}return!0}if(this.isComposite()||e===ce.CB&&t){if(!t&&h.length>1)return!1;for(let y in this.symbols)if(!this.symbols[y].isPoly(t))return!1;return!0}return!1}stripVar(t,e=!1){let{_:o}=ce,h;return(this.group===ce.PL||this.group===ce.S)&&this.value===t?h=new r(e?0:this.multiplier):this.group===ce.CB&&this.isLinear()?(h=new r(1),this.each(y=>{y.contains(t,!0)||(h=o.multiply(h,y.clone()))}),h.multiplier=h.multiplier.multiply(this.multiplier)):this.group===ce.CP&&!this.isLinear()?h=new r(this.multiplier):this.group===ce.CP&&this.isLinear()?(h=new r(0),this.each(y=>{if(!y.contains(t)){let L=y.clone();L.multiplier=L.multiplier.multiply(this.multiplier),h=o.add(h,L)}}),h.equals(0)&&(h=new r(this.multiplier))):this.group===ce.EX&&this.power.contains(t,!0)?h=new r(this.multiplier):this.group===ce.FN&&this.contains(t)?h=new r(this.multiplier):h=this.clone(),h}toArray(t,e){let{_:o}=ce;e||={arr:[],add(y,L){let b=this.arr[L];this.arr[L]=b?o.add(b,y):y}};let h=this.group;if(h===ce.S&&this.contains(t))e.add(new r(this.multiplier),this.power);else if(h===ce.CB){let y=this.stripVar(t),L=o.divide(this.clone(),y.clone()),b=L.isConstant()?0:L.power;e.add(y,b)}else if(h===ce.PL&&this.value===t)this.each((y,L)=>{e.add(y.stripVar(t),L)});else if(h===ce.CP)this.each(y=>{y.toArray(t,e)});else{if(this.contains(t))throw new En("Cannot convert to array! Exiting");e.add(this.clone(),0)}e=e.arr;for(let y=0;y<e.length;y++)e[y]||=new r(0);return e}hasFunc(t){let e=this.group===ce.FN||this.group===ce.EX;if(e&&!t||e&&this.contains(t))return!0;if(this.symbols){for(let o in this.symbols)if(this.symbols[o].hasFunc(t))return!0}return!1}sub(t,e){let{_:o}=ce;t=ce.isSymbol(t)?t.clone():o.parse(t),e=ce.isSymbol(e)?e.clone():o.parse(e),(t.group===ce.N||t.group===ce.P)&&Pt("Cannot substitute a number. Must be a variable");let h=!1,y=t.multiplier.equals(1),L=this.multiplier.clone(),b;if(this.value===t.value&&(this.group!==ce.PL&&t.group!==ce.PL||this.group===ce.PL&&t.group===ce.PL))(y||t.multiplier.equals(this.multiplier))&&(t.isLinear()?b=e:t.power.equals(this.power)&&(b=e,h=!0),t.multiplier.equals(this.multiplier)&&(L=new Ve(1)));else if(this.group===ce.CB||this.previousGroup===ce.CB)b=new r(1),this.each(k=>{let G=o.parse(k.sub(t,e));b=o.multiply(b,G)});else if(this.isComposite()){let k=this.clone();if(t.isComposite()&&k.isComposite()&&k.isLinear()&&t.isLinear()){let G=function(V,Y){for(let we in V.symbols){if(!Object.hasOwn(V.symbols,we))continue;let Ee=V.symbols[we];if(Ee.isComposite()&&G(Ee,Y)||Ee.equals(Y))return!0}return!1};for(let V in t.symbols)if(Object.hasOwn(t.symbols,V)&&!G(k,t.symbols[V]))return k.clone();b=o.add(o.subtract(k.clone(),t),e)}else b=new r(0),k.each(G=>{b=o.add(b,G.sub(t,e))})}else if(this.group===ce.EX)b=o.parse(this.value).sub(t,e);else if(this.group===ce.FN){let k=[];for(let G=0;G<this.args.length;G++){let V=this.args[G];ce.isSymbol(V)||(V=o.parse(V)),k.push(V.sub(t,e))}b=o.symfunction(this.fname,k)}if(b){if(!h){let k=this.group===ce.EX?this.power.sub(t,e):o.parse(this.power);b=o.pow(b,k)}return b.multiplier=b.multiplier.multiply(L),b}return this.clone()}isMonomial(){if(this.group===ce.S)return!0;if(this.group===ce.CB){for(let t in this.symbols)if(this.symbols[t].group!==ce.S)return!1}else return!1;return!0}isPi(){return this.group===ce.S&&this.value==="pi"}sign(){return this.multiplier.sign()}isE(){return this.value==="e"}isSQRT(){return this.fname===ce.SQRT}isConstant(t,e){if(e&&this.group===ce.CB){for(let o in this.symbols)if(this.symbols[o].isConstant(!0))return!0}if(t==="functions"&&this.isComposite()){let o=!0;return this.each(h=>{h.isConstant(t,e)||(o=!1)},!0),o}if(t==="all"&&(this.isPi()||this.isE()))return!0;if(t&&this.group===ce.FN){for(let o=0;o<this.args.length;o++)if(!this.args[o].isConstant(t))return!1;return!0}return t?q0(this):this.value===ce.CONST_HASH}isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let t in this.symbols)if(this.symbols[t].isImaginary())return!0}return!1}realpart(){let{_:t}=ce;if(this.isConstant())return this.clone();if(this.imaginary)return new r(0);if(this.isComposite()){let e=new r(0);return this.each(o=>{e=t.add(e,o.realpart())}),e}return this.isImaginary()?new r(0):this.clone()}imagpart(){let{_:t}=ce;if(this.group===ce.S&&this.isImaginary()){let e=this;return this.power.isNegative()&&(e=this.clone(),e.power.negate(),e.multiplier.negate()),new r(e.multiplier)}if(this.isComposite()){let e=new r(0);return this.each(o=>{e=t.add(e,o.imagpart())}),e}return this.group===ce.CB?this.stripVar(Ie.IMAGINARY):new r(0)}isInteger(){return this.isConstant()&&this.multiplier.isInteger()}isLinear(t){if(t){if(this.isConstant()||!this.contains(t,!0))return!0;if(this.group===ce.S)return this.value===t?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let e in this.symbols)if(!this.symbols[e].isLinear(t))return!1;return!0}return this.group===ce.CB?this.symbols[t]?this.symbols[t].isLinear(t):!0:!1}return this.power.equals(1)}containsFunction(t){if(typeof t=="string"&&(t=[t]),this.group===ce.FN&&t.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let e in this.symbols)if(this.symbols[e].containsFunction(t))return!0}return!1}multiplyPower(t){let{_:e}=ce;if(this.group===ce.N&&this.multiplier.equals(1))return this;let o=this.power;if(this.group!==ce.EX&&ce.isSymbol(t)&&t.group===ce.N){let h=t.multiplier;this.group===ce.N&&!h.isInteger()&&this.convert(ce.P),this.power=o.equals(1)?h.clone():o.multiply(h),this.group===ce.P&&mt(this.power)&&(this.value=String(Number(this.value)**Number(this.power)),this.toLinear(),this.convert(ce.N))}else{this.group!==ce.EX&&(o=new r(o),this.convert(ce.EX));let h=e.multiply(o,t);this.power=h}return this}setPower(t,e=!1){if(this.group===ce.N&&this.multiplier.equals(1))return this;if(this.group===ce.EX&&!ce.isSymbol(t))this.group=this.previousGroup,delete this.previousGroup,this.group===ce.N?(this.multiplier=new Ve(this.value),this.value=ce.CONST_HASH):this.power=t;else{let o=!1;ce.isSymbol(t)&&(t.group===ce.N?t=t.multiplier:o=!0);let h=o?ce.EX:ce.P;this.power=t,this.group===ce.N&&h&&this.convert(h,e)}return this}isInverse(){return this.group===ce.EX?this.power.multiplier.lessThan(0):Number(this.power)<0}clone(t=void 0){let e=this,o=t||new r(0),h=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],y=h.length,L;if(e.symbols){o.symbols={};for(let G in e.symbols)Object.hasOwn(e.symbols,G)&&(o.symbols[G]=e.symbols[G].clone())}for(L=0;L<y;L++)e[h[L]]!==void 0&&(o[h[L]]=e[h[L]]);o.power=e.power.clone(),o.multiplier=e.multiplier.clone();let b=e,k=o;return b.isConversion&&(k.isConversion=b.isConversion),b.isUnit&&(k.isUnit=b.isUnit),o}toUnitMultiplier(t=!1){return this.multiplier.num=new ce.bigInt(this.multiplier.num.isNegative()&&t?-1:1),this.multiplier.den=new ce.bigInt(1),this}toLinear(){return this.power.equals(1)?this:(this.setPower(new Ve(1)),this)}each(t,e=!1){if(this.symbols)for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let h=this.symbols[o];if(h.group===ce.PL&&e)for(let y in h.symbols)Object.hasOwn(h.symbols,y)&&t.call(o,h.symbols[y],y);else t.call(this,h,o)}else t.call(this,this,this.value)}valueOf(){return this.group===ce.N?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:ce.text(this,"decimals")}contains(t,e=!1){t=String(t);let o=this.group;if(this.value===t)return!0;if(this.symbols){for(let h in this.symbols)if(this.symbols[h].contains(t,e))return!0}if(o===ce.FN||this.previousGroup===ce.FN){for(let h=0;h<this.args.length;h++)if(this.args[h].contains(t,e))return!0}return o===ce.EX&&(e&&this.power.contains(t,e)||this.value===t)?!0:this.value===t}negate(){return this.multiplier.negate(),(this.group===ce.CP||this.group===ce.PL)&&this.distributeMultiplier(),this}invert(t=!1,e=!1){return t||(this.multiplier=this.multiplier.invert()),ce.isSymbol(this.power)?this.power.negate():this.group===ce.CB&&e?this.each(o=>o.invert()):this.power&&this.group!==ce.N&&this.power.negate(),this}distributeMultiplier(t=!1){let e=t?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&e&&this.group!==ce.CB&&!this.multiplier.equals(1)){for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let h=this.symbols[o];h.multiplier=h.multiplier.multiply(this.multiplier),h.distributeMultiplier()}this.toUnitMultiplier()}return this}distributeExponent(){let{_:t}=ce;if(!this.power.equals(1)){let e=this.power;for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let h=this.symbols[o];h.group===ce.EX?h.power=t.multiply(h.power,new r(e)):ce.isSymbol(this.symbols[o].power)?this.symbols[o].power=t.multiply(this.symbols[o].power,new r(e)):this.symbols[o].power=this.symbols[o].power.multiply(e)}this.toLinear()}return this}convert(t,e=void 0){if(t>ce.FN){let o=this.clone();this.symbols={},t===ce.CB?o.toUnitMultiplier():this.toUnitMultiplier(),this.group===ce.FN&&(o.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[o.keyForGroup(t)]=o,this.group=t,this.length=1}else if(t===ce.EX)this.group===ce.N&&this.multiplier.equals(1)||(this.group!==ce.EX&&(this.previousGroup=this.group),this.group===ce.N?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=ce.text(this,"hash"),this.group=ce.EX);else if(t===ce.N){let o=this.multiplier.toDecimal();this.symbols&&=void 0,new r(this.group===ce.P?Number(o)*Number(this.value)**Number(this.power):o).clone(this)}else t===ce.P&&this.group===ce.N&&(this.value=e?this.multiplier.num.toString():String(Math.abs(Number(this.multiplier.num.toString()))),this.toUnitMultiplier(!e),this.group=ce.P);return this}insert(t,e){let{_:o}=ce;if(ce.isSymbol(t)||Pt(`Object ${t} is not of type NerdamerSymbol!`),this.symbols){let{group:h}=this;if(h>ce.FN){let y=t.keyForGroup(h),L=y in this.symbols?this.symbols[y]:!1;if(e==="add"){let b=y;L?(this.symbols[b]=o.add(L,t),this.symbols[b].multiplier.equals(0)&&(delete this.symbols[b],this.length--,this.length===0&&(this.convert(ce.N),this.multiplier=new Ve(0)))):(this.symbols[y]=t,this.length++)}else t.group===ce.P&&mt(t.power)&&t.convert(ce.N),t.group===ce.EX?(t.parens=t.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(t.multiplier.clone().abs()),t.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(t.multiplier),t.toUnitMultiplier()),L&&(t=o.multiply(d0(this.symbols,y),t),t.isConstant()&&(this.multiplier=this.multiplier.multiply(t.multiplier),t=new r(1)),this.length--),t.isOne(!0)?t.multiplier.lessThan(0)&&this.negate():(this.symbols[y]=t,this.length++);this.length===0&&this.convert(ce.N),(this.group===ce.CP||this.group===ce.CB)&&this.updateHash()}}return this}attach(t){if(Dt(t)){for(let e=0;e<t.length;e++)this.insert(t[e],"add");return this}return this.insert(t,"add")}combine(t){if(Dt(t)){for(let e=0;e<t.length;e++)this.insert(t[e],"multiply");return this}return this.insert(t,"multiply")}updateHash(){if(this.group!==ce.N)if(this.group===ce.FN){let t="",{args:e}=this,o=this.fname===ce.PARENTHESIS;for(let y=0;y<e.length;y++)t+=(y===0?"":",")+ce.text(e[y]);let h=o?"":this.fname;this.value=h+(o?t:Mt(t))}else this.group===ce.S||this.group===ce.PL||(this.value=ce.text(this,"hash"))}keyForGroup(t){let e=this.group,o;if(e===ce.N)o=this.value;else if(e===ce.S||e===ce.P)t===ce.PL?o=this.power.toDecimal():o=this.value;else if(e===ce.FN)t===ce.PL?o=this.power.toDecimal():o=ce.text(this,"hash");else{if(e===ce.PL)return t===ce.CB?o=ce.text(this,"hash"):t===ce.CP?this.power.equals(1)?o=this.value:o=Mt(ce.text(this,"hash"))+Ie.POWER_OPERATOR+this.power.toDecimal():t===ce.PL?o=this.power.toString():o=this.value,o;e===ce.CP?(t===ce.CP&&(o=ce.text(this,"hash")),t===ce.PL?o=this.power.toDecimal():o=this.value):e===ce.CB?t===ce.PL?o=this.power.toDecimal():o=ce.text(this,"hash"):e===ce.EX&&(t===ce.PL?o=ce.text(this.power):o=ce.text(this,"hash"))}return o}collectSymbols(t,e,o,h){let y=[];if(this.symbols)for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let b=this.symbols[L];h&&(b.group===ce.PL||b.group===ce.CP)?y=y.concat(b.collectSymbols()):y.push(t?t(b,e):b)}else y.push(this);return o===null&&(o=void 0),y.sort(o)}collectSummandSymbols(t,e,o,h){let y=[];if(!this.symbols||this.group===ce.CB)y.push(this);else for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let b=this.symbols[L];h&&(b.group===ce.PL||b.group===ce.CP)?y=y.concat(b.collectSymbols()):y.push(t?t(b,e):b)}return o===null&&(o=void 0),y.sort(o)}latex(t){return yt.latex(this,t)}text(t=void 0){return ce.text(this,t)}isOne(t=!1){let e=t?"absEquals":"equals";return this.group===ce.N?this.multiplier[e](1):this.power.equals(0)}isComposite(){let t=this.group,e=this.previousGroup;return t===ce.CP||t===ce.PL||e===ce.PL||e===ce.CP}isCombination(){let t=this.group,e=this.previousGroup;return t===ce.CB||e===ce.CB}lessThan(t){return this.multiplier.lessThan(t)}greaterThan(t){return ce.isSymbol(t)||(t=new r(t)),!this.isConstant(!0)||!t.isConstant(!0)?!1:this.multiplier.greaterThan(t.multiplier)}getDenom(){let{_:t}=ce,e,o;if(o=this.clone(),this.group===ce.CB&&this.power.lessThan(0)&&(o=t.expand(o)),o.power.lessThan(0)||o.group===ce.EX&&o.power.multiplier.lessThan(0)){let h=t.parse(o.multiplier.den);e=o.toUnitMultiplier(),e.power.negate(),e=t.multiply(h,e)}else if(o.group===ce.CB){e=t.parse(o.multiplier.den);for(let h in o.symbols){if(!Object.hasOwn(o.symbols,h))continue;let y=o.symbols[h];(Number(y.power)<0||y.group===ce.EX&&y.power.multiplier.lessThan(0))&&(e=t.multiply(e,o.symbols[h].clone().invert()))}}else e=t.parse(o.multiplier.den);return e}getNum(){let{_:t}=ce,e,o;return o=this.clone(),o.group===ce.CB&&o.power.lessThan(0)&&(o=t.expand(o)),o.power.greaterThan(0)&&o.group!==ce.CB||o.group===ce.EX&&o.power.multiplier.greaterThan(0)?e=t.multiply(t.parse(o.multiplier.num),o.toUnitMultiplier()):o.group===ce.CB?(e=t.parse(o.multiplier.num),o.each(h=>{(Number(h.power)>0||h.group===ce.EX&&h.power.multiplier.greaterThan(0))&&(e=t.multiply(e,h.clone()))})):e=t.parse(o.multiplier.num),e}toString(){return this.text()}};re.classes.NerdamerSymbol=W;var nn=class{constructor(){let{N:t,P:e,S:o,EX:h,FN:y,PL:L,CB:b,CP:k}=bt,{SQRT:G,ABS:V,FACTORIAL:Y,DOUBLEFACTORIAL:we,PARENTHESIS:Ee}=bt,{bigDec:Me,PRIMES:se,VARS:ge}=bt,fe=this,a=fe,Ne={},be={names:[],actions:[]};class Le{upper;lower;constructor(i,l){this.upper=i,this.lower=l}isConstant(){let i=this.upper,l=this.lower;return i.isConstant()&&l.isConstant()}text(){return`${Xt(this.upper)}:${Xt(this.lower)}`}}class Ae{static OPERATOR="OPERATOR";static VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL";static FUNCTION="FUNCTION";static UNIT="UNIT";static KEYWORD="KEYWORD";static MAX_PRECEDENCE=999;constructor(i,l,v){if(this.type=l,this.value=i,v!==void 0&&(this.column=v+1),l===Ae.OPERATOR){let d=ye[i];for(let T in d)Object.hasOwn(d,T)&&(this[T]=d[T])}else l===Ae.FUNCTION&&(this.precedence=Ae.MAX_PRECEDENCE,this.leftAssoc=!1)}toString(){return this.is_prefix?`\`${this.value}`:this.value}}this.classes={Collection:t0,Slice:Le,Token:Ae};let xe={prec:void 0,cos(n,i){let l=a.parse(String(Math.cos(n)*Math.cosh(i))),v=a.parse(String(Math.sin(n)*Math.sinh(i)));return a.subtract(l,a.multiply(v,W.imaginary()))},sin(n,i){let l=a.parse(String(Math.sin(n)*Math.cosh(i))),v=a.parse(String(Math.cos(n)*Math.sinh(i)));return a.subtract(l,a.multiply(v,W.imaginary()))},tan(n,i){let l=a.parse(String(Math.sin(2*n)/(Math.cos(2*n)+Math.cosh(2*i)))),v=a.parse(String(Math.sinh(2*i)/(Math.cos(2*n)+Math.cosh(2*i))));return a.add(l,a.multiply(v,W.imaginary()))},sec(n,i){let l=this.removeDen(this.cos(n,i));return a.subtract(l[0],a.multiply(l[1],W.imaginary()))},csc(n,i){let l=this.removeDen(this.sin(n,i));return a.add(l[0],a.multiply(l[1],W.imaginary()))},cot(n,i){let l=this.removeDen(this.tan(n,i));return a.subtract(l[0],a.multiply(l[1],W.imaginary()))},acos(n,i){let l=this.fromArray([n,i]),v=a.pow(l.clone(),new W(2)),d=a.expand(v),T=a.multiply(Fe(a.subtract(new W(1),d)),W.imaginary()),E=a.expand(a.add(l.clone(),T)),I=B(E);return a.expand(a.multiply(W.imaginary().negate(),I))},asin(n,i){return a.subtract(a.parse("pi/2"),this.acos(n,i))},atan(n,i){if(n.equals(0)&&(i.equals(1)||i.equals(-1)))return a.parse(`${W.infinity()}*${Ie.IMAGINARY}*${i}`);let l=xe.fromArray([n,i]),v=a.expand(a.multiply(W.imaginary(),l.clone())),d=B(a.expand(a.subtract(new W(1),v.clone()))),T=B(a.expand(a.add(new W(1),v.clone())));return a.expand(a.multiply(a.divide(W.imaginary(),new W(2)),a.subtract(d,T)))},asec(n,i){let l=this.removeDen([n,i]);return l[1].negate(),this.acos(...l)},acsc(n,i){let l=this.removeDen([n,i]);return l[1].negate(),this.asin(...l)},acot(n,i){let l=this.removeDen([n,i]);return l[1].negate(),this.atan(...l)},cosh(n,i){let l=a.parse(String(Math.cosh(n)*Math.cos(i))),v=a.parse(String(Math.sinh(n)*Math.sin(i)));return a.add(l,a.multiply(v,W.imaginary()))},sinh(n,i){let l=a.parse(String(Math.sinh(n)*Math.cos(i))),v=a.parse(String(Math.cosh(n)*Math.sin(i)));return a.add(l,a.multiply(v,W.imaginary()))},tanh(n,i){let l=a.parse(String(Math.sinh(2*n)/(Math.cos(2*i)+Math.cosh(2*n)))),v=a.parse(String(Math.sin(2*i)/(Math.cos(2*i)+Math.cosh(2*n))));return a.subtract(l,a.multiply(v,W.imaginary()))},sech(n,i){let l=this.removeDen(this.cosh(n,i));return a.subtract(l[0],a.multiply(l[1],W.imaginary()))},csch(n,i){let l=this.removeDen(this.sinh(n,i));return a.subtract(l[0],a.multiply(l[1],W.imaginary()))},coth(n,i){let l=this.removeDen(this.tanh(n,i));return a.add(l[0],a.multiply(l[1],W.imaginary()))},acosh(n,i){let l=this.fromArray([n,i]),v=Fe(a.add(l.clone(),new W(1))),d=Fe(a.subtract(l.clone(),new W(1)));return a.expand(B(a.add(l,a.expand(a.multiply(v,d)))))},asinh(n,i){let l=this.fromArray([n,i]),v=Fe(a.add(new W(1),a.expand(a.pow(l.clone(),new W(2)))));return a.expand(B(a.add(l,v)))},atanh(n,i){let l=this.fromArray([n,i]),v=B(a.add(l.clone(),new W(1))),d=B(a.subtract(new W(1),l));return a.expand(a.divide(a.subtract(v,d),new W(2)))},asech(n,i){let l=this.removeDen([n,i]);return l[1].negate(),this.acosh(...l)},acsch(n,i){let l=this.removeDen([n,i]);return l[1].negate(),this.asinh(...l)},acoth(n,i){let l=this.removeDen([n,i]);return l[1].negate(),this.atanh(...l)},sqrt(n){let i=n.realpart(),l=n.imagpart(),v=W.hyp(i,l),d=a.add(i.clone(),v),T=Fe(a.multiply(new W(2),d.clone()));return a.add(a.divide(d.clone(),T.clone()),a.multiply(a.divide(l,T),W.imaginary()))},log(n,i){let l=B(W.hyp(n,i)),v=Ie.USE_BIG?new W(Me.atan2(i.multiplier.toDecimal(),n.multiplier.toDecimal())):Math.atan2(i,n),d=a.parse(v);return a.add(l,a.multiply(W.imaginary(),d))},erf(n,i){return a.symfunction("erf",[n])},removeDen(n){let i,l;Dt(n)?(i=n[0],l=n[1]):(i=n.realpart(),l=n.imagpart());let v=i**2+l**2,d=a.parse(String(i/v)),T=a.parse(String(l/v));return[d,T]},fromArray(n){return a.add(n[0],a.multiply(W.imaginary(),n[1]))},evaluate(n,i){let l,v,d=n.power.sign();if(n.power=n.power.abs(),n.power.greaterThan(1)&&(n=a.expand(n)),d<0){let T=this.removeDen(n);l=T[0],v=T[1]}else l=n.realpart(),v=n.imagpart();return l.isConstant("all")&&v.isConstant("all")?this[i](l,v):a.symfunction(i,[n])}},me=this.trig={cos(n){if(n.equals("pi")&&n.multiplier.den.equals(2))return new W(0);if(Ie.PARSE2NUMBER){if(n.equals(new W(Ie.PI/2)))return new W(0);if(n.isConstant())return Ie.USE_BIG?new W(Me.cos(n.multiplier.toDecimal())):new W(Math.cos(n.valueOf()));if(n.isImaginary())return xe.evaluate(n,"cos")}if(n.equals(0))return new W(1);let i,l=!1,v=J(n.multiplier.toDecimal()),d=n.multiplier.abs();if(n.multiplier=d,n.isPi()&&n.isLinear())if(mt(d))i=new W(Ut(d)?1:-1);else{let T=Number(d.num),E=Number(d.den);E===2?i=new W(0):E===3?(i=a.parse("1/2"),l=!0):E===4?(i=a.parse("1/sqrt(2)"),l=!0):E===6?(i=a.parse("sqrt(3)/2"),l=!0):i=a.symfunction("cos",[n])}return l&&(v===2||v===3)&&i.negate(),i||=a.symfunction("cos",[n]),i},sin(n){if(Ie.PARSE2NUMBER){if(n.isConstant())return Number(n.multiplier.toDecimal())%Math.PI===0?new W(0):Ie.USE_BIG?new W(Me.sin(n.multiplier.toDecimal())):new W(Math.sin(n.valueOf()));if(n.isImaginary())return xe.evaluate(n,"sin")}if(n.equals(0))return new W(0);let i,l=!1,v=J(n.multiplier.toDecimal()),d=n.multiplier.sign(),T=n.multiplier.abs();if(n.multiplier=T,n.equals("pi"))i=new W(0);else if(n.isPi()&&n.isLinear())if(mt(T))i=new W(0);else{let E=T.num,I=T.den;I.equals(2)?(i=new W(1),l=!0):I.equals(3)?(i=a.parse("sqrt(3)/2"),l=!0):I.equals(4)?(i=a.parse("1/sqrt(2)"),l=!0):I.equals(6)?(i=a.parse("1/2"),l=!0):i=a.multiply(new W(d),a.symfunction("sin",[n]))}return i||=a.multiply(new W(d),a.symfunction("sin",[n])),l&&(v===3||v===4)&&i.negate(),i},tan(n){if(Ie.PARSE2NUMBER){if(Number(n.multiplier.toDecimal())%Math.PI===0&&n.isLinear())return new W(0);if(n.isConstant())return Ie.USE_BIG?new W(Me.tan(n.multiplier.toDecimal())):new W(Math.tan(n.valueOf()));if(n.isImaginary())return xe.evaluate(n,"tan")}let i,l=!1,v=J(n.multiplier.toDecimal()),d=n.multiplier;if(n.multiplier=d,n.isPi()&&n.isLinear())if(mt(d))i=new W(0);else{let T=d.num,E=d.den;if(E.equals(2))throw new Ht(`tan is undefined for ${n.toString()}`);E.equals(3)?(i=a.parse("sqrt(3)"),l=!0):E.equals(4)?(i=new W(1),l=!0):E.equals(6)?(i=a.parse("1/sqrt(3)"),l=!0):i=a.symfunction("tan",[n])}return i||=a.symfunction("tan",[n]),l&&(v===2||v===4)&&i.negate(),i},sec(n){if(Ie.PARSE2NUMBER)return n.isConstant()?Ie.USE_BIG?new W(new Me(1).dividedBy(Me.cos(n.multiplier.toDecimal()))):new W(ut.sec(n.valueOf())):n.isImaginary()?xe.evaluate(n,"sec"):a.parse(qt("1/cos({0})",n));let i,l=!1,v=J(n.multiplier.toDecimal()),d=n.multiplier.abs();if(n.multiplier=d,n.isPi()&&n.isLinear())if(mt(d))i=new W(Ut(d)?1:-1);else{let T=d.num,E=d.den;if(E.equals(2))throw new Ht(`sec is undefined for ${n.toString()}`);E.equals(3)?(i=new W(2),l=!0):E.equals(4)?(i=a.parse("sqrt(2)"),l=!0):E.equals(6)?(i=a.parse("2/sqrt(3)"),l=!0):i=a.symfunction("sec",[n])}return l&&(v===2||v===3)&&i.negate(),i||=a.symfunction("sec",[n]),i},csc(n){if(Ie.PARSE2NUMBER)return n.isConstant()?Ie.USE_BIG?new W(new Me(1).dividedBy(Me.sin(n.multiplier.toDecimal()))):new W(ut.csc(n.valueOf())):n.isImaginary()?xe.evaluate(n,"csc"):a.parse(qt("1/sin({0})",n));let i,l=!1,v=J(n.multiplier.toDecimal()),d=n.multiplier.sign(),T=n.multiplier.abs();if(n.multiplier=T,n.isPi()&&n.isLinear()){if(mt(T))throw new Ht(`csc is undefined for ${n.toString()}`);{let E=T.num,I=T.den;I.equals(2)?(i=new W(1),l=!0):I.equals(3)?(i=a.parse("2/sqrt(3)"),l=!0):I.equals(4)?(i=a.parse("sqrt(2)"),l=!0):I.equals(6)?(i=new W(2),l=!0):i=a.multiply(new W(d),a.symfunction("csc",[n]))}}return i||=a.multiply(new W(d),a.symfunction("csc",[n])),l&&(v===3||v===4)&&i.negate(),i},cot(n){if(Ie.PARSE2NUMBER)return Number(n.multiplier.toDecimal())%(Math.PI/2)===0?new W(0):n.isConstant()?Ie.USE_BIG?new W(new Me(1).dividedBy(Me.tan(n.multiplier.toDecimal()))):new W(ut.cot(n.valueOf())):n.isImaginary()?xe.evaluate(n,"cot"):a.parse(qt("1/tan({0})",n));let i,l=!1,v=J(n.multiplier.toDecimal()),d=n.multiplier;if(n.multiplier=d,n.isPi()&&n.isLinear()){if(mt(d))throw new Ht(`cot is undefined for ${n.toString()}`);{let T=d.num,E=d.den;E.equals(2)?i=new W(0):E.equals(3)?(i=a.parse("1/sqrt(3)"),l=!0):E.equals(4)?(i=new W(1),l=!0):E.equals(6)?(i=a.parse("sqrt(3)"),l=!0):i=a.symfunction("cot",[n])}}return i||=a.symfunction("cot",[n]),l&&(v===2||v===4)&&i.negate(),i},acos(n){if(Ie.PARSE2NUMBER){if(n.isConstant()){if(n.gt(1)||n.lt(-1)){let i=n.toString();return ae(Nt(`pi/2-asin(${i})`))}return Ie.USE_BIG?new W(Me.acos(n.multiplier.toDecimal())):new W(Math.acos(n.valueOf()))}if(n.isImaginary())return xe.evaluate(n,"acos")}return a.symfunction("acos",[n])},asin(n){if(Ie.PARSE2NUMBER){if(n.isConstant()){if(n.gt(1)||n.lt(-1)){let i=Ie.IMAGINARY,l=n.multiplier.toDecimal();return ae(Nt(`${i}*log(sqrt(1-${l}^2)-${i}*${l})`))}return Ie.USE_BIG?new W(Me.asin(n.multiplier.toDecimal())):new W(Math.asin(n.valueOf()))}if(n.isImaginary())return xe.evaluate(n,"asin")}return a.symfunction("asin",[n])},atan(n){let i;if(n.equals(0))i=new W(0);else{if(Ie.PARSE2NUMBER)return n.isConstant()?Ie.USE_BIG?new W(Me.atan(n.multiplier.toDecimal())):new W(Math.atan(n.valueOf())):n.isImaginary()?xe.evaluate(n,"atan"):a.symfunction("atan",[n]);n.equals(-1)?i=a.parse("-pi/4"):i=a.symfunction("atan",[n])}return i},asec(n){if(Ie.PARSE2NUMBER){if(n.equals(0))throw new hn("Input is out of the domain of sec!");if(n.isConstant())return me.acos(n.invert());if(n.isImaginary())return xe.evaluate(n,"asec")}return a.symfunction("asec",[n])},acsc(n){if(Ie.PARSE2NUMBER){if(n.isConstant())return me.asin(n.invert());if(n.isImaginary())return xe.evaluate(n,"acsc")}return a.symfunction("acsc",[n])},acot(n){if(Ie.PARSE2NUMBER){if(n.isConstant())return a.add(a.parse("pi/2"),me.atan(n).negate());if(n.isImaginary())return xe.evaluate(n,"acot")}return a.symfunction("acot",[n])},atan2(n,i){if(n.equals(0)&&i.equals(0))throw new Ht("atan2 is undefined for 0, 0");return Ie.PARSE2NUMBER&&n.isConstant()&&i.isConstant()?new W(Math.atan2(n,i)):a.symfunction("atan2",[n,i])}},_e=this.trigh={cosh(n){if(Ie.PARSE2NUMBER){if(n.isConstant())return new W(Math.cosh(n.valueOf()));if(n.isImaginary())return xe.evaluate(n,"cosh")}return a.symfunction("cosh",[n])},sinh(n){if(Ie.PARSE2NUMBER){if(n.isConstant())return new W(Math.sinh(n.valueOf()));if(n.isImaginary())return xe.evaluate(n,"sinh")}return a.symfunction("sinh",[n])},tanh(n){if(Ie.PARSE2NUMBER){if(n.isConstant())return new W(Math.tanh(n.valueOf()));if(n.isImaginary())return xe.evaluate(n,"tanh")}return a.symfunction("tanh",[n])},sech(n){return Ie.PARSE2NUMBER?n.isConstant()?new W(Math.sech(n.valueOf())):n.isImaginary()?xe.evaluate(n,"sech"):a.parse(qt("1/cosh({0})",n)):a.symfunction("sech",[n])},csch(n){return Ie.PARSE2NUMBER?n.isConstant()?new W(Math.csch(n.valueOf())):n.isImaginary()?xe.evaluate(n,"csch"):a.parse(qt("1/sinh({0})",n)):a.symfunction("csch",[n])},coth(n){return Ie.PARSE2NUMBER?n.isConstant()?new W(Math.coth(n.valueOf())):n.isImaginary()?xe.evaluate(n,"coth"):a.parse(qt("1/tanh({0})",n)):a.symfunction("coth",[n])},acosh(n){let i;return Ie.PARSE2NUMBER&&n.isImaginary()?i=xe.evaluate(n,"acosh"):Ie.PARSE2NUMBER?i=Nt(a.parse(qt(`${Ie.LOG}(({0})+sqrt(({0})^2-1))`,n.toString()))):i=a.symfunction("acosh",[n]),i},asinh(n){let i;return Ie.PARSE2NUMBER&&n.isImaginary()?i=xe.evaluate(n,"asinh"):Ie.PARSE2NUMBER?i=Nt(a.parse(qt(`${Ie.LOG}(({0})+sqrt(({0})^2+1))`,n.toString()))):i=a.symfunction("asinh",[n]),i},atanh(n){let i;return Ie.PARSE2NUMBER&&n.isImaginary()?i=xe.evaluate(n,"atanh"):Ie.PARSE2NUMBER?i=Nt(a.parse(qt(`(1/2)*${Ie.LOG}((1+({0}))/(1-({0})))`,n.toString()))):i=a.symfunction("atanh",[n]),i},asech(n){let i;return Ie.PARSE2NUMBER&&n.isImaginary()?i=xe.evaluate(n,"asech"):Ie.PARSE2NUMBER?i=Nt(B(a.add(n.clone().invert(),Fe(a.subtract(a.pow(n,new W(-2)),new W(1)))))):i=a.symfunction("asech",[n]),i},acsch(n){let i;return Ie.PARSE2NUMBER&&n.isImaginary()?i=xe.evaluate(n,"acsch"):Ie.PARSE2NUMBER?i=Nt(a.parse(qt(`${Ie.LOG}((1+sqrt(1+({0})^2))/({0}))`,n.toString()))):i=a.symfunction("acsch",[n]),i},acoth(n){let i;if(Ie.PARSE2NUMBER&&n.isImaginary())i=xe.evaluate(n,"acoth");else if(Ie.PARSE2NUMBER)if(n.equals(1))i=W.infinity();else{let l=B(a.divide(a.add(n.clone(),new W(1)),a.subtract(n.clone(),new W(1))));i=Nt(a.divide(l,new W(2)))}else i=a.symfunction("acoth",[n]);return i}};this.units={};let ye={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(n){return n}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(n){return a.symfunction(Ie.DOUBLEFACTORIAL,[n])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(n){return $(n)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(n){return a.divide(n,new W(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},he={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},s=this.functions={cos:[me.cos,1],sin:[me.sin,1],tan:[me.tan,1],sec:[me.sec,1],csc:[me.csc,1],cot:[me.cot,1],acos:[me.acos,1],asin:[me.asin,1],atan:[me.atan,1],arccos:[me.acos,1],arcsin:[me.asin,1],arctan:[me.atan,1],asec:[me.asec,1],acsc:[me.acsc,1],acot:[me.acot,1],atan2:[me.atan2,2],acoth:[_e.acoth,1],asech:[_e.asech,1],acsch:[_e.acsch,1],sinh:[_e.sinh,1],cosh:[_e.cosh,1],tanh:[_e.tanh,1],asinh:[_e.asinh,1],sech:[_e.sech,1],csch:[_e.csch,1],coth:[_e.coth,1],acosh:[_e.acosh,1],atanh:[_e.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[Ue,1],radians:[De,1],degrees:[Je,1],min:[P,-1],max:[p,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[ve,1],tri:[void 0,1],sign:[w,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[$,1],factorial:[$,1],continuedFraction:[Q,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[Z,[1,2]],scientific:[Xe,[1,2]],mod:[ne,2],pfactor:[z,1],vector:[ft,-1],matrix:[At,-1],NerdamerSet:[$t,-1],imatrix:[de,-1],parens:[q,-1],sqrt:[Fe,1],cbrt:[$e,1],nthroot:[ke,2],log:[B,[1,2]],expand:[te,1],abs:[F,1],invert:[Vt,1],determinant:[Tt,1],size:[pt,1],transpose:[Ot,1],dot:[Ft,2],cross:[_t,2],vecget:[Be,2],vecset:[ze,3],vectrim:[Te,[1,2]],matget:[We,3],matset:[ct,4],matgetrow:[je,2],matsetrow:[et,3],matgetcol:[He,2],matsetcol:[lt,3],rationalize:[qe,1],IF:[pe,3],isIn:[Se,2],realpart:[j,1],imagpart:[X,1],conjugate:[D,1],arg:[ee,1],polarform:[O,1],rectform:[x,1],sort:[U,[1,2]],integer_part:[void 0,1],union:[Jt,2],contains:[Yt,2],intersection:[c0,2],difference:[r0,2],intersects:[Kt,2],isSubset:[v0,2],primes:[u,2],print:[N,-1]};this.error=Pt;let f=function(n){let i=Ie.FUNCTION_MODULES,l=i.length;for(let v=0;v<l;v++){let d=i[v];if(n in d)return d[n]}return Pt(`The function ${n} is undefined!`)};this.override=function(i,l){Ne[i]||=[],Ne[i].push(this[i]),this[i]=l},this.restore=function(i){this[i]&&=Ne[i].pop()},this.extend=function(i,l,v){let d=this;if(typeof this[i]=="function"&&typeof l=="function"){let E=this[i];this[i]=function(H,oe){return gt(H)&&gt(oe)&&!v?E.call(d,H,oe):l.call(d,H,oe,E)}}},this.symfunction=function(i,l){let v=new W(i);return v.group=y,typeof l=="object"&&(l=[].slice.call(l)),v.args=l,v.fname=i===Ee?"":i,v.updateHash(),v},this.callfunction=function(i,l,v=void 0){let d=s[i];d||Pt(`Nerdamer currently does not support the function ${i}`);let T=d[1]||v,E=d[0],I;if(l instanceof Array||(l=l===void 0?[]:[l]),T!==-1){let oe=Dt(T),ue=oe?T[0]:T,Oe=oe?T[1]:T,Pe=l.length,Ce=`${i} requires a {0} of {1} arguments. {2} provided!`;Pe<ue&&Pt(qt(Ce,"minimum",ue,Pe)),Pe>Oe&&Pt(qt(Ce,"maximum",Oe,Pe))}let H=un(l);return E?I=E.apply(d[2],l):(E=f(i),Ie.PARSE2NUMBER&&H?I=ie(E.apply(E,l)):I=a.symfunction(i,l)),I},this.operator_filter_regex=(function(){let i=`^\\${Object.keys(ye).filter(l=>l.length===1).join("\\")}`;return new RegExp(`([${i}])\\s+([${i}])`)})(),this.setOperator=function(i,l=void 0,v=void 0){let d=i.operator;if(ye[d]=i,l&&(this[i.action]=l),fe[d]=i.operation,!i.action&&!(i.prefix||i.postif)&&(i.action=d),v==="over"||v==="under"){let{precedence:T}=i;for(let E in ye){if(!Object.hasOwn(ye,E))continue;let I=ye[E];(v==="over"?I.precedence>=T:I.precedence>T)&&I.precedence++}}},this.getOperator=function(i){return ye[i]},this.aliasOperator=function(i,l){let v={},d=ye[i];for(let T in d)Object.hasOwn(d,T)&&(v[T]=d[T]);v.operator=l,this.setOperator(v)},this.getOperators=function(){return ye},this.getBrackets=function(){return he};let S=function(i,l){i=String(i);for(let v=0;v<be.actions.length;v++)i=be.actions[v].call(l,i);for(i=i.replace(/\s+/gu," "),/e/giu.test(i)&&(i=i.replace(/-+\d+\.?\d*e\+?-?\d+/giu,v=>F0(v)),i=i.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,v=>F0(v))),i=i.replace(Ie.IMPLIED_MULTIPLICATION_REGEX,(v,d,T,E,I)=>{let H=I.charAt(E),oe="",ue="*";return H.match(/[+\-/*]/u)||(oe=I.charAt(E-1)),oe.match(/[a-z]/iu)&&(ue=""),d+ue+T}).replace(/(?<varname>[a-z0-9_]+)/giu,(v,d)=>Ie.USE_MULTICHARACTER_VARS===!1&&!(d in s)&&isNaN(d)?d.split("").join("*"):d).replace(/\)\(/gu,")*(")||"0";;){let v=i;if(i=i.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,(d,T,E,I,H)=>{let oe=T||I,ue=E||H;return oe in s?oe+ue:`${oe}*${ue}`}),v===i)break}return i};this.initConstants=function(){this.CONSTANTS={E:new W(Ie.E),PI:new W(Ie.PI)}},this.prettyPrint=function(i){if(Array.isArray(i)){let l=i,v=l.map(d=>a.prettyPrint(d)).join(", ");return l.type==="vector"?`vector<${v}>`:`(${v})`}return i.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(i,...l){if(Ie.callPeekers){let v=this.peekers[i],d=l.map(T1);for(let T=0;T<v.length;T++)v[T].apply(null,d)}},this.tokenize=function(i){i=String(i),i=i.trim().replace(/\s+/gu," ");for(let tt in he){if(!Object.hasOwn(he,tt))continue;let nt=new RegExp(he[tt].is_close?`\\s+\\${tt}`:`\\${tt}\\s+`,"gu");i=i.replace(nt,tt)}let l=0,v=i.length,d=0,T=[],E=[T],I=E[0],H=0,oe=[],ue=!1,Oe,Pe=" ",Ce="",Ge=",",st="-",Ct="*",Qe=function(tt=void 0,nt=void 0){let it=[];tt!==void 0&&(it.type=tt),it.column=nt,E.push(it),I.push(it),I=it,H++},Re=function(){E.pop(),I=E[--H]},Ke=function(tt){tt=tt===void 0?l:tt;let nt=tt+1;for(;i.charAt(nt++)in ye;);return i.substring(tt,nt-1)},Ze=function(tt){let nt=l-tt.length,it=[],zt=tt.charAt(0),U0=tt.length,a0;for(a0=1;a0<U0;a0++){let b0=tt.charAt(a0),G0=zt+b0;G0 in ye?zt=G0:(it.push(new Ae(zt,Ae.OPERATOR,nt+a0)),zt=b0)}return it.push(new Ae(zt,Ae.OPERATOR,nt+a0)),it},Ye=function(tt,nt=void 0){nt===void 0&&(nt=i.substring(d,tt)),nt in a.units?I.push(new Ae(nt,Ae.UNIT,d)):nt!==""&&I.push(new Ae(nt,Ae.VARIABLE_OR_LITERAL,d))},at=function(tt){I.push(new Ae(tt,Ae.FUNCTION,d))},dt=function(tt){d=tt+1},ht=function(){d=d+Oe.length-2,l=d-1};for(;l<v;l++){let tt=i.charAt(l);if(tt in ye){Ye(l);let it=I[0]&&zn(I[0])&&tt===Ct;ue&&d<l&&!(tt===Ge||it)&&(ue=!1,Re()),dt(l+1),Oe=Ke(l),ht(),I.push(...Ze(Oe))}else if(tt in he){let nt=he[tt];if(nt.is_open){oe.push([nt,d]);let it=i.substring(d,l);it in s?at(it):it!==""&&I.push(new Ae(it,Ae.VARIABLE_OR_LITERAL,d)),Qe(nt.maps_to,l)}else if(nt.is_close){let it=oe.pop();if(it){if(it[0].id!==nt.id-1)throw new W0("Parity error")}else throw new W0(`Missing open bracket for bracket at: ${l+1}`);Ye(l),Re()}dt(l)}else if(tt===Pe){let nt=i.substring(d,l),it=i.charAt(l+1);if(ue){if(nt in ye)I.push(new Ae(nt,Ae.OPERATOR,l));else{Ye(void 0,nt),Re();let zt=it in ye;(zt&&ye[it].value===st||!zt)&&I.push(new Ae(Ct,Ae.OPERATOR,l))}ue=!1}else{let zt=i.substring(d,l);zt in s?(ue=!0,at(zt),Qe()):zt in ye?I.push(new Ae(zt,Ae.OPERATOR,l)):(Ye(void 0,zt),it=i.charAt(l+1),nt!==Ce&&it!==Ce&&!(nt in ye)&&!(it in ye)&&I.push(new Ae(Ct,Ae.OPERATOR,l)))}dt(l)}}if(oe.length){let tt=oe.pop();throw new W0(`Missing closed bracket for bracket at ${tt[1]+1}`)}return Ye(l),T},this.toRPN=function(i){let l=i.type,v=i.length,d,T,E=[],I=[],H=[],oe=function(Oe,Pe){for(;Oe.length;)Pe.push(Oe.pop())};for(d=0;d<v;d++){let ue=i[d];if(ue.type!==Ae.OPERATOR)break;if(!ue.prefix)throw new _0("Not a prefix operator");ue.is_prefix=!0,I.push(ue)}for(;d<v;d++){if(T=i[d],T.type===Ae.OPERATOR){let ue=T;if(ue.overloaded){let Oe=i[d+1];Oe&&Oe.type===Ae.VARIABLE_OR_LITERAL&&(ue.postfix=!1,ue.action=ue.overloadAction,ue.leftAssoc=ue.overloadLeftAssoc)}for(;I.length;){let Oe=I[I.length-1];if(!(Oe.precedence>ue.precedence||!ue.leftAssoc&&Oe.precedence===ue.precedence))break;E.push(I.pop())}if((l==="vector"||l==="set")&&"vectorFn"in ue&&(ue.action=ue.vectorFn),ue.postfix){let Oe=i[d-1];if(Oe){if(Oe.type===Ae.OPERATOR&&!Oe.postfix)throw new _0(`Unexpected prefix operator '${Oe.value}'! at ${Oe.column}`)}else throw new _0(`Unexpected prefix operator '${T.value}'! at ${T.column}`)}else{let Oe;do{let Pe=i[d+1];if(Oe=Pe?Pe.type===Ae.OPERATOR:!1,Oe){if(!Pe.prefix)throw new _0(`A prefix operator was expected at ${Pe.column}`);Pe.is_prefix=!0,H.push(Pe),d++}}while(Oe)}for(ue.is_prefix?H.push(ue):I.push(ue);H.length&&(ue.leftAssoc||!ue.leftAssoc&&H[H.length-1].precedence>=ue.precedence);)I.push(H.pop())}else if(T.type===Ae.VARIABLE_OR_LITERAL){E.length===0&&oe(H,I),E.push(T);let ue=I[I.length-1];(!ue||!ue.leftAssoc)&&oe(H,E)}else T.type===Ae.FUNCTION?I.push(T):T.type===Ae.UNIT&&E.push(T);if(Array.isArray(T)){let ue=T;E.push(this.toRPN(T)),ue.type&&E.push(new Ae(ue.type,Ae.FUNCTION,ue.column))}}return oe(I,E),oe(H,E),E},this.parseRPN=function(i,l){try{l||={};for(let E in l)Object.hasOwn(l,E)&&(l[E]=a.parse(l[E],{}));Ie.PARSE2NUMBER&&("e"in l||(l.e=new W(Ie.E)),"pi"in l||(l.pi=new W(Ie.PI)));let v=[],d;for(let E=0,I=i.length;E<I;E++)if(d=i[E],Array.isArray(d)&&(d=this.parseRPN(d,l)),d)if(d.type===Ae.OPERATOR)if(d.is_prefix||d.postfix)v.push(d.operation(v.pop()));else{let H=v.pop(),oe=v.pop();if(typeof oe>"u")throw new _0(`${d} is not a valid postfix operator at ${d.column}`);let ue=d.action==="comma";oe instanceof g0&&!ue&&(oe=It.fromSet(oe)),H instanceof g0&&!ue&&(H=It.fromSet(H)),this.callPeekers("pre_operator",oe,H,d);let Oe=a[d.action](oe,H);this.callPeekers("post_operator",Oe,oe,H,d),v.push(Oe)}else if(d.type===Ae.FUNCTION){let H=v.pop(),{parent:oe}=H;H instanceof t0||(H=t0.create(H));let ue=d.value,Oe=H.getItems();this.callPeekers("pre_function",ue,Oe);let Pe=a.callfunction(ue,Oe);this.callPeekers("post_function",Pe,ue,Oe);let Ce=v[v.length-1],Ge=i[E+1],st=Ge&&Ge.type===Ae.OPERATOR&&Ge.value===",";oe&&(Pe.parent=oe),v.push(Pe)}else{let H,oe=d.value;if(oe in Ie.ALIASES)d=a.parse(Ie.ALIASES[d]);else if(d.type===Ae.VARIABLE_OR_LITERAL)d=new W(oe);else if(d.type===Ae.UNIT){let ue=new W(oe);ue.isUnit=!0,d=ue}oe in a.CONSTANTS?(H=d,d=new W(a.CONSTANTS[oe])):oe in l&&oe!==l[oe].toString()?(H=d,d=l[oe].clone()):oe in ge&&(H=d,d=ge[oe].clone()),H&&(d.subbed=H),v.push(d)}let T=v[0];if(["undefined","string","number"].indexOf(typeof T)!==-1)throw new Zn("Unexpected token!");return T}catch(v){if(v.message==="timeout"||v instanceof TypeError||v instanceof ReferenceError||v instanceof RangeError)throw v;[hn].forEach(E=>{if(v instanceof E){let I=v.column;throw new E(`${v.message}${I?`: ${I}`:""}`)}});let T=v.column;throw new Gn(`${v.message}${T?`: ${T}`:""}`)}};class _{constructor(i){this.type=i.type,this.value=i.value,this.left=i.left,this.right=i.right}toString(){let i=this.left?`${this.left.toString()}---`:"",l=this.right?`---${this.right.toString()}`:"";return`${i}(${this.value})${l}`}toHTML(i,l){i||=0,l=typeof l>"u"?4:l;let v=function(H){return" ".repeat(l*H)},d="",T=this.left?`${v(i+1)}<li>
${this.left.toHTML(i+2,l)}${v(i+1)}</li> 
`:"",E=this.right?`${v(i+1)}<li>
${this.right.toHTML(i+2,l)}${v(i+1)}</li>
`:"";return d=`${v(i)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${v(i)}
`,(T||E)&&(d+=`${v(i)}<ul>
${T}${E}${v(i)}</ul>
`),d}}this.tree=function(i){let l=[];for(let v=0;v<i.length;v++){let d=i[v];if(Array.isArray(d)){d=this.tree(d),l.push(d);continue}if(d.type===Ae.OPERATOR)if(d.is_prefix||d.postfix){let T=d.is_prefix?"left":"right",E=l.pop();d=new _(d),d[T]=E,l.push(d)}else d=new _(d),d.right=l.pop(),d.left=l.pop(),l.push(d);else if(d.type===Ae.FUNCTION){d=new _(d);let T=l.pop();if(d.right=T,d.value==="object"){let E=l[l.length-1];if(E){for(;E.right;)E=E.right;E.right=d;continue}}l.push(d)}else l.push(new _(d))}return l[0]},this.parse=function(i,l){i=S(i,this),l||={};let v=this.tokenize(i),d=this.toRPN(v);return this.parseRPN(d,l)},this.toObject=function(i){return function v(d){let T=[];for(let E=0,I=d.length;E<I;E++){let H=d[E],oe=H.value;if(H.type===Ae.VARIABLE_OR_LITERAL)T.push(new W(oe));else if(H.type===Ae.FUNCTION){E++;let ue=a.symfunction(oe,v(d[E]));ue.isConversion=!0,T.push(ue)}else H.type===Ae.OPERATOR?T.push(oe):T.push(v(H))}return T}(a.tokenize(i))};let c=function(i){let l=0,v=[[]];for(let d=0,T=i.length;d<T;d++)i[d]===","?(l++,v[l]=[]):v[l].push(i[d]);return v},m=function(n){return n.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(i,l)=>l||i)},M=function(n){let i=[];for(;n.length;){let l=n.shift(),v=n[0],d=Dt(v),T=v==="-";if(l==="^"&&(v==="+"?n.shift():d&&v[0]==="+"&&v.shift(),d&&v.length===1&&n.unshift(n.shift()[0])),l==="^"&&(d&&v[0]==="-"||T)){let E=i.pop(),I=i[i.length-1],H="1";I==="*"?(i.pop(),H=i.pop()):Dt(I)&&(H=i.pop()),i.push(H,"/",E,l),d?v.shift():n.shift(),d&&v.length===1&&i.push(n.shift()[0])}else i.push(l)}return i};this.toTeX=function(i,l){l||={};let v=l.decimals===!0?"decimals":void 0,d=typeof i=="string"?this.toObject(i):i,T=[],E=typeof l.cdot>"u"?"\\cdot":l.cdot;if(d=M(d),Dt(d)){let I=[],H,oe;for(let ue=0;ue<d.length;ue++)H=d[ue],d[ue+1]==="^"?(oe=d[ue+2],I.push(`${yt.braces(this.toTeX([H]))}^${yt.braces(this.toTeX([oe]))}`),ue+=2):I.push(H);d=I}for(let I=0,H=d.length;I<H;I++){let oe=d[I];if(oe==="*"&&(oe=E),gt(oe))if(oe.group===y){let{fname:ue}=oe,Oe;if(ue===G)Oe=`\\sqrt${yt.braces(this.toTeX(oe.args))}`;else if(ue===V)Oe=yt.brackets(this.toTeX(oe.args),"abs");else if(ue===Ee)Oe=yt.brackets(this.toTeX(oe.args),"parens");else if(ue===Ie.LOG10)Oe=`\\${Ie.LOG10_LATEX}\\left( ${this.toTeX(oe.args)}\\right)`;else if(ue===Ie.LOG2)Oe=`\\${Ie.LOG2_LATEX}\\left( ${this.toTeX(oe.args)}\\right)`;else if(ue===Ie.LOG1P)Oe=`\\${qt(Ie.LOG1P_LATEX,this.toTeX(oe.args))}`;else if(ue==="integrate"){let Pe=c(oe.args),Ce=yt.braces(this.toTeX(Pe[0])),Ge=this.toTeX(Pe[1]);Oe=`\\int ${Ce}\\, d${Ge}`}else if(ue==="defint"){let Pe=c(oe.args),Ce=yt.braces(this.toTeX(Pe[0])),Ge=this.toTeX(Pe[3]),st=this.toTeX(Pe[1]),Ct=this.toTeX(Pe[2]);Oe=`\\int\\limits_{${st}}^{${Ct}} ${Ce}\\, d${Ge}`}else if(ue==="diff"){let Pe=c(oe.args),Ce="",Ge=yt.braces(this.toTeX(Pe[0]));if(Pe.length===1){let st=[];for(let Ct=0;Ct<Pe[0].length;Ct++)Pe[0][Ct].group===3&&st.push(Pe[0][Ct].value);st.sort(),Ce=st.length>0?`\\frac{d}{d ${st[0]}}`:"\\frac{d}{d x}"}else Pe.length===2?Ce=`\\frac{d}{d ${Pe[1]}}`:Ce=`\\frac{d^{${Pe[2]}}}{d ${this.toTeX(Pe[1])}^{${Pe[2]}}}`;Oe=`${Ce}\\left(${Ge}\\right)`}else if(ue==="sum"||ue==="product"){let Pe=[[],[],[],[]],Ce=0;for(let Ge=0;Ge<oe.args.length;Ge++){if(oe.args[Ge]===","){Ce++;continue}Pe[Ce].push(oe.args[Ge])}Oe=(ue==="sum"?"\\sum_":"\\prod_")+yt.braces(`${this.toTeX(Pe[1])} = ${this.toTeX(Pe[2])}`),Oe+=`^${yt.braces(this.toTeX(Pe[3]))}${yt.braces(this.toTeX(Pe[0]))}`}else if(ue==="limit"){let Pe=this.toTeX.bind(this),Ce=a,Ge=c(oe.args).map(st=>Array.isArray(st)?Ce.toTeX(st.join("")):Pe(String(st)));Oe=`\\lim_${yt.braces(`${Ge[1]}\\to ${Ge[2]}`)} ${yt.braces(Ge[0])}`}else ue===Y||ue===we?Oe=this.toTeX(oe.args)+(ue===Y?"!":"!!"):Oe=yt.latex(oe,v);T.push(Oe)}else T.push(yt.latex(oe,v));else Dt(oe)?T.push(yt.brackets(this.toTeX(oe))):oe==="/"?T.push(yt.frac(m(T.pop()),m(this.toTeX([d[++I]])))):T.push(oe)}return T.join(" ")};function q(n){return Ie.PARSE2NUMBER?n:a.symfunction("parens",[n])}function F(n){if(n.isInfinity)return W.infinity();if(n.multiplier.lessThan(0)&&n.multiplier.negate(),n.isImaginary()){let l=n.realpart(),v=n.imagpart();if(l.isConstant()&&v.isConstant())return Fe(a.add(a.pow(l,new W(2)),a.pow(v,new W(2))))}else{if(q0(n)||Ut(n.power))return n;if(Qn(n)&&typeof n.value=="string"&&n.value.startsWith("baseunit_"))return n}if(n.isComposite()){let l=[];n.each(d=>{l.push(d.multiplier)}),ut.QGCD.apply(null,l).lessThan(0)&&(n.multiplier=n.multiplier.multiply(new Ve(-1)),n.distributeMultiplier())}let i=a.parse(n.multiplier);return n.toUnitMultiplier(),a.multiply(i,a.symfunction(V,[n]))}function $(n){let i;if(vt(n)){let l=new It;return n.each((v,d)=>{l.set(d-1,$(v))}),l}if(St(n)){let l=new xt;return n.each((v,d,T)=>{l.set(d,T,$(v))}),l}if(Ie.PARSE2NUMBER&&n.isConstant())return mt(n)?i=ut.bigfactorial(n):i=ut.gamma(n.multiplier.add(new Ve(1)).toDecimal()),i=ie(i),i;if(n.isConstant()&&n.getDenom().equals(2)){let v=n.getNum(),d,T,E;n.multiplier.isNegative()?(E=a.subtract(v.negate(),new W(1)).multiplier.divide(new Ve(2)),d=a.pow(new W(-4),new W(E)).multiplier.multiply(ut.bigfactorial(E)),T=ut.bigfactorial(new Ve(2).multiply(E))):(E=a.add(v,new W(1)).multiplier.divide(new Ve(2)),d=ut.bigfactorial(new Ve(2).multiply(E)),T=a.pow(new W(4),new W(E)).multiplier.multiply(ut.bigfactorial(E)));let I=d.divide(T);return a.multiply(a.parse("sqrt(pi)"),new W(I))}return a.symfunction(Y,[n])}function Q(n,i){let l=Nt(n);if(l.isConstant()){let v=ut.continuedFraction(l,i),d=It.fromArray(v.fractions.map(T=>new W(T)));return It.fromArray([new W(v.sign),new W(v.whole),d])}return a.symfunction("continuedFraction",[n,i])}function K(n){let i=Nt(n);return i.isConstant()?new W(ut.erf(i)):i.isImaginary()?xe.erf(n):a.symfunction("erf",[n])}function ne(n,i){if(n.isConstant()&&i.isConstant()){let v=new W(1);return v.multiplier=v.multiplier.multiply(n.multiplier.mod(i.multiplier)),v}let l=a.divide(n.clone(),i.clone());return mt(l)?new W(0):a.symfunction("mod",[n,i])}function pe(n,i,l){return typeof n!="boolean"&&q0(n)&&(n=!!Number(n)),n?i:l}function Se(n,i){if(St(n)){for(let l=0,v=n.rows();l<v;l++)for(let d=0,T=n.cols();d<T;d++)if(n.elements[l][d].equals(i))return new W(1)}else if(n.elements){for(let l=0,v=n.elements.length;l<v;l++)if(n.elements[l].equals(i))return new W(1)}return new W(0)}function ve(n){return Ie.PARSE2NUMBER?n.isConstant()?new W(ut.sinc(n)):a.parse(qt("sin({0})/({0})",n)):a.symfunction("sinc",[n])}function Ue(n){return n.fname===Ie.LOG&&n.isLinear()?a.pow(n.args[0],W.create(n.multiplier.toString())):a.parse(qt("e^({0})",n))}function De(n){return a.parse(qt("({0})*pi/180",n))}function Je(n){return a.parse(qt("({0})*180/pi",n))}function rt(n){let i,l,v;if(n.group===y&&n.fname===""?(i=W.unwrapPARENS(a.parse(n).toLinear()),l=a.parse(n.power)):n.group===e&&(i=a.parse(n.value),l=a.parse(n.power)),i&&l&&i.group===t&&l.group===t){v=[];let d=W.toPolarFormArray(n),T=a.parse(i).abs().toString(),E=ee(i).toString(),I=l.multiplier.den.toString(),H=l.multiplier.num.toString(),oe="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let ue=0;ue<Number(I);ue++){let Oe=Nt(a.parse(qt("(({0})+2*pi*({1}))/({2})",E,ue,I))).multiplier.toDecimal();v.push(Nt(a.parse(qt(oe,T,I,Ie.IMAGINARY,Oe,H))))}return It.fromArray(v)}if(n.isConstant(!0)){let d=n.sign(),T=Nt(n.abs()),E=a.sqrt(T);v=[E.clone(),E.negate()],d<0&&(v=v.map(I=>a.multiply(I,W.imaginary())))}else v=[a.parse(n)];return It.fromArray(v)}function qe(n){if(n.isComposite()){let i=new W(0),l,v,d,T,E,I,H,oe;return n.each(ue=>{l=ue.getNum(),v=ue.getDenom(),d=i.getNum(),T=i.getDenom(),E=a.multiply(v,d),I=a.multiply(l,T),H=a.expand(a.add(E,I)),oe=a.multiply(T,v),i=a.divide(H,oe)},!0),i}return n}function Fe(n){gt(n)||(n=a.parse(n));let i=a.symfunction("sqrt",[n]);if(n.group===h)return a.symfunction(G,[n]);n.fname===""&&n.power.equals(1)&&(n=n.args[0]);let l=n.multiplier.sign()<0;if(Ie.PARSE2NUMBER){if(n.isConstant()&&!l)return new W(Me.sqrt(n.multiplier.toDecimal()));if(n.isImaginary())return xe.sqrt(n);if(n.group===o)return a.symfunction("sqrt",[n])}let v,d,T=n.isConstant();if(n.group===b&&n.isLinear()){let E=Fe(new W(n.multiplier));for(let I in n.symbols){if(!Object.hasOwn(n.symbols,I))continue;let H=n.symbols[I];E=a.multiply(E,Fe(H))}d=E}else if(n.fname===G){let E=n.args[0],I=n.multiplier;E.setPower(n.power.multiply(new Ve(.25))),d=E,I.equals(1)||(d=a.multiply(Fe(a.parse(I)),d))}else if(!n.power.isInteger())n.setPower(n.power.multiply(new Ve(.5))),d=n;else if(Number(n.multiplier)<0&&n.group===o){let E=a.parse(n.multiplier).negate(),I=a.parse(n).toUnitMultiplier().negate();d=a.multiply(a.symfunction(Ie.SQRT,[I]),Fe(E))}else{let E=n.power.sign();n.power=n.power.abs(),T&&n.multiplier.lessThan(0)&&(v=W.imaginary(),n.multiplier=n.multiplier.abs());let I=Number(n.multiplier.toDecimal()),H=Math.abs(I),oe=Math.sqrt(H),ue;if(mt(oe))ue=new W(oe);else if(mt(I)){let Oe=ut.ifactor(I),Pe=1;for(let Ce in Oe){if(!Object.hasOwn(Oe,Ce))continue;let Ge=Oe[Ce],st=Ge-Ge%2;if(st){let Ct=Number(Ce)**st;Pe*=Number(Ce)**(st/2),I/=Ct}}ue=a.multiply(a.symfunction(G,[new W(I)]),new W(Pe))}else{let Oe=[new W(n.multiplier.num),new W(n.multiplier.den)],Pe=[new W(1),new W(1)],Ce=[new W(1),new W(1)],Ge=a;for(let st=0;st<2;st++){let Ct=Oe[st];z(Ct).each(Qe=>{Qe=W.unwrapPARENS(Qe);let Re=Qe.clone().toLinear(),Ke=Number(Qe.power),Ze=Ke%2,Ye=(Ke-Ze)/2;Pe[st]=Ge.multiply(Pe[st],Ge.pow(Re,new W(Ye))),Ce[st]=Ge.multiply(Ce[st],Fe(Ge.pow(Re,new W(Ze))))})}ue=a.divide(a.multiply(Pe[0],Ce[0]),a.multiply(Pe[1],Ce[1]))}n=n.toUnitMultiplier(!0),n.isOne()?d=n:Ut(n.power.toString())?d=a.pow(n.clone(),new W(.5)):d=a.symfunction(G,[n]),E<0&&d.power.negate(),ue&&(d=a.multiply(ue,d)),v&&(d=a.multiply(v,d))}return tn&&Ie.PARSE2NUMBER&&d.text()!==i.text()?a.parse(d):d}function $e(n){if(!n.isConstant(!0)){let i,l=Number(n.power)/3,v=a.pow(a.parse(n.multiplier),new W(1/3)),d=n.toUnitMultiplier();return mt(l)?i=a.pow(d.toLinear(),a.parse(String(l))):d.group===b?(i=new W(1),d.each(T=>{i=a.multiply(i,$e(T))})):i=a.symfunction("cbrt",[d]),a.multiply(v,i)}return ke(n,new W(3))}function Xe(n,i){return n.scientific=i||10,n}function ke(n,i,l=void 0,v=void 0){if(i=Nt(a.parse(i)),i.equals(0))throw new Ht("Unable to calculate nthroots of zero");if(Number(n)<0&&Ut(i))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!n.isConstant(!0)){let I=[n,i];return typeof l<"u"&&I.push(new W(l)),typeof v<"u"&&I.push(new W(v?1:0)),a.symfunction("nthroot",I)}n.group!==t&&(n=Nt(n)),typeof v>"u"&&(v=!0),l||=25;let d=n.sign(),T,E;if(d<0&&(n=F(n)),mt(n)&&i.isConstant())return Number(n)<18446744073709552e3?E=Ve.create(Number(n)**(1/Number(i))):E=ut.nthroot(n,i),v?T=new W(E):T=new W(E.toDecimal(l)),a.multiply(new W(d),T)}function z(n){if(n.greaterThan(9999999999998891e26)||n.equals(-1))return n;if(n.equals(Math.PI))return new W(Math.PI);n=Nt(n.clone());let i;if(n.isConstant()){i=new W(1);let l=n.toString();if(mt(l)){let v=ut.ifactor(l);for(let d in v){if(!Object.hasOwn(v,d))continue;let T=v[d];i=a.multiply(i,a.symfunction("parens",[new W(d).setPower(new Ve(T))]))}}else{let v=z(new W(n.multiplier.num)),d=z(new W(n.multiplier.den));i=a.multiply(a.symfunction("parens",[v]),a.symfunction("parens",[d]).invert())}}else i=a.symfunction("pfactor",[n]);return i}function j(n){return n.realpart()}function X(n){return n.imagpart()}function D(n){let i=n.realpart(),l=n.imagpart();return a.add(i,a.multiply(l.negate(),W.imaginary()))}function ee(n){let i=n.realpart(),l=n.imagpart();return i.isConstant()&&l.isConstant()?l.equals(0)&&i.equals(1)?a.parse("0"):l.equals(1)&&i.equals(0)?a.parse("pi/2"):l.equals(0)&&i.equals(-1)?a.parse("pi"):l.equals(-1)&&i.equals(0)?a.parse("-pi/2"):l.equals(1)&&i.equals(1)?a.parse("pi/4"):l.equals(1)&&i.equals(-1)?a.parse("pi*3/4"):l.equals(-1)&&i.equals(1)?a.parse("-pi/4"):l.equals(-1)&&i.equals(-1)?a.parse("-pi*3/4"):new W(Math.atan2(Number(l),Number(i))):a.symfunction("atan2",[l,i])}function O(n){let i=W.toPolarFormArray(n),l=i[1],v=i[0],d=a.parse(qt("e^({0}*({1}))",Ie.IMAGINARY,l));return a.multiply(v,d)}function x(n){let i=n.clone();try{let l=o1(n,"e",!0),v=ce.isSymbol(l.x.power)?l.x.power:a.parse(l.x.power),d=a.divide(v,W.imaginary()),T=Nt(me.tan(d)),E=a.pow(l.a,new W(2)),I=T.getDenom(),H=T.getNum();return W.hyp(H,I).equals(l.a)?a.add(I,a.multiply(W.imaginary(),H)):i}catch(l){if(l.message==="timeout")throw l;return i}}function g(n,i){i.forEach(I=>{I.numVal=Nt(I).multiplier});let l,v,d,T,E;for(;;){if(l=i.length,l<2)return i[0];v=i.pop(),d=i[l-2],(n==="min"?v.numVal<d.numVal:v.numVal>d.numVal)&&(i.pop(),i.push(v))}}function p(...n){return Q0(n)?n[0]:un(n)?new W(Math.max.apply(null,n)):Ie.SYMBOLIC_MIN_MAX&&kn(n)?g("max",n):a.symfunction("max",n)}function P(...n){return Q0(n)?n[0]:un(n)?new W(Math.min.apply(null,n)):Ie.SYMBOLIC_MIN_MAX&&kn(n)?g("min",n):a.symfunction("min",n)}function w(n){return n.isConstant(!0)?new W(Math.sign(Nt(n))):a.symfunction("sign",[n])}function U(n,i){i=i?i.toString():"asc";let l=function(d){return d.group===t?d.multiplier:d.group===y?d.fname===""?l(d.args[0]):d.fname:d.group===o?d.power:d.value},v=vt(n)?n.elements:n.collectSymbols();return new It(v.sort((d,T)=>{let E=l(d),I=l(T);return i==="desc"?I-E:E-I}))}function B(n,i=void 0){let l=n,v=i===void 0?void 0:i;if(l.equals(1))return new W(0);let d;if(l.fname===G&&l.multiplier.equals(1))return d=a.divide(B(l.args[0]),new W(2)),l.power.sign()<0&&d.negate(),d;if(l.equals(0))throw new Ht(`${Ie.LOG}(0) is undefined!`);if(l.isImaginary())return xe.evaluate(l,Ie.LOG);if(l.isConstant()&&typeof v<"u"&&v.isConstant()){let T=Math.log(l),E=Math.log(v);d=new W(T/E)}else if(l.group===h&&l.power.multiplier.lessThan(0)||l.power.toString()==="-1")l.power.negate(),d=B(l).negate();else if(l.value==="e"&&l.multiplier.equals(1)){let T=l.power;d=gt(T)?T:new W(T)}else if(l.group===y&&l.fname==="exp"){let T=l.args[0];l.multiplier.equals(1)?d=a.multiply(T,new W(l.power)):d=a.symfunction(Ie.LOG,[l])}else if(Ie.PARSE2NUMBER&&q0(l)){let T=a.parse(l),E;T.multiplier.lessThan(0)&&(T.negate(),E=a.multiply(new W(Math.PI),new W("i"))),d=new W(Math.log(T.multiplier.toDecimal())),E&&(d=a.add(d,E))}else{let T;!l.power.equals(1)&&!l.contains("e")&&l.multiplier.isOne()&&(T=l.group===h?l.power:new W(l.power),l.toLinear());let E=typeof v>"u"?[l]:[l,v];E.length>1&&Q0(E)?d=new W(1):d=a.symfunction(Ie.LOG,E),T&&(d=a.multiply(T,d))}return d}function Z(n,i){typeof i=="number"&&(i=new W(i));let l=i&&i.isConstant()||typeof i>"u";if(n.isConstant()&&l){let d,T,E;d=n,i&&i.lessThan(0)&&(i=F(i),T=Number(n).toExponential().toString().split("e"),d=T[0],E=T[1]);let I=new W(m0(Number(d),Number(i)||0));return a.multiply(I,a.pow(new W(10),new W(E||0)))}let v=[n];return typeof i<"u"&&v.push(i),a.symfunction("round",v)}function J(n){let i=Number(n)%2,l;return i<0&&(i=2+i),i>=0&&i<=.5?l=1:i>.5&&i<=1?l=2:i>1&&i<=1.5?l=3:l=4,l}function ie(n){if(!isFinite(n)){let l=Math.sign(n),v=new W(String(Math.abs(n)));return v.multiplier=v.multiplier.multiply(new Ve(l)),v}if(gt(n))return n;if(typeof n=="number")try{n=Ve.simple(n)}catch(l){if(l.message==="timeout")throw l;n=new Ve(n)}let i=new W(0);return i.multiplier=n,i}function le(n){let i=n.group,l;if(i===k){let v=n.getNum(),d=n.getDenom()||new W(1),T=Number(n.power),E=new W(1);if(Math.abs(T)===1){d.each(oe=>{oe.group===b?E=a.multiply(E,le(oe.getDenom())):oe.power.lessThan(0)&&(E=a.multiply(E,le(oe.clone().toUnitMultiplier())))});let I=new W(0);d.each(oe=>{I=a.add(a.divide(oe,E.clone()),I)}),E.invert();let H;v.isComposite()?(H=new W(0),v.each(oe=>{H=a.add(a.multiply(le(oe),E.clone()),H)})):H=a.multiply(E,v),l=a.divide(H,I)}}else i===b?(l=new W(1),n.each(v=>{l=a.multiply(l,a.clean(v))})):i===y&&n.args.length===1&&n.args[0].isConstant()&&(l=Bt("PARSE2NUMBER",()=>a.parse(n),!0));return l||=n,l}function te(n,i){return i||={expand_denominator:!0,expand_functions:!0},ae(n,i)}function ae(n,i){if(Array.isArray(n))return n.map(d=>ae(d,i));if("expand"in n&&typeof n.expand=="function")return n.expand(i);let l=n;if(i||={},l.group===y&&l.fname===""){let d=ae(l.args[0],i),T=ae(a.pow(d,a.parse(l.power)),i);return a.multiply(a.parse(l.multiplier),T).distributeMultiplier()}if([t,e,o].indexOf(l.group)!==-1)return l;let v=l.clone();try{let d=l.multiplier.toString(),T=Number(l.power),E=l;if(l.isComposite()&&mt(l.power)&&T>0){let I=T-1,H=new W(0);l.each(ue=>{H=a.add(H,ae(a.parse(ue),i))});let oe=a.parse(H);for(let ue=0;ue<I;ue++)oe=Bn(oe,H,i);E=a.multiply(a.parse(d),oe).distributeMultiplier()}else if(l.group===y&&i.expand_functions===!0){let I=[];l.args.forEach(H=>{I.push(ae(H,i))}),E=a.pow(a.symfunction(l.fname,I),a.parse(l.power)),E=a.multiply(E,a.parse(l.multiplier))}else if(l.isComposite()&&mt(l.power)&&T<0&&i.expand_denominator===!0){let I=l.invert();E=ae(I,i),E.invert()}else if(l.group===b){let I=function(ue){switch(ue.group){case k:return 0;case L:return 1;case b:return 2;case y:return 3;default:return 4}},H=l.collectSymbols().sort((ue,Oe)=>I(Oe)-I(ue)).map(ue=>{let Oe=a.pow(ue,a.parse(String(T)));return ae(Oe,i)}),oe=H.pop();oe.isComposite()&&oe.isLinear()?(H.forEach(ue=>{oe=Bn(oe,ue,i)}),oe.isComposite()?(Number(oe.power)>1&&(oe=ae(a.pow(oe,a.parse(oe.power)),i)),E=a.multiply(a.parse(d),oe).distributeMultiplier()):E=oe):(E=oe,H.forEach(ue=>{E=a.multiply(E,ue)}),E=a.multiply(E,a.parse(d)).distributeMultiplier()),E.group===b&&(E=a.parse(E))}else E=l;return E}catch(d){if(d.message==="timeout")throw d;return v}}function de(n){return xt.identity(n)}function Be(n,i){return i.isConstant()&&mt(i)?n.elements[Number(i)]:a.symfunction("vecget",[n,i])}function Te(n,i){return i=typeof i>"u"?1e-14:i,n=n.clone(),i=Number(i),n.elements.sort((l,v)=>v.group-l.group),n.elements=B1(n.elements,(l,v)=>Number(a.subtract(Nt(l),Nt(v)).abs())<=i),n}function ze(n,i,l){return i.isConstant?(n.elements[Number(i)]=l,n):a.symfunction("vecset",[n,i,l])}function We(n,i,l){return i.isConstant()&&l.isConstant()?n.elements[Number(i)][Number(l)]:a.symfunction("matget",[n,i,l])}function je(n,i){return i.isConstant()?It.fromArray(n.elements[Number(i)]):a.symfunction("matgetrow",[n,i])}function et(n,i,l){if(!i.isConstant())return a.symfunction("matsetrow",[n,i,l]);if(n.elements[Number(i)].length!==l.elements.length)throw new gn("Matrix row must match row dimensions!");let v=n.clone();return v.elements[Number(i)]=l.clone().elements,v}function He(n,i){if(!i.isConstant())return a.symfunction("matgetcol",[n,i]);let l=Number(i),v=xt.fromArray([]);return n.each((d,T,E)=>{E===l&&v.elements.push([d.clone()])}),v}function lt(n,i,l){if(!i.isConstant())return a.symfunction("matsetcol",[n,i,l]);let v=Number(i);if(n.rows()!==l.elements.length)throw new gn("Matrix column length must match number of rows!");return l.each(((d,T)=>{n.set(T-1,v,d.elements[0].clone())})),n}function ct(n,i,l,v){return n.elements[i][l]=v,n}function ft(...n){return new It(n)}function At(...n){return xt.fromArray(n)}function $t(...n){return g0.fromArray(n)}function Tt(n){return St(n)?n.determinant():n}function pt(n){let i;return St(n)?i=[new W(n.cols()),new W(n.rows())]:vt(n)||bn(n)?i=new W(n.elements.length):Pt("size expects a matrix or a vector"),i}function Ft(n,i){return St(n)&&(n=new It(n)),St(i)&&(i=new It(i)),vt(n)&&vt(i)?n.dot(i):a.multiply(n.clone(),i.clone())}function _t(n,i){return St(n)&&(n=new It(n)),St(i)&&(i=new It(i)),vt(n)&&vt(i)?n.cross(i):a.multiply(n.clone(),i.clone())}function Ot(n){return St(n)?n.transpose():Pt("function transpose expects a matrix")}function Vt(n){return St(n)?n.invert():Pt("invert expects a matrix")}function Jt(n,i){return n.union(i)}function c0(n,i){return n.intersection(i)}function Yt(n,i){return n.contains(i)}function r0(n,i){return n.difference(i)}function Kt(n,i){return new W(Number(n.intersects(i)))}function v0(n,i){return new W(Number(n.isSubset(i)))}function u(n,i){i??=n;let l=se.slice(n,i).map(v=>new W(v));return l.length===1?l[0]:l.length===0?new W(0):new It(l)}function N(...n){n.forEach(i=>{console.log(i.toString())})}function A(n){if(!gt(n.power)&&n.power.absEquals(.5)){let i=n.power.sign(),l=Fe(n.group===e?new W(n.value):n.toLinear());return i<0&&l.invert(),l}return n}function C(n){if(n.group===e){let i=n.value,l=Oi(i)[0];if(!l)return In("Unable to compute prime factors. This should not happen. Please review and report."),n;let d=new Ve(Math.log(i)/Math.log(l)).multiply(n.power);if(d.den>n.power.den)return n;mt(d)?n=new W(l**Number(d)):n=new W(l).setPower(d)}return n}this.expand=ae,this.round=Z,this.clean=le,this.sqrt=Fe,this.cbrt=$e,this.abs=F,this.log=B,this.rationalize=qe,this.nthroot=ke,this.arg=ee,this.conjugate=D,this.imagpart=X,this.realpart=j,this.getFunction=function(i){return s[i][0]},this.addPreprocessor=function(i,l,v,d){let{names:T}=be,{actions:E}=be;if(typeof l!="function")throw new Error("Incorrect parameters. Function expected!");v?d?(T.splice(v,0,i),E.splice(v,0,l)):(T[v]=i,E[v]=l):(T.push(i),E.push(l))},this.getPreprocessors=function(){let i={};for(let l=0,v=be.names.length;l<v;l++){let d=be.names[l];i[d]={order:l,action:be.actions[l]}}return i},this.removePreprocessor=function(i,l){let v=be.names.indexOf(i);l?(d0(be.names,v),d0(be.actions,v)):(be.names[v]=void 0,be.actions[v]=void 0)},this.mappedFunction=function(...i){let l={},{params:v}=this;for(let d=0;d<v.length;d++)l[v[d]]=String(i[d]);return a.parse(this.body,l)},this.add=function(i,l){let v=gt(i),d=gt(l);if(v&&d){let E=i,I=l;if(E.unit||I.unit)return a.Unit.add(E,I);if(E.isInfinity||I.isInfinity){let ht=E.multiplier.lessThan(0),tt=I.multiplier.lessThan(0);if(E.isInfinity&&I.isInfinity&&ht!==tt)throw new Ht(`(${E})+(${I}) is not defined!`);let nt=W.infinity();return tt&&nt.negate(),nt}if(E.isComposite()&&E.isLinear()&&I.isComposite()&&I.isLinear()&&(E.distributeMultiplier(),I.distributeMultiplier(),I.length>E.length&&E.group===I.group&&([E,I]=[I,E])),E.multiplier.equals(0))return I;if(I.multiplier.equals(0))return E;if(E.isConstant()&&I.isConstant()&&Ie.PARSE2NUMBER)return new W(E.multiplier.add(I.multiplier).toDecimal(Ie.PRECISION));let H=E.group,oe=I.group,ue=E.power.toString(),Oe=I.power.toString();if(H<oe||H===oe&&Number(ue)>Number(Oe)&&Number(Oe)>0)return this.add(I,E);if(H===b&&oe===L&&E.value===I.value){let ht=E;E=I,I=ht,H=E.group,oe=I.group,ue=E.power.toString(),Oe=I.power.toString()}let Pe=ue===Oe,Ce=E.value,Ge=I.value,st=E.isComposite(),Ct=I.isComposite(),Qe,Re,Ke;if(st&&(Qe=Xt(E,"hash")),Ct&&(Re=Xt(I,"hash")),H===k&&oe===k&&I.isLinear()&&!E.isLinear()&&Qe!==Re)return this.add(I,E);H===L&&oe===L&&(Ce=Qe,Ge=Re);let Ze=H===e&&oe===t,Ye=E.value===I.multiplier.toString(),at=Ce===Ge||Qe===Re&&Qe!==void 0||Ze&&Ye;if(at&&Pe&&H===oe)if(Ze&&(I=I.convert(e)),H===L&&(oe===o||oe===e))E.distributeMultiplier(),Ke=E.attach(I);else if(Ke=E,E.multiplier.isOne()&&I.multiplier.isOne()&&H===k&&E.isLinear()&&I.isLinear())for(let ht in I.symbols){if(!Object.hasOwn(I.symbols,ht))continue;let tt=I.symbols[ht];Ke.attach(tt)}else Ke.multiplier=Ke.multiplier.add(I.multiplier);else if(at&&H!==L)H===k&&oe===L?(I.insert(E,"add"),Ke=I):(Ke=W.shell(L).attach([E,I]),Ke.value=H===L?Qe:Ce);else if(st&&E.isLinear()){let ht=H===oe,tt=H===L&&oe===L;if(tt&&(ht=E.value===I.value),E.distributeMultiplier(),I.isComposite()&&I.isLinear()&&ht){I.distributeMultiplier();for(let nt in I.symbols){if(!Object.hasOwn(I.symbols,nt))continue;let it=I.symbols[nt];E.attach(it)}Ke=E}else tt&&E.value!==Re||H===L&&!at?(Ke=W.shell(k).attach([E,I]),Ke.updateHash()):Ke=E.attach(I)}else{if(H===y&&E.fname===G&&oe!==h&&I.power.equals(.5)){let ht=I.multiplier.clone();I=Fe(I.toUnitMultiplier().toLinear()),I.multiplier=ht}E.length===2&&I.length===2&&Ut(E.power)&&Ut(I.power)?Ke=a.add(ae(E),ae(I)):(Ke=W.shell(k).attach([E,I]),Ke.updateHash())}Ke.multiplier.equals(0)&&(Ke=new W(0));let dt=Ke;if(dt.length===1){let ht=dt.multiplier,tt=J0(dt.symbols);return tt.multiplier=tt.multiplier.multiply(ht),tt}return Ke}if(d&&!v){let E=i;i=l,l=E;let I=d;d=v,v=I}let T=St(l);if(v&&T){let E=new xt;l.eachElement((H,oe,ue)=>{E.set(oe,ue,a.add(i.clone(),H))}),l=E}else if(St(i)&&T)l=i.add(l);else if(v&&vt(l)){let E=l;E.each((I,H)=>{H--,E.elements[H]=a.add(i.clone(),E.elements[H])})}else if(vt(i)&&vt(l)){let E=i,I=l;I.each((H,oe)=>{oe--,I.elements[oe]=a.add(E.elements[oe],I.elements[oe])})}else{if(vt(i)&&St(l))return a.add(l,i);if(St(i)&&vt(l)){if(l.elements.length===i.rows()){let E=new xt,I=i.cols();return l.each((H,oe)=>{let ue=[];if(vt(H))for(let Oe=0;Oe<I;Oe++)ue.push(a.add(i.elements[oe-1][Oe].clone(),H.elements[Oe].clone()));else for(let Oe=0;Oe<I;Oe++)ue.push(a.add(i.elements[oe-1][Oe].clone(),H.clone()));E.elements.push(ue)}),E}Pt("Dimensions must match!")}}return l},this.subtract=function(i,l){let v=gt(i),d=gt(l),T;if(v&&d){let E=i,I=l;return E.unit||I.unit?a.Unit.subtract(E,I):this.add(E,I.negate())}if(d&&vt(i))l=i.map(E=>a.subtract(E,l.clone()));else if(v&&vt(l))l=l.map(E=>a.subtract(i.clone(),E));else if(vt(i)&&vt(l)||dn(i)&&dn(l))i.dimensions()===l.dimensions()?l=i.subtract(l):a.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(St(i)&&vt(l)){if(l.elements.length===i.rows()){let E=new xt,I=i.cols();return l.each((H,oe)=>{let ue=[];for(let Oe=0;Oe<I;Oe++)ue.push(a.subtract(i.elements[oe-1][Oe].clone(),H.clone()));E.elements.push(ue)}),E}Pt("Dimensions must match!")}else if(vt(i)&&St(l)){let E=l.clone().negate();return a.add(E,i)}else if(St(i)&&St(l))l=i.subtract(l);else if(St(i)&&d){let E=new xt;i.each((I,H,oe)=>{E.set(H,oe,a.subtract(I,l.clone()))}),l=E}else if(v&&St(l)){let E=new xt;l.each((I,H,oe)=>{E.set(H,oe,a.subtract(i.clone(),I))}),l=E}return l},this.multiply=function(i,l){let v=gt(i),d=gt(l);if(v&&l instanceof t0)return l.elements.push(i),l;if(v&&d){let I=i,H=l;if(H.isUnit){let Ze=I.clone();return I.unit=H,Ze}if(I.unit||H.unit)return a.Unit.multiply(I,H);if(I.isInfinity||H.isInfinity){if(I.equals(0)||H.equals(0))throw new Ht(`${I}*${H} is undefined!`);if(H.power.lessThan(0)){if(!I.isInfinity)return new W(0);throw new Ht("Infinity/Infinity is not defined!")}let Ze=I.multiplier.multiply(H.multiplier).sign(),Ye=W.infinity();if(I.isConstant()||H.isConstant()||I.isInfinity&&H.isInfinity)return Ze<0&&Ye.negate(),Ye}if(I.multiplier.equals(0)||H.multiplier.equals(0))return new W(0);if(I.isOne())return H.clone();if(H.isOne())return I.clone();if(I.isConstant()&&H.isConstant()&&Ie.PARSE2NUMBER){let Ze,Ye=I.multiplier.num.abs().toString().length,at=I.multiplier.den.toString().length,dt=Ye-at,ht=H.multiplier.num.abs().toString().length,tt=H.multiplier.den.toString().length,nt=ht-tt,it=Ie.PRECISION-5;if(dt<-it||dt>it||nt<-it||nt>it){let U0=new Me(String(I.multiplier.num)),a0=new Me(String(I.multiplier.den)),b0=new Me(String(H.multiplier.num)),G0=new Me(String(H.multiplier.den));Ze=new W(U0.times(b0).dividedBy(a0).dividedBy(G0).toFixed())}else{let U0=new Me(I.multiplier.toDecimal()),a0=new Me(H.multiplier.toDecimal()),b0=U0.times(a0).toFixed();Ze=new W(b0)}return Ze}if(H.group>I.group&&H.group!==k)return this.multiply(H,I);if(I.group===b&&H.group===L&&I.value===H.value){let Ze=I;I=H,H=Ze}let oe=I.group,ue=H.group,Oe=H.multiplier.num,Pe=H.multiplier.den;if(oe===y&&I.fname===G&&!H.isConstant()&&I.args[0].value===H.value&&!I.args[0].multiplier.lessThan(0)){let Ze=I.power,Ye=a.parse(I.multiplier);I=a.multiply(Ye,I.args[0].clone()),I.setPower(new Ve(.5).multiply(Ze)),oe=I.group}else oe===y&&I.fname===G&&I.multiplier.equals(1)&&I.power.equals(-1)&&H.isConstant()&&I.args[0].equals(H)&&(I=a.symfunction(G,[H.clone()]),H=new W(1));let Ce=I.value,Ge=H.value,st=new Ve(I.sign()),Ct=oe===e&&ue===t&&H.multiplier.equals(I.value),Qe=Ct?new Ve(1).multiply(I.multiplier).abs():I.multiplier.multiply(H.multiplier).abs(),Re=I.clone().toUnitMultiplier();if(H=H.clone().toUnitMultiplier(!0),oe===y&&ue===y){let Ze=I.args[0].clone(),Ye=H.args[0].clone();if(I.fname===G&&H.fname===G&&I.isLinear()&&H.isLinear()){let at=a.divide(Ze,Ye).invert();at.gt(1)&&mt(at)&&(Re=a.multiply(I.args[0].clone(),Fe(at.clone())),H=new W(1))}else if(I.fname===Y&&H.fname===Y&&!Ze.isConstant()&&!Ye.isConstant()&&Number(H.power)<0){let at=a.subtract(Ze.clone(),Ye.clone());if(at.isConstant()){let dt=new W(1);if(Number(at)<0){for(let ht=0,tt=Math.abs(Number(at));ht<=tt;ht++){let nt=a.add(Ze.clone(),new W(ht));dt=a.multiply(dt,nt)}Re=a.multiply(a.pow(Ze,new W(I.power)),a.pow(dt,new W(H.power))),H=new W(1)}else{for(let ht=0,tt=Math.abs(Number(at));ht<=tt;ht++){let nt=a.add(Ye.clone(),new W(ht));dt=a.multiply(dt,nt)}Re=a.multiply(a.pow(dt,new W(I.power)),a.pow(Ye,new W(H.power))),H=new W(1)}}}}if(Ce===Ge&&oe===L&&oe===ue&&(Ce=I.text("hash"),Ge=H.text("hash")),ue===h&&H.previousGroup===L&&oe===L&&(Ce=Xt(I,"hash",h)),(Ce===Ge||Ct)&&!(oe===L&&(ue===o||ue===e||ue===y))&&!(oe===L&&ue===b)){let Ze=I.power,Ye=H.power,at=gt(Ze),dt=gt(Ye),ht=at||dt;oe===L&&ue!==L&&H.previousGroup!==L&&Ze.equals(1)?(Re=new W(0),I.each(tt=>{Re=a.add(Re,a.multiply(tt,H.clone()))},!0)):(ht?Re.power=a.add(gt(Ze)?Ze:new W(Ze),gt(Ye)?Ye:new W(Ye)):oe===t?Re.power=Ze:Re.power=Ze.add(Ye),Re.power.equals(0)&&(Re=Re.convert(t)),ht&&Re.convert(h),I.imaginary&&H.imaginary&&Ut(Number(Re.power)%2)&&(Re=new W(1),Qe.negate()),Re.group!==h&&Re.previousGroup&&(Re.previousGroup=void 0),Re.multiplier=Re.multiplier.multiply(H.multiplier))}else if(oe===b&&I.isLinear())if(ue===b&&H.distributeExponent(),ue===b&&H.isLinear()){for(let Ze in H.symbols){if(!Object.hasOwn(H.symbols,Ze))continue;let Ye=H.symbols[Ze];Re=Re.combine(Ye)}Re.multiplier=Re.multiplier.multiply(H.multiplier)}else Re.combine(H);else if(oe===t)Re=H.clone().toUnitMultiplier(!0);else if(oe===b)Re.distributeExponent(),Re.combine(H);else if(!H.isOne()){let Ze=H.multiplier.clone();H.toUnitMultiplier(),Re=W.shell(b).combine([Re,H]),Re.multiplier=Re.multiplier.multiply(Ze)}if(Re.group===e){let Ze=Math.log(Number(Re.value)),Ye=Math.log(Number(Oe))/Ze,at=Math.log(Number(Pe))/Ze,dt=Number(Qe.num)/Number(Oe),ht=Number(Qe.den)/Number(Pe);Ye!==0&&mt(Ye)&&mt(dt)&&(Re.power=Re.power.add(new Ve(Ye)),Qe.num=Qe.num.divide(Oe)),at!==0&&mt(at)&&mt(ht)&&(Re.power=Re.power.subtract(new Ve(at)),Qe.den=Qe.den.divide(Pe))}if(Re.length===1){let Ze=Re.multiplier;Re=J0(Re.symbols),Re.multiplier=Re.multiplier.multiply(Ze)}let Ke=Re.power.toString();if(Ut(Ke)&&Re.fname===G){st=st.multiply(new Ve(Re.sign()));let Ze=Re.power;Re=Re.args[0],Re=a.multiply(new W(Qe),a.pow(Re,new W(Ze.divide(new Ve(2))))),st.lessThan(0)&&Re.negate()}else Re.multiplier=Re.multiplier.multiply(Qe).multiply(st),Re.group===k&&Re.isImaginary()&&Re.distributeMultiplier();return Re.group===e&&mt(Re.power.toDecimal())&&(Re=Re.convert(t)),Re}if(d&&!v){let I=i;i=l,l=I;let H=d;d=v,v=H}let T=St(l),E=St(i);if(v&&T){let I=new xt;l.eachElement((oe,ue,Oe)=>{I.set(ue,Oe,a.multiply(i.clone(),oe))}),l=I}else if(E&&T)l=i.multiply(l);else if(v&&vt(l)){let I=l;I.each((H,oe)=>{oe--,I.elements[oe]=a.multiply(i.clone(),I.elements[oe])})}else if(vt(i)&&vt(l)){let I=i,H=l;H.each((oe,ue)=>{ue--,H.elements[ue]=a.multiply(I.elements[ue],H.elements[ue])})}else{if(vt(i)&&St(l))return this.multiply(l,i);if(St(i)&&vt(l)){let I=i,H=l;if(H.elements.length===I.rows()){let oe=new xt,ue=I.cols();return H.each((Oe,Pe)=>{let Ce=[];for(let Ge=0;Ge<ue;Ge++)Ce.push(a.multiply(I.elements[Pe-1][Ge].clone(),Oe.clone()));oe.elements.push(Ce)}),oe}Pt("Dimensions must match!")}}return l},this.divide=function(i,l){let v=gt(i),d=gt(l);if(v&&d){let I=i,H=l;if(I.unit||H.unit)return a.Unit.divide(I,H);let oe;if(H.equals(0))throw new yn("Division by zero not allowed!");return I.isConstant()&&H.isConstant()?(oe=I.clone(),oe.multiplier=oe.multiplier.divide(H.multiplier)):(H.invert(),oe=a.multiply(I,H)),oe}let T=vt(i),E=vt(l);if(v&&E)l=l.map(I=>a.divide(i.clone(),I));else if(T&&d)l=i.map(I=>a.divide(I,l.clone()));else if(T&&E){let I=i;I.dimensions()===l.dimensions()?l=l.map((H,oe)=>a.divide(I.elements[--oe],H)):a.error("Cannot divide vectors. Dimensions do not match!")}else{let I=St(i),H=St(l);if(I&&d){let oe=new xt;i.eachElement((ue,Oe,Pe)=>{oe.set(Oe,Pe,a.divide(ue,l.clone()))}),l=oe}else if(v&&H){let oe=new xt;l.eachElement((ue,Oe,Pe)=>{oe.set(Oe,Pe,a.divide(i.clone(),ue))}),l=oe}else if(I&&H){let oe=new xt,ue=i,Oe=l;ue.rows()===Oe.rows()&&ue.cols()===Oe.cols()?(ue.eachElement((Pe,Ce,Ge)=>{oe.set(Ce,Ge,a.divide(Pe,Oe.elements[Ce][Ge]))}),l=oe):a.error("Dimensions do not match!")}else if(I&&E){let oe=i,ue=l;if(oe.cols()===ue.dimensions()){let Oe=new xt;oe.eachElement((Pe,Ce,Ge)=>{Oe.set(Ce,Ge,a.divide(Pe,ue.elements[Ce].clone()))}),l=Oe}else a.error("Unable to divide matrix by vector.")}}return l},this.pow=function(i,l){let v=gt(i),d=gt(l);if(v&&d){let T=i,E=l;if(T.unit||E.unit)return a.Unit.pow(T,E);if(T.group===y&&T.fname===V&&Ut(E)){let Qe=T.multiplier.clone(),Re=a.pow(T.args[0],E);return Re.multiplier=Qe,Re}if(T.isInfinity||E.isInfinity){if(T.isInfinity&&E.isInfinity)throw new Ht(`(${T})^(${E}) is undefined!`);if(T.isConstant()&&E.isInfinity){if(T.equals(0)){if(E.lessThan(0))throw new Ht("0^Infinity is undefined!");return new W(0)}if(T.equals(1))throw new Ht(`1^${E.toString()} is undefined!`);if(E.lessThan(0))return new W(0);if(!T.lessThan(0))return W.infinity()}if(T.isInfinity&&E.isConstant()){if(E.equals(0))throw new Ht(`${T}^0 is undefined!`);return E.lessThan(0)?new W(0):a.multiply(W.infinity(),a.pow(new W(T.sign()),E.clone()))}}let I=T.equals(0),H=E.equals(0);if(I&&H)throw new Ht("0^0 is undefined!");if(I&&E.isConstant()&&E.multiplier.greaterThan(0))return new W(0);if(H)return new W(1);let oe=E.isConstant(),ue=T.isConstant(),Oe=E.isInteger(),Pe=T.multiplier,Ce=T.clone();if(ue&&oe&&T.equals(0)&&E.lessThan(0))throw new Ht("Division by zero is not allowed!");if(Ie.PARSE2NUMBER&&ue&&oe&&T.sign()<0&&mn(E)){let Qe=Math.PI*Number(E.multiplier.toDecimal()),Re=new W(Math.cos(Qe)),Ke=a.multiply(W.imaginary(),new W(Math.sin(Qe)));return a.add(Re,Ke)}if(Ie.PARSE2NUMBER&&T.isImaginary()&&oe&&mt(E)&&!E.lessThan(0)){let Qe,Re,Ke,Ze,Ye,at=T.realpart(),dt=T.imagpart();if(at.isConstant("all")&&dt.isConstant("all"))return Ye=Ie.USE_BIG?new W(rn.atan2(dt.multiplier.toDecimal(),at.multiplier.toDecimal()).times(E.toString())):Math.atan2(Number(dt.multiplier.toDecimal()),Number(at.multiplier.toDecimal()))*Number(E.multiplier.toDecimal()),Re=new W(Ye),Qe=a.pow(W.hyp(at,dt),E),Ke=a.multiply(Qe.clone(),a.trig.cos(Re.clone())),Ze=a.multiply(Qe,a.trig.sin(Re)),a.add(Ke,a.multiply(W.imaginary(),Ze))}Ce.toUnitMultiplier();let Ge;if(Ce.group===y&&Ce.fname===G&&!oe){let Qe=Ce.args[0];Qe.multiplyPower(new W(.5)),Qe.multiplier.multiply(Ce.multiplier),Qe.multiplyPower(E),Ce=Qe}else Ge=Pe.sign(),mn(E)&&Ge<0&&(Ce.negate(),Ce=a.symfunction(Ee,[Ce]),Ce.negate()),Ce.multiplyPower(E);let st,Ct;if(ue&&oe&&Ie.PARSE2NUMBER){let Qe;Ge<0&&(T.negate(),E.multiplier.den.equals(2)?Qe=new W(Ie.IMAGINARY):mt(E.multiplier)?Ut(E.multiplier)?Qe=new W(1):Qe=new W(-1):Ut(E.multiplier.den)?Qe=a.pow(a.symfunction(Ee,[new W(Ge)]),E.clone()):Qe=new W(Ge**E.multiplier.num));let Re=Number(T.multiplier.toDecimal())**Number(E.multiplier.toDecimal());if(Re!==0||T.multiplier.equals(0))Ce=new W(Re);else{let Ke=new Me(T.multiplier.toDecimal()),Ze=new Me(E.multiplier.toDecimal());Ce=new W(Ke.pow(Ze).toFixed())}Qe&&(Ce=a.multiply(Ce,Qe))}else if(Oe&&!Pe.equals(1)){if(E.abs().gt(Ie.MAX_EXP))return E.sign()<0?new W(0):W.infinity();let Re=E.multiplier.toDecimal(),Ke=Math.sign(Number(Re)),Ze=Math.abs(Number(Re)),Ye=new Ve(1);Ye.num=Pe.num.pow(Number(Ze)),Ye.den=Pe.den.pow(Number(Ze)),Ke<0&&Ye.invert(),Ce.multiplier=Ce.multiplier.multiply(Ye)}else{let Qe=T.sign();if(E.isConstant()&&T.isConstant()&&!E.multiplier.den.equals(1)&&Qe<0)if(E.multiplier.den.equals(2)){let Re=new W(Ie.IMAGINARY);T.negate(),E.lessThan(0)&&(Re.negate(),E.negate()),Ce=a.multiply(a.pow(T,E),Re)}else{let Re=T.clone();Re.multiplier.negate(),Ce=a.pow(a.symfunction(Ee,[new W(Ge)]),E.clone());let Ke=a.pow(new W(Re.multiplier.num),E.clone()),Ze=a.pow(new W(Re.multiplier.den),E.clone()),Ye=a.divide(Ke,Ze);Ce=a.multiply(Ce,Ye)}else if(Ie.PARSE2NUMBER&&E.isImaginary()){let Re=E.realpart(),Ke=E.imagpart(),Ze=T.clone().toLinear(),Ye=a.pow(Ze.clone(),Re),at=B(Ze.clone()),dt=me.cos(a.multiply(Ke.clone(),at)),ht=a.multiply(me.sin(a.multiply(Ke,B(Ze))),W.imaginary());Ce=a.multiply(Ye,a.add(dt,ht)),Ce=a.expand(a.parse(Ce))}else{let Re=T.group===t&&Qe<0;if(st=A(new W(Re?Number(Pe.num):Math.abs(Number(Pe.num))).setPower(E.clone())),Ct=A(new W(Number(Pe.den)).setPower(E.clone()).invert()),T.imaginary)if(Oe){let Ke=Math.sign(E),Ye=F(E)%4;Ce=new W(Ut(Ye)?-1:Ie.IMAGINARY),(Ye===0||Ke<0&&Ye===1||Ke>0&&Ye===3)&&Ce.negate()}else{let Ke=l.multiplier.multiply(Ve.quick(1,2)),Ze=(-1)**Ke.num;Ce=Ut(Ke.den)?new W(-1).setPower(Ke,!0):new W(Ze)}if(Qe<0&&!Re&&Ce.negate(),oe&&T.group!==h){let Ke=Ut(E.multiplier.den),Ze=Ut(T.power),Ye=Ce.power.toDecimal(),at=Ut(Ye);if(Ke&&Ze&&!at){if(Ye==="1"||Ye==="1")typeof Ce.value=="string"&&Ce.value.startsWith("baseunit_")||(Ce=a.symfunction(V,[Ce]));else if(mt(Ye))Ce=a.multiply(a.symfunction(V,[Ce.clone().toLinear()]),Ce.clone().setPower(new Ve(Number(Ye)-1)));else{let dt=Ce.power;Ce=a.symfunction(V,[Ce.toLinear()]).setPower(dt)}Ie.POSITIVE_MULTIPLIERS&&Ce.fname===V&&(Ce=Ce.args[0])}}if(E.equals(2)&&Ce.group===b){let Ke=new W(1);Ce.each(Ze=>{Ke=a.multiply(Ke,a.pow(Ze,E))}),Ce=Ke}}}if(Ce=A(Ce),st&&Ct&&(Ce=a.multiply(Ce,C(a.multiply(st,Ct)))),Ce.fname===G){let Qe=Ce.group===h,Re=Qe?Ce.power.multiplier.toString():Ce.power.toString();if(Ut(Re)){let Ke=Qe?a.divide(Ce.power,new W(2)):new W(Ce.power.divide(new Ve(2))),Ze=Ce.multiplier;Ce=a.pow(Ce.args[0],Ke),Ce.multiplier=Ce.multiplier.multiply(Ze)}}else if(!Ie.IGNORE_E&&Ce.isE()&&Ce.group===h&&Ce.power.contains("pi")&&Ce.power.contains(Ie.IMAGINARY)&&E.group===b){let Qe=E.stripVar(Ie.IMAGINARY);Ce=a.add(me.cos(Qe),a.multiply(W.imaginary(),me.sin(Qe)))}return Ce}if(vt(i)&&d)i=i.map(T=>a.pow(T,l.clone()));else if(St(i)&&d){let T=new xt;i.eachElement((E,I,H)=>{T.set(I,H,a.pow(E,l.clone()))}),i=T}else if(v&&St(l)){let T=new xt;l.eachElement((E,I,H)=>{T.set(I,H,a.pow(i.clone(),E))}),i=T}return i},this.comma=function(i,l){return i instanceof t0||(i=t0.create(i)),i.append(l),i},this.mod=function(i,l){return ne(i,l)},this.slice=function(i,l){return new Le(i,l)},this.equals=function(i,l){return i.group!==o&&!i.isLinear()&&Pt(`Cannot set equality for ${i.toString()}`),ge[i.value]=l.clone(),l},this.percent=function(i){return a.divide(i,new W(100))},this.assign=function(i,l){if(i instanceof t0&&l instanceof t0)return i.elements.map((v,d)=>a.assign(v,l.elements[d])),It.fromArray(l.elements);if(i.parent){let v=i.parent;return v.elements[v.getter]=l,delete v.getter,v}if(i.group!==o)throw new jn(`Cannot complete operation. Incorrect LH value for ${i}`);return ge[i.value]=l,l},this.functionAssign=function(i,l){let v=i.elements.pop();return On(v,i.elements,l)};let R=function(i){return new W(i===!0?1:0)};this.eq=function(i,l){return R(i.equals(l))},this.gt=function(i,l){return R(i.gt(l))},this.gte=function(i,l){return R(i.gte(l))},this.lt=function(i,l){return R(i.lt(l))},this.lte=function(i,l){return R(i.lte(l))},this.factorial=function(i){return this.symfunction(Y,[i])},this.dfactorial=function(i){return this.symfunction(we,[i])}}},Fi={allSame:Q0,allNumeric:k1,arguments2Array:x1,armTimeout:t1,arrayAddSlices:D1,arrayClone:$1,arrayMax:U1,arrayMin:Mn,arrayEqual:P1,arrayUnique:An,err:Pt,arrayGetVariables:xi,arraySum:Li,block:Bt,checkTimeout:en,clearU:X1,comboSort:V1,compare:Ri,convertToVector:l1,customError:jt,customType:L1,decompose_fn:o1,disarmTimeout:n1,each:Wn,evaluate:Nt,even:Ut,evenFraction:mn,fillHoles:Ui,firstObject:J0,format:qt,generatePrimes:i1,getCoeffs:qi,getU:Pi,importFunctions:Di,inBrackets:Mt,isArray:Dt,isCollection:dn,isExpression:r1,isFraction:_n,isInt:mt,isMatrix:St,isNegative:tn,isNumericSymbol:q0,isPrime:$0,isReserved:K0,isSet:bn,isSymbol:gt,isVariableSymbol:Qn,isVector:vt,keys:Cn,knownVariable:F1,nroots:Ti,remove:d0,reserveNames:k0,range:q1,round:m0,sameSign:O1,scientificToDecimal:F0,separate:s1,stringReplace:R1,text:Xt,validateName:w0,variables:n0,warn:In};function ki(){return(function(t,e,o,h){t1();try{let y=re.parser,L=re.state.EXPRESSIONS,b=!1;if((typeof t=="string"||typeof t=="function")&&On(t))return re.libExports;t!==null&&typeof t=="object"&&t instanceof S0&&(t=t.toString()),t!==null&&typeof t=="object"&&"text"in t&&typeof t.text=="function"&&(t=t.text()),Dt(o)||(o=typeof o>"u"?[]:[o]),o.forEach(V=>{if(V==="numer"){b=!0;return}let Y=y.functions[V];Y&&Y[1]===1&&(t=`${V}(${t})`)});let k=Bt("PARSE2NUMBER",()=>y.parse(t,e),b||Ie.PARSE2NUMBER),G=new S0(k);return h?L[h-1]=G:L.push(G),G}finally{n1()}})}function Bi(){let r=re.parser;return{groups:M1,NerdamerSymbol:W,Expression:S0,Collection:t0,Frac:Ve,Vector:It,Matrix:xt,NerdamerSet:g0,Math2:ut,LaTeX:yt,Build:e0,Utils:Fi,PARSER:r,Settings:Ie,bigInt:Nn,bigDec:rn,exceptions:re.exceptions,Solve:{},Calculus:{},Algebra:{},Extra:{}}}function Vi(){let r=re.parser;k0(r.CONSTANTS),k0(r.functions),r.initConstants(),r.error||=Pt,Ie.LOG_FNS={log:r.functions.log,log10:r.functions.log10}}function Xi(r){r.rpn=pi,r.convertToLaTeX=si,r.convertFromLaTeX=wi,r.version=J1,r.getWarnings=G1,r.setConstant=Mi,r.getConstant=ni,r.clearConstants=Ni,r.setFunction=bi,r.clearFunctions=vi,r.getCore=Y1,r.getExpression=r.getEquation=S0.getExpression,r.reserved=Q1,r.clear=Kn,r.flush=yi,r.expressions=mi,r.functions=di,r.register=e1,r.validateName=w0,r.validVarName=W1,r.supported=ei,r.numEquations=r.numExpressions=j1,r.setVar=Ai,r.getVar=ii,r.clearVars=Si,r.load=Ei,r.getVars=ri,r.set=Sn,r.get=z1,r.updateAPI=Ci,r.replaceFunction=gi,r.setOperator=ai,r.getOperator=oi,r.aliasOperator=li,r.tree=Yn,r.htmlTree=hi,r.addPeeker=ui,r.removePeeker=ci,r.parse=fi}var Gi=(function(){let t=new nn;re.parser=t,re.classes.Parser=nn,yt.initParser(),e0.initDependencies(),Vi();let e=Bi();re.core=e,re.classes.Math2=e.Math2,re.utils.symfunction=t.symfunction.bind(t),re.utils.callfunction=t.callfunction.bind(t),re.state.CONSTANTS=t.CONSTANTS;let o=ki();return re.libExports=o,Xi(o),o.updateAPI(),o})();typeof vn<"u"&&(vn.exports=Gi)});var V0=f0((Ji,a1)=>{"use strict";var B0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof a1<"u"&&B0===void 0&&(B0=T0(),X0());(function(){let t=B0.getCore(),e=t.PARSER,{Frac:o}=t,{Settings:h}=t,{isSymbol:y}=t.Utils,{FN:L}=t.groups,{NerdamerSymbol:b}=t,{text:k}=t.Utils,{inBrackets:G}=t.Utils,{isInt:V}=t.Utils,{format:Y}=t.Utils,{even:we}=t.Utils,{evaluate:Ee}=t.Utils,{N:Me}=t.groups,{S:se}=t.groups,{PL:ge}=t.groups,{CP:fe}=t.groups,{CB:a}=t.groups,{EX:Ne}=t.groups,{P:be}=t.groups,{LOG:Le}=h,Ae="exp",xe="abs",me="sqrt",_e="sin",ye="cos",he="tan",s="sec",f="csc",S="cot",_="asin",c="acos",m="atan",M="asec",q="acsc",F="acot",$="sinh",Q="cosh",K="tanh",ne="csch",pe="sech",Se="coth",ve="asech",Ue="acsch",De="acoth";function Je(j){return y(j.power)&&(j.power.group===se||j.power.group===a)}function rt(j){this.message=j||""}rt.prototype=new Error,b.prototype.hasIntegral=function(){return this.containsFunction("integrate")},b.prototype.fnTransform=function(){if(this.group!==L)return this;let X,D=this.args[0],ee=new b(this.multiplier),O=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case $:X=e.parse(Y("(e^({0})-e^(-({0})))/2",D));break;case Q:X=e.parse(Y("(e^({0})+e^(-({0})))/2",D));break;case K:X=e.parse(Y("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",D));break;case he:X=e.parse(Y("sin({0})/cos({0})",D));break;case f:X=e.parse(Y("1/sin({0})",D));break;case s:X=e.parse(Y("1/cos({0})",D));break;default:X=O}else if(this.power.equals(2))switch(this.fname){case _e:X=e.parse(Y("1/2-cos(2*({0}))/2",D));break;case ye:X=e.parse(Y("1/2+cos(2*({0}))/2",D));break;case he:X=e.parse(Y("sin({0})^2/cos({0})^2",D));break;case Q:X=e.parse(Y("1/2+cosh(2*({0}))/2",D));break;case $:X=e.parse(Y("-1/2+cosh(2*({0}))/2",D));break;case K:X=e.parse(Y("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",D));break;case s:X=e.parse(Y("(1-cos(2*({0})))/(1+cos(2*({0})))+1",D));break;default:X=O}else if(this.fname===s)X=e.parse(Y("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===f)X=e.parse(Y("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===he)this.power.lessThan(0)?X=e.parse(Y("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):X=e.parse(Y("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===_e&&this.power.lessThan(0))X=e.parse(Y("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===ye&&this.power.lessThan(0))X=e.parse(Y("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===_e&&this.power.equals(3))X=e.parse(Y("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===ye&&this.power.equals(3))X=e.parse(Y("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===ye||this.fname===_e)&&we(this.power)){let x=this.power/2,g=this.clone().toLinear(),p=e.pow(g,e.parse(2)),P=e.expand(e.pow(p.fnTransform(),e.parse(x)));X=new b(0),P.each(w=>{let U=w.fnTransform();X=e.add(X,U)},!0)}else X=O;return e.multiply(X,ee)},b.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===se)return!1;if(this.fname&&(t.Utils.inTrig(this.fname)||t.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let X in this.symbols)if(this.symbols[X].hasTrig())return!0}return!1},t.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},t.Utils.toCommonDenominator=function(X){if(X.isComposite()&&X.isLinear()){let D=new b(X.multiplier),ee=new b(1),O=new b(0);return X.each(g=>{ee=e.multiply(ee,g.getDenom())},!0),X.each(g=>{let p=g.getNum(),P=g.getDenom(),w=e.multiply(p,e.divide(ee.clone(),P));O=e.add(O,w)}),e.multiply(D,t.Algebra.divide(e.expand(O),e.expand(ee)))}return X},t.Utils.inInverseTrig=function(X){return[_,c,m,q,M,F].indexOf(X)!==-1},t.Utils.inTrig=function(X){return[ye,_e,he,s,f,S].indexOf(X)!==-1},t.Utils.inHtrig=function(X){return[$,Q,K,Ue,ve,De].indexOf(X)!==-1},t.Matrix.jacobian=function(X,D){let ee=new t.Matrix;return D||=t.Utils.arrayGetVariables(X),D.forEach((O,x)=>{X.forEach((g,p)=>{let P=t.Calculus.diff(g.clone(),O);ee.set(p,x,P)})}),ee},t.Matrix.prototype.max=function(){let X=new b(0);return this.each(D=>{let ee=D.abs();ee.gt(X)&&(X=ee)}),X},t.Matrix.cMatrix=function(X,D){let ee=new t.Matrix;return D.forEach((O,x)=>{ee.set(x,0,e.parse(X))}),ee};let qe=t.Utils.allFunctions=function(X){for(let D=0,ee=X.length;D<ee;D++)if(X[D].group!==L)return!1;return!0},Fe=t.Utils.cosAsinBtranform=function(X,D){let ee=X.args[0],O=D.args[0];return e.parse(Y("(sin(({0})+({1}))-sin(({0})-({1})))/2",ee,O))},$e=t.Utils.cosAsinAtranform=function(X,D){if(Number(D.power)!==1)return e.multiply(X,D);let ee=X.args[0];return e.parse(Y("(sin(2*({0})))/2",ee))},Xe=t.Utils.cosAsinBtranform=function(X,D){let ee=X.args[0],O=D.args[0];return e.parse(Y("(cos(({0})+({1}))-cos(({0})-({1})))/2",ee,O))},ke=t.Utils.trigTransform=function(X){let D={},ee,O,x=new b(1);for(let g=0,p=X.length;g<p;g++)if(ee=X[g],ee.group===L){let{fname:P}=ee;P===ye&&D[_e]?(D[_e].args[0].toString()===ee.args[0].toString()?O=$e(ee,D[_e]):O=Fe(ee,D[_e]),delete D[_e],x=e.multiply(x,O)):P===_e&&D[ye]?(D[ye].args[0].toString()===ee.args[0].toString()?O=$e(ee,D[ye]):O=Fe(ee,D[ye]),delete D[ye],x=e.multiply(x,O)):P===_e&&D[_e]?(D[_e].args[0].toString()===ee.args[0].toString()?(O=e.multiply(ee,D[_e]),delete D[_e]):(O=Xe(ee,D[_e]),delete D[_e]),x=O):D[P]=ee}else x=e.multiply(x,ee);for(let g in D)Object.hasOwn(D,g)&&(x=e.multiply(x,D[g]));return x};t.Settings.integration_depth=10,t.Settings.max_lim_depth=10;let z=t.Calculus={version:"1.4.6",sum(j,X,D,ee){if(X.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${k(X)} provided`);let O=X.value,x;if(t.Utils.isNumericSymbol(D)&&t.Utils.isNumericSymbol(ee)){let g=Number(ee)-Number(D)<200?"":"PARSE2NUMBER",p=Number(D),P=Number(ee);x=t.Utils.block(g,()=>{let w=j.text(),U={"~":!0},B=new t.NerdamerSymbol(0);for(let Z=p;Z<=P;Z++){U[O]=new b(Z);let J=e.parse(w,U);B=e.add(B,J)}return B})}else x=e.symfunction("sum",[j,new b(O),D,ee]);return x},product(j,X,D,ee){if(X.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${k(X)} provided`);let O=X.value,x;if(t.Utils.isNumericSymbol(D)&&t.Utils.isNumericSymbol(ee)){let g=Number(ee)-Number(D)<200?"":"PARSE2NUMBER";x=t.Utils.block(g,()=>{let p=Number(D),P=Number(ee.multiplier),w=j.text(),U={},B=new t.NerdamerSymbol(1);for(let Z=p;Z<=P;Z++)U[O]=new b(Z),B=e.multiply(B,e.parse(w,U));return B})}else x=e.symfunction("product",[j,new b(O),D,ee]);return x},diff(j,X,D){if(t.Utils.isVector(j)){let w=new t.Vector([]);return j.each(U=>{w.elements.push(z.diff(U,X,D))}),w}if(t.Utils.isMatrix(j)){let w=new t.Matrix;return j.each((U,B,Z)=>{w.set(B,Z,z.diff(U,X,D))}),w}let ee=j;if(ee.LHS&&ee.RHS)return new t.Equation(z.diff(ee.LHS.clone(),X,D),z.diff(ee.RHS.clone(),X,D));let O=y(X)?X.text():X;if(D=y(D)?D.multiplier.toDecimal():D||1,O===void 0&&(O=t.Utils.variables(j)[0]),ee.group===L&&ee.fname===me){let w=ee.args[0],U=ee.power.clone();(w.group!==Me||w.group!==be)&&(w.power=y(w.power)?e.multiply(e.multiply(w.power,new b(1/2)),new b(U)):w.power.multiply(new o(.5)).multiply(U),w.multiplier=w.multiplier.multiply(ee.multiplier)),j=w}if(j.group===L&&!y(j.power)){let w=g(e.parse(j)),U=z.diff(j.args[0].clone(),O);j=e.multiply(w,U)}else j=g(j);return D>1&&(D--,j=z.diff(j,X,D)),j;function x(w){return(w.value===O||w.contains(O,!0))&&(w.multiplier=w.multiplier.multiply(w.power),w.power=w.power.subtract(new o(1)),w.power.equals(0)&&(w=new b(w.multiplier))),w}function g(w){let U=w.group,B,Z,J;if(U===Me||U===se&&w.value!==O||U===be)w=new b(0);else if(U===se)w=x(w);else if(U===a){let ie=w.multiplier.clone();w.toUnitMultiplier();let le=e.multiply(P(w),x(w));return le.multiplier=le.multiplier.multiply(ie),le}else if(U===L&&w.power.equals(1)){let ie=w.multiplier.clone();switch(w.toUnitMultiplier(),w.fname){case Le:J=w.clone(),w=w.args[0].clone(),w.power=w.power.negate(),w.multiplier=J.multiplier.divide(w.multiplier);break;case ye:w.fname=_e,w.multiplier.negate();break;case _e:w.fname=ye;break;case he:w.fname=s,w.power=new o(2);break;case s:w=p(w,he);break;case f:w=p(w,"-cot");break;case S:w.fname=f,w.multiplier.negate(),w.power=new o(2);break;case _:w=e.parse(`(sqrt(1-(${k(w.args[0])})^2))^(-1)`);break;case c:w=e.parse(`-(sqrt(1-(${k(w.args[0])})^2))^(-1)`);break;case m:w=e.parse(`(1+(${k(w.args[0])})^2)^(-1)`);break;case xe:Z=w.args[0].clone(),Z.toUnitMultiplier(),w=e.parse(`${G(k(w.args[0]))}/abs${G(k(Z))}`);break;case"parens":w=new b(1);break;case"cosh":w.fname="sinh";break;case"sinh":w.fname="cosh";break;case K:w.fname=pe,w.power=new o(2);break;case pe:w=p(w,"-tanh");break;case ne:{let le=String(w.args[0]);w=e.parse(`-coth(${le})*csch(${le})`);break}case Se:{let le=String(w.args[0]);w=e.parse(`-csch(${le})^2`);break}case"asinh":w=e.parse(`(sqrt(1+(${k(w.args[0])})^2))^(-1)`);break;case"acosh":w=e.parse(`(sqrt(-1+(${k(w.args[0])})^2))^(-1)`);break;case"atanh":w=e.parse(`(1-(${k(w.args[0])})^2)^(-1)`);break;case ve:{let le=String(w.args[0]);w=e.parse(`-1/(sqrt(1/(${le})^2-1)*(${le})^2)`);break}case De:w=e.parse(`-1/((${w.args[0]})^2-1)`);break;case Ue:{let le=String(w.args[0]);w=e.parse(`-1/(sqrt(1/(${le})^2+1)*(${le})^2)`);break}case M:{let le=String(w.args[0]);w=e.parse(`1/(sqrt(1-1/(${le})^2)*(${le})^2)`);break}case q:{let le=String(w.args[0]);w=e.parse(`-1/(sqrt(1-1/(${le})^2)*(${le})^2)`);break}case F:w=e.parse(`-1/((${w.args[0]})^2+1)`);break;case"S":{let le=String(w.args[0]);w=e.parse(`sin((pi*(${le})^2)/2)`);break}case"C":{let le=String(w.args[0]);w=e.parse(`cos((pi*(${le})^2)/2)`);break}case"Si":{let le=w.args[0];w=e.parse(`sin(${le})/(${le})`);break}case"Shi":{let le=w.args[0];w=e.parse(`sinh(${le})/(${le})`);break}case"Ci":{let le=w.args[0];w=e.parse(`cos(${le})/(${le})`);break}case"Chi":{let le=w.args[0];w=e.parse(`cosh(${le})/(${le})`);break}case"Ei":{let le=w.args[0];w=e.parse(`e^(${le})/(${le})`);break}case"Li":{let le=w.args[0];w=e.parse(`1/${h.LOG}(${le})`);break}case"erf":w=e.parse(`(2*e^(-(${w.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let le=String(w.args[0]),te=String(w.args[1]);w=e.parse(`(${te})/((${te})^2+(${le})^2)`);break}case"sign":w=new b(0);break;case"sinc":w=e.parse(Y("(({0})*cos({0})-sin({0}))*({0})^(-2)",w.args[0]));break;case h.LOG10:w=e.parse(`1/((${w.args[0]})*${h.LOG}(10))`);break;default:w=e.symfunction("diff",[w,X])}w.multiplier=w.multiplier.multiply(ie)}else if(U===Ne||U===L&&y(w.power)){let ie;U===Ne?ie=w.value:U===L&&w.contains(O)?ie=w.fname+G(k(w.args[0])):ie=w.value+G(k(w.args[0])),Z=z.diff(e.multiply(e.parse(Le+G(ie)),w.power.clone()),O),w=e.multiply(w,Z)}else if(U===L&&!w.power.equals(1))Z=w.clone(),Z.toLinear(),Z.toUnitMultiplier(),w=e.multiply(x(w.clone()),g(Z));else if(U===fe||U===ge){let ie=w.clone(),le=new b(0);for(let te in w.symbols)Object.hasOwn(w.symbols,te)&&(le=e.add(le,z.diff(w.symbols[te].clone(),O)));w=e.multiply(x(ie),le)}return w.updateHash(),w}function p(w,U,B){return e.multiply(w,e.parse(U+G(B||k(w.args[0]))))}function P(w){let U=w.collectSymbols(),B=new b(0),Z=U.length;for(let J=0;J<Z;J++){let ie=z.diff(U[J].clone(),O);for(let le=0;le<Z;le++)J!==le&&(ie=e.multiply(ie,U[le].clone()));B=e.add(B,ie)}return B}},integration:{u_substitution(j,X){let D="__u__";function ee(U,B,Z){let J=z.diff(B,X),ie=Z?Z(U,B):e.divide(U.clone(),J);return ie.contains(X,!0)?null:ie}function O(U,B){let Z=z.integrate(e.symfunction(U,[new b(D)]),D,0);return Z=Z.sub(new b(D),B),Z.updateHash(),Z}let x=j[0].clone(),g=j[1].clone(),p=x.group,P=g.group,w;if(p===L&&P!==L){let U=x.args[0];if(w=ee(g,U.clone()),w)return e.multiply(w,O(x.fname,U));if(w=ee(g,x),w)return z.integration.poly_integrate(x)}else if(P===L&&p!==L){let U=g.args[0];if(w=ee(x,U.clone()),w)return e.multiply(w,O(g.fname,U))}else if(p===L&&P===L){if(w=ee(x.clone(),g.clone()),w||(w=ee(g.clone(),x.clone()),w))return e.multiply(z.integration.poly_integrate(g),w)}else if(p===Ne&&P!==Ne){let U=x.power;if(w=ee(g,y(U)?U.clone():new b(U)),!w){let J=z.integration.decompose_arg(y(U)?U.clone():new b(U),X),ie=z.diff(J[2].clone(),X),le=z.integration.decompose_arg(ie.clone(),X);if(e.multiply(J[1],le[1]).power.equals(g.power)){let te=e.divide(J[0].clone(),le[0].clone()),ae=e.multiply(te.clone(),e.pow(new b(x.value),e.multiply(J[0],new b(D))));return ae=e.multiply(ae,new b(D)),z.integration.by_parts(ae,D,0,{}).sub(D,J[1].clone())}}let B=z.integrate(x.sub(U.clone(),new b(D)),D,0);return e.multiply(B.sub(new b(D),U),w)}else if(P===Ne&&p!==Ne){let U=g.power;w=ee(x,U.clone());let B=z.integrate(g.sub(U,new b(D)),D,0);return e.multiply(B.sub(new b(D),U),w)}else if(x.isComposite()||g.isComposite()){let U=function(J,ie){let le=z.diff(ie,X),te=t.Algebra.Factor.factorInner(J),ae=t.Algebra.Factor.factorInner(le);return e.divide(te,ae)},B=x.isComposite()?x.clone().toLinear():x.clone(),Z=g.isComposite()?g.clone().toLinear():g.clone();if(w=ee(B.clone(),Z.clone(),U),w)return e.multiply(z.integration.poly_integrate(g),w);if(w=ee(Z.clone(),B.clone(),U),w)return e.multiply(z.integration.poly_integrate(x),w)}},poly_integrate(j){let X=j.power.toString(),D=j.multiplier.toDecimal(),ee=j.toUnitMultiplier().toLinear();return Number(X)===-1?e.multiply(new b(D),e.symfunction(Le,[ee])):e.parse(Y("({0})*({1})^(({2})+1)/(({2})+1)",D,ee,X))},stop(j){throw j||="Unable to compute integral!",t.Utils.warn(j),new rt(j)},partial_fraction(j,X,D,ee){y(X)||(X=e.parse(X));let O;O=new b(0);let x=t.Algebra.PartFrac.partfrac(j,X);return x.group===a&&x.isLinear()?(x.each(g=>{g.isLinear()||z.integration.stop()}),x.each(g=>{O=e.add(O,z.integrate(g,X,D,ee))})):O=e.add(O,z.integrate(x,X,D,ee)),O},get_udv(j){let X=[[],[],[],[],[]],D=function(x){let g=x.group;if(g===L){let{fname:p}=x;t.Utils.inTrig(p)||t.Utils.inHtrig(p)?X[3].push(x):t.Utils.inInverseTrig(p)?X[1].push(x):p===Le?X[0].push(x):z.integration.stop()}else g===se||x.isComposite()&&x.isLinear()||g===a&&x.isLinear()?X[2].push(x):g===Ne||x.isComposite()&&!x.isLinear()?X[4].push(x):z.integration.stop()};j.group===a?j.each(x=>{D(b.unwrapSQRT(x,!0))}):D(j);let ee,O=new b(1);for(let x=0;x<5;x++){let g=X[x],p,P=g.length;if(P>0){if(P>1){p=new b(1);for(let w=0;w<P;w++)p=e.multiply(p,g[w].clone())}else p=g[0].clone();ee?O=e.multiply(O,p):(ee=p,ee.multiplier=ee.multiplier.multiply(j.multiplier))}}return[ee,O]},trig_sub(j,X,D,ee,O,x){O||=z.integration.decompose_arg(j.clone().toLinear(),X);let g=O[3],p=O[2],P=O[0],w=O[1];if(w.power.equals(2)&&P.greaterThan(0)){let U=t.Utils.getU(j),B=e.parse(he+G(U)),Z=e.parse(`${s+G(U)}^2`),J=e.multiply(j.sub(w,B),Z),ie=z.integrate(J,U,D,ee).sub(B,w);return t.Utils.clearU(B),ie}},by_parts(j,X,D,ee){ee.previous||=[];let O,x=z.integration.get_udv(j),g=x[0],p=x[1],P=b.unwrapSQRT(e.expand(z.diff(g.clone(),X)),!0),w=P.clone().stripVar(X);P=e.divide(P,w.clone());let U=z.integrate(p.clone(),X,D||0),B=e.multiply(U.clone(),P),Z=B.toString();if(ee.previous.indexOf(Z)!==-1&&t.Utils.inTrig(g.fname)&&p.isE())return ee.is_cyclic=!0,new b(1);ee.previous.push(Z);let J=e.multiply(g,U),ie=B.multiplier.clone();B.toUnitMultiplier();let le=e.multiply(z.integrate(B.clone(),X,D,ee),w);if(le.multiplier=le.multiplier.multiply(ie),O=e.subtract(J,le),ee.is_cyclic&&(ee.previous.pop(),ee.previous.length===0)){O=e.expand(O);let te=new b(0);O.each(ae=>{ae.contains(X)||(te=e.add(te,ae.clone()))}),O=e.divide(e.subtract(O,te.clone()),e.subtract(new b(1),te))}return O},decompose_arg:t.Utils.decompose_fn},integrate(j,X,D,ee){if(!X){let O=t.Utils.variables(j);O.length===1&&(X=O[0]),X||="x"}if(t.Utils.isVector(j)){let O=new t.Vector([]);return j.each(x=>{O.elements.push(z.integrate(x,X))}),O}return isNaN(parseFloat(X))||e.error(`variable expected but received ${X}`),j.isConstant(!0)?e.multiply(j.clone(),e.parse(X)):(ee||={},t.Utils.block("PARSE2NUMBER",()=>{D||=0;let O=y(X)?X.toString():X,x=b.unwrapSQRT(j.clone(),!0),g=x.group,p;try{if(++D>t.Settings.integration_depth&&z.integration.stop("Maximum depth reached. Exiting!"),!x.contains(O,!0))p=e.multiply(x.clone(),e.parse(O));else if(g===se)p=z.integration.poly_integrate(x,O,D);else if(g===Ne)if(x.previousGroup===L&&!(x.fname==="sqrt"||x.fname===h.PARENTHESIS)&&z.integration.stop(),x.contains(O)&&x.previousGroup!==L)x.power.contains(O)?z.integration.stop():(z.diff(x.clone().toLinear(),O).contains(O)&&z.integration.stop(),p=z.integration.poly_integrate(x));else{let w=z.diff(x.power.clone(),O);if(w.contains(O)){let U=w.stripVar(O),B=e.divide(w.clone(),U.clone());if(B.group===se&&B.isLinear())return U.multiplier=U.multiplier.divide(new o(2)),e.parse(Y("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",U,O,x.multiplier));z.integration.stop()}if(x.isE())if(w.isLinear())p=x;else if(w.isE()&&y(w.power)&&w.power.group===se&&w.power.power.equals(1)){let U=y(x.power)?x.power:new b(x.power);p=e.multiply(e.symfunction("Ei",[U.clone()]),U)}else z.integration.stop();else{let U=e.symfunction(Le,[e.parse(x.value)]);p=e.divide(x,U)}p=e.divide(p,w)}else if(x.isComposite()&&x.isLinear()){let w=e.parse(x.multiplier);x.toUnitMultiplier(),p=new b(0),x.each(U=>{p=e.add(p,z.integrate(U,O,D))}),p=e.multiply(w,p)}else if(g===fe)if(x.power.greaterThan(1)&&(x=e.expand(x)),x.power.equals(1))p=new b(0),x.each(w=>{p=e.add(p,z.integrate(w,O,D))},!0);else{let w=Number(x.power),U=x.multiplier.clone();x.toUnitMultiplier();let B=x.clone().toLinear(),Z=z.integration.decompose_arg(B,O),J=Z[3],ie=Z[2],le=Z[0],te=Z[1];if(w===-1&&te.group!==ge&&te.power.equals(2)){let ae=V(J)?J>0:!0;if(te.group===se&&te.power.equals(2)&&ae){let de=function(je){let et=new b(1);return je.each(He=>{et=e.multiply(et,He.fname==="abs"?He.args[0]:He)}),et},Be=le.clone(),Te=J.clone();Be=e.pow(Be,new b(1/2)),Te=e.pow(Te,new b(1/2));let ze=e.multiply(de(Te),de(Be)),We=e.symfunction(m,[e.divide(e.multiply(le,te.toLinear()),ze.clone())]);p=e.divide(We,ze)}else if(te.group===se&&te.isLinear())p=e.divide(z.integration.poly_integrate(x),le);else if(te.power.equals(4)){let de=G,Be=e.parse(`${me+de(String(le))}*${O}^2`),Te=e.parse(`${me+de(String(2))}*${de(String(le))}^${de("1/4")}*${de(String(J))}^${de("1/4")}*${O}`),ze=e.parse(me+de(String(J))),We=e.add(e.add(Be.clone(),Te.clone()),ze.clone()),je=e.add(e.subtract(Be,Te),ze),et=e.parse(`${me+de(String(2))}*${de(String(J))}^${de("3/4")}`),He=e.parse(`${me+de(String(J))}*${de(String(J))}^${de("1/4")}*${O}`),lt=e.parse(`2*${de(String(J))}*${me}${de(String(2))}*${de(String(J))}^${de("1/4")}`),ct=e.divide(e.subtract(et.clone(),He.clone()),e.multiply(lt.clone(),je)),ft=e.divide(e.add(et,He),e.multiply(lt,We.clone()));p=e.add(z.integrate(ct,O,D,ee),z.integrate(ft,O,D,ee))}else p=z.integration.partial_fraction(x,O,D)}else if(w===-1/2)if(te.group===se&&te.power.equals(2))if(ie.multiplier.lessThan(0)&&!J.multiplier.lessThan(0))if(le.negate(),J.isConstant()&&le.isConstant()){let ae=e.symfunction(me,[le.clone()]),de=e.symfunction(me,[e.multiply(le.clone(),J)]);p=e.divide(e.symfunction(_,[e.divide(ie.toLinear(),de)]),ae)}else{let ae=e.symfunction(me,[le]),de=e.multiply(ae.clone(),te.clone().toLinear());p=e.divide(e.symfunction(m,[e.divide(de,e.symfunction(me,[B.clone()]))]),ae)}else z.integration.stop();else z.integration.stop();else if(w===1/2&&te.power.equals(2)&&le.greaterThan(0))z.integration.stop();else if(te.isLinear()&&te.group!==ge)p=e.divide(z.integration.poly_integrate(x),le);else if(te.power.equals(2)&&le.greaterThan(0)){let ae=e.parse(me+G(le)),de=e.parse(me+G(J)),Be=e.multiply(ae.clone(),de.clone()).invert(),Te=e.pow(J,new b(x.power.toDecimal())),ze=t.Utils.getU(x),We=e.multiply(Be,te.clone().toLinear()),je=e.symfunction(m,[We]),et=(Math.abs(Number(x.power))-1)*2,He=z.integrate(e.parse(`${ye+G(ze)}^${et}`));return t.Utils.clearU(ze),e.multiply(He.sub(ze,je),Te)}else if(x.group!==a&&!x.power.lessThan(0))p=z.integration.by_parts(x,O,D,ee);else{let ae=x.clone().toLinear(),Be=t.Algebra.Factor.factorInner(ae).toString()!==ae.toString();if(t.Algebra.degree(ae,e.parse(O)).equals(2)&&!Be)try{let Te=t.Algebra.sqComplete(ae,O),ze=t.Utils.getU(ae),We=Te.f.sub(Te.a,ze),je=e.pow(We,e.parse(x.power));p=z.integrate(je,ze).sub(ze,Te.a)}catch(Te){if(Te.message==="timeout")throw Te;z.integration.stop()}else p=z.integration.partial_fraction(x,O,D,ee)}p.multiplier=p.multiplier.multiply(U)}else if(g===L){let w=x.args[0],U=x.multiplier.clone();x.toUnitMultiplier();let B=z.integration.decompose_arg(w,O),Z=B[0],J=B[1],{fname:ie}=x;if(ie===Le||ie===_||ie===c||ie===m&&J.isLinear()){let le=x.power.toString();if(V(le)&&(D-=Number(le)),w.isComposite()){let te=t.Utils.getU(x),ae=e.pow(e.parse(Le+G(te)),new b(le)),de=z.diff(w,O),Be=e.multiply(ae,de),Te=z.integrate(Be,te,D,ee);p=e.multiply(e.parse(U),Te.sub(te,w))}else p=e.multiply(e.parse(U),z.integration.by_parts(x,O,D,ee))}else if(ie===he&&x.power.lessThan(0)){let le=x.clone();return le.power.negate(),le.fname=S,e.multiply(e.parse(U),z.integrate(le,O,D))}else{if(!Z.contains(O,!0)&&x.isLinear())if(ie===xe){let le=e.divide(w.clone(),Z.clone());if(le.group===se&&!le.power.lessThan(0))if(t.Utils.even(le.power))p=z.integrate(w,O,D);else{let te=z.integrate(le,O,D);te.power=te.power.subtract(new o(1)),p=e.multiply(e.multiply(e.symfunction(xe,[le.toLinear()]),te),Z)}else z.integration.stop()}else{let le=x.args[0].group,te=z.integration.decompose_arg(w,O);switch((!(le===fe||le===se||le===a)||!te[1].power.equals(1)||w.hasFunc(""))&&z.integration.stop(),ie){case ye:p=e.symfunction(_e,[w]);break;case _e:p=e.symfunction(ye,[w]),p.negate();break;case he:p=e.parse(Y(`${h.LOG}(sec({0}))`,w));break;case s:p=e.parse(Y(`${h.LOG}(tan({0})+sec({0}))`,w));break;case f:p=e.parse(Y(`-${h.LOG}(csc({0})+cot({0}))`,w));break;case S:p=e.parse(Y(`${h.LOG}(sin({0}))`,w));break;case $:p=e.symfunction(Q,[w]);break;case Q:p=e.symfunction($,[w]);break;case K:p=e.parse(Y(`${h.LOG}(cosh({0}))`,w));break;case M:p=z.integration.by_parts(x,O,D,ee);break;case q:p=z.integration.by_parts(x,O,D,ee);break;case F:p=z.integration.by_parts(x,O,D,ee);break;case ve:p=z.integration.by_parts(x,O,D,ee);break;case Ue:p=z.integration.by_parts(x,O,D,ee);break;case De:p=z.integration.by_parts(x,O,D,ee);break;case pe:p=e.parse(Y("atan(sinh({0}))",w));break;case ne:p=e.parse(Y(`${h.LOG}(tanh(({0})/2))`,w));break;case Se:p=e.parse(Y(`${h.LOG}(sinh({0}))`,w));break;case Ae:p=z.integrate(e.parse(Y("e^({0})",w)),O,D);break;case"S":{let ae=x.args[0].clone(),de=z.integration.decompose_arg(ae,O),Be=de[1],Te=de[0],ze=de[3];p=e.parse(Y("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Te,ze,J));break}case"C":{let ae=x.args[0].clone(),de=z.integration.decompose_arg(ae,O),Be=de[1],Te=de[0],ze=de[3];p=e.parse(Y("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Te,ze,Be));break}case"erf":{let ae=x.args[0].clone(),de=z.integration.decompose_arg(ae,O),Be=de[1],Te=de[0];p=e.parse(Y("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Te,Be,ae));break}case"sign":p=e.multiply(x.clone(),w.clone());break;default:z.integration.stop()}p=e.divide(p,Z)}else if(J.isLinear())if(ie===ye||ie===_e){let le=Number(x.power);if(le<0)x.fname=ie===_e?f:s,x.invert().updateHash(),p=z.integrate(x,O,D);else{let te=x.args[0],ae=x.clone(),de=x.clone(),Be=new b((le-1)/le),Te=e.multiply(Z.clone(),new b(le)).invert();ae.power=ae.power.subtract(new o(1)),de.power=de.power.subtract(new o(2));let ze=e.symfunction(ie===ye?_e:ye,[w.clone()]);ie===_e&&ze.negate(),p=e.add(e.multiply(e.multiply(Te,ae),ze),e.multiply(Be,z.integrate(e.parse(de),O,D)))}}else if(ie===he||ie===S){if(x.args[0].isLinear(O)){let le=x.power.subtract(new o(1)).toString(),te=x.clone().toUnitMultiplier(),ae=e.parse(Y(`${ie===S?"-":""}1/({2}*{0})*{3}({1})^({0})`,le,w,Z,ie));te.power=te.power.subtract(new o(2)),te.power.equals(0)&&(te=e.parse(te)),p=e.subtract(ae,z.integrate(te,O,D))}}else if(ie===s||ie===f){let le=x.power.subtract(new o(1)).toString(),te=x.power.subtract(new o(2)).toString(),ae=ie===s?he:S,de=x.clone().toUnitMultiplier(),Be=Y(`${ie===f?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,Z,le,te,w,ie,ae),Te=e.parse(Be);de.power=de.power.subtract(new o(2)),de.power.equals(0)&&(de=e.parse(de)),p=e.add(Te,e.multiply(new b(Number(te)/Number(le)),z.integrate(de,O,D)))}else(ie===Q||ie===$)&&x.power.equals(2)?p=z.integrate(x.fnTransform(),O,D):z.integration.stop();else z.integration.stop();p.multiplier=p.multiplier.multiply(U)}}else if(g===ge)p=z.integration.partial_fraction(x,O,D);else if(g===a){x.getDenom().group===se&&(x=e.expand(x));let U=x.stripVar(O),B=e.divide(x.clone(),U.clone());if(U.contains(O)&&(B=e.multiply(B,U),U=new b(1)),B.group===a){let Z=B.collectSymbols().sort((ie,le)=>ie.group===le.group?Number(ie.power)===Number(le.power)?ie<le?1:-1:Number(le.power)-Number(ie.power):le.group-ie.group).map(ie=>{let le=b.unwrapSQRT(ie,!0);return le.fname===Ae?e.parse(Y("({1})*e^({0})",le.args[0],le.multiplier)):le}),J=Z.length;if(Number(x.power)<0){if(J===2)return z.integrate(e.expand(x),O,D,ee)}else if(J===2){try{p=z.integration.u_substitution(Z,O)}catch(ie){if(ie.message==="timeout")throw ie}if(!p){let ie=Z[0].group,le=Z[1].group,te=Z[0],ae=Z[1],de=te.fname,Be=ae.fname;if(x=e.multiply(te.clone(),ae.clone()),ie===L&&le===L)if(de===Le||Be===Le)p=z.integration.by_parts(x.clone(),O,D,ee);else{Z.sort((He,lt)=>lt.fname>He.fname?1:-1);let Te=te.args[0];(!Te.isLinear()||!(Te.group===fe||Te.group===a||Te.group===se))&&z.integration.stop();let ze=z.integration.decompose_arg(Te,O),We=ze[1],je=ze[0];We.isLinear()||z.integration.stop();let et=ae.args[0];if(Te.equals(et))if(de===_e&&Be===ye||de===ye&&Be===_e)if(te.power.lessThan(0)&&z.integration.stop(),de===_e&&te.power.add(ae.power).equals(0))te.fname=he,te.updateHash(),p=z.integrate(te,O,D);else if(we(te.power)&&Be===ye&&ae.power.lessThan(0)){let He=Number(te.power)/2,lt=e.parse(Y("(1-cos({0})^2)^({1})",te.args[0],He));p=z.integrate(e.expand(e.multiply(lt,ae.clone())),O,D,ee)}else if(we(te.power)&&Be===_e&&ae.power.lessThan(0)){let He=Number(te.power)/2,lt=e.parse(Y("(1-sin({0})^2)^({1})",te.args[0],He));p=z.integrate(e.expand(e.multiply(lt,ae.clone())),O,D,ee)}else{let He=t.Utils.even(te.power),lt=t.Utils.even(ae.power);if(p=new b(0),!He||!lt){let ct,ft;He?(ct=te,ft=ae):(ct=ae,ft=te);let At=ct.fname===ye?-1:1,Tt=(Number(ft.power)-1)/2,pt=e.parse(`(1-${ct.fname}${t.Utils.inBrackets(Te.toString())}^2)^${Tt}`);e.expand(e.multiply(new b(At),e.multiply(ct.clone(),pt))).each(_t=>{p=e.add(p,z.integration.poly_integrate(_t.clone()))})}else{let ct=function(pt){let _t=pt.power/2,Ot;return pt.fname===ye?Ot=`((1/2)+(cos(2*(${pt.args[0]}))/2))^${_t}`:Ot=`((1/2)-(cos(2*(${pt.args[0]}))/2))^${_t}`,e.parse(Ot)},ft=ct(te),At=ct(ae),$t=e.multiply(ft,At);return e.expand($t).each(pt=>{p=e.add(p,z.integrate(pt,O,D))}),e.multiply(p,U)}}else if(de===s&&Be===he&&We.isLinear()&&ae.isLinear())p=e.parse(Y("sec({0})^({1})/({1})",te.args[0],te.power));else if(de===he&&Be===s&&We.isLinear())if(te.isLinear()&&ae.isLinear())p=e.divide(e.symfunction(s,[Te.clone()]),je);else if(we(te.power)){let He=Number(te.power)/2,lt=e.parse(Y("(sec({0})^2-1)^({1})",te.args[0],He));p=z.integrate(e.expand(e.multiply(lt,ae)),O,D)}else z.integration.stop();else if(de===s&&Be===ye)te.fname=ye,te.invert().updateHash(),p=z.integrate(e.multiply(te,ae),O,D);else if(de===_e&&Be===f)ae.fname=_e,ae.invert().updateHash(),p=z.integrate(e.multiply(te,ae),O,D);else if(de===he&&(Be===ye||Be===_e)&&ae.power.lessThan(0)){let He=e.multiply(te.fnTransform(),ae);p=z.integrate(e.expand(He),O,D)}else{let He=e.multiply(te.fnTransform(),ae.fnTransform());p=z.integrate(e.expand(He),O,D)}else if((de===_e||de===ye)&&(Be===_e||Be===ye))if(te.isLinear()&&ae.isLinear())if(te.args[0].isLinear()&&ae.args[0].isLinear()){let He,lt;Be===_e?(He=te.args[0],lt=ae.args[0]):(lt=te.args[0],He=ae.args[0]);let ct=e.parse(Y("(sin(({1})+({0}))+sin(({1})-({0})))/2",He.toString(),lt.toString()));p=z.integrate(ct,O,D)}else{let He=ke(Z);p=z.integrate(e.expand(He),O,D)}else{let He=new b(1);Z.forEach(ct=>{let ft=ct.fnTransform();He=e.multiply(He,ft)});let lt=e.expand(He);p=z.integrate(lt,O,D),p.hasIntegral()&&(p=z.integrate(ke(He.collectSymbols()),O,D))}else z.integration.stop()}else if(ie===L&&le===se){let Te=te.isLinear();if(te.fname===ye&&Te&&ae.power.equals(-1))p=e.symfunction("Ci",[te.args[0]]);else if(te.fname===ye&&ae.power.equals(-1))p=z.integrate(e.multiply(te.fnTransform(),ae.clone()),O,D);else if(te.fname===Q&&Te&&ae.power.equals(-1))p=e.symfunction("Chi",[te.args[0]]);else if(te.fname===Q&&ae.power.equals(-1))p=z.integrate(e.multiply(te.fnTransform(),ae.clone()),O,D);else if(te.fname===_e&&Te&&ae.power.equals(-1))p=e.symfunction("Si",[te.args[0]]);else if(te.fname===_e&&ae.power.equals(-1))p=z.integrate(e.multiply(te.fnTransform(),ae.clone()),O,D);else if(te.fname===$&&Te&&ae.power.equals(-1))p=e.symfunction("Shi",[te.args[0]]);else if(te.fname===$&&ae.power.equals(-1))p=z.integrate(e.multiply(te.fnTransform(),ae.clone()),O,D);else if(te.fname===Le&&ae.power.equals(-1))p=z.integration.poly_integrate(te,O,D);else if(te.fname==="erf"){if(ae.power.equals(1)){let ze=z.integration.decompose_arg(te.args[0],O),We=ze[0],je=ze[1],et=te.args[0].toString();p=e.parse(Y("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",We,je,et))}}else p=z.integration.by_parts(x,O,D,ee)}else if(ie===Ne&&le===se){let Te=de===Le?z.integration.decompose_arg(te.args[0],O)[1]:null;te.isE()&&Je(te)&&ae.power.equals(-1)?p=e.symfunction("Ei",[te.power.clone()]):de===Le&&Te.value===ae.value?p=z.integration.poly_integrate(te):p=z.integration.by_parts(x,O,D,ee)}else if(ie===ge&&le===se){if(ae.value===te.value&&te.power.equals(-1)){let Te=Math.min.apply(null,t.Utils.keys(te.symbols)),ze=Math.min(Te,Number(ae.power)),We=ae.clone();We.power=new o(ze),ae=e.divide(ae,We.clone());let je=new b(0);te.each(et=>{je=e.add(je,e.divide(et.clone(),We.clone()))}),je.multiplier=te.multiplier,x=e.divide(ae,je)}else x=e.expand(x);p=z.integration.partial_fraction(x,O,D)}else if(ie===fe&&le===se){let Te=te.clone().toLinear(),ze=t.Algebra.degree(Te,e.parse(O)).equals(1);if(te.power.equals(-1/2)){let We=z.integration.decompose_arg(te.clone().toLinear(),O),je=We[0].negate(),et=We[1],He=We[3],lt=Number(te.power),ct=Number(ae.power);if(V(ct)&&t.Utils.even(ct)&&et.power.equals(2)){let ft=e.divide(e.multiply(e.pow(He.clone(),new b(2)),e.symfunction(me,[e.divide(He.clone(),je.clone())])),e.pow(je.clone(),new b(2)));ft=e.multiply(ft,e.symfunction(me,[He]).invert());let At=e.parse("sin(u)");At.power=At.power.multiply(ae.power);let $t=z.integrate(At,"u",D),Tt=e.parse(`${_}(${me}(${je}/${He})*${O})`);p=e.multiply(ft,$t.sub(new b("u"),Tt))}else if(lt===-1/2){let ft=function(At,$t){let Tt=e.parse(z.integrate(At,O,D,ee).sub(O,Y($t,O)));if(!Tt.hasIntegral())return Tt};ct===-1?p=ft(e.expand(e.expand(e.pow(e.multiply(te.invert(),ae.invert()),new b(2)))).invert(),"sqrt(1-1/({0})^2)"):ct===-2&&(p=ft(e.sqrt(e.expand(e.divide(e.pow(x,new b(2)).invert(),e.pow(new b(O),new b(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(te.power.equals(-1)&&ae.isLinear()&&ze)p=z.integration.partial_fraction(x,O,D);else if(!te.power.lessThan(0)&&V(te.power)){let We=e.expand(te);p=new b(0),We.each(je=>{je.group===ge?je.each(et=>{p=e.add(p,z.integrate(e.multiply(ae.clone(),et),O,D))}):p=e.add(p,z.integrate(e.multiply(ae.clone(),je),O,D))})}else if(te.power.lessThan(-2))p=z.integration.by_parts(x,O,D,ee);else if(te.power.lessThan(0)&&ae.power.greaterThan(1)){let We=z.integration.decompose_arg(te.clone().toLinear(),O),je=We[0].negate(),et=We[1],He=We[3],lt=te.clone().toLinear();if(et.group!==ge&&et.isLinear()){let ct=Number(ae.power),ft="_u_",At=new b(ft),$t=e.expand(e.divide(e.pow(e.subtract(At.clone(),He.clone()),new b(ct)),At.clone())),Tt={};Tt[ft]=lt;let pt=e.parse($t,Tt);p=z.integrate(pt,O,0)}else if(ae.power.greaterThan(et.power)||ae.power.equals(et.power)){let ct=new t.Algebra.Classes.Factors;te=t.Algebra.Factor.coeffFactor(te.invert(),ct);let ft=t.Algebra.divide(ae,te);ft.group===a?p=z.integration.by_parts(x,O,D,ee):(p=new b(0),ft.each(At=>{p=e.add(p,z.integrate(At,O,D))}),ct.each(At=>{p=e.divide(p,At)}),p=e.expand(p))}else p=z.integration.partial_fraction(x,O,D)}else if(te.power.den.equals(2)){let We=z.integration.decompose_arg(te.clone().toLinear(),O),je=We[3],et=We[1],He=We[0],lt=We[2];if(et.power.equals(2)&&He.lessThan(0)){je.equals(1)||(U=e.multiply(U,e.pow(je,new b(2))));let ct=O,ft=e.divide(e.pow(He.clone().negate(),new b(1/2)),e.pow(je,new b(1/2))),At=e.symfunction(ye,[new b(ct)]),$t=e.pow(e.symfunction(ye,[new b(ct)]),new b(Number(te.power.num))),Tt=e.pow(e.symfunction(_e,[new b(ct)]),new b(Number(ae.power))),pt=e.multiply(e.multiply($t,At),Tt);p=z.integrate(pt,ct,D).sub(ct,e.symfunction(_,[e.multiply(new b(O),ft)]))}else p=z.integration.partial_fraction(x,O,D,ee)}else ze&&(p=z.integration.partial_fraction(x,O,D))}else if(te.isComposite()&&ae.isComposite())if(p=new b(0),te.power.greaterThan(0)&&ae.power.greaterThan(0))e.expand(x).each(ze=>{p=e.add(p,z.integrate(ze,O,D))},!0);else{let Te=Number(te.power),ze=Number(ae.power);if(Te<0&&ze>0){let We=te;te=ae,ae=We}Te===-1&&ze===-1?p=z.integration.partial_fraction(x,O):te.each(We=>{let je=e.multiply(We,ae.clone()),et=z.integrate(je,O,D);p=e.add(p,et)})}else if(ie===fe&&Z[0].power.greaterThan(0))te=e.expand(te),p=new b(0),te.each(Te=>{p=e.add(p,z.integrate(e.multiply(Te,ae.clone()),O,D))},!0);else if(ie===L&&le===Ne&&t.Utils.inHtrig(te.fname))te=te.fnTransform(),p=z.integrate(e.expand(e.multiply(te,ae)),O,D);else if(ie===L&&le===fe||le===L&&ie===fe){if(le===L&&ie===fe){let lt=te;te=ae,ae=lt}let Te,ze,We,je,et=b.unwrapSQRT(z.diff(te.clone(),O),!0),He=b.unwrapSQRT(ae,!0);if(et.power.equals(He.power)){if(Te=new b(Number(ae.power)),We=et.clone().toLinear(),je=ae.clone().toLinear(),ze=t.Algebra.divide(We.toLinear(),je),ze.isConstant()){let lt=e.pow(ze,Te.negate());p=e.multiply(lt,z.integration.poly_integrate(te.clone()))}}else p=z.integration.by_parts(x,O,D,ee)}else{let Te=te.clone().toLinear(),ze=ae.clone().toLinear();ie===Ne&&le===Ne&&te.power.contains(O)&&ae.power.contains(O)&&!Te.contains(O)&&!ze.contains(O)?p=e.parse(Y("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Te.toString(),ze.toString(),te.power.multiplier.toString(),ae.power.multiplier.toString(),O)):p=z.integration.by_parts(x,O,D,ee)}}}else if(J===3&&(Z[2].group===se&&Z[2].power.lessThan(2)||Z[0].group===fe)){let ie=Z[0];if(ie.group===fe){ie.power.greaterThan(1)&&(ie=e.expand(ie));let le=e.multiply(Z[1],Z[2]);p=new b(0),ie.each(te=>{let ae=e.multiply(te,le.clone()),de=z.integrate(ae,O,D);p=e.add(p,de)},!0)}else p=z.integration.by_parts(x,O,D,ee)}else if(qe(Z)){let ie=new b(1);for(let le=0,te=Z.length;le<te;le++)ie=e.multiply(ie,Z[le].fnTransform());ie=e.expand(ie),p=z.integrate(ie,O,D)}else{let ie=ke(Z);p=z.integrate(e.expand(ie),O,D)}}else{if(B.equals(1))return z.integrate(e.expand(x),O,D);B.clone().toLinear().isPoly(!0)&&t.Utils.variables(B).length>1&&(B=t.Algebra.Factor.factorInner(B)),p=z.integrate(B,O,D)}p=e.multiply(p,U)}if(p)return p}catch(w){if(w.message==="timeout"||!(w instanceof rt||w instanceof t.exceptions.DivisionByZero))throw w}let P=y(X)?X.toString():X;return e.symfunction("integrate",[j,new b(P)])},!1))},defint(j,X,D,ee){ee||="x";let O=function(w,U,B){try{return e.parse(w,U)}catch(Z){if(Z.message==="timeout")throw Z;return z.Limit.limit(w,ee,B)}},x=t.Utils.variables(j),g=j.hasTrig(),p,P;if(x.length===1&&!ee&&(ee=x[0]),g||(P=z.integrate(j,ee)),!g&&!P.hasIntegral()){let w={},U={};w[ee]=D,U[ee]=X;let B=O(P,w,D),Z=O(P,U,X);p=e.subtract(B,Z)}else if(x.length===1&&X.isConstant()&&D.isConstant()){let w=t.Build.build(j);p=new b(t.Math2.num_integrate(w,Number(X),Number(D)))}else p=e.symfunction("defint",[j,X,D,new b(ee)]);return p},Limit:{interval(j,X){return e.parse(Y("[{0}, {1}]",j,X))},diverges(){return z.Limit.interval("-Infinity","Infinity")},divide(j,X,D,ee,O){if(O++>h.max_lim_depth)return;let x=j.clone(),g=X.clone();if(X.fname===xe){let te=j.sign(),ae=ee.sign();if(ee.isInfinity)return e.multiply(new b(te),new b(ae));if(ee.equals(0)){let de=e.parse(j.multiplier),Be=e.parse(X.multiplier);return e.divide(e.multiply(de,z.Limit.interval("-1","1")),Be)}return z.Limit.diverges()}let p=function(te){if(t.Utils.isVector(te)){let ae=te;for(let de=0;de<ae.elements.length;de++)if(!ae.elements[de].isInfinity)return!1;return!0}return te.isInfinity},P=function(te,ae){return t.Utils.isVector(te)?!1:te.equals(ae)},w,U=0,B,Z,J;do if(B=Ee(z.Limit.limit(j.clone(),D,ee,O)),Z=Ee(z.Limit.limit(X.clone(),D,ee,O)),J=p(B)&&p(Z)||P(B,0)&&P(Z,0),J){let te=z.diff(j.clone(),D),ae=z.diff(X.clone(),D),de=e.divide(te,ae);j=de.getNum(),X=de.getDenom()}while(J&&++U<h.max_lim_depth);if(U>=h.max_lim_depth)return;let ie=Z.equals(0),le=Number(g.power);return ee.isConstant(!0)&&ie?w=b.infinity(B.lessThan(0)?-1:void 0):ie?w=z.Limit.diverges():w=e.divide(B,Z),w},rewriteToLog(j){let X=j.power.clone();return j.toLinear(),e.pow(new b("e"),e.multiply(X,e.symfunction(`${h.LOG}`,[j])))},getSubbed(j,X,D){let ee;j.group===Ne&&(j=z.Limit.rewriteToLog(j));try{ee=j.sub(X,D)}catch(O){if(O.message==="timeout")throw O;ee=j}return ee},isInterval(j){return t.Utils.isVector(j)},isConvergent(j){return!(z.Limit.isInterval(j)&&j.elements[0].isInfinity&&j.elements[1].isInfinity||j.containsFunction("limit"))},limit(j,X,D,ee){if(j.isLinear()&&j.isComposite()){let g=new b(0);return j.each(p=>{g=e.add(g,z.Limit.limit(p,X,D,ee))},!0),g}if(j=t.Algebra.Simplify.simplify(j),ee||=1,ee++>h.max_lim_depth)return;let O=e.parse(j.multiplier);j.toUnitMultiplier();let x;try{if(j.isConstant(!0))x=j;else{let g={};g[X]=D;try{let p=e.parse(j.sub(X,D),g);(p.isConstant(!0)||p.isInfinity)&&(x=p)}catch(p){if(p.message==="timeout")throw p}if(!x){let p=j.getNum(),P=j.getDenom();if(P.isConstant(!0)){if(j.group===Ne){let w=j.clone().toLinear(),U=j.power.clone(),B=w.getNum(),Z=w.getDenom(),J=t.Utils.decompose_fn(Z,X,!0);if(B.group===se&&B.multiplier.isOne()&&J.ax.group===se&&J.b.isConstant(!0)&&J.a.isOne()&&J.b.isConstant(!0))x=e.parse(Y("(1/e^({0}))",J.b));else{let ie=z.Limit.rewriteToLog(j.clone()),le=ie.power.clone(),te=ie.clone().toLinear(),ae=z.Limit.limit(te,X,D,ee),de=z.Limit.limit(le,X,D,ee);x=e.pow(ae,de)}}else if(j.group===L&&j.args.length===1){let w,U=z.Limit.limit(j.args[0],X,D,ee);if(t.Utils.isVector(U))return x=U.map(Z=>{let J=j.clone();return J.args[0]=Z,z.Limit.limit(e.symfunction(j.fname,[Z]),X,D,ee)}),e.multiply(O,x);let B;if(U.isConstant(!0)){B=e.symfunction(j.fname,[U]);try{Ee(B),w=!0}catch(Z){if(Z.message==="timeout")throw Z;w=!1}}if(w)x=B;else if(z.Limit.isConvergent(U)){if(j.fname===Le)switch(U.toString()){case"0":x=b.infinity().negate();break;case"Infinity":x=b.infinity();break;case"-Infinity":x=b.infinity();break}else if((j.fname===ye||j.fname===_e)&&D.isInfinity)x=z.Limit.interval(-1,1);else if(j.fname===he){let Z=j.args[0],J=Z.getNum(),ie=Z.getDenom(),le=J.toUnitMultiplier();(D.isInfinity||le.equals("pi")&&ie.equals(2))&&(x=z.Limit.diverges())}else if(j.fname===h.FACTORIAL&&U.isInfinity)return b.infinity()}}else if(j.group===se){if(Number(j.power)>0)return e.parse(j,g);t.Utils.even(j.power)?x=b.infinity():x=z.Limit.diverges()}else if(j.group===a){let w,U,B=j.collectSymbols().sort((J,ie)=>J.group-ie.group),Z=B.pop();for(w=Ee(z.Limit.limit(Z,X,D,ee));B.length;){let J=B.pop();U=Ee(z.Limit.limit(J,X,D,ee)),w.isInfinity||!z.Limit.isConvergent(w)&&U.equals(0)||w.equals(0)&&z.Limit.isConvergent(U)?(J.containsFunction(Le)&&(J=[Z,Z=J][0]),J.invert(),w.isInfinity&&U.isInfinity?w=b.infinity():w=z.Limit.divide(Z,J,X,D,ee)):(w=e.multiply(w,U),Z=e.multiply(Z,J))}x=w}else if(j.isComposite()){let w;j.isLinear()||(j=e.expand(j)),x=new b(0);let U=j.collectSymbols().sort((J,ie)=>ie.group-J.group),B=[],Z=new b(0);for(let J=0,ie=U.length;J<ie;J++){let le=U[J].clone();le.group===L||le.group===a&&le.hasFunc("")?Z=e.add(Z,le):B.push(le)}B.unshift(Z),B.length!==1&&(U=B);for(let J=0,ie=U.length;J<ie;J++){let le=U[J];try{w=z.Limit.limit(le,X,D,ee)}catch(te){if(te.message==="timeout")throw te;w=z.Limit.diverges()}try{x=e.add(x,w)}catch(te){if(te.message==="timeout")throw te;if(ee++>h.max_lim_depth)return;x=z.Limit.limit(z.diff(j,X),X,D,ee)}}}}else x=z.Limit.divide(p,P,X,D,ee)}}x||=e.symfunction("limit",[j,new b(X),D])}catch(g){if(g.message==="timeout")throw g;x=e.symfunction("limit",[j,new b(X),D])}return e.multiply(O,x)}},Fresnel:{S(j){return j.isConstant(!0)?z.defint(e.parse("sin(pi*x^2/2)"),new b(0),j,"x"):e.symfunction("S",[j])},C(j){return j.isConstant(!0)?z.defint(e.parse("cos(pi*x^2/2)"),new b(0),j,"x"):e.symfunction("C",[j])}}};B0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return z.diff}},{name:"sum",visible:!0,numargs:4,build(){return z.sum}},{name:"product",visible:!0,numargs:4,build(){return z.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return z.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return z.defint}},{name:"S",visible:!0,numargs:1,build(){return z.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return z.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return z.Limit.limit}}]),B0.updateAPI()})()});var X0=f0((Yi,u1)=>{"use strict";var h0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof u1<"u"&&h0===void 0&&(h0=T0(),V0());(function(){let t=h0.getCore(),e=t.PARSER,{N:o,P:h,S:y,EX:L,FN:b,PL:k,CP:G,CB:V}=t.groups,{keys:Y,even:we,variables:Ee,format:Me,round:se,isInt:ge}=t.Utils,{Frac:fe,NerdamerSymbol:a,Vector:Ne,Expression:be}=t,{CONST_HASH:Le}=t.Settings,Ae=t.Utils.importFunctions(),xe=t.Utils.evaluate;function me(s,f,S){if(this.coeffs=[],this.variable="",t.Utils.isSymbol(s))this.parse(s),this.variable||=f||"";else if(typeof s=="number"&&!isNaN(s)){if(S||=0,f===void 0)throw new t.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[S]=new fe(s),this.fill(s)}else typeof s=="string"&&this.parse(e.parse(s))}me.fromArray=function(f,S){if(typeof S>"u")throw new t.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let _=new me;return _.coeffs=f,_.variable=S,_},me.fit=function(f,S,_,c,m,M){let q=new Array(m+1),F=_-S;q[0]=S,q[m]=f,F-=f*c**m;for(let $=m-1;$>0;$--){let Q=c**$,K=F/Q,pe=Math.sign(K)*Math.floor(Math.abs(K));F-=pe*Q,q[$]=pe}if(F!==0)return null;for(let $=0;$<q.length;$++)q[$]=new fe(q[$]);return me.fromArray(q,M)},me.prototype={parse(s,f){if(this.variable=Ee(s)[0],!s.isPoly())throw new t.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${t.Utils.text(s)}`);if(f||=[],s.power.absEquals(1)||(s=e.expand(s)),s.group===t.groups.N)f[0]=s.multiplier;else if(s.group===t.groups.S)f[Number(s.power.toDecimal())]=s.multiplier;else for(let S in s.symbols){if(!Object.hasOwn(s.symbols,S))continue;let _=s.symbols[S],c=_.power;if(t.Utils.isSymbol(c))throw new t.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");let m=_.group===o?0:Number(c.toDecimal());_.symbols?this.parse(_,f):f[m]=_.multiplier}this.coeffs=f,this.fill()},fill(s){s=Number(s)||0;let f=this.coeffs.length;for(let S=0;S<f;S++)this.coeffs[S]===void 0&&(this.coeffs[S]=new fe(s));return this},trim(){let s=this.coeffs.length;for(;s--;){let f=this.coeffs[s],S=f.equals(0);if(f&&S){if(s===0)break;this.coeffs.pop()}else break}return this},modP(s){let f=this.coeffs.length;for(let S=0;S<f;S++){let _=this.coeffs[S],c;if(_.lessThan(0)){let q;for(c=S;c<f;c++)if(this.coeffs[c].greaterThan(0)){q=this.coeffs[c];break}if(q){for(;c>S;c--)this.coeffs[c]=this.coeffs[c].subtract(new fe(1)),this.coeffs[c-1]=this.coeffs[c-1].add(new fe(s));_=this.coeffs[S]}}let m=_.mod(new fe(s)),M=_.subtract(m).divide(new fe(s));if(!M.equals(0)){let q=S+1,F=this.coeffs[q]||new fe(0);F=F.add(M),this.coeffs[q]=F,this.coeffs[S]=m}}return this},add(s){let f=Math.max(this.coeffs.length,s.coeffs.length);for(let S=0;S<f;S++){let _=this.coeffs[S]||new fe(0),c=s.coeffs[S]||new fe(0);this.coeffs[S]=_.add(c)}return this},subtract(s){let f=Math.max(this.coeffs.length,s.coeffs.length);for(let S=0;S<f;S++){let _=this.coeffs[S]||new fe(0),c=s.coeffs[S]||new fe(0);this.coeffs[S]=_.subtract(c)}return this},divide(s){let{variable:f}=this,S=t.Utils.arrayClone(this.coeffs),_=t.Utils.arrayClone(s.coeffs),c=S.length,m=_.length-1,M=[];for(let $=0;$<c;$++){let Q=c-($+1),K=Q-m,ne=S[Q].divide(_[m]);if(K<0)break;M[K]=ne;for(let pe=0;pe<=m;pe++)S[pe+K]=S[pe+K].subtract(_[pe].multiply(ne))}let q=me.fromArray(S,f||"x").trim();return[me.fromArray(M,f||"x"),q]},multiply(s){let f=this.coeffs.length,S=s.coeffs.length,_=[];for(let c=0;c<f;c++){let m=this.coeffs[c];for(let M=0;M<S;M++){let q=c+M,F=s.coeffs[M],$=_[q]||new fe(0);_[q]=$.add(m.multiply(F))}}return this.coeffs=_,this},isZero(){let s=this.coeffs.length;for(let f=0;f<s;f++)if(!this.coeffs[f].equals(0))return!1;return!0},sub(s){let f=new fe(0),S=this.coeffs.length;for(let _=0;_<S;_++){let c=this.coeffs[_];c.equals(0)||(f=f.add(c.multiply(new fe(s**_))))}return f},clone(){let s=new me;return s.coeffs=this.coeffs.slice(),s.variable=this.variable,s},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let s=this.lc(),f=this.coeffs.length;for(let S=0;S<f;S++)this.coeffs[S]=this.coeffs[S].divide(s);return this},gcd(s){let f=this.coeffs.length-1,S=s.coeffs.length-1,_;if(f<S)return s.gcd(this);let c=this;for(;!s.isZero();){let M=s.clone();c=c.clone(),_=c.divide(M),s=_[1],c=M}let m=t.Math2.QGCD.apply(null,c.coeffs);if(!m.equals(1)){let M=c.coeffs.length;for(let q=0;q<M;q++)c.coeffs[q]=c.coeffs[q].divide(m)}return c},diff(){let s=[],f=this.coeffs.length;for(let S=1;S<f;S++)s.push(this.coeffs[S].multiply(new fe(S)));return this.coeffs=s,this},integrate(){let s=[new fe(0)],f=this.coeffs.length;for(let S=0;S<f;S++){let _=new fe(S+1);s[S+1]=this.coeffs[S].divide(_)}return this.coeffs=s,this},gcf(s){let f=function(c){for(let m=0;m<c.length;m++)if(!c[m].equals(0))return m},S=[];for(let c=0;c<this.coeffs.length;c++){let m=this.coeffs[c];!m.equals(0)&&S.indexOf(m)===-1&&S.push(m)}let _=[t.Math2.QGCD.apply(void 0,S),f(this.coeffs)||0];if(s){let c=[];c[_[1]-1]=_[0],_=me.fromArray(c,this.variable).fill()}return _},quad(s){let f=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let S=this.coeffs[2]?Number(this.coeffs[2].toDecimal()):0,_=this.coeffs[1]?Number(this.coeffs[1].toDecimal()):0,c=Number(this.coeffs[0].toDecimal()),m=_*_-4*S*c;return m<0&&!s||(f[0]=(-_+Math.sqrt(m))/(2*S),f[1]=(-_-Math.sqrt(m))/(2*S)),f},squareFree(){let s=this.clone(),f=1,S=s.clone().diff(),_=s.clone().gcd(S),c=s.divide(_)[0],m=me.fromArray([new fe(1)],s.variable);for(;!_.equalsNumber(1);){let M=c.gcd(_),q=c.divide(M)[0];if(!q.equalsNumber(1)&&f>1){let F=q.clone();for(let $=1;$<f;$++)F.multiply(q.clone());q=F}m=m.multiply(q),f++,c=M,_=_.divide(M)[0]}return[m,c,f]},toSymbol(){let s=this.coeffs.length,{variable:f}=this;if(s===0)return new a(0);if(!f)throw new t.exceptions.NerdamerTypeError("Polynomial.toSymbol requires a variable. Constants should not be converted to Polynomial.");let S=[];for(let _=0;_<s;_++){let c=this.coeffs[_];c.equals(0)||S.push(`${c}*${f}^${_}`)}return S.length===0?new a(0):e.parse(S.join("+"))},equalsNumber(s){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(s)},toString(){return this.toSymbol().toString()}},a.prototype.coeffs=function(f,S){S&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),f||=[];let _=this.clone().distributeMultiplier();if(_.isComposite())for(let c in _.symbols){if(!Object.hasOwn(_.symbols,c))continue;let m=_.symbols[c];m.isComposite()?m.clone().distributeMultiplier().coeffs(f,S):S?f[m.isConstant()?0:Number(m.power.toDecimal())]=m.multiplier:f.push(m.multiplier)}else if(S)f[_.isConstant(!0)?0:Number(_.power.toDecimal())]=_.multiplier;else if(_.group===V&&_.isImaginary()){let c=new a(_.multiplier);_.each(m=>{(m.isConstant(!0)||m.imaginary)&&(c=e.multiply(c,m))}),f.push(c)}else f.push(_.multiplier);if(S)for(let c=0;c<f.length;c++)f[c]===void 0&&(f[c]=new a(0));return f},a.prototype.tBase=function(f){if(typeof f>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let S=[],_=this.collectSymbols(null,null,null,!0),c=_.length;for(let m=0;m<c;m++){let M=_[m],q=M.group,F=new ye(M.multiplier,[],f);if(q===V)for(let $ in M.symbols){if(!Object.hasOwn(M.symbols,$))continue;let Q=M.symbols[$];F.terms[f[$]]=Q.power}else F.terms[f[M.value]]=M.power;S.push(F.fill()),F.updateCount()}return S},a.prototype.altVar=function(f){let S=this.multiplier.toString(),_=this.power.toString();return(S==="1"?"":`${S}*`)+f+(_==="1"?"":`^${_}`)},a.prototype.sameVars=function(f){if(!(this.symbols||this.group===f.group))return!1;for(let S in this.symbols){if(!Object.hasOwn(this.symbols,S))continue;let _=this.symbols[S],c=f.symbols[S];if(!c||_.value!==c.value)return!1}return!0},a.prototype.groupTerms=function(f){f=String(f);let S,_,c,m=[];return this.each(M=>{if(M.group===k){c=M.groupTerms(f);for(let q=0;q<c.length;q++){let F=c[q];F&&(m[q]=F)}}else S=t.Utils.decompose_fn(M,f,!0),_=S.x.value===f?Number(S.x.power):0,m[_]=e.add(m[_]||new a(0),S.a)}),m},a.prototype.collectFactors=function(){let f=[];return this.group===V?this.each(S=>{f.push(S.clone())}):f.push(this.clone()),f};function _e(){this.factors={},this.length=0,this.preAdd=void 0,this.pFactor=void 0}_e.prototype.getNumberSymbolics=function(){let f=0;return this.each(S=>{S.isConstant(!0)||f++}),f},_e.prototype.add=function(f){if(f.equals(0))return this;if(f.equals(-1)&&this.length>0){let S=t.Utils.firstObject(this.factors,null,!0),_=e.symfunction(t.Settings.PARENTHESIS,[S.obj]).negate();return delete this.factors[S.key],this.add(_),this.length--,this}if(f.group===V){let S=this;f.multiplier.equals(1)||S.add(new a(f.multiplier)),f.each(_=>{S.add(_)})}else{this.preAdd&&(f=this.preAdd(f)),this.pFactor&&(f=e.pow(f,new a(this.pFactor)));let S=f.isConstant();if(S&&f.equals(1))return this;let _=S?f.value:f.text();_ in this.factors?(this.factors[_]=e.multiply(this.factors[_],f),this.factors[_].equals(1)&&(delete this.factors[_],this.length--)):(this.factors[_]=f,this.length++)}return this},_e.prototype.toSymbol=function(){let f=new a(1),S=Object.values(this.factors).sort((_,c)=>_.group>c.group?1:-1);for(let _=0,c=S.length;_<c;_++){let m=S[_],M=m.power.equals(1)&&m.fname!==""?e.symfunction(t.Settings.PARENTHESIS,[m]):m;f=e.multiply(f,M)}return f.fname===""&&(f=a.unwrapPARENS(f)),f},_e.prototype.merge=function(f){for(let S in f)S in this.factors?this.factors[S]=e.multiply(this.factors[S],f[S]):this.factors[S]=f[S];return this},_e.prototype.each=function(f){for(let S in this.factors){if(!Object.hasOwn(this.factors,S))continue;let _=this.factors[S];_.fname===t.Settings.PARENTHESIS&&_.isLinear()&&(_=_.args[0]),f.call(this,_,S)}return this},_e.prototype.count=function(){return Y(this.factors).length},_e.prototype.clean=function(){try{let f=t.Settings.CONST_HASH;this.factors[f].lessThan(0)&&(this.factors[f].equals(-1)?delete this.factors[f]:this.factors[f].negate(),this.each(S=>{S.negate()}))}catch(f){if(f.message==="timeout")throw f}},_e.prototype.toString=function(){return this.toSymbol().toString()};function ye(s,f,S){this.terms=f||[],this.coeff=s,this.map=S,this.sum=new fe(0),this.image=void 0,this.revMap=void 0,this.count=void 0}ye.prototype.updateCount=function(){this.count||=0;for(let f=0;f<this.terms.length;f++)this.terms[f].equals(0)||this.count++;return this},ye.prototype.getVars=function(){let f=[];for(let S=0;S<this.terms.length;S++){let _=this.terms[S];this.getRevMap(),!_.equals(0)&&this.revMap&&f.push(this.revMap[S])}return f.join(" ")},ye.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count||0},ye.prototype.toSymbol=function(f){f||=this.getRevMap();let S=new a(this.coeff);for(let _=0;_<this.terms.length;_++){let c=f[_],m=this.terms[_];if(m.equals(0)||c===Le)continue;let M=new a(c);M.power=m,S=e.multiply(S,M)}return S},ye.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let f={};if(this.map)for(let S in this.map)Object.hasOwn(this.map,S)&&(f[this.map[S]]=S);return this.revMap=f,f},ye.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},ye.prototype.getImg=function(){return this.image||this.generateImage(),this.image||""},ye.prototype.fill=function(){let f=this.map?this.map.length:0;for(let S=0;S<f;S++)typeof this.terms[S]>"u"?this.terms[S]=new fe(0):this.sum=this.sum.add(this.terms[S]);return this},ye.prototype.divide=function(f){let S=this.coeff.divide(f.coeff),_=this.terms.length,c=new ye(S,[],this.map);for(let m=0;m<_;m++)c.terms[m]=this.terms[m].subtract(f.terms[m]),c.sum=c.sum.add(c.terms[m]);return c},ye.prototype.multiply=function(f){let S=this.coeff.multiply(f.coeff),_=this.terms.length,c=new ye(S,[],this.map);for(let m=0;m<_;m++)c.terms[m]=this.terms[m].add(f.terms[m]),c.sum=c.sum.add(c.terms[m]);return c},ye.prototype.isZero=function(){return this.coeff.equals(0)},ye.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},t.Utils.toMapObj=function(f){let S=0,_={length:0};for(let c=0;c<f.length;c++){let m=f[c];typeof _[m]>"u"&&(_[m]=S,S++)}return _.length=S,_},t.Utils.filledArray=function(f,S,_){let c=[];for(;S--;)c[S]=_?new _(f):f;return c},t.Utils.arrSum=function(f){let S=0,_=f.length;for(let c=0;c<_;c++)S+=f[c];return S},t.Utils.haveIntersection=function(f,S){return S.length>f.length&&([f,S]=[S,f]),f.some(_=>S.indexOf(_)>-1)},t.Utils.subFunctions=function(f,S){S||={};let _=[],c=new Set(Ee(f));return f.each(m=>{if(m.group===b||m.previousGroup===b){let M=t.Utils.text(m,"hash"),q=S[M];if(q)_.push(m.altVar(q));else{let F=0,$;do $=m.fname+Y(S).length+(F>0?String(F):""),F++;while(c.has($));S[M]=$,_.push(m.altVar($))}}else m.group===V||m.group===k||m.group===G?_.push(t.Utils.subFunctions(m,S)):_.push(m.text())}),f.group===G||f.group===k?f.altVar(t.Utils.inBrackets(_.join("+"))):f.group===V?f.altVar(t.Utils.inBrackets(_.join("*"))):f.text()},t.Utils.getFunctionsSubs=function(f){let S={};for(let _ in f)Object.hasOwn(f,_)&&(S[f[_]]=e.parse(_));return S};let he=t.Algebra={version:"1.4.6",proots(s,f){f||=7;let S=0,_=[],c=function(M,q,F){let $=m(M,q,F).concat(_);for(let Q=0;Q<S;Q++)$.unshift(0);return $};if(t.Utils.isSymbol(s)&&s.isPoly()){let M=s;if(M.distributeMultiplier(),M.group===k){let pe=t.Utils.arrayMin(Y(M.symbols)),Se=M.symbols[pe].clone().toUnitMultiplier();M=e.expand(e.divide(M,Se)),_.push(0)}if(M.group===t.groups.S)return["0"];if(M.group===t.groups.PL){let pe=Y(M.symbols),Se=t.Utils.arrayMin(pe);M=t.PARSER.divide(M,t.PARSER.parse(`${M.value}^${Se}`))}let q=Y(M.symbols).sort().pop(),F=M.group===t.groups.PL?M.symbols:M.symbols[q||""],$=F.group,Q=$===y?[F.power.toDecimal()]:Y(F.symbols),K=[],ne=t.Utils.arrayMax(Q);for(let pe=1;pe<=ne;pe++){let Se=0;Q.indexOf(`${pe}`)!==-1&&($===y?Se=F.multiplier:Se=F.symbols[pe].multiplier),K.unshift(Se)}return K.push(s.symbols[Le].multiplier),M.group===y&&(K[0]=M.multiplier),c(K,Q,ne)}if(t.Utils.isArray(s)){let M=s,q=[],F=[],$=0;for(let K=0;K<M.length;K++){let ne=M[K][0],pe=M[K][1],Se=pe-$-1;for(let ve=0;ve<Se;ve++)q.unshift(0);q.unshift(ne),pe!==0&&F.push(pe),$=pe}let Q=Math.max.apply(void 0,F);return c(q,F,Q)}throw new t.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function m(M,q,F){let Q,K=M.slice(0);if(M.unshift(F),F>100)throw new t.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let ne=[],pe={};for(pe.Degree=F,Q=0;Q<F;Q++)ne.push(0);let Se=ne.slice(0);function ve(j,X,D,ee,O,x){O[0]=x.b=ee[0],O[1]=x.a=-(X*x.b)+ee[1];for(let g=2;g<j;g++)O[g]=-(X*x.a+D*x.b)+ee[g],x.b=x.a,x.a=O[g]}function Ue(j,X,D,ee,O,x,g,p,P){let w={},U=3;return w.b=w.a=0,ve(X,g,p,x,P,w),O.c=w.a,O.d=w.b,Math.abs(O.c)<=100*j*Math.abs(x[X-1])&&Math.abs(O.d)<=100*j*Math.abs(x[X-2])||(O.h=p*ee,Math.abs(O.d)>=Math.abs(O.c)?(U=2,O.e=D/O.d,O.f=O.c/O.d,O.g=g*ee,O.a3=O.e*(O.g+D)+O.h*(ee/O.d),O.a1=-D+O.f*ee,O.a7=O.h+(O.f+g)*D):(U=1,O.e=D/O.c,O.f=O.d/O.c,O.g=O.e*g,O.a3=O.e*D+(O.g+O.h/O.c)*ee,O.a1=-(D*(O.d/O.c))+ee,O.a7=O.g*O.d+O.h*O.f+D)),U}function De(j,X,D,ee,O,x,g,p,P){if(D===3){g[1]=g[0]=0;for(let U=2;U<X;U++)g[U]=p[U-2];return}let w=D===1?O:ee;if(Math.abs(x.a1)>10*j*Math.abs(w)){x.a7/=x.a1,x.a3/=x.a1,g[0]=P[0],g[1]=-(P[0]*x.a7)+P[1];for(let U=2;U<X;U++)g[U]=-(P[U-1]*x.a7)+p[U-2]*x.a3+P[U]}else{g[0]=0,g[1]=-(P[0]*x.a7);for(let U=2;U<X;U++)g[U]=-(P[U-1]*x.a7)+p[U-2]*x.a3}}function Je(j,X,D,ee,O,x,g,p,P,w,U,B,Z,J,ie,le,te){let ae,de,Be,Te,ze,We,je,et,He;X.b=X.a=0,j===3||(j===2?(ae=(D+U)*w+B,de=(w+Z)*p+J*P):(ae=D+Z*g+B*w,de=p+(Z+J*w)*P),Be=-(ie[le-1]/te[le]),Te=-(ie[le-2]+Be*te[le-1])/te[le],ze=J*Te*ee,We=Be*x,je=Be*Be*O,et=-(We+je)+ze,He=-et+de+Be*ae,He!==0&&(X.a=-((Z*(je+We)+J*(Be*ee+Te*x))/He)+Z,X.b=J*(1+et/He)))}function rt(j,X,D,ee){let O,x;if(ee.sr=ee.si=ee.lr=ee.li=0,j===0){ee.sr=X===0?ee.sr:-(D/X);return}if(D===0){ee.lr=-(X/j);return}let g=X/2;Math.abs(g)<Math.abs(D)?(x=D>=0?j:-j,x=-x+g*(g/Math.abs(D)),O=Math.sqrt(Math.abs(x))*Math.sqrt(Math.abs(D))):(x=-(j/g*(D/g))+1,O=Math.sqrt(Math.abs(x))*Math.abs(g)),x>=0?(O=g>=0?-O:O,ee.lr=(-g+O)/j,ee.sr=ee.lr===0?ee.sr:D/ee.lr/j):(ee.lr=ee.sr=-(g/j),ee.si=Math.abs(O/j),ee.li=-ee.si)}function qe(j,X,D,ee,O,x,g,p,P,w,U,B){let Z={},J,ie,le,te=0,ae,de,Be,Te,ze,We,je,et=0,He,lt=0;D.NZ=0,de=ee,Te=O;do{if(Z.li=Z.lr=Z.si=Z.sr=0,rt(1,de,Te,Z),D.szr=Z.sr,D.szi=Z.si,D.lzr=Z.lr,D.lzi=Z.li,Math.abs(Math.abs(D.szr)-Math.abs(D.lzr))>.01*Math.abs(D.lzr))break;for(ve(g,de,Te,P,x,p),ie=Math.abs(-(D.szr*p.b)+p.a)+Math.abs(D.szi*p.b),We=Math.sqrt(Math.abs(Te)),J=2*Math.abs(x[0]),ae=-(D.szr*p.b),je=1;je<X;je++)J=J*We+Math.abs(x[je]);if(J=J*We+Math.abs(ae+p.a),J=(9*J+2*Math.abs(ae)-7*(Math.abs(p.a+ae)+We*Math.abs(p.b)))*j,ie<=20*J){D.NZ=2;break}if(et++,et>20)break;if(et>=2&&te<=.01&&ie>=le&&!lt){for(te=te<j?Math.sqrt(j):Math.sqrt(te),de-=de*te,Te+=Te*te,ve(g,de,Te,P,x,p),je=0;je<5;je++)He=Ue(j,X,p.a,p.b,U,B,de,Te,w),De(j,X,He,p.a,p.b,U,B,w,x);lt=1,et=0}le=ie,He=Ue(j,X,p.a,p.b,U,B,de,Te,w),De(j,X,He,p.a,p.b,U,B,w,x),He=Ue(j,X,p.a,p.b,U,B,de,Te,w),Je(He,p,p.a,U.a1,U.a3,U.a7,p.b,U.c,U.d,U.f,U.g,U.h,de,Te,B,X,P),Be=p.a,ze=p.b,ze!==0&&(te=Math.abs((-Te+ze)/ze),de=Be,Te=ze)}while(ze!==0)}function Fe(j,X,D,ee,O,x,g,p,P){let w,U,B,Z,J,ie,le,te,ae,de,Be,Te=ee-1;for(X.NZ=Be=ae=0,le=D.a;;){for(ie=O[0],g[0]=ie,de=1;de<x;de++)g[de]=ie=ie*le+O[de];for(B=Math.abs(ie),Z=Math.abs(le),w=.5*Math.abs(g[0]),de=1;de<x;de++)w=w*Z+Math.abs(g[de]);if(B<=20*j*(2*w-B)){X.NZ=1,X.szr=le,X.szi=0;break}if(Be++,Be>10)break;if(Be>=2&&Math.abs(te)<=.001*Math.abs(-te+le)&&B>J){ae=1,X.a=le;break}for(J=B,P[0]=U=p[0],de=1;de<ee;de++)P[de]=U=U*le+p[de];if(Math.abs(U)>Math.abs(p[Te])*10*j)for(te=-(ie/U),p[0]=g[0],de=1;de<ee;de++)p[de]=te*P[de-1]+g[de];else for(p[0]=0,de=1;de<ee;de++)p[de]=P[de-1];for(U=p[0],de=1;de<ee;de++)U=U*le+p[de];te=Math.abs(U)>Math.abs(p[Te])*10*j?-(ie/U):0,le+=te}return ae}function $e(j,X,D,ee,O,x,g,p,P,w,U,B){let Z={},J={},ie=new Array(X),le=new Array(X),te,ae,de,Be,Te,ze,We,je,et,He,lt,ct,ft,At,$t,Tt,pt,Ft,_t,Ot=1,Vt,Jt,c0,Yt,r0,Kt;for(B.NZ=0,Be=de=.25,Te=ee,je=O,Z.b=Z.a=0,ve(P,U,O,p,w,Z),te=Z.a,ae=Z.b,J.h=J.g=J.f=J.e=J.d=J.c=J.a7=J.a3=J.a1=0,Yt=Ue(j,g,te,ae,J,x,U,O,ie),Vt=0;Vt<D;Vt++){if(Ft=1,De(j,g,Yt,te,ae,J,x,ie,w),Yt=Ue(j,g,te,ae,J,x,U,O,ie),Je(Yt,Z,te,J.a1,J.a3,J.a7,ae,J.c,J.d,J.f,J.g,J.h,U,O,x,g,p),$t=Z.a,pt=Tt=Z.b,He=x[g-1]===0?0:-(p[g]/x[g-1]),lt=ft=1,Vt!==0&&Yt!==3&&(ft=pt===0?ft:Math.abs((pt-je)/pt),lt=He===0?lt:Math.abs((He-Te)/He),At=ft<We?ft*We:1,ct=lt<ze?lt*ze:1,r0=At<Be?1:0,Jt=ct<de?1:0,Jt||r0)){for(_t=0;_t<g;_t++)le[_t]=x[_t];for(et=He,c0=Kt=0;;){if(!(Ft&&(Ft=0)==0&&Jt&&(!r0||ct<At))){if(qe(j,g,B,$t,Tt,w,P,Z,p,ie,J,x),te=Z.a,ae=Z.b,B.NZ>0)return;if(Ot=Kt=1,Be*=.25,c0||!Jt)Ot=0;else for(_t=0;_t<g;_t++)x[_t]=le[_t]}if(Ot!==0){if(Z.a=et,Ot=Fe(j,B,Z,g,p,P,w,x,ie),et=Z.a,B.NZ>0)return;if(c0=1,de*=.25,Ot!==0){$t=-(et+et),Tt=et*et;continue}}for(_t=0;_t<g;_t++)x[_t]=le[_t];if(!r0||Kt)break}ve(P,U,O,p,w,Z),te=Z.a,ae=Z.b,Yt=Ue(j,g,te,ae,J,x,U,O,ie)}je=pt,Te=He,We=ft,ze=lt}}function Xe(j,X,D,ee){let O=j.Degree,x=Math.PI/180,g=Math.LN2,p=j.Degree+1,P=new Array(p),w=new Array(p),U=new Array(p),B=new Array(p),Z={},J={},ie,le,te,ae,de,Be,Te,ze,We,je,et,He,lt,ct,ft,At,$t,Tt,pt,Ft,_t,Ot,Vt,Jt;He=1;do le=He,He/=2,lt=1+He;while(lt>1);let c0=Number.MIN_VALUE/le,Yt=Math.cos(94*x),r0=Math.sin(94*x),Kt=Math.sqrt(.5),v0=-Kt;for(J.NZ=pt=0,J.szr=J.szi=J.lzr=J.lzi=0;X[O]===0;)D[pt]=ee[pt]=0,O--,pt++;for(Vt=O+1;O>=1;){if(O<=2){O<2?(D[j.Degree-1]=-(X[1]/X[0]),ee[j.Degree-1]=0):(Z.li=Z.lr=Z.si=Z.sr=0,rt(X[0],X[1],X[2],Z),D[j.Degree-2]=Z.sr,ee[j.Degree-2]=Z.si,D[j.Degree-1]=Z.lr,ee[j.Degree-1]=Z.li);break}for(Te=0,ze=Number.MAX_VALUE,Q=0;Q<Vt;Q++)je=Math.abs(X[Q]),je>Te&&(Te=je),je!==0&&je<ze&&(ze=je);if(We=c0/ze,(We<=1&&Te>=10||We>1&&Number.MAX_VALUE/We>=Te)&&(We=We===0?Number.MIN_VALUE:We,_t=Math.floor(Math.log(We)/g+.5),de=2**_t,de!==1))for(Q=0;Q<Vt;Q++)X[Q]*=de;for(let u=0;u<Vt;u++)w[u]=Math.abs(X[u]);w[O]=-w[O],Ot=O-1,je=Math.exp((Math.log(-w[O])-Math.log(w[0]))/O),w[Ot]!==0&&(et=-w[O]/w[Ot],je=et<je?et:je),et=je;do{je=et,et=.1*je,Be=w[0];for(let u=1;u<Vt;u++)Be=Be*et+w[u]}while(Be>0);ae=je;do{te=Be=w[0];for(let u=1;u<O;u++)Be=je*Be+w[u],te=je*te+Be;Be=je*Be+w[O],ae=Be/te,je-=ae}while(Math.abs(ae/je)>.005);ie=je;for(let u=1;u<O;u++)P[u]=(O-u)*X[u]/O;for(P[0]=X[0],He=X[O],lt=X[Ot],Jt=P[Ot]===0?1:0,Ft=0;Ft<5;Ft++)if(ct=P[Ot],Jt){for(let u=0;u<Ot;u++)pt=Ot-u,P[pt]=P[pt-1];P[0]=0,Jt=P[Ot]===0?1:0}else{At=-He/ct;for(let u=0;u<Ot;u++)pt=Ot-u,P[pt]=At*P[pt-1]+X[pt];P[0]=X[0],Jt=Math.abs(P[Ot])<=Math.abs(lt)*le*10?1:0}for(let u=0;u<O;u++)B[u]=P[u];for(Ft=1;Ft<=20;Ft++)if(Tt=-(r0*v0)+Yt*Kt,v0=r0*Kt+Yt*v0,Kt=Tt,ft=ie*Kt,$t=-(2*ft),$e(le,p,20*Ft,ft,ie,P,O,X,Vt,U,$t,J),J.NZ===0)for(let u=0;u<O;u++)P[u]=B[u];else{pt=j.Degree-O,D[pt]=J.szr,ee[pt]=J.szi,Vt-=J.NZ,O=Vt-1;for(let u=0;u<Vt;u++)X[u]=U[u];J.NZ===1||(D[pt+1]=J.lzr,ee[pt+1]=J.lzi);break}if(Ft>20){j.Degree-=O;break}}}Xe(pe,K,Se,ne);let ke=ne.length,z=[];for(Q=0;Q<ke;Q++){let j=se(ne[Q],f+8),X=se(Number(Se[Q]),f+8);X=f-String(X).length>2?X:Number(Se[Q]);let D=Number(j)<0?"-":"",ee=X,O=j;X===0&&(ee=""),j===0&&(O=""),Math.abs(Number(j))===1?O=`${D}i`:j?O=`${j}*i`:O="";let x=ee&&O?`${ee}+${O}`:String(ee)+String(O);z[Q]=x.replace(/\+-/gu,"-")}return z}},roots(s){if(s.isConstant(!0,!0))return t.Utils.nroots(s);let f=he.proots(s).map(S=>e.parse(S));return t.Vector.fromArray(f)},froot(s,f,S){return function(c){let M=S||t.Build.build(t.Calculus.diff(s.clone())),q=s instanceof Function?s:t.Build.build(s),F=1e4,$=!1,Q=0;for(;!$;){let K=c-q(c)/M(c),ne=Math.abs(K)-Math.abs(c),pe=Math.abs(ne);c=K,pe<1e-12?$=!0:Q>F&&(c=null,$=!0),Q++}return c}(Number(f))},quad(s,f,S){let _=function(c,m,M,q){return e.parse(`-(${m}+${q}*sqrt((${m})^2-4*(${c})*(${M})))/(2*${c})`)};return[_(s,f,S,1),_(s,f,S,-1)]},sumProd(s,f){return he.quad(-f,s,-1).map(S=>S.invert())},coeffs(s,f,S){s=e.expand(s),S||=[new a(0)];let _=Ee(s);f===void 0&&_.length===1&&(f=_[0]),f=String(f),s.group===L&&s.contains(f,!0)&&e.error(`Unable to get coefficients using expression ${s.toString()}`),_=Ee(s);let c=s.contains("pi")||s.contains("e")||s.containsFunction("sqrt");if(_.length===1&&_[0]===f&&!s.isImaginary()&&!c){let m=new me(s).coeffs.map(M=>new a(M));for(let M=0,q=m.length;M<q;M++){let F=m[M],$=S[M];$&&(F=e.add($,F)),S[M]=F}}else if(_.length===1&&_[0]===f&&!s.isImaginary()&&c&&s.group===G){let m=t.Utils.getCoeffs(s,f);for(let M=0,q=m.length;M<q;M++){let F=m[M],$=S[M];$&&(F=e.add($,F)),S[M]=F}}else if(f||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),_.indexOf(f)===-1)S[0]=e.add(s,S[0]);else{S||=[new a(0)];let m;if(s.group===V){let M=s.symbols[f];M||e.error("Expression is not a polynomial!");let q=Number(M.power);m=e.divide(s.clone(),M.clone()),(m.contains(f,!0)||q<0||!ge(q))&&e.error("Expression is not a polynomial!");let F=S[q];F&&(m=e.add(F,m)),S[q]=m}else s.group===G&&s.each(M=>{he.coeffs(M.clone(),f,S)},!0)}for(let m=0,M=S.length;m<M;m++)typeof S[m]>"u"&&(S[m]=new a(0));return S},polyPowers(s,f,S){S||=[];let _=s.group;if(_===k&&f===s.value)S=S.concat(Y(s.symbols));else if(_===G)for(let c in s.symbols){if(!Object.hasOwn(s.symbols,c))continue;let m=s.symbols[c],M=m.group,q=m.value;if(M===y&&f===q)S.push(m.power);else if(M===k||M===G)S=he.polyPowers(m,f,S);else if(M===V&&m.contains(f)){let F=m.symbols[f];F&&S.push(F.power)}else(M===o||f!==q)&&S.push(0)}else if(_===V&&s.contains(f)){let c=t.Utils.decompose_fn(s,f,!0);S.push(c.x.power)}return t.Utils.arrayUnique(S).sort()},Factor:{split(s){let f=new a(1),S=new a(1);return he.Factor.factorInner(s,new _e).each(_=>{let c=e.parse(_);_.isConstant(!0)?f=e.multiply(f,c):S=e.multiply(S,c)}),[f,S]},mix(s,f){let S=Y(s),_=S.length,c=[];for(let m=0;m<_;m++){let M=Number(S[m]),q=s[S[m]],F=c.length;for(let $=0;$<F;$++){let Q=c[$]*M;c.push(Q),f&&c.push(-Q)}for(let $=1;$<=q;$++)c.push(M**$)}return c},common(s,f){try{if(s.group===G){let S=e.expand(s.clone(),{expand_denominator:!0}),_=$=>$.length||1,c=S.collectSymbols(null,null,($,Q)=>_(Q)-_($)),m={},M=[];for(let $=0;$<c.length;$++){let Q=c[$];M.push(Q.multiplier.clone()),Q.each(K=>{let ne=Number(K.power);if(isNaN(ne))throw new Error("exiting");K.value in m?(ne<m[K.value][0]&&(m[K.value][0]=ne),m[K.value][1].push(K)):m[K.value]=[ne,[K]]})}let q=new a(1);for(let $ in m)m[$][1].length===c.length&&(q=e.multiply(q,e.pow(new a($),new a(m[$][0]))));let F=t.Math2.QGCD.apply(null,M);if(!F.equals(1)){f.add(new a(F));for(let $=0;$<c.length;$++)c[$].multiplier=c[$].multiplier.divide(F)}if(!q.equals(1)){f.add(q),s=new a(0);for(let $=0;$<c.length;$++)s=e.add(s,e.divide(c[$],q.clone()))}}}catch(S){if(S.message==="timeout")throw S}return s},zeroes(s,f){let S=function(){throw new t.exceptions.ValueLimitExceededError("Exiting")};try{let _,c,m;s=e.expand(s.clone());let M=s.toString(),q=Ee(s);c=new a(0);let F=[],$=[];for(let Q=0,K=q.length;Q<q.length;Q++){let ne={};for(let Se=0;Se<K;Se++)Q!==Se&&(ne[q[Se]]=0);_=e.parse(M,ne);let pe=_.power;ge(pe)||S(),F.push(_),$.push(_.power)}if(t.Utils.allSame($)){let Q=s.length,K=F.length,ne=Math.round((Math.sqrt(8*Q-1)-3)/2);K===2?m=new fe(Number($[0])/(Q-1)):K===3&&ne!==0?m=new fe(Number($[0])/ne):m=t.Math2.QGCD.apply(null,$)}else m=t.Math2.QGCD.apply(null,$);if(!ge(m))return s;for(let Q=0;Q<F.length;Q++){let K=F[Q],ne=K.power.clone().divide(m),pe=Number(ne);if((Number(K.multiplier.num)<0||Number(K.multiplier.den)<0)&&pe%2===0)return s;K.multiplier=new fe(Number(K.multiplier)**(1/pe)),K.power=m.clone(),c=e.add(c,K)}if(c.group!==G)return s;for(;;){let Q=he.div(s.clone(),c.clone());if(Q[1].equals(0)){if(s=Q[0],f.add(c.clone()),s.equals(1))break}else break}}catch(_){if(_.message==="timeout")throw _}return s},factor(s,f){t.Utils.checkTimeout();let S=f?[...f]:null;try{let _=he.Factor.factorInner(s,f);return _=_.pushMinus(),_}catch(_){if(_.message==="timeout")throw _;return f&&f.splice(0,f.length,...S),s}},factorInner(s,f){if(t.Utils.checkTimeout(),s.isConstant()&&s.isInteger())return t.Math2.factor(Number(s.multiplier));let S=e.parse(s);if(S.isConstant())return S.isInteger()?t.Math2.factor(Number(S.multiplier)):s;if(S.equals(0)||S.equals(1))return S;let _=he.Factor._factor(S,f);if(_.equals(s)||_.equals(0)||_.equals(1))return _;if(_.group===V){let c=new a(1),m=e.parse(_.power),M=e.parse(_.multiplier);_.toUnitMultiplier(),_.multiplier.lessThan(0)&&(c.negate(),_.negate()),_.each(F=>{let $=e.parse(he.Factor._factor(F));if(M=e.multiply(M,a.create($.multiplier.toString())),$.toUnitMultiplier(),$.group===V){let Q=new a(1);$.each(K=>{let ne=e.parse(he.Factor._factor(K));ne.group===V&&(M=e.multiply(M,a.create(ne.multiplier.toString())),ne.toUnitMultiplier()),Q=e.multiply(Q,ne)}),Q=e.pow(Q,new a($.power.toString())),c=e.multiply(c,Q)}else c=e.multiply(c,$)});let q=e.pow(c,m);_=e.multiply(M,q)}return _},quadFactor(s,f){if(s.isPoly()&&he.degree(s.equals(2))){let S=t.Utils.variables(s)[0],_=he.coeffs(s,S);if(_.length<3)return s;let c=he.Factor._factor(_[2].clone());if(c.group===V){let m=c.collectSymbols();if(m.length>2)return s;let M=e.multiply(e.parse(_[0]),e.parse(m[0])),q=e.parse(_[1]).negate(),F=e.parse(m[1]),$=he.quad(F,q,M).filter(Q=>t.Utils.isInt(Q));if($.length===1){let Q=$[0],K=e.divide(_[0],e.parse(Q));t.Utils.isInt(K)&&(f.add(e.parse(Me("({0})*({1})+({2})",String(m[1]),S,String(K)))),f.add(e.parse(Me("({0})*({1})+({2})",String(m[0]),S,Q))),s=new a(1))}}}return s},cubeFactor(s,f){if(s.isComposite()){let S=s.collectSymbols();if(S.length===2){let _=S[0].sign(),c=S[0].clone().abs(),m=S[1].sign(),M=S[1].clone().abs();if(c.isCube()&&M.isCube()){_<m&&([_,m]=[m,_],[c,M]=[M,c]);let q=e.parse(c.getNth(3)),F=e.parse(M.getNth(3)),$=e.multiply(e.expand(e.pow(c.clone().toUnitMultiplier(),e.parse("1/3"))),q),Q=e.multiply(e.expand(e.pow(M.clone().toUnitMultiplier(),e.parse("1/3"))),F);_===1&&m===-1?(f.add(e.parse(Me("(({0})-({1}))",String($),String(Q)))),f.add(e.parse(Me("(({0})^2+({0})*({1})+({1})^2)",String($),String(Q)))),s=new a(1)):_===1&&m===1&&(f.add(e.parse(Me("(({0})+({1}))",String($),String(Q)))),f.add(e.parse(Me("(({0})^2-({0})*({1})+({1})^2)",String($),String(Q)))),s=new a(1))}}}return s},_factor(s,f){t.Utils.checkTimeout();let S=s.group;if(s.group===b){let c=s.args[0];if(c.group===y&&c.isSimple())return s}else if(s.group===y&&s.isSimple())return s;if(s.group===G){s.distributeMultiplier(!0);let c=new a(0);s.each(m=>{(m.group===G&&m.power.greaterThan(1)||m.group===V)&&(m=e.expand(m)),c=e.add(c,m)}),c.power=s.power,s=c}s.group===b&&s.fname!=="sqrt"&&(s=t.Utils.evaluate(s));let _=s.clone();try{if(s.group===V){let m=e.parse(s.power),M=he.Simplify.strip(s.getDenom()),q=he.Simplify.strip(s.getNum()),F=M.pop(),$=q.pop();if($.equals(s))return s;let Q=he.Factor.factorInner($),K=he.Factor.factorInner(F),ne=he.Simplify.unstrip(q,Q),pe=he.Simplify.unstrip(M,K);return e.divide(ne,pe)}if(s.group===y)return s;if(s.isConstant())return s.equals(1)||s.equals(0)||!s.isInteger()?s.clone():t.Math2.factor(s);let c=s.power.clone();if(ge(c)&&!(c.lessThan(0)&&s.group===b)){let m=c.sign();s.toLinear(),f||=new _e;let M={};s=e.parse(t.Utils.subFunctions(s,M)),Y(M).length>0&&(f.preAdd=function(Se){return e.parse(Se,t.Utils.getFunctionsSubs(M))}),s.isLinear()||(f.pFactor=s.power.toString(),s.toLinear());let q=Ee(s);s.isImaginary()&&q.push(t.Settings.IMAGINARY);let F=q.length>1;if(F){let pe=!0,Se=!0;if(s.each(ve=>{ve.group!==y&&(pe=!1),ve.multiplier.equals(1)||(Se=!1)}),pe&&Se)return e.pow(e.parse(s,t.Utils.getFunctionsSubs(M)),e.parse(c))}let $=new _e;s=he.Factor.coeffFactor(s,$),$.each(pe=>{we(c)&&pe.lessThan(0)&&pe.negate(),m<0&&pe.invert(),f.add(pe)});let Q=new _e;if(s=he.Factor.powerFactor(s,Q),Q.each(pe=>{m<0&&pe.invert(),f.add(pe)}),F)s=he.Factor.cubeFactor(s,f),s=he.Factor.mfactor(s,f),f.each(pe=>{m<0&&pe.power.negate()});else{let pe=q[0];s=he.Factor.squareFree(s,f,pe);let Se=new _e;s=he.Factor.trialAndError(s,Se,pe);let ve=Se.toSymbol();if(ve.equals(_))return ve;for(let Ue in Se.factors){if(!Object.hasOwn(Se.factors,Ue))continue;let De=Se.factors[Ue];f.add(e.pow(De,e.parse(c)))}s.equals(_)&&(s=he.Factor.quadFactor(s,f))}s=e.parse(s,t.Utils.getFunctionsSubs(M));let K=f.length===1;f.add(e.pow(s,e.parse(c)));let ne=f.toSymbol();return K&&s.equals(1)&&ne.isLinear()&&(ne=e.pow(ne,e.parse(c))),ne}return s}catch(c){if(c?.message==="timeout")throw c;return _}},reduce(s,f){if(s.group===G&&s.length===2){let S=s.collectSymbols().sort((_,c)=>Number(c.multiplier)-Number(_.multiplier));if(S[0].power.equals(S[1].power)){let _=e.parse(S[0].power),c=S[0].clone().toLinear(),m=S[1].clone().toLinear();f.add(e.add(c.clone(),m.clone())),m.negate();let M=Number(_),q=new a(0);for(let F=1;F<=M;F++){let $=e.pow(c.clone(),e.subtract(_.clone(),new a(F))),Q=e.pow(m.clone(),e.subtract(new a(F),new a(1)));q=e.add(q,e.multiply($,Q))}return q}}return s},squareFree(s,f,S){if(s.isConstant()||s.group===y||!s.isPoly())return s;let c=new me(s,S).squareFree(),m=c[2];if(m!==1){let M=c[1].toSymbol();return M.power=M.power.multiply(new fe(m)),f.add(he.Factor.factorInner(M)),he.Factor.squareFree(c[0].toSymbol(),f)}return s},powerFactor(s,f){if(s.group!==k||s.previousGroup===L)return s;let S=Y(s.symbols);if(!t.Utils.allNumeric(S))return s;let _=t.Utils.arrayMin(S),c=new a(0),m=e.parse(`${s.value}^${_}`);return s.each(M=>{M=e.divide(M,m.clone()),c=e.add(c,M)}),f.add(m),c},coeffFactor(s,f){if(s.isComposite()){let S=t.Math2.QGCD.apply(null,s.coeffs());if(S.equals(1)){let _=function(M){let q;return M.group===V?(q=0,M.each(F=>{q+=F.power})):q=Number(M.power),q},c=s.collectSymbols(null,null,null,!0).sort((M,q)=>M.isConstant(!0)?1:Number(q.power)-Number(M.power)),m=c[0];(_(m)>_(c[1])||c[1].isConstant(!0))&&m.multiplier.lessThan(0)&&(f.add(new a(-1)),s.each(M=>{M.negate()},!0))}else s.each(_=>{_.isComposite()?_.each(c=>{c.multiplier=c.multiplier.divide(S)}):_.multiplier=_.multiplier.divide(S)}),s.updateHash();f&&f.add(new a(S))}return s},trialAndError(s,f,S){let _=s.clone();try{let c=[];if(s.isConstant()||s.group===y||!s.isPoly())return s;let m=new me(s,S),M=m.coeffs[0],q=t.Math2.ifactor(Number(M)),F=he.proots(s);for(let $=0;$<F.length;$++){let Q=F[$],K=1;if(!isNaN(Number(Q))){for(let Ue in q){if(!Object.hasOwn(q,Ue))continue;let De=t.Utils.round(Math.log(Number(Ue))/Math.log(Math.abs(Number(Q))),8);if(ge(De)){Q=Ue,K=Number(De);break}}let ne=new fe(Number(Q)),pe=[new fe(Number(ne.num)).negate()];pe[K]=new fe(Number(ne.den));let Se=me.fromArray(pe,m.variable).fill(),ve=m.divide(Se);ve[1].equalsNumber(0)&&(m=ve[0],c.push(Se.toSymbol()))}}return m.equalsNumber(1)||(m=he.Factor.search(m,f)),c.forEach($=>{f.add($)}),m.toSymbol()}catch(c){if(c.message==="timeout")throw c;return _}},search(s,f,S){S||=10;let _=s.variable,c=function(ve,Ue,De,Je){let rt=me.fit(ve,Ue,De,S,Je,_);if(rt&&rt.coeffs.length>1){let qe=s.divide(rt);if(qe[1].equalsNumber(0))return f.add(rt.toSymbol()),[qe[0],rt]}return null},m=s.coeffs[0],M=t.Math2.ifactor(Number(m)),q=s.lc(),F=t.Math2.ifactor(Number(q)),$=s.sub(S),Q=t.Math2.ifactor($),K=he.Factor.mix(Q,$<0),ne=Math.ceil(s.coeffs.length/2),pe=q.lessThan(0),Se=m.lessThan(0);for(F[1]=1,M[1]=1;ne--;)for(let ve in F)if(Object.hasOwn(F,ve)){for(let Ue in M)if(Object.hasOwn(M,Ue))for(let De=0;De<K.length;De++){let Je=c(Number(ve),Number(Ue),K[De],ne);if(Je)return s=Je[0],t.Utils.isPrime(s.sub(S))||(s=he.Factor.search(s,f)),s;Je||(pe&&Se?Je=c(-Number(ve),-Number(Ue),K[De],ne):pe?Je=c(-Number(ve),Number(Ue),K[De],ne):Se&&(Je=c(Number(ve),-Number(Ue),K[De],ne)))}}return s},mSqfrFactor(s,f){if(s.group!==b){let S=Ee(s).reverse();for(let _=0;_<S.length;_++){let c=!1;do{if(S[_]===s.value){f.add(s),s=new a(1);continue}let m=t.Calculus.diff(s,S[_]),M=he.Factor.coeffFactor(m);if(M.equals(0)||M.equals(1)||M.equals(-1))break;let q=!0;M.isConstant()&&s.isComposite()&&s.each($=>{Number($.multiplier)%Number(M.multiplier)!==0&&(q=!1)},!0);let F;if(q){let $=s.clone();if(F=he.divWithCheck(s,M.clone()),c=F[1].equals(0),s.equals(F[0])&&F[1].equals(0)){s=$;break}if(F[0].isConstant()){f.add(F[0]);break}}else c=!1;c&&(f.add(F[0]),s=M)}while(c)}}return s},sqdiff(s,f){if(s.isConstant("all"))return s;try{let S=function(m){return t.Utils.block("POSITIVE_MULTIPLIERS",()=>a.unwrapPARENS(Ae.sqrt(Ae.abs(m))),!0)},_=t.Utils.separate(s.clone());if(!_)return s;let c=[];for(let m in _)m!=="constants"&&c.push(_[m]);if(c.sort((m,M)=>Number(M.power)-Number(m.power)),c.length===2){let m,M;if(m=c.pop(),M=c.pop(),we(Number(m.power))&&we(Number(M.power))&&m.sign()===M.sign()&&m.group===y&&M.group===y)throw new Error("Unable to factor");if(m.isComposite()&&M.power.equals(2)&&m.sign()!==M.sign()){M=S(M);let q=he.Factor.factorInner(e.add(m,_.constants));q.power.equals(2)&&(q.toLinear(),f.add(e.subtract(q.clone(),M.clone())),f.add(e.add(q,M)),s=new a(1))}else if(m=m.powSimp(),M=M.powSimp(),(m.group===y||m.fname==="")&&m.power.equals(2)&&(M.group===y||M.fname==="")&&M.power.equals(2)&&!_.constants){if(m.multiplier.lessThan(0)){let q=M;M=m,m=q}m.multiplier.greaterThan(0)&&(m=S(m),M=S(M)),f.add(e.subtract(m.clone(),M.clone())),f.add(e.add(m,M)),s=new a(1)}}}catch(S){if(S.message==="timeout")throw S}return s},mfactor(s,f){if(s.group===b)if(s.fname==="sqrt"){let S=new _e,_=he.Factor.common(s.args[0].clone(),S);_=he.Factor.coeffFactor(_,null),s=e.multiply(e.symfunction("sqrt",[_]),e.parse(s.multiplier)),S.each(c=>{s=e.multiply(s,e.parse(t.Utils.format("sqrt({0})",String(c))))})}else f.add(s),s=new a(1);else{s=he.Factor.mSqfrFactor(s,f);let S=Ee(s),_=s.collectSymbols().map(F=>a.unwrapSQRT(F)),c={},m={},M=S.length,q=_.length;for(let F=0;F<M;F++){let $=S[F];c[$]=new a(0);for(let Q=0;Q<q;Q++){let K=_[Q];if(K.contains($)){let ne=K.value===$?K.power.toDecimal():K.symbols[$].power.toDecimal();(!m[$]||ne<m[$])&&(m[$]=ne),c[$]=e.add(c[$],K.clone())}}}for(let F in c){if(!Object.hasOwn(c,F))continue;let $=e.parse(`${F}^${m[F]}`),Q=e.divide(c[F],$),K=e.expand(Q);if(K.equals(1)||K.equals(-1))break;let ne=he.div(s.clone(),K);if(ne[0].equals(0))break;if(ne[1].equals(0)){let Se=!1;if(ne[0].each(ve=>{ge(ve.multiplier)||(Se=!0)}),Se){ne[1]=e.expand(e.multiply(ne[1],K));break}}let pe=ge(K)&&K.lessThan(0);if(ne[1].equals(0)&&!pe){let Se=he.divWithCheck(s.clone(),ne[0].clone()),ve=Se[0];if(ve.equals(0)||(s=Se[1],ve.equals(-1)&&!s.equals(0)))return s;let Ue=ne[0];if(s.equals(Ue)){let De=he.Factor.reduce(Ue,f);return s.equals(De)?De:he.Factor.mfactor(De,f)}return f.add(Ue),s.equals(0)?ve:ve.isConstant("all")?(f.add(ve),ve):(s=he.Factor.mfactor(ve,f),s)}}}return s=he.Factor.sqdiff(s,f),s=he.Factor.zeroes(s,f),s}},allLinear(s){let f=s.length;for(let S=0;S<f;S++)if(!he.isLinear(s[S]))return!1;return!0},isLinear(s){let f=!1,S=s.group;if(S===k||S===G){f=!0;for(let _ in s.symbols){if(!Object.hasOwn(s.symbols,_))continue;let c=s.symbols[_],m=c.group;if((m===b||m===L)&&(f=!1),m===V)f=Ee(c).length===1;else if(m===k||m===G)f=he.isLinear(c);else if(c.group!==o&&c.power.toString()!=="1"){f=!1;break}}}else S===y&&s.power===1&&(f=!0);return f},gcd(...s){let f;if(s.length===1&&s[0]instanceof t.Vector?f=s[0].elements:f=s,f.length===0)return new a(1);if(f.length===1)return f[0];let S=[],_=!1;for(let c=0;c<f.length;c++)if(f[c].group===b&&f[c].fname==="gcd")f=f.concat(f[c].args),f.splice(c,1);else{let m=Ee(f[c]);if(t.Utils.haveIntersection(m,S)){_=!0;break}else S=S.concat(m)}if(_||S.length===0){if(f.every(c=>c.getDenom().equals(1))){let c=f[0];for(let m=1;m<f.length;m++)c=he.gcd_(f[m],c);return c}return e.divide(he.gcd.apply(null,f.map(c=>c.getNum())),he.lcm.apply(null,f.map(c=>c.getDenom())))}return e.symfunction("gcd",f)},gcd_(s,f){if((s.group===b||s.group===h)&&(s=t.Utils.block("PARSE2NUMBER",()=>e.parse(s))),f.group===b&&(f=t.Utils.block("PARSE2NUMBER",()=>e.parse(f))),s.isConstant()&&f.isConstant())return new a(t.Math2.QGCD(new fe(Number(s)),new fe(Number(f))));let S=e.multiply(s.getDenom()||new a(1),f.getDenom()||new a(1)).invert();if(s=e.multiply(s.clone(),S.clone()),f=e.multiply(f.clone(),S.clone()),s=e.expand(s),f=e.expand(f),s.group===V||f.group===V){let F=e.divide(s.clone(),f.clone()),$=e.multiply(f.clone(),F.getDenom().invert());if(!$.equals(1))return $}if(s.group===L||f.group===L){let F=new a(t.Math2.GCD(s.multiplier,f.multiplier)),$=he.gcd_(s.value===Le?new a(1):e.parse(s.value),f.value===Le?new a(1):e.parse(f.value)),Q=he.gcd_(e.parse(s.power),e.parse(f.power));return e.multiply(F,e.pow($,Q))}if(s.length<f.length){let F=s;s=f,f=F}let _=Ee(s),c=Ee(f);if(_.length===1&&c.length===0||_.length===0&&c.length===1){let F=_.length===1?s:f,$=_.length===0?s:f;return $.equals(0)?F:new a(t.Math2.QGCD(F.multiplier,$.multiplier))}if(_.length===c.length&&_.length===1&&_[0]===c[0])return s=new me(s),f=new me(f),e.divide(s.gcd(f).toSymbol(),S);let m=[];s.each(F=>{m.push(F.multiplier)}),f.each(F=>{m.push(F.multiplier)});let M;for(;!f.equals(0);){let F=f.clone();if(s=s.clone(),M=he.div(s,F),f=M[1],M[0].equals(0))return e.divide(new a(t.Math2.QGCD(s.multiplier,f.multiplier)),S);s=F}let q=t.Math2.QGCD.apply(void 0,m);return q.equals(1)||s.each(F=>{F.multiplier=F.multiplier.divide(q)}),s.equals(1)&&!s.isConstant()&&!f.isConstant()?e.divide(e.symfunction("gcd",[s,f]),S):e.divide(s,S)},lcm(...s){let f;s.length===1?s[0]instanceof t.Vector?f=s[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):f=s;let S=f.reduce((M,q)=>e.multiply(M,q.clone()),new a(1)),_=(function(q,F){F=Number(F);let $=[],Q,K,ne,pe=2**q.length;for(K=F;K<pe;K++){Q=[],ne=q.length-1;do(K&1<<ne)!==0&&Q.push(q[ne]);while(ne--);Q.length===F&&$.push(Q)}return $})(f,f.length-1).map(M=>M.reduce((q,F)=>e.multiply(q,F.clone()),new a(1))),c;return f.every(M=>t.Utils.isVariableSymbol(M))?c=e.symfunction("gcd",t.Utils.arrayUnique(_)):c=he.gcd.apply(null,_),e.divide(S,c)},divide(s,f){let S,_=he.Factor.factorInner(s.clone());S=_.getDenom(),S.isConstant("all")?S=new a(1):s=e.expand(a.unwrapPARENS(e.multiply(_,S.clone())));let c=he.div(s,f),m=e.divide(c[1],f);return e.divide(e.add(c[0],m),S)},divWithCheck(s,f){let S=[new a(0),s.clone()],_=he.div(s,f),c=s.clone(),m=e.multiply(_[0].clone(),f.clone());m=e.add(m,_[1].clone());let M=e.subtract(c,m);return M=e.expand(M),M.equals(0)?_:S},div(s,f){let S=[new a(0),s.clone()];try{if(f.isConstant("all"))return s.each(K=>{K.multiplier=K.multiplier.divide(f.multiplier)}),[s,new a(0)];if(s=e.expand(s),f=e.expand(f),s.group===y&&f.group===G){let K=s.value,ne=t.Utils.decompose_fn(f.clone(),K,!0);if(s.isLinear()&&ne.x&&ne.x.isLinear()&&f.isLinear()){let pe=a.create(s.multiplier);return[e.divide(pe.clone(),ne.a.clone()),e.divide(e.multiply(pe,ne.b),ne.a).negate()]}}if(s.group===y&&f.group===y){let K=e.divide(s.clone(),f.clone());return K.isConstant()?[K,new a(0)]:[new a(0),s.clone()]}let _=s.hasFunc(),c=f.hasFunc(),m=!1,M;if(_||c){m=!0;let K={};s=e.parse(t.Utils.subFunctions(s,K)),f=e.parse(t.Utils.subFunctions(f,K)),M=t.Utils.getFunctionsSubs(K)}let q=t.Utils.arrayUnique(Ee(s).concat(Ee(f))),F,$,Q;if((s.isImaginary()||f.isImaginary())&&q.push(t.Settings.IMAGINARY),q.length===1){let K=new me(s).divide(new me(f));F=K[0].toSymbol(),$=K[1].toSymbol()}else{q.push(Le);let K=function($e){let Xe=new a(0);for(let ke=0;ke<$e.length;ke++){let z=$e[ke].toSymbol();Xe=e.add(Xe,z)}return Xe},ne=function($e,Xe){let ke=Math.max.apply(null,$e.terms),z=0,j;if(!Xe){for(let X=0;X<$e.terms.length;X++)if($e.terms[X].equals(ke)&&(j=X,z++),z>1)return}if(Xe){for(let X=0;X<$e.terms.length;X++)if($e.terms[X].equals(ke)){j=X;break}}return[ke,j,$e]},pe=t.Utils.toMapObj(q),Se=function($e,Xe){return Xe.sum.subtract($e.sum)},ve=s.tBase(pe).sort(Se),Ue=f.tBase(pe).sort(Se),De=function($e,Xe){Xe||=0;let ke=$e[Xe],z=$e.length;if(!ke)return;let j=ne(ke);for(let ee=Xe+1;ee<z;ee++){let O=$e[ee],x=ke.sum.equals(O.sum);if(!x&&j)break;if(x){let g,p,P,w,U=ke.terms.length;for(let J=0;J<U;J++){let ie=ke.terms[J],le=O.terms[J];(typeof g>"u"||ie.greaterThan(g))&&(g=ie,P=J),(typeof p>"u"||le.greaterThan(p))&&(p=le,w=J)}let B=g.subtract(O.terms[P]),Z=p.subtract(ke.terms[w]);if(Z>B){j=[p,w,O];break}if(B>Z){j=[g,P,ke];break}}else if(j=ne(O),j)break;j=ne(O)}if(!j)return ne($e[0],!0);let X,D;for(let ee=0;ee<Ue.length;ee++){let O=Ue[ee].terms;if(D=j[1],D===O.length-1)return;if(X=O[D],!X.equals(0))break}return X.equals(0)?De($e,++Xe):j},Je=function($e,Xe){if(!$e||!Xe)return!1;for(let ke=0;ke<$e.terms.length;ke++)if($e.terms[ke].lessThan(Xe.terms[ke]))return!1;return!0},rt=Je(ve[0],Ue[0])&&ve[0].count>Ue[0].count?Ue:ve,qe=De(rt),Fe=[];if(qe){let $e=qe[1],Xe=function(x,g){return x[0].sum.equals(g[0].sum)?x.length>=g.length:!0},ke=function(x,g,p){let P=[];for(let w=0;w<x.length;w++){let U=x[w];for(let B=0;B<U.terms.length;B++){let Z=P[B],J=U.terms[B];w===0?P[B]=J:Z&&!Z.equals(J)&&(P[B]=void 0)}}for(let w=0;w<P.length;w++){let U=P[w];if(U&&!U.equals(0))return w}return p},z=function(x,g){let p=x.len(),P=g.len(),w=g.terms[$e],U=x.terms[$e];return P>p&&w.greaterThan(U)?P-p:w.subtract(U)};$e=ke(ve,Ue,$e),ve.sort(z),Ue.sort(z);let j=Ue[0],X=ve[0];if(Q=new ye(new fe(1),[],X.map),j.sum.greaterThan(X.sum)&&X.len()>1)for(let x=0;x<X.terms.length;x++){let g=j.terms[x].subtract(X.terms[x]);if(g.equals(0))Q.terms[x]=new fe(0);else{let p=g.add(new fe(1));Q.terms[x]=g;for(let P=0;P<ve.length;P++)ve[P].terms[x]=ve[P].terms[x].add(p)}}let D=Je(ve[0],Ue[0]),ee=0,O=200;for(;D&&Xe(ve,Ue);){if(ee++>O)throw new t.exceptions.InfiniteLoopError("Unable to compute!");let x=ve[0].divide(Ue[0]);Fe.push(x),ve.shift();for(let g=1;g<Ue.length;g++){let p=Ue[g].multiply(x).generateImage(),P=ve.length;P===0&&(p.coeff=p.coeff.neg(),ve.push(p),ve.sort(z));for(let w=0;w<P;w++){let U=ve[w];if(U.getImg()===p.getImg()){U.coeff=U.coeff.subtract(p.coeff),U.coeff.equals(0)&&(t.Utils.remove(ve,w),w--);break}w===P-1&&(p.coeff=p.coeff.neg(),ve.push(p),ve.sort(z))}}if(D=Je(ve[0],Ue[0]),!D&&ve.length>=Ue.length){for(let g=1;g<ve.length;g++)if(D=Je(ve[g],Ue[0]),D){ve.unshift(t.Utils.remove(ve,g));break}}}}F=K(Fe),$=K(ve),typeof Q<"u"&&(Q=Q.toSymbol(),F=e.divide(F,Q.clone()),$=e.divide($,Q))}return m&&(F=e.parse(F.text(),M),$=e.parse($.text(),M)),[F,$]}catch(_){if(_.message==="timeout")throw _;return S}},line(s,f,S){t.Utils.isArray(s)&&(s=t.Utils.convertToVector(s)),t.Utils.isArray(f)&&(f=t.Utils.convertToVector(f)),S=e.parse(S||"x"),(!t.Utils.isVector(s)||!t.Utils.isVector(f))&&e.error(`Line expects a vector! Received "${s}" & "${f}"`);let _=e.subtract(f.e(1).clone(),s.e(1).clone()),c=e.subtract(f.e(2).clone(),s.e(2).clone()),m=e.divide(c,_),M=e.multiply(S,m.clone()),q=e.multiply(s.e(1).clone(),m);return e.add(e.subtract(M,q),s.e(2).clone())},PartFrac:{createTemplate(s,f,S,_){s=he.Factor.factorInner(s),s.each((K,ne)=>{if(K.group===b&&K.fname===""&&K.args[0].group===y){let pe=K.args[0];s.symbols?(delete s.symbols[ne],s.symbols[pe.value]=pe):s=K.args[0]}});let c,m,M,q=f.collectFactors(),F=[],$=[],Q=new a(1);for(let K=0;K<q.length;K++){let ne=a.unwrapPARENS(q[K]);if(ne.power.greaterThan(1)){m=Number(ne.power),c=ne.clone().toLinear(),M=Number(he.degree(c,_));for(let pe=0;pe<m;pe++){let Se=e.pow(c.clone(),new a(pe+1));S.push(Se.clone());let ve=e.divide(s.clone(),Se.clone());$.push(M),F.push(ve)}}else{M=Number(he.degree(ne,_)),S.push(ne);let pe=e.divide(s.clone(),ne.clone());pe=e.expand(a.unwrapPARENS(pe)),$.push(M),F.push(pe)}}return S=S.map(K=>e.multiply(K,Q.clone())),[S,F,$]},partfrac(s,f,S){let _=Ee(s);f||=e.parse(_[0]);try{let c,m,M,q=e.expand(s.getNum()),F=e.expand(s.getDenom().toUnitMultiplier());if(q.multiplier=s.multiplier,c=q.groupTerms(f),Number(he.degree(q,f))>=Number(he.degree(F,f))?(m=he.div(q.clone(),e.expand(F.clone())),M=m[0],q=m[1],c=q.groupTerms(f)):M=new a(0),Number(he.degree(F,f))===1){let z=e.divide(q,F);return S?[M,z]:e.add(M,z)}let $=he.Factor.factorInner(F),Q=he.PartFrac.createTemplate(F.clone(),$,[],f),K=Q[0],ne=Q[1],pe=Q[2],Se=[c.length],ve=[],Ue=[],De=[],Je,rt;ne.forEach((z,j)=>{Je=K[j],rt=pe[j];for(let X=0;X<rt;X++){Ue.push(Je.clone());let D=a.create(f,X),ee=e.expand(e.multiply(z,D.clone())).groupTerms(f),O=ee.length;Se.push(O),ve.push(ee),De.push(D.clone())}});let qe=t.Utils.arrayMax(Se),Fe=new t.Matrix(t.Utils.fillHoles(c,qe)).transpose(),$e=new t.Matrix;for(let z=0;z<ve.length;z++)$e.elements.push(t.Utils.fillHoles(ve[z],qe));let Xe=e.multiply($e.transpose().invert(),Fe),ke=S?[M]:M;return Xe.each((z,j)=>{let X=e.multiply(De[j],e.divide(z,Ue[j]));S?ke.push(X):ke=e.add(ke,X)}),ke}catch(c){if(c.message==="timeout")throw c;try{if(s.isComposite()){let m={};s.each(q=>{let F=q.getDenom(),$=q.getNum(),Q=m[F];m[F]=Q?e.add(Q,$):$});let M=new a(0);for(let q in m)Object.hasOwn(m,q)&&(M=e.add(M,e.divide(m[q],e.parse(q))));s=M}}catch(m){if(m.message==="timeout")throw m}}return s}},degree(s,f,S){if(S||={nd:[],sd:[],depth:0},!f){let m=Ee(s);if(m.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(m.length===0)return new a(0);f=e.parse(m[0])}let _=s.group;s.isComposite()?(s=s.clone(),s.distributeExponent(),s.each(m=>{S.depth++,he.degree(m,f,S),S.depth--})):s.group===V?s.each(m=>{S.depth++,he.degree(m,f,S),S.depth++}):_===L&&s.value===f.value?S.sd.push(s.power.clone()):_===y&&s.value===f.value?S.nd.push(e.parse(s.power)):S.nd.push(new a(0));let c=S.nd.length>0?t.Utils.arrayMax(S.nd):void 0;return S.depth===0&&S.sd.length>0?(c!==void 0&&S.sd.unshift(c),e.symfunction("max",S.sd)):(t.Utils.isSymbol(c)||(c=e.parse(c)),c)},sqComplete(s,f,S){t.Utils.isSymbol(f)||(f=e.parse(f));let _=function(ve){throw ve||="Stopping",new t.exceptions.ValueLimitExceededError(ve)};s.isPoly(!0)||_("Must be a polynomial!");let c=t.Utils.inBrackets;s=s.clone();let m=t.Algebra.degree(s,f);m.equals(2)||_(`Cannot complete square for degree ${m}`);let M=t.Algebra.coeffs(s,f),q=M[2],F=M[1].sign(),$=e.divide(M[1],new a(2)),Q=e.pow($.clone(),new a(2)),K=Ae.sqrt(q),ne=e.divide(Ae.sqrt(Q),K.clone()),pe=e.subtract(M[0],e.pow(ne.clone(),new a(2)));if(S)return[q,$,pe];let Se=e.parse(c(`${K.clone()}*${f}${F<0?"-":"+"}${ne}`));return{a:Se,c:pe,f:e.add(e.pow(Se.clone(),new a(2)),pe.clone())}},Simplify:{strip(s){let f=e.parse(s.multiplier);s.toUnitMultiplier();let S=e.parse(s.power);return s.toLinear(),[f,S,s]},unstrip(s,f){let S=s[0],_=s[1];return e.multiply(S,e.pow(f,_))},complexSimp(s,f){let S=s.realpart(),_=s.imagpart(),c=f.realpart(),m=f.imagpart(),M=e.multiply(S.clone(),c.clone()),q=e.multiply(_.clone(),m.clone()),F=e.multiply(c.clone(),_),$=e.multiply(S,m.clone()),Q=e.add(e.pow(c,new a(2)),e.pow(m,new a(2)));return e.divide(e.add(e.add(M,q),e.multiply(e.subtract(F,$),a.imaginary())),Q)},trigSimp(s){let f=!0,S=0;for(;f&&s.containsFunction(["cos","sin","tan"]);){S++,f=!1,s=s.clone();let _=he.Simplify.strip(s);s=_.pop();let c=s.clone();if(s.group===G){let m=new a(0);s.each(M=>{let q=he.Simplify.trigSimp(M.fnTransform());m=e.add(m,q)},!0),c=e.pow(e.multiply(new a(s.multiplier),m),new a(s.power)),f=c.text()!==s.text()}else if(s.group===V){let m=s.getNum(),M=s.getDenom();if(m.fname==="sin"&&M.fname==="cos"&&m.args[0].equals(M.args[0])&&m.power.equals(M.power))c=e.parse(t.Utils.format("(({1})/({0}))*tan({2})^({3})",M.multiplier,m.multiplier,m.args[0],m.power)),f=!0;else if(m.fname==="tan"&&M.fname==="sin"&&m.args[0].equals(M.args[0])&&m.power.equals(M.power))c=e.parse(t.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",M.multiplier,m.multiplier,m.args[0],m.power)),f=!0;else{let q=new a(1),F={workDone:f};c.each($=>{if($.fname==="tan")$=e.parse(t.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",$.multiplier,he.Simplify._simplify($.args[0]),$.power)),F.workDone=!0;else if($.containsFunction(["cos","sin","tan"])){let Q=he.Simplify.trigSimp($);$.equals(Q)||($=Q,F.workDone=!0)}q=e.multiply(q,$)}),f=F.workDone,c=q}}else if((s.fname==="cos"||s.fname==="sin")&&s.args[0].group===G){let m=0,M=new a(0),q=e.parse("pi/2");if(s.args[0].each(F=>{let $=e.divide(F.clone(),q.clone());$=he.Simplify._simplify($),$=t.Utils.evaluate($),ge($)?m+=$.multiplier.num.toJSNumber():M=e.add(M,F)}),m){m+=s.fname==="cos"?1:0,m%=4,m+=m<0?4:0;let F=["sin({0})","cos({0})","-sin({0})","-cos({0})"],$=t.Utils.format(F[m],String(M));c=e.parse($),f=!0}else if(Object.keys(s.args[0].symbols).length>1){let F=s.args[0].clone(),$=Object.values(F.symbols),Q=$[0],ne=$.slice(1).map(Se=>`(${Se.text()})`).join("+"),pe;s.fname==="sin"?pe=t.Utils.format("sin({0})cos({1})+sin({1})cos({0})",Q,ne):pe=t.Utils.format("cos({0})cos({1})-sin({1})sin({0})",Q,ne),c=e.parse(pe),f=!0}}else if((s.fname==="cos"||s.fname==="sin")&&s.args[0].multiplier.sign()===-1){let m=s.args[0].clone().negate(),M=t.Utils.format(`${s.fname}({0})`,m);s.fname==="sin"&&(M=`-${M}`),c=e.parse(M),f=!0}if(s.fname==="sin"&&s.args[0].multiplier.equals(2)&&!s.args[0].equals(2)){let m=s.args[0].clone().toUnitMultiplier(),M=t.Utils.format("2sin({0})cos({0})",m);c=e.parse(M),f=!0}if(c=he.Simplify.unstrip(_,c).distributeMultiplier(),s=c,S>10)break}return s},logArgSimp(s,f){if(f.value==="1"||f.value===1)return new a(0);let S=new a(0),_=f.multiplier.clone();if(f.toUnitMultiplier(),!_.equals(1)){let c=t.Utils.format("({0}({1}))",s,_);S=e.add(S,e.parse(c))}if(f.group===V)f.each(c=>{c=c.clone();let m=c.power.clone();he.Simplify.strip(c);let M=t.Utils.format("(({1})*{0}({2}))",s,m,c);S=e.add(S,e.parse(M))});else{let c=f.clone(),m=c.power.clone();he.Simplify.strip(c);let M=t.Utils.format("(({1})*{0}({2}))",s,m,c);S=e.add(S,e.parse(M))}return S},logSimp(s){if(s.group===b&&(s.fname==="log"||s.fname==="log10")){let f=s.clone(),S=he.Simplify.strip(s);s=S.pop();let _=s.args[0].clone(),c=_.getNum().clone(),m=_.getDenom().clone(),M=s.fname,q=he.Simplify.logArgSimp(M,c);if(!m.equals(1)){let F=he.Simplify.logArgSimp(M,m);q=e.subtract(q,F)}q=he.Simplify.unstrip(S,q).distributeMultiplier(),s=q}else if(s.containsFunction(["log","log10"]))for(let f in s.symbols){if(!Object.hasOwn(s.symbols,f))continue;let S=s.symbols[f];s.symbols[f]=he.Simplify.logSimp(S)}return s},_sqrtCompression(s,f,S){let _=he.Simplify.strip(s),c=Se=>Se.fname==="abs",m=Se=>Se.args[0],M=Se=>c(Se)?m(Se):null,q=Se=>Se.type===y&&Se.value.startsWith("baseunit_"),F=(Se,ve)=>{let Ue=m(ve);return Ue.equals(M(Se))?[ve,null]:Ue.equals(Se)&&q(Se)?[ve,null]:[null,ve]},$,Q=!1,K=(Se,ve)=>{for(let Ue=0;Ue<Se.length;Ue++){let De=Se[Ue];if(De.isSQRT()){for(let Je=0;Je<ve.length;Je++){let rt=ve[Je];if([rt,De]=F(rt,De),rt!==null){ve[Je]=rt,$=!0,Q=!0;break}}Se[Ue]=De,Se=Se.filter(Je=>Je),ve=ve.filter(Je=>Je)}}return[Se,ve]},ne=f.collectFactors(),pe=S.collectFactors();do $=!1,[ne,pe]=K(ne,pe),[pe,ne]=K(pe,ne);while($);return Q&&(s=ne.reduce((Se,ve)=>Se=e.multiply(Se,ve),new a(1)),s=pe.reduce((Se,ve)=>Se=e.divide(Se,ve),s)),s=he.Simplify.unstrip(_,s),s},fracSimp(s){let f=s.getDenom(),S=s.getNum();if(S.isImaginary()&&f.isImaginary()&&(s=he.Simplify.complexSimp(S,f)),s.isComposite()){s.power>1&&(s=e.expand(s));let _=s.collectSymbols(),c,m,M,q,F,$,Q,K,ne,pe,Se;for(m=_.pop();_.length;)M=_.pop(),q=e.parse(m.getDenom()),F=e.parse(M.getDenom()),$=m.getNum(),Q=M.getNum(),Se=e.multiply(q.clone(),F.clone()),ne=e.multiply($,F),pe=e.multiply(Q,q),K=e.add(ne,pe),m=e.divide(K,Se);return f=e.expand(m.getDenom()),S=e.expand(m.getNum()),S.isImaginary()&&f.isImaginary()?c=he.Simplify.complexSimp(S,f):c=e.divide(S,f),c.equals(s)?s:he.Simplify._simplify(c)}return s=he.Simplify._sqrtCompression(s,S,f),s=he.Simplify.simpleFracSimp(s),s},simpleFracSimp(s){let f=s.getDenom(),S=s.getNum(),_;return f=e.expand(f),S=e.expand(S),S.isImaginary()&&f.isImaginary()?_=he.Simplify.complexSimp(S,f):_=e.divide(S,f),_.equals(s)?s:_},ratSimp(s){if(s.group===V){let f=s.getDenom(),S=s.getNum().distributeMultiplier(),_=he.Simplify.fracSimp(f),c=he.Simplify.fracSimp(S);s=e.divide(c,_)}return s},sqrtSimp(s,f){let S,_=!1,c=s.clone();try{if(s.isSQRT()){let m=s.multiplier.clone(),M=s.args[0].clone(),q=he.Factor.factorInner(M),F=e.parse(q.multiplier),$=F.sign();S=new a(1);let Q;if(q.group===V){let K=new a(1);q.each(pe=>{if(pe=e.parse(pe),pe.group===o){let Se=e.sqrt(pe.clone());ge(Se)?S=e.multiply(S,Se):K=e.multiply(K,pe)}else K=e.multiply(K,pe)});let ne=e.multiply(K,e.parse($));Q=e.sqrt(ne.clone()),Q.isImaginary()&&(Q=e.sqrt(e.expand(ne.clone())))}else Q=q.clone().toUnitMultiplier(),Q=e.multiply(Q,new a($)),Q=e.sqrt(Q);S=e.multiply(S,Q),S=e.pow(S,e.parse(s.power)),S=e.multiply(S,e.sqrt(F.abs())),S=e.multiply(S,e.parse(m)),_=!0}else s.isComposite()&&s.isLinear()?(S=new a(0),s.each(m=>{S=e.add(S,he.Simplify.sqrtSimp(m))},!0),S=e.pow(S,e.parse(s.power)),S=e.multiply(S,e.parse(s.multiplier)),_=!0):s.group===V&&(S=new a(1),s.each(m=>{let M=he.Simplify.sqrtSimp(m);S=e.multiply(S,M)}),S=e.pow(S,e.parse(s.power)),S=e.multiply(S,e.parse(s.multiplier)),_=!0);return _||S&&!ge(S)&&(S=null),S||=e.parse(s),S}catch(m){if(m.message==="timeout")throw m;return c}},patternSub(s){let f={},S=function(c){let m=!1;return c.each(M=>{M.group===G?m=!0:M.symbols&&(m=S(M))}),m},_=function(c){c.each(m=>{if(!(!m.symbols&&m.group!==b)){if(S(m))_(m);else if(!f[m.value]){let M=t.Utils.getU(s);f[m.value]=M,s=s.sub(m.value,M)}}},!0)};return _(s),[s,f]},simplify(s){if(s.simplify)return s.simplify();let f=he.Simplify._simplify(s);return f=f.pushMinus(),f=e.parse(f),f},_simplify(s){let f=he.Simplify.strip(s.clone());if(s=f.pop(),s=he.Simplify.fracSimp(s),s.isConstant()||s.group===t.groups.S)return f.push(s),he.Simplify.unstrip(f,s);let S=s.clone();if(S=he.Simplify.sqrtSimp(S,f),S=he.Simplify.trigSimp(S),S=he.Simplify.logSimp(S),S=he.Simplify.ratSimp(S),S=he.Factor.factorInner(S),S.group===t.groups.CP&&S.isLinear()){let _=S.multiplier.clone();S.toUnitMultiplier();let c=new a(0);return S.each(m=>{let M=he.Simplify._simplify(m);c=e.add(c,M)}),S=c,S=e.multiply(S,new a(_)),S.multiplier.equals(-1)&&S.distributeMultiplier(),S=he.Simplify.unstrip(f,S),S}return S=he.Simplify.unstrip(f,S),S}},Classes:{Polynomial:me,Factors:_e,MVTerm:ye}};t.Expression.prototype.simplify=function(){t.Utils.armTimeout();try{let f;if(typeof this.symbol.LHS>"u")f=new t.Expression(he.Simplify.simplify(this.symbol));else{let S=this.symbol.clone();S.LHS=he.Simplify.simplify(S.LHS),S.RHS=he.Simplify.simplify(S.RHS),f=S}return f}catch(f){if(f.message==="timeout")throw f;return this}finally{t.Utils.disarmTimeout()}},t.Collection.prototype.simplify=function(){return this.elements=this.elements.map(f=>he.Simplify.simplify(f)),this},t.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(f=>f.map(S=>he.Simplify.simplify(S))),this},h0.useAlgebraDiv=function(){let f=he.divideFn=e.divide,S=0;e.divide=function _(c,m){S++;let M;return S===1?M=t.Algebra.divide(c,m):M=_(c,m),S=0,M}},h0.useParserDiv=function(){he.divideFn&&(e.divide=he.divideFn),delete he.divideFn},h0.register([{name:"factor",visible:!0,numargs:1,build(){return he.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return he.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return he.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return he.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return he.roots}},{name:"divide",visible:!0,numargs:2,build(){return he.divide}},{name:"div",visible:!0,numargs:2,build(){return he.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return he.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return he.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...f){let S=he.coeffs(...f);return new t.Vector(S)}}}]),h0.coeffs=function(...f){let S=t.PARSER;for(let c=0;c<f.length;c++)typeof f[c]=="string"?f[c]=S.parse(f[c]):f[c]&&f[c].symbol?f[c]=f[c].symbol.clone():t.Utils.isSymbol(f[c])&&(f[c]=f[c].clone());let _=he.coeffs(...f);return new t.Expression(new t.Vector(_))},h0.register([{name:"line",visible:!0,numargs:[2,3],build(){return he.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(f,S){try{return S||=Ee(f)[0],he.sqComplete(f.clone(),S).f}catch(_){if(_.message==="timeout")throw _;return f}}}}]),h0.updateAPI()})()});var f1=f0((Ki,c1)=>{"use strict";var R0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof c1<"u"&&R0===void 0&&(R0=T0(),V0(),X0());(function(){let t=R0.getCore(),e=t.PARSER,o=t.Algebra,h=t.Calculus,L=h.integration.decompose_arg,b=o.Factor,k=o.Simplify,G=o.Classes,{evaluate:V}=t.Utils,{remove:Y}=t.Utils,{format:we}=t.Utils,{build:Ee}=t.Build,{knownVariable:Me}=t.Utils,{NerdamerSymbol:se}=t,{isSymbol:ge}=t.Utils,{variables:fe}=t.Utils,{S:a}=t.groups,{PL:Ne}=t.groups,{CB:be}=t.groups,{CP:Le}=t.groups,{FN:Ae}=t.groups,{Settings:xe}=t,{range:me}=t.Utils,{isArray:_e}=t.Utils;t.Settings.SOLVE_RADIUS=1e3,t.Settings.ROOTS_PER_SIDE=10,t.Settings.make_pi_conversions=!1,t.Settings.STEP_SIZE=.1,t.Settings.EPSILON=2e-13,t.Settings.MAX_NEWTON_ITERATIONS=200,t.Settings.NEWTON_EPSILON=2e-15,t.Settings.MAX_NON_LINEAR_TRIES=12,t.Settings.NON_LINEAR_JUMP_AT=50,t.Settings.NON_LINEAR_JUMP_SIZE=100,t.Settings.NON_LINEAR_START=.01,t.Settings.NEWTON_SLICES=200,t.Settings.SOLUTION_PROXIMITY=1e-14,t.Settings.FILTER_SOLUTIONS=!0,t.Settings.MAX_SOLVE_DEPTH=10,t.Settings.ZERO_EPSILON=1e-9,t.Settings.MAX_BISECTION_ITER=2e3,t.Settings.BI_SECTION_EPSILON=1e-12,t.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},t.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let m in this.symbols){if(!Object.hasOwn(this.symbols,m))continue;let M=this.symbols[m];if(M.group===Ne&&M.hasNegativeTerms()||this.symbols[m].power.lessThan(0))return!0}return!1};function ye(c,m){if(m.isConstant()&&c.isConstant()&&!c.equals(m)||c.equals(t.Settings.IMAGINARY)&&m.isConstant(!0)||m.equals(t.Settings.IMAGINARY)&&c.isConstant(!0))throw new t.exceptions.NerdamerValueError(`${c.toString()} does not equal ${m.toString()}`);this.LHS=c,this.RHS=m}ye.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(c){return`${this.LHS.text(c)}=${this.RHS.text(c)}`},toLHS(c){c=!!c;let m=this.removeDenom(),M=m.LHS,q=m.RHS;M.isConstant(!0)&&!q.isConstant(!0)&&([M,q]=[q,M]);let F=e.subtract(M,q),$=c?e.expand(F):F;return $=new ye($,new se(0)).removeDenom().LHS,$},removeDenom(){let c=this.LHS.clone(),m=this.RHS.clone(),M=e.multiply(c.getDenom(),m.getDenom());if(c=e.expand(e.multiply(c,M.clone())),m=e.expand(e.multiply(m,M)),m.group===Le&&m.group!==Le){let q=c;c=m,m=q}if(c.group===be){let q=new se(c.multiplier),F=m.clone();c.each($=>{$.power.lessThan(0)?F=e.divide(F,$):q=e.multiply(q,$)}),c=q,m=F}else if(c.group===Le)for(let q in c.symbols){if(!Object.hasOwn(c.symbols,q))continue;let F=c.symbols[q];if(F.group===be)for(let $ in F.symbols){if(!Object.hasOwn(F.symbols,$))continue;let Q=F.symbols[$];if(Q.power.lessThan(0))return new ye(e.expand(e.multiply(Q.clone().toLinear(),c)),e.expand(e.multiply(Q.clone().toLinear(),m)))}}return new ye(c,m)},clone(){return new ye(this.LHS.clone(),this.RHS.clone())},sub(c,m){let M=this.clone();return M.LHS=M.LHS.sub(c.clone(),m.clone()),M.RHS=M.RHS.sub(c.clone(),m.clone()),M},isZero(){return t.Utils.evaluate(this.toLHS()).equals(0)},latex(c){return[this.LHS.latex(c),this.RHS.latex(c)].join("=")}},e.equals=function(m,M){return new ye(m,M)},(function(){let m=e.functions.simplify[0];e.functions.simplify[0]=function(q){return q instanceof ye?(q.LHS=m(q.LHS),q.RHS=m(q.RHS),q):m(q)}})(),t.Expression.prototype.equals=function(m){return m instanceof t.Expression&&(m=m.symbol),new ye(this.symbol,m)},t.Expression.prototype.solveFor=function(m){t.Utils.armTimeout();try{let{symbol:M}=this;if(this.symbol instanceof ye){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(m))return[new t.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(m))return[new t.Expression(this.symbol.RHS)]}return _(M,m).map($=>($=k.simplify(e.parse($)),new t.Expression($)))}finally{t.Utils.disarmTimeout()}},t.Expression.prototype.expand=function(){if(this.symbol instanceof ye){let m=this.symbol.clone();return m.RHS=e.expand(m.RHS),m.LHS=e.expand(m.LHS),new t.Expression(m)}return new t.Expression(e.expand(this.symbol))},t.Expression.prototype.variables=function(){return this.symbol instanceof ye?t.Utils.arrayUnique(t.Utils.variables(this.symbol.LHS).concat(t.Utils.variables(this.symbol.RHS))):t.Utils.variables(this.symbol)};let he=function(m,M){return e.equals(m,M)};t.Equation=ye;let s=t.Utils.checkAll=function(m,M){for(let q=0;q<m.length;q++)if(M(m[q]))return!1;return!0},f=t.Solve={version:"2.0.3",solutions:[],solve(c,m){let M=xe.PARSE2NUMBER;xe.PARSE2NUMBER=!1;let q=_(c,String(m));return xe.PARSE2NUMBER=M,new t.Vector(q)},toLHS(c,m){if(ge(c))return c;if(!(c instanceof ye)){let q=c.split("=");q[1]||="0",c=new ye(e.parse(q[0]),e.parse(q[1]))}return c.toLHS(m)},solveCircle(c,m){let M=m.map(K=>e.parse(K)),q=[],F=[];for(let K=0;K<c.length;K++){let ne=[];for(let pe=0;pe<M.length;pe++)ne.push(Number(o.degree(c[K],M[pe])));ne.push(t.Utils.arraySum(ne,!0)),q.push(ne)}let $=c[0],Q=c[1];if(q[0][2]>q[1][2]&&([Q,$]=[$,Q],[q[1],q[0]]=[q[0],q[1]]),q[0][0]===1&&q[0][2]===2&&q[1][0]===2&&q[1][2]===4){let K=m[0],ne=m[1],pe=_(e.parse(Q,Me(K,_(e.parse($),K)[0])),ne).map(ve=>ve.toString()),Se=[_(e.parse($,Me(ne,pe[0])))[0].toString()];if(pe[1]&&Se.push(_(e.parse($,Me(ne,pe[1])))[0].toString()),xe.SOLUTIONS_AS_OBJECT){let ve={};ve[K]=Se,ve[ne]=pe,F=ve}else pe.unshift(ne),Se.unshift(K),F=[Se,pe]}return F},solveNonLinearSystem(c,m,M){if(m<0)return[];M=typeof M>"u"?t.Settings.NON_LINEAR_START:M;let q=t.Settings.MAX_NON_LINEAR_TRIES,F=Math.floor(q/2);m=typeof m>"u"?q:m;let $=t.Settings.NON_LINEAR_JUMP_AT,Q=t.Settings.NON_LINEAR_JUMP_SIZE,K=!0,ne=function(X,D){return X.map((ee,O)=>Number(D.get(O,0)))},pe=t.Utils.arrayGetVariables(c),Se=t.Matrix.jacobian(c,pe,X=>Ee(X,pe),!0),ve=t.Settings.MAX_NEWTON_ITERATIONS,Ue,De,Je,rt,qe,Fe,$e,Xe,ke=c.map(X=>Ee(X,pe)),z=Se.map(X=>Ee(X,pe),!0);rt=t.Matrix.cMatrix(0,pe);let j=t.Matrix.cMatrix(M,pe);Je=0;do{if(Je>ve){K=!1;break}Ue=ne(pe,j),$e=j.clone();let X=Ue,D=j;ke.forEach((O,x)=>{D.set(x,0,O(...X))});let ee=new t.Matrix;if(z.each((O,x,g)=>{let p=O(...X);ee.set(x,g,p)}),ee=ee.invert(),De=e.multiply(ee,j).negate(),Xe=De.subtract(rt,O=>e.parse(Number(O))),rt=$e.add(De,O=>e.parse(Number(O))),j=rt,Je>=$&&Number(qe)>1){m===F&&(M=0);let O=m>F?1:-1,x=m%Math.floor(F)+1;return M+=O*x*Q,f.solveNonLinearSystem(c,--m,M)}if(Fe=qe,Je++,qe=Xe.max(),Number(qe)===Number(Fe))break}while(Number(qe)>=Number.EPSILON);return K?f.systemSolutions(j,pe,!0,X=>t.Utils.round(Number(X),14)):[]},systemSolutions(c,m,M,q){let F=t.Settings.SOLUTIONS_AS_OBJECT?{}:[];return c.each(($,Q)=>{let K=(M?e.expand($):$).valueOf();q&&(K=q.call($,K));let ne=m[Q];t.Settings.SOLUTIONS_AS_OBJECT?F[ne]=K:F.push([ne,K])}),F},solveSystemBySubstitution(c){let m=fe(c[0]),M=fe(c[1]);return c.length===2&&m.length===2&&t.Utils.arrayEqual(m,M)?f.solveCircle(c,m):[]},solveSystem(c,m){for(let ne=0;ne<c.length;ne++)c[ne]=f.toLHS(c[ne]);let M=c.length,q=new t.Matrix,F=new t.Matrix,$=!1,Q;if(typeof m>"u"){if(!o.allLinear(c))try{return f.solveNonLinearSystem(c)}catch(ne){if(ne.message==="timeout")throw ne;if(ne instanceof t.exceptions.DivisionByZero)return f.solveSystemBySubstitution(c)}if(Q=t.Utils.arrayGetVariables(c),Q.length===1){let ne=0,pe,Se;do Se=c[ne].clone(),ne>0&&(Se=Se.sub(Q[0],pe[0])),pe=_(Se,Q[0]);while(++ne<c.length);let ve;return xe.SOLUTIONS_AS_OBJECT?(ve={},ve[Q[0]]=pe):pe.length===0?ve=pe:ve=[Q[0],pe],ve}if(Q.length<c.length){let ne=[],pe=c.length;for(let De=0;De<pe-1;De++)ne.push(e.parse(c[De]));let Se={},ve=f.solveSystem(ne,Q);Array.isArray(ve)?ve.forEach(De=>{Se[De[0]]=De[1]}):Se=ve;let Ue=!0;for(let De=pe-1;De<pe;De++)e.parse(c[De],Se).equals(0)||(Ue=!1);if(Ue)return ve}for(let ne=0;ne<Q.length;ne++)R0.setVar(Q[ne],"delete");for(let ne=0;ne<M;ne++){let pe=c[ne];for(let ve=0;ve<Q.length;ve++){let Ue=Q[ve],De=[];pe.each(rt=>{rt.contains(Ue)&&(De=De.concat(rt.coeffs()))});let Je=t.Utils.arraySum(De);q.set(ne,ve,Je)}let Se=pe.clone();Q.forEach(ve=>{Se=Se.stripVar(ve,!0)}),F.set(ne,0,Se.negate())}}else{Q=m,$=!0;for(let ne=0;ne<M;ne++){F.set(ne,0,new se(0));let pe=e.expand(c[ne]).collectSummandSymbols();for(let Se=0;Se<m.length;Se++){q.set(ne,Se,new se(0));let ve=m[Se];for(let Ue=0;Ue<pe.length;Ue++){let De=pe[Ue],Je=!1;for(let rt=0;rt<m.length;rt++)De.contains(m[rt])&&(Je&&t.Utils.err(`Multiple variables found for term ${De}`),Je=!0);if(De.contains(ve)){let rt=L(Y(pe,Ue),ve);Ue--,q.set(ne,Se,e.add(q.get(ne,Se),rt[0]))}}}for(let Se=0;Se<pe.length;Se++)F.set(ne,0,e.add(F.get(ne,0),pe[Se]))}}if(Q.length!==c.length||q.determinant().equals(0))throw new t.exceptions.SolveError("System does not have a distinct solution");q=q.invert();let K=q.multiply(F);return t.Utils.isArray(m)&&K.each(ne=>ne.negate()),f.systemSolutions(K,Q,$)},quad(c,m,M){let q=e.subtract(e.pow(m.clone(),new se(2)),e.multiply(e.multiply(M.clone(),c.clone()),new se(4)));q=e.expand(q);let F=e.pow(q,new se(.5)),$=e.parse(e.multiply(new se(2),M.clone()));return[e.parse(we("(-({0})+({1}))/({2})",m,F,$)),e.parse(we("(-({0})-({1}))/({2})",m,F,$))]},cubic(c,m,M,q){let F=q.text(),$=M.text(),Q=m.text(),K=c.text(),ne=`(-(${$})^3/(27*(${F})^3)+(${$})*(${Q})/(6*(${F})^2)-(${K})/(2*(${F})))`,pe=`((${Q})/(3*(${F}))-(${$})^2/(9*(${F})^2))`,Se=`(${$})/(3*(${F}))`,ve=`((${ne})+sqrt((${ne})^2+(${pe})^3))^(1/3)+((${ne})-sqrt((${ne})^2+(${pe})^3))^(1/3)-(${Se})`,Ue="1/2+sqrt(3)/2*i";return[e.parse(ve),e.parse(`(${ve})(${Ue})`),e.parse(`(${ve})(${Ue})^2`)]},quartic(c,m,M,q,F){let $={};t.Utils.arrayUnique(fe(F).concat(fe(q)).concat(fe(M)).concat(fe(m)).concat(fe(c))).forEach(j=>{$[j]=1});let Q=F.toString(),K=q.toString(),ne=M.toString(),pe=m.toString(),Se=c.toString(),ve,Ue=e.parse(we("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",Q,K,ne)).toString(),De=e.parse(we("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",Q,K,ne,pe)).toString(),Je=e.parse(we("12*({0})*({4})-3*({1})*({3})+({2})^2",Q,K,ne,pe,Se)).toString(),rt=e.parse(we("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",Q,K,ne,pe,Se)).toString(),qe=e.parse(we("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",Je,rt)).toString(),Fe=e.parse(we("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",Q,Ue,qe,Je)).toString(),$e=e.parse(we("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",Q,K,Ue,De,Fe)),Xe=e.parse(we("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",Q,K,Ue,De,Fe)),ke=e.parse(we("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",Q,K,Ue,De,Fe)),z=e.parse(we("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",Q,K,Ue,De,Fe));return[$e,Xe,ke,z]},divideAndConquer(c,m){let M=[],q=b.factorInner(c);return q.group===be&&q.each(F=>{F=se.unwrapPARENS(F),M=M.concat(_(F,m))}),M},csolve(c,m){return t.Utils.block("IGNORE_E",()=>{let M,q,F,$,Q,K,ne,pe,Se=[],ve=t.Utils.decompose_fn(c,m,!0);if(ve.x.group===a){M=e.parse(ve.x.power),q=Number(M),F=e.pow(e.divide(ve.b.negate(),ve.a),M.invert()),$=se.toPolarFormArray(F),Q=$[0],K=$[1],ne=Q.toString(),pe=M.toString();let Ue,De,Je;for(let rt=0;rt<q;rt++)Ue=rt,Je=we("({0})*e^(2*{1}*pi*{2}*{3})",ne,Ue,M,t.Settings.IMAGINARY),De=e.parse(Je),Se.push(De)}return Se},!0)},getPoints(c,m,M){m||=.01;let q=[],F=Ee(c),Q=Math.round(0),K=F(Q),ne=t.Settings.ROOTS_PER_SIDE,pe=ne;q.push(Math.floor(Q/2)),q.push(Math.abs(Q)),q.push(Q),c.each(De=>{De.containsFunction(t.Settings.LOG)&&q.push(.1)});let Se=me(-t.Settings.SOLVE_RADIUS,Q,m),ve=me(Q,t.Settings.SOLVE_RADIUS,m),Ue=function(De,Je){let rt,qe,Fe,$e=[],Xe=De[0],ke=Math.sign(F(Xe));for(let z=0,j=De.length;z<j&&$e.length<Je;z++)rt=De[z],qe=F(rt),Fe=Math.sign(qe),!isNaN(Fe)&&(Fe!==ke&&($e.push(rt),$e.push(De[z-1])),ke=Fe);q=q.concat($e)};if(Ue(Se,pe),Ue(ve,ne),M){let De=t.Settings.SOLVE_RADIUS;Ue([De,De*De],1),Ue([-De*De,-De],1)}return q},bisection(c,m){let M=c-1,q=c+1;if(Math.sign(m(M))!==Math.sign(m(q))){let F=0,$,Q;do{if($=Math.abs(q-M),F++>t.Settings.MAX_BISECTION_ITER||isNaN($))return;Q=(M+q)/2,m(M)*m(Q)>0?M=Q:q=Q}while($>=xe.EPSILON);let K=(M+q)/2,ne=m(K);return!isNaN(ne)&&Math.abs(ne)<=t.Settings.BI_SECTION_EPSILON?t.Utils.round(K,13):void 0}},bSearch(c,m,M){let q=M(c),F=M(m);if(Math.sign(q)===Math.sign(F)||isNaN(q)||isNaN(F))return;let $=80,Q=0;do{let K=(c+m)/2,ne=Math.sign(q),pe=Math.sign(M(K));if(ne===pe){if(K===c)break;c=K,q=M(c)}else{if(K===m)break;m=K,F=M(m)}Q++}while(c!==m&&Q<$);if(!(!isFinite(M(c))||!isFinite(M(m))))return c},Newton(c,m,M,q){let F=t.Settings.MAX_NEWTON_ITERATIONS,$=0,Q=c,K,ne,pe;do{let Se=m(Q);if(Q===0&&Se===0){K=0;break}if($++,$>F)return;let ve=M(Q);if(isNaN(ve)||isNaN(Se))return;if(ve===0)K+=pe;else{if(!isFinite(Se)||!isFinite(ve)||Math.abs(Se)>1e25)return f.bSearch(q,Q,m);K=Q-Se/ve}if(pe=K-Q,pe===0&&!isFinite(ve))return;ne=Math.abs(pe),Q=K}while(ne>xe.NEWTON_EPSILON);return K},rewrite(c,m,M){if(m||=new se(0),c.isComposite()&&c.isLinear()){let $=[],Q=[];c.each(K=>{K=K.clone(),K.fname==="sqrt"&&K.contains(M)?$.push(K):Q.push(K)},!0),$.length===1&&(m=e.expand(e.pow(e.subtract(m,t.Utils.arraySum(Q)),new se(2))),c=e.expand(e.pow(se.unwrapSQRT($[0]),new se(2))))}else c=se.unwrapSQRT(e.expand(c));let q=0,F=c.length;if(c.group===Le&&c.contains(M)&&c.isLinear()){c.distributeMultiplier();let $=new se(0);return c.each(Q=>{Q.contains(M)?(q++,$=e.add($,Q.clone())):m=e.subtract(m,Q.clone())}),c=$,q!==F?f.rewrite(c,m,M):[c,m]}if(c.group===be&&c.contains(M)&&c.isLinear()){if(c.multiplier.lessThan(0)&&(c.multiplier=c.multiplier.multiply(new t.Frac(-1)),m.multiplier=m.multiplier.multiply(new t.Frac(-1))),m.equals(0))return new se(0);let $=new se(1);return c.each(Q=>{Q.contains(M)?$=e.multiply($,Q.clone()):m=e.divide(m,Q.clone())}),c=$,f.rewrite(c,m,M)}if(!c.isLinear()&&c.contains(M)){let $=e.parse(c.power.clone().invert());return c=e.pow(c,$.clone()),m=e.pow(e.expand(m),$.clone()),f.rewrite(c,m,M)}return c.group===Ae||c.group===a||c.group===Ne?[c,m]:[c,m]},sqrtSolve(c,m){let M=new se(0),q=new se(0);if(c.isComposite()&&(c.each(F=>{F.fname==="sqrt"&&F.contains(m)?M=e.add(M,F.clone()):q=e.add(q,F.clone())}),!M.equals(0))){let F=e.expand(e.multiply(e.parse(c.multiplier),e.subtract(e.pow(q,new se(2)),e.pow(M,new se(2))))),$=_(F,m);return $=$.filter(Q=>{if(Q.isImaginary())return!0;let K={};return K[m]=Q,!!V(c,K).equals(0)}),$}}},S=function(c,m,M,q){let F=c.toString(),$=F.match(/(?<![a-z])abs/gu);if(!$||$.length>2||c.LHS.group!==Ae&&c.RHS.group!==Ae)return null;let Q=c.constructor(F.replace(/(?<![a-z])abs/u,"")),K=c.constructor(F.replace(/(?<![a-z])abs/u,"(-1)")),ne=_(Q,m,null,M,q);return[_(K,m,null,M,q),ne]};function _(c,m,M,q,F){if(q||=0,q++>xe.MAX_SOLVE_DEPTH)return M;M||=[];let $={},Q={};Q[m]=0;let K=function(qe,Fe){let $e=ge(qe);if(!(qe===void 0||typeof qe=="number"&&isNaN(qe))){if(_e(qe))qe.forEach(Xe=>{K(Xe)});else if(qe.valueOf()!=="null"){if(typeof t.Settings.PRE_ADD_SOLUTION=="function"&&(qe=t.Settings.PRE_ADD_SOLUTION(qe)),$e||(qe=e.parse(qe)),t.Settings.make_pi_conversions&&Fe){let ke=e.divide(qe.clone(),new se(Math.PI)),z=ke.multiplier,j=Math.abs(Number(z.num)),X=Math.abs(Number(z.den));j<10&&X<10&&(qe=e.multiply(ke,new se("pi")))}let Xe=qe.toString();$[Xe]||M.push(qe),$[Xe]=!0}}};if(c instanceof ye){let qe=S(c,m,q,F);if(qe)return K(qe),M;if(c.isZero())return[new se(0)];if(c.LHS.equals(m)&&!c.RHS.contains(m,!0))return[c.RHS];if(c.RHS.equals(m)&&!c.LHS.contains(m,!0))return[c.LHS]}if(c instanceof t.Vector&&(c=c.elements),_e(c))return f.solveSystem(c,m);if(m||="x",ge(c)&&V(c.getDenom(),Q).equals(0)===!0)return M;if(c.group===a&&c.contains(m)){try{let qe={};qe[m]=0,V(F,qe),K(new se(0))}catch(qe){if(qe.message==="timeout")throw qe}return M}if(c.group===be){let qe=c.getNum();if(qe.group===be){let Fe=String(m);return qe.each($e=>{$e.contains(Fe)&&_($e,m,M,q,c)}),M}return _(qe,m,M,q,F)}c.group===Ae&&c.fname==="sqrt"&&(c=e.pow(se.unwrapSQRT(c),new se(2)));let ne=(t.Utils.isSymbol(c)?c:f.toLHS(c,!1)).getNum(),pe=t.Utils.variables(ne),Se=pe.length;if(t.Utils.isInt(ne.power)&&ne.power>1&&(ne=e.parse(ne).toLinear()),(ne.group===a||ne.group===be)&&ne.contains(m))return[new se(0)];let ve={},Ue,De=function(qe){qe=e.expand(qe,{expand_denominator:!0,expand_functions:!0});let Fe=qe.clone();if(qe.symbols)for(let $e in qe.symbols){if(!Object.hasOwn(qe.symbols,$e))continue;let Xe=qe.symbols[$e],ke=Xe.getDenom();if(!ke.isConstant(!0)&&qe.isComposite()){let ee=new se(0);return qe.each(O=>{ee=e.add(ee,e.multiply(O,ke.clone()))}),De(e.multiply(e.parse(qe.multiplier),ee))}let z=L(Xe,m),j=z[1].fname===t.Settings.SQRT,X=se.unwrapSQRT(z[1]),D=X.power.clone();if(!ge(D)&&!D.equals(1/2)){if(Number(D.den)>1){if(j)return qe=e.subtract(qe,Xe.clone()),qe=e.add(qe,e.multiply(z[0].clone(),X)),De(qe);let ee=ve[Number(D.den)];ve[Number(D.den)]=ee?ee++:1}else if(D.sign()===-1){let ee=e.parse(`${m}^${Math.abs(Number(D))}`),O=qe;return O.each((x,g)=>{x.contains(m)&&(O.symbols[g]=e.multiply(x,ee.clone()))}),ve={},De(e.parse(O))}else if(Xe.group===Ne){let ee=t.Utils.arrayMin(t.Utils.keys(Xe.symbols).map(Number));if(ee<0){let O=e.parse(`${m}^${Math.abs(ee)}`),x=new se(0);return Fe.each(g=>{x=e.add(x,e.multiply(g.clone(),O.clone()))},!0),x}}}}return qe},Je=function(qe){let Fe=new se(0),$e=new se(0);return qe.each(Xe=>{Xe.contains(m,!0)?Fe=e.add(Fe,Xe.clone()):$e=e.subtract($e,Xe.clone())}),[Fe,$e]};if(f.inverseFunctionSolve=function(Fe,$e,Xe){let ke=L($e.args[0],m);if(ke[1].group===a)return e.divide(e.symfunction(Fe,[e.divide(Xe,e.parse($e.multiplier))]),ke[0])},ne=De(ne),ne.equals(0))return[ne];let rt=t.Utils.keys(ve);if(rt.length===1&&(Ue=rt[0],ne.each((qe,Fe)=>{if(qe.contains(m)){let $e=L(qe,m),Xe=$e[1],ke=Xe.power;ke.den.gt(1)&&(Xe.power=ke.multiply(new t.Frac(Ue)),ne.symbols[Fe]=e.multiply(Xe,$e[0]))}}),ne=e.parse(ne)),K(f.sqrtSolve(ne,m)),Se===1)if(ne.isPoly(!0)){let qe=new G.Factors;if(b.factorInner(ne,qe),qe.getNumberSymbolics()>1)for(let Fe in qe.factors)Object.hasOwn(qe.factors,Fe)&&K(_(qe.factors[Fe],m));else{let Fe=t.Utils.getCoeffs(ne,m),$e=Fe.length-1,Xe=!1;if(pe[0]===m){if(s(Fe,ke=>ke.group!==t.groups.N)){let ke=t.Algebra.proots(ne);s(ke,z=>!t.Utils.isInt(z))&&(Xe=!0,ke.forEach(z=>{K(new se(z))}))}if(!Xe)if(c=e.parse(c),c instanceof t.Equation&&(c=c.toLHS()),$e===1)K(e.divide(Fe[0],Fe[1].negate()));else if($e===2)K(e.expand(f.quad.apply(void 0,Fe)));else if($e===3){let ke=[],z=b.factorInner(c);ke=[],ke.length>0?K(ke):K(f.cubic.apply(void 0,Fe))}else o.proots(ne).map(K)}}}else{let qe=ne.hasTrig(),Fe=f.getPoints(ne,.1),$e=f.getPoints(ne,.05),Xe=f.getPoints(ne,.01,!0),ke=t.Utils.arrayUnique(Fe.concat($e).concat(Xe)).sort((p,P)=>p-P),z,j,X,D=Ee(ne.clone()),ee=[];for(z=0;z<ke.length;z++){if(j=ke[z],X=f.bisection(j,D),typeof X>"u"){ee.push(j);continue}K(X,qe)}ke=ee;let O=h.diff(ne.clone()),x=Ee(O),g=ke[0];for(z=0;z<ke.length;z++)j=ke[z],K(f.Newton(j,D,x,g),qe),g=j;M.sort((p,P)=>{let w=p.text("decimals"),U=P.text("decimals"),B=Number(w),Z=Number(U);return isNaN(B)&&isNaN(Z)?w.localeCompare(U):isNaN(B)&&!isNaN(Z)?-1:!isNaN(B)&&isNaN(Z)?1:B-Z}),M=M.map(p=>p.isConstant()?new se(Number(Number(p).toPrecision(15))):p),M=M.filter((p,P,w)=>{let U=Number(Number(p).toPrecision(15)),B=Number(w[P-1]);return P===0||isNaN(U)||isNaN(B)?!0:Math.abs(U-B)>=xe.EPSILON})}else if(!ne.hasFunc(m)&&ne.isComposite())try{let qe=b.factorInner(ne.clone()),Fe=e.expand(e.parse(qe)),$e=e.expand(ne.clone()),Xe=e.subtract(Fe,$e),ke=!0;if(Xe.equals(0)||(ke=!1),ke&&qe.group===be)qe.each(z=>{K(_(z,m))});else{let z=t.Utils.getCoeffs(ne,m);switch(z.length-1){case 0:{let D=Je(ne),ee=D[0],O=D[1];if(ee.group===t.groups.EX){let x=t.Settings.LOG,g=`${x}((${O})/(${ee.multiplier}))/(${x}(${ee.value})*${ee.power.multiplier})`,p=e.parse(g);K(p)}break}case 1:K(e.divide(z[0],z[1].negate()));break;case 2:K(f.quad.apply(void 0,z));break;case 3:K(f.cubic.apply(void 0,z));break;case 4:K(f.quartic.apply(void 0,z));break;default:K(f.csolve(ne,m)),M.length===0&&K(f.divideAndConquer(ne,m))}M.length===0&&K(_(qe,m,M,q))}}catch(qe){if(qe.message==="timeout")throw qe}else try{let qe=f.rewrite(ne,null,m),Fe=qe[0],$e=qe[1];if(Fe.group===Ae)if(Fe.fname==="abs")Fe.args[0].toString()===m&&K([$e.clone(),$e.negate()]);else if(Fe.fname==="sin")K(f.inverseFunctionSolve("asin",Fe,$e));else if(Fe.fname==="cos")K(f.inverseFunctionSolve("acos",Fe,$e));else if(Fe.fname==="tan")K(f.inverseFunctionSolve("atan",Fe,$e));else if(Fe.fname===t.Settings.LOG){let Xe=L(Fe.args[0],m),ke=Xe[1];if(ke.group===a){$e=e.divide(e.subtract(e.pow(Fe.args.length>1?Fe.args[1]:new se("e"),e.divide($e,e.parse(Fe.multiplier))),Xe[3]),Xe[0]);let z=new ye(ke,$e).toLHS();K(_(z,m))}}else K(e.subtract(Fe,$e));else{let Xe=new ye(Fe,$e).toLHS();if(Xe.equals(ne))throw new Error("Stopping. No stop condition exists");K(_(Xe,m))}}catch(qe){if(qe.message==="timeout")throw qe;if(ne.group===be)K(0);else if(ne.group===Le){let Fe=Je(ne),$e=Fe[0],Xe=Fe[1];if($e.group===t.groups.EX&&$e.value===m){let ke=$e.power.clone().invert();K(e.pow(Xe,ke))}}}if(Ue&&(M=M.map(qe=>e.pow(qe,new se(Ue)))),ge(c)){let qe={};M=M.filter(Fe=>{try{qe[m]=Fe;let $e=Number(V(c,qe));return isNaN($e),!0}catch($e){if($e.message==="timeout")throw $e;return!1}})}return M}R0.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return _}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return t.Solve.solve}},{name:"setEquation",parent:"Solve",numargs:2,visible:!0,build(){return he}}]),R0.updateAPI()})()});var p1=f0((e2,on)=>{"use strict";var L0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof on<"u"&&L0===void 0&&(L0=T0(),V0(),X0());(function(){let t=L0.getCore(),e=t.PARSER,{NerdamerSymbol:o}=t,{format:h}=t.Utils,{isVector:y}=t.Utils,{isArray:L}=t.Utils,b=t.Vector,{S:k}=t.groups,G=t.groups.EX,{CP:V}=t.groups,{PL:Y}=t.groups,{CB:we}=t.groups,{FN:Ee}=t.groups;t.Settings.Laplace_integration_depth=40,o.prototype.findFunction=function(ge){if(this.group===Ee&&this.fname===ge)return this.clone();let fe;if(this.symbols){for(let a in this.symbols)if(Object.hasOwn(this.symbols,a)&&(fe=this.symbols[a].findFunction(ge),fe))break}return fe};let Me=t.Extra={version:"1.4.2",LaPlace:{transform(se,ge,fe){se=se.clone(),ge=ge.toString(),se=o.unwrapSQRT(se,!0);let a,Ne=se.stripVar(ge),be=se.group;if(se=e.divide(se,Ne.clone()),se.isConstant()||!se.contains(ge,!0))a=e.parse(h("({0})/({1})",se,fe));else if(be===k&&t.Utils.isInt(se.power)){let Le=String(se.power);a=e.parse(h("factorial({0})/({1})^({0}+1)",Le,fe))}else if(se.group===k&&se.power.equals(1/2))a=e.parse(h("sqrt(pi)/(2*({0})^(3/2))",fe));else if(se.isComposite())a=new o(0),se.each(Le=>{a=e.add(a,Me.LaPlace.transform(Le,ge,fe))},!0);else if(se.isE()&&(se.power.group===k||se.power.group===we)){let Le=se.power.stripVar(ge);a=e.parse(h("1/(({1})-({0}))",Le,fe))}else{let Le=["sin","cos","sinh","cosh"];if(se.group===Ee&&Le.indexOf(se.fname)!==-1&&(se.args[0].group===k||se.args[0].group===we)){let Ae=se.args[0].stripVar(ge);switch(se.fname){case"sin":a=e.parse(h("({0})/(({1})^2+({0})^2)",Ae,fe));break;case"cos":a=e.parse(h("({1})/(({1})^2+({0})^2)",Ae,fe));break;case"sinh":a=e.parse(h("({0})/(({1})^2-({0})^2)",Ae,fe));break;case"cosh":a=e.parse(h("({1})/(({1})^2-({0})^2)",Ae,fe));break}}else{let Ae=t.Settings.integration_depth<t.Settings.Laplace_integration_depth,xe;Ae&&(xe=t.Settings.integration_depth,t.Settings.integration_depth=t.Settings.Laplace_integration_depth),t.Utils.block("PARSE2NUMBER",()=>{let me=ge,_e=se.sub(ge,me),ye=e.parse(`e^(-${fe}*${me})*${_e}`);if(a=t.Calculus.integrate(ye,me),a.hasIntegral()){a=e.symfunction("laplace",[se,ge,fe]);return}a=a.sub(ge,0),a=e.expand(e.multiply(a,new o(-1))),a=a.sub(me,ge)},!1),a=t.Utils.block("PARSE2NUMBER",()=>e.parse(a),!0),Ae&&(t.Settings.integration_depth=xe)}}return e.multiply(a,Ne)},inverse(se,ge,fe){let a=se.clone();return t.Utils.block("POSITIVE_MULTIPLIERS",()=>{let Ne;if(se.group===we&&(se=t.Algebra.PartFrac.partfrac(e.expand(se),ge)),se.group===k||se.group===we||se.isComposite()){let be,Le,Ae,xe,me,_e,ye,he,s=se.multiplier.clone();se.toUnitMultiplier();let f=se.getNum(),S=se.getDenom().toUnitMultiplier();S.group===V||S.group===Y?(Le=S.power.clone(),S.toLinear()):Le=new t.Frac(1);let _=ge.toString(),c=t.Utils.decompose_fn(S,_,!0),m=t.Utils.decompose_fn(e.expand(f.clone()),_,!0);f.multiplier=f.multiplier.multiply(s);let M=function(){Ne=e.multiply(Ne,f),Ne.multiplier=Ne.multiplier.multiply(se.multiplier),Ne=e.divide(Ne,c.a)};if((S.group===k||S.group===we)&&c.x.value===_&&c.b.equals(0)&&t.Utils.isInt(c.x.power))be=c.x.power-1,he=t.Math2.factorial(be),Ne=e.divide(e.pow(fe,new o(be)),new o(he)),M();else if(S.group===V&&Le.equals(1)){if(c.x.group===t.groups.PL&&t.Algebra.degree(S).equals(2)){let q=t.Algebra.sqComplete(S,_),F=t.Utils.getU(S);Ae=t.Utils.decompose_fn(q.a,_,!0).b;let $=Me.LaPlace.inverse(e.parse(`1/((${F})^2+(${q.c}))`),F,fe);Ne=e.multiply($,e.parse(`(${s})*e^(-(${Ae})*(${fe}))`))}else if(c.x.isLinear()&&!f.contains(_))fe=e.divide(fe,c.a.clone()),be=Le-1,he=be===0||be===1?"1":`(${Le}-1)!`,Ne=e.parse(h("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",fe,c.a,c.b,Le,he)),M();else if(c.x.group===k&&c.x.power.equals(2))if(f.contains(_)){if(Ae=new o(1),f.group===we){let pe=new o(1);f.each(Se=>{Se.contains(_)?pe=e.multiply(pe,Se):Ae=e.multiply(Ae,Se)}),f=pe}ye=t.Utils.decompose_fn(f,_,!0);let q=ye.a,F=ye.b,$=q.containsFunction("sin"),Q=q.containsFunction("cos"),K=F.containsFunction("cos"),ne=F.containsFunction("sin");if(ye.x.value===_&&ye.x.isLinear()&&!($&&K||Q||ne))Ne=e.parse(h("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",fe,ye.a,c.a,c.b));else if($&&K){let pe=q.findFunction("sin"),Se=F.findFunction("cos");if(pe.args[0].equals(Se.args[0])&&!pe.args[0].contains(_)){xe=e.divide(F,Se.toUnitMultiplier()).toString();let ve=pe.args[0].toString();me=c.b;let Ue=e.divide(q,pe.toUnitMultiplier());_e="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",Ne=e.parse(h(_e,fe,Ae,xe,ve,me,Ue))}}}else Ne=e.parse(h("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",fe,f,c.a,c.b))}else if(c.x.power.num&&c.x.power.num.equals(3)&&c.x.power.den.equals(2)&&f.contains("sqrt(pi)")&&!f.contains(_)&&f.isLinear())xe=e.divide(f.clone(),e.parse("sqrt(pi)")),Ne=e.parse(h("(2*({2})*sqrt({0}))/({1})",fe,c.a,xe,f));else if(Le.equals(2)&&c.x.power.equals(2))if(f.contains(_))if(ye=t.Utils.decompose_fn(e.expand(f.clone()),_,!0),ye.x.isComposite()){let q=[],F=f.collectSymbols($=>{$=o.unwrapPARENS($);let Q=t.Utils.decompose_fn($,_,!0);return Q.symbol=$,Q}).sort(($,Q)=>{let K=$.x.value===_?$.x.power:0;return(Q.x.value===_?Q.x.power:0)-K});Ae=new o(-1);for(let $=0;$<F.length;$++){let Q=F[$];Q.x.value===_?q.push(Q):Ae=e.multiply(Ae,Q.symbol)}q[0].x.power.equals(2)&&q[1].x.power.equals(1)&&q[1].b.equals(0)&&!q[0].b.equals(0)&&(xe=q[0].a.negate(),_e="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",Ne=e.parse(h(_e,fe,Ae,xe,q[0].b,c.a,c.b)))}else ye.x.isLinear()?(Ae=e.divide(ye.a,new o(2)),_e="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",Ne=e.parse(h(_e,fe,Ae,c.a,c.b))):ye.x.power.equals(2)&&(ye.b.equals(0)?(Ae=e.divide(ye.a,new o(2)),_e="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ne=e.parse(h(_e,fe,Ae,c.a,c.b))):(Ae=e.divide(ye.a,new o(2)),me=ye.b.negate(),_e="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ne=e.parse(h(_e,fe,Ae,c.a,c.b,me))));else Ae=e.divide(f,new o(2)),_e="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",Ne=e.parse(h(_e,fe,Ae,c.a,c.b));else se.isComposite()&&(Le.equals(2)&&c.x.group===k?Ne=e.parse(`(${s})*(${fe})*e^(-(${c.b})*(${fe}))`):(Ne=new o(0),se=t.Algebra.PartFrac.partfrac(e.expand(se),ge),se.each(q=>{Ne=e.add(Ne,Me.LaPlace.inverse(q,ge,fe))},!0)))}return Ne||=e.symfunction("ilt",[a,ge,fe]),Ne},!0)}},Statistics:{frequencyMap(se){let ge={};for(let fe=0,a=se.length;fe<a;fe++){let be=se[fe].toString();ge[be]||=0,ge[be]++}return ge},sort(se){return se.sort((ge,fe)=>((!ge.isConstant()||!fe.isConstant())&&e.error("Unable to sort! All values must be numeric"),ge.multiplier.subtract(fe.multiplier)))},count(se){return new o(se.length)},sum(se,ge){let fe=new o(0);for(let a=0,Ne=se.length;a<Ne;a++){let be=se[a].clone();ge?fe=e.add(e.pow(e.subtract(be,ge.clone()),new o(2)),fe):fe=e.add(be,fe)}return fe},mean(...se){return y(se[0])?Me.Statistics.mean(...se[0].elements):e.divide(Me.Statistics.sum(se),Me.Statistics.count(se))},median(...se){let ge;if(y(se[0]))return Me.Statistics.median(...se[0].elements);try{let fe=Me.Statistics.sort(se),a=se.length;if(t.Utils.even(a)){let Ne=a/2;ge=Me.Statistics.mean(fe[Ne-1],fe[Ne])}else ge=fe[Math.floor(a/2)]}catch(fe){if(fe.message==="timeout")throw fe;ge=e.symfunction("median",se)}return ge},mode(...se){let ge;if(y(se[0]))return Me.Statistics.mode(...se[0].elements);let fe=Me.Statistics.frequencyMap(se);if(t.Utils.keys(fe).length===1)ge=se[0];else{let a={};for(let be in fe){if(!Object.hasOwn(fe,be))continue;let Le=fe[be];if(Le in a){let Ae=a[Le];L(Ae)?Ae.push(be):a[Le]=[be,a[Le]]}else a[Le]=be}let Ne=a[Math.max.apply(null,t.Utils.keys(a))];L(Ne)?ge=e.symfunction("mode",Ne.sort()):ge=e.parse(Ne)}return ge},gVariance(se,ge){let fe=Me.Statistics.mean(...ge),a=Me.Statistics.sum(ge,fe);return e.multiply(se,a)},variance(...se){if(y(se[0]))return Me.Statistics.variance(...se[0].elements);let ge=e.divide(new o(1),Me.Statistics.count(se));return Me.Statistics.gVariance(ge,se)},sampleVariance(...se){if(y(se[0]))return Me.Statistics.sampleVariance(...se[0].elements);let ge=e.divide(new o(1),e.subtract(Me.Statistics.count(se),new o(1)));return Me.Statistics.gVariance(ge,se)},standardDeviation(...se){return y(se[0])?Me.Statistics.standardDeviation(...se[0].elements):e.pow(Me.Statistics.variance(...se),new o(1/2))},sampleStandardDeviation(...se){return y(se[0])?Me.Statistics.sampleStandardDeviation(...se[0].elements):e.pow(Me.Statistics.sampleVariance(...se),new o(1/2))},zScore(se,ge,fe){return e.divide(e.subtract(se,ge),fe)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};L0.register([{name:"laplace",visible:!0,numargs:3,build(){return Me.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Me.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Me.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Me.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Me.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Me.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Me.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Me.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Me.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Me.Statistics.zScore}}]),L0.updateAPI()})();typeof on<"u"&&(on.exports=L0)});var ji=f0((t2,h1)=>{var Hi=T0();X0();V0();f1();p1();h1.exports=Hi});return ji();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
