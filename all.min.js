"use strict";var nerdamer=(()=>{var u0=(O,l)=>()=>(l||O((l={exports:{}}).exports,l),l.exports);var I1=u0((Di,Z0)=>{var Gt=(function(O){"use strict";var l=1e7,t=7,ee=9007199254740992,de=mt(ee),xe="0123456789abcdefghijklmnopqrstuvwxyz",Ue=typeof BigInt=="function";function se(i,h,M,C){return typeof i>"u"?se[0]:typeof h<"u"?+h==10&&!M?q(i):Le(i,h,M,C):q(i)}function ge(i,h){this.value=i,this.sign=h,this.isSmall=!1}ge.prototype=Object.create(se.prototype);function G(i){this.value=i,this.sign=i<0,this.isSmall=!0}G.prototype=Object.create(se.prototype);function u(i){this.value=i}u.prototype=Object.create(se.prototype);function le(i){return-ee<i&&i<ee}function mt(i){return i<1e7?[i]:i<1e14?[i%1e7,Math.floor(i/1e7)]:[i%1e7,Math.floor(i/1e7)%1e7,Math.floor(i/1e14)]}function at(i){Ke(i);var h=i.length;if(h<4&&F(i,de)<0)switch(h){case 0:return 0;case 1:return i[0];case 2:return i[0]+i[1]*l;default:return i[0]+(i[1]+i[2]*l)*l}return i}function Ke(i){for(var h=i.length;i[--h]===0;);i.length=h+1}function ue(i){for(var h=new Array(i),M=-1;++M<i;)h[M]=0;return h}function Se(i){return i>0?Math.floor(i):Math.ceil(i)}function Ie(i,h){var M=i.length,C=h.length,H=new Array(M),D=0,e=l,n,r;for(r=0;r<C;r++)n=i[r]+h[r]+D,D=n>=e?1:0,H[r]=n-D*e;for(;r<M;)n=i[r]+D,D=n===e?1:0,H[r++]=n-D*e;return D>0&&H.push(D),H}function te(i,h){return i.length>=h.length?Ie(i,h):Ie(h,i)}function $e(i,h){var M=i.length,C=new Array(M),H=l,D,e;for(e=0;e<M;e++)D=i[e]-H+h,h=Math.floor(D/H),C[e]=D-h*H,h+=1;for(;h>0;)C[e++]=h%H,h=Math.floor(h/H);return C}ge.prototype.add=function(i){var h=q(i);if(this.sign!==h.sign)return this.subtract(h.negate());var M=this.value,C=h.value;return h.isSmall?new ge($e(M,Math.abs(C)),this.sign):new ge(te(M,C),this.sign)},ge.prototype.plus=ge.prototype.add,G.prototype.add=function(i){var h=q(i),M=this.value;if(M<0!==h.sign)return this.subtract(h.negate());var C=h.value;if(h.isSmall){if(le(M+C))return new G(M+C);C=mt(Math.abs(C))}return new ge($e(C,Math.abs(M)),M<0)},G.prototype.plus=G.prototype.add,u.prototype.add=function(i){return new u(this.value+q(i).value)},u.prototype.plus=u.prototype.add;function He(i,h){var M=i.length,C=h.length,H=new Array(M),D=0,e=l,n,r;for(n=0;n<C;n++)r=i[n]-D-h[n],r<0?(r+=e,D=1):D=0,H[n]=r;for(n=C;n<M;n++){if(r=i[n]-D,r<0)r+=e;else{H[n++]=r;break}H[n]=r}for(;n<M;n++)H[n]=i[n];return Ke(H),H}function Be(i,h,M){var C;return F(i,h)>=0?C=He(i,h):(C=He(h,i),M=!M),C=at(C),typeof C=="number"?(M&&(C=-C),new G(C)):new ge(C,M)}function qe(i,h,M){var C=i.length,H=new Array(C),D=-h,e=l,n,r;for(n=0;n<C;n++)r=i[n]+D,D=Math.floor(r/e),r%=e,H[n]=r<0?r+e:r;return H=at(H),typeof H=="number"?(M&&(H=-H),new G(H)):new ge(H,M)}ge.prototype.subtract=function(i){var h=q(i);if(this.sign!==h.sign)return this.add(h.negate());var M=this.value,C=h.value;return h.isSmall?qe(M,Math.abs(C),this.sign):Be(M,C,this.sign)},ge.prototype.minus=ge.prototype.subtract,G.prototype.subtract=function(i){var h=q(i),M=this.value;if(M<0!==h.sign)return this.add(h.negate());var C=h.value;return h.isSmall?new G(M-C):qe(C,Math.abs(M),M>=0)},G.prototype.minus=G.prototype.subtract,u.prototype.subtract=function(i){return new u(this.value-q(i).value)},u.prototype.minus=u.prototype.subtract,ge.prototype.negate=function(){return new ge(this.value,!this.sign)},G.prototype.negate=function(){var i=this.sign,h=new G(-this.value);return h.sign=!i,h},u.prototype.negate=function(){return new u(-this.value)},ge.prototype.abs=function(){return new ge(this.value,!1)},G.prototype.abs=function(){return new G(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)};function Xe(i,h){var M=i.length,C=h.length,H=M+C,D=ue(H),e=l,n,r,p,w,E;for(p=0;p<M;++p){w=i[p];for(var _=0;_<C;++_)E=h[_],n=w*E+D[p+_],r=Math.floor(n/e),D[p+_]=n-r*e,D[p+_+1]+=r}return Ke(D),D}function De(i,h){var M=i.length,C=new Array(M),H=l,D=0,e,n;for(n=0;n<M;n++)e=i[n]*h+D,D=Math.floor(e/H),C[n]=e-D*H;for(;D>0;)C[n++]=D%H,D=Math.floor(D/H);return C}function J(i,h){for(var M=[];h-- >0;)M.push(0);return M.concat(i)}function c(i,h){var M=Math.max(i.length,h.length);if(M<=30)return Xe(i,h);M=Math.ceil(M/2);var C=i.slice(M),H=i.slice(0,M),D=h.slice(M),e=h.slice(0,M),n=c(H,e),r=c(C,D),p=c(te(H,C),te(e,D)),w=te(te(n,J(He(He(p,n),r),M)),J(r,2*M));return Ke(w),w}function d(i,h){return-.012*i-.012*h+15e-6*i*h>0}ge.prototype.multiply=function(i){var h=q(i),M=this.value,C=h.value,H=this.sign!==h.sign,D;if(h.isSmall){if(C===0)return se[0];if(C===1)return this;if(C===-1)return this.negate();if(D=Math.abs(C),D<l)return new ge(De(M,D),H);C=mt(D)}return d(M.length,C.length)?new ge(c(M,C),H):new ge(Xe(M,C),H)},ge.prototype.times=ge.prototype.multiply;function a(i,h,M){return i<l?new ge(De(h,i),M):new ge(Xe(h,mt(i)),M)}G.prototype._multiplyBySmall=function(i){return le(i.value*this.value)?new G(i.value*this.value):a(Math.abs(i.value),mt(Math.abs(this.value)),this.sign!==i.sign)},ge.prototype._multiplyBySmall=function(i){return i.value===0?se[0]:i.value===1?this:i.value===-1?this.negate():a(Math.abs(i.value),this.value,this.sign!==i.sign)},G.prototype.multiply=function(i){return q(i)._multiplyBySmall(this)},G.prototype.times=G.prototype.multiply,u.prototype.multiply=function(i){return new u(this.value*q(i).value)},u.prototype.times=u.prototype.multiply;function m(i){var h=i.length,M=ue(h+h),C=l,H,D,e,n,r;for(e=0;e<h;e++){n=i[e],D=0-n*n;for(var p=e;p<h;p++)r=i[p],H=2*(n*r)+M[e+p]+D,D=Math.floor(H/C),M[e+p]=H-D*C;M[e+h]=D}return Ke(M),M}ge.prototype.square=function(){return new ge(m(this.value),!1)},G.prototype.square=function(){var i=this.value*this.value;return le(i)?new G(i):new ge(m(mt(Math.abs(this.value))),!1)},u.prototype.square=function(i){return new u(this.value*this.value)};function v(i,h){var M=i.length,C=h.length,H=l,D=ue(h.length),e=h[C-1],n=Math.ceil(H/(2*e)),r=De(i,n),p=De(h,n),w,E,_,Y,P,Z,K;for(r.length<=M&&r.push(0),p.push(0),e=p[C-1],E=M-C;E>=0;E--){for(w=H-1,r[E+C]!==e&&(w=Math.floor((r[E+C]*H+r[E+C-1])/e)),_=0,Y=0,Z=p.length,P=0;P<Z;P++)_+=w*p[P],K=Math.floor(_/H),Y+=r[E+P]-(_-K*H),_=K,Y<0?(r[E+P]=Y+H,Y=-1):(r[E+P]=Y,Y=0);for(;Y!==0;){for(w-=1,_=0,P=0;P<Z;P++)_+=r[E+P]-H+p[P],_<0?(r[E+P]=_+H,_=0):(r[E+P]=_,_=1);Y+=_}D[E]=w}return r=I(r,n)[0],[at(D),at(r)]}function S(i,h){for(var M=i.length,C=h.length,H=[],D=[],e=l,n,r,p,w,E;M;){if(D.unshift(i[--M]),Ke(D),F(D,h)<0){H.push(0);continue}r=D.length,p=D[r-1]*e+D[r-2],w=h[C-1]*e+h[C-2],r>C&&(p=(p+1)*e),n=Math.ceil(p/w);do{if(E=De(h,n),F(E,D)<=0)break;n--}while(n);H.push(n),D=He(D,E)}return H.reverse(),[at(H),at(D)]}function I(i,h){var M=i.length,C=ue(M),H=l,D,e,n,r;for(n=0,D=M-1;D>=0;--D)r=n*H+i[D],e=Se(r/h),n=r-e*h,C[D]=e|0;return[C,n|0]}function V(i,h){var M,C=q(h);if(Ue)return[new u(i.value/C.value),new u(i.value%C.value)];var H=i.value,D=C.value,e;if(D===0)throw new Error("Cannot divide by zero");if(i.isSmall)return C.isSmall?[new G(Se(H/D)),new G(H%D)]:[se[0],i];if(C.isSmall){if(D===1)return[i,se[0]];if(D==-1)return[i.negate(),se[0]];var n=Math.abs(D);if(n<l){M=I(H,n),e=at(M[0]);var r=M[1];return i.sign&&(r=-r),typeof e=="number"?(i.sign!==C.sign&&(e=-e),[new G(e),new G(r)]):[new ge(e,i.sign!==C.sign),new G(r)]}D=mt(n)}var p=F(H,D);if(p===-1)return[se[0],i];if(p===0)return[se[i.sign===C.sign?1:-1],se[0]];H.length+D.length<=200?M=v(H,D):M=S(H,D),e=M[0];var w=i.sign!==C.sign,E=M[1],_=i.sign;return typeof e=="number"?(w&&(e=-e),e=new G(e)):e=new ge(e,w),typeof E=="number"?(_&&(E=-E),E=new G(E)):E=new ge(E,_),[e,E]}ge.prototype.divmod=function(i){var h=V(this,i);return{quotient:h[0],remainder:h[1]}},u.prototype.divmod=G.prototype.divmod=ge.prototype.divmod,ge.prototype.divide=function(i){return V(this,i)[0]},u.prototype.over=u.prototype.divide=function(i){return new u(this.value/q(i).value)},G.prototype.over=G.prototype.divide=ge.prototype.over=ge.prototype.divide,ge.prototype.mod=function(i){return V(this,i)[1]},u.prototype.mod=u.prototype.remainder=function(i){return new u(this.value%q(i).value)},G.prototype.remainder=G.prototype.mod=ge.prototype.remainder=ge.prototype.mod,ge.prototype.pow=function(i){var h=q(i),M=this.value,C=h.value,H,D,e;if(C===0)return se[1];if(M===0)return se[0];if(M===1)return se[1];if(M===-1)return h.isEven()?se[1]:se[-1];if(h.sign)return se[0];if(!h.isSmall)throw new Error("The exponent "+h.toString()+" is too large.");if(this.isSmall&&le(H=Math.pow(M,C)))return new G(Se(H));for(D=this,e=se[1];C&!0&&(e=e.times(D),--C),C!==0;)C/=2,D=D.square();return e},G.prototype.pow=ge.prototype.pow,u.prototype.pow=function(i){var h=q(i),M=this.value,C=h.value,H=BigInt(0),D=BigInt(1),e=BigInt(2);if(C===H)return se[1];if(M===H)return se[0];if(M===D)return se[1];if(M===BigInt(-1))return h.isEven()?se[1]:se[-1];if(h.isNegative())return new u(H);for(var n=this,r=se[1];(C&D)===D&&(r=r.times(n),--C),C!==H;)C/=e,n=n.square();return r},ge.prototype.modPow=function(i,h){if(i=q(i),h=q(h),h.isZero())throw new Error("Cannot take modPow with modulus 0");var M=se[1],C=this.mod(h);for(i.isNegative()&&(i=i.multiply(se[-1]),C=C.modInv(h));i.isPositive();){if(C.isZero())return se[0];i.isOdd()&&(M=M.multiply(C).mod(h)),i=i.divide(2),C=C.square().mod(h)}return M},u.prototype.modPow=G.prototype.modPow=ge.prototype.modPow;function F(i,h){if(i.length!==h.length)return i.length>h.length?1:-1;for(var M=i.length-1;M>=0;M--)if(i[M]!==h[M])return i[M]>h[M]?1:-1;return 0}ge.prototype.compareAbs=function(i){var h=q(i),M=this.value,C=h.value;return h.isSmall?1:F(M,C)},G.prototype.compareAbs=function(i){var h=q(i),M=Math.abs(this.value),C=h.value;return h.isSmall?(C=Math.abs(C),M===C?0:M>C?1:-1):-1},u.prototype.compareAbs=function(i){var h=this.value,M=q(i).value;return h=h>=0?h:-h,M=M>=0?M:-M,h===M?0:h>M?1:-1},ge.prototype.compare=function(i){if(i===1/0)return-1;if(i===-1/0)return 1;var h=q(i),M=this.value,C=h.value;return this.sign!==h.sign?h.sign?1:-1:h.isSmall?this.sign?-1:1:F(M,C)*(this.sign?-1:1)},ge.prototype.compareTo=ge.prototype.compare,G.prototype.compare=function(i){if(i===1/0)return-1;if(i===-1/0)return 1;var h=q(i),M=this.value,C=h.value;return h.isSmall?M==C?0:M>C?1:-1:M<0!==h.sign?M<0?-1:1:M<0?1:-1},G.prototype.compareTo=G.prototype.compare,u.prototype.compare=function(i){if(i===1/0)return-1;if(i===-1/0)return 1;var h=this.value,M=q(i).value;return h===M?0:h>M?1:-1},u.prototype.compareTo=u.prototype.compare,ge.prototype.equals=function(i){return this.compare(i)===0},u.prototype.eq=u.prototype.equals=G.prototype.eq=G.prototype.equals=ge.prototype.eq=ge.prototype.equals,ge.prototype.notEquals=function(i){return this.compare(i)!==0},u.prototype.neq=u.prototype.notEquals=G.prototype.neq=G.prototype.notEquals=ge.prototype.neq=ge.prototype.notEquals,ge.prototype.greater=function(i){return this.compare(i)>0},u.prototype.gt=u.prototype.greater=G.prototype.gt=G.prototype.greater=ge.prototype.gt=ge.prototype.greater,ge.prototype.lesser=function(i){return this.compare(i)<0},u.prototype.lt=u.prototype.lesser=G.prototype.lt=G.prototype.lesser=ge.prototype.lt=ge.prototype.lesser,ge.prototype.greaterOrEquals=function(i){return this.compare(i)>=0},u.prototype.geq=u.prototype.greaterOrEquals=G.prototype.geq=G.prototype.greaterOrEquals=ge.prototype.geq=ge.prototype.greaterOrEquals,ge.prototype.lesserOrEquals=function(i){return this.compare(i)<=0},u.prototype.leq=u.prototype.lesserOrEquals=G.prototype.leq=G.prototype.lesserOrEquals=ge.prototype.leq=ge.prototype.lesserOrEquals,ge.prototype.isEven=function(){return(this.value[0]&1)===0},G.prototype.isEven=function(){return(this.value&1)===0},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},ge.prototype.isOdd=function(){return(this.value[0]&1)===1},G.prototype.isOdd=function(){return(this.value&1)===1},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},ge.prototype.isPositive=function(){return!this.sign},G.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=G.prototype.isPositive,ge.prototype.isNegative=function(){return this.sign},G.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=G.prototype.isNegative,ge.prototype.isUnit=function(){return!1},G.prototype.isUnit=function(){return Math.abs(this.value)===1},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},ge.prototype.isZero=function(){return!1},G.prototype.isZero=function(){return this.value===0},u.prototype.isZero=function(){return this.value===BigInt(0)},ge.prototype.isDivisibleBy=function(i){var h=q(i);return h.isZero()?!1:h.isUnit()?!0:h.compareAbs(2)===0?this.isEven():this.mod(h).isZero()},u.prototype.isDivisibleBy=G.prototype.isDivisibleBy=ge.prototype.isDivisibleBy;function L(i){var h=i.abs();if(h.isUnit())return!1;if(h.equals(2)||h.equals(3)||h.equals(5))return!0;if(h.isEven()||h.isDivisibleBy(3)||h.isDivisibleBy(5))return!1;if(h.lesser(49))return!0}function B(i,h){for(var M=i.prev(),C=M,H=0,D,e,n,r;C.isEven();)C=C.divide(2),H++;e:for(n=0;n<h.length;n++)if(!i.lesser(h[n])&&(r=Gt(h[n]).modPow(C,i),!(r.isUnit()||r.equals(M)))){for(D=H-1;D!=0;D--){if(r=r.square().mod(i),r.isUnit())return!1;if(r.equals(M))continue e}return!1}return!0}ge.prototype.isPrime=function(i){var h=L(this);if(h!==O)return h;var M=this.abs(),C=M.bitLength();if(C<=64)return B(M,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var H=Math.log(2)*C.toJSNumber(),D=Math.ceil(i===!0?2*Math.pow(H,2):H),e=[],n=0;n<D;n++)e.push(Gt(n+2));return B(M,e)},u.prototype.isPrime=G.prototype.isPrime=ge.prototype.isPrime,ge.prototype.isProbablePrime=function(i,h){var M=L(this);if(M!==O)return M;for(var C=this.abs(),H=i===O?5:i,D=[],e=0;e<H;e++)D.push(Gt.randBetween(2,C.minus(2),h));return B(C,D)},u.prototype.isProbablePrime=G.prototype.isProbablePrime=ge.prototype.isProbablePrime,ge.prototype.modInv=function(i){for(var h=Gt.zero,M=Gt.one,C=q(i),H=this.abs(),D,e,n;!H.isZero();)D=C.divide(H),e=h,n=C,h=M,C=H,M=e.subtract(D.multiply(M)),H=n.subtract(D.multiply(H));if(!C.isUnit())throw new Error(this.toString()+" and "+i.toString()+" are not co-prime");return h.compare(0)===-1&&(h=h.add(i)),this.isNegative()?h.negate():h},u.prototype.modInv=G.prototype.modInv=ge.prototype.modInv,ge.prototype.next=function(){var i=this.value;return this.sign?qe(i,1,this.sign):new ge($e(i,1),this.sign)},G.prototype.next=function(){var i=this.value;return i+1<ee?new G(i+1):new ge(de,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},ge.prototype.prev=function(){var i=this.value;return this.sign?new ge($e(i,1),!0):qe(i,1,this.sign)},G.prototype.prev=function(){var i=this.value;return i-1>-ee?new G(i-1):new ge(de,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var Q=[1];2*Q[Q.length-1]<=l;)Q.push(2*Q[Q.length-1]);var ce=Q.length,pe=Q[ce-1];function Ce(i){return Math.abs(i)<=l}ge.prototype.shiftLeft=function(i){var h=q(i).toJSNumber();if(!Ce(h))throw new Error(String(h)+" is too large for shifting.");if(h<0)return this.shiftRight(-h);var M=this;if(M.isZero())return M;for(;h>=ce;)M=M.multiply(pe),h-=ce-1;return M.multiply(Q[h])},u.prototype.shiftLeft=G.prototype.shiftLeft=ge.prototype.shiftLeft,ge.prototype.shiftRight=function(i){var h,M=q(i).toJSNumber();if(!Ce(M))throw new Error(String(M)+" is too large for shifting.");if(M<0)return this.shiftLeft(-M);for(var C=this;M>=ce;){if(C.isZero()||C.isNegative()&&C.isUnit())return C;h=V(C,pe),C=h[1].isNegative()?h[0].prev():h[0],M-=ce-1}return h=V(C,Q[M]),h[1].isNegative()?h[0].prev():h[0]},u.prototype.shiftRight=G.prototype.shiftRight=ge.prototype.shiftRight;function ae(i,h,M){h=q(h);for(var C=i.isNegative(),H=h.isNegative(),D=C?i.not():i,e=H?h.not():h,n=0,r=0,p=null,w=null,E=[];!D.isZero()||!e.isZero();)p=V(D,pe),n=p[1].toJSNumber(),C&&(n=pe-1-n),w=V(e,pe),r=w[1].toJSNumber(),H&&(r=pe-1-r),D=p[0],e=w[0],E.push(M(n,r));for(var _=M(C?1:0,H?1:0)!==0?Gt(-1):Gt(0),Y=E.length-1;Y>=0;Y-=1)_=_.multiply(pe).add(Gt(E[Y]));return _}ge.prototype.not=function(){return this.negate().prev()},u.prototype.not=G.prototype.not=ge.prototype.not,ge.prototype.and=function(i){return ae(this,i,function(h,M){return h&M})},u.prototype.and=G.prototype.and=ge.prototype.and,ge.prototype.or=function(i){return ae(this,i,function(h,M){return h|M})},u.prototype.or=G.prototype.or=ge.prototype.or,ge.prototype.xor=function(i){return ae(this,i,function(h,M){return h^M})},u.prototype.xor=G.prototype.xor=ge.prototype.xor;var Re=1<<30,et=(l&-l)*(l&-l)|Re;function _e(i){var h=i.value,M=typeof h=="number"?h|Re:typeof h=="bigint"?h|BigInt(Re):h[0]+h[1]*l|et;return M&-M}function Ve(i,h){if(h.compareTo(i)<=0){var M=Ve(i,h.square(h)),C=M.p,H=M.e,D=C.multiply(h);return D.compareTo(i)<=0?{p:D,e:H*2+1}:{p:C,e:H*2}}return{p:Gt(1),e:0}}ge.prototype.bitLength=function(){var i=this;return i.compareTo(Gt(0))<0&&(i=i.negate().subtract(Gt(1))),i.compareTo(Gt(0))===0?Gt(0):Gt(Ve(i,Gt(2)).e).add(Gt(1))},u.prototype.bitLength=G.prototype.bitLength=ge.prototype.bitLength;function je(i,h){return i=q(i),h=q(h),i.greater(h)?i:h}function st(i,h){return i=q(i),h=q(h),i.lesser(h)?i:h}function Ge(i,h){if(i=q(i).abs(),h=q(h).abs(),i.equals(h))return i;if(i.isZero())return h;if(h.isZero())return i;for(var M=se[1],C,H;i.isEven()&&h.isEven();)C=st(_e(i),_e(h)),i=i.divide(C),h=h.divide(C),M=M.multiply(C);for(;i.isEven();)i=i.divide(_e(i));do{for(;h.isEven();)h=h.divide(_e(h));i.greater(h)&&(H=h,h=i,i=H),h=h.subtract(i)}while(!h.isZero());return M.isUnit()?i:i.multiply(M)}function nt(i,h){return i=q(i).abs(),h=q(h).abs(),i.divide(Ge(i,h)).multiply(h)}function ot(i,h,M){i=q(i),h=q(h);var C=M||Math.random,H=st(i,h),D=je(i,h),e=D.subtract(H).add(1);if(e.isSmall)return H.add(Math.floor(C()*e));for(var n=j(e,l).value,r=[],p=!0,w=0;w<n.length;w++){var E=p?n[w]+(w+1<n.length?n[w+1]/l:0):l,_=Se(C()*E);r.push(_),_<n[w]&&(p=!1)}return H.add(se.fromArray(r,l,!1))}var Le=function(i,h,M,C){M=M||xe,i=String(i),C||(i=i.toLowerCase(),M=M.toLowerCase());var H=i.length,D,e=Math.abs(h),n={};for(D=0;D<M.length;D++)n[M[D]]=D;for(D=0;D<H;D++){var r=i[D];if(r!=="-"&&r in n&&n[r]>=e){if(r==="1"&&e===1)continue;throw new Error(r+" is not a valid digit in base "+h+".")}}h=q(h);var p=[],w=i[0]==="-";for(D=w?1:0;D<i.length;D++){var r=i[D];if(r in n)p.push(q(n[r]));else if(r==="<"){var E=D;do D++;while(i[D]!==">"&&D<i.length);p.push(q(i.slice(E+1,D)))}else throw new Error(r+" is not a valid character")}return b(p,h,w)};function b(i,h,M){var C=se[0],H=se[1],D;for(D=i.length-1;D>=0;D--)C=C.add(i[D].times(H)),H=H.times(h);return M?C.negate():C}function X(i,h){return h=h||xe,i<h.length?h[i]:"<"+i+">"}function j(i,h){if(h=Gt(h),h.isZero()){if(i.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(h.equals(-1)){if(i.isZero())return{value:[0],isNegative:!1};if(i.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-i.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var M=Array.apply(null,Array(i.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return M.unshift([1]),{value:[].concat.apply([],M),isNegative:!1}}var C=!1;if(i.isNegative()&&h.isPositive()&&(C=!0,i=i.abs()),h.isUnit())return i.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(i.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:C};for(var H=[],D=i,e;D.isNegative()||D.compareAbs(h)>=0;){e=D.divmod(h),D=e.quotient;var n=e.remainder;n.isNegative()&&(n=h.minus(n).abs(),D=D.next()),H.push(n.toJSNumber())}return H.push(D.toJSNumber()),{value:H.reverse(),isNegative:C}}function x(i,h,M){var C=j(i,h);return(C.isNegative?"-":"")+C.value.map(function(H){return X(H,M)}).join("")}ge.prototype.toArray=function(i){return j(this,i)},G.prototype.toArray=function(i){return j(this,i)},u.prototype.toArray=function(i){return j(this,i)},ge.prototype.toString=function(i,h){if(i===O&&(i=10),i!==10||h)return x(this,i,h);for(var M=this.value,C=M.length,H=String(M[--C]),D="0000000",e;--C>=0;)e=String(M[C]),H+=D.slice(e.length)+e;var n=this.sign?"-":"";return n+H},G.prototype.toString=function(i,h){return i===O&&(i=10),i!=10||h?x(this,i,h):String(this.value)},u.prototype.toString=G.prototype.toString,u.prototype.toJSON=ge.prototype.toJSON=G.prototype.toJSON=function(){return this.toString()},ge.prototype.valueOf=function(){return parseInt(this.toString(),10)},ge.prototype.toJSNumber=ge.prototype.valueOf,G.prototype.valueOf=function(){return this.value},G.prototype.toJSNumber=G.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function z(i){if(le(+i)){var h=+i;if(h===Se(h))return Ue?new u(BigInt(h)):new G(h);throw new Error("Invalid integer: "+i)}var M=i[0]==="-";M&&(i=i.slice(1));var C=i.split(/e/i);if(C.length>2)throw new Error("Invalid integer: "+C.join("e"));if(C.length===2){var H=C[1];if(H[0]==="+"&&(H=H.slice(1)),H=+H,H!==Se(H)||!le(H))throw new Error("Invalid integer: "+H+" is not a valid exponent.");var D=C[0],e=D.indexOf(".");if(e>=0&&(H-=D.length-e-1,D=D.slice(0,e)+D.slice(e+1)),H<0)throw new Error("Cannot include negative exponent part for integers");D+=new Array(H+1).join("0"),i=D}var n=/^([0-9][0-9]*)$/.test(i);if(!n)throw new Error("Invalid integer: "+i);if(Ue)return new u(BigInt(M?"-"+i:i));for(var r=[],p=i.length,w=t,E=p-w;p>0;)r.push(+i.slice(E,p)),E-=w,E<0&&(E=0),p-=w;return Ke(r),new ge(r,M)}function U(i){if(Ue)return new u(BigInt(i));if(le(i)){if(i!==Se(i))throw new Error(i+" is not an integer.");return new G(i)}return z(i.toString())}function q(i){return typeof i=="number"?U(i):typeof i=="string"?z(i):typeof i=="bigint"?new u(i):i}for(var fe=0;fe<1e3;fe++)se[fe]=q(fe),fe>0&&(se[-fe]=q(-fe));return se.one=se[1],se.zero=se[0],se.minusOne=se[-1],se.max=je,se.min=st,se.gcd=Ge,se.lcm=nt,se.isInstance=function(i){return i instanceof ge||i instanceof G||i instanceof u},se.randBetween=ot,se.fromArray=function(i,h,M){return b(i.map(q),q(h||10),M)},se})();typeof Z0<"u"&&Z0.hasOwnProperty("exports")&&(Z0.exports=Gt);typeof define=="function"&&define.amd&&define(function(){return Gt})});var _1=u0((q1,z0)=>{(function(O){"use strict";var l=9e15,t=1e9,ee="0123456789abcdef",de="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",xe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Ue={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-l,maxE:l,crypto:!1},se,ge,G,u,le=!0,mt="[DecimalError] ",at=mt+"Invalid argument: ",Ke=mt+"Precision limit exceeded",ue=mt+"crypto unavailable",Se="[object Decimal]",Ie=Math.floor,te=Math.pow,$e=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,He=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Be=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,qe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Xe=1e7,De=7,J=9007199254740991,c=de.length-1,d=xe.length-1,a={toStringTag:Se};a.absoluteValue=a.abs=function(){var g=new this.constructor(this);return g.s<0&&(g.s=1),L(g)},a.ceil=function(){return L(new this.constructor(this),this.e+1,2)},a.clampedTo=a.clamp=function(g,y){var N,A=this,T=A.constructor;if(g=new T(g),y=new T(y),!g.s||!y.s)return new T(NaN);if(g.gt(y))throw Error(at+y);return N=A.cmp(g),N<0?g:A.cmp(y)>0?y:new T(A)},a.comparedTo=a.cmp=function(g){var y,N,A,T,R=this,W=R.d,re=(g=new R.constructor(g)).d,me=R.s,oe=g.s;if(!W||!re)return!me||!oe?NaN:me!==oe?me:W===re?0:!W^me<0?1:-1;if(!W[0]||!re[0])return W[0]?me:re[0]?-oe:0;if(me!==oe)return me;if(R.e!==g.e)return R.e>g.e^me<0?1:-1;for(A=W.length,T=re.length,y=0,N=A<T?A:T;y<N;++y)if(W[y]!==re[y])return W[y]>re[y]^me<0?1:-1;return A===T?0:A>T^me<0?1:-1},a.cosine=a.cos=function(){var g,y,N=this,A=N.constructor;return N.d?N.d[0]?(g=A.precision,y=A.rounding,A.precision=g+Math.max(N.e,N.sd())+De,A.rounding=1,N=V(A,X(A,N)),A.precision=g,A.rounding=y,L(u==2||u==3?N.neg():N,g,y,!0)):new A(1):new A(NaN)},a.cubeRoot=a.cbrt=function(){var g,y,N,A,T,R,W,re,me,oe,Ae=this,Te=Ae.constructor;if(!Ae.isFinite()||Ae.isZero())return new Te(Ae);for(le=!1,R=Ae.s*te(Ae.s*Ae,1/3),!R||Math.abs(R)==1/0?(N=m(Ae.d),g=Ae.e,(R=(g-N.length+1)%3)&&(N+=R==1||R==-2?"0":"00"),R=te(N,1/3),g=Ie((g+1)/3)-(g%3==(g<0?-1:2)),R==1/0?N="5e"+g:(N=R.toExponential(),N=N.slice(0,N.indexOf("e")+1)+g),A=new Te(N),A.s=Ae.s):A=new Te(R.toString()),W=(g=Te.precision)+3;;)if(re=A,me=re.times(re).times(re),oe=me.plus(Ae),A=F(oe.plus(Ae).times(re),oe.plus(me),W+2,1),m(re.d).slice(0,W)===(N=m(A.d)).slice(0,W))if(N=N.slice(W-3,W+1),N=="9999"||!T&&N=="4999"){if(!T&&(L(re,g+1,0),re.times(re).times(re).eq(Ae))){A=re;break}W+=4,T=1}else{(!+N||!+N.slice(1)&&N.charAt(0)=="5")&&(L(A,g+1,1),y=!A.times(A).times(A).eq(Ae));break}return le=!0,L(A,g,Te.rounding,y)},a.decimalPlaces=a.dp=function(){var g,y=this.d,N=NaN;if(y){if(g=y.length-1,N=(g-Ie(this.e/De))*De,g=y[g],g)for(;g%10==0;g/=10)N--;N<0&&(N=0)}return N},a.dividedBy=a.div=function(g){return F(this,new this.constructor(g))},a.dividedToIntegerBy=a.divToInt=function(g){var y=this,N=y.constructor;return L(F(y,new N(g),0,1,1),N.precision,N.rounding)},a.equals=a.eq=function(g){return this.cmp(g)===0},a.floor=function(){return L(new this.constructor(this),this.e+1,3)},a.greaterThan=a.gt=function(g){return this.cmp(g)>0},a.greaterThanOrEqualTo=a.gte=function(g){var y=this.cmp(g);return y==1||y===0},a.hyperbolicCosine=a.cosh=function(){var g,y,N,A,T,R=this,W=R.constructor,re=new W(1);if(!R.isFinite())return new W(R.s?1/0:NaN);if(R.isZero())return re;N=W.precision,A=W.rounding,W.precision=N+Math.max(R.e,R.sd())+4,W.rounding=1,T=R.d.length,T<32?(g=Math.ceil(T/3),y=(1/b(4,g)).toString()):(g=16,y="2.3283064365386962890625e-10"),R=Le(W,1,R.times(y),new W(1),!0);for(var me,oe=g,Ae=new W(8);oe--;)me=R.times(R),R=re.minus(me.times(Ae.minus(me.times(Ae))));return L(R,W.precision=N,W.rounding=A,!0)},a.hyperbolicSine=a.sinh=function(){var g,y,N,A,T=this,R=T.constructor;if(!T.isFinite()||T.isZero())return new R(T);if(y=R.precision,N=R.rounding,R.precision=y+Math.max(T.e,T.sd())+4,R.rounding=1,A=T.d.length,A<3)T=Le(R,2,T,T,!0);else{g=1.4*Math.sqrt(A),g=g>16?16:g|0,T=T.times(1/b(5,g)),T=Le(R,2,T,T,!0);for(var W,re=new R(5),me=new R(16),oe=new R(20);g--;)W=T.times(T),T=T.times(re.plus(W.times(me.times(W).plus(oe))))}return R.precision=y,R.rounding=N,L(T,y,N,!0)},a.hyperbolicTangent=a.tanh=function(){var g,y,N=this,A=N.constructor;return N.isFinite()?N.isZero()?new A(N):(g=A.precision,y=A.rounding,A.precision=g+7,A.rounding=1,F(N.sinh(),N.cosh(),A.precision=g,A.rounding=y)):new A(N.s)},a.inverseCosine=a.acos=function(){var g=this,y=g.constructor,N=g.abs().cmp(1),A=y.precision,T=y.rounding;return N!==-1?N===0?g.isNeg()?pe(y,A,T):new y(0):new y(NaN):g.isZero()?pe(y,A+4,T).times(.5):(y.precision=A+6,y.rounding=1,g=new y(1).minus(g).div(g.plus(1)).sqrt().atan(),y.precision=A,y.rounding=T,g.times(2))},a.inverseHyperbolicCosine=a.acosh=function(){var g,y,N=this,A=N.constructor;return N.lte(1)?new A(N.eq(1)?0:NaN):N.isFinite()?(g=A.precision,y=A.rounding,A.precision=g+Math.max(Math.abs(N.e),N.sd())+4,A.rounding=1,le=!1,N=N.times(N).minus(1).sqrt().plus(N),le=!0,A.precision=g,A.rounding=y,N.ln()):new A(N)},a.inverseHyperbolicSine=a.asinh=function(){var g,y,N=this,A=N.constructor;return!N.isFinite()||N.isZero()?new A(N):(g=A.precision,y=A.rounding,A.precision=g+2*Math.max(Math.abs(N.e),N.sd())+6,A.rounding=1,le=!1,N=N.times(N).plus(1).sqrt().plus(N),le=!0,A.precision=g,A.rounding=y,N.ln())},a.inverseHyperbolicTangent=a.atanh=function(){var g,y,N,A,T=this,R=T.constructor;return T.isFinite()?T.e>=0?new R(T.abs().eq(1)?T.s/0:T.isZero()?T:NaN):(g=R.precision,y=R.rounding,A=T.sd(),Math.max(A,g)<2*-T.e-1?L(new R(T),g,y,!0):(R.precision=N=A-T.e,T=F(T.plus(1),new R(1).minus(T),N+g,1),R.precision=g+4,R.rounding=1,T=T.ln(),R.precision=g,R.rounding=y,T.times(.5))):new R(NaN)},a.inverseSine=a.asin=function(){var g,y,N,A,T=this,R=T.constructor;return T.isZero()?new R(T):(y=T.abs().cmp(1),N=R.precision,A=R.rounding,y!==-1?y===0?(g=pe(R,N+4,A).times(.5),g.s=T.s,g):new R(NaN):(R.precision=N+6,R.rounding=1,T=T.div(new R(1).minus(T.times(T)).sqrt().plus(1)).atan(),R.precision=N,R.rounding=A,T.times(2)))},a.inverseTangent=a.atan=function(){var g,y,N,A,T,R,W,re,me,oe=this,Ae=oe.constructor,Te=Ae.precision,Pe=Ae.rounding;if(oe.isFinite()){if(oe.isZero())return new Ae(oe);if(oe.abs().eq(1)&&Te+4<=d)return W=pe(Ae,Te+4,Pe).times(.25),W.s=oe.s,W}else{if(!oe.s)return new Ae(NaN);if(Te+4<=d)return W=pe(Ae,Te+4,Pe).times(.5),W.s=oe.s,W}for(Ae.precision=re=Te+10,Ae.rounding=1,N=Math.min(28,re/De+2|0),g=N;g;--g)oe=oe.div(oe.times(oe).plus(1).sqrt().plus(1));for(le=!1,y=Math.ceil(re/De),A=1,me=oe.times(oe),W=new Ae(oe),T=oe;g!==-1;)if(T=T.times(me),R=W.minus(T.div(A+=2)),T=T.times(me),W=R.plus(T.div(A+=2)),W.d[y]!==void 0)for(g=y;W.d[g]===R.d[g]&&g--;);return N&&(W=W.times(2<<N-1)),le=!0,L(W,Ae.precision=Te,Ae.rounding=Pe,!0)},a.isFinite=function(){return!!this.d},a.isInteger=a.isInt=function(){return!!this.d&&Ie(this.e/De)>this.d.length-2},a.isNaN=function(){return!this.s},a.isNegative=a.isNeg=function(){return this.s<0},a.isPositive=a.isPos=function(){return this.s>0},a.isZero=function(){return!!this.d&&this.d[0]===0},a.lessThan=a.lt=function(g){return this.cmp(g)<0},a.lessThanOrEqualTo=a.lte=function(g){return this.cmp(g)<1},a.logarithm=a.log=function(g){var y,N,A,T,R,W,re,me,oe=this,Ae=oe.constructor,Te=Ae.precision,Pe=Ae.rounding,lt=5;if(g==null)g=new Ae(10),y=!0;else{if(g=new Ae(g),N=g.d,g.s<0||!N||!N[0]||g.eq(1))return new Ae(NaN);y=g.eq(10)}if(N=oe.d,oe.s<0||!N||!N[0]||oe.eq(1))return new Ae(N&&!N[0]?-1/0:oe.s!=1?NaN:N?0:1/0);if(y)if(N.length>1)R=!0;else{for(T=N[0];T%10===0;)T/=10;R=T!==1}if(le=!1,re=Te+lt,W=je(oe,re),A=y?ce(Ae,re+10):je(g,re),me=F(W,A,re,1),S(me.d,T=Te,Pe))do if(re+=10,W=je(oe,re),A=y?ce(Ae,re+10):je(g,re),me=F(W,A,re,1),!R){+m(me.d).slice(T+1,T+15)+1==1e14&&(me=L(me,Te+1,0));break}while(S(me.d,T+=10,Pe));return le=!0,L(me,Te,Pe)},a.minus=a.sub=function(g){var y,N,A,T,R,W,re,me,oe,Ae,Te,Pe,lt=this,yt=lt.constructor;if(g=new yt(g),!lt.d||!g.d)return!lt.s||!g.s?g=new yt(NaN):lt.d?g.s=-g.s:g=new yt(g.d||lt.s!==g.s?lt:NaN),g;if(lt.s!=g.s)return g.s=-g.s,lt.plus(g);if(oe=lt.d,Pe=g.d,re=yt.precision,me=yt.rounding,!oe[0]||!Pe[0]){if(Pe[0])g.s=-g.s;else if(oe[0])g=new yt(lt);else return new yt(me===3?-0:0);return le?L(g,re,me):g}if(N=Ie(g.e/De),Ae=Ie(lt.e/De),oe=oe.slice(),R=Ae-N,R){for(Te=R<0,Te?(y=oe,R=-R,W=Pe.length):(y=Pe,N=Ae,W=oe.length),A=Math.max(Math.ceil(re/De),W)+2,R>A&&(R=A,y.length=1),y.reverse(),A=R;A--;)y.push(0);y.reverse()}else{for(A=oe.length,W=Pe.length,Te=A<W,Te&&(W=A),A=0;A<W;A++)if(oe[A]!=Pe[A]){Te=oe[A]<Pe[A];break}R=0}for(Te&&(y=oe,oe=Pe,Pe=y,g.s=-g.s),W=oe.length,A=Pe.length-W;A>0;--A)oe[W++]=0;for(A=Pe.length;A>R;){if(oe[--A]<Pe[A]){for(T=A;T&&oe[--T]===0;)oe[T]=Xe-1;--oe[T],oe[A]+=Xe}oe[A]-=Pe[A]}for(;oe[--W]===0;)oe.pop();for(;oe[0]===0;oe.shift())--N;return oe[0]?(g.d=oe,g.e=Q(oe,N),le?L(g,re,me):g):new yt(me===3?-0:0)},a.modulo=a.mod=function(g){var y,N=this,A=N.constructor;return g=new A(g),!N.d||!g.s||g.d&&!g.d[0]?new A(NaN):!g.d||N.d&&!N.d[0]?L(new A(N),A.precision,A.rounding):(le=!1,A.modulo==9?(y=F(N,g.abs(),0,3,1),y.s*=g.s):y=F(N,g,0,A.modulo,1),y=y.times(g),le=!0,N.minus(y))},a.naturalExponential=a.exp=function(){return Ve(this)},a.naturalLogarithm=a.ln=function(){return je(this)},a.negated=a.neg=function(){var g=new this.constructor(this);return g.s=-g.s,L(g)},a.plus=a.add=function(g){var y,N,A,T,R,W,re,me,oe,Ae,Te=this,Pe=Te.constructor;if(g=new Pe(g),!Te.d||!g.d)return!Te.s||!g.s?g=new Pe(NaN):Te.d||(g=new Pe(g.d||Te.s===g.s?Te:NaN)),g;if(Te.s!=g.s)return g.s=-g.s,Te.minus(g);if(oe=Te.d,Ae=g.d,re=Pe.precision,me=Pe.rounding,!oe[0]||!Ae[0])return Ae[0]||(g=new Pe(Te)),le?L(g,re,me):g;if(R=Ie(Te.e/De),A=Ie(g.e/De),oe=oe.slice(),T=R-A,T){for(T<0?(N=oe,T=-T,W=Ae.length):(N=Ae,A=R,W=oe.length),R=Math.ceil(re/De),W=R>W?R+1:W+1,T>W&&(T=W,N.length=1),N.reverse();T--;)N.push(0);N.reverse()}for(W=oe.length,T=Ae.length,W-T<0&&(T=W,N=Ae,Ae=oe,oe=N),y=0;T;)y=(oe[--T]=oe[T]+Ae[T]+y)/Xe|0,oe[T]%=Xe;for(y&&(oe.unshift(y),++A),W=oe.length;oe[--W]==0;)oe.pop();return g.d=oe,g.e=Q(oe,A),le?L(g,re,me):g},a.precision=a.sd=function(g){var y,N=this;if(g!==void 0&&g!==!!g&&g!==1&&g!==0)throw Error(at+g);return N.d?(y=Ce(N.d),g&&N.e+1>y&&(y=N.e+1)):y=NaN,y},a.round=function(){var g=this,y=g.constructor;return L(new y(g),g.e+1,y.rounding)},a.sine=a.sin=function(){var g,y,N=this,A=N.constructor;return N.isFinite()?N.isZero()?new A(N):(g=A.precision,y=A.rounding,A.precision=g+Math.max(N.e,N.sd())+De,A.rounding=1,N=ot(A,X(A,N)),A.precision=g,A.rounding=y,L(u>2?N.neg():N,g,y,!0)):new A(NaN)},a.squareRoot=a.sqrt=function(){var g,y,N,A,T,R,W=this,re=W.d,me=W.e,oe=W.s,Ae=W.constructor;if(oe!==1||!re||!re[0])return new Ae(!oe||oe<0&&(!re||re[0])?NaN:re?W:1/0);for(le=!1,oe=Math.sqrt(+W),oe==0||oe==1/0?(y=m(re),(y.length+me)%2==0&&(y+="0"),oe=Math.sqrt(y),me=Ie((me+1)/2)-(me<0||me%2),oe==1/0?y="5e"+me:(y=oe.toExponential(),y=y.slice(0,y.indexOf("e")+1)+me),A=new Ae(y)):A=new Ae(oe.toString()),N=(me=Ae.precision)+3;;)if(R=A,A=R.plus(F(W,R,N+2,1)).times(.5),m(R.d).slice(0,N)===(y=m(A.d)).slice(0,N))if(y=y.slice(N-3,N+1),y=="9999"||!T&&y=="4999"){if(!T&&(L(R,me+1,0),R.times(R).eq(W))){A=R;break}N+=4,T=1}else{(!+y||!+y.slice(1)&&y.charAt(0)=="5")&&(L(A,me+1,1),g=!A.times(A).eq(W));break}return le=!0,L(A,me,Ae.rounding,g)},a.tangent=a.tan=function(){var g,y,N=this,A=N.constructor;return N.isFinite()?N.isZero()?new A(N):(g=A.precision,y=A.rounding,A.precision=g+10,A.rounding=1,N=N.sin(),N.s=1,N=F(N,new A(1).minus(N.times(N)).sqrt(),g+10,0),A.precision=g,A.rounding=y,L(u==2||u==4?N.neg():N,g,y,!0)):new A(NaN)},a.times=a.mul=function(g){var y,N,A,T,R,W,re,me,oe,Ae=this,Te=Ae.constructor,Pe=Ae.d,lt=(g=new Te(g)).d;if(g.s*=Ae.s,!Pe||!Pe[0]||!lt||!lt[0])return new Te(!g.s||Pe&&!Pe[0]&&!lt||lt&&!lt[0]&&!Pe?NaN:!Pe||!lt?g.s/0:g.s*0);for(N=Ie(Ae.e/De)+Ie(g.e/De),me=Pe.length,oe=lt.length,me<oe&&(R=Pe,Pe=lt,lt=R,W=me,me=oe,oe=W),R=[],W=me+oe,A=W;A--;)R.push(0);for(A=oe;--A>=0;){for(y=0,T=me+A;T>A;)re=R[T]+lt[A]*Pe[T-A-1]+y,R[T--]=re%Xe|0,y=re/Xe|0;R[T]=(R[T]+y)%Xe|0}for(;!R[--W];)R.pop();return y?++N:R.shift(),g.d=R,g.e=Q(R,N),le?L(g,Te.precision,Te.rounding):g},a.toBinary=function(g,y){return j(this,2,g,y)},a.toDecimalPlaces=a.toDP=function(g,y){var N=this,A=N.constructor;return N=new A(N),g===void 0?N:(v(g,0,t),y===void 0?y=A.rounding:v(y,0,8),L(N,g+N.e+1,y))},a.toExponential=function(g,y){var N,A=this,T=A.constructor;return g===void 0?N=B(A,!0):(v(g,0,t),y===void 0?y=T.rounding:v(y,0,8),A=L(new T(A),g+1,y),N=B(A,!0,g+1)),A.isNeg()&&!A.isZero()?"-"+N:N},a.toFixed=function(g,y){var N,A,T=this,R=T.constructor;return g===void 0?N=B(T):(v(g,0,t),y===void 0?y=R.rounding:v(y,0,8),A=L(new R(T),g+T.e+1,y),N=B(A,!1,g+A.e+1)),T.isNeg()&&!T.isZero()?"-"+N:N},a.toFraction=function(g){var y,N,A,T,R,W,re,me,oe,Ae,Te,Pe,lt=this,yt=lt.d,pt=lt.constructor;if(!yt)return new pt(lt);if(oe=N=new pt(1),A=me=new pt(0),y=new pt(A),R=y.e=Ce(yt)-lt.e-1,W=R%De,y.d[0]=te(10,W<0?De+W:W),g==null)g=R>0?y:oe;else{if(re=new pt(g),!re.isInt()||re.lt(oe))throw Error(at+re);g=re.gt(y)?R>0?y:oe:re}for(le=!1,re=new pt(m(yt)),Ae=pt.precision,pt.precision=R=yt.length*De*2;Te=F(re,y,0,1,1),T=N.plus(Te.times(A)),T.cmp(g)!=1;)N=A,A=T,T=oe,oe=me.plus(Te.times(T)),me=T,T=y,y=re.minus(Te.times(T)),re=T;return T=F(g.minus(N),A,0,1,1),me=me.plus(T.times(oe)),N=N.plus(T.times(A)),me.s=oe.s=lt.s,Pe=F(oe,A,R,1).minus(lt).abs().cmp(F(me,N,R,1).minus(lt).abs())<1?[oe,A]:[me,N],pt.precision=Ae,le=!0,Pe},a.toHexadecimal=a.toHex=function(g,y){return j(this,16,g,y)},a.toNearest=function(g,y){var N=this,A=N.constructor;if(N=new A(N),g==null){if(!N.d)return N;g=new A(1),y=A.rounding}else{if(g=new A(g),y===void 0?y=A.rounding:v(y,0,8),!N.d)return g.s?N:g;if(!g.d)return g.s&&(g.s=N.s),g}return g.d[0]?(le=!1,N=F(N,g,0,y,1).times(g),le=!0,L(N)):(g.s=N.s,N=g),N},a.toNumber=function(){return+this},a.toOctal=function(g,y){return j(this,8,g,y)},a.toPower=a.pow=function(g){var y,N,A,T,R,W,re=this,me=re.constructor,oe=+(g=new me(g));if(!re.d||!g.d||!re.d[0]||!g.d[0])return new me(te(+re,oe));if(re=new me(re),re.eq(1))return re;if(A=me.precision,R=me.rounding,g.eq(1))return L(re,A,R);if(y=Ie(g.e/De),y>=g.d.length-1&&(N=oe<0?-oe:oe)<=J)return T=Re(me,re,N,A),g.s<0?new me(1).div(T):L(T,A,R);if(W=re.s,W<0){if(y<g.d.length-1)return new me(NaN);if((g.d[y]&1)==0&&(W=1),re.e==0&&re.d[0]==1&&re.d.length==1)return re.s=W,re}return N=te(+re,oe),y=N==0||!isFinite(N)?Ie(oe*(Math.log("0."+m(re.d))/Math.LN10+re.e+1)):new me(N+"").e,y>me.maxE+1||y<me.minE-1?new me(y>0?W/0:0):(le=!1,me.rounding=re.s=1,N=Math.min(12,(y+"").length),T=Ve(g.times(je(re,A+N)),A),T.d&&(T=L(T,A+5,1),S(T.d,A,R)&&(y=A+10,T=L(Ve(g.times(je(re,y+N)),y),y+5,1),+m(T.d).slice(A+1,A+15)+1==1e14&&(T=L(T,A+1,0)))),T.s=W,le=!0,me.rounding=R,L(T,A,R))},a.toPrecision=function(g,y){var N,A=this,T=A.constructor;return g===void 0?N=B(A,A.e<=T.toExpNeg||A.e>=T.toExpPos):(v(g,1,t),y===void 0?y=T.rounding:v(y,0,8),A=L(new T(A),g,y),N=B(A,g<=A.e||A.e<=T.toExpNeg,g)),A.isNeg()&&!A.isZero()?"-"+N:N},a.toSignificantDigits=a.toSD=function(g,y){var N=this,A=N.constructor;return g===void 0?(g=A.precision,y=A.rounding):(v(g,1,t),y===void 0?y=A.rounding:v(y,0,8)),L(new A(N),g,y)},a.toString=function(){var g=this,y=g.constructor,N=B(g,g.e<=y.toExpNeg||g.e>=y.toExpPos);return g.isNeg()&&!g.isZero()?"-"+N:N},a.truncated=a.trunc=function(){return L(new this.constructor(this),this.e+1,1)},a.valueOf=a.toJSON=function(){var g=this,y=g.constructor,N=B(g,g.e<=y.toExpNeg||g.e>=y.toExpPos);return g.isNeg()?"-"+N:N};function m(g){var y,N,A,T=g.length-1,R="",W=g[0];if(T>0){for(R+=W,y=1;y<T;y++)A=g[y]+"",N=De-A.length,N&&(R+=ae(N)),R+=A;W=g[y],A=W+"",N=De-A.length,N&&(R+=ae(N))}else if(W===0)return"0";for(;W%10===0;)W/=10;return R+W}function v(g,y,N){if(g!==~~g||g<y||g>N)throw Error(at+g)}function S(g,y,N,A){var T,R,W,re;for(R=g[0];R>=10;R/=10)--y;return--y<0?(y+=De,T=0):(T=Math.ceil((y+1)/De),y%=De),R=te(10,De-y),re=g[T]%R|0,A==null?y<3?(y==0?re=re/100|0:y==1&&(re=re/10|0),W=N<4&&re==99999||N>3&&re==49999||re==5e4||re==0):W=(N<4&&re+1==R||N>3&&re+1==R/2)&&(g[T+1]/R/100|0)==te(10,y-2)-1||(re==R/2||re==0)&&(g[T+1]/R/100|0)==0:y<4?(y==0?re=re/1e3|0:y==1?re=re/100|0:y==2&&(re=re/10|0),W=(A||N<4)&&re==9999||!A&&N>3&&re==4999):W=((A||N<4)&&re+1==R||!A&&N>3&&re+1==R/2)&&(g[T+1]/R/1e3|0)==te(10,y-3)-1,W}function I(g,y,N){for(var A,T=[0],R,W=0,re=g.length;W<re;){for(R=T.length;R--;)T[R]*=y;for(T[0]+=ee.indexOf(g.charAt(W++)),A=0;A<T.length;A++)T[A]>N-1&&(T[A+1]===void 0&&(T[A+1]=0),T[A+1]+=T[A]/N|0,T[A]%=N)}return T.reverse()}function V(g,y){var N,A,T;if(y.isZero())return y;A=y.d.length,A<32?(N=Math.ceil(A/3),T=(1/b(4,N)).toString()):(N=16,T="2.3283064365386962890625e-10"),g.precision+=N,y=Le(g,1,y.times(T),new g(1));for(var R=N;R--;){var W=y.times(y);y=W.times(W).minus(W).times(8).plus(1)}return g.precision-=N,y}var F=(function(){function g(A,T,R){var W,re=0,me=A.length;for(A=A.slice();me--;)W=A[me]*T+re,A[me]=W%R|0,re=W/R|0;return re&&A.unshift(re),A}function y(A,T,R,W){var re,me;if(R!=W)me=R>W?1:-1;else for(re=me=0;re<R;re++)if(A[re]!=T[re]){me=A[re]>T[re]?1:-1;break}return me}function N(A,T,R,W){for(var re=0;R--;)A[R]-=re,re=A[R]<T[R]?1:0,A[R]=re*W+A[R]-T[R];for(;!A[0]&&A.length>1;)A.shift()}return function(A,T,R,W,re,me){var oe,Ae,Te,Pe,lt,yt,pt,Nt,Lt,Zt,At,Pt,N0,xt,R0,M0,w0,L0,i0,A0,I0=A.constructor,U0=A.s==T.s?1:-1,zt=A.d,Ct=T.d;if(!zt||!zt[0]||!Ct||!Ct[0])return new I0(!A.s||!T.s||(zt?Ct&&zt[0]==Ct[0]:!Ct)?NaN:zt&&zt[0]==0||!Ct?U0*0:U0/0);for(me?(lt=1,Ae=A.e-T.e):(me=Xe,lt=De,Ae=Ie(A.e/lt)-Ie(T.e/lt)),i0=Ct.length,w0=zt.length,Lt=new I0(U0),Zt=Lt.d=[],Te=0;Ct[Te]==(zt[Te]||0);Te++);if(Ct[Te]>(zt[Te]||0)&&Ae--,R==null?(xt=R=I0.precision,W=I0.rounding):re?xt=R+(A.e-T.e)+1:xt=R,xt<0)Zt.push(1),yt=!0;else{if(xt=xt/lt+2|0,Te=0,i0==1){for(Pe=0,Ct=Ct[0],xt++;(Te<w0||Pe)&&xt--;Te++)R0=Pe*me+(zt[Te]||0),Zt[Te]=R0/Ct|0,Pe=R0%Ct|0;yt=Pe||Te<w0}else{for(Pe=me/(Ct[0]+1)|0,Pe>1&&(Ct=g(Ct,Pe,me),zt=g(zt,Pe,me),i0=Ct.length,w0=zt.length),M0=i0,At=zt.slice(0,i0),Pt=At.length;Pt<i0;)At[Pt++]=0;A0=Ct.slice(),A0.unshift(0),L0=Ct[0],Ct[1]>=me/2&&++L0;do Pe=0,oe=y(Ct,At,i0,Pt),oe<0?(N0=At[0],i0!=Pt&&(N0=N0*me+(At[1]||0)),Pe=N0/L0|0,Pe>1?(Pe>=me&&(Pe=me-1),pt=g(Ct,Pe,me),Nt=pt.length,Pt=At.length,oe=y(pt,At,Nt,Pt),oe==1&&(Pe--,N(pt,i0<Nt?A0:Ct,Nt,me))):(Pe==0&&(oe=Pe=1),pt=Ct.slice()),Nt=pt.length,Nt<Pt&&pt.unshift(0),N(At,pt,Pt,me),oe==-1&&(Pt=At.length,oe=y(Ct,At,i0,Pt),oe<1&&(Pe++,N(At,i0<Pt?A0:Ct,Pt,me))),Pt=At.length):oe===0&&(Pe++,At=[0]),Zt[Te++]=Pe,oe&&At[0]?At[Pt++]=zt[M0]||0:(At=[zt[M0]],Pt=1);while((M0++<w0||At[0]!==void 0)&&xt--);yt=At[0]!==void 0}Zt[0]||Zt.shift()}if(lt==1)Lt.e=Ae,ge=yt;else{for(Te=1,Pe=Zt[0];Pe>=10;Pe/=10)Te++;Lt.e=Te+Ae*lt-1,L(Lt,re?R+Lt.e+1:R,W,yt)}return Lt}})();function L(g,y,N,A){var T,R,W,re,me,oe,Ae,Te,Pe,lt=g.constructor;e:if(y!=null){if(Te=g.d,!Te)return g;for(T=1,re=Te[0];re>=10;re/=10)T++;if(R=y-T,R<0)R+=De,W=y,Ae=Te[Pe=0],me=Ae/te(10,T-W-1)%10|0;else if(Pe=Math.ceil((R+1)/De),re=Te.length,Pe>=re)if(A){for(;re++<=Pe;)Te.push(0);Ae=me=0,T=1,R%=De,W=R-De+1}else break e;else{for(Ae=re=Te[Pe],T=1;re>=10;re/=10)T++;R%=De,W=R-De+T,me=W<0?0:Ae/te(10,T-W-1)%10|0}if(A=A||y<0||Te[Pe+1]!==void 0||(W<0?Ae:Ae%te(10,T-W-1)),oe=N<4?(me||A)&&(N==0||N==(g.s<0?3:2)):me>5||me==5&&(N==4||A||N==6&&(R>0?W>0?Ae/te(10,T-W):0:Te[Pe-1])%10&1||N==(g.s<0?8:7)),y<1||!Te[0])return Te.length=0,oe?(y-=g.e+1,Te[0]=te(10,(De-y%De)%De),g.e=-y||0):Te[0]=g.e=0,g;if(R==0?(Te.length=Pe,re=1,Pe--):(Te.length=Pe+1,re=te(10,De-R),Te[Pe]=W>0?(Ae/te(10,T-W)%te(10,W)|0)*re:0),oe)for(;;)if(Pe==0){for(R=1,W=Te[0];W>=10;W/=10)R++;for(W=Te[0]+=re,re=1;W>=10;W/=10)re++;R!=re&&(g.e++,Te[0]==Xe&&(Te[0]=1));break}else{if(Te[Pe]+=re,Te[Pe]!=Xe)break;Te[Pe--]=0,re=1}for(R=Te.length;Te[--R]===0;)Te.pop()}return le&&(g.e>lt.maxE?(g.d=null,g.e=NaN):g.e<lt.minE&&(g.e=0,g.d=[0])),g}function B(g,y,N){if(!g.isFinite())return st(g);var A,T=g.e,R=m(g.d),W=R.length;return y?(N&&(A=N-W)>0?R=R.charAt(0)+"."+R.slice(1)+ae(A):W>1&&(R=R.charAt(0)+"."+R.slice(1)),R=R+(g.e<0?"e":"e+")+g.e):T<0?(R="0."+ae(-T-1)+R,N&&(A=N-W)>0&&(R+=ae(A))):T>=W?(R+=ae(T+1-W),N&&(A=N-T-1)>0&&(R=R+"."+ae(A))):((A=T+1)<W&&(R=R.slice(0,A)+"."+R.slice(A)),N&&(A=N-W)>0&&(T+1===W&&(R+="."),R+=ae(A))),R}function Q(g,y){var N=g[0];for(y*=De;N>=10;N/=10)y++;return y}function ce(g,y,N){if(y>c)throw le=!0,N&&(g.precision=N),Error(Ke);return L(new g(de),y,1,!0)}function pe(g,y,N){if(y>d)throw Error(Ke);return L(new g(xe),y,N,!0)}function Ce(g){var y=g.length-1,N=y*De+1;if(y=g[y],y){for(;y%10==0;y/=10)N--;for(y=g[0];y>=10;y/=10)N++}return N}function ae(g){for(var y="";g--;)y+="0";return y}function Re(g,y,N,A){var T,R=new g(1),W=Math.ceil(A/De+4);for(le=!1;;){if(N%2&&(R=R.times(y),x(R.d,W)&&(T=!0)),N=Ie(N/2),N===0){N=R.d.length-1,T&&R.d[N]===0&&++R.d[N];break}y=y.times(y),x(y.d,W)}return le=!0,R}function et(g){return g.d[g.d.length-1]&1}function _e(g,y,N){for(var A,T,R=new g(y[0]),W=0;++W<y.length;){if(T=new g(y[W]),!T.s){R=T;break}A=R.cmp(T),(A===N||A===0&&R.s===N)&&(R=T)}return R}function Ve(g,y){var N,A,T,R,W,re,me,oe=0,Ae=0,Te=0,Pe=g.constructor,lt=Pe.rounding,yt=Pe.precision;if(!g.d||!g.d[0]||g.e>17)return new Pe(g.d?g.d[0]?g.s<0?0:1/0:1:g.s?g.s<0?0:g:NaN);for(y==null?(le=!1,me=yt):me=y,re=new Pe(.03125);g.e>-2;)g=g.times(re),Te+=5;for(A=Math.log(te(2,Te))/Math.LN10*2+5|0,me+=A,N=R=W=new Pe(1),Pe.precision=me;;){if(R=L(R.times(g),me,1),N=N.times(++Ae),re=W.plus(F(R,N,me,1)),m(re.d).slice(0,me)===m(W.d).slice(0,me)){for(T=Te;T--;)W=L(W.times(W),me,1);if(y==null)if(oe<3&&S(W.d,me-A,lt,oe))Pe.precision=me+=10,N=R=re=new Pe(1),Ae=0,oe++;else return L(W,Pe.precision=yt,lt,le=!0);else return Pe.precision=yt,W}W=re}}function je(g,y){var N,A,T,R,W,re,me,oe,Ae,Te,Pe,lt=1,yt=10,pt=g,Nt=pt.d,Lt=pt.constructor,Zt=Lt.rounding,At=Lt.precision;if(pt.s<0||!Nt||!Nt[0]||!pt.e&&Nt[0]==1&&Nt.length==1)return new Lt(Nt&&!Nt[0]?-1/0:pt.s!=1?NaN:Nt?0:pt);if(y==null?(le=!1,Ae=At):Ae=y,Lt.precision=Ae+=yt,N=m(Nt),A=N.charAt(0),Math.abs(R=pt.e)<15e14){for(;A<7&&A!=1||A==1&&N.charAt(1)>3;)pt=pt.times(g),N=m(pt.d),A=N.charAt(0),lt++;R=pt.e,A>1?(pt=new Lt("0."+N),R++):pt=new Lt(A+"."+N.slice(1))}else return oe=ce(Lt,Ae+2,At).times(R+""),pt=je(new Lt(A+"."+N.slice(1)),Ae-yt).plus(oe),Lt.precision=At,y==null?L(pt,At,Zt,le=!0):pt;for(Te=pt,me=W=pt=F(pt.minus(1),pt.plus(1),Ae,1),Pe=L(pt.times(pt),Ae,1),T=3;;){if(W=L(W.times(Pe),Ae,1),oe=me.plus(F(W,new Lt(T),Ae,1)),m(oe.d).slice(0,Ae)===m(me.d).slice(0,Ae))if(me=me.times(2),R!==0&&(me=me.plus(ce(Lt,Ae+2,At).times(R+""))),me=F(me,new Lt(lt),Ae,1),y==null)if(S(me.d,Ae-yt,Zt,re))Lt.precision=Ae+=yt,oe=W=pt=F(Te.minus(1),Te.plus(1),Ae,1),Pe=L(pt.times(pt),Ae,1),T=re=1;else return L(me,Lt.precision=At,Zt,le=!0);else return Lt.precision=At,me;me=oe,T+=2}}function st(g){return String(g.s*g.s/0)}function Ge(g,y){var N,A,T;for((N=y.indexOf("."))>-1&&(y=y.replace(".","")),(A=y.search(/e/i))>0?(N<0&&(N=A),N+=+y.slice(A+1),y=y.substring(0,A)):N<0&&(N=y.length),A=0;y.charCodeAt(A)===48;A++);for(T=y.length;y.charCodeAt(T-1)===48;--T);if(y=y.slice(A,T),y){if(T-=A,g.e=N=N-A-1,g.d=[],A=(N+1)%De,N<0&&(A+=De),A<T){for(A&&g.d.push(+y.slice(0,A)),T-=De;A<T;)g.d.push(+y.slice(A,A+=De));y=y.slice(A),A=De-y.length}else A-=T;for(;A--;)y+="0";g.d.push(+y),le&&(g.e>g.constructor.maxE?(g.d=null,g.e=NaN):g.e<g.constructor.minE&&(g.e=0,g.d=[0]))}else g.e=0,g.d=[0];return g}function nt(g,y){var N,A,T,R,W,re,me,oe,Ae;if(y.indexOf("_")>-1){if(y=y.replace(/(\d)_(?=\d)/g,"$1"),qe.test(y))return Ge(g,y)}else if(y==="Infinity"||y==="NaN")return+y||(g.s=NaN),g.e=NaN,g.d=null,g;if(He.test(y))N=16,y=y.toLowerCase();else if($e.test(y))N=2;else if(Be.test(y))N=8;else throw Error(at+y);for(R=y.search(/p/i),R>0?(me=+y.slice(R+1),y=y.substring(2,R)):y=y.slice(2),R=y.indexOf("."),W=R>=0,A=g.constructor,W&&(y=y.replace(".",""),re=y.length,R=re-R,T=Re(A,new A(N),R,R*2)),oe=I(y,N,Xe),Ae=oe.length-1,R=Ae;oe[R]===0;--R)oe.pop();return R<0?new A(g.s*0):(g.e=Q(oe,Ae),g.d=oe,le=!1,W&&(g=F(g,T,re*4)),me&&(g=g.times(Math.abs(me)<54?te(2,me):se.pow(2,me))),le=!0,g)}function ot(g,y){var N,A=y.d.length;if(A<3)return y.isZero()?y:Le(g,2,y,y);N=1.4*Math.sqrt(A),N=N>16?16:N|0,y=y.times(1/b(5,N)),y=Le(g,2,y,y);for(var T,R=new g(5),W=new g(16),re=new g(20);N--;)T=y.times(y),y=y.times(R.plus(T.times(W.times(T).minus(re))));return y}function Le(g,y,N,A,T){var R,W,re,me,oe=1,Ae=g.precision,Te=Math.ceil(Ae/De);for(le=!1,me=N.times(N),re=new g(A);;){if(W=F(re.times(me),new g(y++*y++),Ae,1),re=T?A.plus(W):A.minus(W),A=F(W.times(me),new g(y++*y++),Ae,1),W=re.plus(A),W.d[Te]!==void 0){for(R=Te;W.d[R]===re.d[R]&&R--;);if(R==-1)break}R=re,re=A,A=W,W=R,oe++}return le=!0,W.d.length=Te+1,W}function b(g,y){for(var N=g;--y;)N*=g;return N}function X(g,y){var N,A=y.s<0,T=pe(g,g.precision,1),R=T.times(.5);if(y=y.abs(),y.lte(R))return u=A?4:1,y;if(N=y.divToInt(T),N.isZero())u=A?3:2;else{if(y=y.minus(N.times(T)),y.lte(R))return u=et(N)?A?2:3:A?4:1,y;u=et(N)?A?1:4:A?3:2}return y.minus(T).abs()}function j(g,y,N,A){var T,R,W,re,me,oe,Ae,Te,Pe,lt=g.constructor,yt=N!==void 0;if(yt?(v(N,1,t),A===void 0?A=lt.rounding:v(A,0,8)):(N=lt.precision,A=lt.rounding),!g.isFinite())Ae=st(g);else{for(Ae=B(g),W=Ae.indexOf("."),yt?(T=2,y==16?N=N*4-3:y==8&&(N=N*3-2)):T=y,W>=0&&(Ae=Ae.replace(".",""),Pe=new lt(1),Pe.e=Ae.length-W,Pe.d=I(B(Pe),10,T),Pe.e=Pe.d.length),Te=I(Ae,10,T),R=me=Te.length;Te[--me]==0;)Te.pop();if(!Te[0])Ae=yt?"0p+0":"0";else{if(W<0?R--:(g=new lt(g),g.d=Te,g.e=R,g=F(g,Pe,N,A,0,T),Te=g.d,R=g.e,oe=ge),W=Te[N],re=T/2,oe=oe||Te[N+1]!==void 0,oe=A<4?(W!==void 0||oe)&&(A===0||A===(g.s<0?3:2)):W>re||W===re&&(A===4||oe||A===6&&Te[N-1]&1||A===(g.s<0?8:7)),Te.length=N,oe)for(;++Te[--N]>T-1;)Te[N]=0,N||(++R,Te.unshift(1));for(me=Te.length;!Te[me-1];--me);for(W=0,Ae="";W<me;W++)Ae+=ee.charAt(Te[W]);if(yt){if(me>1)if(y==16||y==8){for(W=y==16?4:3,--me;me%W;me++)Ae+="0";for(Te=I(Ae,T,y),me=Te.length;!Te[me-1];--me);for(W=1,Ae="1.";W<me;W++)Ae+=ee.charAt(Te[W])}else Ae=Ae.charAt(0)+"."+Ae.slice(1);Ae=Ae+(R<0?"p":"p+")+R}else if(R<0){for(;++R;)Ae="0"+Ae;Ae="0."+Ae}else if(++R>me)for(R-=me;R--;)Ae+="0";else R<me&&(Ae=Ae.slice(0,R)+"."+Ae.slice(R))}Ae=(y==16?"0x":y==2?"0b":y==8?"0o":"")+Ae}return g.s<0?"-"+Ae:Ae}function x(g,y){if(g.length>y)return g.length=y,!0}function z(g){return new this(g).abs()}function U(g){return new this(g).acos()}function q(g){return new this(g).acosh()}function fe(g,y){return new this(g).plus(y)}function i(g){return new this(g).asin()}function h(g){return new this(g).asinh()}function M(g){return new this(g).atan()}function C(g){return new this(g).atanh()}function H(g,y){g=new this(g),y=new this(y);var N,A=this.precision,T=this.rounding,R=A+4;return!g.s||!y.s?N=new this(NaN):!g.d&&!y.d?(N=pe(this,R,1).times(y.s>0?.25:.75),N.s=g.s):!y.d||g.isZero()?(N=y.s<0?pe(this,A,T):new this(0),N.s=g.s):!g.d||y.isZero()?(N=pe(this,R,1).times(.5),N.s=g.s):y.s<0?(this.precision=R,this.rounding=1,N=this.atan(F(g,y,R,1)),y=pe(this,R,1),this.precision=A,this.rounding=T,N=g.s<0?N.minus(y):N.plus(y)):N=this.atan(F(g,y,R,1)),N}function D(g){return new this(g).cbrt()}function e(g){return L(g=new this(g),g.e+1,2)}function n(g,y,N){return new this(g).clamp(y,N)}function r(g){if(!g||typeof g!="object")throw Error(mt+"Object expected");var y,N,A,T=g.defaults===!0,R=["precision",1,t,"rounding",0,8,"toExpNeg",-l,0,"toExpPos",0,l,"maxE",0,l,"minE",-l,0,"modulo",0,9];for(y=0;y<R.length;y+=3)if(N=R[y],T&&(this[N]=Ue[N]),(A=g[N])!==void 0)if(Ie(A)===A&&A>=R[y+1]&&A<=R[y+2])this[N]=A;else throw Error(at+N+": "+A);if(N="crypto",T&&(this[N]=Ue[N]),(A=g[N])!==void 0)if(A===!0||A===!1||A===0||A===1)if(A)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[N]=!0;else throw Error(ue);else this[N]=!1;else throw Error(at+N+": "+A);return this}function p(g){return new this(g).cos()}function w(g){return new this(g).cosh()}function E(g){var y,N,A;function T(R){var W,re,me,oe=this;if(!(oe instanceof T))return new T(R);if(oe.constructor=T,K(R)){oe.s=R.s,le?!R.d||R.e>T.maxE?(oe.e=NaN,oe.d=null):R.e<T.minE?(oe.e=0,oe.d=[0]):(oe.e=R.e,oe.d=R.d.slice()):(oe.e=R.e,oe.d=R.d?R.d.slice():R.d);return}if(me=typeof R,me==="number"){if(R===0){oe.s=1/R<0?-1:1,oe.e=0,oe.d=[0];return}if(R<0?(R=-R,oe.s=-1):oe.s=1,R===~~R&&R<1e7){for(W=0,re=R;re>=10;re/=10)W++;le?W>T.maxE?(oe.e=NaN,oe.d=null):W<T.minE?(oe.e=0,oe.d=[0]):(oe.e=W,oe.d=[R]):(oe.e=W,oe.d=[R]);return}if(R*0!==0){R||(oe.s=NaN),oe.e=NaN,oe.d=null;return}return Ge(oe,R.toString())}if(me==="string")return(re=R.charCodeAt(0))===45?(R=R.slice(1),oe.s=-1):(re===43&&(R=R.slice(1)),oe.s=1),qe.test(R)?Ge(oe,R):nt(oe,R);if(me==="bigint")return R<0?(R=-R,oe.s=-1):oe.s=1,Ge(oe,R.toString());throw Error(at+R)}if(T.prototype=a,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=r,T.clone=E,T.isDecimal=K,T.abs=z,T.acos=U,T.acosh=q,T.add=fe,T.asin=i,T.asinh=h,T.atan=M,T.atanh=C,T.atan2=H,T.cbrt=D,T.ceil=e,T.clamp=n,T.cos=p,T.cosh=w,T.div=_,T.exp=Y,T.floor=P,T.hypot=Z,T.ln=we,T.log=Ee,T.log10=Qe,T.log2=ye,T.max=be,T.min=Ze,T.mod=Ye,T.mul=Fe,T.pow=Je,T.random=ft,T.round=St,T.sign=Rt,T.sin=n0,T.sinh=Vt,T.sqrt=Yt,T.sub=jt,T.sum=l0,T.tan=ct,T.tanh=N1,T.trunc=j0,g===void 0&&(g={}),g&&g.defaults!==!0)for(A=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],y=0;y<A.length;)g.hasOwnProperty(N=A[y++])||(g[N]=this[N]);return T.config(g),T}function _(g,y){return new this(g).div(y)}function Y(g){return new this(g).exp()}function P(g){return L(g=new this(g),g.e+1,3)}function Z(){var g,y,N=new this(0);for(le=!1,g=0;g<arguments.length;)if(y=new this(arguments[g++]),y.d)N.d&&(N=N.plus(y.times(y)));else{if(y.s)return le=!0,new this(1/0);N=y}return le=!0,N.sqrt()}function K(g){return g instanceof se||g&&g.toStringTag===Se||!1}function we(g){return new this(g).ln()}function Ee(g,y){return new this(g).log(y)}function ye(g){return new this(g).log(2)}function Qe(g){return new this(g).log(10)}function be(){return _e(this,arguments,-1)}function Ze(){return _e(this,arguments,1)}function Ye(g,y){return new this(g).mod(y)}function Fe(g,y){return new this(g).mul(y)}function Je(g,y){return new this(g).pow(y)}function ft(g){var y,N,A,T,R=0,W=new this(1),re=[];if(g===void 0?g=this.precision:v(g,1,t),A=Math.ceil(g/De),this.crypto)if(crypto.getRandomValues)for(y=crypto.getRandomValues(new Uint32Array(A));R<A;)T=y[R],T>=429e7?y[R]=crypto.getRandomValues(new Uint32Array(1))[0]:re[R++]=T%1e7;else if(crypto.randomBytes){for(y=crypto.randomBytes(A*=4);R<A;)T=y[R]+(y[R+1]<<8)+(y[R+2]<<16)+((y[R+3]&127)<<24),T>=214e7?crypto.randomBytes(4).copy(y,R):(re.push(T%1e7),R+=4);R=A/4}else throw Error(ue);else for(;R<A;)re[R++]=Math.random()*1e7|0;for(A=re[--R],g%=De,A&&g&&(T=te(10,De-g),re[R]=(A/T|0)*T);re[R]===0;R--)re.pop();if(R<0)N=0,re=[0];else{for(N=-1;re[0]===0;N-=De)re.shift();for(A=1,T=re[0];T>=10;T/=10)A++;A<De&&(N-=De-A)}return W.e=N,W.d=re,W}function St(g){return L(g=new this(g),g.e+1,this.rounding)}function Rt(g){return g=new this(g),g.d?g.d[0]?g.s:0*g.s:g.s||NaN}function n0(g){return new this(g).sin()}function Vt(g){return new this(g).sinh()}function Yt(g){return new this(g).sqrt()}function jt(g,y){return new this(g).sub(y)}function l0(){var g=0,y=arguments,N=new this(y[g]);for(le=!1;N.s&&++g<y.length;)N=N.plus(y[g]);return le=!0,L(N,this.precision,this.rounding)}function ct(g){return new this(g).tan()}function N1(g){return new this(g).tanh()}function j0(g){return L(g=new this(g),g.e+1,1)}se=E(Ue),se.prototype.constructor=se,se.default=se.Decimal=se,de=new se(de),xe=new se(xe),typeof define=="function"&&define.amd?define(function(){return se}):typeof z0<"u"&&z0.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(a[Symbol.for("nodejs.util.inspect.custom")]=a.toString,a[Symbol.toStringTag]="Decimal"),z0.exports=se):(O||(O=typeof self<"u"&&self&&self.self==self?self:window),G=O.Decimal,se.noConflict=function(){return O.Decimal=G,se},O.Decimal=se)})(q1)});var T1=u0((Pi,l1)=>{"use strict";var O1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],C1={};for(let O of O1)C1[O]=!0;var Tn="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",Rn="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",Ln=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof l1<"u"&&(l1.exports={PRIMES:O1,PRIMES_SET:C1,LONG_PI:Tn,LONG_E:Rn,BIG_LOG_CACHE:Ln})});var T0=u0((Fi,E1)=>{"use strict";var b1=typeof globalThis.nerdamerBigInt>"u"?I1():globalThis.nerdamerBigInt,B1=typeof globalThis.nerdamerBigDecimal>"u"?_1():globalThis.nerdamerBigDecimal,Un=typeof globalThis.nerdamerConstants>"u"?T1():globalThis.nerdamerConstants,Ot={bigInt:b1,bigDec:B1,isInt:()=>!1,scientificToDecimal:()=>"",DivisionByZero:Error,Settings:{PRECISION:21,USE_BIG:!1},Fraction:{convert:()=>[0,1],quickConversion:()=>[0,1],fullConversion:()=>[0,1]}},We=class O{constructor(l){if(this.num,this.den,l instanceof O)return l;if(l===void 0)return this;try{if(Ot.isInt(l))try{this.num=Ot.bigInt(l),this.den=Ot.bigInt(1)}catch(t){if(t.message==="timeout")throw t;return O.simple(l)}else{let t=l instanceof Ot.bigDec?Ot.Fraction.quickConversion(l):Ot.Fraction.convert(l);this.num=new Ot.bigInt(t[0]),this.den=new Ot.bigInt(t[1])}}catch(t){if(t.message==="timeout")throw t;return O.simple(l)}}static create(l){if(l instanceof O)return l;l=l.toString();let t=l.charAt(0)==="-";t&&(l=l.substr(1,l.length-1));let ee=new O(l);return t&&ee.negate(),ee}static isFrac(l){return l instanceof O}static quick(l,t){let ee=new O;return ee.num=new Ot.bigInt(l),ee.den=new Ot.bigInt(t),ee}static simple(l){let ee=String(Ot.scientificToDecimal(l)).split("."),de=ee.join(""),xe="1",Ue=(ee[1]||"").length;for(let ge=0;ge<Ue;ge++)xe+="0";return O.quick(de,xe).simplify()}multiply(l){if(this.isOne())return l.clone();if(l.isOne())return this.clone();let t=this.clone();return t.num=t.num.multiply(l.num),t.den=t.den.multiply(l.den),t.simplify()}divide(l){if(l.equals(0))throw new Ot.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(l.clone().invert()).simplify()}subtract(l){return this.clone().add(l.clone().neg())}sub(l){return this.subtract(l)}neg(){return this.num=this.num.multiply(-1),this}add(l){let t=this.den,ee=l.den,de=this.clone(),xe=de.num,Ue=l.num;return t.equals(ee)?de.num=xe.add(Ue):(de.num=xe.multiply(ee).add(Ue.multiply(t)),de.den=t.multiply(ee)),de.simplify()}mod(l){let t=this.clone(),ee=l.clone();return t.num=t.num.multiply(ee.den),t.den=t.den.multiply(ee.den),ee.num=ee.num.multiply(this.den),ee.den=ee.den.multiply(this.den),t.num=t.num.mod(ee.num),t.simplify()}simplify(){let l=Ot.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(l),this.den=this.den.divide(l),this}clone(){let l=new O;return l.num=new Ot.bigInt(this.num),l.den=new Ot.bigInt(this.den),l}decimal(l){let t=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";l||=Ot.Settings.PRECISION,l+=2;let ee=[],de=this.num.abs(),xe=this.den,Ue;for(Ue=0;Ue<l;Ue++){let G=de.divide(xe),u=de.subtract(G.multiply(xe));if(ee.push(G),u.equals(0))break;de=u.times(10)}let se=ee.shift();if(ee.length===0)return t+se.toString();if(Ue===l){let G=[];for(let u=0;u<2;u++)G.unshift(ee.pop());ee.push(Math.round(Number(G.join("."))))}let ge=`${se.toString()}.${ee.join("")}`;return t+ge}toDecimal(l){return l||=Ot.Settings.PRECISION,l?this.decimal(l):this.num.valueOf()/this.den.valueOf()}qcompare(l){return[this.num.multiply(l.den),l.num.multiply(this.den)]}equals(l){isNaN(l)||(l=new O(l));let t=this.qcompare(l);return t[0].equals(t[1])}absEquals(l){isNaN(l)||(l=new O(l));let t=this.qcompare(l);return t[0].abs().equals(t[1])}greaterThan(l){isNaN(l)||(l=new O(l));let t=this.qcompare(l);return t[0].gt(t[1])}gt(l){return this.greaterThan(l)}gte(l){return this.greaterThan(l)||this.equals(l)}lte(l){return this.lessThan(l)||this.equals(l)}lessThan(l){isNaN(l)||(l=new O(l));let t=this.qcompare(l);return t[0].lt(t[1])}lt(l){return this.lessThan(l)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let l=this.den;if(!this.num.equals(0)){let t=this.num.isNegative();this.den=this.num.abs(),this.num=l,t&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(l){return O.quick(Ot.bigInt.gcd(l.num,this.num),Ot.bigInt.lcm(l.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Ot.Settings.USE_BIG?new Ot.bigDec(this.num.toString()).div(new Ot.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(l){let t=typeof l=="number"?new O(l):l;return this.mod(t).equals(0)}},O0={isVector:()=>!1,Vector:{fromArray:()=>({})},remove:()=>{}};function o0(O,...l){if(this.elements=[],typeof O>"u")return;let t=O;if(O0.isVector(t)||(t=O0.Vector.fromArray([t,...l])),t){let{elements:ee}=t;for(let de=0,xe=ee.length;de<xe;de++)this.add(ee[de])}}o0.fromArray=function(l){function t(ee){return o0.apply(this,ee)}return t.prototype=o0.prototype,new t(l)};o0.prototype={elements:[],add(O){this.contains(O)||this.elements.push(O.clone())},contains(O){for(let l=0;l<this.elements.length;l++){let t=this.elements[l];if(O.equals(t))return!0}return!1},each(O){let{elements:l}=this,t=new o0;for(let ee=0,de=l.length;ee<de;ee++){let xe=l[ee];O.call(this,xe,t,ee)}return t},clone(){let O=new o0;return this.each(l=>{O.add(l.clone())}),O},union(O){let l=this.clone();return O.each(t=>{l.add(t)}),l},difference(O){let l=this.clone();return O.each(t=>{l.remove(t)}),l},remove(O){for(let l=0,t=this.elements.length;l<t;l++)if(this.elements[l].equals(O))return O0.remove(this.elements,l),!0;return!1},intersection(O){let l=new o0,t=this;return O.each(ee=>{t.contains(ee)&&l.add(ee)}),l},intersects(O){return this.intersection(O).elements.length>0},isSubset(O){let{elements:l}=O;for(let t=0,ee=l.length;t<ee;t++)if(!this.contains(l[t]))return!1;return!0},toString(){return`{${this.elements.join(",")}}`}};var p0={_:null,block:()=>{}};function $t(){this.elements=[]}$t.prototype.append=function(l){this.elements.push(l)};$t.prototype.getItems=function(){return this.elements};$t.prototype.toString=function(){return p0._.prettyPrint(this.elements)};$t.prototype.dimensions=function(){return this.elements.length};$t.prototype.text=function(O){return`(${this.elements.map(l=>l.text(O)).join(",")})`};$t.create=function(l){let t=new $t;return l&&t.append(l),t};$t.prototype.clone=function(l){let t=$t.create();return t.elements=this.elements.map(ee=>ee.clone()),t};$t.prototype.expand=function(l){return this.elements=this.elements.map(t=>p0._.expand(t,l)),this};$t.prototype.evaluate=function(O){return this.elements=this.elements.map(l=>p0._.evaluate(l,O)),this};$t.prototype.map=function(l){let t=this.clone();return t.elements=t.elements.map((ee,de)=>l(ee,de+1)),t};$t.prototype.add=function(l){return p0.block("SAFE",()=>{let t=l.elements||l;return this.elements.length!==t.length?null:this.map((ee,de)=>p0._.add(ee,t[de-1]))},void 0,this)};$t.prototype.subtract=function(l){return p0.block("SAFE",()=>{let t=l.elements||l;return this.elements.length!==t.length?null:this.map((ee,de)=>p0._.subtract(ee,t[de-1]))},void 0,this)};var V1={Settings:{SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0},nround:(O,l)=>Math.round(O*10**l)/10**l};function Bt(O){return this instanceof Bt?(O=String(typeof O>"u"?0:O),O.startsWith("-")?(this.sign=-1,O=O.substr(1,O.length)):this.sign=1,Bt.isScientific(O)?this.fromScientific(O):this.convert(O),this):new Bt(O)}Bt.prototype={fromScientific(O){let l=String(O).toLowerCase().split("e");this.coeff=l[0],this.exponent=Number(l[1]);let t=this.coeff.split(".");this.wholes=t[0]||"",this.dec=t[1]||"";let{dec:ee}=this;return this.decp=ee==="0"?0:ee.length,this},convert(O){let l=O.split("."),t=l[0]||"",ee=l[1]||"";t=Bt.removeLeadingZeroes(t),ee=Bt.removeTrailingZeroes(ee);let de=t.length,xe=t+ee,Ue=Bt.leadingZeroes(xe).length;this.exponent=de-(Ue+1);let se=Bt.removeLeadingZeroes(xe);this.coeff=`${se.charAt(0)}.${Bt.removeTrailingZeroes(se.substr(1,se.length))||"0"}`;let ge=this.coeff.split(".")[1]||"";return this.decp=ge==="0"?0:ge.length,this.dec=ee,this.wholes=t,this},round(O){let l=this.copy();if(O=Number(O),O===0)l.coeff=l.coeff.charAt(0);else{let t=this.coeff.substring(0,O+1),ee=this.coeff.substring(O+1,O+3),de=Number(ee.charAt(0));Number(ee.charAt(1))>4&&de++,l.coeff=t+de}return l},copy(){let O=new Bt(0);return O.coeff=this.coeff,O.exponent=this.exponent,O.sign=this.sign,O},toString(O){let l;if(V1.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<O)this.decp===0&&this.wholes!==void 0?l=this.wholes:l=this.coeff;else{let t=typeof O>"u"?this.coeff:Bt.round(this.coeff,Math.min(O,this.decp||1)),ee=this.exponent;t.startsWith("10.")&&(t=typeof O>"u"?t.replace(/^10\./u,"1.0"):Bt.round(t.replace(/^10\./u,"1.0"),Math.min(O,this.decp||1)),ee=Number(ee)+1),l=this.exponent===0?t:`${t}e${ee}`}return(this.sign===-1?"-":"")+l}};Bt.isScientific=function(l){return/\d+\.?\d*e[+-]*\d+/iu.test(l)};Bt.leadingZeroes=function(l){let t=l.match(/^(?<zeros>0*).*$/u);return t?t[1]:""};Bt.removeLeadingZeroes=function(l){let t=l.match(/^0*(?<rest>.*)$/u);return t?t[1]:""};Bt.removeTrailingZeroes=function(l){let t=l.match(/0*$/u);return t?l.substring(0,l.length-t[0].length):""};Bt.round=function(l,t){let ee=String(V1.nround(l,t)),de=ee.includes(".")?ee.split(".").pop():"",xe=t-de.length;return xe>0&&(ee.includes(".")||(ee+="."),ee+=new Array(xe+1).join("0")),ee};function e0(O){let l=function(t){this.name=O,this.message=t===void 0?"":t;let ee=new Error(this.message);ee.name=this.name,this.stack=ee.stack};return l.prototype=Object.create(Error.prototype),l}function bt(O){return Array.isArray(O)}function qt(O){return`(${O})`}function xn(O,l){return O<0==l<0}function Ut(...O){return O.shift().replace(/\{(?<idx>\d+)\}/gu,(ee,de)=>{let xe=O[de];return typeof xe=="function"?xe():xe})}function $n(O,l,t){let ee=[];t||=1;for(let de=O;de<=l;de++)ee.push(de*t);return ee}function kn(O){return O&&String(O)}function Dn(O,l,t,ee){return O.substr(0,l)+ee+O.substr(t,O.length)}function Pn(O){return O!==void 0&&O.custom}function Fn(O){return Math.max.apply(void 0,O)}function a1(O){return Math.min.apply(void 0,O)}function kt(O){return Number(O)%2===0}function u1(O){return 1/(O%1)%2===0}function c1(O){let l=O.length,t=[];for(let ee=0;ee<l;ee++){let de=O[ee];t.indexOf(de)===-1&&t.push(de)}return t}function bn(O){return[].slice.call(O)}function vt(O){return typeof O=="number"?Number.isInteger(O):typeof O<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(O.toString())}function Bn(O,l){if(O.sort(),l.sort(),O.length===l.length){for(let t=0;t<O.length;t++)if(O[t]!==l[t])return!1;return!0}return!1}function Vn(O){let l=[],t=O.length;for(let ee=0;ee<t;ee++)l[ee]=O[ee].clone();return l}function G1(O){return/^\d+\.?\d*$/u.test(O)}function v0(O,l=14){return vt(O)?Number(O)>=Number.MAX_VALUE?O.toString():Number(O):Math.round(O*10**l)/10**l}function Gn(O,l){l||=20;let t=[],ee,de,xe;t.push(O[0]);for(let Ue=0;Ue<O.length-1;Ue++){ee=O[Ue],de=O[Ue+1]-ee,xe=de/l;for(let se=0;se<l;se++)ee+=xe,t.push(ee)}return t}function H1(O,l){if(bt(O)){let t=O.length;for(let ee=0;ee<t;ee++)l.call(O,ee)}else for(let t in O)Object.hasOwn(O,t)&&l.call(O,t)}function S0(O,l){let t;return bt(O)?t=O.splice(l,1)[0]:(t=O[l],delete O[l]),t}function Hn(O,l){let t={};return t[O]=l,t}function Xn(O){for(let l=0;l<O.length;l++)if(!G1(O[l]))return!1;return!0}function k0(O){let l=Math.sign(O),t=Math.abs(O);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(t))){let de=String(t).toLowerCase().split("e"),xe=de.pop(),Ue=Math.abs(Number(xe)),se=Math.sign(Number(xe)),ge=de[0].split(".");if(se===-1)Ue-=ge[0].length,Ue<0?t=`${ge[0].slice(0,Ue)}.${ge[0].slice(Ue)}${ge.length===2?ge[1]:""}`:t=`0.${new Array(Ue+1).join("0")}${ge.join("")}`;else{let G=ge[1];G&&(Ue-=G.length),Ue<0?t=`${ge[0]+G.slice(0,Ue)}.${G.slice(Ue)}`:t=ge.join("")+new Array(Ue+1).join("0")}}return l<0?`-${t}`:String(t)}function W0(O){let l=O[0];for(let t=1,ee=O.length;t<ee;t++)if(!O[t].equals(l))return!1;return!0}function jn(O,l){typeof l!=="function"&&(l=function(de,xe){return de===xe});let ee=[];for(;O.length;){let de=O[0];if(O.length===1){ee.push(de);break}let xe=[];ee.push(de);for(let Ue=1;Ue<O.length;Ue++){let se=O[Ue];l(de,se)||xe.push(se)}O=xe}return ee}function Zn(O,l){let t=O.length,ee=[];for(let Ue=0;Ue<O.length;Ue++)ee.push([O[Ue],l[Ue]]);ee.sort((Ue,se)=>Number(Ue[0])-Number(se[0]));let de=[],xe=[];for(let Ue=0;Ue<t;Ue++)de.push(ee[Ue][0]),xe.push(ee[Ue][1]);return[de,xe]}var f1=e0("DivisionByZero"),R1=e0("ParseError"),Kt=e0("UndefinedError"),p1=e0("OutOfFunctionDomainError"),zn=e0("MaximumIterationsReached"),w1=e0("NerdamerTypeError"),Q0=e0("ParityError"),q0=e0("OperatorError"),Wn=e0("OutOfRangeError"),h1=e0("DimensionError"),X1=e0("InvalidVariableNameError"),Qn=e0("ValueLimitExceededError"),L1=e0("NerdamerValueError"),Jn=e0("SolveError"),Yn=e0("InfiniteLoopError"),U1=e0("UnexpectedTokenError");function g1(O){return O instanceof $t}function x1(O){return O instanceof o0}function J0(O,l,t){let de=Object.keys(O)[0];return l?de:t?{key:de,obj:O[de]}:O[de]}var{keys:v1}=Object,t1={N:1,P:2};function _0(O){return O.group===t1.N||O.group===t1.P}var j1={S:3};function $1(O){return O.group===j1.S&&O.multiplier.equals(1)&&O.power.equals(1)}var Z1={N:1};function m1(O){for(let l=0;l<O.length;l++)if(O[l].group!==Z1.N)return!1;return!0}var S1={RESERVED:[]};function Y0(O){let l=function(t){S1.RESERVED.indexOf(t)===-1&&S1.RESERVED.push(t)};typeof O=="string"?l(O):H1(O,t=>{l(t)})}var C0={RESERVED:[]};function Kn(O){let l=C0.RESERVED.indexOf(O);l!==-1&&(C0.RESERVED[l]=void 0)}var n1={ALLOW_CHARS:[],VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function g0(O,l="variable"){if(n1.ALLOW_CHARS.indexOf(O)!==-1)return;if(!n1.VALIDATION_REGEX.test(O))throw new X1(`${O} is not a valid ${l} name`)}var z1={RESERVED:[]};function K0(O){return z1.RESERVED.indexOf(O)!==-1}var F0={WARNINGS:[],SHOW_WARNINGS:!1};function d1(O){F0.WARNINGS.push(O),F0.SHOW_WARNINGS&&console&&console.warn&&console.warn(O)}function ei(){return F0.WARNINGS}var W1={EXPRESSIONS:[]};function ti(){return W1.EXPRESSIONS.length}var Q1={Settings:{}};function ni(O){return Q1.Settings[O]}function ii(O){try{return g0(O),C0.RESERVED.indexOf(O)===-1}catch(l){if(l.message==="timeout")throw l;return!1}}function ri(O){return O?C0.RESERVED:C0.RESERVED.join(", ")}var b0={_version:"",C:{}};function si(O){if(O)try{return b0.C[O].version}catch(l){if(l.message==="timeout")throw l;return`No module named ${O} found!`}return b0._version}function oi(){return b0.C}var J1={functions:null};function li(){return v1(J1.functions)}var Y1={CONSTANTS:null};function ai(O){return String(Y1.CONSTANTS[O])}var y0={VARS:null};function ui(O){return y0.VARS[O]}function ci(O,l){O||="text";let t={};if(O==="object")t=y0.VARS;else for(let ee in y0.VARS)Object.hasOwn(y0.VARS,ee)&&(O==="latex"?t[ee]=y0.VARS[ee].latex(l):O==="text"&&(t[ee]=y0.VARS[ee].text(l)));return t}var Jt={_:null,C:null};function fi(O,l){return Jt._.toTeX(O,l)}function pi(O){return Jt._.getOperator(O)}function hi(O,l){Jt._.aliasOperator(O,l)}function gi(O,l){Jt._.setOperator(O,l)}function mi(O,l){Jt._.peekers[O]&&Jt._.peekers[O].push(l)}function di(O,l){let t=Jt._.peekers[O];if(t){let ee=t.indexOf(l);ee!==-1&&S0(t,ee)}}function K1(O){return Jt._.tree(Jt._.toRPN(Jt._.tokenize(O)))}function wi(O){return String(O).split(";").map(l=>Jt._.parse(l))}function vi(O){return Jt._.tokenize(Jt._.toRPN(O))}function Si(O,l){return`<div class="tree">
    <ul>
        <li>
${K1(O).toHTML(3,l)}
        </li>
    </ul>
</div>`}function yi(O,l,t){let ee=Jt._.functions[O],de=typeof t>"u"?ee[1]:t;Jt._.functions[O]=[l(ee[0],Jt.C),de]}var Dt={EXPRESSIONS:[],USER_FUNCTIONS:[],LaTeX:{latex:()=>"",parse:()=>""},text:()=>"",functions:{},Math2:{},_:null,Expression:null};function Ei(O,l,t){let ee=O?{}:[];for(let de=0;de<Dt.EXPRESSIONS.length;de++){let xe=l?Dt.LaTeX.latex(Dt.EXPRESSIONS[de],t):Dt.text(Dt.EXPRESSIONS[de],t);O?ee[de+1]=xe:ee.push(xe)}return ee}function Ni(O,l){let t=O?{}:[];for(let ee=0;ee<Dt.USER_FUNCTIONS.length;ee++){let de,xe,Ue=Dt.USER_FUNCTIONS[ee],se=Dt.functions[Ue][2];if(se)({params:de,body:xe}=se);else{let u=Dt.Math2[Ue].toString();[,de]=/\((?<params>.*?)\)/u.exec(u),de=de.split(",").map(le=>le.trim()),xe="{JavaScript}"}let ge=`${Ue}(${de.join(", ")})=${xe}`,G=Dt.text(ge,l);O?t[ee+1]=G:t.push(G)}return t}function Mi(O){O=O.replace(/_(?<char>[A-Za-z0-9])/gu,(...t)=>`${t[0]} `),O=O.replace(/\^(?<char>[A-Za-z0-9])/gu,(...t)=>`^{${t[1]}}`),O=O.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...t)=>`${t[1]}{${t[2]}}`),O=O.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...t)=>`${t[1]}{${t[2]}}`);let l=Dt.LaTeX.parse(Dt._.tokenize(O));return new Dt.Expression(Dt._.parse(l))}var t0={libExports:null,VARS:{},_clearFunctions:()=>{},_initConstants:()=>{},clear:null};function Ai(){for(let O in t0.VARS)Object.hasOwn(t0.VARS,O)&&delete t0.VARS[O];return t0.libExports}function Ii(){return t0._clearFunctions(),t0.libExports}function qi(){return t0.libExports}function _i(){return t0.clear("all"),t0.libExports}function Oi(O){return O.call(t0.libExports),t0.libExports}var D0={libExports:null,CONSTANTS:{}};function Ci(O,l){if(g0(O),!K0(O))if(l==="delete"||l==="")delete D0.CONSTANTS[O];else{if(isNaN(l))throw new w1("Constant must be a number!");D0.CONSTANTS[O]=l}return D0.libExports}var r0={libExports:null,VARS:{},CONSTANTS:{},parse:()=>null,isSymbol:()=>!1};function Ti(O,l){return g0(O),O in r0.CONSTANTS&&Ft(`Cannot set value for constant ${O}`),l==="delete"||l===""?delete r0.VARS[O]:r0.VARS[O]=r0.isSymbol(l)?l:r0.parse(l),r0.libExports}var i1={libExports:null,_setFunction:()=>!1};function Ri(O,l,t){if(!i1._setFunction(O,l,t))throw new Error("Failed to set function!");return i1.libExports}var c0={libExports:null,EXPRESSIONS:[]};function k1(O,l=!1){if(O==="all")c0.EXPRESSIONS.length=0;else if(O==="last")c0.EXPRESSIONS.pop();else if(O==="first")c0.EXPRESSIONS.shift();else{let t=O?O-1:c0.EXPRESSIONS.length;l===!0?c0.EXPRESSIONS[t]=void 0:S0(c0.EXPRESSIONS,t)}return c0.libExports}var E0={libExports:null,Settings:null,functions:null};function en(O){let l=E0.libExports.getCore();if(bt(O))for(let t=0;t<O.length;t++)O&&en(O[t]);else if(O&&E0.Settings.exclude.indexOf(O.name)===-1){if(O.dependencies){for(let de=0;de<O.dependencies.length;de++)if(!l[O.dependencies[de]])throw new Error(Ut("{0} requires {1} to be loaded!",O.name,O.dependencies[de]))}let t=O.parent,ee=O.build.call(l);if(t){l[t]||(l[O.parent]={});let de=t==="nerdamer"?E0.libExports:l[t];de[O.name]=ee}O.visible&&(E0.functions[O.name]=[ee,O.numargs])}}var Xt={bigDec:null,Settings:null,functions:null,symfunction:null,NerdamerSymbol:null};function y1(O,l){if(typeof O=="object"&&O!==null){let ee=O;for(let de in ee)Object.hasOwn(ee,de)&&y1(de,ee[de])}["SAFE"].indexOf(O)!==-1&&Ft(`Cannot modify setting: ${O}`),O==="PRECISION"?(Xt.bigDec.set({precision:l}),Xt.Settings.PRECISION=l,l>21&&y1("USE_BIG",!0)):O==="USE_LN"&&l===!0?(Xt.Settings.LOG="LN",Xt.Settings.LOG10="log",Xt.functions.log=Xt.Settings.LOG_FNS.log10,Xt.functions.log[0]=function(de){return de.isConstant()?new Xt.NerdamerSymbol(Math.log10(de)):Xt.symfunction(Xt.Settings.LOG10,[de])},Xt.functions.LN=Xt.Settings.LOG_FNS.log,delete Xt.functions.log10):Xt.Settings[O]=l}var s0={libExports:null,functions:null,parse:null,callfunction:null,Expression:null};function Li(O=!1){let l=function(ee){return function(...xe){for(let Ue=0;Ue<xe.length;Ue++)xe[Ue]=s0.parse(xe[Ue]);return new s0.Expression(Ht("PARSE2NUMBER",()=>s0.callfunction(ee,xe)))}};for(let t in s0.functions)(!(t in s0.libExports)||O)&&(s0.libExports[t]=l(t))}var tn={suppress_errors:!1};function Ft(O,l=void 0){if(!tn.suppress_errors)throw l?new l(O):new Error(O)}var nn={PRIMES_SET:{}};function P0(O){if(O in nn.PRIMES_SET)return!0;let l=Math.floor(Math.sqrt(O));for(let t=2;t<=l;t++)if(O%t===0)return!1;return!0}var m0={starttime:0,timeout:0,TIMEOUT:800};function D1(){m0.starttime=Date.now(),m0.timeout=m0.TIMEOUT}function P1(){m0.starttime=0}function r1(){if(m0.starttime!==0&&Date.now()>m0.starttime+m0.timeout)throw new Error("timeout")}var f0={PRIMES:[],PRIMES_SET:{}};function Ui(O){if(r1(),P0(O))return[O];let l=O,t=1,ee=[],de=2220446049250313e-31;for(;t<l;){r1();let xe=O/t,Ue=Math.floor(xe);if(xe-Ue<=de&&t>1){if(P0(t)&&(f0.PRIMES_SET[t]||(f0.PRIMES.push(t),f0.PRIMES_SET[t]=!0),ee.push(t)),P0(Ue)){ee.push(Ue);break}l=Ue}t++}return ee.sort((xe,Ue)=>xe-Ue)}function F1(O){let l=f0.PRIMES[f0.PRIMES.length-1]||2;for(let t=l;t<O;t++)P0(t)&&f0.PRIMES.push(t),f0.PRIMES_SET[t]=!0}var e1={Settings:{}};function Ht(O,l,t=void 0,ee=void 0){let de=e1.Settings[O];e1.Settings[O]=t===void 0?!0:!!t;let xe=l.call(ee);return e1.Settings[O]=de,xe}var rn={_:{parse:()=>{}}};function Mt(O,l=void 0){return Ht("PARSE2NUMBER",()=>rn._.parse(O,l),!0)}var sn=(function(l){let t="1.1.16",{bigInt:ee}=l,{bigDec:de}=l;de.set({precision:250});let xe={},{PRIMES:Ue}=l.constants,{PRIMES_SET:se}=l.constants,ge={},G={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",LONG_PI:l.constants.LONG_PI,LONG_E:l.constants.LONG_E,PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800};(function(){G.CACHE.roots={};let n=40,r=40;for(let p=2;p<=n;p++)for(let w=2;w<=r;w++){let E=ee(p).pow(w);G.CACHE.roots[`${E}-${w}`]=p}})(),Object.defineProperty(m0,"TIMEOUT",{get:()=>G.TIMEOUT,configurable:!0});let u=null,le=null,mt=null,at=null,Ke=null,ue=null,Se=xe.N=1,Ie=xe.P=2,te=xe.S=3,$e=xe.EX=4,He=xe.FN=5,Be=xe.PL=6,qe=xe.CB=7,Xe=xe.CP=8,De=G.CONST_HASH="#",{PARENTHESIS:J}=G,{SQRT:c}=G,{ABS:d}=G,{FACTORIAL:a}=G,{DOUBLEFACTORIAL:m}=G,v=[],S={},I=[],V=[],F=[];Object.defineProperty(tn,"suppress_errors",{get:()=>G.suppress_errors,configurable:!0}),z1.RESERVED=I,F0.WARNINGS=V,Object.defineProperty(F0,"SHOW_WARNINGS",{get:()=>G.SHOW_WARNINGS,configurable:!0}),Object.defineProperty(W1,"EXPRESSIONS",{get:()=>v,configurable:!0}),Q1.Settings=G,b0._version=t,Object.defineProperty(b0,"C",{get:()=>mt,configurable:!0}),n1.ALLOW_CHARS=G.ALLOW_CHARS,n1.VALIDATION_REGEX=G.VALIDATION_REGEX,nn.PRIMES_SET=se,f0.PRIMES=Ue,f0.PRIMES_SET=se;let L=function(e){return ue(e)?L(e.multiplier.toDecimal()):Number(e)%1!==0};ue=function(e){return e instanceof i};let B=function(e){return e instanceof fe},Q=function(e,n=null,r=null){if(r||={c:[],add(p){this.c.indexOf(p)===-1&&isNaN(p)&&this.c.push(p)}},ue(e)){let{group:p}=e,w=e.previousGroup;if(p===$e&&Q(e.power,n,r),p===Xe||p===qe||w===Xe||w===qe)for(let E in e.symbols)Object.hasOwn(e.symbols,E)&&Q(e.symbols[E],n,r);else if(p===te||w===te)e.value==="e"||e.value==="pi"||e.value===G.IMAGINARY||r.add(e.value);else if(p===Be||w===Be)Q(J0(e.symbols),n,r);else if(p===$e)isNaN(Number(e.value))||r.add(e.value),Q(e.power,n,r);else if(p===He&&!n&&e.args)for(let E=0;E<e.args.length;E++)Q(e.args[E],n,r)}return r.c.sort()},ce=function(e,n){let r=new i(0);for(let p=0;p<e.length;p++){let w=e[p];r=u.add(r,ue(w)?w:u.parse(w))}return n?Number(r):r},pe=function(e,n){e=u.expand(e),n||={};let r=function(p,w){n[p]||=new i(0),n[p]=u.add(n[p],w.clone())};return e.each(p=>{p.isConstant("all")?r("constants",p):p.group===te?r(p.value,p):p.group===He&&(p.fname===d||p.fname==="")?pe(p.args[0]):p.group===$e||p.group===He||r(Q(p).join(" "),p)}),n},Ce=function(e,n){n||=e.length;for(let r=0;r<n;r++)e[r]||(e[r]=new i(0));return e},ae=function(e){return e instanceof M},Re=function(e){return e instanceof C};t1.N=Se,t1.P=Ie,j1.S=te;let et=function(e){return ue(e)?e.multiplier.lessThan(0):e<0},_e=function(e,n,r){let w={},E;for(let _=0;_<r.length;_++)w[r[_]]=new i(Math.floor(Math.random()*5)+1);return Ht("PARSE2NUMBER",()=>{E=u.parse(e,w).equals(u.parse(n,w))}),E},Ve=function(e,n,r){if(!n){let p=typeof e;if(p==="string"){let w=e;if(!/:?=/u.test(w))return!1;let E=G.FUNCTION_REGEX.exec(w);if(!E)return!1;let[,_,Y,P]=E;e=_,n=Y.split(",").map(Z=>Z.trim()),r=P}else if(p==="function"){let w=e,E=w.name;return g0(E),K0(E)?!1:(mt.Math2[E]=w,u.functions[E]=[void 0,w.length],F.includes(E)||F.push(E),!0)}else return!1}return e=e.trim(),g0(e),K0(e)?!1:(n||=Q(u.parse(r)),n=n.map(p=>p.trim()),u.functions[e]=[u.mappedFunction,n.length,{name:e,params:n,body:r}],F.includes(e)||F.push(e),!0)},je=function(){for(let e of F)delete mt.Math2[e],delete u.functions[e]},st=function(e){let n,r,p;if(e.group===He&&e.fname===""?(n=i.unwrapPARENS(u.parse(e).toLinear()),r=u.parse(e.power)):e.group===Ie&&(n=u.parse(e.value),r=u.parse(e.power)),n&&r&&n.group===Se&&r.group===Se&&n.multiplier.isNegative()){p=[];let E=i.toPolarFormArray(Mt(e))[0],_=u.arg(n),Y=r.multiplier.den.toString(),P=r.multiplier.num.toString(),Z="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let K=0;K<Number(Y);K++){let we=Mt(u.parse(Ut("(({0})+2*pi*({1}))/({2})",_,K,Y))).multiplier.toDecimal();p.push(Mt(u.parse(Ut(Z,E,Y,G.IMAGINARY,we,P))))}return M.fromArray(p)}if(e.isConstant(!0,!0)){let w=e.sign(),E=Mt(e.abs()),_=u.sqrt(E);p=[_.clone(),_.negate()],w<0&&(p=p.map(Y=>u.multiply(Y,i.imaginary())))}else p=[u.parse(e)];return M.fromArray(p)},Ge=function(e,n,r){n=String(n);let p,w;if(e.group===Xe){let Y=u.expand(e.clone()).stripVar(n);p=u.subtract(e.clone(),Y.clone()),w=Y}else p=e.clone();let E=p.stripVar(n),_=u.divide(p.clone(),E.clone());return w||=new i(0),r?{a:E,x:_,ax:p,b:w}:[E,_,p,w]},nt=function(e){let r="u",p=0,w=Q(e);for(;!(I.indexOf(r)===-1&&w.indexOf(r)===-1);)r="u"+p++;for(let E=0,_=I.length;E<=_;E++)if(!I[E]){I[E]=r;break}return r};C0.RESERVED=I;let ot=function(e){let n=Q(e[0],null,null);for(let r=1,p=e.length;r<p;r++)n=n.concat(Q(e[r]));return n=c1(n).sort(),n};S1.RESERVED=I,e1.Settings=G;let Le=function(){let e={};for(let n in u.functions)Object.hasOwn(u.functions,n)&&(e[n]=u.functions[n][0]);return e},b=function(e,n,r){let p=[];e.each(w=>{let E,_;w.contains(n)?(E=w.stripVar(n),_=u.divide(w.clone(),E.clone()).power.toDecimal()):(E=w,_=0);let Y=p[_];p[_]=Y?u.add(Y,E):E},!0);for(let w=0;w<p.length;w++)p[w]||=new i(0);return p},X=function(e){if(bt(e)){let n=new M([]);for(let r=0;r<e.length;r++)n.elements.push(X(e[r]));return n}return ue(e)?e:u.parse(e)};Z1.N=Se;let j=function(e){for(let n=0;n<e.length;n++)if(!(e[n].isPi()||e[n].isE())&&!e[n].isConstant(!0))return!1;return!0},x=function(e,n,r){(n.isComposite()&&!e.isComposite()||n.isLinear()&&!e.isLinear())&&([e,n]=[n,e]);let p=new i(0);return e.isLinear()?e.each(w=>{if(n.isComposite())n.isLinear()?n.each(E=>{let _=u.multiply(u.parse(w),u.parse(E)),Y=u.expand(u.parse(_),r);p=u.add(p,Y)},!0):p=u.add(p,u.multiply(w,u.parse(n)));else{let E=u.multiply(u.parse(w),u.parse(n));p=u.add(p,u.expand(E,r))}},!0):p=u.multiply(e,n),p},z={DivisionByZero:f1,ParseError:R1,OutOfFunctionDomainError:p1,UndefinedError:Kt,MaximumIterationsReached:zn,NerdamerTypeError:w1,ParityError:Q0,OperatorError:q0,OutOfRangeError:Wn,DimensionError:h1,InvalidVariableNameError:X1,ValueLimitExceededError:Qn,NerdamerValueError:L1,SolveError:Jn,InfiniteLoopError:Yn,UnexpectedTokenError:U1},U={csc(e){return 1/Math.sin(e)},sec(e){return 1/Math.cos(e)},cot(e){return 1/Math.tan(e)},acsc(e){return Math.asin(1/e)},asec(e){return Math.acos(1/e)},acot(e){return Math.PI/2-Math.atan(e)},erf(e){let n=1/(1+.5*Math.abs(e)),r=1-n*Math.exp(-e*e-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(-.18628806+n*(.27886807+n*(-1.13520398+n*(1.48851587+n*(-.82215223+n*.17087277)))))))));return e>=0?r:-r},diff(e){return function(p){return(e(p+.001)-e(p-.001))/.002}},median(...e){e.sort((r,p)=>r-p);let n=Math.floor(e.length/2);return e.length%2?e[n]:(e[n-1]+e[n])/2},fromContinued(e){let n=e.fractions.slice(),r=1/n.pop();for(let p=0,w=n.length;p<w;p++)r=1/(n.pop()+r);return e.sign*(e.whole+r)},continuedFraction(e,n){n||=20;let r=Math.sign(e),p=Math.abs(e),w=Math.floor(p),E=p-w,_=0,Y=!1,P=1e-14,Z=1e7,K,we,Ee={whole:w,sign:r,fractions:[]};for(;!Y&&E!==0&&(K=1/E,we=Math.floor(K),!(we>Z&&U.fromContinued(Ee)-e<=Number.EPSILON));)Ee.fractions.push(we),E=K-we,(E<=P||_>=n-1)&&(Y=!0),_++;let ye=Ee.fractions.length-1;return Ee.fractions[ye]===1&&(Ee.fractions.pop(),Ee.fractions[--ye]++),Ee},bigpow(e,n){e instanceof We||(e=We.create(e)),n instanceof We||(n=We.create(n));let r=new We(0);if(n.isInteger())r.num=e.num.pow(n.toString()),r.den=e.den.pow(n.toString());else{let p=We.create(e.num**n.num),w=We.create(e.den**n.num);r.num=U.nthroot(p,n.den.toString()),r.den=U.nthroot(w,n.den)}return r},gamma(e){let r=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*U.gamma(1-e));e-=1;let p=r[0];for(let E=1;E<9;E++)p+=r[E]/(e+E);let w=e+7+.5;return Math.sqrt(2*Math.PI)*w**(e+.5)*Math.exp(-w)*p},bigfactorial(e){let n=new ee(1);for(let r=2;r<=e;r++)n=n.times(r);return new We(n)},bigLog(e){let n=l.constants.BIG_LOG_CACHE;if(n[e])return We.quick.apply(null,n[e].split("/"));e=new We(e);let r=80,p=new We(0),w=e.subtract(new We(1)),E=e.add(new We(1));for(let _=0;_<r;_++){let Y=new We(2*_+1),P=U.bigpow(w.divide(E),Y),Z=Y.clone().invert().multiply(P);p=p.add(Z)}return p.multiply(new We(2))},factorial(e){let n=e%1===0;if(n&&e<0)return NaN;if(!n)return U.gamma(e+1);let r=1;for(let p=2;p<=e;p++)r*=p;return r},dfactorial(e){let n=new We(1);if(vt(e)){let r=e%2===0,p=r?e/2:(e+1)/2;if(r)for(let w=1;w<=p;w++)n=n.multiply(new We(2).multiply(new We(w)));else for(let w=1;w<=p;w++)n=n.multiply(new We(2).multiply(new We(w)).subtract(new We(1)))}else n=2**((1+2*e-Math.cos(Math.PI*e))/4)*Math.PI**((Math.cos(Math.PI*e)-1)/4)*U.gamma(1+e/2);return n},GCD(...e){let n=c1(e.map(w=>Math.abs(w))).sort(),r=Math.abs(n.shift()),p=n.length;for(;p-- >0;){let w=Math.abs(n.shift());for(;;){if(r%=w,r===0){r=w;break}if(w%=r,w===0)break}}return r},QGCD(...e){let n=e[0];for(let r=1;r<e.length;r++){let p=e[r],w=n.isNegative()&&p.isNegative()?-1:1;n=p.gcd(n),w<0&&n.negate()}return n},LCM(e,n){return e*n/U.GCD(e,n)},pow(e,n){return e<0&&Math.abs(n)<1?1/n%2===0?NaN:-(Math.abs(e)**n):e**n},factor(e){e=Number(e);let n=Math.sign(e);e=Math.abs(e);let r=U.ifactor(e),p=new i;p.symbols={},p.group=qe;for(let w in r){if(!Object.hasOwn(r,w))continue;let E=new i(1);E.group=Ie,E.value=w;let _=new i(r[w]);E.power=_,p.symbols[w]=E}return p.updateHash(),e===1&&(p=new i(e)),n<0&&p.negate(),p},sfactor(e,n){n||={};let r=Math.floor(Math.sqrt(e)),p=Ue[Ue.length-1];r>p&&e<1e6&&F1(r);let w=Ue.length;for(let E=0;E<w;E++){let _=Ue[E];for(;e%_===0;)e/=_,n[_]=(n[_]||0)+1}return e>1&&(n[e]=1),n},ifactor(e){let n=new ee(e),r=new ee(String(e));if(r.equals(0))return{0:1};let p=r.isNegative()?-1:1;r=r.abs();let w={};if(r.lt("65536"))w=U.sfactor(r,w);else{let E=function(_){_.isPrime()?w[_]=(w[_]||0)+1:w=U.sfactor(_,w)};try{let Y={value:0},P=function(Z,K,we){let Ee=new ee(Z),ye=2,Qe=new ee(Z),be=new ee(1);for(;be.equals(1);){for(let Ze=0;Ze<=ye&&be.equals(1);Ze++){if(we.value++>1e3)throw new Error("stopping");Qe=Qe.pow(2).add(1).mod(K),be=ee.gcd(Qe.minus(Ee).abs(),K)}ye*=2,Ee=Qe}return be.equals(K)?P(Z+1,K,we):be};for(;!r.abs().equals(1);)if(r.isPrime()){E(r);break}else{let Z=P(2,r,Y);E(Z),r=r.divide(Z)}}catch(_){if(_.message==="timeout")throw _;w={},E(n)}}if(p===-1){let E=a1(v1(w));w[`-${E}`]=w[E],delete w[E]}return w},boxfactor(e,n){n||=200;let r,p,w=Math.floor(5/12*e),E=0,_=!1;for(;r=Math.floor(e/w),p=e%w,p!==0;){if(_)return[e,1];w=Math.max(p,w-p),E++,_=E>n}return[r,w,E]},fib(e){let n=Math.sign(e);e=Math.abs(e),n=kt(e)?n:Math.abs(n);let r=0,p=1,w=1;for(let E=2;E<=e;E++)w=r+p,r=p,p=w;return w*n},mod(e,n){return e%n},integer_part(e){return Math.sign(e)*Math.floor(Math.abs(e))},simpson(e,n,r,p){let w=function(Ee,ye,Qe){let be=Ee(ye),Ze=1e-12;return isNaN(be)&&(be=Ee(Qe===1?ye+Ze:ye-Ze)),be};p||=1e-4;let E=Math.abs(Math.floor((r-n)/p));E%2!==0&&E++;let _=(r-n)/E,Y=w(e,n,1),P=!1,Z=n+_,K,we;for(let Ee=1;Ee<E;Ee++)K=P?2:4,we=K*w(e,Z,1),Y+=we,P=!P,Z+=_;return(Y+w(e,Z,2))*(_/3)},num_integrate(e,n,r,p,w){if(w<0)throw new Error("max depth cannot be negative");function E(P,Z,K,we,Ee,ye,Qe,be,Ze,Ye,Fe){if(Fe.nanEncountered)return NaN;let Je=K-Z,ft=P(Z+Je*.25),St=P(K-Je*.25);if(isNaN(ft)){Fe.nanEncountered=!0;return}if(isNaN(St)){Fe.nanEncountered=!0;return}let Rt=Je*(we+4*ft+Ee)/12,n0=Je*(Ee+4*St+ye)/12,Vt=Rt+n0,Yt=(Vt-Qe)/15;if(Fe.maxDepthCount>1e3*Ze)return;if(Ye>Ze)return Fe.maxDepthCount++,Vt+Yt;if(Math.abs(Yt)<be)return Vt+Yt;let jt=Z+Je*.5,l0=E(P,Z,jt,we,ft,Ee,Rt,be*.5,Ze,Ye+1,Fe);if(isNaN(l0))return Fe.nanEncountered=!0,NaN;let ct=E(P,jt,K,Ee,St,ye,n0,be*.5,Ze,Ye+1,Fe);return isNaN(ct)?(Fe.nanEncountered=!0,NaN):l0+ct}function _(P,Z,K,we,Ee){let ye={maxDepthCount:0,nanEncountered:!1};we===void 0&&(we=1e-9),Ee===void 0&&(Ee=45);let Qe=P(Z),be=P(.5*(Z+K)),Ze=P(K),Ye=(Qe+4*be+Ze)*(K-Z)/6,Fe=E(P,Z,K,Qe,be,Ze,Ye,we,Ee,1,ye);if(ye.maxDepthCount>0&&d1(`integrate-adaptive-simpson: Warning: maximum recursion depth (${Ee}) reached ${ye.maxDepthCount} times`),ye.nanEncountered)throw new Error("Function does not converge over interval!");return Fe}let Y;try{Y=_(e,n,r,p,w)}catch(P){if(P.message==="timeout")throw P;return U.simpson(e,n,r)}return v0(Y,12)},Ci(e){let r=.5772156649015329,p=0;for(let w=1;w<20;w++){let E=2*w;p+=(-1)**w*e**E/(E*U.factorial(E))}return Math.log(e)+r+p},Si(e){let r=0;for(let p=0;p<20;p++){let w=2*p;r+=(-1)**p*e**(w+1)/((w+1)*U.factorial(w+1))}return r},Ei(e){if(Number(e)===0)return-1/0;let n=30,r=.5772156649015329,p=0;for(let w=1;w<n;w++)p+=e**w/(w*U.factorial(w));return r+Math.abs(Math.log(e))+p},Shi(e){let r=0,p,w;for(let E=0;E<30;E++)p=2*E,w=p+1,r+=e**w/(w*w*U.factorial(p));return r},Chi(e){let r=.5772156649015329,p=function(w){return(Math.cosh(w)-1)/w};return Math.log(e)+r+U.num_integrate(p,.002,e,.001)},Li(e){return U.Ei(U.bigLog(e))},gamma_incomplete(e,n){let r=e-1,p=0,w=n||0;for(let E=0;E<r;E++)p+=w**E/U.factorial(E);return U.factorial(r)*Math.exp(-w)*p},step(e){return e>0?1:e<0?0:.5},rect(e){let n=Math.abs(e);return n===.5?n:n>.5?0:1},sinc(e){return e.equals(0)?1:Math.sin(e)/e},tri(e){return e=Math.abs(e),e>=1?0:1-e},nthroot(e,n){if(e instanceof We||(e=new We(e.toString())),n instanceof We||(n=new We(n.toString())),n.equals(1))return e;let r=e.divide(new We(2)),p=new We(1e-15),w,E,_,Y=n.clone().invert(),P=n.subtract(new We(1));do{let Z=U.bigpow(r,P),K=Y.multiply(e.divide(Z).subtract(r)).toDecimal(25);if(w=We.create(K),_)break;r=r.add(w),K=w.toDecimal(),_=E?E===K:!1,E=K}while(w.abs().gte(p));return r},sqrt(e){e instanceof We||(e=new We(e));let n,r,p,w,E=0,_=!1,Y=new We(1e-20);n=e.divide(new We(2));let P=1e3;do{if(E>P)throw new Error(`Unable to calculate square root for ${e}`);n=n.add(e.divide(n)).divide(new We(2)),n=new We(n.decimal(30)),r=e.subtract(n.multiply(n)),w=p?p.equals(r):!1,(r.clone().abs().lessThan(Y)||w)&&(_=!0),p=r,E++}while(!_);return n}};G.FUNCTION_MODULES.push(U),Y0(U),Math.sign||=function(n){return n=Number(n),n===0||isNaN(n)?n:n>0?1:-1},Math.cosh||=function(n){let r=Math.exp(n);return(r+1/r)/2},Math.sech||=function(n){return 1/Math.cosh(n)},Math.csch||=function(n){return 1/Math.sinh(n)},Math.coth||=function(n){return 1/Math.tanh(n)},Math.sinh||=function(n){let r=Math.exp(n);return(r-1/r)/2},Math.tanh||=function(n){if(n===1/0)return 1;if(n===-1/0)return-1;let r=Math.exp(2*n);return(r-1)/(r+1)},Math.asinh||=function(n){return n===-1/0?n:Math.log(n+Math.sqrt(n*n+1))},Math.acosh||=function(n){return Math.log(n+Math.sqrt(n*n-1))},Math.atanh||=function(n){return Math.log((1+n)/(1-n))/2},Math.trunc||=function(n){return isNaN(n)?NaN:n>0?Math.floor(n):Math.ceil(n)};function q(e,n=void 0,r=void 0,p=void 0){let w=n==="hash",E,_=w?void 0:n,Y=_==="decimal"||_==="decimals"||_==="decimals_or_scientific";_==="decimals_or_scientific"&&typeof p>"u"&&(p=G.DEFAULT_DECP);function P(Z,K){switch(n){case"decimals":case"decimal":return E||=function(we){return!1},K?Z.toDecimal(K):Z.valueOf();case"recurring":{E||=function(Rt){return Rt.indexOf("'")!==-1};let we=Z.toString(),Ee=/^-?\d+(?:\/\d+)?$/u.exec(we);if(Ee.length===0)return we;let ye=Ee[0].split("/"),Qe=!1,be=Number(ye[0]);be<0&&(be=-be,Qe=!0);let Ze=Number(ye[1]);Ze||=1;let Ye=Math.floor(be/Ze),Fe=10*(be-Ye*Ze);for(Ye=`${Ye.toString()}.`;Fe&&Fe<Ze;)Fe*=10,Ye+="0";let Je="",ft=[],St=0;for(;;){if(typeof ft[Fe]<"u"){let Vt=Je.slice(0,ft[Fe]),Yt=Je.slice(ft[Fe]),jt=`${Ye+Vt}'${Yt}'`;return(Qe?"-":"")+jt.replace("'0'","").replace(/\.$/u,"")}let Rt=Math.floor(Fe/Ze),n0=Fe-Rt*Ze;ft[Fe]=St,Je+=Rt.toString(),St+=1,Fe=10*n0}}case"mixed":{E||=function(ft){return ft.indexOf("/")!==-1};let we=Z.toString(),Ee=/^-?\d+(?:\/\d+)?$/u.exec(we);if(Ee.length===0)return we;let ye=Ee[0].split("/"),Qe=new ee(ye[0]),be=new ee(ye[1]);be.equals(0)&&(be=new ee(1));let Ze=Qe.divmod(be),{quotient:Ye}=Ze,{remainder:Fe}=Ze,Je=ye[0][0]==="-"||Ye.equals(0)||Fe.equals(0)?"":"+";return(Ye.equals(0)?"":Ye.toString())+Je+(Fe.equals(0)?"":`${Fe.toString()}/${ye[1]}`)}case"scientific":return E||=function(we){return!1},new Bt(Z.valueOf()).toString(G.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{E||=function(ye){return!1};let we=Z.valueOf(),Ee=new Bt(we);return Math.abs(Ee.exponent)>=G.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?Ee.toString(G.SCIENTIFIC_MAX_DECIMAL_PLACES):K?Z.toDecimal(K):we}default:return E||=function(we){return we.indexOf("/")!==-1},Z.toString()}}if(ue(e)){let Z="",K="",we="",Ee=e.group||r,{value:ye}=e;if(!w){let Fe=P(e.multiplier);String(Fe)==="-1"&&String(e.multiplier)==="-1"&&(we="-",Fe="1"),String(Fe)!=="1"&&(Z=Fe);let Je=e.power?P(e.power):"";String(Je)!=="1"&&(ue(Je)?K=q(Je,_):K=Je)}switch(Ee){case Se:{Z="";let Fe;_==="decimals_or_scientific"?Fe=P(e.multiplier,p):p&&Y?Fe=e.multiplier.toDecimal(p):Fe=P(e.multiplier),ye=String(e.multiplier)==="-1"?"1":Fe,K="";break}case Be:ye=e.collectSymbols().map(Fe=>{let Je=q(Fe,_,r,p);return Je==="0"&&(Je=""),Je}).sort().join("+").replace(/\+-/gu,"-");break;case Xe:ye=e.collectSymbols().map(Fe=>{let Je=q(Fe,_,r,p);return Je==="0"&&(Je=""),Je}).sort().join("+").replace(/\+-/gu,"-");break;case qe:ye=e.collectSymbols(Fe=>{let Je=Fe.group;return(Je===Be||Je===Xe)&&Fe.power.equals(1)&&Fe.multiplier.equals(1)?qt(q(Fe,_)):q(Fe,_)}).join("*");break;case $e:{let Fe=e.previousGroup,Je=e.power.group;Fe===Be&&(ye=e.collectSymbols(q,_).join("+").replace("+-","-")),!(Fe===Se||Fe===te||Fe===He)&&!w&&(ye=qt(ye)),(Je===Xe||Je===qe||Je===Be||e.power.multiplier.toString()!=="1")&&K&&(K=qt(K));break}}if(Ee===He&&(ye=e.fname+qt(e.args.map(Fe=>q(Fe,_)).join(","))),Ee===He&&e.fname in ge){let Fe=q(e.args[0]),Je=q(e.args[1]);e.args[0].isComposite()&&(Fe=qt(Fe)),e.args[1].isComposite()&&(Je=qt(Je)),ye=Fe+ge[e.fname]+Je}let Qe=typeof E=="function"?E(K):!1;if(K&&Ee!==$e&&Qe&&(K=qt(K)),((Ee===Xe||Ee===Be)&&(Z&&String(Z)!=="1"||we==="-")||(Ee===qe||Ee===Xe||Ee===Be)&&K&&String(K)!=="1"||!w&&Ee===Ie&&String(ye)==="-1"||e.fname===J)&&(ye=qt(ye)),p&&(n==="decimal"||(n==="decimals"||n==="decimals_or_scientific")&&Z))if(Z.toString().includes("e")){if(n!=="decimals_or_scientific"){let Fe=Number(Z),Je=Fe.toExponential(),ft=Fe.toPrecision(p);Z=Je.length<ft.length?Je:ft}}else Z=v0(Number(Z),p);let be=we+Z,Ze=typeof E=="function"?E(Z):!1;if(Z&&Ze&&(be=qt(be)),Number(K)<0&&(K=qt(K)),Z&&(be=`${be}*`),K){if(ye==="e"&&G.E_TO_EXP)return`${be}exp${qt(K)}`;K=G.POWER_OPERATOR+K}Ee===$e&&ye.charAt(0)==="-"&&(ye=qt(ye));let Ye=be+ye;return e.parens&&(Ye=qt(Ye)),Ye+K}if(ae(e)){let Z=e.elements.length,K=[];for(let we=0;we<Z;we++)K.push(e.elements[we].text(n));return`[${K.join(",")}]`}try{return e.toString()}catch(Z){if(Z.message==="timeout")throw Z;return""}}function fe(e){this.symbol=e}fe.getExpression=function(n,r=void 0){(n==="last"||!n)&&(n=v.length),n==="first"&&(n=1);let p=Number(n)-1,w=v[p];return w&&new fe(w)},fe.prototype={text(e="decimals",n=void 0){n||=G.EXPRESSION_DECP;let r=this.symbol;return r.text_?r.text_(e):q(this.symbol,e,void 0,n)},latex(e){return this.symbol.latex?this.symbol.latex(e):le.latex(this.symbol,e)},valueOf(){return this.symbol.valueOf()},evaluate(...e){if(ae(this.symbol)&&this.symbol.dimensions()===0)return this;let n=e[0],r,p=1;typeof n=="string"?r=n.charAt(0)==="%"?fe.getExpression(n.substr(1)).text():n:n instanceof fe||ue(n)?r=n.text():(r=this.symbol.text(),p--);let w=e[p]||{};return new fe(Ht("PARSE2NUMBER",()=>u.parse(r,w),!0))},buildFunction(e){return Ke.build(this.symbol,e)},isNumber(){return _0(this.symbol)},isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0},isImaginary(){return Mt(u.parse(this.symbol)).isImaginary()},variables(){return Q(this.symbol)},toString(){try{return bt(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(e){if(e.message==="timeout")throw e;return""}},toDecimal(e){G.precision=e;let n=q(this.symbol,"decimals");return G.precision=void 0,n},isFraction(){return L(this.symbol)},isPolynomial(){return this.symbol.isPoly()},sub(e,n){return new fe(this.symbol.sub(u.parse(e),u.parse(n)))},operation(e,n){return B(n)?n=n.symbol:ue(n)||(n=u.parse(n)),new fe(u[e](this.symbol.clone(),n.clone()))},add(e){return this.operation("add",e)},subtract(e){return this.operation("subtract",e)},multiply(e){return this.operation("multiply",e)},divide(e){return this.operation("divide",e)},pow(e){return this.operation("pow",e)},expand(){return new fe(u.expand(this.symbol))},each(e,n){if(this.symbol.each)this.symbol.each(e,n);else if(bt(this.symbol))for(let r=0;r<this.symbol.length;r++)e.call(this.symbol,this.symbol[r],r);else e.call(this.symbol)},eq(e){ue(e)||(e=u.parse(e));try{return u.subtract(this.symbol.clone(),e).equals(0)}catch(n){if(n.message==="timeout")throw n;return!1}},lt(e){ue(e)||(e=u.parse(e));try{return Mt(u.subtract(this.symbol.clone(),e)).lessThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gt(e){ue(e)||(e=u.parse(e));try{return Mt(u.subtract(this.symbol.clone(),e)).greaterThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gte(e){return this.gt(e)||this.eq(e)},lte(e){return this.lt(e)||this.eq(e)},numerator(){return new fe(this.symbol.getNum())},denominator(){return new fe(this.symbol.getDenom())},hasFunction(e){return this.symbol.containsFunction(e)},contains(e){return this.symbol.contains(e)}},fe.prototype.toTeX=fe.prototype.latex,Ot.bigInt=ee,Ot.bigDec=de,Ot.isInt=vt,Ot.scientificToDecimal=k0,Ot.DivisionByZero=f1,Ot.Settings=G;function i(e){r1();let n=e==="Infinity";if(!(this instanceof i))return new i(e);typeof e=="object"&&e!==null&&e instanceof de&&(e=e.toString());let r=String(e);return/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(r)||typeof e=="object"&&e!==null&&e instanceof de?(this.group=Se,this.value=De,this.multiplier=new We(e)):(this.group=te,g0(e),this.value=e,this.multiplier=new We(1),this.imaginary=e===G.IMAGINARY,this.isInfinity=n),this.power=new We(1),this.args=void 0,this.fname=void 0,this.isImgSymbol=void 0,this}i.imaginary=function(){let n=new i(G.IMAGINARY);return n.imaginary=!0,n},i.infinity=function(n=void 0){let r=new i("Infinity");return n===-1&&r.negate(),r},i.shell=function(n,r){let p=new i(r);return p.group=n,p.symbols={},p.length=0,p},i.unwrapSQRT=function(n,r){let p=n.power;if(n.fname===c&&(n.isLinear()||r)){let w=n.args[0].clone();w.power=w.power.multiply(new We(1/2)),w.multiplier=w.multiplier.multiply(n.multiplier),n=w,r&&(n.power=p.multiply(new We(1/2)))}return n},i.hyp=function(n,r){return n||=new i(0),r||=new i(0),u.sqrt(u.add(u.pow(n.clone(),new i(2)),u.pow(r.clone(),new i(2))))},i.toPolarFormArray=function(n){let r=n.realpart(),p=n.imagpart(),w=i.hyp(r,p),E=r.equals(0)?u.parse("pi/2"):u.trig.atan(u.divide(p,r));return[w,E]},i.unwrapPARENS=function(n){if(n.fname===""){let r=n.args[0];return r.power=r.power.multiply(n.power),r.multiplier=r.multiplier.multiply(n.multiplier),n.fname===""?i.unwrapPARENS(r):r}return n},i.create=function(n,r){return r=r===void 0?1:r,u.parse(`(${n})^(${r})`)},i.prototype={pushMinus(){let e=this;if((this.group===qe||this.group===Xe||this.group===Be)&&this.multiplier.lessThan(0)&&!kt(this.power)){e=this.clone();let n=e.multiplier.clone();n.negate(),e.toUnitMultiplier();for(let r in e.symbols)if(Object.hasOwn(e.symbols,r)&&(e.symbols[r]=e.symbols[r].clone().negate(),e.group===qe))break;e.length>0&&e.each(r=>r.pushMinus()),e=u.parse(e),e=u.multiply(u.parse(n),e)}return e},getNth(e){let n=Mt(u.pow(u.parse(this.multiplier),u.parse(String(e)).invert())),r=u.parse(v0(n));return Mt(u.pow(r,u.parse(String(e)))).equals(u.parse(this.multiplier))?r:n},isToNth(e){let n=this.getNth(e),r=vt(n),p;return this.group===qe?(p=!0,this.each(w=>{w.isToNth(e)||(p=!1)})):p=this.group===Se?!0:vt(u.divide(u.parse(this.power),u.parse(e))),r&&p},isSquare(){return this.isToNth(2)},isCube(){return this.isToNth(3)},isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)},powSimp(){if(this.group===qe){let e=[],n=this.multiplier.sign();if(this.each(Z=>{let K=Z.power;ue(K)||K.equals(1)||e.push(K)}),e.length===0)return this.clone();let r=new We(a1(e)),p=this.multiplier.clone().abs(),w=U.ifactor(p.valueOf()),E=new We(1),_=new We(1);for(let Z in w){if(!Object.hasOwn(w,Z))continue;let K=new We(w[Z]);K.lessThan(r)||(K=K.divide(r).subtract(new We(1)),_=_.multiply(new We(Z))),E=E.multiply(u.parse(`${qt(Z)}^${qt(K)}`).multiplier)}let Y=new i(_);this.each(Z=>{Z=Z.clone(),Z.power=Z.power.divide(r),Y=u.multiply(Y,Z)});let P=u.symfunction(J,[Y]);return P.power=r,P.multiplier=n<0?E.negate():E,P}return this.clone()},equals(e){let n;return ue(e)?n=e:n=new i(e),this.value===n.value&&this.power.equals(n.power)&&this.multiplier.equals(n.multiplier)&&this.group===n.group},abs(){let e=this.clone();return e.multiplier.abs(),e},gt(e){return ue(e)||(e=new i(e)),this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)},gte(e){return ue(e)||(e=new i(e)),this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)},lt(e){return ue(e)||(e=new i(e)),this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)},lte(e){return ue(e)||(e=new i(e)),this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)},isPoly(e=!1){let n=this.group,r=this.power;if(!vt(r)||Number(r)<0)return!1;if(n===Se||n===te||this.isConstant(!0))return!0;let p=Q(this);if(n===qe&&p.length===1){let w=p[0];if(!w)return!0;for(let E in this.symbols){if(!Object.hasOwn(this.symbols,E))continue;let _=this.symbols[E];if(_.group===He&&!_.args[0].isConstant()||!_.contains(w)&&!_.isConstant(!0))return!1}return!0}if(this.isComposite()||n===qe&&e){if(!e&&p.length>1)return!1;for(let w in this.symbols)if(!this.symbols[w].isPoly(e))return!1;return!0}return!1},stripVar(e,n=!1){let r;return(this.group===Be||this.group===te)&&this.value===e?r=new i(n?0:this.multiplier):this.group===qe&&this.isLinear()?(r=new i(1),this.each(p=>{p.contains(e,!0)||(r=u.multiply(r,p.clone()))}),r.multiplier=r.multiplier.multiply(this.multiplier)):this.group===Xe&&!this.isLinear()?r=new i(this.multiplier):this.group===Xe&&this.isLinear()?(r=new i(0),this.each(p=>{if(!p.contains(e)){let w=p.clone();w.multiplier=w.multiplier.multiply(this.multiplier),r=u.add(r,w)}}),r.equals(0)&&(r=new i(this.multiplier))):this.group===$e&&this.power.contains(e,!0)?r=new i(this.multiplier):this.group===He&&this.contains(e)?r=new i(this.multiplier):r=this.clone(),r},toArray(e,n){n||={arr:[],add(p,w){let E=this.arr[w];this.arr[w]=E?u.add(E,p):p}};let r=this.group;if(r===te&&this.contains(e))n.add(new i(this.multiplier),this.power);else if(r===qe){let p=this.stripVar(e),w=u.divide(this.clone(),p.clone()),E=w.isConstant()?0:w.power;n.add(p,E)}else if(r===Be&&this.value===e)this.each((p,w)=>{n.add(p.stripVar(e),w)});else if(r===Xe)this.each(p=>{p.toArray(e,n)});else{if(this.contains(e))throw new w1("Cannot convert to array! Exiting");n.add(this.clone(),0)}n=n.arr;for(let p=0;p<n.length;p++)n[p]||=new i(0);return n},hasFunc(e){let n=this.group===He||this.group===$e;if(n&&!e||n&&this.contains(e))return!0;if(this.symbols){for(let r in this.symbols)if(this.symbols[r].hasFunc(e))return!0}return!1},sub(e,n){e=ue(e)?e.clone():u.parse(e),n=ue(n)?n.clone():u.parse(n),(e.group===Se||e.group===Ie)&&Ft("Cannot substitute a number. Must be a variable");let r=!1,p=e.multiplier.equals(1),w=this.multiplier.clone(),E;if(this.value===e.value&&(this.group!==Be&&e.group!==Be||this.group===Be&&e.group===Be))(p||e.multiplier.equals(this.multiplier))&&(e.isLinear()?E=n:e.power.equals(this.power)&&(E=n,r=!0),e.multiplier.equals(this.multiplier)&&(w=new We(1)));else if(this.group===qe||this.previousGroup===qe)E=new i(1),this.each(_=>{let Y=u.parse(_.sub(e,n));E=u.multiply(E,Y)});else if(this.isComposite()){let _=this.clone();if(e.isComposite()&&_.isComposite()&&_.isLinear()&&e.isLinear()){let Y=function(P,Z){for(let K in P.symbols){if(!Object.hasOwn(P.symbols,K))continue;let we=P.symbols[K];if(we.isComposite()&&Y(we,Z)||we.equals(Z))return!0}return!1};for(let P in e.symbols)if(Object.hasOwn(e.symbols,P)&&!Y(_,e.symbols[P]))return _.clone();E=u.add(u.subtract(_.clone(),e),n)}else E=new i(0),_.each(Y=>{E=u.add(E,Y.sub(e,n))})}else if(this.group===$e)E=u.parse(this.value).sub(e,n);else if(this.group===He){let _=[];for(let Y=0;Y<this.args.length;Y++){let P=this.args[Y];ue(P)||(P=u.parse(P)),_.push(P.sub(e,n))}E=u.symfunction(this.fname,_)}if(E){if(!r){let _=this.group===$e?this.power.sub(e,n):u.parse(this.power);E=u.pow(E,_)}return E.multiplier=E.multiplier.multiply(w),E}return this.clone()},isMonomial(){if(this.group===te)return!0;if(this.group===qe){for(let e in this.symbols)if(this.symbols[e].group!==te)return!1}else return!1;return!0},isPi(){return this.group===te&&this.value==="pi"},sign(){return this.multiplier.sign()},isE(){return this.value==="e"},isSQRT(){return this.fname===c},isConstant(e,n){if(n&&this.group===qe){for(let r in this.symbols)if(this.symbols[r].isConstant(!0))return!0}if(e==="functions"&&this.isComposite()){let r=!0;return this.each(p=>{p.isConstant(e,n)||(r=!1)},!0),r}if(e==="all"&&(this.isPi()||this.isE()))return!0;if(e&&this.group===He){for(let r=0;r<this.args.length;r++)if(!this.args[r].isConstant(e))return!1;return!0}return e?_0(this):this.value===De},isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let e in this.symbols)if(this.symbols[e].isImaginary())return!0}return!1},realpart(){if(this.isConstant())return this.clone();if(this.imaginary)return new i(0);if(this.isComposite()){let e=new i(0);return this.each(n=>{e=u.add(e,n.realpart())}),e}return this.isImaginary()?new i(0):this.clone()},imagpart(){if(this.group===te&&this.isImaginary()){let e=this;return this.power.isNegative()&&(e=this.clone(),e.power.negate(),e.multiplier.negate()),new i(e.multiplier)}if(this.isComposite()){let e=new i(0);return this.each(n=>{e=u.add(e,n.imagpart())}),e}return this.group===qe?this.stripVar(G.IMAGINARY):new i(0)},isInteger(){return this.isConstant()&&this.multiplier.isInteger()},isLinear(e){if(e){if(this.isConstant()||!this.contains(e,!0))return!0;if(this.group===te)return this.value===e?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let n in this.symbols)if(!this.symbols[n].isLinear(e))return!1;return!0}return this.group===qe?this.symbols[e]?this.symbols[e].isLinear(e):!0:!1}return this.power.equals(1)},containsFunction(e){if(typeof e=="string"&&(e=[e]),this.group===He&&e.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let n in this.symbols)if(this.symbols[n].containsFunction(e))return!0}return!1},multiplyPower(e){if(this.group===Se&&this.multiplier.equals(1))return this;let n=this.power;if(this.group!==$e&&ue(e)&&e.group===Se){let r=e.multiplier;this.group===Se&&!r.isInteger()&&this.convert(Ie),this.power=n.equals(1)?r.clone():n.multiply(r),this.group===Ie&&vt(this.power)&&(this.value=Number(this.value)**Number(this.power),this.toLinear(),this.convert(Se))}else{this.group!==$e&&(n=new i(n),this.convert($e));let r=u.multiply(n,e);this.power=r}return this},setPower(e,n=!1){if(this.group===Se&&this.multiplier.equals(1))return this;if(this.group===$e&&!ue(e))this.group=this.previousGroup,delete this.previousGroup,this.group===Se?(this.multiplier=new We(this.value),this.value=De):this.power=e;else{let r=!1;ue(e)&&(e.group===Se?e=e.multiplier:r=!0);let p=r?$e:Ie;this.power=e,this.group===Se&&p&&this.convert(p,n)}return this},isInverse(){return this.group===$e?this.power.multiplier.lessThan(0):Number(this.power)<0},clone(e=void 0){let n=this,r=e||new i(0),p=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],w=p.length,E;if(n.symbols){r.symbols={};for(let _ in n.symbols)Object.hasOwn(n.symbols,_)&&(r.symbols[_]=n.symbols[_].clone())}for(E=0;E<w;E++)n[p[E]]!==void 0&&(r[p[E]]=n[p[E]]);return r.power=n.power.clone(),r.multiplier=n.multiplier.clone(),n.isConversion&&(r.isConversion=n.isConversion),n.isUnit&&(r.isUnit=n.isUnit),r},toUnitMultiplier(e=!1){return this.multiplier.num=new ee(this.multiplier.num.isNegative()&&e?-1:1),this.multiplier.den=new ee(1),this},toLinear(){return this.power.equals(1)?this:(this.setPower(new We(1)),this)},each(e,n=!1){if(this.symbols)for(let r in this.symbols){if(!Object.hasOwn(this.symbols,r))continue;let p=this.symbols[r];if(p.group===Be&&n)for(let w in p.symbols)Object.hasOwn(p.symbols,w)&&e.call(r,p.symbols[w],w);else e.call(this,p,r)}else e.call(this,this,this.value)},valueOf(){return this.group===Se?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:q(this,"decimals")},contains(e,n=!1){e=String(e);let r=this.group;if(this.value===e)return!0;if(this.symbols){for(let p in this.symbols)if(this.symbols[p].contains(e,n))return!0}if(r===He||this.previousGroup===He){for(let p=0;p<this.args.length;p++)if(this.args[p].contains(e,n))return!0}return r===$e&&(n&&this.power.contains(e,n)||this.value===e)?!0:this.value===e},negate(){return this.multiplier.negate(),(this.group===Xe||this.group===Be)&&this.distributeMultiplier(),this},invert(e=!1,n=!1){return e||(this.multiplier=this.multiplier.invert()),ue(this.power)?this.power.negate():this.group===qe&&n?this.each(r=>r.invert()):this.power&&this.group!==Se&&this.power.negate(),this},distributeMultiplier(e=!1){let n=e?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&n&&this.group!==qe&&!this.multiplier.equals(1)){for(let r in this.symbols){if(!Object.hasOwn(this.symbols,r))continue;let p=this.symbols[r];p.multiplier=p.multiplier.multiply(this.multiplier),p.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent(){if(!this.power.equals(1)){let e=this.power;for(let n in this.symbols){if(!Object.hasOwn(this.symbols,n))continue;let r=this.symbols[n];r.group===$e?r.power=u.multiply(r.power,new i(e)):ue(this.symbols[n].power)?this.symbols[n].power=u.multiply(this.symbols[n].power,new i(e)):this.symbols[n].power=this.symbols[n].power.multiply(e)}this.toLinear()}return this},convert(e,n=void 0){if(e>He){let r=this.clone();this.symbols={},e===qe?r.toUnitMultiplier():this.toUnitMultiplier(),this.group===He&&(r.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[r.keyForGroup(e)]=r,this.group=e,this.length=1}else if(e===$e)this.group===Se&&this.multiplier.equals(1)||(this.group!==$e&&(this.previousGroup=this.group),this.group===Se?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=q(this,"hash"),this.group=$e);else if(e===Se){let r=this.multiplier.toDecimal();this.symbols&&=void 0,new i(this.group===Ie?Number(r)*Number(this.value)**Number(this.power):r).clone(this)}else e===Ie&&this.group===Se&&(this.value=n?this.multiplier.num.toString():Math.abs(Number(this.multiplier.num.toString())),this.toUnitMultiplier(!n),this.group=Ie);return this},insert(e,n){if(ue(e)||Ft(`Object ${e} is not of type NerdamerSymbol!`),this.symbols){let{group:r}=this;if(r>He){let p=e.keyForGroup(r),w=p in this.symbols?this.symbols[p]:!1;if(n==="add"){let E=p;w?(this.symbols[E]=u.add(w,e),this.symbols[E].multiplier.equals(0)&&(delete this.symbols[E],this.length--,this.length===0&&(this.convert(Se),this.multiplier=new We(0)))):(this.symbols[p]=e,this.length++)}else e.group===Ie&&vt(e.power)&&e.convert(Se),e.group===$e?(e.parens=e.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(e.multiplier.clone().abs()),e.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(e.multiplier),e.toUnitMultiplier()),w&&(e=u.multiply(S0(this.symbols,p),e),e.isConstant()&&(this.multiplier=this.multiplier.multiply(e.multiplier),e=new i(1)),this.length--),e.isOne(!0)?e.multiplier.lessThan(0)&&this.negate():(this.symbols[p]=e,this.length++);this.length===0&&this.convert(Se),(this.group===Xe||this.group===qe)&&this.updateHash()}}return this},attach(e){if(bt(e)){for(let n=0;n<e.length;n++)this.insert(e[n],"add");return this}return this.insert(e,"add")},combine(e){if(bt(e)){for(let n=0;n<e.length;n++)this.insert(e[n],"multiply");return this}return this.insert(e,"multiply")},updateHash(){if(this.group!==Se)if(this.group===He){let e="",{args:n}=this,r=this.fname===J;for(let w=0;w<n.length;w++)e+=(w===0?"":",")+q(n[w]);let p=r?"":this.fname;this.value=p+(r?e:qt(e))}else this.group===te||this.group===Be||(this.value=q(this,"hash"))},keyForGroup(e){let n=this.group,r;if(n===Se)r=this.value;else if(n===te||n===Ie)e===Be?r=this.power.toDecimal():r=this.value;else if(n===He)e===Be?r=this.power.toDecimal():r=q(this,"hash");else{if(n===Be)return e===qe?r=q(this,"hash"):e===Xe?this.power.equals(1)?r=this.value:r=qt(q(this,"hash"))+G.POWER_OPERATOR+this.power.toDecimal():e===Be?r=this.power.toString():r=this.value,r;n===Xe?(e===Xe&&(r=q(this,"hash")),e===Be?r=this.power.toDecimal():r=this.value):n===qe?e===Be?r=this.power.toDecimal():r=q(this,"hash"):n===$e&&(e===Be?r=q(this.power):r=q(this,"hash"))}return r},collectSymbols(e,n,r,p){let w=[];if(this.symbols)for(let E in this.symbols){if(!Object.hasOwn(this.symbols,E))continue;let _=this.symbols[E];p&&(_.group===Be||_.group===Xe)?w=w.concat(_.collectSymbols()):w.push(e?e(_,n):_)}else w.push(this);return r===null&&(r=void 0),w.sort(r)},collectSummandSymbols(e,n,r,p){let w=[];if(!this.symbols||this.group===qe)w.push(this);else for(let E in this.symbols){if(!Object.hasOwn(this.symbols,E))continue;let _=this.symbols[E];p&&(_.group===Be||_.group===Xe)?w=w.concat(_.collectSymbols()):w.push(e?e(_,n):_)}return r===null&&(r=void 0),w.sort(r)},latex(e){return le.latex(this,e)},text(e=void 0){return q(this,e)},isOne(e=!1){let n=e?"absEquals":"equals";return this.group===Se?this.multiplier[n](1):this.power.equals(0)},isComposite(){let e=this.group,n=this.previousGroup;return e===Xe||e===Be||n===Be||n===Xe},isCombination(){let e=this.group,n=this.previousGroup;return e===qe||n===qe},lessThan(e){return this.multiplier.lessThan(e)},greaterThan(e){return ue(e)||(e=new i(e)),!this.isConstant(!0)||!e.isConstant(!0)?!1:this.multiplier.greaterThan(e.multiplier)},getDenom(){let e,n;if(n=this.clone(),this.group===qe&&this.power.lessThan(0)&&(n=u.expand(n)),n.power.lessThan(0)||n.group===$e&&n.power.multiplier.lessThan(0)){let r=u.parse(n.multiplier.den);e=n.toUnitMultiplier(),e.power.negate(),e=u.multiply(r,e)}else if(n.group===qe){e=u.parse(n.multiplier.den);for(let r in n.symbols){if(!Object.hasOwn(n.symbols,r))continue;let p=n.symbols[r];(Number(p.power)<0||p.group===$e&&p.power.multiplier.lessThan(0))&&(e=u.multiply(e,n.symbols[r].clone().invert()))}}else e=u.parse(n.multiplier.den);return e},getNum(){let e,n;return n=this.clone(),n.group===qe&&n.power.lessThan(0)&&(n=u.expand(n)),n.power.greaterThan(0)&&n.group!==qe||n.group===$e&&n.power.multiplier.greaterThan(0)?e=u.multiply(u.parse(n.multiplier.num),n.toUnitMultiplier()):n.group===qe?(e=u.parse(n.multiplier.num),n.each(r=>{(Number(r.power)>0||r.group===$e&&r.power.multiplier.greaterThan(0))&&(e=u.multiply(e,r.clone()))})):e=u.parse(n.multiplier.num),e},toString(){return this.text()}};function h(){let e=this,n={},r={names:[],actions:[]};function p(o,s){this.start=o,this.end=s}p.prototype.isConstant=function(){return this.start.isConstant()&&this.end.isConstant()},p.prototype.text=function(){return`${q(this.start)}:${q(this.end)}`};function w(o,s,f){if(this.type=s,this.value=o,f!==void 0&&(this.column=f+1),s===w.OPERATOR){let k=P[o];for(let $ in k)Object.hasOwn(k,$)&&(this[$]=k[$])}else s===w.FUNCTION&&(this.precedence=w.MAX_PRECEDENCE,this.leftAssoc=!1)}w.prototype.toString=function(){return this.is_prefix?`\`${this.value}`:this.value},w.OPERATOR="OPERATOR",w.VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL",w.FUNCTION="FUNCTION",w.UNIT="UNIT",w.KEYWORD="KEYWORD",w.MAX_PRECEDENCE=999,this.classes={Collection:$t,Slice:p,Token:w};let E={prec:void 0,cos(o,s){let f=u.parse(String(Math.cos(o)*Math.cosh(s))),k=u.parse(String(Math.sin(o)*Math.sinh(s)));return u.subtract(f,u.multiply(k,i.imaginary()))},sin(o,s){let f=u.parse(String(Math.sin(o)*Math.cosh(s))),k=u.parse(String(Math.cos(o)*Math.sinh(s)));return u.subtract(f,u.multiply(k,i.imaginary()))},tan(o,s){let f=u.parse(String(Math.sin(2*o)/(Math.cos(2*o)+Math.cosh(2*s)))),k=u.parse(String(Math.sinh(2*s)/(Math.cos(2*o)+Math.cosh(2*s))));return u.add(f,u.multiply(k,i.imaginary()))},sec(o,s){let f=this.removeDen(this.cos(o,s));return u.subtract(f[0],u.multiply(f[1],i.imaginary()))},csc(o,s){let f=this.removeDen(this.sin(o,s));return u.add(f[0],u.multiply(f[1],i.imaginary()))},cot(o,s){let f=this.removeDen(this.tan(o,s));return u.subtract(f[0],u.multiply(f[1],i.imaginary()))},acos(o,s){let f=this.fromArray([o,s]),k=u.pow(f.clone(),new i(2)),$=u.expand(k),he=u.multiply(g(u.subtract(new i(1),$)),i.imaginary()),ie=u.expand(u.add(f.clone(),he)),ne=Nt(ie);return u.expand(u.multiply(i.imaginary().negate(),ne))},asin(o,s){return u.subtract(u.parse("pi/2"),this.acos(o,s))},atan(o,s){if(o.equals(0)&&(s.equals(1)||s.equals(-1)))return u.parse(`${i.infinity()}*${G.IMAGINARY}*${s}`);let f=E.fromArray([o,s]),k=u.expand(u.multiply(i.imaginary(),f.clone())),$=Nt(u.expand(u.subtract(new i(1),k.clone()))),he=Nt(u.expand(u.add(new i(1),k.clone())));return u.expand(u.multiply(u.divide(i.imaginary(),new i(2)),u.subtract($,he)))},asec(o,s){let f=this.removeDen([o,s]);return f[1].negate(),this.acos(...f)},acsc(o,s){let f=this.removeDen([o,s]);return f[1].negate(),this.asin(...f)},acot(o,s){let f=this.removeDen([o,s]);return f[1].negate(),this.atan(...f)},cosh(o,s){let f=u.parse(String(Math.cosh(o)*Math.cos(s))),k=u.parse(String(Math.sinh(o)*Math.sin(s)));return u.add(f,u.multiply(k,i.imaginary()))},sinh(o,s){let f=u.parse(String(Math.sinh(o)*Math.cos(s))),k=u.parse(String(Math.cosh(o)*Math.sin(s)));return u.add(f,u.multiply(k,i.imaginary()))},tanh(o,s){let f=u.parse(String(Math.sinh(2*o)/(Math.cos(2*s)+Math.cosh(2*o)))),k=u.parse(String(Math.sin(2*s)/(Math.cos(2*s)+Math.cosh(2*o))));return u.subtract(f,u.multiply(k,i.imaginary()))},sech(o,s){let f=this.removeDen(this.cosh(o,s));return u.subtract(f[0],u.multiply(f[1],i.imaginary()))},csch(o,s){let f=this.removeDen(this.sinh(o,s));return u.subtract(f[0],u.multiply(f[1],i.imaginary()))},coth(o,s){let f=this.removeDen(this.tanh(o,s));return u.add(f[0],u.multiply(f[1],i.imaginary()))},acosh(o,s){let f=this.fromArray([o,s]),k=g(u.add(f.clone(),new i(1))),$=g(u.subtract(f.clone(),new i(1)));return u.expand(Nt(u.add(f,u.expand(u.multiply(k,$)))))},asinh(o,s){let f=this.fromArray([o,s]),k=g(u.add(new i(1),u.expand(u.pow(f.clone(),new i(2)))));return u.expand(Nt(u.add(f,k)))},atanh(o,s){let f=this.fromArray([o,s]),k=Nt(u.add(f.clone(),new i(1))),$=Nt(u.subtract(new i(1),f));return u.expand(u.divide(u.subtract(k,$),new i(2)))},asech(o,s){let f=this.removeDen([o,s]);return f[1].negate(),this.acosh(...f)},acsch(o,s){let f=this.removeDen([o,s]);return f[1].negate(),this.asinh(...f)},acoth(o,s){let f=this.removeDen([o,s]);return f[1].negate(),this.atanh(...f)},sqrt(o){let s=o.realpart(),f=o.imagpart(),k=i.hyp(s,f),$=u.add(s.clone(),k),he=g(u.multiply(new i(2),$.clone()));return u.add(u.divide($.clone(),he.clone()),u.multiply(u.divide(f,he),i.imaginary()))},log(o,s){let f=Nt(i.hyp(o,s)),k=G.USE_BIG?new i(de.atan2(s.multiplier.toDecimal(),o.multiplier.toDecimal())):Math.atan2(s,o),$=u.parse(k);return u.add(f,u.multiply(i.imaginary(),$))},erf(o,s){return u.symfunction("erf",[o])},removeDen(o){let s,f;bt(o)?(s=o[0],f=o[1]):(s=o.realpart(),f=o.imagpart());let k=s**2+f**2,$=u.parse(String(s/k)),he=u.parse(String(f/k));return[$,he]},fromArray(o){return u.add(o[0],u.multiply(i.imaginary(),o[1]))},evaluate(o,s){let f,k,$=o.power.sign();if(o.power=o.power.abs(),o.power.greaterThan(1)&&(o=u.expand(o)),$<0){let he=this.removeDen(o);f=he[0],k=he[1]}else f=o.realpart(),k=o.imagpart();return f.isConstant("all")&&k.isConstant("all")?this[s](f,k):u.symfunction(s,[o])}},_=this.trig={cos(o){if(o.equals("pi")&&o.multiplier.den.equals(2))return new i(0);if(G.PARSE2NUMBER){if(o.equals(new i(G.PI/2)))return new i(0);if(o.isConstant())return G.USE_BIG?new i(de.cos(o.multiplier.toDecimal())):new i(Math.cos(o.valueOf()));if(o.isImaginary())return E.evaluate(o,"cos")}if(o.equals(0))return new i(1);let s,f=!1,k=Zt(o.multiplier.toDecimal()),$=o.multiplier.abs();if(o.multiplier=$,o.isPi()&&o.isLinear())if(vt($))s=new i(kt($)?1:-1);else{let he=Number($.num),ie=Number($.den);ie===2?s=new i(0):ie===3?(s=u.parse("1/2"),f=!0):ie===4?(s=u.parse("1/sqrt(2)"),f=!0):ie===6?(s=u.parse("sqrt(3)/2"),f=!0):s=u.symfunction("cos",[o])}return f&&(k===2||k===3)&&s.negate(),s||=u.symfunction("cos",[o]),s},sin(o){if(G.PARSE2NUMBER){if(o.isConstant())return Number(o.multiplier.toDecimal())%Math.PI===0?new i(0):G.USE_BIG?new i(de.sin(o.multiplier.toDecimal())):new i(Math.sin(o.valueOf()));if(o.isImaginary())return E.evaluate(o,"sin")}if(o.equals(0))return new i(0);let s,f=!1,k=Zt(o.multiplier.toDecimal()),$=o.multiplier.sign(),he=o.multiplier.abs();if(o.multiplier=he,o.equals("pi"))s=new i(0);else if(o.isPi()&&o.isLinear())if(vt(he))s=new i(0);else{let ie=he.num,ne=he.den;ne.equals(2)?(s=new i(1),f=!0):ne.equals(3)?(s=u.parse("sqrt(3)/2"),f=!0):ne.equals(4)?(s=u.parse("1/sqrt(2)"),f=!0):ne.equals(6)?(s=u.parse("1/2"),f=!0):s=u.multiply(new i($),u.symfunction("sin",[o]))}return s||=u.multiply(new i($),u.symfunction("sin",[o])),f&&(k===3||k===4)&&s.negate(),s},tan(o){if(G.PARSE2NUMBER){if(Number(o.multiplier.toDecimal())%Math.PI===0&&o.isLinear())return new i(0);if(o.isConstant())return G.USE_BIG?new i(de.tan(o.multiplier.toDecimal())):new i(Math.tan(o.valueOf()));if(o.isImaginary())return E.evaluate(o,"tan")}let s,f=!1,k=Zt(o.multiplier.toDecimal()),$=o.multiplier;if(o.multiplier=$,o.isPi()&&o.isLinear())if(vt($))s=new i(0);else{let he=$.num,ie=$.den;if(ie.equals(2))throw new Kt(`tan is undefined for ${o.toString()}`);ie.equals(3)?(s=u.parse("sqrt(3)"),f=!0):ie.equals(4)?(s=new i(1),f=!0):ie.equals(6)?(s=u.parse("1/sqrt(3)"),f=!0):s=u.symfunction("tan",[o])}return s||=u.symfunction("tan",[o]),f&&(k===2||k===4)&&s.negate(),s},sec(o){if(G.PARSE2NUMBER)return o.isConstant()?G.USE_BIG?new i(new de(1).dividedBy(de.cos(o.multiplier.toDecimal()))):new i(U.sec(o.valueOf())):o.isImaginary()?E.evaluate(o,"sec"):u.parse(Ut("1/cos({0})",o));let s,f=!1,k=Zt(o.multiplier.toDecimal()),$=o.multiplier.abs();if(o.multiplier=$,o.isPi()&&o.isLinear())if(vt($))s=new i(kt($)?1:-1);else{let he=$.num,ie=$.den;if(ie.equals(2))throw new Kt(`sec is undefined for ${o.toString()}`);ie.equals(3)?(s=new i(2),f=!0):ie.equals(4)?(s=u.parse("sqrt(2)"),f=!0):ie.equals(6)?(s=u.parse("2/sqrt(3)"),f=!0):s=u.symfunction("sec",[o])}return f&&(k===2||k===3)&&s.negate(),s||=u.symfunction("sec",[o]),s},csc(o){if(G.PARSE2NUMBER)return o.isConstant()?G.USE_BIG?new i(new de(1).dividedBy(de.sin(o.multiplier.toDecimal()))):new i(U.csc(o.valueOf())):o.isImaginary()?E.evaluate(o,"csc"):u.parse(Ut("1/sin({0})",o));let s,f=!1,k=Zt(o.multiplier.toDecimal()),$=o.multiplier.sign(),he=o.multiplier.abs();if(o.multiplier=he,o.isPi()&&o.isLinear()){if(vt(he))throw new Kt(`csc is undefined for ${o.toString()}`);{let ie=he.num,ne=he.den;ne.equals(2)?(s=new i(1),f=!0):ne.equals(3)?(s=u.parse("2/sqrt(3)"),f=!0):ne.equals(4)?(s=u.parse("sqrt(2)"),f=!0):ne.equals(6)?(s=new i(2),f=!0):s=u.multiply(new i($),u.symfunction("csc",[o]))}}return s||=u.multiply(new i($),u.symfunction("csc",[o])),f&&(k===3||k===4)&&s.negate(),s},cot(o){if(G.PARSE2NUMBER)return Number(o.multiplier.toDecimal())%(Math.PI/2)===0?new i(0):o.isConstant()?G.USE_BIG?new i(new de(1).dividedBy(de.tan(o.multiplier.toDecimal()))):new i(U.cot(o.valueOf())):o.isImaginary()?E.evaluate(o,"cot"):u.parse(Ut("1/tan({0})",o));let s,f=!1,k=Zt(o.multiplier.toDecimal()),$=o.multiplier;if(o.multiplier=$,o.isPi()&&o.isLinear()){if(vt($))throw new Kt(`cot is undefined for ${o.toString()}`);{let he=$.num,ie=$.den;ie.equals(2)?s=new i(0):ie.equals(3)?(s=u.parse("1/sqrt(3)"),f=!0):ie.equals(4)?(s=new i(1),f=!0):ie.equals(6)?(s=u.parse("sqrt(3)"),f=!0):s=u.symfunction("cot",[o])}}return s||=u.symfunction("cot",[o]),f&&(k===2||k===4)&&s.negate(),s},acos(o){if(G.PARSE2NUMBER){if(o.isConstant()){if(o.gt(1)||o.lt(-1)){let s=o.toString();return xt(Mt(`pi/2-asin(${s})`))}return G.USE_BIG?new i(de.acos(o.multiplier.toDecimal())):new i(Math.acos(o.valueOf()))}if(o.isImaginary())return E.evaluate(o,"acos")}return u.symfunction("acos",[o])},asin(o){if(G.PARSE2NUMBER){if(o.isConstant()){if(o.gt(1)||o.lt(-1)){let s=G.IMAGINARY,f=o.multiplier.toDecimal();return xt(Mt(`${s}*log(sqrt(1-${f}^2)-${s}*${f})`))}return G.USE_BIG?new i(de.asin(o.multiplier.toDecimal())):new i(Math.asin(o.valueOf()))}if(o.isImaginary())return E.evaluate(o,"asin")}return u.symfunction("asin",[o])},atan(o){let s;if(o.equals(0))s=new i(0);else{if(G.PARSE2NUMBER)return o.isConstant()?G.USE_BIG?new i(de.atan(o.multiplier.toDecimal())):new i(Math.atan(o.valueOf())):o.isImaginary()?E.evaluate(o,"atan"):u.symfunction("atan",[o]);o.equals(-1)?s=u.parse("-pi/4"):s=u.symfunction("atan",[o])}return s},asec(o){if(G.PARSE2NUMBER){if(o.equals(0))throw new p1("Input is out of the domain of sec!");if(o.isConstant())return _.acos(o.invert());if(o.isImaginary())return E.evaluate(o,"asec")}return u.symfunction("asec",[o])},acsc(o){if(G.PARSE2NUMBER){if(o.isConstant())return _.asin(o.invert());if(o.isImaginary())return E.evaluate(o,"acsc")}return u.symfunction("acsc",[o])},acot(o){if(G.PARSE2NUMBER){if(o.isConstant())return u.add(u.parse("pi/2"),_.atan(o).negate());if(o.isImaginary())return E.evaluate(o,"acot")}return u.symfunction("acot",[o])},atan2(o,s){if(o.equals(0)&&s.equals(0))throw new Kt("atan2 is undefined for 0, 0");return G.PARSE2NUMBER&&o.isConstant()&&s.isConstant()?new i(Math.atan2(o,s)):u.symfunction("atan2",[o,s])}},Y=this.trigh={cosh(o){if(G.PARSE2NUMBER){if(o.isConstant())return new i(Math.cosh(o.valueOf()));if(o.isImaginary())return E.evaluate(o,"cosh")}return u.symfunction("cosh",[o])},sinh(o){if(G.PARSE2NUMBER){if(o.isConstant())return new i(Math.sinh(o.valueOf()));if(o.isImaginary())return E.evaluate(o,"sinh")}return u.symfunction("sinh",[o])},tanh(o){if(G.PARSE2NUMBER){if(o.isConstant())return new i(Math.tanh(o.valueOf()));if(o.isImaginary())return E.evaluate(o,"tanh")}return u.symfunction("tanh",[o])},sech(o){return G.PARSE2NUMBER?o.isConstant()?new i(Math.sech(o.valueOf())):o.isImaginary()?E.evaluate(o,"sech"):u.parse(Ut("1/cosh({0})",o)):u.symfunction("sech",[o])},csch(o){return G.PARSE2NUMBER?o.isConstant()?new i(Math.csch(o.valueOf())):o.isImaginary()?E.evaluate(o,"csch"):u.parse(Ut("1/sinh({0})",o)):u.symfunction("csch",[o])},coth(o){return G.PARSE2NUMBER?o.isConstant()?new i(Math.coth(o.valueOf())):o.isImaginary()?E.evaluate(o,"coth"):u.parse(Ut("1/tanh({0})",o)):u.symfunction("coth",[o])},acosh(o){let s;return G.PARSE2NUMBER&&o.isImaginary()?s=E.evaluate(o,"acosh"):G.PARSE2NUMBER?s=Mt(u.parse(Ut(`${G.LOG}(({0})+sqrt(({0})^2-1))`,o.toString()))):s=u.symfunction("acosh",[o]),s},asinh(o){let s;return G.PARSE2NUMBER&&o.isImaginary()?s=E.evaluate(o,"asinh"):G.PARSE2NUMBER?s=Mt(u.parse(Ut(`${G.LOG}(({0})+sqrt(({0})^2+1))`,o.toString()))):s=u.symfunction("asinh",[o]),s},atanh(o){let s;return G.PARSE2NUMBER&&o.isImaginary()?s=E.evaluate(o,"atanh"):G.PARSE2NUMBER?s=Mt(u.parse(Ut(`(1/2)*${G.LOG}((1+({0}))/(1-({0})))`,o.toString()))):s=u.symfunction("atanh",[o]),s},asech(o){let s;return G.PARSE2NUMBER&&o.isImaginary()?s=E.evaluate(o,"asech"):G.PARSE2NUMBER?s=Mt(Nt(u.add(o.clone().invert(),g(u.subtract(u.pow(o,new i(-2)),new i(1)))))):s=u.symfunction("asech",[o]),s},acsch(o){let s;return G.PARSE2NUMBER&&o.isImaginary()?s=E.evaluate(o,"acsch"):G.PARSE2NUMBER?s=Mt(u.parse(Ut(`${G.LOG}((1+sqrt(1+({0})^2))/({0}))`,o.toString()))):s=u.symfunction("acsch",[o]),s},acoth(o){let s;return G.PARSE2NUMBER&&o.isImaginary()?s=E.evaluate(o,"acoth"):G.PARSE2NUMBER?o.equals(1)?s=i.infinity():s=Mt(u.divide(Nt(u.divide(u.add(o.clone(),new i(1)),u.subtract(o.clone(),new i(1)))),new i(2))):s=u.symfunction("acoth",[o]),s}};this.units={};let P={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(o){return o}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(o){return u.symfunction(G.DOUBLEFACTORIAL,[o])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(o){return Je(o)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(o){return u.divide(o,new i(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},Z={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},K=this.functions={cos:[_.cos,1],sin:[_.sin,1],tan:[_.tan,1],sec:[_.sec,1],csc:[_.csc,1],cot:[_.cot,1],acos:[_.acos,1],asin:[_.asin,1],atan:[_.atan,1],arccos:[_.acos,1],arcsin:[_.asin,1],arctan:[_.atan,1],asec:[_.asec,1],acsc:[_.acsc,1],acot:[_.acot,1],atan2:[_.atan2,2],acoth:[Y.acoth,1],asech:[Y.asech,1],acsch:[Y.acsch,1],sinh:[Y.sinh,1],cosh:[Y.cosh,1],tanh:[Y.tanh,1],asinh:[Y.asinh,1],sech:[Y.sech,1],csch:[Y.csch,1],coth:[Y.coth,1],acosh:[Y.acosh,1],atanh:[Y.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[jt,1],radians:[l0,1],degrees:[ct,1],min:[lt,-1],max:[Pe,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[Yt,1],tri:[void 0,1],sign:[yt,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[Je,1],factorial:[Je,1],continuedFraction:[ft,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[Lt,[1,2]],scientific:[N,[1,2]],mod:[Rt,2],pfactor:[T,1],vector:[pn,-1],matrix:[hn,-1],NerdamerSet:[gn,-1],imatrix:[R0,-1],parens:[Ye,-1],sqrt:[g,1],cbrt:[y,1],nthroot:[A,2],log:[Nt,[1,2]],expand:[N0,1],abs:[Fe,1],invert:[yn,1],determinant:[mn,1],size:[dn,1],transpose:[Sn,1],dot:[wn,2],cross:[vn,2],vecget:[M0,2],vecset:[L0,3],vectrim:[w0,[1,2]],matget:[i0,3],matset:[Ct,4],matgetrow:[A0,2],matsetrow:[I0,3],matgetcol:[U0,2],matsetcol:[zt,3],rationalize:[j0,1],IF:[n0,3],isIn:[Vt,2],realpart:[R,1],imagpart:[W,1],conjugate:[re,1],arg:[me,1],polarform:[oe,1],rectform:[Ae,1],sort:[pt,[1,2]],integer_part:[void 0,1],union:[En,2],contains:[Mn,2],intersection:[Nn,2],difference:[An,2],intersects:[In,2],isSubset:[qn,2],primes:[_n,2],print:[On,-1]};this.error=Ft;let we=function(o){let s=G.FUNCTION_MODULES,f=s.length;for(let k=0;k<f;k++){let $=s[k];if(o in $)return $[o]}return Ft(`The function ${o} is undefined!`)};this.override=function(s,f){n[s]||=[],n[s].push(this[s]),this[s]=f},this.restore=function(s){this[s]&&=n[s].pop()},this.extend=function(s,f,k){let $=this;if(typeof this[s]=="function"&&typeof f=="function"){let ie=this[s];this[s]=function(Me,Ne){return ue(Me)&&ue(Ne)&&!k?ie.call($,Me,Ne):f.call($,Me,Ne,ie)}}},this.symfunction=function(s,f){let k=new i(s);return k.group=He,typeof f=="object"&&(f=[].slice.call(f)),k.args=f,k.fname=s===J?"":s,k.updateHash(),k},this.callfunction=function(s,f,k=void 0){let $=K[s];$||Ft(`Nerdamer currently does not support the function ${s}`);let he=$[1]||k,ie=$[0],ne;if(f instanceof Array||(f=f===void 0?[]:[f]),he!==-1){let Ne=bt(he),Oe=Ne?he[0]:he,ve=Ne?he[1]:he,ze=f.length,gt=`${s} requires a {0} of {1} arguments. {2} provided!`;ze<Oe&&Ft(Ut(gt,"minimum",Oe,ze)),ze>ve&&Ft(Ut(gt,"maximum",ve,ze))}let Me=m1(f);return ie?ne=ie.apply($[2],f):(ie=we(s),G.PARSE2NUMBER&&Me?ne=At(ie.apply(ie,f)):ne=u.symfunction(s,f)),ne},this.operator_filter_regex=(function(){let s=`^\\${Object.keys(P).filter(f=>f.length===1).join("\\")}`;return new RegExp(`([${s}])\\s+([${s}])`)})(),this.setOperator=function(s,f=void 0,k=void 0){let $=s.operator;if(P[$]=s,f&&(this[s.action]=f),e[$]=s.operation,!s.action&&!(s.prefix||s.postif)&&(s.action=$),k==="over"||k==="under"){let{precedence:he}=s;for(let ie in P){if(!Object.hasOwn(P,ie))continue;let ne=P[ie];(k==="over"?ne.precedence>=he:ne.precedence>he)&&ne.precedence++}}},this.getOperator=function(s){return P[s]},this.aliasOperator=function(s,f){let k={},$=P[s];for(let he in $)Object.hasOwn($,he)&&(k[he]=$[he]);k.operator=f,this.setOperator(k)},this.getOperators=function(){return P},this.getBrackets=function(){return Z};let Ee=function(s,f){s=String(s);for(let k=0;k<r.actions.length;k++)s=r.actions[k].call(f,s);for(s=s.replace(/\s+/gu," "),/e/giu.test(s)&&(s=s.replace(/-+\d+\.?\d*e\+?-?\d+/giu,k=>k0(k)),s=s.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,k=>k0(k))),s=s.replace(G.IMPLIED_MULTIPLICATION_REGEX,(k,$,he,ie,ne)=>{let Me=ne.charAt(ie),Ne="",Oe="*";return Me.match(/[+\-/*]/u)||(Ne=ne.charAt(ie-1)),Ne.match(/[a-z]/iu)&&(Oe=""),$+Oe+he}).replace(/(?<varname>[a-z0-9_]+)/giu,(k,$)=>G.USE_MULTICHARACTER_VARS===!1&&!($ in K)&&isNaN($)?$.split("").join("*"):$).replace(/\)\(/gu,")*(")||"0";;){let k=s;if(s=s.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,($,he,ie,ne,Me)=>{let Ne=he||ne,Oe=ie||Me;return Ne in K?Ne+Oe:`${Ne}*${Oe}`}),k===s)break}return s};this.initConstants=function(){this.CONSTANTS={E:new i(G.E),PI:new i(G.PI)}},this.prettyPrint=function(s){if(Array.isArray(s)){let f=s,k=f.map($=>u.prettyPrint($)).join(", ");return f.type==="vector"?`vector<${k}>`:`(${k})`}return s.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(s,...f){if(G.callPeekers){let k=this.peekers[s],$=f.map(kn);for(let he=0;he<k.length;he++)k[he].apply(null,$)}},this.tokenize=function(s){s=String(s),s=s.trim().replace(/\s+/gu," ");for(let dt in Z){if(!Object.hasOwn(Z,dt))continue;let It=new RegExp(Z[dt].is_close?`\\s+\\${dt}`:`\\${dt}\\s+`,"g");s=s.replace(It,dt)}let f=0,k=s.length,$=0,he=[],ie=[he],ne=ie[0],Me=0,Ne=[],Oe=!1,ve,ze=" ",gt="",wt=",",tt="-",ke="*",rt=function(dt=void 0,It=void 0){let _t=[];dt!==void 0&&(_t.type=dt),_t.column=It,ie.push(_t),ne.push(_t),ne=_t,Me++},it=function(){ie.pop(),ne=ie[--Me]},ut=function(dt){dt=dt===void 0?f:dt;let It=dt+1;for(;s.charAt(It++)in P;);return s.substring(dt,It-1)},Et=function(dt){let It=f-dt.length,_t=[],Qt=dt.charAt(0),$0=dt.length,h0;for(h0=1;h0<$0;h0++){let M1=dt.charAt(h0),A1=Qt+M1;A1 in P?Qt=A1:(_t.push(new w(Qt,w.OPERATOR,It+h0)),Qt=M1)}return _t.push(new w(Qt,w.OPERATOR,It+h0)),_t},ht=function(dt,It=void 0){It===void 0&&(It=s.substring($,dt)),It in u.units?ne.push(new w(It,w.UNIT,$)):It!==""&&ne.push(new w(It,w.VARIABLE_OR_LITERAL,$))},Tt=function(dt){ne.push(new w(dt,w.FUNCTION,$))},Wt=function(dt){$=dt+1},a0=function(){$=$+ve.length-2,f=$-1};for(;f<k;f++){let dt=s.charAt(f);if(dt in P){ht(f);let _t=ne[0]&&G1(ne[0])&&dt===ke;Oe&&$<f&&!(dt===wt||_t)&&(Oe=!1,it()),Wt(f+1),ve=ut(f),a0(),ne.push(...Et(ve))}else if(dt in Z){let It=Z[dt];if(It.is_open){Ne.push([It,$]);let _t=s.substring($,f);_t in K?Tt(_t):_t!==""&&ne.push(new w(_t,w.VARIABLE_OR_LITERAL,$)),rt(It.maps_to,f)}else if(It.is_close){let _t=Ne.pop();if(_t){if(_t[0].id!==It.id-1)throw new Q0("Parity error")}else throw new Q0(`Missing open bracket for bracket at: ${f+1}`);ht(f),it()}Wt(f)}else if(dt===ze){let It=s.substring($,f),_t=s.charAt(f+1);if(Oe){if(It in P)ne.push(new w(It,w.OPERATOR,f));else{ht(void 0,It),it();let Qt=_t in P;(Qt&&P[_t].value===tt||!Qt)&&ne.push(new w(ke,w.OPERATOR,f))}Oe=!1}else{let Qt=s.substring($,f);Qt in K?(Oe=!0,Tt(Qt),rt()):Qt in P?ne.push(new w(Qt,w.OPERATOR,f)):(ht(void 0,Qt),_t=s.charAt(f+1),It!==gt&&_t!==gt&&!(It in P)&&!(_t in P)&&ne.push(new w(ke,w.OPERATOR,f)))}Wt(f)}}if(Ne.length){let dt=Ne.pop();throw new Q0(`Missing closed bracket for bracket at ${dt[1]+1}`)}return ht(f),he},this.toRPN=function(s){let f=s.type,k=s.length,$,he,ie=[],ne=[],Me=[],Ne=function(ve,ze){for(;ve.length;)ze.push(ve.pop())};for($=0;$<k;$++){let Oe=s[$];if(Oe.type!==w.OPERATOR)break;if(!Oe.prefix)throw new q0("Not a prefix operator");Oe.is_prefix=!0,ne.push(Oe)}for(;$<k;$++){if(he=s[$],he.type===w.OPERATOR){let Oe=he;if(Oe.overloaded){let ve=s[$+1];ve&&ve.type===w.VARIABLE_OR_LITERAL&&(Oe.postfix=!1,Oe.action=Oe.overloadAction,Oe.leftAssoc=Oe.overloadLeftAssoc)}for(;ne.length;){let ve=ne[ne.length-1];if(!(ve.precedence>Oe.precedence||!Oe.leftAssoc&&ve.precedence===Oe.precedence))break;ie.push(ne.pop())}if((f==="vector"||f==="set")&&"vectorFn"in Oe&&(Oe.action=Oe.vectorFn),Oe.postfix){let ve=s[$-1];if(ve){if(ve.type===w.OPERATOR&&!ve.postfix)throw new q0(`Unexpected prefix operator '${ve.value}'! at ${ve.column}`)}else throw new q0(`Unexpected prefix operator '${he.value}'! at ${he.column}`)}else{let ve;do{let ze=s[$+1];if(ve=ze?ze.type===w.OPERATOR:!1,ve){if(!ze.prefix)throw new q0(`A prefix operator was expected at ${ze.column}`);ze.is_prefix=!0,Me.push(ze),$++}}while(ve)}for(Oe.is_prefix?Me.push(Oe):ne.push(Oe);Me.length&&(Oe.leftAssoc||!Oe.leftAssoc&&Me[Me.length-1].precedence>=Oe.precedence);)ne.push(Me.pop())}else if(he.type===w.VARIABLE_OR_LITERAL){ie.length===0&&Ne(Me,ne),ie.push(he);let Oe=ne[ne.length-1];(!Oe||!Oe.leftAssoc)&&Ne(Me,ie)}else he.type===w.FUNCTION?ne.push(he):he.type===w.UNIT&&ie.push(he);if(Array.isArray(he)){let Oe=he;ie.push(this.toRPN(he)),Oe.type&&ie.push(new w(Oe.type,w.FUNCTION,Oe.column))}}return Ne(ne,ie),Ne(Me,ie),ie},this.parseRPN=function(s,f){try{f||={};for(let ie in f)Object.hasOwn(f,ie)&&(f[ie]=u.parse(f[ie],{}));G.PARSE2NUMBER&&("e"in f||(f.e=new i(G.E)),"pi"in f||(f.pi=new i(G.PI)));let k=[],$;for(let ie=0,ne=s.length;ie<ne;ie++)if($=s[ie],Array.isArray($)&&($=this.parseRPN($,f)),$)if($.type===w.OPERATOR)if($.is_prefix||$.postfix)k.push($.operation(k.pop()));else{let Me=k.pop(),Ne=k.pop();if(typeof Ne>"u")throw new q0(`${$} is not a valid postfix operator at ${$.column}`);let Oe=$.action==="comma";Ne instanceof o0&&!Oe&&(Ne=M.fromSet(Ne)),Me instanceof o0&&!Oe&&(Me=M.fromSet(Me)),this.callPeekers("pre_operator",Ne,Me,$);let ve=u[$.action](Ne,Me);this.callPeekers("post_operator",ve,Ne,Me,$),k.push(ve)}else if($.type===w.FUNCTION){let Me=k.pop(),{parent:Ne}=Me;Me instanceof $t||(Me=$t.create(Me));let Oe=$.value,ve=Me.getItems();this.callPeekers("pre_function",Oe,ve);let ze=u.callfunction(Oe,ve);this.callPeekers("post_function",ze,Oe,ve);let gt=k[k.length-1],wt=s[ie+1],tt=wt&&wt.type===w.OPERATOR&&wt.value===",";Ne&&(ze.parent=Ne),k.push(ze)}else{let Me,Ne=$.value;if(Ne in G.ALIASES)$=u.parse(G.ALIASES[$]);else if($.type===w.VARIABLE_OR_LITERAL)$=new i(Ne);else if($.type===w.UNIT){let Oe=new i(Ne);Oe.isUnit=!0,$=Oe}Ne in u.CONSTANTS?(Me=$,$=new i(u.CONSTANTS[Ne])):Ne in f&&Ne!==f[Ne].toString()?(Me=$,$=f[Ne].clone()):Ne in S&&(Me=$,$=S[Ne].clone()),Me&&($.subbed=Me),k.push($)}let he=k[0];if(["undefined","string","number"].indexOf(typeof he)!==-1)throw new U1("Unexpected token!");return he}catch(k){if(k.message==="timeout")throw k;[p1].forEach(ie=>{if(k instanceof ie){let ne=k.column;throw new ie(`${k.message}${ne?`: ${ne}`:""}`)}});let he=k.column;throw new R1(`${k.message}${he?`: ${he}`:""}`)}};function ye(o){this.type=o.type,this.value=o.value,this.left=o.left,this.right=o.right}ye.prototype.toString=function(){let s=this.left?`${this.left.toString()}---`:"",f=this.right?`---${this.right.toString()}`:"";return`${s}(${this.value})${f}`},ye.prototype.toHTML=function(s,f){s||=0,f=typeof f>"u"?4:f;let k=function(Me){return" ".repeat(f*Me)},$="",he=this.left?`${k(s+1)}<li>
${this.left.toHTML(s+2,f)}${k(s+1)}</li> 
`:"",ie=this.right?`${k(s+1)}<li>
${this.right.toHTML(s+2,f)}${k(s+1)}</li>
`:"";return $=`${k(s)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${k(s)}
`,(he||ie)&&($+=`${k(s)}<ul>
${he}${ie}${k(s)}</ul>
`),$},this.tree=function(s){let f=[];for(let k=0;k<s.length;k++){let $=s[k];if(Array.isArray($)){$=this.tree($),f.push($);continue}if($.type===w.OPERATOR)if($.is_prefix||$.postfix){let he=$.is_prefix?"left":"right",ie=f.pop();$=new ye($),$[he]=ie,f.push($)}else $=new ye($),$.right=f.pop(),$.left=f.pop(),f.push($);else if($.type===w.FUNCTION){$=new ye($);let he=f.pop();if($.right=he,$.value==="object"){let ie=f[f.length-1];if(ie){for(;ie.right;)ie=ie.right;ie.right=$;continue}}f.push($)}else f.push(new ye($))}return f[0]},this.parse=function(s,f){s=Ee(s,this),f||={};let k=this.tokenize(s),$=this.toRPN(k);return this.parseRPN($,f)},this.toObject=function(s){return function k($){let he=[];for(let ie=0,ne=$.length;ie<ne;ie++){let Me=$[ie],Ne=Me.value;if(Me.type===w.VARIABLE_OR_LITERAL)he.push(new i(Ne));else if(Me.type===w.FUNCTION){ie++;let Oe=u.symfunction(Ne,k($[ie]));Oe.isConversion=!0,he.push(Oe)}else Me.type===w.OPERATOR?he.push(Ne):he.push(k(Me))}return he}(u.tokenize(s))};let Qe=function(s){let f=0,k=[[]];for(let $=0,he=s.length;$<he;$++)s[$]===","?(f++,k[f]=[]):k[f].push(s[$]);return k},be=function(o){return o.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(s,f)=>f||s)},Ze=function(o){let s=[];for(;o.length;){let f=o.shift(),k=o[0],$=bt(k),he=k==="-";if(f==="^"&&(k==="+"?o.shift():$&&k[0]==="+"&&k.shift(),$&&k.length===1&&o.unshift(o.shift()[0])),f==="^"&&($&&k[0]==="-"||he)){let ie=s.pop(),ne=s[s.length-1],Me="1";ne==="*"?(s.pop(),Me=s.pop()):bt(ne)&&(Me=s.pop()),s.push(Me,"/",ie,f),$?k.shift():o.shift(),$&&k.length===1&&s.push(o.shift()[0])}else s.push(f)}return s};this.toTeX=function(s,f){f||={};let k=f.decimals===!0?"decimals":void 0,$=typeof s=="string"?this.toObject(s):s,he=[],ie=typeof f.cdot>"u"?"\\cdot":f.cdot;if($=Ze($),bt($)){let ne=[],Me,Ne;for(let Oe=0;Oe<$.length;Oe++)Me=$[Oe],$[Oe+1]==="^"?(Ne=$[Oe+2],ne.push(`${le.braces(this.toTeX([Me]))}^${le.braces(this.toTeX([Ne]))}`),Oe+=2):ne.push(Me);$=ne}for(let ne=0,Me=$.length;ne<Me;ne++){let Ne=$[ne];if(Ne==="*"&&(Ne=ie),ue(Ne))if(Ne.group===He){let{fname:Oe}=Ne,ve;if(Oe===c)ve=`\\sqrt${le.braces(this.toTeX(Ne.args))}`;else if(Oe===d)ve=le.brackets(this.toTeX(Ne.args),"abs");else if(Oe===J)ve=le.brackets(this.toTeX(Ne.args),"parens");else if(Oe===G.LOG10)ve=`\\${G.LOG10_LATEX}\\left( ${this.toTeX(Ne.args)}\\right)`;else if(Oe===G.LOG2)ve=`\\${G.LOG2_LATEX}\\left( ${this.toTeX(Ne.args)}\\right)`;else if(Oe===G.LOG1P)ve=`\\${Ut(G.LOG1P_LATEX,this.toTeX(Ne.args))}`;else if(Oe==="integrate"){let ze=Qe(Ne.args),gt=le.braces(this.toTeX(ze[0])),wt=this.toTeX(ze[1]);ve=`\\int ${gt}\\, d${wt}`}else if(Oe==="defint"){let ze=Qe(Ne.args),gt=le.braces(this.toTeX(ze[0])),wt=this.toTeX(ze[3]),tt=this.toTeX(ze[1]),ke=this.toTeX(ze[2]);ve=`\\int\\limits_{${tt}}^{${ke}} ${gt}\\, d${wt}`}else if(Oe==="diff"){let ze=Qe(Ne.args),gt="",wt=le.braces(this.toTeX(ze[0]));if(ze.length===1){let tt=[];for(let ke=0;ke<ze[0].length;ke++)ze[0][ke].group===3&&tt.push(ze[0][ke].value);tt.sort(),gt=tt.length>0?`\\frac{d}{d ${tt[0]}}`:"\\frac{d}{d x}"}else ze.length===2?gt=`\\frac{d}{d ${ze[1]}}`:gt=`\\frac{d^{${ze[2]}}}{d ${this.toTeX(ze[1])}^{${ze[2]}}}`;ve=`${gt}\\left(${wt}\\right)`}else if(Oe==="sum"||Oe==="product"){let ze=[[],[],[],[]],gt=0;for(let wt=0;wt<Ne.args.length;wt++){if(Ne.args[wt]===","){gt++;continue}ze[gt].push(Ne.args[wt])}ve=(Oe==="sum"?"\\sum_":"\\prod_")+le.braces(`${this.toTeX(ze[1])} = ${this.toTeX(ze[2])}`),ve+=`^${le.braces(this.toTeX(ze[3]))}${le.braces(this.toTeX(ze[0]))}`}else if(Oe==="limit"){let ze=this.toTeX.bind(this),gt=u,wt=Qe(Ne.args).map(tt=>Array.isArray(tt)?gt.toTeX(tt.join("")):ze(String(tt)));ve=`\\lim_${le.braces(`${wt[1]}\\to ${wt[2]}`)} ${le.braces(wt[0])}`}else Oe===a||Oe===m?ve=this.toTeX(Ne.args)+(Oe===a?"!":"!!"):ve=le.latex(Ne,k);he.push(ve)}else he.push(le.latex(Ne,k));else bt(Ne)?he.push(le.brackets(this.toTeX(Ne))):Ne==="/"?he.push(le.frac(be(he.pop()),be(this.toTeX([$[++ne]])))):he.push(Ne)}return he.join(" ")};function Ye(o){return G.PARSE2NUMBER?o:u.symfunction("parens",[o])}function Fe(o){if(o.isInfinity)return i.infinity();if(o.multiplier.lessThan(0)&&o.multiplier.negate(),o.isImaginary()){let f=o.realpart(),k=o.imagpart();if(f.isConstant()&&k.isConstant())return g(u.add(u.pow(f,new i(2)),u.pow(k,new i(2))))}else{if(_0(o)||kt(o.power))return o;if($1(o)&&typeof o.value=="string"&&o.value.startsWith("baseunit_"))return o}if(o.isComposite()){let f=[];o.each($=>{f.push($.multiplier)}),U.QGCD.apply(null,f).lessThan(0)&&(o.multiplier=o.multiplier.multiply(new We(-1)),o.distributeMultiplier())}let s=u.parse(o.multiplier);return o.toUnitMultiplier(),u.multiply(s,u.symfunction(d,[o]))}function Je(o){let s;if(ae(o)){let f=new M;return o.each((k,$)=>{f.set($-1,Je(k))}),f}if(Re(o)){let f=new C;return o.each((k,$,he)=>{f.set($,he,Je(k))}),f}if(G.PARSE2NUMBER&&o.isConstant())return vt(o)?s=U.bigfactorial(o):s=U.gamma(o.multiplier.add(new We(1)).toDecimal()),s=At(s),s;if(o.isConstant()&&o.getDenom().equals(2)){let k=o.getNum(),$,he,ie;o.multiplier.isNegative()?(ie=u.subtract(k.negate(),new i(1)).multiplier.divide(new We(2)),$=u.pow(new i(-4),new i(ie)).multiplier.multiply(U.bigfactorial(ie)),he=U.bigfactorial(new We(2).multiply(ie))):(ie=u.add(k,new i(1)).multiplier.divide(new We(2)),$=U.bigfactorial(new We(2).multiply(ie)),he=u.pow(new i(4),new i(ie)).multiplier.multiply(U.bigfactorial(ie)));let ne=$.divide(he);return u.multiply(u.parse("sqrt(pi)"),new i(ne))}return u.symfunction(a,[o])}function ft(o,s){let f=Mt(o);if(f.isConstant()){let k=U.continuedFraction(f,s),$=M.fromArray(k.fractions.map(he=>new i(he)));return M.fromArray([new i(k.sign),new i(k.whole),$])}return u.symfunction("continuedFraction",[o,s])}function St(o){let s=Mt(o);return s.isConstant()?new i(U.erf(s)):s.isImaginary()?E.erf(o):u.symfunction("erf",[o])}function Rt(o,s){if(o.isConstant()&&s.isConstant()){let k=new i(1);return k.multiplier=k.multiplier.multiply(o.multiplier.mod(s.multiplier)),k}let f=u.divide(o.clone(),s.clone());return vt(f)?new i(0):u.symfunction("mod",[o,s])}function n0(o,s,f){return typeof o!="boolean"&&_0(o)&&(o=!!Number(o)),o?s:f}function Vt(o,s){if(Re(o)){for(let f=0,k=o.rows();f<k;f++)for(let $=0,he=o.cols();$<he;$++)if(o.elements[f][$].equals(s))return new i(1)}else if(o.elements){for(let f=0,k=o.elements.length;f<k;f++)if(o.elements[f].equals(s))return new i(1)}return new i(0)}function Yt(o){return G.PARSE2NUMBER?o.isConstant()?new i(U.sinc(o)):u.parse(Ut("sin({0})/({0})",o)):u.symfunction("sinc",[o])}function jt(o){return o.fname===G.LOG&&o.isLinear()?u.pow(o.args[0],i.create(o.multiplier)):u.parse(Ut("e^({0})",o))}function l0(o){return u.parse(Ut("({0})*pi/180",o))}function ct(o){return u.parse(Ut("({0})*180/pi",o))}function N1(o){let s,f,k;if(o.group===He&&o.fname===""?(s=i.unwrapPARENS(u.parse(o).toLinear()),f=u.parse(o.power)):o.group===Ie&&(s=u.parse(o.value),f=u.parse(o.power)),s&&f&&s.group===Se&&f.group===Se){k=[];let $=i.toPolarFormArray(o),he=u.parse(s).abs().toString(),ie=me(s).toString(),ne=f.multiplier.den.toString(),Me=f.multiplier.num.toString(),Ne="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let Oe=0;Oe<Number(ne);Oe++){let ve=Mt(u.parse(Ut("(({0})+2*pi*({1}))/({2})",ie,Oe,ne))).multiplier.toDecimal();k.push(Mt(u.parse(Ut(Ne,he,ne,G.IMAGINARY,ve,Me))))}return M.fromArray(k)}if(o.isConstant(!0)){let $=o.sign(),he=Mt(o.abs()),ie=u.sqrt(he);k=[ie.clone(),ie.negate()],$<0&&(k=k.map(ne=>u.multiply(ne,i.imaginary())))}else k=[u.parse(o)];return M.fromArray(k)}function j0(o){if(o.isComposite()){let s=new i(0),f,k,$,he,ie,ne,Me,Ne;return o.each(Oe=>{f=Oe.getNum(),k=Oe.getDenom(),$=s.getNum(),he=s.getDenom(),ie=u.multiply(k,$),ne=u.multiply(f,he),Me=u.expand(u.add(ie,ne)),Ne=u.multiply(he,k),s=u.divide(Me,Ne)},!0),s}return o}function g(o){ue(o)||(o=u.parse(o));let s=u.symfunction("sqrt",[o]);if(o.group===$e)return u.symfunction(c,[o]);o.fname===""&&o.power.equals(1)&&(o=o.args[0]);let f=o.multiplier.sign()<0;if(G.PARSE2NUMBER){if(o.isConstant()&&!f)return new i(de.sqrt(o.multiplier.toDecimal()));if(o.isImaginary())return E.sqrt(o);if(o.group===te)return u.symfunction("sqrt",[o])}let k,$,he=o.isConstant();if(o.group===qe&&o.isLinear()){let ie=g(new i(o.multiplier));for(let ne in o.symbols){if(!Object.hasOwn(o.symbols,ne))continue;let Me=o.symbols[ne];ie=u.multiply(ie,g(Me))}$=ie}else if(o.fname===c){let ie=o.args[0],ne=o.multiplier;ie.setPower(o.power.multiply(new We(.25))),$=ie,ne.equals(1)||($=u.multiply(g(u.parse(ne)),$))}else if(!o.power.isInteger())o.setPower(o.power.multiply(new We(.5))),$=o;else if(Number(o.multiplier)<0&&o.group===te){let ie=u.parse(o.multiplier).negate(),ne=u.parse(o).toUnitMultiplier().negate();$=u.multiply(u.symfunction(G.SQRT,[ne]),g(ie))}else{let ie=o.power.sign();o.power=o.power.abs(),he&&o.multiplier.lessThan(0)&&(k=i.imaginary(),o.multiplier=o.multiplier.abs());let ne=Number(o.multiplier.toDecimal()),Me=Math.abs(ne),Ne=Math.sqrt(Me),Oe;if(vt(Ne))Oe=new i(Ne);else if(vt(ne)){let ve=U.ifactor(ne),ze=1;for(let gt in ve){if(!Object.hasOwn(ve,gt))continue;let wt=ve[gt],tt=wt-wt%2;if(tt){let ke=Number(gt)**tt;ze*=Number(gt)**(tt/2),ne/=ke}}Oe=u.multiply(u.symfunction(c,[new i(ne)]),new i(ze))}else{let ve=[new i(o.multiplier.num),new i(o.multiplier.den)],ze=[new i(1),new i(1)],gt=[new i(1),new i(1)],wt=u;for(let tt=0;tt<2;tt++){let ke=ve[tt];T(ke).each(rt=>{rt=i.unwrapPARENS(rt);let it=rt.clone().toLinear(),ut=Number(rt.power),Et=ut%2,ht=(ut-Et)/2;ze[tt]=wt.multiply(ze[tt],wt.pow(it,new i(ht))),gt[tt]=wt.multiply(gt[tt],g(wt.pow(it,new i(Et))))})}Oe=u.divide(u.multiply(ze[0],gt[0]),u.multiply(ze[1],gt[1]))}o=o.toUnitMultiplier(!0),o.isOne()?$=o:kt(o.power.toString())?$=u.pow(o.clone(),new i(.5)):$=u.symfunction(c,[o]),ie<0&&$.power.negate(),Oe&&($=u.multiply(Oe,$)),k&&($=u.multiply(k,$))}return et&&G.PARSE2NUMBER&&$.text()!==s.text()?u.parse($):$}function y(o){if(!o.isConstant(!0)){let s,f=Number(o.power)/3,k=u.pow(u.parse(o.multiplier),new i(1/3)),$=o.toUnitMultiplier();return vt(f)?s=u.pow($.toLinear(),u.parse(String(f))):$.group===qe?(s=new i(1),$.each(he=>{s=u.multiply(s,y(he))})):s=u.symfunction("cbrt",[$]),u.multiply(k,s)}return A(o,new i(3))}function N(o,s){return o.scientific=s||10,o}function A(o,s,f=void 0,k=void 0){if(s=Mt(u.parse(s)),s.equals(0))throw new Kt("Unable to calculate nthroots of zero");if(Number(o)<0&&kt(s))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!o.isConstant(!0)){let ne=[o,s];return typeof f<"u"&&ne.push(f),typeof k<"u"&&ne.push(k),u.symfunction("nthroot",ne)}o.group!==Se&&(o=Mt(o)),typeof k>"u"&&(k=!0),f||=25;let $=o.sign(),he,ie;if($<0&&(o=Fe(o)),vt(o)&&s.isConstant())return Number(o)<18446744073709552e3?ie=We.create(Number(o)**(1/Number(s))):ie=U.nthroot(o,s),k?he=new i(ie):he=new i(ie.toDecimal(f)),u.multiply(new i($),he)}function T(o){if(o.greaterThan(9999999999998891e26)||o.equals(-1))return o;if(o.equals(Math.PI))return new i(Math.PI);o=Mt(o.clone());let s;if(o.isConstant()){s=new i(1);let f=o.toString();if(vt(f)){let k=U.ifactor(f);for(let $ in k){if(!Object.hasOwn(k,$))continue;let he=k[$];s=u.multiply(s,u.symfunction("parens",[new i($).setPower(new We(he))]))}}else{let k=T(new i(o.multiplier.num)),$=T(new i(o.multiplier.den));s=u.multiply(u.symfunction("parens",[k]),u.symfunction("parens",[$]).invert())}}else s=u.symfunction("pfactor",[o]);return s}function R(o){return o.realpart()}function W(o){return o.imagpart()}function re(o){let s=o.realpart(),f=o.imagpart();return u.add(s,u.multiply(f.negate(),i.imaginary()))}function me(o){let s=o.realpart(),f=o.imagpart();return s.isConstant()&&f.isConstant()?f.equals(0)&&s.equals(1)?u.parse("0"):f.equals(1)&&s.equals(0)?u.parse("pi/2"):f.equals(0)&&s.equals(-1)?u.parse("pi"):f.equals(-1)&&s.equals(0)?u.parse("-pi/2"):f.equals(1)&&s.equals(1)?u.parse("pi/4"):f.equals(1)&&s.equals(-1)?u.parse("pi*3/4"):f.equals(-1)&&s.equals(1)?u.parse("-pi/4"):f.equals(-1)&&s.equals(-1)?u.parse("-pi*3/4"):new i(Math.atan2(Number(f),Number(s))):u.symfunction("atan2",[f,s])}function oe(o){let s=i.toPolarFormArray(o),f=s[1],k=s[0],$=u.parse(Ut("e^({0}*({1}))",G.IMAGINARY,f));return u.multiply(k,$)}function Ae(o){let s=o.clone();try{let f=Ge(o,"e",!0),k=u.divide(f.x.power,i.imaginary()),$=Mt(_.tan(k)),he=u.pow(f.a,new i(2)),ie=$.getDenom(!0),ne=$.getNum();return i.hyp(ne,ie).equals(f.a)?u.add(ie,u.multiply(i.imaginary(),ne)):s}catch(f){if(f.message==="timeout")throw f;return s}}function Te(o,s){s.forEach(ne=>{ne.numVal=Mt(ne).multiplier});let f,k,$,he,ie;for(;;){if(f=s.length,f<2)return s[0];k=s.pop(),$=s[f-2],(o==="min"?k.numVal<$.numVal:k.numVal>$.numVal)&&(s.pop(),s.push(k))}}function Pe(...o){return W0(o)?o[0]:m1(o)?new i(Math.max.apply(null,o)):G.SYMBOLIC_MIN_MAX&&j(o)?Te("max",o):u.symfunction("max",o)}function lt(...o){return W0(o)?o[0]:m1(o)?new i(Math.min.apply(null,o)):G.SYMBOLIC_MIN_MAX&&j(o)?Te("min",o):u.symfunction("min",o)}function yt(o){return o.isConstant(!0)?new i(Math.sign(Mt(o))):u.symfunction("sign",[o])}function pt(o,s){s=s?s.toString():"asc";let f=function($){return $.group===Se?$.multiplier:$.group===He?$.fname===""?f($.args[0]):$.fname:$.group===te?$.power:$.value},k=ae(o)?o.elements:o.collectSymbols();return new M(k.sort(($,he)=>{let ie=f($),ne=f(he);return s==="desc"?ne-ie:ie-ne}))}function Nt(o,s=void 0){if(o.equals(1))return new i(0);let f;if(o.fname===c&&o.multiplier.equals(1))return f=u.divide(Nt(o.args[0]),new i(2)),o.power.sign()<0&&f.negate(),f;if(o.equals(0))throw new Kt(`${G.LOG}(0) is undefined!`);if(o.isImaginary())return E.evaluate(o,G.LOG);if(o.isConstant()&&typeof s<"u"&&s.isConstant()){let k=Math.log(o),$=Math.log(s);f=new i(k/$)}else if(o.group===$e&&o.power.multiplier.lessThan(0)||o.power.toString()==="-1")o.power.negate(),f=Nt(o).negate();else if(o.value==="e"&&o.multiplier.equals(1)){let k=o.power;f=ue(k)?k:new i(k)}else if(o.group===He&&o.fname==="exp"){let k=o.args[0];o.multiplier.equals(1)?f=u.multiply(k,new i(o.power)):f=u.symfunction(G.LOG,[o])}else if(G.PARSE2NUMBER&&_0(o)){o=u.parse(o);let k;o.multiplier.lessThan(0)&&(o.negate(),k=u.multiply(new i(Math.PI),new i("i"))),f=new i(Math.log(o.multiplier.toDecimal())),k&&(f=u.add(f,k))}else{let k;!o.power.equals(1)&&!o.contains("e")&&o.multiplier.isOne()&&(k=o.group===$e?o.power:new i(o.power),o.toLinear());let $=typeof s>"u"?[o]:[o,s];$.length>1&&W0($)?f=new i(1):f=u.symfunction(G.LOG,$),k&&(f=u.multiply(k,f))}return f}function Lt(o,s){let f=s&&s.isConstant()||typeof s>"u";if(o.isConstant()&&f){let $,he,ie;$=o,s&&s.lessThan(0)&&(s=Fe(s),he=Number(o).toExponential().toString().split("e"),$=he[0],ie=he[1]);let ne=new i(v0(Number($),Number(s)||0));return u.multiply(ne,u.pow(new i(10),new i(ie||0)))}let k=[o];return typeof s<"u"&&k.push(s),u.symfunction("round",k)}function Zt(o){let s=Number(o)%2,f;return s<0&&(s=2+s),s>=0&&s<=.5?f=1:s>.5&&s<=1?f=2:s>1&&s<=1.5?f=3:f=4,f}function At(o){if(!isFinite(o)){let f=Math.sign(o),k=new i(String(Math.abs(o)));return k.multiplier=k.multiplier.multiply(new We(f)),k}if(ue(o))return o;if(typeof o=="number")try{o=We.simple(o)}catch(f){if(f.message==="timeout")throw f;o=new We(o)}let s=new i(0);return s.multiplier=o,s}function Pt(o){let s=o.group,f;if(s===Xe){let k=o.getNum(),$=o.getDenom()||new i(1),he=Number(o.power),ie=new i(1);if(Math.abs(he)===1){$.each(Ne=>{Ne.group===qe?ie=u.multiply(ie,Pt(Ne.getDenom())):Ne.power.lessThan(0)&&(ie=u.multiply(ie,Pt(Ne.clone().toUnitMultiplier())))});let ne=new i(0);$.each(Ne=>{ne=u.add(u.divide(Ne,ie.clone()),ne)}),ie.invert();let Me;k.isComposite()?(Me=new i(0),k.each(Ne=>{Me=u.add(u.multiply(Pt(Ne),ie.clone()),Me)})):Me=u.multiply(ie,k),f=u.divide(Me,ne)}}else s===qe?(f=new i(1),o.each(k=>{f=u.multiply(f,u.clean(k))})):s===He&&o.args.length===1&&o.args[0].isConstant()&&(f=Ht("PARSE2NUMBER",()=>u.parse(o),!0));return f||=o,f}function N0(o,s){return s||={expand_denominator:!0,expand_functions:!0},xt(o,s)}function xt(o,s){if(Array.isArray(o))return o.map(k=>xt(k,s));if(o.expand)return o.expand(s);if(s||={},o.group===He&&o.fname===""){let k=xt(o.args[0],s),$=xt(u.pow(k,u.parse(o.power)),s);return u.multiply(u.parse(o.multiplier),$).distributeMultiplier()}if([Se,Ie,te].indexOf(o.group)!==-1)return o;let f=o.clone();try{let k=o.multiplier.toString(),$=Number(o.power),he=o;if(o.isComposite()&&vt(o.power)&&o.power>0){let ie=$-1,ne=new i(0);o.each(Ne=>{ne=u.add(ne,xt(u.parse(Ne),s))});let Me=u.parse(ne);for(let Ne=0;Ne<ie;Ne++)Me=x(Me,ne,s);he=u.multiply(u.parse(k),Me).distributeMultiplier()}else if(o.group===He&&s.expand_functions===!0){let ie=[];o.args.forEach(ne=>{ie.push(xt(ne,s))}),he=u.pow(u.symfunction(o.fname,ie),u.parse(o.power)),he=u.multiply(he,u.parse(o.multiplier))}else if(o.isComposite()&&vt(o.power)&&o.power<0&&s.expand_denominator===!0)o=o.invert(),he=xt(o,s),he.invert();else if(o.group===qe){let ie=function(Ne){switch(Ne.group){case Xe:return 0;case Be:return 1;case qe:return 2;case He:return 3;default:return 4}},ne=o.collectSymbols().sort((Ne,Oe)=>ie(Oe)-ie(Ne)).map(Ne=>{let Oe=u.pow(Ne,u.parse(String($)));return xt(Oe,s)}),Me=ne.pop();Me.isComposite()&&Me.isLinear()?(ne.forEach(Ne=>{Me=x(Me,Ne,s)}),Me.isComposite()?(Me.power>1&&(Me=xt(u.pow(Me,u.parse(Me.power)),s)),he=u.multiply(u.parse(k),Me).distributeMultiplier()):he=Me):(he=Me,ne.forEach(Ne=>{he=u.multiply(he,Ne)}),he=u.multiply(he,u.parse(k)).distributeMultiplier()),he.group===qe&&(he=u.parse(he))}else he=o;return he}catch(k){if(k.message==="timeout")throw k;return f}}function R0(o){return C.identity(o)}function M0(o,s){return s.isConstant()&&vt(s)?o.elements[Number(s)]:u.symfunction("vecget",[o,s])}function w0(o,s){return s=typeof s>"u"?1e-14:s,o=o.clone(),s=Number(s),o.elements.sort((f,k)=>k.group-f.group),o.elements=jn(o.elements,(f,k)=>Number(u.subtract(Mt(f),Mt(k)).abs())<=s),o}function L0(o,s,f){return s.isConstant?(o.elements[Number(s)]=f,o):u.symfunction("vecset",[o,s,f])}function i0(o,s,f){return s.isConstant()&&f.isConstant()?o.elements[Number(s)][Number(f)]:u.symfunction("matget",[o,s,f])}function A0(o,s){return s.isConstant()?new C(o.elements[s]):u.symfunction("matgetrow",[o,s])}function I0(o,s,f){if(!s.isConstant())return u.symfunction("matsetrow",[o,s,f]);if(o.elements[Number(s)].length!==f.elements.length)throw new h1("Matrix row must match row dimensions!");let k=o.clone();return k.elements[Number(s)]=f.clone().elements,k}function U0(o,s){if(!s.isConstant())return u.symfunction("matgetcol",[o,s]);let f=Number(s),k=C.fromArray([]);return o.each(($,he,ie)=>{ie===f&&k.elements.push([$.clone()])}),k}function zt(o,s,f){if(!s.isConstant())return u.symfunction("matsetcol",[o,s,f]);let k=Number(s);if(o.rows()!==f.elements.length)throw new h1("Matrix column length must match number of rows!");return f.each((($,he)=>{o.set(he-1,k,$.elements[0].clone())})),o}function Ct(o,s,f,k){return o.elements[s][f]=k,o}function pn(...o){return new M(o)}function hn(...o){return C.fromArray(o)}function gn(...o){return o0.fromArray(o)}function mn(o){return Re(o)?o.determinant():o}function dn(o){let s;return Re(o)?s=[new i(o.cols()),new i(o.rows())]:ae(o)||x1(o)?s=new i(o.elements.length):Ft("size expects a matrix or a vector"),s}function wn(o,s){return Re(o)&&(o=new M(o)),Re(s)&&(s=new M(s)),ae(o)&&ae(s)?o.dot(s):u.multiply(o.clone(),s.clone())}function vn(o,s){return Re(o)&&(o=new M(o)),Re(s)&&(s=new M(s)),ae(o)&&ae(s)?o.cross(s):u.multiply(o.clone(),s.clone())}function Sn(o){return Re(o)?o.transpose():Ft("function transpose expects a matrix")}function yn(o){return Re(o)?o.invert():Ft("invert expects a matrix")}function En(o,s){return o.union(s)}function Nn(o,s){return o.intersection(s)}function Mn(o,s){return o.contains(s)}function An(o,s){return o.difference(s)}function In(o,s){return new i(Number(o.intersects(s)))}function qn(o,s){return new i(Number(o.isSubset(s)))}function _n(o,s){s??=o;let f=Ue.slice(o,s).map(k=>new i(k));return f.length===1?f[0]:f.length===0?new i(0):new M(f)}function On(...o){o.forEach(s=>{console.log(s.toString())})}function o1(o){if(!ue(o.power)&&o.power.absEquals(.5)){let s=o.power.sign(),f=g(o.group===Ie?new i(o.value):o.toLinear());return s<0&&f.invert(),f}return o}function Cn(o){if(o.group===Ie){let s=o.value,f=Ui(s)[0];if(!f)return d1("Unable to compute prime factors. This should not happen. Please review and report."),o;let $=new We(Math.log(s)/Math.log(f)).multiply(o.power);if($.den>o.power.den)return o;vt($)?o=new i(f**Number($)):o=new i(f).setPower($)}return o}this.expand=xt,this.round=Lt,this.clean=Pt,this.sqrt=g,this.cbrt=y,this.abs=Fe,this.log=Nt,this.rationalize=j0,this.nthroot=A,this.arg=me,this.conjugate=re,this.imagpart=W,this.realpart=R,this.getFunction=function(s){return K[s][0]},this.addPreprocessor=function(s,f,k,$){let{names:he}=r,{actions:ie}=r;if(typeof f!="function")throw new Error("Incorrect parameters. Function expected!");k?$?(he.splice(k,0,s),ie.splice(k,0,f)):(he[k]=s,ie[k]=f):(he.push(s),ie.push(f))},this.getPreprocessors=function(){let s={};for(let f=0,k=r.names.length;f<k;f++){let $=r.names[f];s[$]={order:f,action:r.actions[f]}}return s},this.removePreprocessor=function(s,f){let k=r.names.indexOf(s);f?(S0(r.names,k),S0(r.actions,k)):(r.names[k]=void 0,r.actions[k]=void 0)},this.mappedFunction=function(...s){let f={},{params:k}=this;for(let $=0;$<k.length;$++)f[k[$]]=String(s[$]);return u.parse(this.body,f)},this.add=function(s,f){let k=ue(s),$=ue(f);if(k&&$){if(s.unit||f.unit)return u.Unit.add(s,f);if(s.isInfinity||f.isInfinity){let ht=s.multiplier.lessThan(0),Tt=f.multiplier.lessThan(0);if(s.isInfinity&&f.isInfinity&&ht!==Tt)throw new Kt(`(${s})+(${f}) is not defined!`);let Wt=i.infinity();return Tt&&Wt.negate(),Wt}if(s.isComposite()&&s.isLinear()&&f.isComposite()&&f.isLinear()&&(s.distributeMultiplier(),f.distributeMultiplier(),f.length>s.length&&s.group===f.group&&([s,f]=[f,s])),s.multiplier.equals(0))return f;if(f.multiplier.equals(0))return s;if(s.isConstant()&&f.isConstant()&&G.PARSE2NUMBER)return new i(s.multiplier.add(f.multiplier).toDecimal(G.PRECISION));let ie=s.group,ne=f.group,Me=s.power.toString(),Ne=f.power.toString();if(ie<ne||ie===ne&&Number(Me)>Number(Ne)&&Number(Ne)>0)return this.add(f,s);if(ie===qe&&ne===Be&&s.value===f.value){let ht=s;s=f,f=ht,ie=s.group,ne=f.group,Me=s.power.toString(),Ne=f.power.toString()}let Oe=Me===Ne,ve=s.value,ze=f.value,gt=s.isComposite(),wt=f.isComposite(),tt,ke,rt;if(gt&&(tt=q(s,"hash")),wt&&(ke=q(f,"hash")),ie===Xe&&ne===Xe&&f.isLinear()&&!s.isLinear()&&tt!==ke)return this.add(f,s);ie===Be&&ne===Be&&(ve=tt,ze=ke);let it=ie===Ie&&ne===Se,ut=s.value===f.multiplier.toString(),Et=ve===ze||tt===ke&&tt!==void 0||it&&ut;if(Et&&Oe&&ie===ne)if(it&&(f=f.convert(Ie)),ie===Be&&(ne===te||ne===Ie))s.distributeMultiplier(),rt=s.attach(f);else if(rt=s,s.multiplier.isOne()&&f.multiplier.isOne()&&ie===Xe&&s.isLinear()&&f.isLinear())for(let ht in f.symbols){if(!Object.hasOwn(f.symbols,ht))continue;let Tt=f.symbols[ht];rt.attach(Tt)}else rt.multiplier=rt.multiplier.add(f.multiplier);else if(Et&&ie!==Be)ie===Xe&&ne===Be?(f.insert(s,"add"),rt=f):(rt=i.shell(Be).attach([s,f]),rt.value=ie===Be?tt:ve);else if(gt&&s.isLinear()){let ht=ie===ne,Tt=ie===Be&&ne===Be;if(Tt&&(ht=s.value===f.value),s.distributeMultiplier(),f.isComposite()&&f.isLinear()&&ht){f.distributeMultiplier();for(let Wt in f.symbols){if(!Object.hasOwn(f.symbols,Wt))continue;let a0=f.symbols[Wt];s.attach(a0)}rt=s}else Tt&&s.value!==ke||ie===Be&&!Et?(rt=i.shell(Xe).attach([s,f]),rt.updateHash()):rt=s.attach(f)}else{if(ie===He&&s.fname===c&&ne!==$e&&f.power.equals(.5)){let ht=f.multiplier.clone();f=g(f.toUnitMultiplier().toLinear()),f.multiplier=ht}s.length===2&&f.length===2&&kt(s.power)&&kt(f.power)?rt=u.add(xt(s),xt(f)):(rt=i.shell(Xe).attach([s,f]),rt.updateHash())}if(rt.multiplier.equals(0)&&(rt=new i(0)),rt.length===1){let ht=rt.multiplier;rt=J0(rt.symbols),rt.multiplier=rt.multiplier.multiply(ht)}return rt}if($&&!k){let ie=s;s=f,f=ie,ie=$,$=k,k=ie}let he=Re(f);if(k&&he){let ie=new C;f.eachElement((ne,Me,Ne)=>{ie.set(Me,Ne,u.add(s.clone(),ne))}),f=ie}else if(Re(s)&&he)f=s.add(f);else if(k&&ae(f))f.each((ie,ne)=>{ne--,f.elements[ne]=u.add(s.clone(),f.elements[ne])});else if(ae(s)&&ae(f))f.each((ie,ne)=>{ne--,f.elements[ne]=u.add(s.elements[ne],f.elements[ne])});else{if(ae(s)&&Re(f))return u.add(f,s);if(Re(s)&&ae(f)){if(f.elements.length===s.rows()){let ie=new C,ne=s.cols();return f.each((Me,Ne)=>{let Oe=[];if(ae(Me))for(let ve=0;ve<ne;ve++)Oe.push(u.add(s.elements[Ne-1][ve].clone(),Me.elements[ve].clone()));else for(let ve=0;ve<ne;ve++)Oe.push(u.add(s.elements[Ne-1][ve].clone(),Me.clone()));ie.elements.push(Oe)}),ie}Ft("Dimensions must match!")}}return f},this.subtract=function(s,f){let k=ue(s),$=ue(f),he;if(k&&$){let ie=s,ne=f;return ie.unit||ne.unit?u.Unit.subtract(ie,ne):this.add(ie,ne.negate())}if($&&ae(s))f=s.map(ie=>u.subtract(ie,f.clone()));else if(k&&ae(f))f=f.map(ie=>u.subtract(s.clone(),ie));else if(ae(s)&&ae(f)||g1(s)&&g1(f))s.dimensions()===f.dimensions()?f=s.subtract(f):u.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(Re(s)&&ae(f)){if(f.elements.length===s.rows()){let ie=new C,ne=s.cols();return f.each((Me,Ne)=>{let Oe=[];for(let ve=0;ve<ne;ve++)Oe.push(u.subtract(s.elements[Ne-1][ve].clone(),Me.clone()));ie.elements.push(Oe)}),ie}Ft("Dimensions must match!")}else if(ae(s)&&Re(f)){let ie=f.clone().negate();return u.add(ie,s)}else if(Re(s)&&Re(f))f=s.subtract(f);else if(Re(s)&&$){let ie=new C;s.each((ne,Me,Ne)=>{ie.set(Me,Ne,u.subtract(ne,f.clone()))}),f=ie}else if(k&&Re(f)){let ie=new C;f.each((ne,Me,Ne)=>{ie.set(Me,Ne,u.subtract(s.clone(),ne))}),f=ie}return f},this.multiply=function(s,f){let k=ue(s),$=ue(f);if(k&&f instanceof $t)return f.elements.push(s),f;if(k&&$){if(f.isUnit){let it=s.clone();return s.unit=f,it}if(s.unit||f.unit)return u.Unit.multiply(s,f);if(s.isInfinity||f.isInfinity){if(s.equals(0)||f.equals(0))throw new Kt(`${s}*${f} is undefined!`);if(f.power.lessThan(0)){if(!s.isInfinity)return new i(0);throw new Kt("Infinity/Infinity is not defined!")}let it=s.multiplier.multiply(f.multiplier).sign(),ut=i.infinity();if(s.isConstant()||f.isConstant()||s.isInfinity&&f.isInfinity)return it<0&&ut.negate(),ut}if(s.multiplier.equals(0)||f.multiplier.equals(0))return new i(0);if(s.isOne())return f.clone();if(f.isOne())return s.clone();if(s.isConstant()&&f.isConstant()&&G.PARSE2NUMBER){let it,ut=s.multiplier.num.abs().toString().length,Et=s.multiplier.den.toString().length,ht=ut-Et,Tt=f.multiplier.num.abs().toString().length,Wt=f.multiplier.den.toString().length,a0=Tt-Wt,dt=G.PRECISION-5;if(ht<-dt||ht>dt||a0<-dt||a0>dt){let _t=new de(String(s.multiplier.num)),Qt=new de(String(s.multiplier.den)),$0=new de(String(f.multiplier.num)),h0=new de(String(f.multiplier.den));it=new i(_t.times($0).dividedBy(Qt).dividedBy(h0).toFixed())}else{let _t=new de(s.multiplier.toDecimal()),Qt=new de(f.multiplier.toDecimal()),$0=_t.times(Qt).toFixed();it=new i($0)}return it}if(f.group>s.group&&f.group!==Xe)return this.multiply(f,s);if(s.group===qe&&f.group===Be&&s.value===f.value){let it=s;s=f,f=it}let ne=s.group,Me=f.group,Ne=f.multiplier.num,Oe=f.multiplier.den;if(ne===He&&s.fname===c&&!f.isConstant()&&s.args[0].value===f.value&&!s.args[0].multiplier.lessThan(0)){let it=s.power,ut=u.parse(s.multiplier);s=u.multiply(ut,s.args[0].clone()),s.setPower(new We(.5).multiply(it)),ne=s.group}else ne===He&&s.fname===c&&s.multiplier.equals(1)&&s.power.equals(-1)&&f.isConstant()&&s.args[0].equals(f)&&(s=u.symfunction(c,[f.clone()]),f=new i(1));let ve=s.value,ze=f.value,gt=new We(s.sign()),wt=ne===Ie&&Me===Se&&f.multiplier.equals(s.value),tt=wt?new We(1).multiply(s.multiplier).abs():s.multiplier.multiply(f.multiplier).abs(),ke=s.clone().toUnitMultiplier();if(f=f.clone().toUnitMultiplier(!0),ne===He&&Me===He){let it=s.args[0].clone(),ut=f.args[0].clone();if(s.fname===c&&f.fname===c&&s.isLinear()&&f.isLinear()){let Et=u.divide(it,ut).invert();Et.gt(1)&&vt(Et)&&(ke=u.multiply(s.args[0].clone(),g(Et.clone())),f=new i(1))}else if(s.fname===a&&f.fname===a&&!it.isConstant()&&!ut.isConstant()&&f.power<0){let Et=u.subtract(it.clone(),ut.clone());if(Et.isConstant()){let ht=new i(1);if(Et<0){for(let Tt=0,Wt=Math.abs(Et);Tt<=Wt;Tt++){let a0=u.add(it.clone(),new i(Tt));ht=u.multiply(ht,a0)}ke=u.multiply(u.pow(it,new i(s.power)),u.pow(ht,new i(f.power))),f=new i(1)}else{for(let Tt=0,Wt=Math.abs(Et);Tt<=Wt;Tt++){let a0=u.add(ut.clone(),new i(Tt));ht=u.multiply(ht,a0)}ke=u.multiply(u.pow(ht,new i(s.power)),u.pow(ut,new i(f.power))),f=new i(1)}}}}if(ve===ze&&ne===Be&&ne===Me&&(ve=s.text("hash"),ze=f.text("hash")),Me===$e&&f.previousGroup===Be&&ne===Be&&(ve=q(s,"hash",$e)),(ve===ze||wt)&&!(ne===Be&&(Me===te||Me===Ie||Me===He))&&!(ne===Be&&Me===qe)){let it=s.power,ut=f.power,Et=ue(it),ht=ue(ut),Tt=Et||ht;ne===Be&&Me!==Be&&f.previousGroup!==Be&&it.equals(1)?(ke=new i(0),s.each(Wt=>{ke=u.add(ke,u.multiply(Wt,f.clone()))},!0)):(Tt?ke.power=u.add(ue(it)?it:new i(it),ue(ut)?ut:new i(ut)):ne===Se?ke.power=it:ke.power=it.add(ut),ke.power.equals(0)&&(ke=ke.convert(Se)),Tt&&ke.convert($e),s.imaginary&&f.imaginary&&kt(Number(ke.power)%2)&&(ke=new i(1),tt.negate()),ke.group!==$e&&ke.previousGroup&&(ke.previousGroup=void 0),ke.multiplier=ke.multiplier.multiply(f.multiplier))}else if(ne===qe&&s.isLinear())if(Me===qe&&f.distributeExponent(),Me===qe&&f.isLinear()){for(let it in f.symbols){if(!Object.hasOwn(f.symbols,it))continue;let ut=f.symbols[it];ke=ke.combine(ut)}ke.multiplier=ke.multiplier.multiply(f.multiplier)}else ke.combine(f);else if(ne===Se)ke=f.clone().toUnitMultiplier(!0);else if(ne===qe)ke.distributeExponent(),ke.combine(f);else if(!f.isOne()){let it=f.multiplier.clone();f.toUnitMultiplier(),ke=i.shell(qe).combine([ke,f]),ke.multiplier=ke.multiplier.multiply(it)}if(ke.group===Ie){let it=Math.log(ke.value),ut=Math.log(Ne)/it,Et=Math.log(Oe)/it,ht=tt.num/Ne,Tt=tt.den/Oe;ut!==0&&vt(ut)&&vt(ht)&&(ke.power=ke.power.add(new We(ut)),tt.num/=Ne),Et!==0&&vt(Et)&&vt(Tt)&&(ke.power=ke.power.subtract(new We(Et)),tt.den/=Oe)}if(ke.length===1){let it=ke.multiplier;ke=J0(ke.symbols),ke.multiplier=ke.multiplier.multiply(it)}let rt=ke.power.toString();if(kt(rt)&&ke.fname===c){gt=gt.multiply(new We(ke.sign()));let it=ke.power;ke=ke.args[0],ke=u.multiply(new i(tt),u.pow(ke,new i(it.divide(new We(2))))),gt.lessThan(0)&&ke.negate()}else ke.multiplier=ke.multiplier.multiply(tt).multiply(gt),ke.group===Xe&&ke.isImaginary()&&ke.distributeMultiplier();return ke.group===Ie&&vt(ke.power.toDecimal())&&(ke=ke.convert(Se)),ke}if($&&!k){let ne=s;s=f,f=ne,ne=$,$=k,k=ne}let he=Re(f),ie=Re(s);if(k&&he){let ne=new C;f.eachElement((Me,Ne,Oe)=>{ne.set(Ne,Oe,u.multiply(s.clone(),Me))}),f=ne}else if(ie&&he)f=s.multiply(f);else if(k&&ae(f))f.each((ne,Me)=>{Me--,f.elements[Me]=u.multiply(s.clone(),f.elements[Me])});else if(ae(s)&&ae(f))f.each((ne,Me)=>{Me--,f.elements[Me]=u.multiply(s.elements[Me],f.elements[Me])});else{if(ae(s)&&Re(f))return this.multiply(f,s);if(Re(s)&&ae(f)){if(f.elements.length===s.rows()){let ne=new C,Me=s.cols();return f.each((Ne,Oe)=>{let ve=[];for(let ze=0;ze<Me;ze++)ve.push(u.multiply(s.elements[Oe-1][ze].clone(),Ne.clone()));ne.elements.push(ve)}),ne}Ft("Dimensions must match!")}}return f},this.divide=function(s,f){let k=ue(s),$=ue(f);if(k&&$){if(s.unit||f.unit)return u.Unit.divide(s,f);let ne;if(f.equals(0))throw new f1("Division by zero not allowed!");return s.isConstant()&&f.isConstant()?(ne=s.clone(),ne.multiplier=ne.multiplier.divide(f.multiplier)):(f.invert(),ne=u.multiply(s,f)),ne}let he=ae(s),ie=ae(f);if(k&&ie)f=f.map(ne=>u.divide(s.clone(),ne));else if(he&&$)f=s.map(ne=>u.divide(ne,f.clone()));else if(he&&ie)s.dimensions()===f.dimensions()?f=f.map((ne,Me)=>u.divide(s.elements[--Me],ne)):u.error("Cannot divide vectors. Dimensions do not match!");else{let ne=Re(s),Me=Re(f);if(ne&&$){let Ne=new C;s.eachElement((Oe,ve,ze)=>{Ne.set(ve,ze,u.divide(Oe,f.clone()))}),f=Ne}else if(k&&Me){let Ne=new C;f.eachElement((Oe,ve,ze)=>{Ne.set(ve,ze,u.divide(s.clone(),Oe))}),f=Ne}else if(ne&&Me){let Ne=new C;s.rows()===f.rows()&&s.cols()===f.cols()?(s.eachElement((Oe,ve,ze)=>{Ne.set(ve,ze,u.divide(Oe,f.elements[ve][ze]))}),f=Ne):u.error("Dimensions do not match!")}else if(ne&&ie)if(s.cols()===f.dimensions()){let Ne=new C;s.eachElement((Oe,ve,ze)=>{Ne.set(ve,ze,u.divide(Oe,f.elements[ve].clone()))}),f=Ne}else u.error("Unable to divide matrix by vector.")}return f},this.pow=function(s,f){let k=ue(s),$=ue(f);if(k&&$){if(s.unit||f.unit)return u.Unit.pow(s,f);if(s.group===He&&s.fname===d&&kt(f)){let tt=s.multiplier.clone(),ke=u.pow(s.args[0],f);return ke.multiplier=tt,ke}if(s.isInfinity||f.isInfinity){if(s.isInfinity&&f.isInfinity)throw new Kt(`(${s})^(${f}) is undefined!`);if(s.isConstant()&&f.isInfinity){if(s.equals(0)){if(f.lessThan(0))throw new Kt("0^Infinity is undefined!");return new i(0)}if(s.equals(1))throw new Kt(`1^${f.toString()} is undefined!`);if(f.lessThan(0))return new i(0);if(!s.lessThan(0))return i.infinity()}if(s.isInfinity&&f.isConstant()){if(f.equals(0))throw new Kt(`${s}^0 is undefined!`);return f.lessThan(0)?new i(0):u.multiply(i.infinity(),u.pow(new i(s.sign()),f.clone()))}}let he=s.equals(0),ie=f.equals(0);if(he&&ie)throw new Kt("0^0 is undefined!");if(he&&f.isConstant()&&f.multiplier.greaterThan(0))return new i(0);if(ie)return new i(1);let ne=f.isConstant(),Me=s.isConstant(),Ne=f.isInteger(),Oe=s.multiplier,ve=s.clone();if(Me&&ne&&s.equals(0)&&f.lessThan(0))throw new Kt("Division by zero is not allowed!");if(G.PARSE2NUMBER&&Me&&ne&&s.sign()<0&&u1(f)){let tt=Math.PI*Number(f.multiplier.toDecimal()),ke=new i(Math.cos(tt)),rt=u.multiply(i.imaginary(),new i(Math.sin(tt)));return u.add(ke,rt)}if(G.PARSE2NUMBER&&s.isImaginary()&&ne&&vt(f)&&!f.lessThan(0)){let tt,ke,rt,it,ut,Et=s.realpart(),ht=s.imagpart();if(Et.isConstant("all")&&ht.isConstant("all"))return ut=G.USE_BIG?new i(de.atan2(ht.multiplier.toDecimal(),Et.multiplier.toDecimal()).times(f.toString())):Math.atan2(Number(ht.multiplier.toDecimal()),Number(Et.multiplier.toDecimal()))*Number(f.multiplier.toDecimal()),ke=new i(ut),tt=u.pow(i.hyp(Et,ht),f),rt=u.multiply(tt.clone(),u.trig.cos(ke.clone())),it=u.multiply(tt,u.trig.sin(ke)),u.add(rt,u.multiply(i.imaginary(),it))}ve.toUnitMultiplier();let ze;if(ve.group===He&&ve.fname===c&&!ne){let tt=ve.args[0];tt.multiplyPower(new i(.5)),tt.multiplier.multiply(ve.multiplier),tt.multiplyPower(f),ve=tt}else ze=Oe.sign(),u1(f)&&ze<0&&(ve.negate(),ve=u.symfunction(J,[ve]),ve.negate()),ve.multiplyPower(f);let gt,wt;if(Me&&ne&&G.PARSE2NUMBER){let tt;ze<0&&(s.negate(),f.multiplier.den.equals(2)?tt=new i(G.IMAGINARY):vt(f.multiplier)?kt(f.multiplier)?tt=new i(1):tt=new i(-1):kt(f.multiplier.den)?tt=u.pow(u.symfunction(J,[new i(ze)]),f.clone()):tt=new i(ze**f.multiplier.num));let ke=Number(s.multiplier.toDecimal())**Number(f.multiplier.toDecimal());if(ke!==0||s.multiplier.equals(0))ve=new i(ke);else{let rt=new de(s.multiplier.toDecimal()),it=new de(f.multiplier.toDecimal());ve=new i(rt.pow(it).toFixed())}tt&&(ve=u.multiply(ve,tt))}else if(Ne&&!Oe.equals(1)){if(f.abs().gt(G.MAX_EXP))return f.sign()<0?new i(0):i.infinity();let ke=f.multiplier.toDecimal(),rt=Math.sign(Number(ke)),it=Math.abs(Number(ke)),ut=new We(1);ut.num=Oe.num.pow(it),ut.den=Oe.den.pow(it),rt<0&&ut.invert(),ve.multiplier=ve.multiplier.multiply(ut)}else{let tt=s.sign();if(f.isConstant()&&s.isConstant()&&!f.multiplier.den.equals(1)&&tt<0)if(f.multiplier.den.equals(2)){let ke=new i(G.IMAGINARY);s.negate(),f.lessThan(0)&&(ke.negate(),f.negate()),ve=u.multiply(u.pow(s,f),ke)}else{let ke=s.clone();ke.multiplier.negate(),ve=u.pow(u.symfunction(J,[new i(ze)]),f.clone());let rt=u.pow(new i(ke.multiplier.num),f.clone()),it=u.pow(new i(ke.multiplier.den),f.clone()),ut=u.divide(rt,it);ve=u.multiply(ve,ut)}else if(G.PARSE2NUMBER&&f.isImaginary()){let ke=f.realpart(),rt=f.imagpart(),it=s.clone().toLinear(),ut=u.pow(it.clone(),ke),Et=Nt(it.clone()),ht=_.cos(u.multiply(rt.clone(),Et)),Tt=u.multiply(_.sin(u.multiply(rt,Nt(it))),i.imaginary());ve=u.multiply(ut,u.add(ht,Tt)),ve=u.expand(u.parse(ve))}else{let ke=s.group===Se&&tt<0;if(gt=o1(new i(ke?Oe.num:Math.abs(Oe.num)).setPower(f.clone())),wt=o1(new i(Oe.den).setPower(f.clone()).invert()),s.imaginary)if(Ne){let rt=Math.sign(f),ut=Fe(f)%4;ve=new i(kt(ut)?-1:G.IMAGINARY),(ut===0||rt<0&&ut===1||rt>0&&ut===3)&&ve.negate()}else{let rt=f.multiplier.multiply(We.quick(1,2)),it=(-1)**rt.num;ve=kt(rt.den)?new i(-1).setPower(rt,!0):new i(it)}if(tt<0&&!ke&&ve.negate(),ne&&s.group!==$e){let rt=kt(f.multiplier.den),it=kt(s.power),ut=ve.power.toDecimal(),Et=kt(ut);if(rt&&it&&!Et){if(ut==="1"||ut==="1")typeof ve.value=="string"&&ve.value.startsWith("baseunit_")||(ve=u.symfunction(d,[ve]));else if(vt(ut))ve=u.multiply(u.symfunction(d,[ve.clone().toLinear()]),ve.clone().setPower(new We(Number(ut)-1)));else{let ht=ve.power;ve=u.symfunction(d,[ve.toLinear()]).setPower(ht)}G.POSITIVE_MULTIPLIERS&&ve.fname===d&&(ve=ve.args[0])}}if(f.equals(2)&&ve.group===qe){let rt=new i(1);ve.each(it=>{rt=u.multiply(rt,u.pow(it,f))}),ve=rt}}}if(ve=o1(ve),gt&&wt&&(ve=u.multiply(ve,Cn(u.multiply(gt,wt)))),ve.fname===c){let tt=ve.group===$e,ke=tt?ve.power.multiplier.toString():ve.power.toString();if(kt(ke)){let rt=tt?u.divide(ve.power,new i(2)):new i(ve.power.divide(new We(2))),it=ve.multiplier;ve=u.pow(ve.args[0],rt),ve.multiplier=ve.multiplier.multiply(it)}}else if(!G.IGNORE_E&&ve.isE()&&ve.group===$e&&ve.power.contains("pi")&&ve.power.contains(G.IMAGINARY)&&f.group===qe){let tt=f.stripVar(G.IMAGINARY);ve=u.add(_.cos(tt),u.multiply(i.imaginary(),_.sin(tt)))}return ve}if(ae(s)&&$)s=s.map(he=>u.pow(he,f.clone()));else if(Re(s)&&$){let he=new C;s.eachElement((ie,ne,Me)=>{he.set(ne,Me,u.pow(ie,f.clone()))}),s=he}else if(k&&Re(f)){let he=new C;f.eachElement((ie,ne,Me)=>{he.set(ne,Me,u.pow(s.clone(),ie))}),s=he}return s},this.comma=function(s,f){return s instanceof $t||(s=$t.create(s)),s.append(f),s},this.mod=function(s,f){return Rt(s,f)},this.slice=function(s,f){return new p(s,f)},this.equals=function(s,f){return s.group!==te&&!s.isLinear()&&Ft(`Cannot set equality for ${s.toString()}`),S[s.value]=f.clone(),f},this.percent=function(s){return u.divide(s,new i(100))},this.assign=function(s,f){if(s instanceof $t&&f instanceof $t)return s.elements.map((k,$)=>u.assign(k,f.elements[$])),M.fromArray(f.elements);if(s.parent){let k=s.parent;return k.elements[k.getter]=f,delete k.getter,k}if(s.group!==te)throw new L1(`Cannot complete operation. Incorrect LH value for ${s}`);return S[s.value]=f,f},this.functionAssign=function(s,f){let k=s.elements.pop();return Ve(k,s.elements,f)};let x0=function(s){return new i(s===!0?1:0)};this.eq=function(s,f){return x0(s.equals(f))},this.gt=function(s,f){return x0(s.gt(f))},this.gte=function(s,f){return x0(s.gte(f))},this.lt=function(s,f){return x0(s.lt(f))},this.lte=function(s,f){return x0(s.lte(f))},this.factorial=function(s){return this.symfunction(a,[s])},this.dfactorial=function(s){return this.symfunction(m,[s])}}u=new h,rn._=u,Object.defineProperty(J1,"functions",{get:()=>u.functions,configurable:!0}),Object.defineProperty(Y1,"CONSTANTS",{get:()=>u.CONSTANTS,configurable:!0}),Object.defineProperty(y0,"VARS",{get:()=>S,configurable:!0}),Object.defineProperty(t0,"VARS",{get:()=>S,configurable:!0}),t0._clearFunctions=je,t0._initConstants=()=>u.initConstants(),Jt._=u,Jt.C=mt,at={convert(e,n){let r;if(e===0)r=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let p=this.quickConversion(Number(e));if(p[1]<=1e16){let w=Math.abs(e),E=e/w;r=this.fullConversion(w.toFixed(`${p[1]}`.length-1)),r[0]*=E}else r=p}else r=this.fullConversion(e);return r},quickConversion(e){let n=function(p){typeof p!="string"&&(p=p.toString());let w="",E=p.charAt(0);return E==="-"?(p=p.substr(1,p.length),w="-"):E==="+"&&(p=p.substr(1,p.length)),{sign:w,value:p}};function r(p){Bt.isScientific(p)&&(p=k0(p));let w=n(p),E=w.value.split("."),_;E.length===1?_=E[0]:_=E[0]+E[1];let Y=E[1]?E[1].length:0,P=`1${"0".repeat(Y)}`;return _!=="0"&&(_=_.replace(/^0+/u,"")),[w.sign+_,P]}return r(e)},fullConversion(e){let n=Math.abs(e)>1e10?1e-16:1e-30,r=!1,p=0,w=1,E=1,_=0,Y=0,P=e,Z,K,we=1e-14;for(;!r;){Y++;let Ee;if(Math.abs(P)>1e10){let Qe=Math.round(P);Ee=Math.abs(P-Qe)/Math.abs(Qe)<we?Qe:Math.floor(P)}else Ee=Math.floor(P);Z=p+Ee*E,K=w+Ee*_;let ye=P-Ee;ye<n&&(r=!0),P=1/ye,p=E,w=_,E=Z,_=K,(Math.abs(Z/K-e)<n||Y>30)&&(r=!0)}return[Z,K]}},Ot.Fraction=at,le={parser:(function(){let n=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],r=new h;for(let w in r)n.indexOf(w)===-1&&delete r[w];r.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(w){return w}}),r.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(w){return w}});let p=r.getBrackets();return p["{"].maps_to=void 0,r})(),space:"~",dot:" \\cdot ",latex(e,n){if(e.clone&&(e=e.clone()),e instanceof u.classes.Collection&&(e=e.elements),bt(e)){let Ee=[];for(let ye=0;ye<e.length;ye++){let Qe=e[ye];ue(Qe)||(Qe=u.parse(Qe)),Ee.push(this.latex(Qe,n))}return this.brackets(Ee.join(", "),"square")}if(Re(e)){let Ee=`\\begin{pmatrix}
`;for(let ye=0;ye<e.elements.length;ye++){let Qe=[],be=e.elements[ye];for(let Ze=0;Ze<be.length;Ze++)Qe.push(this.latex(be[Ze],n));Ee+=Qe.join(" & "),ye<e.elements.length-1&&(Ee+=`\\\\
`)}return Ee+="\\end{pmatrix}",Ee}if(ae(e)){let Ee="\\left[";for(let ye=0;ye<e.elements.length;ye++)Ee+=`${this.latex(e.elements[ye],n)} ${ye===e.elements.length-1?"":",\\,"}`;return Ee+="\\right]",Ee}if(x1(e)){let Ee="\\{";for(let ye=0;ye<e.elements.length;ye++)Ee+=`${this.latex(e.elements[ye],n)} ${ye===e.elements.length-1?"":",\\,"}`;return Ee+="\\}",Ee}e=e.clone();let r=n==="decimal"||n==="decimals",{power:p}=e,w=et(p),E=e.multiplier.lessThan(0);if(e.group===Ie&&r)return String(e.multiplier.toDecimal()*e.value**e.power.toDecimal());e.multiplier=e.multiplier.abs();let _;r?_=[String(e.multiplier.toDecimal()),""]:_=[e.multiplier.num,e.multiplier.den];let Y=this.value(e,w,n,E),P;w&&p.negate(),r?(P=ue(p)?le.latex(p,n):String(p.toDecimal()),String(P)==="1"&&(P="")):ue(p)?P=this.latex(p,n):P=this.formatFrac(p,!0);let Z=["",""],K=w?1:0;return Z[K]=P,((E?"-":"")+this.set(_,Y,Z,e.group===qe)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(e,n,r,p){let{group:w}=e,{previousGroup:E}=e,_=["",""],Y=n?1:0;if(e.isInfinity)_[Y]="\\infty";else if(w===te||w===Ie||E===te||E===Ie||E===Se){let P=this.formatSubscripts(e.value);P.replace&&(P=P.replace(/(?<prefix>.+)_$/u,"$1\\_"));let Z=String(P).split("_"),K=this.greek[Z[0]];K&&(Z[0]=K,P=Z.join("_"));let we=this.symbols[Z[0]];we&&(Z[0]=we,P=Z.join("_")),_[Y]=P}else if(w===He||E===He){let P=[],{fname:Z}=e;for(let K=0;K<e.args.length;K++){let we=e.args[K],Ee;typeof we=="string"?Ee=we:Ee=this.latex(we,r),P.push(Ee)}if(Z===c)_[Y]=`\\sqrt${this.braces(P.join(","))}`;else if(Z===d)_[Y]=this.brackets(P.join(","),"abs");else if(Z===J)_[Y]=this.brackets(P.join(","),"parens");else if(Z==="limit")_[Y]=` \\lim\\limits_{${P[1]} \\to ${P[2]}} ${P[0]}`;else if(Z==="integrate")_[Y]=`\\int${this.braces(P[0])}${this.braces(`d${P[1]}`)}`;else if(Z==="defint")_[Y]=`\\int\\limits_${this.braces(P[1])}^${this.braces(P[2])} ${P[0]} d${P[3]}`;else if(Z===a||Z===m){let K=e.args[0];K.power.equals(1)&&(K.isComposite()||K.isCombination())&&(P[0]=this.brackets(P[0])),_[Y]=P[0]+(Z===a?"!":"!!")}else if(Z==="floor")_[Y]=`\\left \\lfloor${this.braces(P[0])}\\right \\rfloor`;else if(Z==="ceil")_[Y]=`\\left \\lceil${this.braces(P[0])}\\right \\rceil`;else if(Z===G.LOG&&P.length>1)_[Y]=`\\mathrm${this.braces(G.LOG)}_${this.braces(P[1])}${this.brackets(P[0])}`;else if(Z===G.LOG10)_[Y]=`\\mathrm${this.braces(G.LOG)}_${this.braces(10)}${this.brackets(P[0])}`;else if(Z===G.LOG2)_[Y]=`\\mathrm${this.braces(G.LOG)}_${this.braces(2)}${this.brackets(P[0])}`;else if(Z===G.LOG1P)_[Y]=`\\ln${this.brackets(`1 + ${P[0]}`)}`;else if(Z==="sum"){let K=P[0],we=P[1],Ee=P[2],ye=P[3];_[Y]=`\\sum\\limits_{${this.braces(we)}=${this.braces(Ee)}}^${this.braces(ye)} ${this.braces(K)}`}else if(Z==="product"){let K=P[0],we=P[1],Ee=P[2],ye=P[3];_[Y]=`\\prod\\limits_{${this.braces(we)}=${this.braces(Ee)}}^${this.braces(ye)} ${this.braces(K)}`}else if(Z==="nthroot")_[Y]=`\\sqrt[${P[1]}]${this.braces(P[0])}`;else if(Z==="mod")_[Y]=`${P[0]} \\bmod ${P[1]}`;else if(Z==="realpart")_[Y]=`\\operatorname{Re}${this.brackets(P[0])}`;else if(Z==="imagpart")_[Y]=`\\operatorname{Im}${this.brackets(P[0])}`;else{let K=Z===""?"":`\\mathrm${this.braces(Z.replace(/_/gu,"\\_"))}`;e.isConversion?_[Y]=K+this.brackets(P.join(""),"parens"):_[Y]=K+this.brackets(P.join(","),"parens")}}else if(e.isComposite()){let P=e.collectSymbols().sort(w===Xe||E===Xe?(Ee,ye)=>ye.group-Ee.group:(Ee,ye)=>{let Qe=ue(Ee.power)?-1:Ee.power;return(ue(ye.power)?-1:ye.power)-Qe}),Z=[],K=P.length;for(let Ee=0;Ee<K;Ee++)Z.push(le.latex(P[Ee],r));let we=Z.join("+");_[Y]=!(e.isLinear()&&e.multiplier.equals(1))||p?this.brackets(we,"parens"):we}else if(w===qe||E===$e||E===qe){w===qe&&e.distributeExponent();let P=[],Z=[],K=[],we=[],Ee=0,ye=0,Qe=function(be,Ze,Ye){if(Ye>1&&Ze.length>0){let Fe=Ze.length;for(let Je=0;Je<Fe;Je++){let ft=Ze[Je],St=be[ft];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(St)||/^\\left\(.+\\right\)$/gu.test(St)||(be[ft]=le.brackets(St,"parens"))}}return be};e.each(be=>{let Ze=et(be.power),Ye;Ze?(Ye=le.latex(be.invert(),r),ye++,be.isComposite()&&(!e.multiplier.den.equals(1)&&Math.abs(be.power)===1&&(Ye=le.brackets(Ye,"parens")),K.push(P.length)),P.push(Ye)):(Ye=le.latex(be,r),Ee++,be.isComposite()&&(!e.multiplier.num.equals(1)&&Math.abs(be.power)===1&&(Ye=le.brackets(Ye,"parens")),we.push(Z.length)),Z.push(Ye))}),Qe(Z,we,Ee),_[0]=Z.join(this.dot),Qe(P,K,ye),_[1]=P.join(this.dot)}return _},set(e,n,r,p){let w=function(Ee){return/^\\left\(.+\\right\)$/u.test(Ee)};r&&=this.formatP(r);let E;p&&(E=r[0],r[0]=""),n=this.merge(n,r);let _=e[0],Y=e[1],P=n[0],Z=n[1];P&&Number(_)===1&&(_=""),Number(Y)===1&&(Y="");let K=this.join(_,P,w(P)?"":this.dot),we=this.join(Y,Z,w(Z)?"":this.dot);if(K&&we){let Ee=this.frac(K,we);return p&&E&&(Ee=this.brackets(Ee)+E),Ee}return K},merge(e,n){let r=[];for(let p=0;p<2;p++)r[p]=e[p]+n[p];return r},join(e,n,r){return!e&&!n?"":e&&!n?e:n&&!e?n:e+r+n},formatSubscripts(e){let n=e.toString().split("_"),r="";for(;n.length>1;)n.length>0&&(r=`_${this.braces(n.pop()+r)}`);return n[0]+r},formatP(e){for(let n=0;n<2;n++){let r=e[n];r&&(e[n]=`^${this.braces(r)}`)}return e},formatFrac(e,n){let r=e.num.toString(),p=e.den.toString();return n&&r==="1"&&p==="1"?"":p==="1"?r:this.frac(r,p)},frac(e,n){return`\\frac${this.braces(e)}${this.braces(n)}`},braces(e){return`{${e}}`},brackets(e,n){n||="parens";let p={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[n];return`\\left${p[0]}${e}\\right${p[1]}`},filterTokens(e){let n=[];bt(e)&&(n.type=e.type);let r=["\\","left","right","big","Big","large","Large"];for(let p=0,w=e.length;p<w;p++){let E=e[p],_=e[p+1];E.value==="\\"&&_.value==="\\"?n.push(E):bt(E)?n.push(le.filterTokens(E)):r.indexOf(E.value)===-1&&n.push(E)}return n},parse(e){let n,r,p="",w=this.filterTokens(e),E={cdot:"",times:"",infty:"Infinity"},_=function(Z){return w[typeof Z>"u"?++n:n+=Z]},Y=function(){return le.parse(_())},P=function(Z){return Z in E?E[Z]:Z==="*"&&w[n+1].value==="&"?(_(2),","):Z==="&"?(_(),","):Z==="\\"?"],[":Z};for(n=0,r=w.length;n<r;n++){let Z=w[n];if(Z.value==="frac"){let K=Y(),we=Y();p+=`${K}/${we}`}else if(Z.value in le.symbols)if(Z.value===c&&w[n+1].type==="vector"&&w[n+2].type==="NerdamerSet"){let K=Y(),we=Y();p+=`${we}^${qt(`1/${K}`)}`}else p+=Z.value+Y();else if(Z.value==="int"){let K=Y();n++;let we=_().value;we=P(we.substring(1,we.length)),p+=`integrate${qt(`${K},${we}`)}`}else if(Z.value==="int_"){let K=Y();n++;let we=_().value;we===void 0&&(n--,we=Y());let Ee=Y(),ye=_().value;ye===","&&(ye=_().value),ye==="differentialD"&&(n++,ye=_().value),ye==="mathrm"&&(n++,ye=_().value),p+=`defint${qt(`${Ee},${K},${we},${ye}`)}`}else if(Z.value&&Z.value.startsWith("int_")){let K=Z.value.replace("int_","");n++;let we=_().value;we===void 0&&(n--,we=Y());let Ee=Y(),ye=_().value;ye===","&&(ye=_().value),ye==="differentialD"&&(n++,ye=_().value),ye==="mathrm"&&(n++,ye=_().value),p+=`defint${qt(`${Ee},${K},${we},${ye}`)}`}else if(Z.value==="mathrm"){let K=w[++n][0].value;p+=K+Y()}else if(Z.value==="sum_"||Z.value==="prod_"){let K=Z.value==="sum_"?"sum":"product",we=_();n++;let Ee=Y(),ye=Y();p+=K+qt([ye,P(we[0]),P(we[2]),P(Ee)].join(","))}else if(Z.value==="lim_"){let K=_();p+=`limit${qt([Y(),P(K[0]),P(K[2])].join(","))}`}else if(Z.value==="begin"){let K=_();Array.isArray(K)&&K[0].value==="matrix"&&(p+="matrix([")}else if(Z.value==="end"){let K=_();Array.isArray(K)&&K[0].value==="matrix"&&(p+="])")}else Array.isArray(Z)?p+=P(le.parse(Z)):p+=P(Z.value.toString())}return qt(p)}},Object.defineProperty(Dt,"EXPRESSIONS",{get:()=>v,configurable:!0}),Object.defineProperty(Dt,"USER_FUNCTIONS",{get:()=>F,configurable:!0}),Dt.LaTeX=le,Dt.text=q,Dt.functions=u.functions,Dt._=u;function M(e,...n){this.multiplier=new We(1),ae(e)?this.elements=e.elements?.slice(0)??[]:bt(e)?this.elements=e.slice(0):Re(e)?e.elements.length===1?(this.elements=[...e.elements[0]],this.rowVector=!0):e.elements.length>1&&Array.isArray(e.elements[0])&&e.elements[0].length===1&&(this.elements=e.elements.map(r=>r[0]),this.rowVector=!1):typeof e>"u"?this.elements=[]:this.elements=[e,...n]}M.arrayPrefill=function(n,r){let p=[];r||=0;for(let w=0;w<n;w++)p[w]=r;return p},M.fromArray=function(n){let r=new M;return r.elements=n,r},M.fromSet=function(n){return M.fromArray(n.elements)},M.prototype={custom:!0,e(e){return e<1||e>this.elements.length?null:this.elements[e-1]},set(e,n){ue(n)||(n=new i(n)),this.elements[e]=n},dimensions(){return this.elements.length},modulus(){return Ht("SAFE",()=>u.pow(this.dot(this.clone()),new i(.5)),void 0,this)},eql(e){let n=this.elements.length,r=e.elements||e;if(n!==r.length)return!1;do if(Math.abs(u.subtract(this.elements[n-1],r[n-1]).valueOf())>G.PRECISION)return!1;while(--n);return!0},clone(){let e=new M,n=this.elements.length;for(let r=0;r<n;r++)e.elements.push(this.elements[r].clone());return e.rowVector=this.rowVector,e},expand(e){return this.elements=this.elements.map(n=>u.expand(n,e)),this},map(e){let n=[];return this.each((r,p)=>{n.push(e(r,p))}),new M(n)},each(e){let n=this.elements.length,r=n,p;do p=r-n,e(this.elements[p],p+1);while(--n)},toUnitVector(){return Ht("SAFE",()=>{let e=this.modulus();return e.valueOf()===0?this.clone():this.map(n=>u.divide(n,e))},void 0,this)},angleFrom(e){return Ht("SAFE",()=>{let n=e.elements||e;if(this.elements.length!==n.length)return null;let p=new i(0),w=new i(0),E=new i(0);this.each((Z,K)=>{p=u.add(p,u.multiply(Z,n[K-1])),w=u.add(w,u.multiply(Z,Z)),E=u.add(E,u.multiply(n[K-1],n[K-1]))}),w=u.pow(w,new i(.5)),E=u.pow(E,new i(.5));let _=u.multiply(w,E);if(_.valueOf()===0)return null;let Y=u.divide(p,_),P=Y.valueOf();return P<-1&&(Y=-1),P>1&&(Y=1),new i(Math.acos(Y))},void 0,this)},isParallelTo(e){let n=this.angleFrom(e).valueOf();return n===null?null:n<=G.PRECISION},isAntiparallelTo(e){let n=this.angleFrom(e).valueOf();return n===null?null:Math.abs(n-Math.PI)<=G.PRECISION},isPerpendicularTo(e){let n=this.dot(e);return n===null?null:Math.abs(n)<=G.PRECISION},add(e){return Ht("SAFE",()=>{let n=e.elements||e;return this.elements.length!==n.length?null:this.map((r,p)=>u.add(r,n[p-1]))},void 0,this)},subtract(e){return Ht("SAFE",()=>{let n=e.elements||e;return this.elements.length!==n.length?null:this.map((r,p)=>u.subtract(r,n[p-1]))},void 0,this)},multiply(e){return this.map(n=>n.clone()*e.clone())},x(e){return this.multiply(e)},dot(e){return Ht("SAFE",()=>{let n=e.elements||e,r=new i(0),p=this.elements.length;if(p!==n.length)return null;do r=u.add(r,u.multiply(this.elements[p-1],n[p-1]));while(--p);return r},void 0,this)},cross(e){let n=e.elements||e;if(this.elements.length!==3||n.length!==3)return null;let r=this.rowVector&&e.rowVector,p=this.elements;return Ht("SAFE",()=>{let w=new M([u.subtract(u.multiply(p[1],n[2]),u.multiply(p[2],n[1])),u.subtract(u.multiply(p[2],n[0]),u.multiply(p[0],n[2])),u.subtract(u.multiply(p[0],n[1]),u.multiply(p[1],n[0]))]);return w.rowVector=r,w},void 0,this)},toUnitMultiplier(){return this},max(){let e=0,n=this.elements.length,r=n,p;do p=r-n,Math.abs(this.elements[p].valueOf())>Math.abs(e.valueOf())&&(e=this.elements[p]);while(--n);return e},magnitude(){let e=new i(0);return this.each(n=>{e=u.add(e,u.pow(n,new i(2)))}),u.sqrt(e)},indexOf(e){let n=null,r=this.elements.length,p=r,w;do w=p-r,n===null&&this.elements[w].valueOf()===e.valueOf()&&(n=w+1);while(--r);return n},text_(e,n){let r=q(this,n);return(this.rowVector?"[":"")+r+(this.rowVector?"]":"")},text(e,n){let r=q(this,n);return(this.rowVector?"[":"")+r+(this.rowVector?"]":"")},toString(){return this.text()},latex(e){let n=[];for(let r=0;r<this.elements.length;r++)n.push(le.latex(this.elements[r],e));return`[${n.join(", ")}]`}};function C(...e){this.multiplier=new We(1);let n=e,r=n.length,p,w=[];if(Re(n))for(p=0;p<r;p++)w.push(n[p].slice(0));else{let E,_,Y;for(p=0;p<r;p++)E=n[p],ae(E)&&(E=E.elements),bt(E)||(E=[E]),Y=E.length,_&&_!==Y&&Ft("Unable to create Matrix. Row dimensions do not match!"),w.push(E),_=Y}this.elements=w}C.identity=function(n){let r=new C;for(let p=0;p<n;p++){r.elements.push([]);for(let w=0;w<n;w++)r.set(p,w,p===w?new i(1):new i(0))}return r},C.fromArray=function(n){function r(p){return C.apply(this,p)}return r.prototype=C.prototype,new r(n)},C.zeroMatrix=function(n,r){let p=new C;for(let w=0;w<n;w++)p.elements.push(M.arrayPrefill(r,new i(0)));return p},C.prototype={custom:!0,get(e,n){if(this.elements[e])return this.elements[e][n]},map(e,n){let r=new C;return this.each((p,w,E)=>{r.set(w,E,e.call(r,p),n)}),r},set(e,n,r,p){this.elements[e]||=[],p||ue(r)?this.elements[e][n]=r:this.elements[e][n]=new i(r)},cols(){return this.elements[0].length},rows(){return this.elements.length},row(e){return!e||e>this.cols()?[]:this.elements[e-1]},col(e){let n=this.rows(),r=[];if(e>this.cols()||!e)return r;for(let p=0;p<n;p++)r.push(this.elements[p][e-1]);return r},eachElement(e){let n=this.rows(),r=this.cols(),p,w;for(p=0;p<n;p++)for(w=0;w<r;w++)e.call(this,this.elements[p][w],p,w)},determinant(){if(!this.isSquare())return null;let e=this.toRightTriangular(),n=e.elements[0][0],r=e.elements.length-1,p=r,w;do w=p-r+1,n=u.multiply(n,e.elements[w][w]);while(--r);return n},isSquare(){return this.elements.length===this.elements[0].length},isSingular(){return this.isSquare()&&this.determinant()===0},augment(e){let n=this.rows(),r=e.rows();n!==r&&Ft("Cannot augment matrix. Rows don't match.");for(let p=0;p<n;p++)this.elements[p]=this.elements[p].concat(e.elements[p]);return this},clone(){let e=this.rows(),n=this.cols(),r=new C;for(let p=0;p<e;p++){r.elements[p]=[];for(let w=0;w<n;w++){let E=this.elements[p][w];r.elements[p][w]=ue(E)?E.clone():E}}return r},toUnitMultiplier(){return this},expand(e){return this.eachElement(n=>u.expand(n,e)),this},evaluate(e){return this.eachElement(n=>u.evaluate(n,e)),this},invert(){return this.isSquare()||Ft("Matrix is not square!"),Ht("SAFE",()=>{let e=this.elements.length,n=e,r,p,w=C.identity(e),E=this.augment(w).toRightTriangular(),_,Y=E.elements[0].length,P,Z,K,we=[],Ee;do{r=e-1,Z=[],_=Y,we[r]=[],K=E.elements[r][r];do P=Y-_,Ee=u.divide(E.elements[r][P],K.clone()),Z.push(Ee),P>=n&&we[r].push(Ee);while(--_);for(E.elements[r]=Z,p=0;p<r;p++){Z=[],_=Y;do P=Y-_,Z.push(u.subtract(E.elements[p][P].clone(),u.multiply(E.elements[r][P].clone(),E.elements[p][r].clone())));while(--_);E.elements[p]=Z}}while(--e);return C.fromArray(we)},void 0,this)},toRightTriangular(){return Ht("SAFE",()=>{let e=this.clone(),n,r,p,w=this.elements.length,E=w,_,Y,P=this.elements[0].length,Z;do{if(_=E-w,r=e.elements[_][_],r.valueOf()===0){for(let K=_+1;K<E;K++)if(p=e.elements[K][_],p&&p.valueOf()!==0){n=[],Y=P;do Z=P-Y,n.push(u.add(e.elements[_][Z].clone(),e.elements[K][Z].clone()));while(--Y);e.elements[_]=n;break}}if(r=e.elements[_][_],r.valueOf()!==0)for(let K=_+1;K<E;K++){let we=u.divide(e.elements[K][_].clone(),e.elements[_][_].clone());n=[],Y=P;do Z=P-Y,n.push(Z<=_?new i(0):u.subtract(e.elements[K][Z].clone(),u.multiply(e.elements[_][Z].clone(),we.clone())));while(--Y);e.elements[K]=n}}while(--w);return e},void 0,this)},transpose(){let e=this.elements.length,n=this.elements[0].length,r=new C,p=n,w,E,_;do{w=n-p,r.elements[w]=[],E=e;do _=e-E,r.elements[w][_]=this.elements[_][w].clone();while(--E)}while(--p);return r},canMultiplyFromLeft(e){let n=Re(e)?e.elements.length:e.length;return this.elements[0].length===n},sameSize(e){return this.rows()===e.rows()&&this.cols()===e.cols()},multiply(e){return Ht("SAFE",()=>{let n=e.elements||e;if(!this.canMultiplyFromLeft(n)){if(this.sameSize(e)){let ye=new C,Qe=this.rows();for(let be=0;be<Qe;be++){let Ze=u.multiply(new M(this.elements[be]),new M(e.elements[be]));ye.elements[be]=Ze.elements}return ye}return null}let r=this.elements.length,p=r,w,E,_=n[0].length,Y,P=this.elements[0].length,Z=[],K,we,Ee;do{w=p-r,Z[w]=[],E=_;do{Y=_-E,K=new i(0),we=P;do Ee=P-we,K=u.add(K,u.multiply(this.elements[w][Ee],n[Ee][Y]));while(--we);Z[w][Y]=K}while(--E)}while(--r);return C.fromArray(Z)},void 0,this)},add(e,n){let r=new C;return this.sameSize(e)&&this.eachElement((p,w,E)=>{let _=u.add(p.clone(),e.elements[w][E].clone());n&&(_=n.call(r,_,p,e.elements[w][E])),r.set(w,E,_)}),r},subtract(e,n){let r=new C;return this.sameSize(e)&&this.eachElement((p,w,E)=>{let _=u.subtract(p.clone(),e.elements[w][E].clone());n&&(_=n.call(r,_,p,e.elements[w][E])),r.set(w,E,_)}),r},negate(){return this.each(e=>e.negate()),this},toVector(){if(this.rows()===1||this.cols()===1){let e=new M;return e.elements=this.elements,e}return this},toString(e,n){let r=this.rows(),p=[];e=e===void 0?`
`:e;for(let w=0;w<r;w++)p.push(`[${this.elements[w].map(E=>{let _=n?E.multiplier.toDecimal():E.toString();return E===void 0?"":_}).join(",")}]`);return`matrix${qt(p.join(","))}`},text(){return`matrix(${this.elements.map(e=>`[${e.toString("")}]`)})`},latex(e){let n=this.cols(),{elements:r}=this;return Ut("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let p=[];for(let w in r){if(!Object.hasOwn(r,w))continue;let E=[];for(let _=0;_<n;_++)E.push(le.latex(r[w][_],e));p.push(E.join(" & "))}return p.join(" \\cr ")})}},C.prototype.each=C.prototype.eachElement,O0.isVector=ae,O0.Vector=M,O0.remove=S0,p0._=u,p0.block=Ht,Ke={dependencies:{_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":U.gamma},gamma_incomplete:{"Math2.factorial":U.factorial},Li:{"Math2.Ei":U.Ei,"Math2.bigLog":U.bigLog,Frac:We},Ci:{"Math2.factorial":U.factorial},Ei:{"Math2.factorial":U.factorial},Si:{"Math2.factorial":U.factorial},Shi:{"Math2.factorial":U.factorial},Chi:{isInt:vt,nround:v0,"Math2.num_integrate":U.num_integrate},factor:{"Math2.ifactor":U.ifactor,NerdamerSymbol:i},num_integrate:{"Math2.simpson":U.simpson,nround:v0},fib:{even:kt}},reformat:{diff(e,n){let r=e.args[1].toString(),p=`let f = ${Ke.build(e.args[0].toString(),[r])};`,w=U.diff.toString();return!w.startsWith("function")&&!w.startsWith("(")&&!w.startsWith("async")&&(w=`function ${w}`),n[1]+=`let diff = ${w};`,n[1]+=p,[`diff(f)(${r})`,n]}},getProperName(e){return{continuedFraction:"continuedFraction"}[e]||e},compileDependencies(e,n){let r=Ke.dependencies[e],p=n&&n[1]?n[1]:"",w=n&&n[0]?n[0]:{};for(let E in r){if(typeof r[E]=="object")continue;let _=E.split("."),Y=r[E];if(typeof Y=="function"){let P=Y.toString();!P.startsWith("function")&&!P.startsWith("(")&&!P.startsWith("async")&&(P=`function ${P}`),Y=P}p+=`let ${_.length>1?_[1]:_[0]}=${Y};`,w[E]=_.pop()}return[w,p]},getArgsDeps(e,n){let{args:r}=e,p=n,w=function(E){E.group===He&&(p=Ke.compileDependencies(E.fname,p))};for(let E=0;E<r.length;E++)e.args[E].each(w);return p},build(e,n){e=Ht("PARSE2NUMBER",()=>u.parse(e),!0);let r=Q(e),p=[],w=[],E=function(P,Z){P.fname===""&&(P=i.unwrapPARENS(P)),Z||=[];let K=[],{group:we}=P,Ee="",ye=function(Ze){let Ye=Ze===qe?"*":"+",Fe=[];for(let ft in P.symbols){if(!Object.hasOwn(P.symbols,ft))continue;let St=P.symbols[ft],Rt=E(St,Z)[0];St.isComposite()&&(Rt=qt(Rt)),Fe.push(Rt)}let Je=Fe.join(Ye);return Je=Je&&!P.multiplier.equals(1)?qt(Je):Je,Je},Qe=function(Ze){let Ye;if(Ze in Math)Ye=`Math.${Ze}`;else{if(Ze=Ke.getProperName(Ze),p.indexOf(Ze)===-1){let Fe=U[Ze].toString();!Fe.startsWith("function")&&!Fe.startsWith("(")&&!Fe.startsWith("async")&&(Fe=`function ${Fe}`),Z.push(`let ${Ze} = ${Fe}; `),p.push(Ze)}Ye=Ze}return Ye+=qt(P.args.map(Fe=>E(Fe,Z)[0]).join(",")),Ye};we===Se?K.push(P.multiplier.toDecimal()):P.multiplier.equals(-1)?Ee="-":P.multiplier.equals(1)||K.push(P.multiplier.toDecimal());let be;if(we===te||we===Ie)be=P.value;else if(we===He)if(w=Ke.compileDependencies(P.fname,w),w=Ke.getArgsDeps(P,w),Ke.reformat[P.fname]){let Ze=Ke.reformat[P.fname](P,w);w=Ze[1],be=Ze[0]}else be=Qe(P.fname);else if(we===$e){let Ze=P.previousGroup;Ze===Se||Ze===te?be=P.value:Ze===He?(be=Qe(P.fname),w=Ke.compileDependencies(P.fname,w),w=Ke.getArgsDeps(P,w)):be=ye(P.previousGroup)}else be=ye(P.group);if(P.group!==Se&&!P.power.equals(1)){let Ze=E(u.parse(P.power));Z.push(Ze[1]),be=`Math.pow${qt(`${be},${Ze[0]}`)}`}return be&&K.push(Ee+be),[K.join("*"),Z.join("").replace(/\n+\s+/gu," ")]};n&&(r=n);let _=E(e);for(let P in w[0]){if(!Object.hasOwn(w[0],P))continue;let Z=w[0][P];_[1]=_[1].replace(P,Z),w[1]=w[1].replace(P,Z)}return new Function(...r,`${(w[1]||"")+_[1]} return ${_[0]};`)}},(function(){Y0(u.CONSTANTS),Y0(u.functions),u.initConstants(),u.error||=Ft,G.LOG_FNS={log:u.functions.log,log10:u.functions.log10}})();let H={allSame:W0,allNumeric:Xn,arguments2Array:bn,armTimeout:D1,arrayAddSlices:Gn,arrayClone:Vn,arrayMax:Fn,arrayMin:a1,arrayEqual:Bn,arrayUnique:c1,arrayGetVariables:ot,arraySum:ce,block:Ht,build:Ke.build,checkTimeout:r1,clearU:Kn,comboSort:Zn,compare:_e,convertToVector:X,customError:e0,customType:Pn,decompose_fn:Ge,disarmTimeout:P1,each:H1,evaluate:Mt,even:kt,evenFraction:u1,fillHoles:Ce,firstObject:J0,format:Ut,generatePrimes:F1,getCoeffs:b,getU:nt,importFunctions:Le,inBrackets:qt,isArray:bt,isExpression:B,isFraction:L,isInt:vt,isMatrix:Re,isNegative:et,isNumericSymbol:_0,isPrime:P0,isReserved:K0,isSymbol:ue,isVariableSymbol:$1,isVector:ae,isCollection:g1,keys:v1,knownVariable:Hn,nroots:st,remove:S0,reserveNames:Y0,range:$n,round:v0,sameSign:xn,scientificToDecimal:k0,separate:pe,stringReplace:Dn,text:q,validateName:g0,variables:Q,warn:d1};mt={groups:xe,NerdamerSymbol:i,Expression:fe,Collection:$t,Frac:We,Vector:M,Matrix:C,Parser:h,Scientific:Bt,Fraction:at,Math2:U,LaTeX:le,Utils:H,PARSER:u,PARENTHESIS:J,Settings:G,err:Ft,bigInt:ee,bigDec:de,exceptions:z},Dt.Math2=mt.Math2,Dt.Expression=fe;let D=function(e,n,r,p){D1();try{let w=!1;if(Ve(e))return sn;e!==null&&typeof e=="object"&&e instanceof fe&&(e=e.toString()),bt(r)||(r=typeof r>"u"?[]:[r]),r.forEach(_=>{if(_==="numer"){w=!0;return}let Y=u.functions[_];Y&&Y[1]===1&&(e=`${_}(${e})`)});let E=Ht("PARSE2NUMBER",()=>u.parse(e,n),w||G.PARSE2NUMBER);return p?v[p-1]=E:v.push(E),new fe(E)}finally{P1()}};return t0.libExports=D,D0.libExports=D,D0.CONSTANTS=u.CONSTANTS,r0.libExports=D,r0.VARS=S,r0.CONSTANTS=u.CONSTANTS,r0.parse=u.parse.bind(u),r0.isSymbol=ue,i1.libExports=D,i1._setFunction=Ve,c0.libExports=D,c0.EXPRESSIONS=v,E0.libExports=D,E0.Settings=G,E0.functions=u.functions,Xt.bigDec=de,Xt.Settings=G,Xt.functions=u.functions,Xt.symfunction=u.symfunction.bind(u),Xt.NerdamerSymbol=i,s0.libExports=D,s0.functions=u.functions,s0.parse=u.parse.bind(u),s0.callfunction=u.callfunction.bind(u),s0.Expression=fe,D.rpn=vi,D.convertToLaTeX=fi,D.convertFromLaTeX=Mi,D.version=si,D.getWarnings=ei,D.setConstant=Ci,D.getConstant=ai,D.clearConstants=qi,D.setFunction=Ri,D.clearFunctions=Ii,D.getCore=oi,D.getExpression=D.getEquation=fe.getExpression,D.reserved=ri,D.clear=k1,t0.clear=k1,D.flush=_i,D.expressions=Ei,D.functions=Ni,D.register=en,D.validateName=g0,D.validVarName=ii,D.supported=li,D.numEquations=D.numExpressions=ti,D.setVar=Ti,D.getVar=ui,D.clearVars=Ai,D.load=Oi,D.getVars=ci,D.set=y1,D.get=ni,D.updateAPI=Li,D.replaceFunction=yi,D.setOperator=gi,D.getOperator=pi,D.aliasOperator=hi,D.tree=K1,D.htmlTree=Si,D.addPeeker=mi,D.removePeeker=di,D.parse=wi,D.updateAPI(),D})({bigInt:b1,bigDec:B1,constants:Un});typeof E1<"u"&&(E1.exports=sn)});var V0=u0((bi,on)=>{"use strict";var B0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof on<"u"&&B0===void 0&&(B0=T0(),G0());(function(){let l=B0.getCore(),t=l.PARSER,{Frac:ee}=l,{Settings:de}=l,{isSymbol:xe}=l.Utils,{FN:Ue}=l.groups,{NerdamerSymbol:se}=l,{text:ge}=l.Utils,{inBrackets:G}=l.Utils,{isInt:u}=l.Utils,{format:le}=l.Utils,{even:mt}=l.Utils,{evaluate:at}=l.Utils,{N:Ke}=l.groups,{S:ue}=l.groups,{PL:Se}=l.groups,{CP:Ie}=l.groups,{CB:te}=l.groups,{EX:$e}=l.groups,{P:He}=l.groups,{LOG:Be}=de,qe="exp",Xe="abs",De="sqrt",J="sin",c="cos",d="tan",a="sec",m="csc",v="cot",S="asin",I="acos",V="atan",F="asec",L="acsc",B="acot",Q="sinh",ce="cosh",pe="tanh",Ce="csch",ae="sech",Re="coth",et="asech",_e="acsch",Ve="acoth";function je(X){this.message=X||""}je.prototype=new Error,se.prototype.hasIntegral=function(){return this.containsFunction("integrate")},se.prototype.fnTransform=function(){if(this.group!==Ue)return this;let j,x=this.args[0],z=new se(this.multiplier),U=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case Q:j=t.parse(le("(e^({0})-e^(-({0})))/2",x));break;case ce:j=t.parse(le("(e^({0})+e^(-({0})))/2",x));break;case pe:j=t.parse(le("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",x));break;case d:j=t.parse(le("sin({0})/cos({0})",x));break;case m:j=t.parse(le("1/sin({0})",x));break;case a:j=t.parse(le("1/cos({0})",x));break;default:j=U}else if(this.power.equals(2))switch(this.fname){case J:j=t.parse(le("1/2-cos(2*({0}))/2",x));break;case c:j=t.parse(le("1/2+cos(2*({0}))/2",x));break;case d:j=t.parse(le("sin({0})^2/cos({0})^2",x));break;case ce:j=t.parse(le("1/2+cosh(2*({0}))/2",x));break;case Q:j=t.parse(le("-1/2+cosh(2*({0}))/2",x));break;case pe:j=t.parse(le("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",x));break;case a:j=t.parse(le("(1-cos(2*({0})))/(1+cos(2*({0})))+1",x));break;default:j=U}else if(this.fname===a)j=t.parse(le("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===m)j=t.parse(le("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===d)this.power.lessThan(0)?j=t.parse(le("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):j=t.parse(le("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===J&&this.power.lessThan(0))j=t.parse(le("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===c&&this.power.lessThan(0))j=t.parse(le("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===J&&this.power.equals(3))j=t.parse(le("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===c&&this.power.equals(3))j=t.parse(le("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===c||this.fname===J)&&mt(this.power)){let q=this.power/2,fe=t.pow(this.clone().toLinear(),t.parse(2)).fnTransform(),i=t.expand(t.pow(fe,t.parse(q)));j=new se(0),i.each(h=>{let M=h.fnTransform();j=t.add(j,M)},!0)}else j=U;return t.multiply(j,z)},se.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===ue)return!1;if(this.fname&&(l.Utils.inTrig(this.fname)||l.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let j in this.symbols)if(this.symbols[j].hasTrig())return!0}return!1},l.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},l.Utils.toCommonDenominator=function(j){if(j.isComposite()&&j.isLinear()){let x=new se(j.multiplier),z=new se(1),U=new se(0);return j.each(fe=>{z=t.multiply(z,fe.getDenom())},!0),j.each(fe=>{let i=fe.getNum(),h=fe.getDenom(),M=t.multiply(i,t.divide(z.clone(),h));U=t.add(U,M)}),t.multiply(x,l.Algebra.divide(t.expand(U),t.expand(z)))}return j},l.Utils.inInverseTrig=function(j){return[S,I,V,L,F,B].indexOf(j)!==-1},l.Utils.inTrig=function(j){return[c,J,d,a,m,v].indexOf(j)!==-1},l.Utils.inHtrig=function(j){return[Q,ce,pe,_e,et,Ve].indexOf(j)!==-1},l.Matrix.jacobian=function(j,x){let z=new l.Matrix;return x||=l.Utils.arrayGetVariables(j),x.forEach((U,q)=>{j.forEach((fe,i)=>{let h=l.Calculus.diff(fe.clone(),U);z.set(i,q,h)})}),z},l.Matrix.prototype.max=function(){let j=new se(0);return this.each(x=>{let z=x.abs();z.gt(j)&&(j=z)}),j},l.Matrix.cMatrix=function(j,x){let z=new l.Matrix;return x.forEach((U,q)=>{z.set(q,0,t.parse(j))}),z};let st=l.Utils.allFunctions=function(j){for(let x=0,z=j.length;x<z;x++)if(j[x].group!==Ue)return!1;return!0},Ge=l.Utils.cosAsinBtranform=function(j,x){let z=j.args[0],U=x.args[0];return t.parse(le("(sin(({0})+({1}))-sin(({0})-({1})))/2",z,U))},nt=l.Utils.cosAsinAtranform=function(j,x){if(Number(x.power)!==1)return t.multiply(j,x);let z=j.args[0];return t.parse(le("(sin(2*({0})))/2",z))},ot=l.Utils.cosAsinBtranform=function(j,x){let z=j.args[0],U=x.args[0];return t.parse(le("(cos(({0})+({1}))-cos(({0})-({1})))/2",z,U))},Le=l.Utils.trigTransform=function(j){let x={},z,U,q=new se(1);for(let fe=0,i=j.length;fe<i;fe++)if(z=j[fe],z.group===Ue){let{fname:h}=z;h===c&&x[J]?(x[J].args[0].toString()===z.args[0].toString()?U=nt(z,x[J]):U=Ge(z,x[J]),delete x[J],q=t.multiply(q,U)):h===J&&x[c]?(x[c].args[0].toString()===z.args[0].toString()?U=nt(z,x[c]):U=Ge(z,x[c]),delete x[c],q=t.multiply(q,U)):h===J&&x[J]?(x[J].args[0].toString()===z.args[0].toString()?(U=t.multiply(z,x[J]),delete x[J]):(U=ot(z,x[J]),delete x[J]),q=U):x[h]=z}else q=t.multiply(q,z);for(let fe in x)Object.hasOwn(x,fe)&&(q=t.multiply(q,x[fe]));return q};l.Settings.integration_depth=10,l.Settings.max_lim_depth=10;let b=l.Calculus={version:"1.4.6",sum(X,j,x,z){if(j.group!==l.groups.S)throw new l.exceptions.NerdamerTypeError(`Index must be symbol. ${ge(j)} provided`);j=j.value;let U;if(l.Utils.isNumericSymbol(x)&&l.Utils.isNumericSymbol(z)){let q=z-x<200?"":"PARSE2NUMBER";x=Number(x),z=Number(z),U=l.Utils.block(q,()=>{let fe=X.text(),i={"~":!0},h=new l.NerdamerSymbol(0);for(let M=x;M<=z;M++){i[j]=new se(M);let C=t.parse(fe,i);h=t.add(h,C)}return h})}else U=t.symfunction("sum",[X,j,x,z]);return U},product(X,j,x,z){if(j.group!==l.groups.S)throw new l.exceptions.NerdamerTypeError(`Index must be symbol. ${ge(j)} provided`);j=j.value;let U;if(l.Utils.isNumericSymbol(x)&&l.Utils.isNumericSymbol(z)){let q=z-x<200?"":"PARSE2NUMBER";U=l.Utils.block(q,()=>{x=Number(x),z=Number(z.multiplier);let fe=X.text(),i={},h=new l.NerdamerSymbol(1);for(let M=x;M<=z;M++)i[j]=new se(M),h=t.multiply(h,t.parse(fe,i));return h})}else U=t.symfunction("product",[X,j,x,z]);return U},diff(X,j,x){if(l.Utils.isVector(X)){let h=new l.Vector([]);return X.each(M=>{h.elements.push(b.diff(M,j,x))}),h}if(l.Utils.isMatrix(X)){let h=new l.Matrix;return X.each((M,C,H)=>{h.set(C,H,b.diff(M,j,x))}),h}if(X.LHS&&X.RHS)return new l.Equation(b.diff(X.LHS.clone(),j,x),b.diff(X.RHS.clone(),j,x));let z=xe(j)?j.text():j;if(x=xe(x)?x.multiplier:x||1,z===void 0&&(z=l.Utils.variables(X)[0]),X.group===Ue&&X.fname===De){let h=X.args[0],M=X.power.clone();(h.group!==Ke||h.group!==He)&&(h.power=xe(h.power)?t.multiply(h.power,t.multiply(new se(1/2)),M):h.power.multiply(new ee(.5)).multiply(M),h.multiplier=h.multiplier.multiply(X.multiplier)),X=h}if(X.group===Ue&&!xe(X.power)){let h=q(t.parse(X)),M=b.diff(X.args[0].clone(),z);X=t.multiply(h,M)}else X=q(X);return x>1&&(x--,X=b.diff(X,j,x)),X;function U(h){return(h.value===z||h.contains(z,!0))&&(h.multiplier=h.multiplier.multiply(h.power),h.power=h.power.subtract(new ee(1)),h.power.equals(0)&&(h=se(h.multiplier))),h}function q(h){let M=h.group,C,H,D;if(M===Ke||M===ue&&h.value!==z||M===He)h=se(0);else if(M===ue)h=U(h);else if(M===te){let e=h.multiplier.clone();h.toUnitMultiplier();let n=t.multiply(i(h),U(h));return n.multiplier=n.multiplier.multiply(e),n}else if(M===Ue&&h.power.equals(1)){let e=h.multiplier.clone();switch(h.toUnitMultiplier(),h.fname){case Be:D=h.clone(),h=h.args[0].clone(),h.power=h.power.negate(),h.multiplier=D.multiplier.divide(h.multiplier);break;case c:h.fname=J,h.multiplier.negate();break;case J:h.fname=c;break;case d:h.fname=a,h.power=new ee(2);break;case a:h=fe(h,d);break;case m:h=fe(h,"-cot");break;case v:h.fname=m,h.multiplier.negate(),h.power=new ee(2);break;case S:h=t.parse(`(sqrt(1-(${ge(h.args[0])})^2))^(-1)`);break;case I:h=t.parse(`-(sqrt(1-(${ge(h.args[0])})^2))^(-1)`);break;case V:h=t.parse(`(1+(${ge(h.args[0])})^2)^(-1)`);break;case Xe:H=h.args[0].clone(),H.toUnitMultiplier(),h=t.parse(`${G(ge(h.args[0]))}/abs${G(ge(H))}`);break;case"parens":h=se(1);break;case"cosh":h.fname="sinh";break;case"sinh":h.fname="cosh";break;case pe:h.fname=ae,h.power=new ee(2);break;case ae:h=fe(h,"-tanh");break;case Ce:{let n=String(h.args[0]);h=t.parse(`-coth(${n})*csch(${n})`);break}case Re:{let n=String(h.args[0]);h=t.parse(`-csch(${n})^2`);break}case"asinh":h=t.parse(`(sqrt(1+(${ge(h.args[0])})^2))^(-1)`);break;case"acosh":h=t.parse(`(sqrt(-1+(${ge(h.args[0])})^2))^(-1)`);break;case"atanh":h=t.parse(`(1-(${ge(h.args[0])})^2)^(-1)`);break;case et:{let n=String(h.args[0]);h=t.parse(`-1/(sqrt(1/(${n})^2-1)*(${n})^2)`);break}case Ve:h=t.parse(`-1/((${h.args[0]})^2-1)`);break;case _e:{let n=String(h.args[0]);h=t.parse(`-1/(sqrt(1/(${n})^2+1)*(${n})^2)`);break}case F:{let n=String(h.args[0]);h=t.parse(`1/(sqrt(1-1/(${n})^2)*(${n})^2)`);break}case L:{let n=String(h.args[0]);h=t.parse(`-1/(sqrt(1-1/(${n})^2)*(${n})^2)`);break}case B:h=t.parse(`-1/((${h.args[0]})^2+1)`);break;case"S":{let n=String(h.args[0]);h=t.parse(`sin((pi*(${n})^2)/2)`);break}case"C":{let n=String(h.args[0]);h=t.parse(`cos((pi*(${n})^2)/2)`);break}case"Si":{let n=h.args[0];h=t.parse(`sin(${n})/(${n})`);break}case"Shi":{let n=h.args[0];h=t.parse(`sinh(${n})/(${n})`);break}case"Ci":{let n=h.args[0];h=t.parse(`cos(${n})/(${n})`);break}case"Chi":{let n=h.args[0];h=t.parse(`cosh(${n})/(${n})`);break}case"Ei":{let n=h.args[0];h=t.parse(`e^(${n})/(${n})`);break}case"Li":{let n=h.args[0];h=t.parse(`1/${de.LOG}(${n})`);break}case"erf":h=t.parse(`(2*e^(-(${h.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let n=String(h.args[0]),r=String(h.args[1]);h=t.parse(`(${r})/((${r})^2+(${n})^2)`);break}case"sign":h=new se(0);break;case"sinc":h=t.parse(le("(({0})*cos({0})-sin({0}))*({0})^(-2)",h.args[0]));break;case de.LOG10:h=t.parse(`1/((${h.args[0]})*${de.LOG}(10))`);break;default:h=t.symfunction("diff",[h,j])}h.multiplier=h.multiplier.multiply(e)}else if(M===$e||M===Ue&&xe(h.power)){let e;M===$e?e=h.value:M===Ue&&h.contains(z)?e=h.fname+G(ge(h.args[0])):e=h.value+G(ge(h.args[0])),H=b.diff(t.multiply(t.parse(Be+G(e)),h.power.clone()),z),h=t.multiply(h,H)}else if(M===Ue&&!h.power.equals(1))H=h.clone(),H.toLinear(),H.toUnitMultiplier(),h=t.multiply(U(h.clone()),q(H));else if(M===Ie||M===Se){let e=h.clone(),n=new se(0);for(let r in h.symbols)Object.hasOwn(h.symbols,r)&&(n=t.add(n,b.diff(h.symbols[r].clone(),z)));h=t.multiply(U(e),n)}return h.updateHash(),h}function fe(h,M,C){return t.multiply(h,t.parse(M+G(C||ge(h.args[0]))))}function i(h){let M=h.collectSymbols(),C=new se(0),H=M.length;for(let D=0;D<H;D++){let e=b.diff(M[D].clone(),z);for(let n=0;n<H;n++)D!==n&&(e=t.multiply(e,M[n].clone()));C=t.add(C,e)}return C}},integration:{u_substitution(X,j){let x="__u__";function z(C,H,D){let e=b.diff(H,j),n=D?D(C,H):t.divide(C.clone(),e);return n.contains(j,!0)?null:n}function U(C,H){let D=b.integrate(t.symfunction(C,[new se(x)]),x,0);return D=D.sub(new se(x),H),D.updateHash(),D}let q=X[0].clone(),fe=X[1].clone(),i=q.group,h=fe.group,M;if(i===Ue&&h!==Ue){let C=q.args[0];if(M=z(fe,C.clone()),M)return t.multiply(M,U(q.fname,C));if(M=z(fe,q),M)return b.integration.poly_integrate(q)}else if(h===Ue&&i!==Ue){let C=fe.args[0];if(M=z(q,C.clone()),M)return t.multiply(M,U(fe.fname,C))}else if(i===Ue&&h===Ue){if(M=z(q.clone(),fe.clone()),M||(M=z(fe.clone(),q.clone()),M))return t.multiply(b.integration.poly_integrate(fe),M)}else if(i===$e&&h!==$e){let C=q.power;if(M=z(fe,C.clone()),!M){let e=b.integration.decompose_arg(C.clone(),j),n=b.diff(e[2].clone(),j),r=b.integration.decompose_arg(n.clone(),j);if(t.multiply(e[1],r[1]).power.equals(fe.power)){let p=t.divide(e[0].clone(),r[0].clone()),w=t.multiply(p.clone(),t.pow(new se(q.value),t.multiply(e[0],new se(x))));return w=t.multiply(w,new se(x)),b.integration.by_parts(w,x,0,{}).sub(x,e[1].clone())}}let H=b.integrate(q.sub(C.clone(),new se(x)),x,0);return t.multiply(H.sub(new se(x),C),M)}else if(h===$e&&i!==$e){let C=fe.power;M=z(q,C.clone());let H=b.integrate(fe.sub(C,new se(x)),x,0);return t.multiply(H.sub(new se(x),C),M)}else if(q.isComposite()||fe.isComposite()){let C=function(e,n){let r=b.diff(n,j),p=l.Algebra.Factor.factorInner(e),w=l.Algebra.Factor.factorInner(r);return t.divide(p,w)},H=q.isComposite()?q.clone().toLinear():q.clone(),D=fe.isComposite()?fe.clone().toLinear():fe.clone();if(M=z(H.clone(),D.clone(),C),M)return t.multiply(b.integration.poly_integrate(fe),M);if(M=z(D.clone(),H.clone(),C),M)return t.multiply(b.integration.poly_integrate(q),M)}},poly_integrate(X){let j=X.power.toString(),x=X.multiplier.toDecimal(),z=X.toUnitMultiplier().toLinear();return Number(j)===-1?t.multiply(new se(x),t.symfunction(Be,[z])):t.parse(le("({0})*({1})^(({2})+1)/(({2})+1)",x,z,j))},stop(X){throw X||="Unable to compute integral!",l.Utils.warn(X),new je(X)},partial_fraction(X,j,x,z){xe(j)||(j=t.parse(j));let U;U=new se(0);let q=l.Algebra.PartFrac.partfrac(X,j);return q.group===te&&q.isLinear()?(q.each(fe=>{fe.isLinear()||b.integration.stop()}),q.each(fe=>{U=t.add(U,b.integrate(fe,j,x,z))})):U=t.add(U,b.integrate(q,j,x,z)),U},get_udv(X){let j=[[],[],[],[],[]],x=function(q){let fe=q.group;if(fe===Ue){let{fname:i}=q;l.Utils.inTrig(i)||l.Utils.inHtrig(i)?j[3].push(q):l.Utils.inInverseTrig(i)?j[1].push(q):i===Be?j[0].push(q):b.integration.stop()}else fe===ue||q.isComposite()&&q.isLinear()||fe===te&&q.isLinear()?j[2].push(q):fe===$e||q.isComposite()&&!q.isLinear()?j[4].push(q):b.integration.stop()};X.group===te?X.each(q=>{x(se.unwrapSQRT(q,!0))}):x(X);let z,U=new se(1);for(let q=0;q<5;q++){let fe=j[q],i,h=fe.length;if(h>0){if(h>1){i=new se(1);for(let M=0;M<h;M++)i=t.multiply(i,fe[M].clone())}else i=fe[0].clone();z?U=t.multiply(U,i):(z=i,z.multiplier=z.multiplier.multiply(X.multiplier))}}return[z,U]},trig_sub(X,j,x,z,U,q){U||=b.integration.decompose_arg(X.clone().toLinear(),j);let fe=U[3],i=U[2],h=U[0],M=U[1];if(M.power.equals(2)&&h.greaterThan(0)){let C=l.Utils.getU(X),H=t.parse(d+G(C)),D=t.parse(`${a+G(C)}^2`),e=t.multiply(X.sub(M,H),D),n=b.integrate(e,C,x,z).sub(H,M);return l.Utils.clearU(H),n}},by_parts(X,j,x,z){z.previous||=[];let U,q=b.integration.get_udv(X),fe=q[0],i=q[1],h=se.unwrapSQRT(t.expand(b.diff(fe.clone(),j)),!0),M=h.clone().stripVar(j);h=t.divide(h,M.clone());let C=b.integrate(i.clone(),j,x||0),H=t.multiply(C.clone(),h),D=H.toString();if(z.previous.indexOf(D)!==-1&&l.Utils.inTrig(fe.fname)&&i.isE())return z.is_cyclic=!0,new se(1);z.previous.push(D);let e=t.multiply(fe,C),n=H.multiplier.clone();H.toUnitMultiplier();let r=t.multiply(b.integrate(H.clone(),j,x,z),M);if(r.multiplier=r.multiplier.multiply(n),U=t.subtract(e,r),z.is_cyclic&&(z.previous.pop(),z.previous.length===0)){U=t.expand(U);let p=new se(0);U.each(w=>{w.contains(j)||(p=t.add(p,w.clone()))}),U=t.divide(t.subtract(U,p.clone()),t.subtract(new se(1),p))}return U},decompose_arg:l.Utils.decompose_fn},integrate(X,j,x,z){if(!j){let U=l.Utils.variables(X);U.length===1&&(j=U[0]),j||="x"}if(l.Utils.isVector(X)){let U=new l.Vector([]);return X.each(q=>{U.elements.push(b.integrate(q,j))}),U}return isNaN(j)||t.error(`variable expected but received ${j}`),X.isConstant(!0)?t.multiply(X.clone(),t.parse(j)):(z||={},l.Utils.block("PARSE2NUMBER",()=>{x||=0;let U=xe(j)?j.toString():j,q=se.unwrapSQRT(X.clone(),!0),fe=q.group,i;try{if(++x>l.Settings.integration_depth&&b.integration.stop("Maximum depth reached. Exiting!"),!q.contains(U,!0))i=t.multiply(q.clone(),t.parse(U));else if(fe===ue)i=b.integration.poly_integrate(q,U,x);else if(fe===$e)if(q.previousGroup===Ue&&!(q.fname==="sqrt"||q.fname===de.PARENTHESIS)&&b.integration.stop(),q.contains(U)&&q.previousGroup!==Ue)q.power.contains(U)?b.integration.stop():(b.diff(q.clone().toLinear(),U).contains(U)&&b.integration.stop(),i=b.integration.poly_integrate(q,U,x));else{let h=b.diff(q.power.clone(),U);if(h.contains(U)){let M=h.stripVar(U),C=t.divide(h.clone(),M.clone());if(C.group===ue&&C.isLinear())return M.multiplier=M.multiplier.divide(new ee(2)),t.parse(le("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",M,U,q.multiplier));b.integration.stop()}if(q.isE())h.isLinear()?i=q:h.isE()&&h.power.group===ue&&h.power.power.equals(1)?i=t.multiply(t.symfunction("Ei",[q.power.clone()]),q.power):b.integration.stop();else{let M=t.symfunction(Be,[t.parse(q.value)]);i=t.divide(q,M)}i=t.divide(i,h)}else if(q.isComposite()&&q.isLinear()){let h=t.parse(q.multiplier);q.toUnitMultiplier(),i=new se(0),q.each(M=>{i=t.add(i,b.integrate(M,U,x))}),i=t.multiply(h,i)}else if(fe===Ie)if(q.power.greaterThan(1)&&(q=t.expand(q)),q.power.equals(1))i=new se(0),q.each(h=>{i=t.add(i,b.integrate(h,U,x))},!0);else{let h=Number(q.power),M=q.multiplier.clone();q.toUnitMultiplier();let C=q.clone().toLinear(),H=b.integration.decompose_arg(C,U),D=H[3],e=H[2],n=H[0],r=H[1];if(h===-1&&r.group!==Se&&r.power.equals(2)){let p=u(D)?D>0:!0;if(r.group===ue&&r.power.equals(2)&&p){let w=function(Z){let K=new se(1);return Z.each(we=>{K=t.multiply(K,we.fname==="abs"?we.args[0]:we)}),K},E=n.clone(),_=D.clone();E=t.pow(E,new se(1/2)),_=t.pow(_,new se(1/2));let Y=t.multiply(w(_),w(E)),P=t.symfunction(V,[t.divide(t.multiply(n,r.toLinear()),Y.clone())]);i=t.divide(P,Y)}else if(r.group===ue&&r.isLinear())i=t.divide(b.integration.poly_integrate(q),n);else if(r.power.equals(4)){let w=G,E=t.parse(`${De+w(n)}*${U}^2`),_=t.parse(`${De+w(2)}*${w(n)}^${w("1/4")}*${w(D)}^${w("1/4")}*${U}`),Y=t.parse(De+w(D)),P=t.add(t.add(E.clone(),_.clone()),Y.clone()),Z=t.add(t.subtract(E,_),Y),K=t.parse(`${De+w(2)}*${w(D)}^${w("3/4")}`),we=t.parse(`${De+w(D)}*${w(D)}^${w("1/4")}*${U}`),Ee=t.parse(`2*${w(D)}*${De}${w(2)}*${w(D)}^${w("1/4")}`),ye=t.divide(t.subtract(K.clone(),we.clone()),t.multiply(Ee.clone(),Z)),Qe=t.divide(t.add(K,we),t.multiply(Ee,P.clone()));i=t.add(b.integrate(ye,U,x,z),b.integrate(Qe,U,x,z))}else i=b.integration.partial_fraction(q,U,x)}else if(h===-1/2)if(r.group===ue&&r.power.equals(2))if(e.multiplier.lessThan(0)&&!D.multiplier.lessThan(0))if(n.negate(),D.isConstant()&&n.isConstant()){let p=t.symfunction(De,[n.clone()]),w=t.symfunction(De,[t.multiply(n.clone(),D)]);i=t.divide(t.symfunction(S,[t.divide(e.toLinear(),w)]),p)}else{let p=t.symfunction(De,[n]),w=t.multiply(p.clone(),r.clone().toLinear());i=t.divide(t.symfunction(V,[t.divide(w,t.symfunction(De,[C.clone()]))]),p)}else b.integration.stop();else b.integration.stop();else if(h===1/2&&r.power.equals(2)&&n.greaterThan(0))b.integration.stop();else if(r.isLinear()&&r.group!==Se)i=t.divide(b.integration.poly_integrate(q),n);else if(r.power.equals(2)&&n.greaterThan(0)){let p=t.parse(De+G(n)),w=t.parse(De+G(D)),E=t.multiply(p.clone(),w.clone()).invert(),_=t.pow(D,new se(q.power)),Y=l.Utils.getU(q),P=t.multiply(E,r.clone().toLinear()),Z=t.symfunction(V,[P]),K=(Math.abs(q.power)-1)*2,we=b.integrate(t.parse(`${c+G(Y)}^${K}`));return l.Utils.clearU(Y),t.multiply(we.sub(Y,Z),_)}else if(q.group!==te&&!q.power.lessThan(0))i=b.integration.by_parts(q,U,x,z);else{let p=q.clone().toLinear(),E=l.Algebra.Factor.factorInner(p).toString()!==p.toString();if(l.Algebra.degree(p,t.parse(U)).equals(2)&&!E)try{let _=l.Algebra.sqComplete(p,U),Y=l.Utils.getU(p),P=_.f.sub(_.a,Y),Z=t.pow(P,t.parse(q.power));i=b.integrate(Z,Y).sub(Y,_.a)}catch(_){if(_.message==="timeout")throw _;b.integration.stop()}else i=b.integration.partial_fraction(q,U,x,z)}i.multiplier=i.multiplier.multiply(M)}else if(fe===Ue){let h=q.args[0],M=q.multiplier.clone();q.toUnitMultiplier();let C=b.integration.decompose_arg(h,U),H=C[0],D=C[1],{fname:e}=q;if(e===Be||e===S||e===I||e===V&&D.isLinear()){let n=q.power.toString();if(u(n)&&(x-=n),h.isComposite()){let r=l.Utils.getU(q),p=t.pow(t.parse(Be+G(r)),new se(n)),w=b.diff(h,U),E=t.multiply(p,w),_=b.integrate(E,r,x,z);i=t.multiply(t.parse(M),_.sub(r,h))}else i=t.multiply(t.parse(M),b.integration.by_parts(q,U,x,z))}else if(e===d&&q.power.lessThan(0)){let n=q.clone();return n.power.negate(),n.fname=v,t.multiply(t.parse(M),b.integrate(n,U,x))}else{if(!H.contains(U,!0)&&q.isLinear())if(e===Xe){let n=t.divide(h.clone(),H.clone());if(n.group===ue&&!n.power.lessThan(0))if(l.Utils.even(n.power))i=b.integrate(h,U,x);else{let r=b.integrate(n,U,x);r.power=r.power.subtract(new ee(1)),i=t.multiply(t.multiply(t.symfunction(Xe,[n.toLinear()]),r),H)}else b.integration.stop()}else{let n=q.args[0].group,r=b.integration.decompose_arg(h,U);switch((!(n===Ie||n===ue||n===te)||!r[1].power.equals(1)||h.hasFunc())&&b.integration.stop(),e){case c:i=t.symfunction(J,[h]);break;case J:i=t.symfunction(c,[h]),i.negate();break;case d:i=t.parse(le(`${de.LOG}(sec({0}))`,h));break;case a:i=t.parse(le(`${de.LOG}(tan({0})+sec({0}))`,h));break;case m:i=t.parse(le(`-${de.LOG}(csc({0})+cot({0}))`,h));break;case v:i=t.parse(le(`${de.LOG}(sin({0}))`,h));break;case Q:i=t.symfunction(ce,[h]);break;case ce:i=t.symfunction(Q,[h]);break;case pe:i=t.parse(le(`${de.LOG}(cosh({0}))`,h));break;case F:i=b.integration.by_parts(q,U,x,z);break;case L:i=b.integration.by_parts(q,U,x,z);break;case B:i=b.integration.by_parts(q,U,x,z);break;case et:i=b.integration.by_parts(q,U,x,z);break;case _e:i=b.integration.by_parts(q,U,x,z);break;case Ve:i=b.integration.by_parts(q,U,x,z);break;case ae:i=t.parse(le("atan(sinh({0}))",h));break;case Ce:i=t.parse(le(`${de.LOG}(tanh(({0})/2))`,h));break;case Re:i=t.parse(le(`${de.LOG}(sinh({0}))`,h));break;case qe:i=b.integrate(t.parse(le("e^({0})",h)),U,x);break;case"S":{let p=q.args[0].clone(),w=b.integration.decompose_arg(p,U),E=w[1],_=w[0],Y=w[3];i=t.parse(le("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",_,Y,D));break}case"C":{let p=q.args[0].clone(),w=b.integration.decompose_arg(p,U),E=w[1],_=w[0],Y=w[3];i=t.parse(le("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",_,Y,E));break}case"erf":{let p=q.args[0].clone(),w=b.integration.decompose_arg(p,U),E=w[1],_=w[0];i=t.parse(le("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",_,E,p));break}case"sign":i=t.multiply(q.clone(),h.clone());break;default:b.integration.stop()}i=t.divide(i,H)}else if(D.isLinear())if(e===c||e===J){let n=Number(q.power);if(n<0)q.fname=e===J?m:a,q.invert().updateHash(),i=b.integrate(q,U,x);else{let r=q.args[0],p=q.clone(),w=q.clone(),E=new se((n-1)/n),_=t.multiply(H.clone(),new se(n)).invert();p.power=p.power.subtract(new ee(1)),w.power=w.power.subtract(new ee(2));let Y=t.symfunction(e===c?J:c,[h.clone()]);e===J&&Y.negate(),i=t.add(t.multiply(t.multiply(_,p),Y),t.multiply(E,b.integrate(t.parse(w),U,x)))}}else if(e===d||e===v){if(q.args[0].isLinear(U)){let n=q.power.subtract(new ee(1)).toString(),r=q.clone().toUnitMultiplier(),p=t.parse(le(`${e===v?"-":""}1/({2}*{0})*{3}({1})^({0})`,n,h,H,e));r.power=r.power.subtract(new ee(2)),r.power.equals(0)&&(r=t.parse(r)),i=t.subtract(p,b.integrate(r,U,x))}}else if(e===a||e===m){let n=q.power.subtract(new ee(1)).toString(),r=q.power.subtract(new ee(2)).toString(),p=e===a?d:v,w=q.clone().toUnitMultiplier(),E=le(`${e===m?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,H,n,r,h,e,p),_=t.parse(E);w.power=w.power.subtract(new ee(2)),w.power.equals(0)&&(w=t.parse(w)),i=t.add(_,t.multiply(new se(r/n),b.integrate(w,U,x)))}else(e===ce||e===Q)&&q.power.equals(2)?i=b.integrate(q.fnTransform(),U,x):b.integration.stop();else b.integration.stop();i.multiplier=i.multiplier.multiply(M)}}else if(fe===Se)i=b.integration.partial_fraction(q,U,x);else if(fe===te){q.getDenom().group===ue&&(q=t.expand(q));let M=q.stripVar(U),C=t.divide(q.clone(),M.clone());if(M.contains(U)&&(C=t.multiply(C,M),M=new se(1)),C.group===te){let H=C.collectSymbols().sort((e,n)=>e.group===n.group?Number(e.power)===Number(n.power)?e<n?1:-1:n.power-e.power:n.group-e.group).map(e=>{let n=se.unwrapSQRT(e,!0);return n.fname===qe?t.parse(le("({1})*e^({0})",n.args[0],n.multiplier)):n}),D=H.length;if(q.power<0){if(D===2)return b.integrate(t.expand(q),U,x,z)}else if(D===2){try{i=b.integration.u_substitution(H,U)}catch(e){if(e.message==="timeout")throw e}if(!i){let e=H[0].group,n=H[1].group,r=H[0],p=H[1],w=r.fname,E=p.fname;if(q=t.multiply(r.clone(),p.clone()),e===Ue&&n===Ue)if(w===Be||E===Be)i=b.integration.by_parts(q.clone(),U,x,z);else{H.sort((we,Ee)=>Ee.fname>we.fname);let _=r.args[0];(!_.isLinear()||!(_.group===Ie||_.group===te||_.group===ue))&&b.integration.stop();let Y=b.integration.decompose_arg(_,U),P=Y[1],Z=Y[0];P.isLinear()||b.integration.stop();let K=p.args[0];if(_.equals(K))if(w===J&&E===c||w===c&&E===J)if(r.power.lessThan(0)&&b.integration.stop(),w===J&&r.power.add(p.power).equals(0))r.fname=d,r.updateHash(),i=b.integrate(r,U,x);else if(mt(r.power)&&E===c&&p.power.lessThan(0)){let we=Number(r.power)/2,Ee=t.parse(le("(1-cos({0})^2)^({1})",r.args[0],we));i=b.integrate(t.expand(t.multiply(Ee,p.clone())),U,x,z)}else if(mt(r.power)&&E===J&&p.power.lessThan(0)){let we=Number(r.power)/2,Ee=t.parse(le("(1-sin({0})^2)^({1})",r.args[0],we));i=b.integrate(t.expand(t.multiply(Ee,p.clone())),U,x,z)}else{let we=l.Utils.even(r.power),Ee=l.Utils.even(p.power);if(i=new se(0),!we||!Ee){let ye,Qe;we?(ye=r,Qe=p):(ye=p,Qe=r);let be=ye.fname===c?-1:1,Ye=(Qe.power-1)/2,Fe=t.parse(`(1-${ye.fname}${l.Utils.inBrackets(_)}^2)^${Ye}`);t.expand(t.multiply(new se(be),t.multiply(ye.clone(),Fe))).each(ft=>{i=t.add(i,b.integration.poly_integrate(ft.clone()))})}else{let ye=function(Fe){let ft=Fe.power/2,St;return Fe.fname===c?St=`((1/2)+(cos(2*(${Fe.args[0]}))/2))^${ft}`:St=`((1/2)-(cos(2*(${Fe.args[0]}))/2))^${ft}`,t.parse(St)},Qe=ye(r),be=ye(p),Ze=t.multiply(Qe,be);return t.expand(Ze).each(Fe=>{i=t.add(i,b.integrate(Fe,U,x))}),t.multiply(i,M)}}else if(w===a&&E===d&&P.isLinear()&&p.isLinear())i=t.parse(le("sec({0})^({1})/({1})",r.args[0],r.power));else if(w===d&&E===a&&P.isLinear())if(r.isLinear()&&p.isLinear())i=t.divide(t.symfunction(a,[_.clone()]),Z);else if(mt(r.power)){let we=Number(r.power)/2,Ee=t.parse(le("(sec({0})^2-1)^({1})",r.args[0],we));i=b.integrate(t.expand(t.multiply(Ee,p)),U,x)}else b.integration.stop();else if(w===a&&E===c)r.fname=c,r.invert().updateHash(),i=b.integrate(t.multiply(r,p),U,x);else if(w===J&&E===m)p.fname=J,p.invert().updateHash(),i=b.integrate(t.multiply(r,p),U,x);else if(w===d&&(E===c||E===J)&&p.power.lessThan(0)){let we=t.multiply(r.fnTransform(),p);i=b.integrate(t.expand(we),U,x)}else{let we=t.multiply(r.fnTransform(),p.fnTransform());i=b.integrate(t.expand(we),U,x)}else if((w===J||w===c)&&(E===J||E===c))if(r.isLinear()&&p.isLinear())if(r.args[0].isLinear()&&p.args[0].isLinear()){let we,Ee;E===J?(we=r.args[0],Ee=p.args[0]):(Ee=r.args[0],we=p.args[0]);let ye=t.parse(le("(sin(({1})+({0}))+sin(({1})-({0})))/2",we.toString(),Ee.toString()));i=b.integrate(ye,U,x)}else{let we=Le(H);i=b.integrate(t.expand(we),U,x)}else{let we=new se(1);H.forEach(ye=>{let Qe=ye.fnTransform();we=t.multiply(we,Qe)});let Ee=t.expand(we);i=b.integrate(Ee,U,x),i.hasIntegral()&&(i=b.integrate(Le(we.collectSymbols()),U,x))}else b.integration.stop()}else if(e===Ue&&n===ue){let _=r.isLinear();if(r.fname===c&&_&&p.power.equals(-1))i=t.symfunction("Ci",[r.args[0]]);else if(r.fname===c&&p.power.equals(-1))i=b.integrate(t.multiply(r.fnTransform(),p.clone()),U,x);else if(r.fname===ce&&_&&p.power.equals(-1))i=t.symfunction("Chi",[r.args[0]]);else if(r.fname===ce&&p.power.equals(-1))i=b.integrate(t.multiply(r.fnTransform(),p.clone()),U,x);else if(r.fname===J&&_&&p.power.equals(-1))i=t.symfunction("Si",[r.args[0]]);else if(r.fname===J&&p.power.equals(-1))i=b.integrate(t.multiply(r.fnTransform(),p.clone()),U,x);else if(r.fname===Q&&_&&p.power.equals(-1))i=t.symfunction("Shi",[r.args[0]]);else if(r.fname===Q&&p.power.equals(-1))i=b.integrate(t.multiply(r.fnTransform(),p.clone()),U,x);else if(r.fname===Be&&p.power.equals(-1))i=b.integration.poly_integrate(r,U,x);else if(r.fname==="erf"){if(p.power.equals(1)){let Y=b.integration.decompose_arg(r.args[0],U),P=Y[0],Z=Y[1],K=r.args[0].toString();i=t.parse(le("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",P,Z,K))}}else i=b.integration.by_parts(q,U,x,z)}else if(e===$e&&n===ue){let _=w===Be?b.integration.decompose_arg(r.args[0],U)[1]:null;r.isE()&&(r.power.group===ue||r.power.group===te)&&p.power.equals(-1)?i=t.symfunction("Ei",[r.power.clone()]):w===Be&&_.value===p.value?i=b.integration.poly_integrate(r,U,x):i=b.integration.by_parts(q,U,x,z)}else if(e===Se&&n===ue){if(p.value===r.value&&r.power.equals(-1)){let _=Math.min.apply(null,l.Utils.keys(r.symbols)),Y=Math.min(_,p.power),P=p.clone();P.power=new ee(Y),p=t.divide(p,P.clone());let Z=new se(0);r.each(K=>{Z=t.add(Z,t.divide(K.clone(),P.clone()))}),Z.multiplier=r.multiplier,q=t.divide(p,Z)}else q=t.expand(q);i=b.integration.partial_fraction(q,U,x)}else if(e===Ie&&n===ue){let _=r.clone().toLinear(),Y=l.Algebra.degree(_,t.parse(U)).equals(1);if(r.power.equals(-1/2)){let P=b.integration.decompose_arg(r.clone().toLinear(),U),Z=P[0].negate(),K=P[1],we=P[3],Ee=Number(r.power),ye=Number(p.power);if(u(ye)&&l.Utils.even(ye)&&K.power.equals(2)){let Qe=t.divide(t.multiply(t.pow(we.clone(),new se(2)),t.symfunction(De,[t.divide(we.clone(),Z.clone())])),t.pow(Z.clone(),new se(2)));Qe=t.multiply(Qe,t.symfunction(De,[we]).invert());let be=t.parse("sin(u)");be.power=be.power.multiply(p.power);let Ze=b.integrate(be,"u",x),Ye=t.parse(`${S}(${De}(${Z}/${we})*${U})`);i=t.multiply(Qe,Ze.sub(new se("u"),Ye))}else if(Ee===-1/2){let Qe=function(be,Ze){let Ye=t.parse(b.integrate(be,U,x,z).sub(U,le(Ze,U)));if(!Ye.hasIntegral())return Ye};ye===-1?i=Qe(t.expand(t.expand(t.pow(t.multiply(r.invert(),p.invert()),new se(2)))).invert(),"sqrt(1-1/({0})^2)"):ye===-2&&(i=Qe(t.sqrt(t.expand(t.divide(t.pow(q,new se(2)).invert(),t.pow(new se(U),new se(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(r.power.equals(-1)&&p.isLinear()&&Y)i=b.integration.partial_fraction(q,U,x);else if(!r.power.lessThan(0)&&u(r.power)){let P=t.expand(r);i=new se(0),P.each(Z=>{Z.group===Se?Z.each(K=>{i=t.add(i,b.integrate(t.multiply(p.clone(),K),U,x))}):i=t.add(i,b.integrate(t.multiply(p.clone(),Z),U,x))})}else if(r.power.lessThan(-2))i=b.integration.by_parts(q,U,x,z);else if(r.power.lessThan(0)&&p.power.greaterThan(1)){let P=b.integration.decompose_arg(r.clone().toLinear(),U),Z=P[0].negate(),K=P[1],we=P[3],Ee=r.clone().toLinear();if(K.group!==Se&&K.isLinear()){let ye=Number(p.power),Qe="_u_",be=new se(Qe),Ze=t.expand(t.divide(t.pow(t.subtract(be.clone(),we.clone()),new se(ye)),be.clone())),Ye={};Ye[Qe]=Ee;let Fe=t.parse(Ze,Ye);i=b.integrate(Fe,U,0)}else if(p.power.greaterThan(K.power)||p.power.equals(K.power)){let ye=new l.Algebra.Classes.Factors;r=l.Algebra.Factor.coeffFactor(r.invert(),ye);let Qe=l.Algebra.divide(p,r);Qe.group===te?i=b.integration.by_parts(q,U,x,z):(i=new se(0),Qe.each(be=>{i=t.add(i,b.integrate(be,U,x))}),ye.each(be=>{i=t.divide(i,be)}),i=t.expand(i))}else i=b.integration.partial_fraction(q,U,x)}else if(r.power.den.equals(2)){let P=b.integration.decompose_arg(r.clone().toLinear(),U),Z=P[3],K=P[1],we=P[0],Ee=P[2];if(K.power.equals(2)&&we.lessThan(0)){Z.equals(1)||(M=t.multiply(M,t.pow(Z,new se(2))));let ye=U,Qe=t.divide(t.pow(we.clone().negate(),new se(1/2)),t.pow(Z,new se(1/2))),be=t.symfunction(c,[new se(ye)]),Ze=t.pow(t.symfunction(c,[new se(ye)]),new se(r.power.num)),Ye=t.pow(t.symfunction(J,[new se(ye)]),new se(p.power)),Fe=t.multiply(t.multiply(Ze,be),Ye);i=b.integrate(Fe,ye,x).sub(ye,t.symfunction(S,[t.multiply(new se(U),Qe)]))}else i=b.integration.partial_fraction(q,U,x,z)}else Y&&(i=b.integration.partial_fraction(q,U,x))}else if(r.isComposite()&&p.isComposite())if(i=new se(0),r.power.greaterThan(0)&&p.power.greaterThan(0))t.expand(q).each(Y=>{i=t.add(i,b.integrate(Y,U,x))},!0);else{let _=Number(r.power),Y=Number(p.power);if(_<0&&Y>0){let P=r;r=p,p=P}_===-1&&Y===-1?i=b.integration.partial_fraction(q,U):r.each(P=>{let Z=t.multiply(P,p.clone()),K=b.integrate(Z,U,x);i=t.add(i,K)})}else if(e===Ie&&H[0].power.greaterThan(0))r=t.expand(r),i=new se(0),r.each(_=>{i=t.add(i,b.integrate(t.multiply(_,p.clone()),U,x))},!0);else if(e===Ue&&n===$e&&l.Utils.inHtrig(r.fname))r=r.fnTransform(),i=b.integrate(t.expand(t.multiply(r,p)),U,x);else if(e===Ue&&n===Ie||n===Ue&&e===Ie){if(n===Ue&&e===Ie){let Ee=r;r=p,p=Ee}let _,Y,P,Z,K=se.unwrapSQRT(b.diff(r.clone(),U),!0),we=se.unwrapSQRT(p,!0);if(K.power.equals(we.power)){if(_=new se(p.power),P=K.clone().toLinear(),Z=p.clone().toLinear(),Y=l.Algebra.divide(P.toLinear(),Z),Y.isConstant()){let Ee=t.pow(Y,_.negate());i=t.multiply(Ee,b.integration.poly_integrate(r.clone()))}}else i=b.integration.by_parts(q,U,x,z)}else{let _=r.clone().toLinear(),Y=p.clone().toLinear();e===$e&&n===$e&&r.power.contains(U)&&p.power.contains(U)&&!_.contains(U)&&!Y.contains(U)?i=t.parse(le("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",_.toString(),Y.toString(),r.power.multiplier.toString(),p.power.multiplier.toString(),U)):i=b.integration.by_parts(q,U,x,z)}}}else if(D===3&&(H[2].group===ue&&H[2].power.lessThan(2)||H[0].group===Ie)){let e=H[0];if(e.group===Ie){e.power.greaterThan(1)&&(e=t.expand(e));let n=t.multiply(H[1],H[2]);i=new se(0),e.each(r=>{let p=t.multiply(r,n.clone()),w=b.integrate(p,U,x);i=t.add(i,w)},!0)}else i=b.integration.by_parts(q,U,x,z)}else if(st(H)){let e=new se(1);for(let n=0,r=H.length;n<r;n++)e=t.multiply(e,H[n].fnTransform());e=t.expand(e),i=b.integrate(e,U,x)}else{let e=Le(H);i=b.integrate(t.expand(e),U,x)}}else{if(C.equals(1))return b.integrate(t.expand(q),U,x);C.clone().toLinear().isPoly(!0)&&l.Utils.variables(C).length>1&&(C=l.Algebra.Factor.factorInner(C)),i=b.integrate(C,U,x)}i=t.multiply(i,M)}if(i)return i}catch(h){if(h.message==="timeout"||!(h instanceof je||h instanceof l.exceptions.DivisionByZero))throw h}return t.symfunction("integrate",[X,j])},!1))},defint(X,j,x,z){z||="x";let U=function(M,C,H){try{return t.parse(M,C)}catch(D){if(D.message==="timeout")throw D;return b.Limit.limit(M,z,H)}},q=l.Utils.variables(X),fe=X.hasTrig(),i,h;if(q.length===1&&!z&&(z=q[0]),fe||(h=b.integrate(X,z)),!fe&&!h.hasIntegral()){let M={},C={};M[z]=x,C[z]=j;let H=U(h,M,x,z),D=U(h,C,j,z);i=t.subtract(H,D)}else if(q.length===1&&j.isConstant()&&x.isConstant()){let M=l.Utils.build(X);i=new se(l.Math2.num_integrate(M,Number(j),Number(x)))}else i=t.symfunction("defint",[X,j,x,z]);return i},Limit:{interval(X,j){return t.parse(le("[{0}, {1}]",X,j))},diverges(){return b.Limit.interval("-Infinity","Infinity")},divide(X,j,x,z,U){if(U++>de.max_lim_depth)return;let q=X.clone(),fe=j.clone();if(j.fname===Xe){let p=X.sign(),w=z.sign();if(z.isInfinity)return t.multiply(new se(p),new se(w));if(z.equals(0)){let E=t.parse(X.multiplier),_=t.parse(j.multiplier);return t.divide(t.multiply(E,b.Limit.interval("-1","1")),_)}return b.Limit.diverges()}let i=function(p){if(l.Utils.isVector(p)){for(let w=0;w<p.elements.length;w++)if(!p.elements[w].isInfinity)return!1;return!0}return p.isInfinity},h=function(p,w){return l.Utils.isVector(p)?!1:p.equals(w)},M,C=0,H,D,e;do if(H=at(b.Limit.limit(X.clone(),x,z,U)),D=at(b.Limit.limit(j.clone(),x,z,U)),e=i(H)&&i(D)||h(H,0)&&h(D,0),e){let p=b.diff(X.clone(),x),w=b.diff(j.clone(),x),E=t.divide(p,w);X=E.getNum(),j=E.getDenom()}while(e&&++C<de.max_lim_depth);if(C>=de.max_lim_depth)return;let n=D.equals(0),r=Number(fe.power);return z.isConstant(!0)&&n?M=se.infinity(l.Utils.even(r)&&H.lessThan(0)?-1:void 0):n?M=b.Limit.diverges():M=t.divide(H,D),M},rewriteToLog(X){let j=X.power.clone();return X.toLinear(),t.pow(new se("e"),t.multiply(j,t.symfunction(`${de.LOG}`,[X])))},getSubbed(X,j,x){let z;X.group===$e&&(X=b.rewriteToLog(X));try{z=X.sub(j,x)}catch(U){if(U.message==="timeout")throw U;z=X}return z},isInterval(X){return l.Utils.isVector(X)},isConvergent(X){return!(b.Limit.isInterval(X)&&X.elements[0].isInfinity&&X.elements[1].isInfinity||X.containsFunction("limit"))},limit(X,j,x,z){if(X.isLinear()&&X.isComposite()){let fe=new se(0);return X.each(i=>{fe=t.add(fe,b.Limit.limit(i,j,x,z))},!0),fe}if(X=l.Algebra.Simplify.simplify(X),z||=1,z++>de.max_lim_depth)return;let U=t.parse(X.multiplier);X.toUnitMultiplier();let q;try{if(X.isConstant(!0))q=X;else{let fe={};fe[j]=x;try{let i=t.parse(X.sub(j,x),fe);(i.isConstant(!0)||i.isInfinity)&&(q=i)}catch(i){if(i.message==="timeout")throw i}if(!q){let i=X.getNum(),h=X.getDenom();if(h.isConstant(!0)){if(X.group===$e){let M=X.clone().toLinear(),C=X.power.clone(),H=M.getNum(),D=M.getDenom(),e=l.Utils.decompose_fn(D,j,!0);if(H.group===ue&&H.multiplier.isOne()&&e.ax.group===ue&&e.b.isConstant(!0)&&e.a.isOne()&&e.b.isConstant(!0))q=t.parse(le("(1/e^({0}))",e.b));else{let n=b.Limit.rewriteToLog(X.clone()),r=n.power.clone(),p=n.clone().toLinear(),w=b.Limit.limit(p,j,x,z),E=b.Limit.limit(r,j,x,z);q=t.pow(w,E)}}else if(X.group===Ue&&X.args.length===1){let M,C=b.Limit.limit(X.args[0],j,x,z);if(l.Utils.isVector(C))return q=C.map(D=>{let e=X.clone();return e.args[0]=D,b.Limit.limit(t.symfunction(X.fname,[D]),j,x,z)}),t.multiply(U,q);let H;if(C.isConstant(!0)){H=t.symfunction(X.fname,[C]);try{at(H),M=!0}catch(D){if(D.message==="timeout")throw D;M=!1}}if(M)q=H;else if(b.Limit.isConvergent(C)){if(X.fname===Be)switch(C.toString()){case"0":q=se.infinity().negate();break;case"Infinity":q=se.infinity();break;case"-Infinity":q=se.infinity();break}else if((X.fname===c||X.fname===J)&&x.isInfinity)q=b.Limit.interval(-1,1);else if(X.fname===d){let D=X.args[0],e=D.getNum(),n=D.getDenom(),r=e.toUnitMultiplier();(x.isInfinity||r.equals("pi")&&n.equals(2))&&(q=b.Limit.diverges())}else if(X.fname===de.FACTORIAL&&C.isInfinity)return se.infinity()}}else if(X.group===ue){if(X.power>0)return t.parse(X,fe);l.Utils.even(X.power)?q=se.infinity():q=b.Limit.diverges()}else if(X.group===te){let M,C,H=X.collectSymbols().sort((e,n)=>e.group-n.group),D=H.pop();for(M=at(b.Limit.limit(D,j,x,z));H.length;){let e=H.pop();C=at(b.Limit.limit(e,j,x,z)),M.isInfinity||!b.Limit.isConvergent(M)&&C.equals(0)||M.equals(0)&&b.Limit.isConvergent(C)?(e.containsFunction(Be)&&(e=[D,D=e][0]),e.invert(),M.isInfinity&&C.isInfinity?M=se.infinity():M=b.Limit.divide(D,e,j,x,z)):(M=t.multiply(M,C),D=t.multiply(D,e))}q=M}else if(X.isComposite()){let M;X.isLinear()||(X=t.expand(X)),q=new se(0);let C=X.collectSymbols().sort((e,n)=>n.group-e.group),H=[],D=new se(0);for(let e=0,n=C.length;e<n;e++){let r=C[e].clone();r.group===Ue||r.group===te&&r.hasFunc()?D=t.add(D,r):H.push(r)}H.unshift(D),H.length!==1&&(C=H);for(let e=0,n=C.length;e<n;e++){let r=C[e];try{M=b.Limit.limit(r,j,x,z)}catch(p){if(p.message==="timeout")throw p;M=b.Limit.diverges()}try{q=t.add(q,M)}catch(p){if(p.message==="timeout")throw p;if(z++>de.max_lim_depth)return;q=b.Limit.limit(b.diff(X,j),j,x,z)}}}}else q=b.Limit.divide(i,h,j,x,z)}}q||=t.symfunction("limit",[X,j,x])}catch(fe){if(fe.message==="timeout")throw fe;q=t.symfunction("limit",[X,j,x])}return t.multiply(U,q)}},Fresnel:{S(X){return X.isConstant(!0)?b.defint(t.parse("sin(pi*x^2/2)"),se(0),X,"x"):t.symfunction("S",[X])},C(X){return X.isConstant(!0)?b.defint(t.parse("cos(pi*x^2/2)"),se(0),X,"x"):t.symfunction("C",[X])}}};B0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return b.diff}},{name:"sum",visible:!0,numargs:4,build(){return b.sum}},{name:"product",visible:!0,numargs:4,build(){return b.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return b.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return b.defint}},{name:"S",visible:!0,numargs:1,build(){return b.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return b.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return b.Limit.limit}}]),B0.updateAPI()})()});var G0=u0((Bi,ln)=>{"use strict";var d0;typeof ln<"u"&&(d0=T0(),V0());(function(){let l=d0.getCore(),t=l.PARSER,{N:ee}=l.groups,{P:de}=l.groups,{S:xe}=l.groups,{EX:Ue}=l.groups,{FN:se}=l.groups,{PL:ge}=l.groups,{CP:G}=l.groups,{CB:u}=l.groups,{keys:le}=l.Utils,{even:mt}=l.Utils,{variables:at}=l.Utils,{format:Ke}=l.Utils,{round:ue}=l.Utils,{Frac:Se}=l,{isInt:Ie}=l.Utils,{NerdamerSymbol:te}=l,{CONST_HASH:$e}=l.Settings,He=l.Utils.importFunctions(),Be=l.Utils.evaluate;function qe(c,d,a){if(l.Utils.isSymbol(c))this.parse(c),this.variable||=d;else if(isNaN(c))typeof c=="string"&&this.parse(t.parse(c));else{if(a||=0,d===void 0)throw new l.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[a]=c,this.fill(c)}}qe.fromArray=function(d,a){if(typeof a>"u")throw new l.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let m=new qe;return m.coeffs=d,m.variable=a,m},qe.fit=function(d,a,m,v,S,I){let V=new Array(S+1),F=m-a;V[0]=a,V[S]=d,F-=d*v**S;for(let L=S-1;L>0;L--){let B=v**L,Q=F/B,pe=Math.sign(Q)*Math.floor(Math.abs(Q));F-=pe*B,V[L]=pe}if(F!==0)return null;for(let L=0;L<V.length;L++)V[L]=new Se(V[L]);return qe.fromArray(V,I)},qe.prototype={parse(c,d){if(this.variable=at(c)[0],!c.isPoly())throw l.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${l.Utils.text(c)}`);if(d||=[],c.power.absEquals(1)||(c=t.expand(c)),c.group===l.groups.N)d[0]=c.multiplier;else if(c.group===l.groups.S)d[c.power.toDecimal()]=c.multiplier;else for(let a in c.symbols){if(!Object.hasOwn(c.symbols,a))continue;let m=c.symbols[a],v=m.power;if(l.Utils.isSymbol(v))throw new l.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");v=m.group===ee?0:v.toDecimal(),m.symbols?this.parse(m,d):d[v]=m.multiplier}this.coeffs=d,this.fill()},fill(c){c=Number(c)||0;let d=this.coeffs.length;for(let a=0;a<d;a++)this.coeffs[a]===void 0&&(this.coeffs[a]=new Se(c));return this},trim(){let c=this.coeffs.length;for(;c--;){let d=this.coeffs[c],a=d.equals(0);if(d&&a){if(c===0)break;this.coeffs.pop()}else break}return this},modP(c){let d=this.coeffs.length;for(let a=0;a<d;a++){let m=this.coeffs[a],v;if(m<0){let V;for(v=a;v<d;v++)if(this.coeffs[v]>0){V=this.coeffs[v];break}if(V){for(;v>a;v--)this.coeffs[v]=this.coeffs[v].subtract(new Se(1)),this.coeffs[v-1]=this.coeffs[v-1].add(new Se(c));m=this.coeffs[a]}}let S=m.mod(c),I=m.subtract(S).divide(c);if(!I.equals(0)){let V=a+1,F=this.coeffs[V]||new Se(0);F=F.add(I),this.coeffs[V]=new Se(F),this.coeffs[a]=new Se(S)}}return this},add(c){let d=Math.max(this.coeffs.length,c.coeffs.length);for(let a=0;a<d;a++){let m=this.coeffs[a]||new Se(0),v=c.coeffs[a]||new Se(0);this.coeffs[a]=m.add(v)}return this},subtract(c){let d=Math.max(this.coeffs.length,c.coeffs.length);for(let a=0;a<d;a++){let m=this.coeffs[a]||new Se(0),v=c.coeffs[a]||new Se(0);this.coeffs[a]=m.subtract(v)}return this},divide(c){let{variable:d}=this,a=l.Utils.arrayClone(this.coeffs),m=l.Utils.arrayClone(c.coeffs),v=a.length,S=m.length-1,I=[];for(let L=0;L<v;L++){let B=v-(L+1),Q=B-S,ce=a[B].divide(m[S]);if(Q<0)break;I[Q]=ce;for(let pe=0;pe<=S;pe++)a[pe+Q]=a[pe+Q].subtract(m[pe].multiply(ce))}let V=qe.fromArray(a,d||"x").trim();return[qe.fromArray(I,d||"x"),V]},multiply(c){let d=this.coeffs.length,a=c.coeffs.length,m=[];for(let v=0;v<d;v++){let S=this.coeffs[v];for(let I=0;I<a;I++){let V=v+I,F=c.coeffs[I],L=m[V]||new Se(0);m[V]=L.add(S.multiply(F))}}return this.coeffs=m,this},isZero(){let c=this.coeffs.length;for(let d=0;d<c;d++)if(!this.coeffs[d].equals(0))return!1;return!0},sub(c){let d=new Se(0),a=this.coeffs.length;for(let m=0;m<a;m++){let v=this.coeffs[m];v.equals(0)||(d=d.add(v.multiply(new Se(c**m))))}return d},clone(){let c=new qe;return c.coeffs=this.coeffs,c.variable=this.variable,c},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let c=this.lc(),d=this.coeffs.length;for(let a=0;a<d;a++)this.coeffs[a]=this.coeffs[a].divide(c);return this},gcd(c){let d=this.coeffs.length-1,a=c.coeffs.length-1,m;if(d<a)return c.gcd(this);let v=this;for(;!c.isZero();){let I=c.clone();v=v.clone(),m=v.divide(I),c=m[1],v=I}let S=l.Math2.QGCD.apply(null,v.coeffs);if(!S.equals(1)){let I=v.coeffs.length;for(let V=0;V<I;V++)v.coeffs[V]=v.coeffs[V].divide(S)}return v},diff(){let c=[],d=this.coeffs.length;for(let a=1;a<d;a++)c.push(this.coeffs[a].multiply(new Se(a)));return this.coeffs=c,this},integrate(){let c=[0],d=this.coeffs.length;for(let a=0;a<d;a++){let m=new Se(a+1);c[m]=this.coeffs[a].divide(m)}return this.coeffs=c,this},gcf(c){let d=function(v){for(let S=0;S<v.length;S++)if(!v[S].equals(0))return S},a=[];for(let v=0;v<this.coeffs.length;v++){let S=this.coeffs[v];!S.equals(0)&&a.indexOf(S)===-1&&a.push(S)}let m=[l.Math2.QGCD.apply(void 0,a),d(this.coeffs)].toDecimal();if(c){let v=[];v[m[1]-1]=m[0],m=qe.fromArray(v,this.variable).fill()}return m},quad(c){let d=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let a=this.coeffs[2]||0,m=this.coeffs[1]||0,v=this.coeffs[0],S=m*m-4*a*v;return S<0&&!c||(d[0]=(-m+Math.sqrt(S))/(2*a),d[1]=(-m-Math.sqrt(S))/(2*a)),d},squareFree(){let c=this.clone(),d=1,a=c.clone().diff(),m=c.clone().gcd(a),v=c.divide(m)[0],S=qe.fromArray([new Se(1)],c.variable);for(;!m.equalsNumber(1);){let I=v.gcd(m),V=v.divide(I)[0];if(!V.equalsNumber(1)&&d>1){let F=V.clone();for(let L=1;L<d;L++)F.multiply(V.clone());V=F}S=S.multiply(V),d++,v=I,m=m.divide(I)[0]}return[S,v,d]},toSymbol(){let c=this.coeffs.length,{variable:d}=this;if(c===0)return new l.NerdamerSymbol(0);let a=c-1,m="";for(let v=0;v<c;v++){let S=v===a?"":"+",I=this.coeffs[v];I.equals(0)||(m+=`${I}*${d}^${v}${S}`)}return t.parse(m)},equalsNumber(c){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(c)},toString(){return this.toSymbol().toString()}},te.prototype.coeffs=function(d,a){a&&!this.isPoly(!0)&&t.error("Polynomial expected when requesting coefficients with order"),d||=[];let m=this.clone().distributeMultiplier();if(m.isComposite())for(let v in m.symbols){if(!Object.hasOwn(m.symbols,v))continue;let S=m.symbols[v];S.isComposite()?S.clone().distributeMultiplier().coeffs(d,a):a?d[S.isConstant()?0:S.power.toDecimal()]=S.multiplier:d.push(S.multiplier)}else if(a)d[m.isConstant(!0)?0:m.power.toDecimal()]=m.multiplier;else if(m.group===u&&m.isImaginary()){let v=new te(m.multiplier);m.each(S=>{(S.isConstant(!0)||S.imaginary)&&(v=t.multiply(v,S))}),d.push(v)}else d.push(m.multiplier);if(a)for(let v=0;v<d.length;v++)d[v]===void 0&&(d[v]=new te(0));return d},te.prototype.tBase=function(d){if(typeof d>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let a=[],m=this.collectSymbols(null,null,null,!0),v=m.length;for(let S=0;S<v;S++){let I=m[S],V=I.group,F=new De(I.multiplier,[],d);if(V===u)for(let L in I.symbols){if(!Object.hasOwn(I.symbols,L))continue;let B=I.symbols[L];F.terms[d[L]]=B.power}else F.terms[d[I.value]]=I.power;a.push(F.fill()),F.updateCount()}return a},te.prototype.altVar=function(d){let a=this.multiplier.toString(),m=this.power.toString();return(a==="1"?"":`${a}*`)+d+(m==="1"?"":`^${m}`)},te.prototype.sameVars=function(d){if(!(this.symbols||this.group===d.group))return!1;for(let a in this.symbols){if(!Object.hasOwn(this.symbols,a))continue;let m=this.symbols[a],v=d.symbols[a];if(!v||m.value!==v.value)return!1}return!0},te.prototype.groupTerms=function(d){d=String(d);let a,m,v,S=[];return this.each(I=>{if(I.group===ge){v=I.groupTerms(d);for(let V=0;V<v.length;V++){let F=v[V];F&&(S[V]=F)}}else a=l.Utils.decompose_fn(I,d,!0),m=a.x.value===d?Number(a.x.power):0,S[m]=t.add(S[m]||new te(0),a.a)}),S},te.prototype.collectFactors=function(){let d=[];return this.group===u?this.each(a=>{d.push(a.clone())}):d.push(this.clone()),d};function Xe(){this.factors={},this.length=0}Xe.prototype.getNumberSymbolics=function(){let d=0;return this.each(a=>{a.isConstant(!0)||d++}),d},Xe.prototype.add=function(d){if(d.equals(0))return this;if(d.equals(-1)&&this.length>0){let a=l.Utils.firstObject(this.factors,null,!0),m=t.symfunction(l.Settings.PARENTHESIS,[a.obj]).negate();return delete this.factors[a.key],this.add(m),this.length--,this}if(d.group===u){let a=this;d.multiplier.equals(1)||a.add(new te(d.multiplier)),d.each(m=>{a.add(m)})}else{this.preAdd&&(d=this.preAdd(d)),this.pFactor&&(d=t.pow(d,new te(this.pFactor)));let a=d.isConstant();if(a&&d.equals(1))return this;let m=a?d.value:d.text();m in this.factors?(this.factors[m]=t.multiply(this.factors[m],d),this.factors[m].equals(1)&&(delete this.factors[m],this.length--)):(this.factors[m]=d,this.length++)}return this},Xe.prototype.toSymbol=function(){let d=new te(1),a=Object.values(this.factors).sort((m,v)=>m.group>v.group);for(let m=0,v=a.length;m<v;m++){let S=a[m],I=S.power.equals(1)&&S.fname!==""?t.symfunction(l.PARENTHESIS,[S]):S;d=t.multiply(d,I)}return d.fname===""&&(d=te.unwrapPARENS(d)),d},Xe.prototype.merge=function(d){for(let a in d)a in this.factors?this.factors[a]=t.multiply(this.factors[a],d[a]):this.factors[a]=d[a];return this},Xe.prototype.each=function(d){for(let a in this.factors){if(!Object.hasOwn(this.factors,a))continue;let m=this.factors[a];m.fname===l.PARENTHESIS&&m.isLinear()&&(m=m.args[0]),d.call(this,m,a)}return this},Xe.prototype.count=function(){return le(this.factors).length},Xe.prototype.clean=function(){try{let d=l.Settings.CONST_HASH;this.factors[d].lessThan(0)&&(this.factors[d].equals(-1)?delete this.factors[d]:this.factors[d].negate(),this.each(a=>{a.negate()}))}catch(d){if(d.message==="timeout")throw d}},Xe.prototype.toString=function(){return this.toSymbol().toString()};function De(c,d,a){this.terms=d||[],this.coeff=c,this.map=a,this.sum=new l.Frac(0),this.image=void 0}De.prototype.updateCount=function(){this.count||=0;for(let d=0;d<this.terms.length;d++)this.terms[d].equals(0)||this.count++;return this},De.prototype.getVars=function(){let d=[];for(let a=0;a<this.terms.length;a++){let m=this.terms[a],v=this.getRevMap();m.equals(0)||d.push(this.revMap[a])}return d.join(" ")},De.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count},De.prototype.toSymbol=function(d){d||=this.getRevMap();let a=new te(this.coeff);for(let m=0;m<this.terms.length;m++){let v=d[m],S=this.terms[m];if(S.equals(0)||v===$e)continue;let I=new te(v);I.power=S,a=t.multiply(a,I)}return a},De.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let d={};for(let a in this.map)Object.hasOwn(this.map,a)&&(d[this.map[a]]=a);return this.revMap=d,d},De.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},De.prototype.getImg=function(){return this.image||this.generateImage(),this.image},De.prototype.fill=function(){let d=this.map.length;for(let a=0;a<d;a++)typeof this.terms[a]>"u"?this.terms[a]=new l.Frac(0):this.sum=this.sum.add(this.terms[a]);return this},De.prototype.divide=function(d){let a=this.coeff.divide(d.coeff),m=this.terms.length,v=new De(a,[],this.map);for(let S=0;S<m;S++)v.terms[S]=this.terms[S].subtract(d.terms[S]),v.sum=v.sum.add(v.terms[S]);return v},De.prototype.multiply=function(d){let a=this.coeff.multiply(d.coeff),m=this.terms.length,v=new De(a,[],this.map);for(let S=0;S<m;S++)v.terms[S]=this.terms[S].add(d.terms[S]),v.sum=v.sum.add(v.terms[S]);return v},De.prototype.isZero=function(){return this.coeff.equals(0)},De.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},l.Utils.toMapObj=function(d){let a=0,m={};for(let v=0;v<d.length;v++){let S=d[v];typeof m[S]>"u"&&(m[S]=a,a++)}return m.length=a,m},l.Utils.filledArray=function(d,a,m){let v=[];for(;a--;)v[a]=m?new m(d):d;return v},l.Utils.arrSum=function(d){let a=0,m=d.length;for(let v=0;v<m;v++)a+=d[v];return a},l.Utils.haveIntersection=function(d,a){return a.length>d.length&&([d,a]=[a,d]),d.some(m=>a.indexOf(m)>-1)},l.Utils.subFunctions=function(d,a){a||={};let m=[],v=new Set(at(d));return d.each(S=>{if(S.group===se||S.previousGroup===se){let I=l.Utils.text(S,"hash"),V=a[I];if(V)m.push(S.altVar(V));else{let F=0,L;do L=S.fname+le(a).length+(F>0?String(F):""),F++;while(v.has(L));a[I]=L,m.push(S.altVar(L))}}else S.group===u||S.group===ge||S.group===G?m.push(l.Utils.subFunctions(S,a)):m.push(S.text())}),d.group===G||d.group===ge?d.altVar(l.Utils.inBrackets(m.join("+"))):d.group===u?d.altVar(l.Utils.inBrackets(m.join("*"))):d.text()},l.Utils.getFunctionsSubs=function(d){let a={};for(let m in d)Object.hasOwn(d,m)&&(a[d[m]]=t.parse(m));return a};let J=l.Algebra={version:"1.4.6",proots(c,d){d||=7;let a=0,m=[],v=function(I,V,F){let L=S(I,V,F).concat(m);for(let B=0;B<a;B++)L.unshift(0);return L};if(c instanceof te&&c.isPoly()){if(c.distributeMultiplier(),c.group===ge){let ce=l.Utils.arrayMin(le(c.symbols)),pe=c.symbols[ce].clone().toUnitMultiplier();c=t.expand(t.divide(c,pe)),m.push(0)}if(c.group===l.groups.S)return[0];if(c.group===l.groups.PL){let ce=le(c.symbols),pe=l.Utils.arrayMin(ce);c=l.PARSER.divide(c,l.PARSER.parse(`${c.value}^${pe}`))}let I=le(c.symbols).sort().pop(),V=c.group===l.groups.PL?c.symbols:c.symbols[I],F=V.group,L=F===xe?[V.power.toDecimal()]:le(V.symbols),B=[],Q=l.Utils.arrayMax(L);for(let ce=1;ce<=Q;ce++){let pe=0;L.indexOf(`${ce}`)!==-1&&(F===xe?pe=V.multiplier:pe=V.symbols[ce].multiplier),B.unshift(pe)}return B.push(c.symbols[$e].multiplier),V.group===xe&&(B[0]=V.multiplier),v(B,L,Q)}if(l.Utils.isArray(c)){let I=c,V=[],F=[],L=0;for(let Q=0;Q<I.length;Q++){let ce=I[Q][0],pe=I[Q][1],Ce=pe-L-1;for(let ae=0;ae<Ce;ae++)V.unshift(0);V.unshift(ce),pe!==0&&F.push(pe),L=pe}let B=Math.max.apply(void 0,F);return v(V,F,B)}throw new l.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function S(I,V,F){let B,Q=I.slice(0);if(I.unshift(F),F>100)throw new l.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let ce=[],pe={};for(pe.Degree=F,B=0;B<F;B++)ce.push(0);let Ce=ce.slice(0);function ae(Le,b,X,j,x,z){x[0]=z.b=j[0],x[1]=z.a=-(b*z.b)+j[1];for(let U=2;U<Le;U++)x[U]=-(b*z.a+X*z.b)+j[U],z.b=z.a,z.a=x[U]}function Re(Le,b,X,j,x,z,U,q,fe){let i={},h=3;return i.b=i.a=0,ae(b,U,q,z,fe,i),x.c=i.a,x.d=i.b,Math.abs(x.c)<=100*Le*Math.abs(z[b-1])&&Math.abs(x.d)<=100*Le*Math.abs(z[b-2])||(x.h=q*j,Math.abs(x.d)>=Math.abs(x.c)?(h=2,x.e=X/x.d,x.f=x.c/x.d,x.g=U*j,x.a3=x.e*(x.g+X)+x.h*(j/x.d),x.a1=-X+x.f*j,x.a7=x.h+(x.f+U)*X):(h=1,x.e=X/x.c,x.f=x.d/x.c,x.g=x.e*U,x.a3=x.e*X+(x.g+x.h/x.c)*j,x.a1=-(X*(x.d/x.c))+j,x.a7=x.g*x.d+x.h*x.f+X)),h}function et(Le,b,X,j,x,z,U,q,fe){if(X===3){U[1]=U[0]=0;for(let h=2;h<b;h++)U[h]=q[h-2];return}let i=X===1?x:j;if(Math.abs(z.a1)>10*Le*Math.abs(i)){z.a7/=z.a1,z.a3/=z.a1,U[0]=fe[0],U[1]=-(fe[0]*z.a7)+fe[1];for(let h=2;h<b;h++)U[h]=-(fe[h-1]*z.a7)+q[h-2]*z.a3+fe[h]}else{U[0]=0,U[1]=-(fe[0]*z.a7);for(let h=2;h<b;h++)U[h]=-(fe[h-1]*z.a7)+q[h-2]*z.a3}}function _e(Le,b,X,j,x,z,U,q,fe,i,h,M,C,H,D,e,n){let r,p,w,E,_,Y,P,Z,K;b.b=b.a=0,Le===3||(Le===2?(r=(X+h)*i+M,p=(i+C)*q+H*fe):(r=X+C*U+M*i,p=q+(C+H*i)*fe),w=-(D[e-1]/n[e]),E=-(D[e-2]+w*n[e-1])/n[e],_=H*E*j,Y=w*z,P=w*w*x,Z=-(Y+P)+_,K=-Z+p+w*r,K!==0&&(b.a=-((C*(P+Y)+H*(w*j+E*z))/K)+C,b.b=H*(1+Z/K)))}function Ve(Le,b,X,j){let x,z;if(j.sr=j.si=j.lr=j.li=0,Le===0){j.sr=b===0?j.sr:-(X/b);return}if(X===0){j.lr=-(b/Le);return}let U=b/2;Math.abs(U)<Math.abs(X)?(z=X>=0?Le:-Le,z=-z+U*(U/Math.abs(X)),x=Math.sqrt(Math.abs(z))*Math.sqrt(Math.abs(X))):(z=-(Le/U*(X/U))+1,x=Math.sqrt(Math.abs(z))*Math.abs(U)),z>=0?(x=U>=0?-x:x,j.lr=(-U+x)/Le,j.sr=j.lr===0?j.sr:X/j.lr/Le):(j.lr=j.sr=-(U/Le),j.si=Math.abs(x/Le),j.li=-j.si)}function je(Le,b,X,j,x,z,U,q,fe,i,h,M){let C={},H,D,e,n,r,p,w,E,_,Y,P,Z=0,K,we=0;X.NZ=0,p=j,E=x;do{if(C.li=C.lr=C.si=C.sr=0,Ve(1,p,E,C),X.szr=C.sr,X.szi=C.si,X.lzr=C.lr,X.lzi=C.li,Math.abs(Math.abs(X.szr)-Math.abs(X.lzr))>.01*Math.abs(X.lzr))break;for(ae(U,p,E,fe,z,q),D=Math.abs(-(X.szr*q.b)+q.a)+Math.abs(X.szi*q.b),Y=Math.sqrt(Math.abs(E)),H=2*Math.abs(z[0]),r=-(X.szr*q.b),P=1;P<b;P++)H=H*Y+Math.abs(z[P]);if(H=H*Y+Math.abs(r+q.a),H=(9*H+2*Math.abs(r)-7*(Math.abs(q.a+r)+Y*Math.abs(q.b)))*Le,D<=20*H){X.NZ=2;break}if(Z++,Z>20)break;if(Z>=2&&n<=.01&&D>=e&&!we){for(n=n<Le?Math.sqrt(Le):Math.sqrt(n),p-=p*n,E+=E*n,ae(U,p,E,fe,z,q),P=0;P<5;P++)K=Re(Le,b,q.a,q.b,h,M,p,E,i),et(Le,b,K,q.a,q.b,h,M,i,z);we=1,Z=0}e=D,K=Re(Le,b,q.a,q.b,h,M,p,E,i),et(Le,b,K,q.a,q.b,h,M,i,z),K=Re(Le,b,q.a,q.b,h,M,p,E,i),_e(K,q,q.a,h.a1,h.a3,h.a7,q.b,h.c,h.d,h.f,h.g,h.h,p,E,M,b,fe),w=q.a,_=q.b,_!==0&&(n=Math.abs((-E+_)/_),p=w,E=_)}while(_!==0)}function st(Le,b,X,j,x,z,U,q,fe){let i,h,M,C,H,D,e,n,r,p,w,E=j-1;for(b.NZ=w=r=0,e=X.a;;){for(D=x[0],U[0]=D,p=1;p<z;p++)U[p]=D=D*e+x[p];for(M=Math.abs(D),C=Math.abs(e),i=.5*Math.abs(U[0]),p=1;p<z;p++)i=i*C+Math.abs(U[p]);if(M<=20*Le*(2*i-M)){b.NZ=1,b.szr=e,b.szi=0;break}if(w++,w>10)break;if(w>=2&&Math.abs(n)<=.001*Math.abs(-n+e)&&M>H){r=1,b.a=e;break}for(H=M,fe[0]=h=q[0],p=1;p<j;p++)fe[p]=h=h*e+q[p];if(Math.abs(h)>Math.abs(q[E])*10*Le)for(n=-(D/h),q[0]=U[0],p=1;p<j;p++)q[p]=n*fe[p-1]+U[p];else for(q[0]=0,p=1;p<j;p++)q[p]=fe[p-1];for(h=q[0],p=1;p<j;p++)h=h*e+q[p];n=Math.abs(h)>Math.abs(q[E])*10*Le?-(D/h):0,e+=n}return r}function Ge(Le,b,X,j,x,z,U,q,fe,i,h,M){let C={},H={},D=new Array(b),e=new Array(b),n,r,p,w,E,_,Y,P,Z,K,we,Ee,ye,Qe,be,Ze,Ye,Fe,Je,ft=1,St,Rt,n0,Vt,Yt,jt;for(M.NZ=0,w=p=.25,E=j,P=x,C.b=C.a=0,ae(fe,h,x,q,i,C),n=C.a,r=C.b,H.h=H.g=H.f=H.e=H.d=H.c=H.a7=H.a3=H.a1=0,Vt=Re(Le,U,n,r,H,z,h,x,D),St=0;St<X;St++){if(Fe=1,et(Le,U,Vt,n,r,H,z,D,i),Vt=Re(Le,U,n,r,H,z,h,x,D),_e(Vt,C,n,H.a1,H.a3,H.a7,r,H.c,H.d,H.f,H.g,H.h,h,x,z,U,q),be=C.a,Ye=Ze=C.b,K=z[U-1]===0?0:-(q[U]/z[U-1]),we=ye=1,St!==0&&Vt!==3&&(ye=Ye===0?ye:Math.abs((Ye-P)/Ye),we=K===0?we:Math.abs((K-E)/K),Qe=ye<Y?ye*Y:1,Ee=we<_?we*_:1,Yt=Qe<w?1:0,Rt=Ee<p?1:0,Rt||Yt)){for(Je=0;Je<U;Je++)e[Je]=z[Je];for(Z=K,n0=jt=0;;){if(!(Fe&&(Fe=0)==0&&Rt&&(!Yt||Ee<Qe))){if(je(Le,U,M,be,Ze,i,fe,C,q,D,H,z),n=C.a,r=C.b,M.NZ>0)return;if(ft=jt=1,w*=.25,n0||!Rt)ft=0;else for(Je=0;Je<U;Je++)z[Je]=e[Je]}if(ft!==0){if(C.a=Z,ft=st(Le,M,C,U,q,fe,i,z,D),Z=C.a,M.NZ>0)return;if(n0=1,p*=.25,ft!==0){be=-(Z+Z),Ze=Z*Z;continue}}for(Je=0;Je<U;Je++)z[Je]=e[Je];if(!Yt||jt)break}ae(fe,h,x,q,i,C),n=C.a,r=C.b,Vt=Re(Le,U,n,r,H,z,h,x,D)}P=Ye,E=K,Y=ye,_=we}}function nt(Le,b,X,j){let x=Le.Degree,z=Math.PI/180,U=Math.LN2,q=Le.Degree+1,fe=new Array(q),i=new Array(q),h=new Array(q),M=new Array(q),C={},H={},D,e,n,r,p,w,E,_,Y,P,Z,K,we,Ee,ye,Qe,be,Ze,Ye,Fe,Je,ft,St,Rt;K=1;do e=K,K/=2,we=1+K;while(we>1);let n0=Number.MIN_VALUE/e,Vt=Math.cos(94*z),Yt=Math.sin(94*z),jt=Math.sqrt(.5),l0=-jt;for(H.NZ=Ye=0,H.szr=H.szi=H.lzr=H.lzi=0;b[x]===0;)X[Ye]=j[Ye]=0,x--,Ye++;for(St=x+1;x>=1;){if(x<=2){x<2?(X[Le.Degree-1]=-(b[1]/b[0]),j[Le.Degree-1]=0):(C.li=C.lr=C.si=C.sr=0,Ve(b[0],b[1],b[2],C),X[Le.Degree-2]=C.sr,j[Le.Degree-2]=C.si,X[Le.Degree-1]=C.lr,j[Le.Degree-1]=C.li);break}for(E=0,_=Number.MAX_VALUE,B=0;B<St;B++)P=Math.abs(b[B]),P>E&&(E=P),P!==0&&P<_&&(_=P);if(Y=n0/_,(Y<=1&&E>=10||Y>1&&Number.MAX_VALUE/Y>=E)&&(Y=Y===0?Number.MIN_VALUE:Y,Je=Math.floor(Math.log(Y)/U+.5),p=2**Je,p!==1))for(B=0;B<St;B++)b[B]*=p;for(let ct=0;ct<St;ct++)i[ct]=Math.abs(b[ct]);i[x]=-i[x],ft=x-1,P=Math.exp((Math.log(-i[x])-Math.log(i[0]))/x),i[ft]!==0&&(Z=-i[x]/i[ft],P=Z<P?Z:P),Z=P;do{P=Z,Z=.1*P,w=i[0];for(let ct=1;ct<St;ct++)w=w*Z+i[ct]}while(w>0);r=P;do{n=w=i[0];for(let ct=1;ct<x;ct++)w=P*w+i[ct],n=P*n+w;w=P*w+i[x],r=w/n,P-=r}while(Math.abs(r/P)>.005);D=P;for(let ct=1;ct<x;ct++)fe[ct]=(x-ct)*b[ct]/x;for(fe[0]=b[0],K=b[x],we=b[ft],Rt=fe[ft]===0?1:0,Fe=0;Fe<5;Fe++)if(Ee=fe[ft],Rt){for(let ct=0;ct<ft;ct++)Ye=ft-ct,fe[Ye]=fe[Ye-1];fe[0]=0,Rt=fe[ft]===0?1:0}else{Qe=-K/Ee;for(let ct=0;ct<ft;ct++)Ye=ft-ct,fe[Ye]=Qe*fe[Ye-1]+b[Ye];fe[0]=b[0],Rt=Math.abs(fe[ft])<=Math.abs(we)*e*10?1:0}for(let ct=0;ct<x;ct++)M[ct]=fe[ct];for(Fe=1;Fe<=20;Fe++)if(Ze=-(Yt*l0)+Vt*jt,l0=Yt*jt+Vt*l0,jt=Ze,ye=D*jt,be=-(2*ye),Ge(e,q,20*Fe,ye,D,fe,x,b,St,h,be,H),H.NZ===0)for(let ct=0;ct<x;ct++)fe[ct]=M[ct];else{Ye=Le.Degree-x,X[Ye]=H.szr,j[Ye]=H.szi,St-=H.NZ,x=St-1;for(let ct=0;ct<St;ct++)b[ct]=h[ct];H.NZ===1||(X[Ye+1]=H.lzr,j[Ye+1]=H.lzi);break}if(Fe>20){Le.Degree-=x;break}}}nt(pe,Q,Ce,ce);let ot=ce.length;for(B=0;B<ot;B++){let Le=ue(ce[B],d+8),b=ue(Ce[B],d+8);b=d-String(b).length>2?b:Ce[B];let X=Le<0?"-":"";b===0&&(b=""),Le===0&&(Le=""),Math.abs(Le)===1?Le=`${X}i`:Le?Le=`${Le}*i`:Le="";let j=b&&Le?`${b}+${Le}`:b+Le;Ce[B]=j.replace(/\+-/gu,"-")}return Ce}},roots(c){if(c.isConstant(!0,!0))return l.Utils.nroots(c);let d=J.proots(c).map(a=>t.parse(a));return l.Vector.fromArray(d)},froot(c,d,a){return function(v){let I=a||l.Utils.build(l.Calculus.diff(c.clone())),V=c instanceof Function?c:l.Utils.build(c),F=1e4,L=!1,B=0;for(;!L;){let Q=v-V(v)/I(v),ce=Math.abs(Q)-Math.abs(v),pe=Math.abs(ce);v=Q,pe<1e-12?L=!0:B>F&&(v=null,L=!0),B++}return v}(Number(d))},quad(c,d,a){let m=function(v,S,I,V){return t.parse(`-(${S}+${V}*sqrt((${S})^2-4*(${v})*(${I})))/(2*${v})`)};return[m(c,d,a,1),m(c,d,a,-1)]},sumProd(c,d){return J.quad(-d,c,-1).map(a=>a.invert())},coeffs(c,d,a){c=t.expand(c),a||=[new te(0)];let m=at(c);d===void 0&&m.length===1&&(d=m[0]),d=String(d),c.group===Ue&&c.contains(d,!0)&&t.error(`Unable to get coefficients using expression ${c.toString()}`),m=at(c);let v=c.contains("pi")||c.contains("e")||c.containsFunction("sqrt");if(m.length===1&&m[0]===d&&!c.isImaginary()&&!v){let S=new qe(c).coeffs.map(I=>new te(I));for(let I=0,V=S.length;I<V;I++){let F=S[I],L=a[I];L&&(F=t.add(L,F)),a[I]=F}}else if(m.length===1&&m[0]===d&&!c.isImaginary()&&v&&c.group===G){let S=l.Utils.getCoeffs(c,d);for(let I=0,V=S.length;I<V;I++){let F=S[I],L=a[I];L&&(F=t.add(L,F)),a[I]=F}}else if(d||t.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),m.indexOf(d)===-1)a[0]=t.add(c,a[0]);else{a||=[new te(0)];let S;if(c.group===u){let I=c.symbols[d];I||t.error("Expression is not a polynomial!");let V=Number(I.power);S=t.divide(c.clone(),I.clone()),(S.contains(d,!0)||V<0||!Ie(V))&&t.error("Expression is not a polynomial!");let F=a[V];F&&(S=t.add(F,S)),a[V]=S}else c.group===G&&c.each(I=>{J.coeffs(I.clone(),d,a)},!0)}for(let S=0,I=a.length;S<I;S++)typeof a[S]>"u"&&(a[S]=new te(0));return a},polyPowers(c,d,a){a||=[];let m=c.group;if(m===ge&&d===c.value)a=a.concat(le(c.symbols));else if(m===G)for(let v in c.symbols){if(!Object.hasOwn(c.symbols,v))continue;let S=c.symbols[v],I=S.group,V=S.value;if(I===xe&&d===V)a.push(S.power);else if(I===ge||I===G)a=J.polyPowers(S,d,a);else if(I===u&&S.contains(d)){let F=S.symbols[d];F&&a.push(F.power)}else(I===ee||d!==V)&&a.push(0)}else m===u&&c.contains(d)&&a.push(l.Utils.decompose_fn(c,d,!0).x.power);return l.Utils.arrayUnique(a).sort()},Factor:{split(c){let d=new te(1),a=new te(1);return J.Factor.factorInner(c,new Xe).each(m=>{let v=t.parse(m);m.isConstant(!0)?d=t.multiply(d,v):a=t.multiply(a,v)}),[d,a]},mix(c,d){let a=le(c),m=a.length,v=[];for(let S=0;S<m;S++){let I=a[S],V=c[I],F=v.length;for(let L=0;L<F;L++){let B=v[L]*I;v.push(B),d&&v.push(-B)}for(let L=1;L<=V;L++)v.push(I**L)}return v},common(c,d){try{if(c.group===G){let a=t.expand(c.clone(),!0).collectSymbols(null,null,(V,F)=>(F.length||1)-(V.length||1)),m={},v=[];for(let V=0;V<a.length;V++){let F=a[V];v.push(F.multiplier.clone()),F.each(L=>{let B=Number(L.power);if(isNaN(B))throw new Error("exiting");L.value in m?(B<m[L.value][0]&&(m[L.value][0]=B),m[L.value][1].push(L)):m[L.value]=[B,[L]]})}let S=new te(1);for(let V in m)m[V][1].length===a.length&&(S=t.multiply(S,t.pow(new te(V),new te(m[V][0]))));let I=l.Math2.QGCD.apply(null,v);if(!I.equals(1)){d.add(new te(I));for(let V=0;V<a.length;V++)a[V].multiplier=a[V].multiplier.divide(I)}if(!S.equals(1)){d.add(S),c=new te(0);for(let V=0;V<a.length;V++)c=t.add(c,t.divide(a[V],S.clone()))}}}catch(a){if(a.message==="timeout")throw a}return c},zeroes(c,d){let a=function(){throw new l.exceptions.ValueLimitExceededError("Exiting")};try{let m,v,S;c=t.expand(c.clone());let I=c.toString(),V=at(c);v=new te(0);let F=[],L=[];for(let B=0,Q=V.length;B<V.length;B++){let ce={};for(let Ce=0;Ce<Q;Ce++)B!==Ce&&(ce[V[Ce]]=0);m=t.parse(I,ce);let pe=m.power;Ie(pe)||a(),F.push(m),L.push(m.power)}if(l.Utils.allSame(L)){let B=c.length,Q=F.length,ce=Math.round((Math.sqrt(8*B-1)-3)/2);Q===2?S=new Se(L[0]/(B-1)):Q===3&&ce!==0?S=new Se(L[0]/ce):S=l.Math2.QGCD.apply(null,L)}else S=l.Math2.QGCD.apply(null,L);if(!Ie(S))return c;for(let B=0;B<F.length;B++){let Q=F[B],ce=Q.power.clone().divide(S);if((Q.multiplier.num<0||Q.multiplier.den<0)&&ce%2===0)return c;Q.multiplier=new Se(Q.multiplier**(1/ce)),Q.power=S.clone(),v=t.add(v,Q)}if(v.group!==G)return c;for(;;){let B=J.div(c.clone(),v.clone());if(B[1].equals(0)){if(c=B[0],d.add(v.clone()),c.equals(1))break}else break}}catch(m){if(m.message==="timeout")throw m}return c},factor(c,d){l.Utils.checkTimeout();let a=d?[...d]:null;try{let m=J.Factor.factorInner(c,d);return m=m.pushMinus(),m}catch(m){if(m.message==="timeout")throw m;return d&&d.splice(0,d.length,...a),c}},factorInner(c,d){if(l.Utils.checkTimeout(),c.isConstant()&&c.isInteger())return l.Math2.factor(c);let a=t.parse(c);if(a.isConstant())return a.isInteger()?l.Math2.factor(a):c;if(a.equals(0)||a.equals(1))return a;let m=J.Factor._factor(a,d);if(m.equals(c)||m.equals(0)||m.equals(1))return m;if(m.group===u){let v=new te(1),S=t.parse(m.power),I=t.parse(m.multiplier);m.toUnitMultiplier(),m.multiplier.lessThan(0)&&(v.negate(),m.negate()),m.each(F=>{let L=t.parse(J.Factor._factor(F));if(I=t.multiply(I,te.create(L.multiplier)),L.toUnitMultiplier(),L.group===u){let B=new te(1);L.each(Q=>{let ce=t.parse(J.Factor._factor(Q));ce.group===u&&(I=t.multiply(I,te.create(ce.multiplier)),ce.toUnitMultiplier()),B=t.multiply(B,ce)}),B=t.pow(B,new te(L.power)),v=t.multiply(v,B)}else v=t.multiply(v,L)});let V=t.pow(v,S);m=t.multiply(I,V)}return m},quadFactor(c,d){if(c.isPoly()&&J.degree(c.equals(2))){let a=l.Utils.variables(c)[0],m=J.coeffs(c,a);if(m.length<3)return c;let v=J.Factor._factor(m[2].clone());if(v.group===u){let S=v.collectSymbols();if(S.length>2)return c;let I=t.multiply(t.parse(m[0]),t.parse(S[0])),V=t.parse(m[1]).negate(),F=t.parse(S[1]),L=J.quad(F,V,I).filter(B=>l.Utils.isInt(B));if(L.length===1){let B=L[0],Q=t.divide(m[0],t.parse(B));l.Utils.isInt(Q)&&(d.add(t.parse(Ke("({0})*({1})+({2})",S[1],a,Q))),d.add(t.parse(Ke("({0})*({1})+({2})",S[0],a,B))),c=new te(1))}}}return c},cubeFactor(c,d){if(c.isComposite()){let a=c.collectSymbols();if(a.length===2){let m=a[0].sign(),v=a[0].clone().abs(),S=a[1].sign(),I=a[1].clone().abs();if(v.isCube()&&I.isCube()){m<S&&([m,S]=[S,m],[v,I]=[I,v]);let V=t.parse(v.getNth(3)),F=t.parse(I.getNth(3)),L=t.multiply(t.expand(t.pow(v.clone().toUnitMultiplier(),t.parse("1/3"))),V),B=t.multiply(t.expand(t.pow(I.clone().toUnitMultiplier(),t.parse("1/3"))),F);m===1&&S===-1?(d.add(t.parse(Ke("(({0})-({1}))",L,B))),d.add(t.parse(Ke("(({0})^2+({0})*({1})+({1})^2)",L,B))),c=te(1)):m===1&&S===1&&(d.add(t.parse(Ke("(({0})+({1}))",L,B))),d.add(t.parse(Ke("(({0})^2-({0})*({1})+({1})^2)",L,B))),c=te(1))}}}return c},_factor(c,d){l.Utils.checkTimeout();let a=c.group;if(c.group===se){let v=c.args[0];if(v.group===xe&&v.isSimple())return c}else if(c.group===xe&&c.isSimple())return c;if(c.group===G){c.distributeMultiplier(!0);let v=new te(0);c.each(S=>{(S.group===G&&S.power.greaterThan(1)||S.group===u)&&(S=t.expand(S)),v=t.add(v,S)}),v.power=c.power,c=v}c.group===se&&c.fname!=="sqrt"&&(c=l.Utils.evaluate(c));let m=c.clone();try{if(c.group===u){let S=t.parse(c.power),I=J.Simplify.strip(c.getDenom()),V=J.Simplify.strip(c.getNum()),F=I.pop(),L=V.pop();if(L.equals(c))return c;let B=J.Factor.factorInner(L),Q=J.Factor.factorInner(F),ce=J.Simplify.unstrip(V,B),pe=J.Simplify.unstrip(I,Q);return t.divide(ce,pe)}if(c.group===xe)return c;if(c.isConstant())return c.equals(1)||c.equals(0)||!c.isInteger()?c.clone():l.Math2.factor(c);let v=c.power.clone();if(Ie(v)&&!(v.lessThan(0)&&c.group===se)){let S=v.sign();c.toLinear(),d||=new Xe;let I={};c=t.parse(l.Utils.subFunctions(c,I)),le(I).length>0&&(d.preAdd=function(Ce){return t.parse(Ce,l.Utils.getFunctionsSubs(I))}),c.isLinear()||(d.pFactor=c.power.toString(),c.toLinear());let V=at(c);c.isImaginary()&&V.push(l.Settings.IMAGINARY);let F=V.length>1;if(F){let pe=!0,Ce=!0;if(c.each(ae=>{ae.group!==xe&&(pe=!1),ae.multiplier.equals(1)||(Ce=!1)}),pe&&Ce)return t.pow(t.parse(c,l.Utils.getFunctionsSubs(I)),t.parse(v))}let L=new Xe;c=J.Factor.coeffFactor(c,L),L.each(pe=>{mt(v)&&pe.lessThan(0)&&pe.negate(),S<0&&pe.invert(),d.add(pe)});let B=new Xe;if(c=J.Factor.powerFactor(c,B),B.each(pe=>{S<0&&pe.invert(),d.add(pe)}),F)c=J.Factor.cubeFactor(c,d),c=J.Factor.mfactor(c,d),d.each(pe=>{S<0&&pe.power.negate()});else{let pe=V[0];c=J.Factor.squareFree(c,d,pe);let Ce=new Xe;c=J.Factor.trialAndError(c,Ce,pe);let ae=Ce.toSymbol();if(ae.equals(m))return ae;for(let Re in Ce.factors){if(!Object.hasOwn(Ce.factors,Re))continue;let et=Ce.factors[Re];d.add(t.pow(et,t.parse(v)))}c.equals(m)&&(c=J.Factor.quadFactor(c,d))}c=t.parse(c,l.Utils.getFunctionsSubs(I));let Q=d.length===1;d.add(t.pow(c,t.parse(v)));let ce=d.toSymbol();return Q&&c.equals(1)&&ce.isLinear()&&(ce=t.pow(ce,t.parse(v))),ce}return c}catch(v){if(v?.message==="timeout")throw v;return m}},reduce(c,d){if(c.group===G&&c.length===2){let a=c.collectSymbols().sort((m,v)=>v.multiplier-m.multiplier);if(a[0].power.equals(a[1].power)){let m=t.parse(a[0].power),v=a[0].clone().toLinear(),S=a[1].clone().toLinear();d.add(t.add(v.clone(),S.clone())),S.negate();let I=Number(m),V=new te(0);for(let F=1;F<=I;F++){let L=t.pow(v.clone(),t.subtract(m.clone(),new te(F))),B=t.pow(S.clone(),t.subtract(new te(F),new te(1)));V=t.add(V,t.multiply(L,B))}return V}}return c},squareFree(c,d,a){if(c.isConstant()||c.group===xe||!c.isPoly())return c;let v=new qe(c,a).squareFree(),S=v[2];if(S!==1){let I=v[1].toSymbol();return I.power=I.power.multiply(new Se(S)),d.add(J.Factor.factorInner(I)),J.Factor.squareFree(v[0].toSymbol(),d)}return c},powerFactor(c,d){if(c.group!==ge||c.previousGroup===Ue)return c;let a=le(c.symbols);if(!l.Utils.allNumeric(a))return c;let m=l.Utils.arrayMin(a),v=new te(0),S=t.parse(`${c.value}^${m}`);return c.each(I=>{I=t.divide(I,S.clone()),v=t.add(v,I)}),d.add(S),v},coeffFactor(c,d){if(c.isComposite()){let a=l.Math2.QGCD.apply(null,c.coeffs());if(a.equals(1)){let m=function(I){let V;return I.group===u?(V=0,I.each(F=>{V+=F.power})):V=Number(I.power),V},v=c.collectSymbols(null,null,null,!0).sort((I,V)=>I.isConstant(!0)?1:V.power-I.power),S=v[0];(m(S)>m(v[1])||v[1].isConstant(!0))&&S.multiplier.lessThan(0)&&(d.add(new te(-1)),c.each(I=>{I.negate()},!0))}else c.each(m=>{m.isComposite()?m.each(v=>{v.multiplier=v.multiplier.divide(a)}):m.multiplier=m.multiplier.divide(a)}),c.updateHash();d&&d.add(new te(a))}return c},trialAndError(c,d,a){let m=c.clone();try{let v=[];if(c.isConstant()||c.group===xe||!c.isPoly())return c;let S=new qe(c,a),I=S.coeffs[0],V=l.Math2.ifactor(I),F=J.proots(c);for(let L=0;L<F.length;L++){let B=F[L],Q=1;if(!isNaN(B)){for(let Re in V){if(!Object.hasOwn(V,Re))continue;let et=l.Utils.round(Math.log(Re)/Math.log(Math.abs(B)),8);if(Ie(et)){B=Re,Q=et;break}}let ce=new Se(B),pe=[new Se(ce.num).negate()];pe[Q]=new Se(ce.den);let Ce=qe.fromArray(pe,S.variable).fill(),ae=S.divide(Ce);ae[1].equalsNumber(0)&&(S=ae[0],v.push(Ce.toSymbol()))}}return S.equalsNumber(1)||(S=J.Factor.search(S,d)),v.forEach(L=>{d.add(L)}),S.toSymbol()}catch(v){if(v.message==="timeout")throw v;return m}},search(c,d,a){a||=10;let m=c.variable,v=function(ae,Re,et,_e){let Ve=qe.fit(ae,Re,et,a,_e,m);if(Ve&&Ve.coeffs.length>1){let je=c.divide(Ve);if(je[1].equalsNumber(0))return d.add(Ve.toSymbol()),[je[0],Ve]}return null},S=c.coeffs[0],I=l.Math2.ifactor(S),V=c.lc(),F=l.Math2.ifactor(V),L=c.sub(a),B=l.Math2.ifactor(L),Q=J.Factor.mix(B,L<0),ce=Math.ceil(c.coeffs.length/2),pe=V.lessThan(0),Ce=S.lessThan(0);for(F[1]=1,I[1]=1;ce--;)for(let ae in F)if(Object.hasOwn(F,ae)){for(let Re in I)if(Object.hasOwn(I,Re))for(let et=0;et<Q.length;et++){let _e=v(ae,Re,Q[et],ce);if(_e)return c=_e[0],l.Utils.isPrime(c.sub(a))||(c=J.Factor.search(c,d)),c;_e||(pe&&Ce?_e=v(-ae,-Re,Q[et],ce):pe?_e=v(-ae,Re,Q[et],ce):Ce&&(_e=v(ae,-Re,Q[et],ce)))}}return c},mSqfrFactor(c,d){if(c.group!==se){let a=at(c).reverse();for(let m=0;m<a.length;m++){let v=!1;do{if(a[m]===c.value){d.add(c),c=new te(1);continue}let S=l.Calculus.diff(c,a[m]),I=J.Factor.coeffFactor(S);if(I.equals(0)||I.equals(1)||I.equals(-1))break;let V=!0;I.isConstant()&&c.isComposite()&&c.each(L=>{L.multiplier%I!==0&&(V=!1)},!0);let F;if(V){let L=c.clone();if(F=J.divWithCheck(c,I.clone()),v=F[1].equals(0),c.equals(F[0])&&F[1].equals(0)){c=L;break}if(F[0].isConstant()){d.add(F[0]);break}}else v=!1;v&&(d.add(F[0]),c=I)}while(v)}}return c},sqdiff(c,d){if(c.isConstant("all"))return c;try{let a=function(S){return l.Utils.block("POSITIVE_MULTIPLIERS",()=>te.unwrapPARENS(He.sqrt(He.abs(S))),!0)},m=l.Utils.separate(c.clone());if(!m)return c;let v=[];for(let S in m)S!=="constants"&&v.push(m[S]);if(v.sort((S,I)=>I.power-S.power),v.length===2){let S,I;if(S=v.pop(),I=v.pop(),mt(S.power)&&mt(I.power)&&S.sign()===I.sign()&&S.group===xe&&I.group===xe)throw new Error("Unable to factor");if(S.isComposite()&&I.power.equals(2)&&S.sign()!==I.sign()){I=a(I);let V=J.Factor.factorInner(t.add(S,m.constants));V.power.equals(2)&&(V.toLinear(),d.add(t.subtract(V.clone(),I.clone())),d.add(t.add(V,I)),c=new te(1))}else if(S=S.powSimp(),I=I.powSimp(),(S.group===xe||S.fname==="")&&S.power.equals(2)&&(I.group===xe||I.fname==="")&&I.power.equals(2)&&!m.constants){if(S.multiplier.lessThan(0)){let V=I;I=S,S=V}S.multiplier.greaterThan(0)&&(S=a(S),I=a(I)),d.add(t.subtract(S.clone(),I.clone())),d.add(t.add(S,I)),c=new te(1)}}}catch(a){if(a.message==="timeout")throw a}return c},mfactor(c,d){if(c.group===se)if(c.fname==="sqrt"){let a=new Xe,m=J.Factor.common(c.args[0].clone(),a);m=J.Factor.coeffFactor(m,null),c=t.multiply(t.symfunction("sqrt",[m]),t.parse(c.multiplier)),a.each(v=>{c=t.multiply(c,t.parse(l.Utils.format("sqrt({0})",v)))})}else d.add(c),c=new te(1);else{c=J.Factor.mSqfrFactor(c,d);let a=at(c),m=c.collectSymbols().map(F=>te.unwrapSQRT(F)),v={},S={},I=a.length,V=m.length;for(let F=0;F<I;F++){let L=a[F];v[L]=new te(0);for(let B=0;B<V;B++){let Q=m[B];if(Q.contains(L)){let ce=Q.value===L?Q.power.toDecimal():Q.symbols[L].power.toDecimal();(!S[L]||ce<S[L])&&(S[L]=ce),v[L]=t.add(v[L],Q.clone())}}}for(let F in v){if(!Object.hasOwn(v,F))continue;let L=t.parse(`${F}^${S[F]}`),B=t.divide(v[F],L),Q=t.expand(B);if(Q.equals(1)||Q.equals(-1))break;let ce=J.div(c.clone(),Q);if(ce[0].equals(0))break;if(ce[1].equals(0)){let Ce=!1;if(ce[0].each(ae=>{Ie(ae.multiplier)||(Ce=!0)}),Ce){ce[1]=t.expand(t.multiply(ce[1],Q));break}}let pe=Ie(Q)&&Q.lessThan(0);if(ce[1].equals(0)&&!pe){let Ce=J.divWithCheck(c.clone(),ce[0].clone()),ae=Ce[0];if(ae.equals(0)||(c=Ce[1],ae.equals(-1)&&!c.equals(0)))return c;let Re=ce[0];if(c.equals(Re)){let et=J.Factor.reduce(Re,d);return c.equals(et)?et:J.Factor.mfactor(et,d)}return d.add(Re),c.equals(0)?ae:ae.isConstant("all")?(d.add(ae),ae):(c=J.Factor.mfactor(ae,d),c)}}}return c=J.Factor.sqdiff(c,d),c=J.Factor.zeroes(c,d),c}},allLinear(c){let d=c.length;for(let a=0;a<d;a++)if(!J.isLinear(c[a]))return!1;return!0},isLinear(c){let d=!1,a=c.group;if(a===ge||a===G){d=!0;for(let m in c.symbols){if(!Object.hasOwn(c.symbols,m))continue;let v=c.symbols[m],S=v.group;if((S===se||S===Ue)&&(d=!1),S===u)d=at(v).length===1;else if(S===ge||S===G)d=J.isLinear(v);else if(v.group!==ee&&v.power.toString()!=="1"){d=!1;break}}}else a===xe&&c.power===1&&(d=!0);return d},gcd(...c){let d;if(c.length===1&&c[0]instanceof l.Vector?d=c[0].elements:d=c,d.length===0)return new te(1);if(d.length===1)return d[0];let a=[],m=!1;for(let v=0;v<d.length;v++)if(d[v].group===se&&d[v].fname==="gcd")d=d.concat(d[v].args),d.splice(v,1);else{let S=at(d[v]);if(l.Utils.haveIntersection(S,a)){m=!0;break}else a=a.concat(S)}if(m||a.length===0){if(d.every(v=>v.getDenom().equals(1))){let v=d[0];for(let S=1;S<d.length;S++)v=J.gcd_(d[S],v);return v}return t.divide(J.gcd.apply(null,d.map(v=>v.getNum())),J.lcm.apply(null,d.map(v=>v.getDenom())))}return t.symfunction("gcd",d)},gcd_(c,d){if((c.group===se||c.group===de)&&(c=l.Utils.block("PARSE2NUMBER",()=>t.parse(c))),d.group===se&&(d=l.Utils.block("PARSE2NUMBER",()=>t.parse(d))),c.isConstant()&&d.isConstant())return new te(l.Math2.QGCD(new Se(Number(c)),new Se(Number(d))));let a=t.multiply(c.getDenom()||new te(1),d.getDenom()||new te(1)).invert();if(c=t.multiply(c.clone(),a.clone()),d=t.multiply(d.clone(),a.clone()),c=t.expand(c),d=t.expand(d),c.group===u||d.group===u){let F=t.divide(c.clone(),d.clone()),L=t.multiply(d.clone(),F.getDenom().invert());if(!L.equals(1))return L}if(c.group===Ue||d.group===Ue){let F=new te(l.Math2.GCD(c.multiplier,d.multiplier)),L=J.gcd_(c.value===$e?new te(1):t.parse(c.value),d.value===$e?new te(1):t.parse(d.value)),B=J.gcd_(t.parse(c.power),t.parse(d.power));return t.multiply(F,t.pow(L,B))}if(c.length<d.length){let F=c;c=d,d=F}let m=at(c),v=at(d);if(m.length===v.length&&m.length===1&&m[0]===v[0]||m.length===1&&v.length===0||m.length===0&&v.length===1)return c=new qe(c),d=new qe(d),t.divide(c.gcd(d).toSymbol(),a);let S=[];c.each(F=>{S.push(F.multiplier)}),d.each(F=>{S.push(F.multiplier)});let I;for(;!d.equals(0);){let F=d.clone();if(c=c.clone(),I=J.div(c,F),d=I[1],I[0].equals(0))return t.divide(new te(l.Math2.QGCD(c.multiplier,d.multiplier)),a);c=F}let V=l.Math2.QGCD.apply(void 0,S);return V.equals(1)||c.each(F=>{F.multiplier=F.multiplier.divide(V)}),c.equals(1)&&!c.isConstant()&&!d.isConstant()?t.divide(t.symfunction("gcd",[c,d]),a):t.divide(c,a)},lcm(...c){let d;c.length===1?c[0]instanceof l.Vector?d=c[0].elements:t.error("lcm expects either 1 vector or 2 or more arguments"):d=c;let a=d.reduce((I,V)=>t.multiply(I,V.clone()),new te(1)),m=(function(V,F){F=Number(F);let L=[],B,Q,ce,pe=2**V.length;for(Q=F;Q<pe;Q++){B=[],ce=V.length-1;do(Q&1<<ce)!==0&&B.push(V[ce]);while(ce--);B.length===F&&L.push(B)}return L})(d,d.length-1).map(I=>I.reduce((V,F)=>t.multiply(V,F.clone()),new te(1))),v;return d.every(I=>l.Utils.isVariableSymbol(I))?v=t.symfunction("gcd",l.Utils.arrayUnique(m)):v=J.gcd.apply(null,m),t.divide(a,v)},divide(c,d){let a,m=l.Algebra.Factor.factorInner(c.clone());a=m.getDenom(),a.isConstant("all")?a=new te(1):c=t.expand(te.unwrapPARENS(t.multiply(m,a.clone())));let v=J.div(c,d),S=t.divide(v[1],d);return t.divide(t.add(v[0],S),a)},divWithCheck(c,d){let a=[new te(0),c.clone()],m=J.div(c,d),v=c.clone(),S=t.multiply(m[0].clone(),d.clone());S=t.add(S,m[1].clone());let I=t.subtract(v,S);return I=t.expand(I),I.equals(0)?m:a},div(c,d){let a=[new te(0),c.clone()];try{if(d.isConstant("all"))return c.each(Q=>{Q.multiplier=Q.multiplier.divide(d.multiplier)}),[c,new te(0)];if(c=t.expand(c),d=t.expand(d),c.group===xe&&d.group===G){let Q=c.value,ce=l.Utils.decompose_fn(d.clone(),Q,!0);if(c.isLinear()&&ce.x&&ce.x.isLinear()&&d.isLinear()){let pe=te.create(c.multiplier);return[t.divide(pe.clone(),ce.a.clone()),t.divide(t.multiply(pe,ce.b),ce.a).negate()]}}if(c.group===xe&&d.group===xe){let Q=t.divide(c.clone(),d.clone());return Q.isConstant()?[Q,new te(0)]:[new te(0),c.clone()]}let m=c.hasFunc(),v=d.hasFunc(),S=!1,I;if(m||v){S=!0;let Q={};c=t.parse(l.Utils.subFunctions(c,Q)),d=t.parse(l.Utils.subFunctions(d,Q)),I=l.Utils.getFunctionsSubs(Q)}let V=l.Utils.arrayUnique(at(c).concat(at(d))),F,L,B;if((c.isImaginary()||d.isImaginary())&&V.push(l.Settings.IMAGINARY),V.length===1){let Q=new qe(c).divide(new qe(d));F=Q[0].toSymbol(),L=Q[1].toSymbol()}else{V.push($e);let Q=function(Ge){let nt=new te(0);for(let ot=0;ot<Ge.length;ot++){let Le=Ge[ot].toSymbol();nt=t.add(nt,Le)}return nt},ce=function(Ge,nt){let ot=Math.max.apply(null,Ge.terms),Le=0,b;if(!nt){for(let X=0;X<Ge.terms.length;X++)if(Ge.terms[X].equals(ot)&&(b=X,Le++),Le>1)return}if(nt){for(let X=0;X<Ge.terms.length;X++)if(Ge.terms[X].equals(ot)){b=X;break}}return[ot,b,Ge]},pe=l.Utils.toMapObj(V),Ce=function(Ge,nt){return nt.sum.subtract(Ge.sum)},ae=c.tBase(pe).sort(Ce),Re=d.tBase(pe).sort(Ce),et=function(Ge,nt){nt||=0;let ot=Ge[nt],Le=Ge.length;if(!ot)return;let b=ce(ot);for(let x=nt+1;x<Le;x++){let z=Ge[x],U=ot.sum.equals(z.sum);if(!U&&b)break;if(U){let q,fe,i,h,M=ot.terms.length;for(let D=0;D<M;D++){let e=ot.terms[D],n=z.terms[D];(typeof q>"u"||e.greaterThan(q))&&(q=e,i=D),(typeof fe>"u"||n.greaterThan(fe))&&(fe=n,h=D)}let C=q.subtract(z.terms[i]),H=fe.subtract(ot.terms[h]);if(H>C){b=[fe,h,z];break}if(C>H){b=[q,i,ot];break}}else if(b=ce(z),b)break;b=ce(z)}if(!b)return ce(Ge[0],!0);let X,j;for(let x=0;x<Re.length;x++){let z=Re[x].terms;if(j=b[1],j===z.length-1)return;if(X=z[j],!X.equals(0))break}return X.equals(0)?et(Ge,++nt):b},_e=function(Ge,nt){if(!Ge||!nt)return!1;for(let ot=0;ot<Ge.terms.length;ot++)if(Ge.terms[ot].lessThan(nt.terms[ot]))return!1;return!0},Ve=_e(ae[0],Re[0])&&ae[0].count>Re[0].count?Re:ae,je=et(Ve),st=[];if(je){let Ge=je[1],nt=function(U,q){return U[0].sum.equals(q[0].sum)?U.length>=q.length:!0},ot=function(U,q,fe){let i=[];for(let h=0;h<U.length;h++){let M=U[h];for(let C=0;C<M.terms.length;C++){let H=i[C],D=M.terms[C];h===0?i[C]=D:H&&!H.equals(D)&&(i[C]=void 0)}}for(let h=0;h<i.length;h++){let M=i[h];if(M&&!M.equals(0))return h}return fe},Le=function(U,q){let fe=U.len(),i=q.len(),h=q.terms[Ge],M=U.terms[Ge];return i>fe&&h.greaterThan(M)?i-fe:h.subtract(M)};Ge=ot(ae,Re,Ge),ae.sort(Le),Re.sort(Le);let b=Re[0],X=ae[0];if(B=new De(new Se(1),[],X.map),b.sum.greaterThan(X.sum)&&X.len()>1)for(let U=0;U<X.terms.length;U++){let q=b.terms[U].subtract(X.terms[U]);if(q.equals(0))B.terms[U]=new Se(0);else{let fe=q.add(new Se(1));B.terms[U]=q;for(let i=0;i<ae.length;i++)ae[i].terms[U]=ae[i].terms[U].add(fe)}}let j=_e(ae[0],Re[0]),x=0,z=200;for(;j&&nt(ae,Re);){if(x++>z)throw new l.exceptions.InfiniteLoopError("Unable to compute!");let U=ae[0].divide(Re[0]);st.push(U),ae.shift();for(let q=1;q<Re.length;q++){let fe=Re[q].multiply(U).generateImage(),i=ae.length;i===0&&(fe.coeff=fe.coeff.neg(),ae.push(fe),ae.sort(Le));for(let h=0;h<i;h++){let M=ae[h];if(M.getImg()===fe.getImg()){M.coeff=M.coeff.subtract(fe.coeff),M.coeff.equals(0)&&(l.Utils.remove(ae,h),h--);break}h===i-1&&(fe.coeff=fe.coeff.neg(),ae.push(fe),ae.sort(Le))}}if(j=_e(ae[0],Re[0]),!j&&ae.length>=Re.length){for(let q=1;q<ae.length;q++)if(j=_e(ae[q],Re[0]),j){ae.unshift(l.Utils.remove(ae,q));break}}}}F=Q(st),L=Q(ae),typeof B<"u"&&(B=B.toSymbol(),F=t.divide(F,B.clone()),L=t.divide(L,B))}return S&&(F=t.parse(F.text(),I),L=t.parse(L.text(),I)),[F,L]}catch(m){if(m.message==="timeout")throw m;return a}},line(c,d,a){l.Utils.isArray(c)&&(c=l.Utils.convertToVector(c)),l.Utils.isArray(d)&&(d=l.Utils.convertToVector(d)),a=t.parse(a||"x"),(!l.Utils.isVector(c)||!l.Utils.isVector(d))&&t.error(`Line expects a vector! Received "${c}" & "${d}"`);let m=t.subtract(d.e(1).clone(),c.e(1).clone()),v=t.subtract(d.e(2).clone(),c.e(2).clone()),S=t.divide(v,m),I=t.multiply(a,S.clone()),V=t.multiply(c.e(1).clone(),S);return t.add(t.subtract(I,V),c.e(2).clone())},PartFrac:{createTemplate(c,d,a,m){c=J.Factor.factorInner(c),c.each((Q,ce)=>{if(Q.group===se&&Q.fname===""&&Q.args[0].group===xe){let pe=Q.args[0];c.symbols?(delete c.symbols[ce],c.symbols[pe.value]=pe):c=Q.args[0]}});let v,S,I,V=d.collectFactors(),F=[],L=[],B=new te(1);for(let Q=0;Q<V.length;Q++){let ce=te.unwrapPARENS(V[Q]);if(ce.power.greaterThan(1)){S=Number(ce.power),v=ce.clone().toLinear(),I=Number(J.degree(v,m));for(let pe=0;pe<S;pe++){let Ce=t.pow(v.clone(),new te(pe+1));a.push(Ce.clone());let ae=t.divide(c.clone(),Ce.clone());L.push(I),F.push(ae)}}else{I=Number(J.degree(ce,m)),a.push(ce);let pe=t.divide(c.clone(),ce.clone());pe=t.expand(te.unwrapPARENS(pe)),L.push(I),F.push(pe)}}return a=a.map(Q=>t.multiply(Q,B.clone())),[a,F,L]},partfrac(c,d,a){let m=at(c);d||=t.parse(m[0]);try{let v,S,I,V=t.expand(c.getNum()),F=t.expand(c.getDenom().toUnitMultiplier());if(V.multiplier=c.multiplier,v=V.groupTerms(d),Number(J.degree(V,d))>=Number(J.degree(F,d))?(S=J.div(V.clone(),t.expand(F.clone())),I=S[0],V=S[1],v=V.groupTerms(d)):I=new te(0),Number(J.degree(F,d))===1){let Le=t.divide(V,F);return a?[I,Le]:t.add(I,Le)}let L=J.Factor.factorInner(F),B=J.PartFrac.createTemplate(F.clone(),L,[],d),Q=B[0],ce=B[1],pe=B[2],Ce=[v.length],ae=[],Re=[],et=[],_e,Ve;ce.forEach((Le,b)=>{_e=Q[b],Ve=pe[b];for(let X=0;X<Ve;X++){Re.push(_e.clone());let j=te.create(d,X),x=t.expand(t.multiply(Le,j.clone())).groupTerms(d),z=x.length;Ce.push(z),ae.push(x),et.push(j.clone())}});let je=l.Utils.arrayMax(Ce),st=new l.Matrix(l.Utils.fillHoles(v,je)).transpose(),Ge=new l.Matrix;for(let Le=0;Le<ae.length;Le++)Ge.elements.push(l.Utils.fillHoles(ae[Le],je));let nt=t.multiply(Ge.transpose().invert(),st),ot=a?[I]:I;return nt.each((Le,b)=>{let X=t.multiply(et[b],t.divide(Le,Re[b]));a?ot.push(X):ot=t.add(ot,X)}),ot}catch(v){if(v.message==="timeout")throw v;try{if(c.isComposite()){let S={};c.each(V=>{let F=V.getDenom(),L=V.getNum(),B=S[F];S[F]=B?t.add(B,L):L});let I=new te(0);for(let V in S)Object.hasOwn(S,V)&&(I=t.add(I,t.divide(S[V],t.parse(V))));c=I}}catch(S){if(S.message==="timeout")throw S}}return c}},degree(c,d,a){if(a||={nd:[],sd:[],depth:0},!d){let S=at(c);if(S.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(S.length===0)return new te(0);d=t.parse(S[0])}let m=c.group;c.isComposite()?(c=c.clone(),c.distributeExponent(),c.each(S=>{a.depth++,J.degree(S,d,a),a.depth--})):c.group===u?c.each(S=>{a.depth++,J.degree(S,d,a),a.depth++}):m===Ue&&c.value===d.value?a.sd.push(c.power.clone()):m===xe&&c.value===d.value?a.nd.push(t.parse(c.power)):a.nd.push(new te(0));let v=a.nd.length>0?l.Utils.arrayMax(a.nd):void 0;return a.depth===0&&a.sd.length>0?(v!==void 0&&a.sd.unshift(v),t.symfunction("max",a.sd)):(l.Utils.isSymbol(v)||(v=t.parse(v)),v)},sqComplete(c,d,a){l.Utils.isSymbol(d)||(d=t.parse(d));let m=function(ae){throw ae||="Stopping",new l.exceptions.ValueLimitExceededError(ae)};c.isPoly(!0)||m("Must be a polynomial!");let v=l.Utils.inBrackets;c=c.clone();let S=l.Algebra.degree(c,d);S.equals(2)||m(`Cannot complete square for degree ${S}`);let I=l.Algebra.coeffs(c,d),V=I[2],F=I[1].sign(),L=t.divide(I[1],new te(2)),B=t.pow(L.clone(),new te(2)),Q=He.sqrt(V),ce=t.divide(He.sqrt(B),Q.clone()),pe=t.subtract(I[0],t.pow(ce.clone(),new te(2)));if(a)return[V,L,pe];let Ce=t.parse(v(`${Q.clone()}*${d}${F<0?"-":"+"}${ce}`));return{a:Ce,c:pe,f:t.add(t.pow(Ce.clone(),new te(2)),pe.clone())}},Simplify:{strip(c){let d=t.parse(c.multiplier);c.toUnitMultiplier();let a=t.parse(c.power);return c.toLinear(),[d,a,c]},unstrip(c,d){let a=c[0],m=c[1];return t.multiply(a,t.pow(d,m))},complexSimp(c,d){let a=c.realpart(),m=c.imagpart(),v=d.realpart(),S=d.imagpart(),I=t.multiply(a.clone(),v.clone()),V=t.multiply(m.clone(),S.clone()),F=t.multiply(v.clone(),m),L=t.multiply(a,S.clone()),B=t.add(t.pow(v,new te(2)),t.pow(S,new te(2)));return t.divide(t.add(t.add(I,V),t.multiply(t.subtract(F,L),te.imaginary())),B)},trigSimp(c){let d=!0,a=0;for(;d&&c.containsFunction(["cos","sin","tan"]);){a++,d=!1,c=c.clone();let m=J.Simplify.strip(c);c=m.pop();let v=c.clone();if(c.group===G){let S=new te(0);c.each(I=>{let V=J.Simplify.trigSimp(I.fnTransform());S=t.add(S,V)},!0),v=t.pow(t.multiply(new te(c.multiplier),S),new te(c.power)),d=v.text()!==c.text()}else if(c.group===u){let S=c.getNum(),I=c.getDenom();if(S.fname==="sin"&&I.fname==="cos"&&S.args[0].equals(I.args[0])&&S.power.equals(I.power))v=t.parse(l.Utils.format("(({1})/({0}))*tan({2})^({3})",I.multiplier,S.multiplier,S.args[0],S.power)),d=!0;else if(S.fname==="tan"&&I.fname==="sin"&&S.args[0].equals(I.args[0])&&S.power.equals(I.power))v=t.parse(l.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",I.multiplier,S.multiplier,S.args[0],S.power)),d=!0;else{let V=new te(1),F={workDone:d};v.each(L=>{if(L.fname==="tan")L=t.parse(l.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",L.multiplier,J.Simplify._simplify(L.args[0]),L.power)),F.workDone=!0;else if(L.containsFunction(["cos","sin","tan"])){let B=J.Simplify.trigSimp(L);L.equals(B)||(L=B,F.workDone=!0)}V=t.multiply(V,L)}),d=F.workDone,v=V}}else if((c.fname==="cos"||c.fname==="sin")&&c.args[0].group===G){let S=0,I=new te(0),V=t.parse("pi/2");if(c.args[0].each(F=>{let L=t.divide(F.clone(),V.clone());L=J.Simplify._simplify(L),L=l.Utils.evaluate(L),Ie(L)?S+=L.multiplier.num.toJSNumber():I=t.add(I,F)}),S){S+=c.fname==="cos"?1:0,S%=4,S+=S<0?4:0;let F=["sin({0})","cos({0})","-sin({0})","-cos({0})"],L=l.Utils.format(F[S],I);v=t.parse(L),d=!0}else if(Object.keys(c.args[0].symbols).length>1){let F=c.args[0].clone(),L=Object.values(F.symbols),B=L[0],ce=L.slice(1).map(Ce=>`(${Ce.text()})`).join("+"),pe;c.fname==="sin"?pe=l.Utils.format("sin({0})cos({1})+sin({1})cos({0})",B,ce):pe=l.Utils.format("cos({0})cos({1})-sin({1})sin({0})",B,ce),v=t.parse(pe),d=!0}}else if((c.fname==="cos"||c.fname==="sin")&&c.args[0].multiplier.sign()===-1){let S=c.args[0].clone().negate(),I=l.Utils.format(`${c.fname}({0})`,S);c.fname==="sin"&&(I=`-${I}`),v=t.parse(I),d=!0}if(c.fname==="sin"&&c.args[0].multiplier.equals(2)&&!c.args[0].equals(2)){let S=c.args[0].clone().toUnitMultiplier(),I=l.Utils.format("2sin({0})cos({0})",S);v=t.parse(I),d=!0}if(v=J.Simplify.unstrip(m,v).distributeMultiplier(),c=v,a>10)break}return c},logArgSimp(c,d){if(d.value==="1"||d.value===1)return new te(0);let a=new te(0),m=d.multiplier.clone();if(d.toUnitMultiplier(),!m.equals(1)){let v=l.Utils.format("({0}({1}))",c,m);a=t.add(a,t.parse(v))}if(d.group===u)d.each(v=>{v=v.clone();let S=v.power.clone();J.Simplify.strip(v);let I=l.Utils.format("(({1})*{0}({2}))",c,S,v);a=t.add(a,t.parse(I))});else{let v=d.clone(),S=v.power.clone();J.Simplify.strip(v);let I=l.Utils.format("(({1})*{0}({2}))",c,S,v);a=t.add(a,t.parse(I))}return a},logSimp(c){if(c.group===se&&(c.fname==="log"||c.fname==="log10")){let d=c.clone(),a=J.Simplify.strip(c);c=a.pop();let m=c.args[0].clone(),v=m.getNum().clone(),S=m.getDenom().clone(),I=c.fname,V=J.Simplify.logArgSimp(I,v);if(!S.equals(1)){let F=J.Simplify.logArgSimp(I,S);V=t.subtract(V,F)}V=J.Simplify.unstrip(a,V).distributeMultiplier(),c=V}else if(c.containsFunction(["log","log10"]))for(let d in c.symbols){if(!Object.hasOwn(c.symbols,d))continue;let a=c.symbols[d];c.symbols[d]=J.Simplify.logSimp(a)}return c},_sqrtCompression(c,d,a){let m=J.Simplify.strip(c),v=Ce=>Ce.fname==="abs",S=Ce=>Ce.args[0],I=Ce=>v(Ce)?S(Ce):null,V=Ce=>Ce.type===xe&&Ce.value.startsWith("baseunit_"),F=(Ce,ae)=>{let Re=S(ae);return Re.equals(I(Ce))?[ae,null]:Re.equals(Ce)&&V(Ce)?[ae,null]:[null,ae]},L,B=!1,Q=(Ce,ae)=>{for(let Re=0;Re<Ce.length;Re++){let et=Ce[Re];if(et.isSQRT()){for(let _e=0;_e<ae.length;_e++){let Ve=ae[_e];if([Ve,et]=F(Ve,et),Ve!==null){ae[_e]=Ve,L=!0,B=!0;break}}Ce[Re]=et,Ce=Ce.filter(_e=>_e),ae=ae.filter(_e=>_e)}}return[Ce,ae]},ce=d.collectFactors(),pe=a.collectFactors();do L=!1,[ce,pe]=Q(ce,pe),[pe,ce]=Q(pe,ce);while(L);return B&&(c=ce.reduce((Ce,ae)=>Ce=t.multiply(Ce,ae),new te(1)),c=pe.reduce((Ce,ae)=>Ce=t.divide(Ce,ae),c)),c=J.Simplify.unstrip(m,c),c},fracSimp(c){let d=c.getDenom(),a=c.getNum();if(a.isImaginary()&&d.isImaginary()&&(c=J.Simplify.complexSimp(a,d)),c.isComposite()){c.power>1&&(c=t.expand(c));let m=c.collectSymbols(),v,S,I,V,F,L,B,Q,ce,pe,Ce;for(S=m.pop();m.length;)I=m.pop(),V=t.parse(S.getDenom()),F=t.parse(I.getDenom()),L=S.getNum(),B=I.getNum(),Ce=t.multiply(V.clone(),F.clone()),ce=t.multiply(L,F),pe=t.multiply(B,V),Q=t.add(ce,pe),S=t.divide(Q,Ce);return d=t.expand(S.getDenom()),a=t.expand(S.getNum()),a.isImaginary()&&d.isImaginary()?v=J.Simplify.complexSimp(a,d):v=t.divide(a,d),v.equals(c)?c:J.Simplify._simplify(v)}return c=J.Simplify._sqrtCompression(c,a,d),c=J.Simplify.simpleFracSimp(c),c},simpleFracSimp(c){let d=c.getDenom(),a=c.getNum(),m;return d=t.expand(d),a=t.expand(a),a.isImaginary()&&d.isImaginary()?m=J.Simplify.complexSimp(a,d):m=t.divide(a,d),m.equals(c)?c:m},ratSimp(c){if(c.group===u){let d=c.getDenom(),a=c.getNum().distributeMultiplier(),m=J.Simplify.fracSimp(d),v=J.Simplify.fracSimp(a);c=t.divide(v,m)}return c},sqrtSimp(c,d){let a,m=!1,v=c.clone();try{if(c.isSQRT()){let S=c.multiplier.clone(),I=c.args[0].clone(),V=J.Factor.factorInner(I),F=t.parse(V.multiplier),L=F.sign();a=new te(1);let B;if(V.group===u){let Q=new te(1);V.each(pe=>{if(pe=t.parse(pe),pe.group===ee){let Ce=t.sqrt(pe.clone());Ie(Ce)?a=t.multiply(a,Ce):Q=t.multiply(Q,pe)}else Q=t.multiply(Q,pe)});let ce=t.multiply(Q,t.parse(L));B=t.sqrt(ce.clone()),B.isImaginary()&&(B=t.sqrt(t.expand(ce.clone())))}else B=V.clone().toUnitMultiplier(),B=t.multiply(B,new te(L)),B=t.sqrt(B);a=t.multiply(a,B),a=t.pow(a,t.parse(c.power)),a=t.multiply(a,t.sqrt(F.abs())),a=t.multiply(a,t.parse(S)),m=!0}else c.isComposite()&&c.isLinear()?(a=new te(0),c.each(S=>{a=t.add(a,J.Simplify.sqrtSimp(S))},!0),a=t.pow(a,t.parse(c.power)),a=t.multiply(a,t.parse(c.multiplier)),m=!0):c.group===u&&(a=new te(1),c.each(S=>{let I=J.Simplify.sqrtSimp(S);a=t.multiply(a,I)}),a=t.pow(a,t.parse(c.power)),a=t.multiply(a,t.parse(c.multiplier)),m=!0);return m||a&&!Ie(a)&&(a=null),a||=t.parse(c),a}catch(S){if(S.message==="timeout")throw S;return v}},patternSub(c){let d={},a=function(v){let S=!1;return v.each(I=>{I.group===G?S=!0:I.symbols&&(S=a(I))}),S},m=function(v){v.each(S=>{if(!(!S.symbols&&S.group!==se)){if(a(S))m(S);else if(!d[S.value]){let I=l.Utils.getU(c);d[S.value]=I,c=c.sub(S.value,I)}}},!0)};return m(c),[c,d]},simplify(c){if(c.simplify)return c.simplify();let d=J.Simplify._simplify(c);return d=d.pushMinus(),d=t.parse(d),d},_simplify(c){let d=J.Simplify.strip(c.clone());if(c=d.pop(),c=J.Simplify.fracSimp(c),c.isConstant()||c.group===l.groups.S)return d.push(c),J.Simplify.unstrip(d,c);let a=c.clone();if(a=J.Simplify.sqrtSimp(a,d),a=J.Simplify.trigSimp(a),a=J.Simplify.logSimp(a),a=J.Simplify.ratSimp(a),a=J.Factor.factorInner(a),a.group===l.groups.CP&&a.isLinear()){let m=a.multiplier.clone();a.toUnitMultiplier();let v=new te(0);return a.each(S=>{let I=J.Simplify._simplify(S);v=t.add(v,I)}),a=v,a=t.multiply(a,new te(m)),a.multiplier.equals(-1)&&a.distributeMultiplier(),a=J.Simplify.unstrip(d,a),a}return a=J.Simplify.unstrip(d,a),a}},Classes:{Polynomial:qe,Factors:Xe,MVTerm:De}};l.Expression.prototype.simplify=function(){l.Utils.armTimeout();try{let d;if(typeof this.symbol.LHS>"u")d=new l.Expression(J.Simplify.simplify(this.symbol));else{let a=this.symbol.clone();a.LHS=J.Simplify.simplify(a.LHS),a.RHS=J.Simplify.simplify(a.RHS),d=a}return d}catch(d){if(d.message==="timeout")throw d;return this}finally{l.Utils.disarmTimeout()}},l.Collection.prototype.simplify=function(){return this.elements=this.elements.map(d=>J.Simplify.simplify(d)),this},l.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(d=>d.map(a=>J.Simplify.simplify(a))),this},d0.useAlgebraDiv=function(){let d=J.divideFn=t.divide,a=0;t.divide=function m(v,S){a++;let I;return a===1?I=l.Algebra.divide(v,S):I=m(v,S),a=0,I}},d0.useParserDiv=function(){J.divideFn&&(t.divide=J.divideFn),delete J.divideFn},d0.register([{name:"factor",visible:!0,numargs:1,build(){return J.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return J.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return J.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return J.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return J.roots}},{name:"divide",visible:!0,numargs:2,build(){return J.divide}},{name:"div",visible:!0,numargs:2,build(){return J.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return J.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return J.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...d){let a=J.coeffs(...d);return new l.Vector(a)}}}]),d0.coeffs=function(...d){let a=l.PARSER;for(let v=0;v<d.length;v++)typeof d[v]=="string"?d[v]=a.parse(d[v]):d[v]&&d[v].symbol?d[v]=d[v].symbol.clone():l.Utils.isSymbol(d[v])&&(d[v]=d[v].clone());let m=J.coeffs(...d);return new l.Expression(new l.Vector(m))},d0.register([{name:"line",visible:!0,numargs:[2,3],build(){return J.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(d,a){try{return a||=at(d)[0],J.sqComplete(d.clone(),a).f}catch(m){if(m.message==="timeout")throw m;return d}}}}]),d0.updateAPI()})()});var un=u0((Vi,an)=>{"use strict";var H0;typeof an<"u"&&(H0=T0(),V0(),G0());(function(){let l=H0.getCore(),t=l.PARSER,ee=l.Algebra,de=l.Calculus,xe=de.integration.decompose_arg,{evaluate:Ue}=l.Utils,{remove:se}=l.Utils,{format:ge}=l.Utils,{build:G}=l.Utils,{knownVariable:u}=l.Utils,{NerdamerSymbol:le}=l,{isSymbol:mt}=l.Utils,{variables:at}=l.Utils,{S:Ke}=l.groups,{PL:ue}=l.groups,{CB:Se}=l.groups,{CP:Ie}=l.groups,{FN:te}=l.groups,{Settings:$e}=l,{range:He}=l.Utils,{isArray:Be}=l.Utils;l.Settings.SOLVE_RADIUS=1e3,l.Settings.ROOTS_PER_SIDE=10,l.Settings.make_pi_conversions=!1,l.Settings.STEP_SIZE=.1,l.Settings.EPSILON=2e-13,l.Settings.MAX_NEWTON_ITERATIONS=200,l.Settings.NEWTON_EPSILON=2e-15,l.Settings.MAX_NON_LINEAR_TRIES=12,l.Settings.NON_LINEAR_JUMP_AT=50,l.Settings.NON_LINEAR_JUMP_SIZE=100,l.Settings.NON_LINEAR_START=.01,l.Settings.NEWTON_SLICES=200,l.Settings.SOLUTION_PROXIMITY=1e-14,l.Settings.FILTER_SOLUTIONS=!0,l.Settings.MAX_SOLVE_DEPTH=10,l.Settings.ZERO_EPSILON=1e-9,l.Settings.MAX_BISECTION_ITER=2e3,l.Settings.BI_SECTION_EPSILON=1e-12,l.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},l.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let m in this.symbols){if(!Object.hasOwn(this.symbols,m))continue;let v=this.symbols[m];if(v.group===ue&&v.hasNegativeTerms()||this.symbols[m].power.lessThan(0))return!0}return!1};function qe(a,m){if(m.isConstant()&&a.isConstant()&&!a.equals(m)||a.equals(l.Settings.IMAGINARY)&&m.isConstant(!0)||m.equals(l.Settings.IMAGINARY)&&a.isConstant(!0))throw new l.exceptions.NerdamerValueError(`${a.toString()} does not equal ${m.toString()}`);this.LHS=a,this.RHS=m}qe.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(a){return`${this.LHS.text(a)}=${this.RHS.text(a)}`},toLHS(a){a=!!a;let m=this.removeDenom(),v=m.LHS,S=m.RHS;v.isConstant(!0)&&!S.isConstant(!0)&&([v,S]=[S,v]);let I=t.subtract(v,S),V=a?t.expand(I):I;return V=new qe(V,new le(0)).removeDenom().LHS,V},removeDenom(){let a=this.LHS.clone(),m=this.RHS.clone(),v=t.multiply(a.getDenom(),m.getDenom());if(a=t.expand(t.multiply(a,v.clone())),m=t.expand(t.multiply(m,v)),m.group===Ie&&m.group!==Ie){let S=a;a=m,m=S}if(a.group===Se){let S=new le(a.multiplier),I=m.clone();a.each(V=>{V.power.lessThan(0)?I=t.divide(I,V):S=t.multiply(S,V)}),a=S,m=I}else if(a.group===Ie)for(let S in a.symbols){if(!Object.hasOwn(a.symbols,S))continue;let I=a.symbols[S];if(I.group===Se)for(let V in I.symbols){if(!Object.hasOwn(I.symbols,V))continue;let F=I.symbols[V];if(F.power.lessThan(0))return new qe(t.expand(t.multiply(F.clone().toLinear(),a)),t.expand(t.multiply(F.clone().toLinear(),m)))}}return new qe(a,m)},clone(){return new qe(this.LHS.clone(),this.RHS.clone())},sub(a,m){let v=this.clone();return v.LHS=v.LHS.sub(a.clone(),m.clone()),v.RHS=v.RHS.sub(a.clone(),m.clone()),v},isZero(){return l.Utils.evaluate(this.toLHS()).equals(0)},latex(a){return[this.LHS.latex(a),this.RHS.latex(a)].join("=")}},t.equals=function(m,v){return new qe(m,v)},(function(){let m=t.functions.simplify[0];t.functions.simplify[0]=function(S){return S instanceof qe?(S.LHS=m(S.LHS),S.RHS=m(S.RHS),S):m(S)}})(),l.Expression.prototype.equals=function(m){return m instanceof l.Expression&&(m=m.symbol),new qe(this.symbol,m)},l.Expression.prototype.solveFor=function(m){l.Utils.armTimeout();try{let{symbol:v}=this;if(this.symbol instanceof qe){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(m))return[new l.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(m))return[new l.Expression(this.symbol.RHS)]}return d(v,m).map(V=>(V=l.Algebra.Simplify.simplify(t.parse(V)),new l.Expression(V)))}finally{l.Utils.disarmTimeout()}},l.Expression.prototype.expand=function(){if(this.symbol instanceof qe){let m=this.symbol.clone();return m.RHS=t.expand(m.RHS),m.LHS=t.expand(m.LHS),new l.Expression(m)}return new l.Expression(t.expand(this.symbol))},l.Expression.prototype.variables=function(){return this.symbol instanceof qe?l.Utils.arrayUnique(l.Utils.variables(this.symbol.LHS).concat(l.Utils.variables(this.symbol.RHS))):l.Utils.variables(this.symbol)};let Xe=function(m,v){return t.equals(m,v)};l.Equation=qe;let De=l.Utils.checkAll=function(m,v){for(let S=0;S<m.length;S++)if(v(m[S]))return!1;return!0},J=l.Solve={version:"2.0.3",solutions:[],solve(a,m){let v=$e.PARSE2NUMBER;$e.PARSE2NUMBER=!1;let S=d(a,String(m));return $e.PARSE2NUMBER=v,new l.Vector(S)},toLHS(a,m){if(mt(a))return a;if(!(a instanceof qe)){let v=a.split("=");v[1]||="0",a=new qe(t.parse(v[0]),t.parse(v[1]))}return a.toLHS(m)},solveCircle(a,m){let v=m.map(L=>t.parse(L)),S=[],I=[];for(let L=0;L<a.length;L++){let B=[];for(let Q=0;Q<v.length;Q++)B.push(Number(l.Algebra.degree(a[L],v[Q])));B.push(l.Utils.arraySum(B,!0)),S.push(B)}let V=a[0],F=a[1];if(S[0][2]>S[1][2]&&([F,V]=[V,F],[S[1],S[0]]=[S[0],S[1]]),S[0][0]===1&&S[0][2]===2&&S[1][0]===2&&S[1][2]===4){let L=m[0],B=m[1],Q=d(t.parse(F,u(L,d(t.parse(V),L)[0])),B).map(pe=>pe.toString()),ce=[d(t.parse(V,u(B,Q[0])))[0].toString()];Q[1]&&ce.push(d(t.parse(V,u(B,Q[1])))[0].toString()),$e.SOLUTIONS_AS_OBJECT?(I={},I[L]=ce,I[B]=Q):(Q.unshift(B),ce.unshift(L),I=[ce,Q])}return I},solveNonLinearSystem(a,m,v){if(m<0)return[];v=typeof v>"u"?l.Settings.NON_LINEAR_START:v;let S=l.Settings.MAX_NON_LINEAR_TRIES,I=Math.floor(S/2);m=typeof m>"u"?S:m;let V=l.Settings.NON_LINEAR_JUMP_AT,F=l.Settings.NON_LINEAR_JUMP_SIZE,L=!0,B=function(Le,b){return Le.map((X,j)=>Number(b.get(j,0)))},Q=l.Utils.arrayGetVariables(a),ce=l.Matrix.jacobian(a,Q,Le=>G(Le,Q),!0),pe=l.Settings.MAX_NEWTON_ITERATIONS,Ce,ae,Re,et,_e,Ve,je,st,Ge=a.map(Le=>G(Le,Q)),nt=ce.map(Le=>G(Le,Q),!0);et=l.Matrix.cMatrix(0,Q);let ot=l.Matrix.cMatrix(v,Q);Re=0;do{if(Re>pe){L=!1;break}Ce=B(Q,ot),je=ot.clone();let Le=Ce,b=ot;Ge.forEach((j,x)=>{b.set(x,0,j(...Le))});let X=new l.Matrix;if(nt.each((j,x,z)=>{let U=j(...Le);X.set(x,z,U)}),X=X.invert(),ae=t.multiply(X,ot).negate(),st=ae.subtract(et,j=>t.parse(Number(j))),et=je.add(ae,j=>t.parse(Number(j))),ot=et,Re>=V&&_e>1){m===I&&(v=0);let j=m>I?1:-1,x=m%Math.floor(I)+1;return v+=j*x*F,J.solveNonLinearSystem(a,--m,v)}if(Ve=_e,Re++,_e=st.max(),Number(_e)===Number(Ve))break}while(Number(_e)>=Number.EPSILON);return L?J.systemSolutions(ot,Q,!0,Le=>l.Utils.round(Number(Le),14)):[]},systemSolutions(a,m,v,S){let I=l.Settings.SOLUTIONS_AS_OBJECT?{}:[];return a.each((V,F)=>{let L=(v?t.expand(V):V).valueOf();S&&(L=S.call(V,L));let B=m[F];l.Settings.SOLUTIONS_AS_OBJECT?I[B]=L:I.push([B,L])}),I},solveSystemBySubstitution(a){let m=at(a[0]),v=at(a[1]);return a.length===2&&m.length===2&&l.Utils.arrayEqual(m,v)?J.solveCircle(a,m):[]},solveSystem(a,m){for(let B=0;B<a.length;B++)a[B]=J.toLHS(a[B]);let v=a.length,S=new l.Matrix,I=new l.Matrix,V=!1,F;if(typeof m>"u"){if(!ee.allLinear(a))try{return J.solveNonLinearSystem(a)}catch(B){if(B.message==="timeout")throw B;if(B instanceof l.exceptions.DivisionByZero)return J.solveSystemBySubstitution(a)}if(F=l.Utils.arrayGetVariables(a),F.length===1){let B=0,Q,ce;do ce=a[B].clone(),B>0&&(ce=ce.sub(F[0],Q[0])),Q=d(ce,F[0]);while(++B<a.length);let pe;return $e.SOLUTIONS_AS_OBJECT?(pe={},pe[F[0]]=Q):Q.length===0?pe=Q:pe=[F[0],Q],pe}if(F.length<a.length){let B=[],Q=a.length;for(let ae=0;ae<Q-1;ae++)B.push(t.parse(a[ae]));let ce={},pe=J.solveSystem(B,F);Array.isArray(pe)?pe.forEach(ae=>{ce[ae[0]]=ae[1]}):ce=pe;let Ce=!0;for(let ae=Q-1;ae<Q;ae++)t.parse(a[ae],ce).equals(0)||(Ce=!1);if(Ce)return pe}for(let B=0;B<F.length;B++)H0.setVar(F[B],"delete");for(let B=0;B<v;B++){let Q=a[B];for(let pe=0;pe<F.length;pe++){let Ce=F[pe],ae=[];Q.each(et=>{et.contains(Ce)&&(ae=ae.concat(et.coeffs()))});let Re=l.Utils.arraySum(ae);S.set(B,pe,Re)}let ce=Q.clone();F.forEach(pe=>{ce=ce.stripVar(pe,!0)}),I.set(B,0,ce.negate())}}else{F=m,V=!0;for(let B=0;B<v;B++){I.set(B,0,new le(0));let Q=t.expand(a[B]).collectSummandSymbols();for(let ce=0;ce<m.length;ce++){S.set(B,ce,new le(0));let pe=m[ce];for(let Ce=0;Ce<Q.length;Ce++){let ae=Q[Ce],Re=!1;for(let et=0;et<m.length;et++)ae.contains(m[et])&&(Re&&l.err(`Multiple variables found for term ${ae}`),Re=!0);if(ae.contains(pe)){let et=xe(se(Q,Ce),pe);Ce--,S.set(B,ce,t.add(S.get(B,ce),et[0]))}}}for(let ce=0;ce<Q.length;ce++)I.set(B,0,t.add(I.get(B,0),Q[ce]))}}if(F.length!==a.length||S.determinant().equals(0))throw new l.exceptions.SolveError("System does not have a distinct solution");S=S.invert();let L=S.multiply(I);return l.Utils.isArray(m)&&L.each(B=>B.negate()),J.systemSolutions(L,F,V)},quad(a,m,v){let S=t.subtract(t.pow(m.clone(),le(2)),t.multiply(t.multiply(v.clone(),a.clone()),le(4)));S=t.expand(S);let I=t.pow(S,le(.5)),V=t.parse(t.multiply(new le(2),v.clone()));return[t.parse(ge("(-({0})+({1}))/({2})",m,I,V)),t.parse(ge("(-({0})-({1}))/({2})",m,I,V))]},cubic(a,m,v,S){let I=S.text(),V=v.text(),F=m.text(),L=a.text(),B=`(-(${V})^3/(27*(${I})^3)+(${V})*(${F})/(6*(${I})^2)-(${L})/(2*(${I})))`,Q=`((${F})/(3*(${I}))-(${V})^2/(9*(${I})^2))`,ce=`(${V})/(3*(${I}))`,pe=`((${B})+sqrt((${B})^2+(${Q})^3))^(1/3)+((${B})-sqrt((${B})^2+(${Q})^3))^(1/3)-(${ce})`,Ce="1/2+sqrt(3)/2*i";return[t.parse(pe),t.parse(`(${pe})(${Ce})`),t.parse(`(${pe})(${Ce})^2`)]},quartic(a,m,v,S,I){let V={};l.Utils.arrayUnique(at(I).concat(at(S)).concat(at(v)).concat(at(m)).concat(at(a))).forEach(Ve=>{V[Ve]=1}),I=I.toString(),S=S.toString(),v=v.toString(),m=m.toString(),a=a.toString();let F,L=t.parse(ge("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",I,S,v)).toString(),B=t.parse(ge("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",I,S,v,m)).toString(),Q=t.parse(ge("12*({0})*({4})-3*({1})*({3})+({2})^2",I,S,v,m,a)).toString(),ce=t.parse(ge("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",I,S,v,m,a)).toString(),pe=t.parse(ge("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",Q,ce)).toString(),Ce=t.parse(ge("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",I,L,pe,Q)).toString(),ae=t.parse(ge("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",I,S,L,B,Ce)),Re=t.parse(ge("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",I,S,L,B,Ce)),et=t.parse(ge("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",I,S,L,B,Ce)),_e=t.parse(ge("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",I,S,L,B,Ce));return[ae,Re,et,_e]},divideAndConquer(a,m){let v=[],S=l.Algebra.Factor.factorInner(a);return S.group===Se&&S.each(I=>{I=le.unwrapPARENS(I),v=v.concat(d(I,m))}),v},csolve(a,m){return l.Utils.block("IGNORE_E",()=>{let v,S,I,V,F,L,B,Q,ce=[],pe=l.Utils.decompose_fn(a,m,!0);if(pe.x.group===Ke){v=t.parse(pe.x.power),S=Number(v),I=t.pow(t.divide(pe.b.negate(),pe.a),v.invert()),V=le.toPolarFormArray(I),F=V[0],L=V[1],B=F.toString(),Q=v.toString();let Ce,ae,Re;for(let et=0;et<S;et++)Ce=et,Re=ge("({0})*e^(2*{1}*pi*{2}*{3})",B,Ce,v,l.Settings.IMAGINARY),ae=t.parse(Re),ce.push(ae)}return ce},!0)},getPoints(a,m,v){m||=.01;let S=[],I=G(a),F=Math.round(0),L=I(F),B=l.Settings.ROOTS_PER_SIDE,Q=B;S.push(Math.floor(F/2)),S.push(Math.abs(F)),S.push(F),a.each(ae=>{ae.containsFunction(l.Settings.LOG)&&S.push(.1)});let ce=He(-l.Settings.SOLVE_RADIUS,F,m),pe=He(F,l.Settings.SOLVE_RADIUS,m),Ce=function(ae,Re){let et,_e,Ve,je=[],st=ae[0],Ge=Math.sign(I(st));for(let nt=0,ot=ae.length;nt<ot&&je.length<Re;nt++)et=ae[nt],_e=I(et),Ve=Math.sign(_e),!isNaN(Ve)&&(Ve!==Ge&&(je.push(et),je.push(ae[nt-1])),Ge=Ve);S=S.concat(je)};if(Ce(ce,Q),Ce(pe,B),v){let ae=l.Settings.SOLVE_RADIUS;Ce([ae,ae*ae],1),Ce([-ae*ae,-ae],1)}return S},bisection(a,m){let v=a-1,S=a+1;if(Math.sign(m(v))!==Math.sign(m(S))){let I=0,V,F;do{if(V=Math.abs(S-v),I++>l.Settings.MAX_BISECTION_ITER||isNaN(V))return;F=(v+S)/2,m(v)*m(F)>0?v=F:S=F}while(V>=$e.EPSILON);let L=(v+S)/2,B=m(L);return!isNaN(B)&&Math.abs(B)<=l.Settings.BI_SECTION_EPSILON?l.Utils.round(L,13):void 0}},bSearch(a,m,v){let S=v(a),I=v(m);if(Math.sign(S)===Math.sign(I)||isNaN(S)||isNaN(I))return;let V=80,F=0;do{let L=(a+m)/2,B=Math.sign(S),Q=Math.sign(v(L));if(B===Q){if(L===a)break;a=L,S=v(a)}else{if(L===m)break;m=L,I=v(m)}F++}while(a!==m&&F<V);if(!(!isFinite(v(a))||!isFinite(v(m))))return a},Newton(a,m,v,S){let I=l.Settings.MAX_NEWTON_ITERATIONS,V=0,F=a,L,B,Q;do{let ce=m(F);if(F===0&&ce===0){L=0;break}if(V++,V>I)return;let pe=v(F);if(isNaN(pe)||isNaN(ce))return;if(pe===0)L+=Q;else{if(!isFinite(ce)||!isFinite(pe)||Math.abs(ce)>1e25)return J.bSearch(S,F,m);L=F-ce/pe}if(Q=L-F,Q===0&&!isFinite(pe))return;B=Math.abs(Q),F=L}while(B>$e.NEWTON_EPSILON);return L},rewrite(a,m,v){if(m||=new le(0),a.isComposite()&&a.isLinear()){let V=[],F=[];a.each(L=>{L=L.clone(),L.fname==="sqrt"&&L.contains(v)?V.push(L):F.push(L)},!0),V.length===1&&(m=t.expand(t.pow(t.subtract(m,l.Utils.arraySum(F)),new le(2))),a=t.expand(t.pow(le.unwrapSQRT(V[0]),new le(2))))}else a=le.unwrapSQRT(t.expand(a));let S=0,I=a.length;if(a.group===Ie&&a.contains(v)&&a.isLinear()){a.distributeMultiplier();let V=new le(0);return a.each(F=>{F.contains(v)?(S++,V=t.add(V,F.clone())):m=t.subtract(m,F.clone())}),a=V,S!==I?J.rewrite(a,m,v):[a,m]}if(a.group===Se&&a.contains(v)&&a.isLinear()){if(a.multiplier.lessThan(0)&&(a.multiplier=a.multiplier.multiply(new l.Frac(-1)),m.multiplier=m.multiplier.multiply(new l.Frac(-1))),m.equals(0))return new le(0);let V=new le(1);return a.each(F=>{F.contains(v)?V=t.multiply(V,F.clone()):m=t.divide(m,F.clone())}),a=V,J.rewrite(a,m,v)}if(!a.isLinear()&&a.contains(v)){let V=t.parse(a.power.clone().invert());return a=t.pow(a,V.clone()),m=t.pow(t.expand(m),V.clone()),J.rewrite(a,m,v)}return a.group===te||a.group===Ke||a.group===ue?[a,m]:[a,m]},sqrtSolve(a,m){let v=new le(0),S=new le(0);if(a.isComposite()&&(a.each(I=>{I.fname==="sqrt"&&I.contains(m)?v=t.add(v,I.clone()):S=t.add(S,I.clone())}),!v.equals(0))){let I=t.expand(t.multiply(t.parse(a.multiplier),t.subtract(t.pow(S,new le(2)),t.pow(v,new le(2))))),V=d(I,m);return V=V.filter(F=>{if(F.isImaginary())return!0;let L={};return L[m]=F,!!Ue(a,L).equals(0)}),V}}},c=function(a,m,v,S){let I=a.toString(),V=I.match(/(?<![a-z])abs/gu);if(!V||V.length>2||a.LHS.group!==te&&a.RHS.group!==te)return null;let F=a.constructor(I.replace(/(?<![a-z])abs/u,"")),L=a.constructor(I.replace(/(?<![a-z])abs/u,"(-1)")),B=d(F,m,null,v,S);return[d(L,m,null,v,S),B]};function d(a,m,v,S,I){if(S||=0,S++>$e.MAX_SOLVE_DEPTH)return v;v||=[];let V={},F={};F[m]=0;let L=function(_e,Ve){let je=mt(_e);if(!(_e===void 0||typeof _e=="number"&&isNaN(_e))){if(Be(_e))_e.forEach(st=>{L(st)});else if(_e.valueOf()!=="null"){if(typeof l.Settings.PRE_ADD_SOLUTION=="function"&&(_e=l.Settings.PRE_ADD_SOLUTION(_e)),je||(_e=t.parse(_e)),l.Settings.make_pi_conversions&&Ve){let Ge=t.divide(_e.clone(),new le(Math.PI)),nt=Ge.multiplier,ot=Math.abs(nt.num),Le=Math.abs(nt.den);ot<10&&Le<10&&(_e=t.multiply(Ge,new le("pi")))}let st=_e.toString();V[st]||v.push(_e),V[st]=!0}}};if(a instanceof qe){let _e=c(a,m,v,S,I);if(_e)return L(_e),v;if(a.isZero())return[new le(0)];if(a.LHS.equals(m)&&!a.RHS.contains(m,!0))return[a.RHS];if(a.RHS.equals(m)&&!a.LHS.contains(m,!0))return[a.LHS]}if(a instanceof l.Vector&&(a=a.elements),Be(a))return J.solveSystem(a,m);if(m||="x",mt(a)&&Ue(a.getDenom(),F).equals(0)===!0)return v;if(a.group===Ke&&a.contains(m)){try{let _e={};_e[m]=0,Ue(I,_e,"numer"),L(new le(0))}catch(_e){if(_e.message==="timeout")throw _e}return v}if(a.group===Se){let _e=a.getNum();if(_e.group===Se){let Ve=String(m);return _e.each(je=>{je.contains(Ve)&&d(je,m,v,S,a)}),v}return d(_e,m,v,S,I)}a.group===te&&a.fname==="sqrt"&&(a=t.pow(le.unwrapSQRT(a),new le(2)));let B=(l.Utils.isSymbol(a)?a:J.toLHS(a,!1)).getNum(),Q=l.Utils.variables(B),ce=Q.length;if(l.Utils.isInt(B.power)&&B.power>1&&(B=t.parse(B).toLinear()),(B.group===Ke||B.group===Se)&&B.contains(m))return[new le(0)];let pe={},Ce,ae=function(_e){_e=t.expand(_e,{expand_denominator:!0,expand_functions:!0});let Ve=_e.clone();if(_e.symbols)for(let je in _e.symbols){if(!Object.hasOwn(_e.symbols,je))continue;let st=_e.symbols[je],Ge=st.getDenom();if(!Ge.isConstant(!0)&&_e.isComposite()){let X=new le(0);return _e.each(j=>{X=t.add(X,t.multiply(j,Ge.clone()))}),ae(t.multiply(t.parse(_e.multiplier),X))}let nt=xe(st,m),ot=nt[1].fname===l.Settings.SQRT,Le=le.unwrapSQRT(nt[1]),b=Le.power.clone();if(!mt(b)&&!b.equals(1/2)){if(b.den.gt(1)){if(ot)return _e=t.subtract(_e,st.clone()),_e=t.add(_e,t.multiply(nt[0].clone(),Le)),ae(_e);let X=pe[b.den];pe[b.den]=X?X++:1}else if(b.sign()===-1){let X=t.parse(`${m}^${Math.abs(b)}`),j=_e;return j.each((x,z)=>{x.contains(m)&&(j.symbols[z]=t.multiply(x,X.clone()))}),pe={},ae(t.parse(j))}else if(st.group===ue){let X=l.Utils.arrayMin(l.Utils.keys(st.symbols));if(X<0){let j=t.parse(`${m}^${Math.abs(X)}`),x=new le(0);return Ve.each(z=>{x=t.add(x,t.multiply(z.clone(),j.clone()))},!0),x}}}}return _e},Re=function(_e){let Ve=new le(0),je=new le(0);return _e.each(st=>{st.contains(m,!0)?Ve=t.add(Ve,st.clone()):je=t.subtract(je,st.clone())}),[Ve,je]};if(J.inverseFunctionSolve=function(Ve,je,st){let Ge=xe(je.args[0],m);if(Ge[1].group===Ke)return t.divide(t.symfunction(Ve,[t.divide(st,t.parse(je.multiplier))]),Ge[0])},B=ae(B),B.equals(0))return[B];let et=l.Utils.keys(pe);if(et.length===1&&(Ce=et[0],B.each((_e,Ve)=>{if(_e.contains(m)){let je=xe(_e,m),st=je[1],Ge=st.power;Ge.den.gt(1)&&(st.power=Ge.multiply(new l.Frac(Ce)),B.symbols[Ve]=t.multiply(st,je[0]))}}),B=t.parse(B)),L(J.sqrtSolve(B,m)),ce===1)if(B.isPoly(!0)){let _e=new l.Algebra.Classes.Factors;if(l.Algebra.Factor.factorInner(B,_e),_e.getNumberSymbolics()>1)for(let Ve in _e.factors)Object.hasOwn(_e.factors,Ve)&&L(d(_e.factors[Ve],m));else{let Ve=l.Utils.getCoeffs(B,m),je=Ve.length-1,st=!1;if(Q[0]===m){if(De(Ve,Ge=>Ge.group!==l.groups.N)){let Ge=l.Algebra.proots(B);De(Ge,nt=>!l.Utils.isInt(nt))&&(st=!0,Ge.forEach(nt=>{L(new le(nt))}))}if(!st)if(a=t.parse(a),a instanceof l.Equation&&(a=a.toLHS()),je===1)L(t.divide(Ve[0],Ve[1].negate()));else if(je===2)L(t.expand(J.quad.apply(void 0,Ve)));else if(je===3){let Ge=[],nt=l.Algebra.Factor.factorInner(a);Ge=[],Ge.length>0?L(Ge):L(J.cubic.apply(void 0,Ve))}else ee.proots(B).map(L)}}}else{let _e=B.hasTrig(),Ve=J.getPoints(B,.1),je=J.getPoints(B,.05),st=J.getPoints(B,.01,!0),Ge=l.Utils.arrayUnique(Ve.concat(je).concat(st)).sort((U,q)=>U-q),nt,ot,Le,b=G(B.clone()),X=[];for(nt=0;nt<Ge.length;nt++){if(ot=Ge[nt],Le=J.bisection(ot,b),typeof Le>"u"){X.push(ot);continue}L(Le,_e)}Ge=X;let j=de.diff(B.clone()),x=G(j),z=Ge[0];for(nt=0;nt<Ge.length;nt++)ot=Ge[nt],L(J.Newton(ot,b,x,z),_e),z=ot;v.sort((U,q)=>{let fe=U.text("decimals"),i=q.text("decimals"),h=Number(fe),M=Number(i);return isNaN(h)&&isNaN(M)?fe.localeCompare(i):isNaN(h)&&!isNaN(M)?-1:!isNaN(h)&&isNaN(M)?1:h-M}),v=v.map(U=>U.isConstant()?new le(Number(Number(U).toPrecision(15))):U),v=v.filter((U,q,fe)=>{let i=Number(Number(U).toPrecision(15)),h=Number(fe[q-1]);return q===0||isNaN(i)||isNaN(h)?!0:Math.abs(i-h)>=$e.EPSILON})}else if(!B.hasFunc(m)&&B.isComposite())try{let _e=l.Algebra.Factor.factorInner(B.clone()),Ve=t.expand(t.parse(_e)),je=t.expand(B.clone()),st=t.subtract(Ve,je),Ge=!0;if(st.equals(0)||(Ge=!1),Ge&&_e.group===Se)_e.each(nt=>{L(d(nt,m))});else{let nt=l.Utils.getCoeffs(B,m);switch(nt.length-1){case 0:{let b=Re(B),X=b[0],j=b[1];if(X.group===l.groups.EX){let x=l.Settings.LOG,z=`${x}((${j})/(${X.multiplier}))/(${x}(${X.value})*${X.power.multiplier})`,U=t.parse(z);L(U)}break}case 1:L(t.divide(nt[0],nt[1].negate()));break;case 2:L(J.quad.apply(void 0,nt));break;case 3:L(J.cubic.apply(void 0,nt));break;case 4:L(J.quartic.apply(void 0,nt));break;default:L(J.csolve(B,m)),v.length===0&&L(J.divideAndConquer(B,m))}v.length===0&&L(d(_e,m,v,S))}}catch(_e){if(_e.message==="timeout")throw _e}else try{let _e=J.rewrite(B,null,m),Ve=_e[0],je=_e[1];if(Ve.group===te)if(Ve.fname==="abs")Ve.args[0].toString()===m&&L([je.clone(),je.negate()]);else if(Ve.fname==="sin")L(J.inverseFunctionSolve("asin",Ve,je));else if(Ve.fname==="cos")L(J.inverseFunctionSolve("acos",Ve,je));else if(Ve.fname==="tan")L(J.inverseFunctionSolve("atan",Ve,je));else if(Ve.fname===l.Settings.LOG){let st=xe(Ve.args[0],m),Ge=st[1];if(Ge.group===Ke){je=t.divide(t.subtract(t.pow(Ve.args.length>1?Ve.args[1]:new le("e"),t.divide(je,t.parse(Ve.multiplier))),st[3]),st[0]);let nt=new qe(Ge,je).toLHS();L(d(nt,m))}}else L(t.subtract(Ve,je));else{let st=new qe(Ve,je).toLHS();if(st.equals(B))throw new Error("Stopping. No stop condition exists");L(d(st,m))}}catch(_e){if(_e.message==="timeout")throw _e;if(B.group===Se)L(0);else if(B.group===Ie){let Ve=Re(B),je=Ve[0],st=Ve[1];if(je.group===l.groups.EX&&je.value===m){let Ge=je.power.clone().invert();L(t.pow(st,Ge))}}}if(Ce&&(v=v.map(_e=>t.pow(_e,new le(Ce)))),mt(a)){let _e={};v=v.filter(Ve=>{try{_e[m]=Ve;let je=Number(Ue(a,_e));return isNaN(je),!0}catch(je){if(je.message==="timeout")throw je;return!1}})}return v}H0.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return d}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return l.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return Xe}}]),H0.updateAPI()})()});var cn=u0((Gi,s1)=>{"use strict";var X0;typeof s1<"u"&&(X0=T0(),V0(),G0());(function(){let l=X0.getCore(),t=l.PARSER,{NerdamerSymbol:ee}=l,{format:de}=l.Utils,{isVector:xe}=l.Utils,{isArray:Ue}=l.Utils,se=l.Vector,{S:ge}=l.groups,G=l.groups.EX,{CP:u}=l.groups,{PL:le}=l.groups,{CB:mt}=l.groups,{FN:at}=l.groups;l.Settings.Laplace_integration_depth=40,ee.prototype.findFunction=function(Se){if(this.group===at&&this.fname===Se)return this.clone();let Ie;if(this.symbols){for(let te in this.symbols)if(Object.hasOwn(this.symbols,te)&&(Ie=this.symbols[te].findFunction(Se),Ie))break}return Ie};let Ke=l.Extra={version:"1.4.2",LaPlace:{transform(ue,Se,Ie){ue=ue.clone(),Se=Se.toString(),ue=ee.unwrapSQRT(ue,!0);let te,$e=ue.stripVar(Se),He=ue.group;if(ue=t.divide(ue,$e.clone()),ue.isConstant()||!ue.contains(Se,!0))te=t.parse(de("({0})/({1})",ue,Ie));else if(He===ge&&l.Utils.isInt(ue.power)){let Be=String(ue.power);te=t.parse(de("factorial({0})/({1})^({0}+1)",Be,Ie))}else if(ue.group===ge&&ue.power.equals(1/2))te=t.parse(de("sqrt(pi)/(2*({0})^(3/2))",Ie));else if(ue.isComposite())te=new ee(0),ue.each(Be=>{te=t.add(te,Ke.LaPlace.transform(Be,Se,Ie))},!0);else if(ue.isE()&&(ue.power.group===ge||ue.power.group===mt)){let Be=ue.power.stripVar(Se);te=t.parse(de("1/(({1})-({0}))",Be,Ie))}else{let Be=["sin","cos","sinh","cosh"];if(ue.group===at&&Be.indexOf(ue.fname)!==-1&&(ue.args[0].group===ge||ue.args[0].group===mt)){let qe=ue.args[0].stripVar(Se);switch(ue.fname){case"sin":te=t.parse(de("({0})/(({1})^2+({0})^2)",qe,Ie));break;case"cos":te=t.parse(de("({1})/(({1})^2+({0})^2)",qe,Ie));break;case"sinh":te=t.parse(de("({0})/(({1})^2-({0})^2)",qe,Ie));break;case"cosh":te=t.parse(de("({1})/(({1})^2-({0})^2)",qe,Ie));break}}else{let qe=l.Settings.integration_depth<l.Settings.Laplace_integration_depth,Xe;qe&&(Xe=l.Settings.integration_depth,l.Settings.integration_depth=l.Settings.Laplace_integration_depth),l.Utils.block("PARSE2NUMBER",()=>{let De=Se,J=ue.sub(Se,De),c=t.parse(`e^(-${Ie}*${De})*${J}`);if(te=l.Calculus.integrate(c,De),te.hasIntegral()){te=t.symfunction("laplace",[ue,Se,Ie]);return}te=te.sub(Se,0),te=t.expand(t.multiply(te,new ee(-1))),te=te.sub(De,Se)},!1),te=l.Utils.block("PARSE2NUMBER",()=>t.parse(te),!0),qe&&(l.Settings.integration_depth=Xe)}}return t.multiply(te,$e)},inverse(ue,Se,Ie){let te=ue.clone();return l.Utils.block("POSITIVE_MULTIPLIERS",()=>{let $e;if(ue.group===mt&&(ue=l.Algebra.PartFrac.partfrac(t.expand(ue),Se)),ue.group===ge||ue.group===mt||ue.isComposite()){let He,Be,qe,Xe,De,J,c,d,a=ue.multiplier.clone();ue.toUnitMultiplier();let m=ue.getNum(),v=ue.getDenom().toUnitMultiplier();v.group===u||v.group===le?(Be=v.power.clone(),v.toLinear()):Be=new l.Frac(1);let S=Se.toString(),I=l.Utils.decompose_fn(v,S,!0),V=l.Utils.decompose_fn(t.expand(m.clone()),S,!0);m.multiplier=m.multiplier.multiply(a);let F=function(){$e=t.multiply($e,m),$e.multiplier=$e.multiplier.multiply(ue.multiplier),$e=t.divide($e,I.a)};if((v.group===ge||v.group===mt)&&I.x.value===S&&I.b.equals(0)&&l.Utils.isInt(I.x.power))He=I.x.power-1,d=l.Math2.factorial(He),$e=t.divide(t.pow(Ie,new ee(He)),new ee(d)),F();else if(v.group===u&&Be.equals(1)){if(I.x.group===l.groups.PL&&l.Algebra.degree(v).equals(2)){let L=l.Algebra.sqComplete(v,S),B=l.Utils.getU(v);qe=l.Utils.decompose_fn(L.a,S,!0).b;let Q=Ke.LaPlace.inverse(t.parse(`1/((${B})^2+(${L.c}))`),B,Ie);$e=t.multiply(Q,t.parse(`(${a})*e^(-(${qe})*(${Ie}))`))}else if(I.x.isLinear()&&!m.contains(S))Ie=t.divide(Ie,I.a.clone()),He=Be-1,d=He===0||He===1?"1":`(${Be}-1)!`,$e=t.parse(de("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",Ie,I.a,I.b,Be,d)),F();else if(I.x.group===ge&&I.x.power.equals(2))if(m.contains(S)){if(qe=new ee(1),m.group===mt){let ae=new ee(1);m.each(Re=>{Re.contains(S)?ae=t.multiply(ae,Re):qe=t.multiply(qe,Re)}),m=ae}c=l.Utils.decompose_fn(m,S,!0);let L=c.a,B=c.b,Q=L.containsFunction("sin"),ce=L.containsFunction("cos"),pe=B.containsFunction("cos"),Ce=B.containsFunction("sin");if(c.x.value===S&&c.x.isLinear()&&!(Q&&pe||ce||Ce))$e=t.parse(de("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",Ie,c.a,I.a,I.b));else if(Q&&pe){let ae=L.findFunction("sin"),Re=B.findFunction("cos");if(ae.args[0].equals(Re.args[0])&&!ae.args[0].contains(S)){Xe=t.divide(B,Re.toUnitMultiplier()).toString();let et=ae.args[0].toString();De=I.b;let _e=t.divide(L,ae.toUnitMultiplier());J="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",$e=t.parse(de(J,Ie,qe,Xe,et,De,_e))}}}else $e=t.parse(de("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",Ie,m,I.a,I.b))}else if(I.x.power.num&&I.x.power.num.equals(3)&&I.x.power.den.equals(2)&&m.contains("sqrt(pi)")&&!m.contains(S)&&m.isLinear())Xe=t.divide(m.clone(),t.parse("sqrt(pi)")),$e=t.parse(de("(2*({2})*sqrt({0}))/({1})",Ie,I.a,Xe,m));else if(Be.equals(2)&&I.x.power.equals(2))if(m.contains(S))if(c=l.Utils.decompose_fn(t.expand(m.clone()),S,!0),c.x.isComposite()){let L=[],B=m.collectSymbols(Q=>{Q=ee.unwrapPARENS(Q);let ce=l.Utils.decompose_fn(Q,S,!0);return ce.symbol=Q,ce}).sort((Q,ce)=>{let pe=Q.x.value===S?Q.x.power:0;return(ce.x.value===S?ce.x.power:0)-pe});qe=new ee(-1);for(let Q=0;Q<B.length;Q++){let ce=B[Q];ce.x.value===S?L.push(ce):qe=t.multiply(qe,ce.symbol)}L[0].x.power.equals(2)&&L[1].x.power.equals(1)&&L[1].b.equals(0)&&!L[0].b.equals(0)&&(Xe=L[0].a.negate(),J="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",$e=t.parse(de(J,Ie,qe,Xe,L[0].b,I.a,I.b)))}else c.x.isLinear()?(qe=t.divide(c.a,new ee(2)),J="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",$e=t.parse(de(J,Ie,qe,I.a,I.b))):c.x.power.equals(2)&&(c.b.equals(0)?(qe=t.divide(c.a,new ee(2)),J="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",$e=t.parse(de(J,Ie,qe,I.a,I.b))):(qe=t.divide(c.a,new ee(2)),De=c.b.negate(),J="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",$e=t.parse(de(J,Ie,qe,I.a,I.b,De))));else qe=t.divide(m,new ee(2)),J="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",$e=t.parse(de(J,Ie,qe,I.a,I.b));else ue.isComposite()&&(Be.equals(2)&&I.x.group===ge?$e=t.parse(`(${a})*(${Ie})*e^(-(${I.b})*(${Ie}))`):($e=new ee(0),ue=l.Algebra.PartFrac.partfrac(t.expand(ue),Se),ue.each(L=>{$e=t.add($e,Ke.LaPlace.inverse(L,Se,Ie))},!0)))}return $e||=t.symfunction("ilt",[te,Se,Ie]),$e},!0)}},Statistics:{frequencyMap(ue){let Se={};for(let Ie=0,te=ue.length;Ie<te;Ie++){let He=ue[Ie].toString();Se[He]||=0,Se[He]++}return Se},sort(ue){return ue.sort((Se,Ie)=>((!Se.isConstant()||!Ie.isConstant())&&t.error("Unable to sort! All values must be numeric"),Se.multiplier.subtract(Ie.multiplier)))},count(ue){return new ee(ue.length)},sum(ue,Se){let Ie=new ee(0);for(let te=0,$e=ue.length;te<$e;te++){let He=ue[te].clone();Se?Ie=t.add(t.pow(t.subtract(He,Se.clone()),new ee(2)),Ie):Ie=t.add(He,Ie)}return Ie},mean(...ue){return xe(ue[0])?Ke.Statistics.mean(...ue[0].elements):t.divide(Ke.Statistics.sum(ue),Ke.Statistics.count(ue))},median(...ue){let Se;if(xe(ue[0]))return Ke.Statistics.median(...ue[0].elements);try{let Ie=Ke.Statistics.sort(ue),te=ue.length;if(l.Utils.even(te)){let $e=te/2;Se=Ke.Statistics.mean(Ie[$e-1],Ie[$e])}else Se=Ie[Math.floor(te/2)]}catch(Ie){if(Ie.message==="timeout")throw Ie;Se=t.symfunction("median",ue)}return Se},mode(...ue){let Se;if(xe(ue[0]))return Ke.Statistics.mode(...ue[0].elements);let Ie=Ke.Statistics.frequencyMap(ue);if(l.Utils.keys(Ie).length===1)Se=ue[0];else{let te={};for(let He in Ie){if(!Object.hasOwn(Ie,He))continue;let Be=Ie[He];if(Be in te){let qe=te[Be];Ue(qe)?qe.push(He):te[Be]=[He,te[Be]]}else te[Be]=He}let $e=te[Math.max.apply(null,l.Utils.keys(te))];Ue($e)?Se=t.symfunction("mode",$e.sort()):Se=t.parse($e)}return Se},gVariance(ue,Se){let Ie=Ke.Statistics.mean(...Se),te=Ke.Statistics.sum(Se,Ie);return t.multiply(ue,te)},variance(...ue){if(xe(ue[0]))return Ke.Statistics.variance(...ue[0].elements);let Se=t.divide(new ee(1),Ke.Statistics.count(ue));return Ke.Statistics.gVariance(Se,ue)},sampleVariance(...ue){if(xe(ue[0]))return Ke.Statistics.sampleVariance(...ue[0].elements);let Se=t.divide(new ee(1),t.subtract(Ke.Statistics.count(ue),new ee(1)));return Ke.Statistics.gVariance(Se,ue)},standardDeviation(...ue){return xe(ue[0])?Ke.Statistics.standardDeviation(...ue[0].elements):t.pow(Ke.Statistics.variance(...ue),new ee(1/2))},sampleStandardDeviation(...ue){return xe(ue[0])?Ke.Statistics.sampleStandardDeviation(...ue[0].elements):t.pow(Ke.Statistics.sampleVariance(...ue),new ee(1/2))},zScore(ue,Se,Ie){return t.divide(t.subtract(ue,Se),Ie)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};X0.register([{name:"laplace",visible:!0,numargs:3,build(){return Ke.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Ke.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Ke.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Ke.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Ke.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Ke.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Ke.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Ke.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Ke.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Ke.Statistics.zScore}}]),X0.updateAPI()})();typeof s1<"u"&&(s1.exports=X0)});var $i=u0((Hi,fn)=>{var xi=T0();G0();V0();un();cn();fn.exports=xi});return $i();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
