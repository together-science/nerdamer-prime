"use strict";var nerdamer=(()=>{var y0=(f,n)=>()=>(n||f((n={exports:{}}).exports,n),n.exports);var P1=y0((Gi,s1)=>{var Zt=(function(f){"use strict";var n=1e7,e=7,_=9007199254740992,X=Ie(_),K="0123456789abcdefghijklmnopqrstuvwxyz",ne=typeof BigInt=="function";function Z(t,i,h,m){return typeof t>"u"?Z[0]:typeof i<"u"?+i==10&&!h?q(t):Le(t,i,h,m):q(t)}function J(t,i){this.value=t,this.sign=i,this.isSmall=!1}J.prototype=Object.create(Z.prototype);function a(t){this.value=t,this.sign=t<0,this.isSmall=!0}a.prototype=Object.create(Z.prototype);function ae(t){this.value=t}ae.prototype=Object.create(Z.prototype);function H(t){return-_<t&&t<_}function Ie(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function Ue(t){De(t);var i=t.length;if(i<4&&b(t,X)<0)switch(i){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*n;default:return t[0]+(t[1]+t[2]*n)*n}return t}function De(t){for(var i=t.length;t[--i]===0;);t.length=i+1}function se(t){for(var i=new Array(t),h=-1;++h<t;)i[h]=0;return i}function he(t){return t>0?Math.floor(t):Math.ceil(t)}function fe(t,i){var h=t.length,m=i.length,y=new Array(h),I=0,x=n,C,O;for(O=0;O<m;O++)C=t[O]+i[O]+I,I=C>=x?1:0,y[O]=C-I*x;for(;O<h;)C=t[O]+I,I=C===x?1:0,y[O++]=C-I*x;return I>0&&y.push(I),y}function j(t,i){return t.length>=i.length?fe(t,i):fe(i,t)}function xe(t,i){var h=t.length,m=new Array(h),y=n,I,x;for(x=0;x<h;x++)I=t[x]-y+i,i=Math.floor(I/y),m[x]=I-i*y,i+=1;for(;i>0;)m[x++]=i%y,i=Math.floor(i/y);return m}J.prototype.add=function(t){var i=q(t);if(this.sign!==i.sign)return this.subtract(i.negate());var h=this.value,m=i.value;return i.isSmall?new J(xe(h,Math.abs(m)),this.sign):new J(j(h,m),this.sign)},J.prototype.plus=J.prototype.add,a.prototype.add=function(t){var i=q(t),h=this.value;if(h<0!==i.sign)return this.subtract(i.negate());var m=i.value;if(i.isSmall){if(H(h+m))return new a(h+m);m=Ie(Math.abs(m))}return new J(xe(m,Math.abs(h)),h<0)},a.prototype.plus=a.prototype.add,ae.prototype.add=function(t){return new ae(this.value+q(t).value)},ae.prototype.plus=ae.prototype.add;function Ge(t,i){var h=t.length,m=i.length,y=new Array(h),I=0,x=n,C,O;for(C=0;C<m;C++)O=t[C]-I-i[C],O<0?(O+=x,I=1):I=0,y[C]=O;for(C=m;C<h;C++){if(O=t[C]-I,O<0)O+=x;else{y[C++]=O;break}y[C]=O}for(;C<h;C++)y[C]=t[C];return De(y),y}function ke(t,i,h){var m;return b(t,i)>=0?m=Ge(t,i):(m=Ge(i,t),h=!h),m=Ue(m),typeof m=="number"?(h&&(m=-m),new a(m)):new J(m,h)}function ye(t,i,h){var m=t.length,y=new Array(m),I=-i,x=n,C,O;for(C=0;C<m;C++)O=t[C]+I,I=Math.floor(O/x),O%=x,y[C]=O<0?O+x:O;return y=Ue(y),typeof y=="number"?(h&&(y=-y),new a(y)):new J(y,h)}J.prototype.subtract=function(t){var i=q(t);if(this.sign!==i.sign)return this.add(i.negate());var h=this.value,m=i.value;return i.isSmall?ye(h,Math.abs(m),this.sign):ke(h,m,this.sign)},J.prototype.minus=J.prototype.subtract,a.prototype.subtract=function(t){var i=q(t),h=this.value;if(h<0!==i.sign)return this.add(i.negate());var m=i.value;return i.isSmall?new a(h-m):ye(m,Math.abs(h),h>=0)},a.prototype.minus=a.prototype.subtract,ae.prototype.subtract=function(t){return new ae(this.value-q(t).value)},ae.prototype.minus=ae.prototype.subtract,J.prototype.negate=function(){return new J(this.value,!this.sign)},a.prototype.negate=function(){var t=this.sign,i=new a(-this.value);return i.sign=!t,i},ae.prototype.negate=function(){return new ae(-this.value)},J.prototype.abs=function(){return new J(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))},ae.prototype.abs=function(){return new ae(this.value>=0?this.value:-this.value)};function Re(t,i){var h=t.length,m=i.length,y=h+m,I=se(y),x=n,C,O,D,le,ge;for(D=0;D<h;++D){le=t[D];for(var de=0;de<m;++de)ge=i[de],C=le*ge+I[D+de],O=Math.floor(C/x),I[D+de]=C-O*x,I[D+de+1]+=O}return De(I),I}function Se(t,i){var h=t.length,m=new Array(h),y=n,I=0,x,C;for(C=0;C<h;C++)x=t[C]*i+I,I=Math.floor(x/y),m[C]=x-I*y;for(;I>0;)m[C++]=I%y,I=Math.floor(I/y);return m}function W(t,i){for(var h=[];i-- >0;)h.push(0);return h.concat(t)}function u(t,i){var h=Math.max(t.length,i.length);if(h<=30)return Re(t,i);h=Math.ceil(h/2);var m=t.slice(h),y=t.slice(0,h),I=i.slice(h),x=i.slice(0,h),C=u(y,x),O=u(m,I),D=u(j(y,m),j(x,I)),le=j(j(C,W(Ge(Ge(D,C),O),h)),W(O,2*h));return De(le),le}function g(t,i){return-.012*t-.012*i+15e-6*t*i>0}J.prototype.multiply=function(t){var i=q(t),h=this.value,m=i.value,y=this.sign!==i.sign,I;if(i.isSmall){if(m===0)return Z[0];if(m===1)return this;if(m===-1)return this.negate();if(I=Math.abs(m),I<n)return new J(Se(h,I),y);m=Ie(I)}return g(h.length,m.length)?new J(u(h,m),y):new J(Re(h,m),y)},J.prototype.times=J.prototype.multiply;function r(t,i,h){return t<n?new J(Se(i,t),h):new J(Re(i,Ie(t)),h)}a.prototype._multiplyBySmall=function(t){return H(t.value*this.value)?new a(t.value*this.value):r(Math.abs(t.value),Ie(Math.abs(this.value)),this.sign!==t.sign)},J.prototype._multiplyBySmall=function(t){return t.value===0?Z[0]:t.value===1?this:t.value===-1?this.negate():r(Math.abs(t.value),this.value,this.sign!==t.sign)},a.prototype.multiply=function(t){return q(t)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply,ae.prototype.multiply=function(t){return new ae(this.value*q(t).value)},ae.prototype.times=ae.prototype.multiply;function d(t){var i=t.length,h=se(i+i),m=n,y,I,x,C,O;for(x=0;x<i;x++){C=t[x],I=0-C*C;for(var D=x;D<i;D++)O=t[D],y=2*(C*O)+h[x+D]+I,I=Math.floor(y/m),h[x+D]=y-I*m;h[x+i]=I}return De(h),h}J.prototype.square=function(){return new J(d(this.value),!1)},a.prototype.square=function(){var t=this.value*this.value;return H(t)?new a(t):new J(d(Ie(Math.abs(this.value))),!1)},ae.prototype.square=function(t){return new ae(this.value*this.value)};function S(t,i){var h=t.length,m=i.length,y=n,I=se(i.length),x=i[m-1],C=Math.ceil(y/(2*x)),O=Se(t,C),D=Se(i,C),le,ge,de,be,Ce,Fe,He;for(O.length<=h&&O.push(0),D.push(0),x=D[m-1],ge=h-m;ge>=0;ge--){for(le=y-1,O[ge+m]!==x&&(le=Math.floor((O[ge+m]*y+O[ge+m-1])/x)),de=0,be=0,Fe=D.length,Ce=0;Ce<Fe;Ce++)de+=le*D[Ce],He=Math.floor(de/y),be+=O[ge+Ce]-(de-He*y),de=He,be<0?(O[ge+Ce]=be+y,be=-1):(O[ge+Ce]=be,be=0);for(;be!==0;){for(le-=1,de=0,Ce=0;Ce<Fe;Ce++)de+=O[ge+Ce]-y+D[Ce],de<0?(O[ge+Ce]=de+y,de=0):(O[ge+Ce]=de,de=1);be+=de}I[ge]=le}return O=M(O,C)[0],[Ue(I),Ue(O)]}function v(t,i){for(var h=t.length,m=i.length,y=[],I=[],x=n,C,O,D,le,ge;h;){if(I.unshift(t[--h]),De(I),b(I,i)<0){y.push(0);continue}O=I.length,D=I[O-1]*x+I[O-2],le=i[m-1]*x+i[m-2],O>m&&(D=(D+1)*x),C=Math.ceil(D/le);do{if(ge=Se(i,C),b(ge,I)<=0)break;C--}while(C);y.push(C),I=Ge(I,ge)}return y.reverse(),[Ue(y),Ue(I)]}function M(t,i){var h=t.length,m=se(h),y=n,I,x,C,O;for(C=0,I=h-1;I>=0;--I)O=C*y+t[I],x=he(O/i),C=O-x*i,m[I]=x|0;return[m,C|0]}function P(t,i){var h,m=q(i);if(ne)return[new ae(t.value/m.value),new ae(t.value%m.value)];var y=t.value,I=m.value,x;if(I===0)throw new Error("Cannot divide by zero");if(t.isSmall)return m.isSmall?[new a(he(y/I)),new a(y%I)]:[Z[0],t];if(m.isSmall){if(I===1)return[t,Z[0]];if(I==-1)return[t.negate(),Z[0]];var C=Math.abs(I);if(C<n){h=M(y,C),x=Ue(h[0]);var O=h[1];return t.sign&&(O=-O),typeof x=="number"?(t.sign!==m.sign&&(x=-x),[new a(x),new a(O)]):[new J(x,t.sign!==m.sign),new a(O)]}I=Ie(C)}var D=b(y,I);if(D===-1)return[Z[0],t];if(D===0)return[Z[t.sign===m.sign?1:-1],Z[0]];y.length+I.length<=200?h=S(y,I):h=v(y,I),x=h[0];var le=t.sign!==m.sign,ge=h[1],de=t.sign;return typeof x=="number"?(le&&(x=-x),x=new a(x)):x=new J(x,le),typeof ge=="number"?(de&&(ge=-ge),ge=new a(ge)):ge=new J(ge,de),[x,ge]}J.prototype.divmod=function(t){var i=P(this,t);return{quotient:i[0],remainder:i[1]}},ae.prototype.divmod=a.prototype.divmod=J.prototype.divmod,J.prototype.divide=function(t){return P(this,t)[0]},ae.prototype.over=ae.prototype.divide=function(t){return new ae(this.value/q(t).value)},a.prototype.over=a.prototype.divide=J.prototype.over=J.prototype.divide,J.prototype.mod=function(t){return P(this,t)[1]},ae.prototype.mod=ae.prototype.remainder=function(t){return new ae(this.value%q(t).value)},a.prototype.remainder=a.prototype.mod=J.prototype.remainder=J.prototype.mod,J.prototype.pow=function(t){var i=q(t),h=this.value,m=i.value,y,I,x;if(m===0)return Z[1];if(h===0)return Z[0];if(h===1)return Z[1];if(h===-1)return i.isEven()?Z[1]:Z[-1];if(i.sign)return Z[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&H(y=Math.pow(h,m)))return new a(he(y));for(I=this,x=Z[1];m&!0&&(x=x.times(I),--m),m!==0;)m/=2,I=I.square();return x},a.prototype.pow=J.prototype.pow,ae.prototype.pow=function(t){var i=q(t),h=this.value,m=i.value,y=BigInt(0),I=BigInt(1),x=BigInt(2);if(m===y)return Z[1];if(h===y)return Z[0];if(h===I)return Z[1];if(h===BigInt(-1))return i.isEven()?Z[1]:Z[-1];if(i.isNegative())return new ae(y);for(var C=this,O=Z[1];(m&I)===I&&(O=O.times(C),--m),m!==y;)m/=x,C=C.square();return O},J.prototype.modPow=function(t,i){if(t=q(t),i=q(i),i.isZero())throw new Error("Cannot take modPow with modulus 0");var h=Z[1],m=this.mod(i);for(t.isNegative()&&(t=t.multiply(Z[-1]),m=m.modInv(i));t.isPositive();){if(m.isZero())return Z[0];t.isOdd()&&(h=h.multiply(m).mod(i)),t=t.divide(2),m=m.square().mod(i)}return h},ae.prototype.modPow=a.prototype.modPow=J.prototype.modPow;function b(t,i){if(t.length!==i.length)return t.length>i.length?1:-1;for(var h=t.length-1;h>=0;h--)if(t[h]!==i[h])return t[h]>i[h]?1:-1;return 0}J.prototype.compareAbs=function(t){var i=q(t),h=this.value,m=i.value;return i.isSmall?1:b(h,m)},a.prototype.compareAbs=function(t){var i=q(t),h=Math.abs(this.value),m=i.value;return i.isSmall?(m=Math.abs(m),h===m?0:h>m?1:-1):-1},ae.prototype.compareAbs=function(t){var i=this.value,h=q(t).value;return i=i>=0?i:-i,h=h>=0?h:-h,i===h?0:i>h?1:-1},J.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var i=q(t),h=this.value,m=i.value;return this.sign!==i.sign?i.sign?1:-1:i.isSmall?this.sign?-1:1:b(h,m)*(this.sign?-1:1)},J.prototype.compareTo=J.prototype.compare,a.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var i=q(t),h=this.value,m=i.value;return i.isSmall?h==m?0:h>m?1:-1:h<0!==i.sign?h<0?-1:1:h<0?1:-1},a.prototype.compareTo=a.prototype.compare,ae.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var i=this.value,h=q(t).value;return i===h?0:i>h?1:-1},ae.prototype.compareTo=ae.prototype.compare,J.prototype.equals=function(t){return this.compare(t)===0},ae.prototype.eq=ae.prototype.equals=a.prototype.eq=a.prototype.equals=J.prototype.eq=J.prototype.equals,J.prototype.notEquals=function(t){return this.compare(t)!==0},ae.prototype.neq=ae.prototype.notEquals=a.prototype.neq=a.prototype.notEquals=J.prototype.neq=J.prototype.notEquals,J.prototype.greater=function(t){return this.compare(t)>0},ae.prototype.gt=ae.prototype.greater=a.prototype.gt=a.prototype.greater=J.prototype.gt=J.prototype.greater,J.prototype.lesser=function(t){return this.compare(t)<0},ae.prototype.lt=ae.prototype.lesser=a.prototype.lt=a.prototype.lesser=J.prototype.lt=J.prototype.lesser,J.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},ae.prototype.geq=ae.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals=J.prototype.geq=J.prototype.greaterOrEquals,J.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},ae.prototype.leq=ae.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals=J.prototype.leq=J.prototype.lesserOrEquals,J.prototype.isEven=function(){return(this.value[0]&1)===0},a.prototype.isEven=function(){return(this.value&1)===0},ae.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},J.prototype.isOdd=function(){return(this.value[0]&1)===1},a.prototype.isOdd=function(){return(this.value&1)===1},ae.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},J.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},ae.prototype.isPositive=a.prototype.isPositive,J.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},ae.prototype.isNegative=a.prototype.isNegative,J.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return Math.abs(this.value)===1},ae.prototype.isUnit=function(){return this.abs().value===BigInt(1)},J.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return this.value===0},ae.prototype.isZero=function(){return this.value===BigInt(0)},J.prototype.isDivisibleBy=function(t){var i=q(t);return i.isZero()?!1:i.isUnit()?!0:i.compareAbs(2)===0?this.isEven():this.mod(i).isZero()},ae.prototype.isDivisibleBy=a.prototype.isDivisibleBy=J.prototype.isDivisibleBy;function R(t){var i=t.abs();if(i.isUnit())return!1;if(i.equals(2)||i.equals(3)||i.equals(5))return!0;if(i.isEven()||i.isDivisibleBy(3)||i.isDivisibleBy(5))return!1;if(i.lesser(49))return!0}function B(t,i){for(var h=t.prev(),m=h,y=0,I,x,C,O;m.isEven();)m=m.divide(2),y++;e:for(C=0;C<i.length;C++)if(!t.lesser(i[C])&&(O=Zt(i[C]).modPow(m,t),!(O.isUnit()||O.equals(h)))){for(I=y-1;I!=0;I--){if(O=O.square().mod(t),O.isUnit())return!1;if(O.equals(h))continue e}return!1}return!0}J.prototype.isPrime=function(t){var i=R(this);if(i!==f)return i;var h=this.abs(),m=h.bitLength();if(m<=64)return B(h,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var y=Math.log(2)*m.toJSNumber(),I=Math.ceil(t===!0?2*Math.pow(y,2):y),x=[],C=0;C<I;C++)x.push(Zt(C+2));return B(h,x)},ae.prototype.isPrime=a.prototype.isPrime=J.prototype.isPrime,J.prototype.isProbablePrime=function(t,i){var h=R(this);if(h!==f)return h;for(var m=this.abs(),y=t===f?5:t,I=[],x=0;x<y;x++)I.push(Zt.randBetween(2,m.minus(2),i));return B(m,I)},ae.prototype.isProbablePrime=a.prototype.isProbablePrime=J.prototype.isProbablePrime,J.prototype.modInv=function(t){for(var i=Zt.zero,h=Zt.one,m=q(t),y=this.abs(),I,x,C;!y.isZero();)I=m.divide(y),x=i,C=m,i=h,m=y,h=x.subtract(I.multiply(h)),y=C.subtract(I.multiply(y));if(!m.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return i.compare(0)===-1&&(i=i.add(t)),this.isNegative()?i.negate():i},ae.prototype.modInv=a.prototype.modInv=J.prototype.modInv,J.prototype.next=function(){var t=this.value;return this.sign?ye(t,1,this.sign):new J(xe(t,1),this.sign)},a.prototype.next=function(){var t=this.value;return t+1<_?new a(t+1):new J(X,!1)},ae.prototype.next=function(){return new ae(this.value+BigInt(1))},J.prototype.prev=function(){var t=this.value;return this.sign?new J(xe(t,1),!0):ye(t,1,this.sign)},a.prototype.prev=function(){var t=this.value;return t-1>-_?new a(t-1):new J(X,!0)},ae.prototype.prev=function(){return new ae(this.value-BigInt(1))};for(var Q=[1];2*Q[Q.length-1]<=n;)Q.push(2*Q[Q.length-1]);var te=Q.length,ue=Q[te-1];function qe(t){return Math.abs(t)<=n}J.prototype.shiftLeft=function(t){var i=q(t).toJSNumber();if(!qe(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftRight(-i);var h=this;if(h.isZero())return h;for(;i>=te;)h=h.multiply(ue),i-=te-1;return h.multiply(Q[i])},ae.prototype.shiftLeft=a.prototype.shiftLeft=J.prototype.shiftLeft,J.prototype.shiftRight=function(t){var i,h=q(t).toJSNumber();if(!qe(h))throw new Error(String(h)+" is too large for shifting.");if(h<0)return this.shiftLeft(-h);for(var m=this;h>=te;){if(m.isZero()||m.isNegative()&&m.isUnit())return m;i=P(m,ue),m=i[1].isNegative()?i[0].prev():i[0],h-=te-1}return i=P(m,Q[h]),i[1].isNegative()?i[0].prev():i[0]},ae.prototype.shiftRight=a.prototype.shiftRight=J.prototype.shiftRight;function me(t,i,h){i=q(i);for(var m=t.isNegative(),y=i.isNegative(),I=m?t.not():t,x=y?i.not():i,C=0,O=0,D=null,le=null,ge=[];!I.isZero()||!x.isZero();)D=P(I,ue),C=D[1].toJSNumber(),m&&(C=ue-1-C),le=P(x,ue),O=le[1].toJSNumber(),y&&(O=ue-1-O),I=D[0],x=le[0],ge.push(h(C,O));for(var de=h(m?1:0,y?1:0)!==0?Zt(-1):Zt(0),be=ge.length-1;be>=0;be-=1)de=de.multiply(ue).add(Zt(ge[be]));return de}J.prototype.not=function(){return this.negate().prev()},ae.prototype.not=a.prototype.not=J.prototype.not,J.prototype.and=function(t){return me(this,t,function(i,h){return i&h})},ae.prototype.and=a.prototype.and=J.prototype.and,J.prototype.or=function(t){return me(this,t,function(i,h){return i|h})},ae.prototype.or=a.prototype.or=J.prototype.or,J.prototype.xor=function(t){return me(this,t,function(i,h){return i^h})},ae.prototype.xor=a.prototype.xor=J.prototype.xor;var Be=1<<30,Je=(n&-n)*(n&-n)|Be;function Ae(t){var i=t.value,h=typeof i=="number"?i|Be:typeof i=="bigint"?i|BigInt(Be):i[0]+i[1]*n|Je;return h&-h}function Ve(t,i){if(i.compareTo(t)<=0){var h=Ve(t,i.square(i)),m=h.p,y=h.e,I=m.multiply(i);return I.compareTo(t)<=0?{p:I,e:y*2+1}:{p:m,e:y*2}}return{p:Zt(1),e:0}}J.prototype.bitLength=function(){var t=this;return t.compareTo(Zt(0))<0&&(t=t.negate().subtract(Zt(1))),t.compareTo(Zt(0))===0?Zt(0):Zt(Ve(t,Zt(2)).e).add(Zt(1))},ae.prototype.bitLength=a.prototype.bitLength=J.prototype.bitLength;function Ze(t,i){return t=q(t),i=q(i),t.greater(i)?t:i}function it(t,i){return t=q(t),i=q(i),t.lesser(i)?t:i}function Xe(t,i){if(t=q(t).abs(),i=q(i).abs(),t.equals(i))return t;if(t.isZero())return i;if(i.isZero())return t;for(var h=Z[1],m,y;t.isEven()&&i.isEven();)m=it(Ae(t),Ae(i)),t=t.divide(m),i=i.divide(m),h=h.multiply(m);for(;t.isEven();)t=t.divide(Ae(t));do{for(;i.isEven();)i=i.divide(Ae(i));t.greater(i)&&(y=i,i=t,t=y),i=i.subtract(t)}while(!i.isZero());return h.isUnit()?t:t.multiply(h)}function Ye(t,i){return t=q(t).abs(),i=q(i).abs(),t.divide(Xe(t,i)).multiply(i)}function rt(t,i,h){t=q(t),i=q(i);var m=h||Math.random,y=it(t,i),I=Ze(t,i),x=I.subtract(y).add(1);if(x.isSmall)return y.add(Math.floor(m()*x));for(var C=G(x,n).value,O=[],D=!0,le=0;le<C.length;le++){var ge=D?C[le]+(le+1<C.length?C[le+1]/n:0):n,de=he(m()*ge);O.push(de),de<C[le]&&(D=!1)}return y.add(Z.fromArray(O,n,!1))}var Le=function(t,i,h,m){h=h||K,t=String(t),m||(t=t.toLowerCase(),h=h.toLowerCase());var y=t.length,I,x=Math.abs(i),C={};for(I=0;I<h.length;I++)C[h[I]]=I;for(I=0;I<y;I++){var O=t[I];if(O!=="-"&&O in C&&C[O]>=x){if(O==="1"&&x===1)continue;throw new Error(O+" is not a valid digit in base "+i+".")}}i=q(i);var D=[],le=t[0]==="-";for(I=le?1:0;I<t.length;I++){var O=t[I];if(O in C)D.push(q(C[O]));else if(O==="<"){var ge=I;do I++;while(t[I]!==">"&&I<t.length);D.push(q(t.slice(ge+1,I)))}else throw new Error(O+" is not a valid character")}return F(D,i,le)};function F(t,i,h){var m=Z[0],y=Z[1],I;for(I=t.length-1;I>=0;I--)m=m.add(t[I].times(y)),y=y.times(i);return h?m.negate():m}function $(t,i){return i=i||K,t<i.length?i[t]:"<"+t+">"}function G(t,i){if(i=Zt(i),i.isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(i.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var h=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return h.unshift([1]),{value:[].concat.apply([],h),isNegative:!1}}var m=!1;if(t.isNegative()&&i.isPositive()&&(m=!0,t=t.abs()),i.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:m};for(var y=[],I=t,x;I.isNegative()||I.compareAbs(i)>=0;){x=I.divmod(i),I=x.quotient;var C=x.remainder;C.isNegative()&&(C=i.minus(C).abs(),I=I.next()),y.push(C.toJSNumber())}return y.push(I.toJSNumber()),{value:y.reverse(),isNegative:m}}function p(t,i,h){var m=G(t,i);return(m.isNegative?"-":"")+m.value.map(function(y){return $(y,h)}).join("")}J.prototype.toArray=function(t){return G(this,t)},a.prototype.toArray=function(t){return G(this,t)},ae.prototype.toArray=function(t){return G(this,t)},J.prototype.toString=function(t,i){if(t===f&&(t=10),t!==10||i)return p(this,t,i);for(var h=this.value,m=h.length,y=String(h[--m]),I="0000000",x;--m>=0;)x=String(h[m]),y+=I.slice(x.length)+x;var C=this.sign?"-":"";return C+y},a.prototype.toString=function(t,i){return t===f&&(t=10),t!=10||i?p(this,t,i):String(this.value)},ae.prototype.toString=a.prototype.toString,ae.prototype.toJSON=J.prototype.toJSON=a.prototype.toJSON=function(){return this.toString()},J.prototype.valueOf=function(){return parseInt(this.toString(),10)},J.prototype.toJSNumber=J.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf,ae.prototype.valueOf=ae.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function z(t){if(H(+t)){var i=+t;if(i===he(i))return ne?new ae(BigInt(i)):new a(i);throw new Error("Invalid integer: "+t)}var h=t[0]==="-";h&&(t=t.slice(1));var m=t.split(/e/i);if(m.length>2)throw new Error("Invalid integer: "+m.join("e"));if(m.length===2){var y=m[1];if(y[0]==="+"&&(y=y.slice(1)),y=+y,y!==he(y)||!H(y))throw new Error("Invalid integer: "+y+" is not a valid exponent.");var I=m[0],x=I.indexOf(".");if(x>=0&&(y-=I.length-x-1,I=I.slice(0,x)+I.slice(x+1)),y<0)throw new Error("Cannot include negative exponent part for integers");I+=new Array(y+1).join("0"),t=I}var C=/^([0-9][0-9]*)$/.test(t);if(!C)throw new Error("Invalid integer: "+t);if(ne)return new ae(BigInt(h?"-"+t:t));for(var O=[],D=t.length,le=e,ge=D-le;D>0;)O.push(+t.slice(ge,D)),ge-=le,ge<0&&(ge=0),D-=le;return De(O),new J(O,h)}function V(t){if(ne)return new ae(BigInt(t));if(H(t)){if(t!==he(t))throw new Error(t+" is not an integer.");return new a(t)}return z(t.toString())}function q(t){return typeof t=="number"?V(t):typeof t=="string"?z(t):typeof t=="bigint"?new ae(t):t}for(var l=0;l<1e3;l++)Z[l]=q(l),l>0&&(Z[-l]=q(-l));return Z.one=Z[1],Z.zero=Z[0],Z.minusOne=Z[-1],Z.max=Ze,Z.min=it,Z.gcd=Xe,Z.lcm=Ye,Z.isInstance=function(t){return t instanceof J||t instanceof a||t instanceof ae},Z.randBetween=rt,Z.fromArray=function(t,i,h){return F(t.map(q),q(i||10),h)},Z})();typeof s1<"u"&&s1.hasOwnProperty("exports")&&(s1.exports=Zt);typeof define=="function"&&define.amd&&define(function(){return Zt})});var b1=y0((D1,o1)=>{(function(f){"use strict";var n=9e15,e=1e9,_="0123456789abcdef",X="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",K="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ne={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-n,maxE:n,crypto:!1},Z,J,a,ae,H=!0,Ie="[DecimalError] ",Ue=Ie+"Invalid argument: ",De=Ie+"Precision limit exceeded",se=Ie+"crypto unavailable",he="[object Decimal]",fe=Math.floor,j=Math.pow,xe=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ge=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,ke=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,ye=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Re=1e7,Se=7,W=9007199254740991,u=X.length-1,g=K.length-1,r={toStringTag:he};r.absoluteValue=r.abs=function(){var w=new this.constructor(this);return w.s<0&&(w.s=1),R(w)},r.ceil=function(){return R(new this.constructor(this),this.e+1,2)},r.clampedTo=r.clamp=function(w,N){var E,A=this,L=A.constructor;if(w=new L(w),N=new L(N),!w.s||!N.s)return new L(NaN);if(w.gt(N))throw Error(Ue+N);return E=A.cmp(w),E<0?w:A.cmp(N)>0?N:new L(A)},r.comparedTo=r.cmp=function(w){var N,E,A,L,T=this,Y=T.d,oe=(w=new T.constructor(w)).d,pe=T.s,re=w.s;if(!Y||!oe)return!pe||!re?NaN:pe!==re?pe:Y===oe?0:!Y^pe<0?1:-1;if(!Y[0]||!oe[0])return Y[0]?pe:oe[0]?-re:0;if(pe!==re)return pe;if(T.e!==w.e)return T.e>w.e^pe<0?1:-1;for(A=Y.length,L=oe.length,N=0,E=A<L?A:L;N<E;++N)if(Y[N]!==oe[N])return Y[N]>oe[N]^pe<0?1:-1;return A===L?0:A>L^pe<0?1:-1},r.cosine=r.cos=function(){var w,N,E=this,A=E.constructor;return E.d?E.d[0]?(w=A.precision,N=A.rounding,A.precision=w+Math.max(E.e,E.sd())+Se,A.rounding=1,E=P(A,$(A,E)),A.precision=w,A.rounding=N,R(ae==2||ae==3?E.neg():E,w,N,!0)):new A(1):new A(NaN)},r.cubeRoot=r.cbrt=function(){var w,N,E,A,L,T,Y,oe,pe,re,Ee=this,Oe=Ee.constructor;if(!Ee.isFinite()||Ee.isZero())return new Oe(Ee);for(H=!1,T=Ee.s*j(Ee.s*Ee,1/3),!T||Math.abs(T)==1/0?(E=d(Ee.d),w=Ee.e,(T=(w-E.length+1)%3)&&(E+=T==1||T==-2?"0":"00"),T=j(E,1/3),w=fe((w+1)/3)-(w%3==(w<0?-1:2)),T==1/0?E="5e"+w:(E=T.toExponential(),E=E.slice(0,E.indexOf("e")+1)+w),A=new Oe(E),A.s=Ee.s):A=new Oe(T.toString()),Y=(w=Oe.precision)+3;;)if(oe=A,pe=oe.times(oe).times(oe),re=pe.plus(Ee),A=b(re.plus(Ee).times(oe),re.plus(pe),Y+2,1),d(oe.d).slice(0,Y)===(E=d(A.d)).slice(0,Y))if(E=E.slice(Y-3,Y+1),E=="9999"||!L&&E=="4999"){if(!L&&(R(oe,w+1,0),oe.times(oe).times(oe).eq(Ee))){A=oe;break}Y+=4,L=1}else{(!+E||!+E.slice(1)&&E.charAt(0)=="5")&&(R(A,w+1,1),N=!A.times(A).times(A).eq(Ee));break}return H=!0,R(A,w,Oe.rounding,N)},r.decimalPlaces=r.dp=function(){var w,N=this.d,E=NaN;if(N){if(w=N.length-1,E=(w-fe(this.e/Se))*Se,w=N[w],w)for(;w%10==0;w/=10)E--;E<0&&(E=0)}return E},r.dividedBy=r.div=function(w){return b(this,new this.constructor(w))},r.dividedToIntegerBy=r.divToInt=function(w){var N=this,E=N.constructor;return R(b(N,new E(w),0,1,1),E.precision,E.rounding)},r.equals=r.eq=function(w){return this.cmp(w)===0},r.floor=function(){return R(new this.constructor(this),this.e+1,3)},r.greaterThan=r.gt=function(w){return this.cmp(w)>0},r.greaterThanOrEqualTo=r.gte=function(w){var N=this.cmp(w);return N==1||N===0},r.hyperbolicCosine=r.cosh=function(){var w,N,E,A,L,T=this,Y=T.constructor,oe=new Y(1);if(!T.isFinite())return new Y(T.s?1/0:NaN);if(T.isZero())return oe;E=Y.precision,A=Y.rounding,Y.precision=E+Math.max(T.e,T.sd())+4,Y.rounding=1,L=T.d.length,L<32?(w=Math.ceil(L/3),N=(1/F(4,w)).toString()):(w=16,N="2.3283064365386962890625e-10"),T=Le(Y,1,T.times(N),new Y(1),!0);for(var pe,re=w,Ee=new Y(8);re--;)pe=T.times(T),T=oe.minus(pe.times(Ee.minus(pe.times(Ee))));return R(T,Y.precision=E,Y.rounding=A,!0)},r.hyperbolicSine=r.sinh=function(){var w,N,E,A,L=this,T=L.constructor;if(!L.isFinite()||L.isZero())return new T(L);if(N=T.precision,E=T.rounding,T.precision=N+Math.max(L.e,L.sd())+4,T.rounding=1,A=L.d.length,A<3)L=Le(T,2,L,L,!0);else{w=1.4*Math.sqrt(A),w=w>16?16:w|0,L=L.times(1/F(5,w)),L=Le(T,2,L,L,!0);for(var Y,oe=new T(5),pe=new T(16),re=new T(20);w--;)Y=L.times(L),L=L.times(oe.plus(Y.times(pe.times(Y).plus(re))))}return T.precision=N,T.rounding=E,R(L,N,E,!0)},r.hyperbolicTangent=r.tanh=function(){var w,N,E=this,A=E.constructor;return E.isFinite()?E.isZero()?new A(E):(w=A.precision,N=A.rounding,A.precision=w+7,A.rounding=1,b(E.sinh(),E.cosh(),A.precision=w,A.rounding=N)):new A(E.s)},r.inverseCosine=r.acos=function(){var w=this,N=w.constructor,E=w.abs().cmp(1),A=N.precision,L=N.rounding;return E!==-1?E===0?w.isNeg()?ue(N,A,L):new N(0):new N(NaN):w.isZero()?ue(N,A+4,L).times(.5):(N.precision=A+6,N.rounding=1,w=new N(1).minus(w).div(w.plus(1)).sqrt().atan(),N.precision=A,N.rounding=L,w.times(2))},r.inverseHyperbolicCosine=r.acosh=function(){var w,N,E=this,A=E.constructor;return E.lte(1)?new A(E.eq(1)?0:NaN):E.isFinite()?(w=A.precision,N=A.rounding,A.precision=w+Math.max(Math.abs(E.e),E.sd())+4,A.rounding=1,H=!1,E=E.times(E).minus(1).sqrt().plus(E),H=!0,A.precision=w,A.rounding=N,E.ln()):new A(E)},r.inverseHyperbolicSine=r.asinh=function(){var w,N,E=this,A=E.constructor;return!E.isFinite()||E.isZero()?new A(E):(w=A.precision,N=A.rounding,A.precision=w+2*Math.max(Math.abs(E.e),E.sd())+6,A.rounding=1,H=!1,E=E.times(E).plus(1).sqrt().plus(E),H=!0,A.precision=w,A.rounding=N,E.ln())},r.inverseHyperbolicTangent=r.atanh=function(){var w,N,E,A,L=this,T=L.constructor;return L.isFinite()?L.e>=0?new T(L.abs().eq(1)?L.s/0:L.isZero()?L:NaN):(w=T.precision,N=T.rounding,A=L.sd(),Math.max(A,w)<2*-L.e-1?R(new T(L),w,N,!0):(T.precision=E=A-L.e,L=b(L.plus(1),new T(1).minus(L),E+w,1),T.precision=w+4,T.rounding=1,L=L.ln(),T.precision=w,T.rounding=N,L.times(.5))):new T(NaN)},r.inverseSine=r.asin=function(){var w,N,E,A,L=this,T=L.constructor;return L.isZero()?new T(L):(N=L.abs().cmp(1),E=T.precision,A=T.rounding,N!==-1?N===0?(w=ue(T,E+4,A).times(.5),w.s=L.s,w):new T(NaN):(T.precision=E+6,T.rounding=1,L=L.div(new T(1).minus(L.times(L)).sqrt().plus(1)).atan(),T.precision=E,T.rounding=A,L.times(2)))},r.inverseTangent=r.atan=function(){var w,N,E,A,L,T,Y,oe,pe,re=this,Ee=re.constructor,Oe=Ee.precision,Pe=Ee.rounding;if(re.isFinite()){if(re.isZero())return new Ee(re);if(re.abs().eq(1)&&Oe+4<=g)return Y=ue(Ee,Oe+4,Pe).times(.25),Y.s=re.s,Y}else{if(!re.s)return new Ee(NaN);if(Oe+4<=g)return Y=ue(Ee,Oe+4,Pe).times(.5),Y.s=re.s,Y}for(Ee.precision=oe=Oe+10,Ee.rounding=1,E=Math.min(28,oe/Se+2|0),w=E;w;--w)re=re.div(re.times(re).plus(1).sqrt().plus(1));for(H=!1,N=Math.ceil(oe/Se),A=1,pe=re.times(re),Y=new Ee(re),L=re;w!==-1;)if(L=L.times(pe),T=Y.minus(L.div(A+=2)),L=L.times(pe),Y=T.plus(L.div(A+=2)),Y.d[N]!==void 0)for(w=N;Y.d[w]===T.d[w]&&w--;);return E&&(Y=Y.times(2<<E-1)),H=!0,R(Y,Ee.precision=Oe,Ee.rounding=Pe,!0)},r.isFinite=function(){return!!this.d},r.isInteger=r.isInt=function(){return!!this.d&&fe(this.e/Se)>this.d.length-2},r.isNaN=function(){return!this.s},r.isNegative=r.isNeg=function(){return this.s<0},r.isPositive=r.isPos=function(){return this.s>0},r.isZero=function(){return!!this.d&&this.d[0]===0},r.lessThan=r.lt=function(w){return this.cmp(w)<0},r.lessThanOrEqualTo=r.lte=function(w){return this.cmp(w)<1},r.logarithm=r.log=function(w){var N,E,A,L,T,Y,oe,pe,re=this,Ee=re.constructor,Oe=Ee.precision,Pe=Ee.rounding,nt=5;if(w==null)w=new Ee(10),N=!0;else{if(w=new Ee(w),E=w.d,w.s<0||!E||!E[0]||w.eq(1))return new Ee(NaN);N=w.eq(10)}if(E=re.d,re.s<0||!E||!E[0]||re.eq(1))return new Ee(E&&!E[0]?-1/0:re.s!=1?NaN:E?0:1/0);if(N)if(E.length>1)T=!0;else{for(L=E[0];L%10===0;)L/=10;T=L!==1}if(H=!1,oe=Oe+nt,Y=Ze(re,oe),A=N?te(Ee,oe+10):Ze(w,oe),pe=b(Y,A,oe,1),v(pe.d,L=Oe,Pe))do if(oe+=10,Y=Ze(re,oe),A=N?te(Ee,oe+10):Ze(w,oe),pe=b(Y,A,oe,1),!T){+d(pe.d).slice(L+1,L+15)+1==1e14&&(pe=R(pe,Oe+1,0));break}while(v(pe.d,L+=10,Pe));return H=!0,R(pe,Oe,Pe)},r.minus=r.sub=function(w){var N,E,A,L,T,Y,oe,pe,re,Ee,Oe,Pe,nt=this,Nt=nt.constructor;if(w=new Nt(w),!nt.d||!w.d)return!nt.s||!w.s?w=new Nt(NaN):nt.d?w.s=-w.s:w=new Nt(w.d||nt.s!==w.s?nt:NaN),w;if(nt.s!=w.s)return w.s=-w.s,nt.plus(w);if(re=nt.d,Pe=w.d,oe=Nt.precision,pe=Nt.rounding,!re[0]||!Pe[0]){if(Pe[0])w.s=-w.s;else if(re[0])w=new Nt(nt);else return new Nt(pe===3?-0:0);return H?R(w,oe,pe):w}if(E=fe(w.e/Se),Ee=fe(nt.e/Se),re=re.slice(),T=Ee-E,T){for(Oe=T<0,Oe?(N=re,T=-T,Y=Pe.length):(N=Pe,E=Ee,Y=re.length),A=Math.max(Math.ceil(oe/Se),Y)+2,T>A&&(T=A,N.length=1),N.reverse(),A=T;A--;)N.push(0);N.reverse()}else{for(A=re.length,Y=Pe.length,Oe=A<Y,Oe&&(Y=A),A=0;A<Y;A++)if(re[A]!=Pe[A]){Oe=re[A]<Pe[A];break}T=0}for(Oe&&(N=re,re=Pe,Pe=N,w.s=-w.s),Y=re.length,A=Pe.length-Y;A>0;--A)re[Y++]=0;for(A=Pe.length;A>T;){if(re[--A]<Pe[A]){for(L=A;L&&re[--L]===0;)re[L]=Re-1;--re[L],re[A]+=Re}re[A]-=Pe[A]}for(;re[--Y]===0;)re.pop();for(;re[0]===0;re.shift())--E;return re[0]?(w.d=re,w.e=Q(re,E),H?R(w,oe,pe):w):new Nt(pe===3?-0:0)},r.modulo=r.mod=function(w){var N,E=this,A=E.constructor;return w=new A(w),!E.d||!w.s||w.d&&!w.d[0]?new A(NaN):!w.d||E.d&&!E.d[0]?R(new A(E),A.precision,A.rounding):(H=!1,A.modulo==9?(N=b(E,w.abs(),0,3,1),N.s*=w.s):N=b(E,w,0,A.modulo,1),N=N.times(w),H=!0,E.minus(N))},r.naturalExponential=r.exp=function(){return Ve(this)},r.naturalLogarithm=r.ln=function(){return Ze(this)},r.negated=r.neg=function(){var w=new this.constructor(this);return w.s=-w.s,R(w)},r.plus=r.add=function(w){var N,E,A,L,T,Y,oe,pe,re,Ee,Oe=this,Pe=Oe.constructor;if(w=new Pe(w),!Oe.d||!w.d)return!Oe.s||!w.s?w=new Pe(NaN):Oe.d||(w=new Pe(w.d||Oe.s===w.s?Oe:NaN)),w;if(Oe.s!=w.s)return w.s=-w.s,Oe.minus(w);if(re=Oe.d,Ee=w.d,oe=Pe.precision,pe=Pe.rounding,!re[0]||!Ee[0])return Ee[0]||(w=new Pe(Oe)),H?R(w,oe,pe):w;if(T=fe(Oe.e/Se),A=fe(w.e/Se),re=re.slice(),L=T-A,L){for(L<0?(E=re,L=-L,Y=Ee.length):(E=Ee,A=T,Y=re.length),T=Math.ceil(oe/Se),Y=T>Y?T+1:Y+1,L>Y&&(L=Y,E.length=1),E.reverse();L--;)E.push(0);E.reverse()}for(Y=re.length,L=Ee.length,Y-L<0&&(L=Y,E=Ee,Ee=re,re=E),N=0;L;)N=(re[--L]=re[L]+Ee[L]+N)/Re|0,re[L]%=Re;for(N&&(re.unshift(N),++A),Y=re.length;re[--Y]==0;)re.pop();return w.d=re,w.e=Q(re,A),H?R(w,oe,pe):w},r.precision=r.sd=function(w){var N,E=this;if(w!==void 0&&w!==!!w&&w!==1&&w!==0)throw Error(Ue+w);return E.d?(N=qe(E.d),w&&E.e+1>N&&(N=E.e+1)):N=NaN,N},r.round=function(){var w=this,N=w.constructor;return R(new N(w),w.e+1,N.rounding)},r.sine=r.sin=function(){var w,N,E=this,A=E.constructor;return E.isFinite()?E.isZero()?new A(E):(w=A.precision,N=A.rounding,A.precision=w+Math.max(E.e,E.sd())+Se,A.rounding=1,E=rt(A,$(A,E)),A.precision=w,A.rounding=N,R(ae>2?E.neg():E,w,N,!0)):new A(NaN)},r.squareRoot=r.sqrt=function(){var w,N,E,A,L,T,Y=this,oe=Y.d,pe=Y.e,re=Y.s,Ee=Y.constructor;if(re!==1||!oe||!oe[0])return new Ee(!re||re<0&&(!oe||oe[0])?NaN:oe?Y:1/0);for(H=!1,re=Math.sqrt(+Y),re==0||re==1/0?(N=d(oe),(N.length+pe)%2==0&&(N+="0"),re=Math.sqrt(N),pe=fe((pe+1)/2)-(pe<0||pe%2),re==1/0?N="5e"+pe:(N=re.toExponential(),N=N.slice(0,N.indexOf("e")+1)+pe),A=new Ee(N)):A=new Ee(re.toString()),E=(pe=Ee.precision)+3;;)if(T=A,A=T.plus(b(Y,T,E+2,1)).times(.5),d(T.d).slice(0,E)===(N=d(A.d)).slice(0,E))if(N=N.slice(E-3,E+1),N=="9999"||!L&&N=="4999"){if(!L&&(R(T,pe+1,0),T.times(T).eq(Y))){A=T;break}E+=4,L=1}else{(!+N||!+N.slice(1)&&N.charAt(0)=="5")&&(R(A,pe+1,1),w=!A.times(A).eq(Y));break}return H=!0,R(A,pe,Ee.rounding,w)},r.tangent=r.tan=function(){var w,N,E=this,A=E.constructor;return E.isFinite()?E.isZero()?new A(E):(w=A.precision,N=A.rounding,A.precision=w+10,A.rounding=1,E=E.sin(),E.s=1,E=b(E,new A(1).minus(E.times(E)).sqrt(),w+10,0),A.precision=w,A.rounding=N,R(ae==2||ae==4?E.neg():E,w,N,!0)):new A(NaN)},r.times=r.mul=function(w){var N,E,A,L,T,Y,oe,pe,re,Ee=this,Oe=Ee.constructor,Pe=Ee.d,nt=(w=new Oe(w)).d;if(w.s*=Ee.s,!Pe||!Pe[0]||!nt||!nt[0])return new Oe(!w.s||Pe&&!Pe[0]&&!nt||nt&&!nt[0]&&!Pe?NaN:!Pe||!nt?w.s/0:w.s*0);for(E=fe(Ee.e/Se)+fe(w.e/Se),pe=Pe.length,re=nt.length,pe<re&&(T=Pe,Pe=nt,nt=T,Y=pe,pe=re,re=Y),T=[],Y=pe+re,A=Y;A--;)T.push(0);for(A=re;--A>=0;){for(N=0,L=pe+A;L>A;)oe=T[L]+nt[A]*Pe[L-A-1]+N,T[L--]=oe%Re|0,N=oe/Re|0;T[L]=(T[L]+N)%Re|0}for(;!T[--Y];)T.pop();return N?++E:T.shift(),w.d=T,w.e=Q(T,E),H?R(w,Oe.precision,Oe.rounding):w},r.toBinary=function(w,N){return G(this,2,w,N)},r.toDecimalPlaces=r.toDP=function(w,N){var E=this,A=E.constructor;return E=new A(E),w===void 0?E:(S(w,0,e),N===void 0?N=A.rounding:S(N,0,8),R(E,w+E.e+1,N))},r.toExponential=function(w,N){var E,A=this,L=A.constructor;return w===void 0?E=B(A,!0):(S(w,0,e),N===void 0?N=L.rounding:S(N,0,8),A=R(new L(A),w+1,N),E=B(A,!0,w+1)),A.isNeg()&&!A.isZero()?"-"+E:E},r.toFixed=function(w,N){var E,A,L=this,T=L.constructor;return w===void 0?E=B(L):(S(w,0,e),N===void 0?N=T.rounding:S(N,0,8),A=R(new T(L),w+L.e+1,N),E=B(A,!1,w+A.e+1)),L.isNeg()&&!L.isZero()?"-"+E:E},r.toFraction=function(w){var N,E,A,L,T,Y,oe,pe,re,Ee,Oe,Pe,nt=this,Nt=nt.d,ot=nt.constructor;if(!Nt)return new ot(nt);if(re=E=new ot(1),A=pe=new ot(0),N=new ot(A),T=N.e=qe(Nt)-nt.e-1,Y=T%Se,N.d[0]=j(10,Y<0?Se+Y:Y),w==null)w=T>0?N:re;else{if(oe=new ot(w),!oe.isInt()||oe.lt(re))throw Error(Ue+oe);w=oe.gt(N)?T>0?N:re:oe}for(H=!1,oe=new ot(d(Nt)),Ee=ot.precision,ot.precision=T=Nt.length*Se*2;Oe=b(oe,N,0,1,1),L=E.plus(Oe.times(A)),L.cmp(w)!=1;)E=A,A=L,L=re,re=pe.plus(Oe.times(L)),pe=L,L=N,N=oe.minus(Oe.times(L)),oe=L;return L=b(w.minus(E),A,0,1,1),pe=pe.plus(L.times(re)),E=E.plus(L.times(A)),pe.s=re.s=nt.s,Pe=b(re,A,T,1).minus(nt).abs().cmp(b(pe,E,T,1).minus(nt).abs())<1?[re,A]:[pe,E],ot.precision=Ee,H=!0,Pe},r.toHexadecimal=r.toHex=function(w,N){return G(this,16,w,N)},r.toNearest=function(w,N){var E=this,A=E.constructor;if(E=new A(E),w==null){if(!E.d)return E;w=new A(1),N=A.rounding}else{if(w=new A(w),N===void 0?N=A.rounding:S(N,0,8),!E.d)return w.s?E:w;if(!w.d)return w.s&&(w.s=E.s),w}return w.d[0]?(H=!1,E=b(E,w,0,N,1).times(w),H=!0,R(E)):(w.s=E.s,E=w),E},r.toNumber=function(){return+this},r.toOctal=function(w,N){return G(this,8,w,N)},r.toPower=r.pow=function(w){var N,E,A,L,T,Y,oe=this,pe=oe.constructor,re=+(w=new pe(w));if(!oe.d||!w.d||!oe.d[0]||!w.d[0])return new pe(j(+oe,re));if(oe=new pe(oe),oe.eq(1))return oe;if(A=pe.precision,T=pe.rounding,w.eq(1))return R(oe,A,T);if(N=fe(w.e/Se),N>=w.d.length-1&&(E=re<0?-re:re)<=W)return L=Be(pe,oe,E,A),w.s<0?new pe(1).div(L):R(L,A,T);if(Y=oe.s,Y<0){if(N<w.d.length-1)return new pe(NaN);if((w.d[N]&1)==0&&(Y=1),oe.e==0&&oe.d[0]==1&&oe.d.length==1)return oe.s=Y,oe}return E=j(+oe,re),N=E==0||!isFinite(E)?fe(re*(Math.log("0."+d(oe.d))/Math.LN10+oe.e+1)):new pe(E+"").e,N>pe.maxE+1||N<pe.minE-1?new pe(N>0?Y/0:0):(H=!1,pe.rounding=oe.s=1,E=Math.min(12,(N+"").length),L=Ve(w.times(Ze(oe,A+E)),A),L.d&&(L=R(L,A+5,1),v(L.d,A,T)&&(N=A+10,L=R(Ve(w.times(Ze(oe,N+E)),N),N+5,1),+d(L.d).slice(A+1,A+15)+1==1e14&&(L=R(L,A+1,0)))),L.s=Y,H=!0,pe.rounding=T,R(L,A,T))},r.toPrecision=function(w,N){var E,A=this,L=A.constructor;return w===void 0?E=B(A,A.e<=L.toExpNeg||A.e>=L.toExpPos):(S(w,1,e),N===void 0?N=L.rounding:S(N,0,8),A=R(new L(A),w,N),E=B(A,w<=A.e||A.e<=L.toExpNeg,w)),A.isNeg()&&!A.isZero()?"-"+E:E},r.toSignificantDigits=r.toSD=function(w,N){var E=this,A=E.constructor;return w===void 0?(w=A.precision,N=A.rounding):(S(w,1,e),N===void 0?N=A.rounding:S(N,0,8)),R(new A(E),w,N)},r.toString=function(){var w=this,N=w.constructor,E=B(w,w.e<=N.toExpNeg||w.e>=N.toExpPos);return w.isNeg()&&!w.isZero()?"-"+E:E},r.truncated=r.trunc=function(){return R(new this.constructor(this),this.e+1,1)},r.valueOf=r.toJSON=function(){var w=this,N=w.constructor,E=B(w,w.e<=N.toExpNeg||w.e>=N.toExpPos);return w.isNeg()?"-"+E:E};function d(w){var N,E,A,L=w.length-1,T="",Y=w[0];if(L>0){for(T+=Y,N=1;N<L;N++)A=w[N]+"",E=Se-A.length,E&&(T+=me(E)),T+=A;Y=w[N],A=Y+"",E=Se-A.length,E&&(T+=me(E))}else if(Y===0)return"0";for(;Y%10===0;)Y/=10;return T+Y}function S(w,N,E){if(w!==~~w||w<N||w>E)throw Error(Ue+w)}function v(w,N,E,A){var L,T,Y,oe;for(T=w[0];T>=10;T/=10)--N;return--N<0?(N+=Se,L=0):(L=Math.ceil((N+1)/Se),N%=Se),T=j(10,Se-N),oe=w[L]%T|0,A==null?N<3?(N==0?oe=oe/100|0:N==1&&(oe=oe/10|0),Y=E<4&&oe==99999||E>3&&oe==49999||oe==5e4||oe==0):Y=(E<4&&oe+1==T||E>3&&oe+1==T/2)&&(w[L+1]/T/100|0)==j(10,N-2)-1||(oe==T/2||oe==0)&&(w[L+1]/T/100|0)==0:N<4?(N==0?oe=oe/1e3|0:N==1?oe=oe/100|0:N==2&&(oe=oe/10|0),Y=(A||E<4)&&oe==9999||!A&&E>3&&oe==4999):Y=((A||E<4)&&oe+1==T||!A&&E>3&&oe+1==T/2)&&(w[L+1]/T/1e3|0)==j(10,N-3)-1,Y}function M(w,N,E){for(var A,L=[0],T,Y=0,oe=w.length;Y<oe;){for(T=L.length;T--;)L[T]*=N;for(L[0]+=_.indexOf(w.charAt(Y++)),A=0;A<L.length;A++)L[A]>E-1&&(L[A+1]===void 0&&(L[A+1]=0),L[A+1]+=L[A]/E|0,L[A]%=E)}return L.reverse()}function P(w,N){var E,A,L;if(N.isZero())return N;A=N.d.length,A<32?(E=Math.ceil(A/3),L=(1/F(4,E)).toString()):(E=16,L="2.3283064365386962890625e-10"),w.precision+=E,N=Le(w,1,N.times(L),new w(1));for(var T=E;T--;){var Y=N.times(N);N=Y.times(Y).minus(Y).times(8).plus(1)}return w.precision-=E,N}var b=(function(){function w(A,L,T){var Y,oe=0,pe=A.length;for(A=A.slice();pe--;)Y=A[pe]*L+oe,A[pe]=Y%T|0,oe=Y/T|0;return oe&&A.unshift(oe),A}function N(A,L,T,Y){var oe,pe;if(T!=Y)pe=T>Y?1:-1;else for(oe=pe=0;oe<T;oe++)if(A[oe]!=L[oe]){pe=A[oe]>L[oe]?1:-1;break}return pe}function E(A,L,T,Y){for(var oe=0;T--;)A[T]-=oe,oe=A[T]<L[T]?1:0,A[T]=oe*Y+A[T]-L[T];for(;!A[0]&&A.length>1;)A.shift()}return function(A,L,T,Y,oe,pe){var re,Ee,Oe,Pe,nt,Nt,ot,n0,Dt,u0,Tt,Qt,U0,h0,V0,x0,C0,G0,c0,$0,k0=A.constructor,X0=A.s==L.s?1:-1,Jt=A.d,Lt=L.d;if(!Jt||!Jt[0]||!Lt||!Lt[0])return new k0(!A.s||!L.s||(Jt?Lt&&Jt[0]==Lt[0]:!Lt)?NaN:Jt&&Jt[0]==0||!Lt?X0*0:X0/0);for(pe?(nt=1,Ee=A.e-L.e):(pe=Re,nt=Se,Ee=fe(A.e/nt)-fe(L.e/nt)),c0=Lt.length,C0=Jt.length,Dt=new k0(X0),u0=Dt.d=[],Oe=0;Lt[Oe]==(Jt[Oe]||0);Oe++);if(Lt[Oe]>(Jt[Oe]||0)&&Ee--,T==null?(h0=T=k0.precision,Y=k0.rounding):oe?h0=T+(A.e-L.e)+1:h0=T,h0<0)u0.push(1),Nt=!0;else{if(h0=h0/nt+2|0,Oe=0,c0==1){for(Pe=0,Lt=Lt[0],h0++;(Oe<C0||Pe)&&h0--;Oe++)V0=Pe*pe+(Jt[Oe]||0),u0[Oe]=V0/Lt|0,Pe=V0%Lt|0;Nt=Pe||Oe<C0}else{for(Pe=pe/(Lt[0]+1)|0,Pe>1&&(Lt=w(Lt,Pe,pe),Jt=w(Jt,Pe,pe),c0=Lt.length,C0=Jt.length),x0=c0,Tt=Jt.slice(0,c0),Qt=Tt.length;Qt<c0;)Tt[Qt++]=0;$0=Lt.slice(),$0.unshift(0),G0=Lt[0],Lt[1]>=pe/2&&++G0;do Pe=0,re=N(Lt,Tt,c0,Qt),re<0?(U0=Tt[0],c0!=Qt&&(U0=U0*pe+(Tt[1]||0)),Pe=U0/G0|0,Pe>1?(Pe>=pe&&(Pe=pe-1),ot=w(Lt,Pe,pe),n0=ot.length,Qt=Tt.length,re=N(ot,Tt,n0,Qt),re==1&&(Pe--,E(ot,c0<n0?$0:Lt,n0,pe))):(Pe==0&&(re=Pe=1),ot=Lt.slice()),n0=ot.length,n0<Qt&&ot.unshift(0),E(Tt,ot,Qt,pe),re==-1&&(Qt=Tt.length,re=N(Lt,Tt,c0,Qt),re<1&&(Pe++,E(Tt,c0<Qt?$0:Lt,Qt,pe))),Qt=Tt.length):re===0&&(Pe++,Tt=[0]),u0[Oe++]=Pe,re&&Tt[0]?Tt[Qt++]=Jt[x0]||0:(Tt=[Jt[x0]],Qt=1);while((x0++<C0||Tt[0]!==void 0)&&h0--);Nt=Tt[0]!==void 0}u0[0]||u0.shift()}if(nt==1)Dt.e=Ee,J=Nt;else{for(Oe=1,Pe=u0[0];Pe>=10;Pe/=10)Oe++;Dt.e=Oe+Ee*nt-1,R(Dt,oe?T+Dt.e+1:T,Y,Nt)}return Dt}})();function R(w,N,E,A){var L,T,Y,oe,pe,re,Ee,Oe,Pe,nt=w.constructor;e:if(N!=null){if(Oe=w.d,!Oe)return w;for(L=1,oe=Oe[0];oe>=10;oe/=10)L++;if(T=N-L,T<0)T+=Se,Y=N,Ee=Oe[Pe=0],pe=Ee/j(10,L-Y-1)%10|0;else if(Pe=Math.ceil((T+1)/Se),oe=Oe.length,Pe>=oe)if(A){for(;oe++<=Pe;)Oe.push(0);Ee=pe=0,L=1,T%=Se,Y=T-Se+1}else break e;else{for(Ee=oe=Oe[Pe],L=1;oe>=10;oe/=10)L++;T%=Se,Y=T-Se+L,pe=Y<0?0:Ee/j(10,L-Y-1)%10|0}if(A=A||N<0||Oe[Pe+1]!==void 0||(Y<0?Ee:Ee%j(10,L-Y-1)),re=E<4?(pe||A)&&(E==0||E==(w.s<0?3:2)):pe>5||pe==5&&(E==4||A||E==6&&(T>0?Y>0?Ee/j(10,L-Y):0:Oe[Pe-1])%10&1||E==(w.s<0?8:7)),N<1||!Oe[0])return Oe.length=0,re?(N-=w.e+1,Oe[0]=j(10,(Se-N%Se)%Se),w.e=-N||0):Oe[0]=w.e=0,w;if(T==0?(Oe.length=Pe,oe=1,Pe--):(Oe.length=Pe+1,oe=j(10,Se-T),Oe[Pe]=Y>0?(Ee/j(10,L-Y)%j(10,Y)|0)*oe:0),re)for(;;)if(Pe==0){for(T=1,Y=Oe[0];Y>=10;Y/=10)T++;for(Y=Oe[0]+=oe,oe=1;Y>=10;Y/=10)oe++;T!=oe&&(w.e++,Oe[0]==Re&&(Oe[0]=1));break}else{if(Oe[Pe]+=oe,Oe[Pe]!=Re)break;Oe[Pe--]=0,oe=1}for(T=Oe.length;Oe[--T]===0;)Oe.pop()}return H&&(w.e>nt.maxE?(w.d=null,w.e=NaN):w.e<nt.minE&&(w.e=0,w.d=[0])),w}function B(w,N,E){if(!w.isFinite())return it(w);var A,L=w.e,T=d(w.d),Y=T.length;return N?(E&&(A=E-Y)>0?T=T.charAt(0)+"."+T.slice(1)+me(A):Y>1&&(T=T.charAt(0)+"."+T.slice(1)),T=T+(w.e<0?"e":"e+")+w.e):L<0?(T="0."+me(-L-1)+T,E&&(A=E-Y)>0&&(T+=me(A))):L>=Y?(T+=me(L+1-Y),E&&(A=E-L-1)>0&&(T=T+"."+me(A))):((A=L+1)<Y&&(T=T.slice(0,A)+"."+T.slice(A)),E&&(A=E-Y)>0&&(L+1===Y&&(T+="."),T+=me(A))),T}function Q(w,N){var E=w[0];for(N*=Se;E>=10;E/=10)N++;return N}function te(w,N,E){if(N>u)throw H=!0,E&&(w.precision=E),Error(De);return R(new w(X),N,1,!0)}function ue(w,N,E){if(N>g)throw Error(De);return R(new w(K),N,E,!0)}function qe(w){var N=w.length-1,E=N*Se+1;if(N=w[N],N){for(;N%10==0;N/=10)E--;for(N=w[0];N>=10;N/=10)E++}return E}function me(w){for(var N="";w--;)N+="0";return N}function Be(w,N,E,A){var L,T=new w(1),Y=Math.ceil(A/Se+4);for(H=!1;;){if(E%2&&(T=T.times(N),p(T.d,Y)&&(L=!0)),E=fe(E/2),E===0){E=T.d.length-1,L&&T.d[E]===0&&++T.d[E];break}N=N.times(N),p(N.d,Y)}return H=!0,T}function Je(w){return w.d[w.d.length-1]&1}function Ae(w,N,E){for(var A,L,T=new w(N[0]),Y=0;++Y<N.length;){if(L=new w(N[Y]),!L.s){T=L;break}A=T.cmp(L),(A===E||A===0&&T.s===E)&&(T=L)}return T}function Ve(w,N){var E,A,L,T,Y,oe,pe,re=0,Ee=0,Oe=0,Pe=w.constructor,nt=Pe.rounding,Nt=Pe.precision;if(!w.d||!w.d[0]||w.e>17)return new Pe(w.d?w.d[0]?w.s<0?0:1/0:1:w.s?w.s<0?0:w:NaN);for(N==null?(H=!1,pe=Nt):pe=N,oe=new Pe(.03125);w.e>-2;)w=w.times(oe),Oe+=5;for(A=Math.log(j(2,Oe))/Math.LN10*2+5|0,pe+=A,E=T=Y=new Pe(1),Pe.precision=pe;;){if(T=R(T.times(w),pe,1),E=E.times(++Ee),oe=Y.plus(b(T,E,pe,1)),d(oe.d).slice(0,pe)===d(Y.d).slice(0,pe)){for(L=Oe;L--;)Y=R(Y.times(Y),pe,1);if(N==null)if(re<3&&v(Y.d,pe-A,nt,re))Pe.precision=pe+=10,E=T=oe=new Pe(1),Ee=0,re++;else return R(Y,Pe.precision=Nt,nt,H=!0);else return Pe.precision=Nt,Y}Y=oe}}function Ze(w,N){var E,A,L,T,Y,oe,pe,re,Ee,Oe,Pe,nt=1,Nt=10,ot=w,n0=ot.d,Dt=ot.constructor,u0=Dt.rounding,Tt=Dt.precision;if(ot.s<0||!n0||!n0[0]||!ot.e&&n0[0]==1&&n0.length==1)return new Dt(n0&&!n0[0]?-1/0:ot.s!=1?NaN:n0?0:ot);if(N==null?(H=!1,Ee=Tt):Ee=N,Dt.precision=Ee+=Nt,E=d(n0),A=E.charAt(0),Math.abs(T=ot.e)<15e14){for(;A<7&&A!=1||A==1&&E.charAt(1)>3;)ot=ot.times(w),E=d(ot.d),A=E.charAt(0),nt++;T=ot.e,A>1?(ot=new Dt("0."+E),T++):ot=new Dt(A+"."+E.slice(1))}else return re=te(Dt,Ee+2,Tt).times(T+""),ot=Ze(new Dt(A+"."+E.slice(1)),Ee-Nt).plus(re),Dt.precision=Tt,N==null?R(ot,Tt,u0,H=!0):ot;for(Oe=ot,pe=Y=ot=b(ot.minus(1),ot.plus(1),Ee,1),Pe=R(ot.times(ot),Ee,1),L=3;;){if(Y=R(Y.times(Pe),Ee,1),re=pe.plus(b(Y,new Dt(L),Ee,1)),d(re.d).slice(0,Ee)===d(pe.d).slice(0,Ee))if(pe=pe.times(2),T!==0&&(pe=pe.plus(te(Dt,Ee+2,Tt).times(T+""))),pe=b(pe,new Dt(nt),Ee,1),N==null)if(v(pe.d,Ee-Nt,u0,oe))Dt.precision=Ee+=Nt,re=Y=ot=b(Oe.minus(1),Oe.plus(1),Ee,1),Pe=R(ot.times(ot),Ee,1),L=oe=1;else return R(pe,Dt.precision=Tt,u0,H=!0);else return Dt.precision=Tt,pe;pe=re,L+=2}}function it(w){return String(w.s*w.s/0)}function Xe(w,N){var E,A,L;for((E=N.indexOf("."))>-1&&(N=N.replace(".","")),(A=N.search(/e/i))>0?(E<0&&(E=A),E+=+N.slice(A+1),N=N.substring(0,A)):E<0&&(E=N.length),A=0;N.charCodeAt(A)===48;A++);for(L=N.length;N.charCodeAt(L-1)===48;--L);if(N=N.slice(A,L),N){if(L-=A,w.e=E=E-A-1,w.d=[],A=(E+1)%Se,E<0&&(A+=Se),A<L){for(A&&w.d.push(+N.slice(0,A)),L-=Se;A<L;)w.d.push(+N.slice(A,A+=Se));N=N.slice(A),A=Se-N.length}else A-=L;for(;A--;)N+="0";w.d.push(+N),H&&(w.e>w.constructor.maxE?(w.d=null,w.e=NaN):w.e<w.constructor.minE&&(w.e=0,w.d=[0]))}else w.e=0,w.d=[0];return w}function Ye(w,N){var E,A,L,T,Y,oe,pe,re,Ee;if(N.indexOf("_")>-1){if(N=N.replace(/(\d)_(?=\d)/g,"$1"),ye.test(N))return Xe(w,N)}else if(N==="Infinity"||N==="NaN")return+N||(w.s=NaN),w.e=NaN,w.d=null,w;if(Ge.test(N))E=16,N=N.toLowerCase();else if(xe.test(N))E=2;else if(ke.test(N))E=8;else throw Error(Ue+N);for(T=N.search(/p/i),T>0?(pe=+N.slice(T+1),N=N.substring(2,T)):N=N.slice(2),T=N.indexOf("."),Y=T>=0,A=w.constructor,Y&&(N=N.replace(".",""),oe=N.length,T=oe-T,L=Be(A,new A(E),T,T*2)),re=M(N,E,Re),Ee=re.length-1,T=Ee;re[T]===0;--T)re.pop();return T<0?new A(w.s*0):(w.e=Q(re,Ee),w.d=re,H=!1,Y&&(w=b(w,L,oe*4)),pe&&(w=w.times(Math.abs(pe)<54?j(2,pe):Z.pow(2,pe))),H=!0,w)}function rt(w,N){var E,A=N.d.length;if(A<3)return N.isZero()?N:Le(w,2,N,N);E=1.4*Math.sqrt(A),E=E>16?16:E|0,N=N.times(1/F(5,E)),N=Le(w,2,N,N);for(var L,T=new w(5),Y=new w(16),oe=new w(20);E--;)L=N.times(N),N=N.times(T.plus(L.times(Y.times(L).minus(oe))));return N}function Le(w,N,E,A,L){var T,Y,oe,pe,re=1,Ee=w.precision,Oe=Math.ceil(Ee/Se);for(H=!1,pe=E.times(E),oe=new w(A);;){if(Y=b(oe.times(pe),new w(N++*N++),Ee,1),oe=L?A.plus(Y):A.minus(Y),A=b(Y.times(pe),new w(N++*N++),Ee,1),Y=oe.plus(A),Y.d[Oe]!==void 0){for(T=Oe;Y.d[T]===oe.d[T]&&T--;);if(T==-1)break}T=oe,oe=A,A=Y,Y=T,re++}return H=!0,Y.d.length=Oe+1,Y}function F(w,N){for(var E=w;--N;)E*=w;return E}function $(w,N){var E,A=N.s<0,L=ue(w,w.precision,1),T=L.times(.5);if(N=N.abs(),N.lte(T))return ae=A?4:1,N;if(E=N.divToInt(L),E.isZero())ae=A?3:2;else{if(N=N.minus(E.times(L)),N.lte(T))return ae=Je(E)?A?2:3:A?4:1,N;ae=Je(E)?A?1:4:A?3:2}return N.minus(L).abs()}function G(w,N,E,A){var L,T,Y,oe,pe,re,Ee,Oe,Pe,nt=w.constructor,Nt=E!==void 0;if(Nt?(S(E,1,e),A===void 0?A=nt.rounding:S(A,0,8)):(E=nt.precision,A=nt.rounding),!w.isFinite())Ee=it(w);else{for(Ee=B(w),Y=Ee.indexOf("."),Nt?(L=2,N==16?E=E*4-3:N==8&&(E=E*3-2)):L=N,Y>=0&&(Ee=Ee.replace(".",""),Pe=new nt(1),Pe.e=Ee.length-Y,Pe.d=M(B(Pe),10,L),Pe.e=Pe.d.length),Oe=M(Ee,10,L),T=pe=Oe.length;Oe[--pe]==0;)Oe.pop();if(!Oe[0])Ee=Nt?"0p+0":"0";else{if(Y<0?T--:(w=new nt(w),w.d=Oe,w.e=T,w=b(w,Pe,E,A,0,L),Oe=w.d,T=w.e,re=J),Y=Oe[E],oe=L/2,re=re||Oe[E+1]!==void 0,re=A<4?(Y!==void 0||re)&&(A===0||A===(w.s<0?3:2)):Y>oe||Y===oe&&(A===4||re||A===6&&Oe[E-1]&1||A===(w.s<0?8:7)),Oe.length=E,re)for(;++Oe[--E]>L-1;)Oe[E]=0,E||(++T,Oe.unshift(1));for(pe=Oe.length;!Oe[pe-1];--pe);for(Y=0,Ee="";Y<pe;Y++)Ee+=_.charAt(Oe[Y]);if(Nt){if(pe>1)if(N==16||N==8){for(Y=N==16?4:3,--pe;pe%Y;pe++)Ee+="0";for(Oe=M(Ee,L,N),pe=Oe.length;!Oe[pe-1];--pe);for(Y=1,Ee="1.";Y<pe;Y++)Ee+=_.charAt(Oe[Y])}else Ee=Ee.charAt(0)+"."+Ee.slice(1);Ee=Ee+(T<0?"p":"p+")+T}else if(T<0){for(;++T;)Ee="0"+Ee;Ee="0."+Ee}else if(++T>pe)for(T-=pe;T--;)Ee+="0";else T<pe&&(Ee=Ee.slice(0,T)+"."+Ee.slice(T))}Ee=(N==16?"0x":N==2?"0b":N==8?"0o":"")+Ee}return w.s<0?"-"+Ee:Ee}function p(w,N){if(w.length>N)return w.length=N,!0}function z(w){return new this(w).abs()}function V(w){return new this(w).acos()}function q(w){return new this(w).acosh()}function l(w,N){return new this(w).plus(N)}function t(w){return new this(w).asin()}function i(w){return new this(w).asinh()}function h(w){return new this(w).atan()}function m(w){return new this(w).atanh()}function y(w,N){w=new this(w),N=new this(N);var E,A=this.precision,L=this.rounding,T=A+4;return!w.s||!N.s?E=new this(NaN):!w.d&&!N.d?(E=ue(this,T,1).times(N.s>0?.25:.75),E.s=w.s):!N.d||w.isZero()?(E=N.s<0?ue(this,A,L):new this(0),E.s=w.s):!w.d||N.isZero()?(E=ue(this,T,1).times(.5),E.s=w.s):N.s<0?(this.precision=T,this.rounding=1,E=this.atan(b(w,N,T,1)),N=ue(this,T,1),this.precision=A,this.rounding=L,E=w.s<0?E.minus(N):E.plus(N)):E=this.atan(b(w,N,T,1)),E}function I(w){return new this(w).cbrt()}function x(w){return R(w=new this(w),w.e+1,2)}function C(w,N,E){return new this(w).clamp(N,E)}function O(w){if(!w||typeof w!="object")throw Error(Ie+"Object expected");var N,E,A,L=w.defaults===!0,T=["precision",1,e,"rounding",0,8,"toExpNeg",-n,0,"toExpPos",0,n,"maxE",0,n,"minE",-n,0,"modulo",0,9];for(N=0;N<T.length;N+=3)if(E=T[N],L&&(this[E]=ne[E]),(A=w[E])!==void 0)if(fe(A)===A&&A>=T[N+1]&&A<=T[N+2])this[E]=A;else throw Error(Ue+E+": "+A);if(E="crypto",L&&(this[E]=ne[E]),(A=w[E])!==void 0)if(A===!0||A===!1||A===0||A===1)if(A)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[E]=!0;else throw Error(se);else this[E]=!1;else throw Error(Ue+E+": "+A);return this}function D(w){return new this(w).cos()}function le(w){return new this(w).cosh()}function ge(w){var N,E,A;function L(T){var Y,oe,pe,re=this;if(!(re instanceof L))return new L(T);if(re.constructor=L,He(T)){re.s=T.s,H?!T.d||T.e>L.maxE?(re.e=NaN,re.d=null):T.e<L.minE?(re.e=0,re.d=[0]):(re.e=T.e,re.d=T.d.slice()):(re.e=T.e,re.d=T.d?T.d.slice():T.d);return}if(pe=typeof T,pe==="number"){if(T===0){re.s=1/T<0?-1:1,re.e=0,re.d=[0];return}if(T<0?(T=-T,re.s=-1):re.s=1,T===~~T&&T<1e7){for(Y=0,oe=T;oe>=10;oe/=10)Y++;H?Y>L.maxE?(re.e=NaN,re.d=null):Y<L.minE?(re.e=0,re.d=[0]):(re.e=Y,re.d=[T]):(re.e=Y,re.d=[T]);return}if(T*0!==0){T||(re.s=NaN),re.e=NaN,re.d=null;return}return Xe(re,T.toString())}if(pe==="string")return(oe=T.charCodeAt(0))===45?(T=T.slice(1),re.s=-1):(oe===43&&(T=T.slice(1)),re.s=1),ye.test(T)?Xe(re,T):Ye(re,T);if(pe==="bigint")return T<0?(T=-T,re.s=-1):re.s=1,Xe(re,T.toString());throw Error(Ue+T)}if(L.prototype=r,L.ROUND_UP=0,L.ROUND_DOWN=1,L.ROUND_CEIL=2,L.ROUND_FLOOR=3,L.ROUND_HALF_UP=4,L.ROUND_HALF_DOWN=5,L.ROUND_HALF_EVEN=6,L.ROUND_HALF_CEIL=7,L.ROUND_HALF_FLOOR=8,L.EUCLID=9,L.config=L.set=O,L.clone=ge,L.isDecimal=He,L.abs=z,L.acos=V,L.acosh=q,L.add=l,L.asin=t,L.asinh=i,L.atan=h,L.atanh=m,L.atan2=y,L.cbrt=I,L.ceil=x,L.clamp=C,L.cos=D,L.cosh=le,L.div=de,L.exp=be,L.floor=Ce,L.hypot=Fe,L.ln=Te,L.log=ze,L.log10=gt,L.log2=st,L.max=wt,L.min=$t,L.mod=ft,L.mul=yt,L.pow=It,L.random=qt,L.round=Pt,L.sign=p0,L.sin=w0,L.sinh=Ct,L.sqrt=l0,L.sub=a0,L.sum=v0,L.tan=ut,L.tanh=i1,L.trunc=r1,w===void 0&&(w={}),w&&w.defaults!==!0)for(A=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],N=0;N<A.length;)w.hasOwnProperty(E=A[N++])||(w[E]=this[E]);return L.config(w),L}function de(w,N){return new this(w).div(N)}function be(w){return new this(w).exp()}function Ce(w){return R(w=new this(w),w.e+1,3)}function Fe(){var w,N,E=new this(0);for(H=!1,w=0;w<arguments.length;)if(N=new this(arguments[w++]),N.d)E.d&&(E=E.plus(N.times(N)));else{if(N.s)return H=!0,new this(1/0);E=N}return H=!0,E.sqrt()}function He(w){return w instanceof Z||w&&w.toStringTag===he||!1}function Te(w){return new this(w).ln()}function ze(w,N){return new this(w).log(N)}function st(w){return new this(w).log(2)}function gt(w){return new this(w).log(10)}function wt(){return Ae(this,arguments,-1)}function $t(){return Ae(this,arguments,1)}function ft(w,N){return new this(w).mod(N)}function yt(w,N){return new this(w).mul(N)}function It(w,N){return new this(w).pow(N)}function qt(w){var N,E,A,L,T=0,Y=new this(1),oe=[];if(w===void 0?w=this.precision:S(w,1,e),A=Math.ceil(w/Se),this.crypto)if(crypto.getRandomValues)for(N=crypto.getRandomValues(new Uint32Array(A));T<A;)L=N[T],L>=429e7?N[T]=crypto.getRandomValues(new Uint32Array(1))[0]:oe[T++]=L%1e7;else if(crypto.randomBytes){for(N=crypto.randomBytes(A*=4);T<A;)L=N[T]+(N[T+1]<<8)+(N[T+2]<<16)+((N[T+3]&127)<<24),L>=214e7?crypto.randomBytes(4).copy(N,T):(oe.push(L%1e7),T+=4);T=A/4}else throw Error(se);else for(;T<A;)oe[T++]=Math.random()*1e7|0;for(A=oe[--T],w%=Se,A&&w&&(L=j(10,Se-w),oe[T]=(A/L|0)*L);oe[T]===0;T--)oe.pop();if(T<0)E=0,oe=[0];else{for(E=-1;oe[0]===0;E-=Se)oe.shift();for(A=1,L=oe[0];L>=10;L/=10)A++;A<Se&&(E-=Se-A)}return Y.e=E,Y.d=oe,Y}function Pt(w){return R(w=new this(w),w.e+1,this.rounding)}function p0(w){return w=new this(w),w.d?w.d[0]?w.s:0*w.s:w.s||NaN}function w0(w){return new this(w).sin()}function Ct(w){return new this(w).sinh()}function l0(w){return new this(w).sqrt()}function a0(w,N){return new this(w).sub(N)}function v0(){var w=0,N=arguments,E=new this(N[w]);for(H=!1;E.s&&++w<N.length;)E=E.plus(N[w]);return H=!0,R(E,this.precision,this.rounding)}function ut(w){return new this(w).tan()}function i1(w){return new this(w).tanh()}function r1(w){return R(w=new this(w),w.e+1,1)}Z=ge(ne),Z.prototype.constructor=Z,Z.default=Z.Decimal=Z,X=new Z(X),K=new Z(K),typeof define=="function"&&define.amd?define(function(){return Z}):typeof o1<"u"&&o1.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(r[Symbol.for("nodejs.util.inspect.custom")]=r.toString,r[Symbol.toStringTag]="Decimal"),o1.exports=Z):(f||(f=typeof self<"u"&&self&&self.self==self?self:window),a=f.Decimal,Z.noConflict=function(){return f.Decimal=a,Z},f.Decimal=Z)})(D1)});var V1=y0((Xi,y1)=>{"use strict";var F1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],B1={};for(let f of F1)B1[f]=!0;var kn="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",Pn="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",Dn=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof y1<"u"&&(y1.exports={PRIMES:F1,PRIMES_SET:B1,LONG_PI:kn,LONG_E:Pn,BIG_LOG_CACHE:Dn})});var B0=y0((Hi,x1)=>{"use strict";var Y1=typeof globalThis.nerdamerBigInt>"u"?P1():globalThis.nerdamerBigInt,K1=typeof globalThis.nerdamerBigDecimal>"u"?b1():globalThis.nerdamerBigDecimal,bn=typeof globalThis.nerdamerConstants>"u"?V1():globalThis.nerdamerConstants,en={convert(f,n){let e=Number(f),_;if(e===0)_=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let X=this.quickConversion(e);if(X[1]<=1e16){let K=Math.abs(e),ne=e/K;_=this.fullConversion(K.toFixed(`${X[1]}`.length-1)),_[0]*=ne}else _=X}else _=this.fullConversion(e);return _},quickConversion(f){let n=function(_){typeof _!="string"&&(_=_.toString());let X="",K=_.charAt(0);return K==="-"?(_=_.substr(1,_.length),X="-"):K==="+"&&(_=_.substr(1,_.length)),{sign:X,value:_}};function e(_){Ht.isScientific(_)&&(_=Z0(_));let X=n(_),K=X.value.split("."),ne;K.length===1?ne=K[0]:ne=K[0]+K[1];let Z=K[1]?K[1].length:0,J=`1${"0".repeat(Z)}`;return ne!=="0"&&(ne=ne.replace(/^0+/u,"")),[X.sign+ne,J]}return e(f)},fullConversion(f){let n=Number(f),e=Math.abs(n)>1e10?1e-16:1e-30,_=!1,X=0,K=1,ne=1,Z=0,J=0,a=n,ae,H,Ie=1e-14;for(;!_;){J++;let Ue;if(Math.abs(a)>1e10){let se=Math.round(a);Ue=Math.abs(a-se)/Math.abs(se)<Ie?se:Math.floor(a)}else Ue=Math.floor(a);ae=X+Ue*ne,H=K+Ue*Z;let De=a-Ue;De<e&&(_=!0),a=1/De,X=ne,K=Z,ne=ae,Z=H,(Math.abs(ae/H-n)<e||J>30)&&(_=!0)}return[ae,H]}},Ut={bigInt:Y1,bigDec:K1,isInt:()=>!1,scientificToDecimal:()=>"",DivisionByZero:Error,Settings:{PRECISION:21,USE_BIG:!1},Fraction:en},je=class f{constructor(n){if(this.num,this.den,n instanceof f)return n;if(n===void 0)return this;try{if(Ut.isInt(n))try{this.num=Ut.bigInt(n),this.den=Ut.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return f.simple(n)}else{let e=n instanceof Ut.bigDec?Ut.Fraction.quickConversion(n):Ut.Fraction.convert(n);this.num=new Ut.bigInt(e[0]),this.den=new Ut.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return f.simple(n)}}static create(n){if(n instanceof f)return n;n=n.toString();let e=n.charAt(0)==="-";e&&(n=n.substr(1,n.length-1));let _=new f(n);return e&&_.negate(),_}static isFrac(n){return n instanceof f}static quick(n,e){let _=new f;return _.num=new Ut.bigInt(n),_.den=new Ut.bigInt(e),_}static simple(n){let _=String(Ut.scientificToDecimal(n)).split("."),X=_.join(""),K="1",ne=(_[1]||"").length;for(let J=0;J<ne;J++)K+="0";return f.quick(X,K).simplify()}multiply(n){if(this.isOne())return n.clone();if(n.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(n.num),e.den=e.den.multiply(n.den),e.simplify()}divide(n){if(n.equals(0))throw new Ut.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(n.clone().invert()).simplify()}subtract(n){return this.clone().add(n.clone().neg())}sub(n){return this.subtract(n)}neg(){return this.num=this.num.multiply(-1),this}add(n){let e=this.den,_=n.den,X=this.clone(),K=X.num,ne=n.num;return e.equals(_)?X.num=K.add(ne):(X.num=K.multiply(_).add(ne.multiply(e)),X.den=e.multiply(_)),X.simplify()}mod(n){let e=this.clone(),_=n.clone();return e.num=e.num.multiply(_.den),e.den=e.den.multiply(_.den),_.num=_.num.multiply(this.den),_.den=_.den.multiply(this.den),e.num=e.num.mod(_.num),e.simplify()}simplify(){let n=Ut.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(n),this.den=this.den.divide(n),this}clone(){let n=new f;return n.num=new Ut.bigInt(this.num),n.den=new Ut.bigInt(this.den),n}decimal(n){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";n||=Ut.Settings.PRECISION,n+=2;let _=[],X=this.num.abs(),K=this.den,ne;for(ne=0;ne<n;ne++){let a=X.divide(K),ae=X.subtract(a.multiply(K));if(_.push(a),ae.equals(0))break;X=ae.times(10)}let Z=_.shift();if(_.length===0)return e+Z.toString();if(ne===n){let a=[];for(let ae=0;ae<2;ae++)a.unshift(_.pop());_.push(Math.round(Number(a.join("."))))}let J=`${Z.toString()}.${_.join("")}`;return e+J}toDecimal(n){return n||=Ut.Settings.PRECISION,n?this.decimal(n):this.num.valueOf()/this.den.valueOf()}qcompare(n){return[this.num.multiply(n.den),n.num.multiply(this.den)]}equals(n){isNaN(n)||(n=new f(n));let e=this.qcompare(n);return e[0].equals(e[1])}absEquals(n){isNaN(n)||(n=new f(n));let e=this.qcompare(n);return e[0].abs().equals(e[1])}greaterThan(n){isNaN(n)||(n=new f(n));let e=this.qcompare(n);return e[0].gt(e[1])}gt(n){return this.greaterThan(n)}gte(n){return this.greaterThan(n)||this.equals(n)}lte(n){return this.lessThan(n)||this.equals(n)}lessThan(n){isNaN(n)||(n=new f(n));let e=this.qcompare(n);return e[0].lt(e[1])}lt(n){return this.lessThan(n)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let n=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=n,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(n){return f.quick(Ut.bigInt.gcd(n.num,this.num),Ut.bigInt.lcm(n.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Ut.Settings.USE_BIG?new Ut.bigDec(this.num.toString()).div(new Ut.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(n){let e=typeof n=="number"?new f(n):n;return this.mod(e).equals(0)}},b0={isVector:()=>!1,Vector:{fromArray:()=>({})},remove:()=>{}};function d0(f,...n){if(this.elements=[],typeof f>"u")return;let e=f;if(b0.isVector(e)||(e=b0.Vector.fromArray([e,...n])),e){let{elements:_}=e;for(let X=0,K=_.length;X<K;X++)this.add(_[X])}}d0.fromArray=function(n){function e(_){return d0.apply(this,_)}return e.prototype=d0.prototype,new e(n)};d0.prototype={elements:[],add(f){this.contains(f)||this.elements.push(f.clone())},contains(f){for(let n=0;n<this.elements.length;n++){let e=this.elements[n];if(f.equals(e))return!0}return!1},each(f){let{elements:n}=this,e=new d0;for(let _=0,X=n.length;_<X;_++){let K=n[_];f.call(this,K,e,_)}return e},clone(){let f=new d0;return this.each(n=>{f.add(n.clone())}),f},union(f){let n=this.clone();return f.each(e=>{n.add(e)}),n},difference(f){let n=this.clone();return f.each(e=>{n.remove(e)}),n},remove(f){for(let n=0,e=this.elements.length;n<e;n++)if(this.elements[n].equals(f))return b0.remove(this.elements,n),!0;return!1},intersection(f){let n=new d0,e=this;return f.each(_=>{e.contains(_)&&n.add(_)}),n},intersects(f){return this.intersection(f).elements.length>0},isSubset(f){let{elements:n}=f;for(let e=0,_=n.length;e<_;e++)if(!this.contains(n[e]))return!1;return!0},toString(){return`{${this.elements.join(",")}}`}};var M0={_:null,block:()=>{}};function Ft(){this.elements=[]}Ft.prototype.append=function(n){this.elements.push(n)};Ft.prototype.getItems=function(){return this.elements};Ft.prototype.toString=function(){return M0._.prettyPrint(this.elements)};Ft.prototype.dimensions=function(){return this.elements.length};Ft.prototype.text=function(f){return`(${this.elements.map(n=>n.text(f)).join(",")})`};Ft.create=function(n){let e=new Ft;return n&&e.append(n),e};Ft.prototype.clone=function(n){let e=Ft.create();return e.elements=this.elements.map(_=>_.clone()),e};Ft.prototype.expand=function(n){return this.elements=this.elements.map(e=>M0._.expand(e,n)),this};Ft.prototype.evaluate=function(f){return this.elements=this.elements.map(n=>M0._.evaluate(n,f)),this};Ft.prototype.map=function(n){let e=this.clone();return e.elements=e.elements.map((_,X)=>n(_,X+1)),e};Ft.prototype.add=function(n){return M0.block("SAFE",()=>{let e=n.elements||n;return this.elements.length!==e.length?null:this.map((_,X)=>M0._.add(_,e[X-1]))},void 0,this)};Ft.prototype.subtract=function(n){return M0.block("SAFE",()=>{let e=n.elements||n;return this.elements.length!==e.length?null:this.map((_,X)=>M0._.subtract(_,e[X-1]))},void 0,this)};var tn={Settings:{SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0},nround:(f,n)=>Math.round(f*10**n)/10**n};function Ht(f){return this instanceof Ht?(f=String(typeof f>"u"?0:f),f.startsWith("-")?(this.sign=-1,f=f.substr(1,f.length)):this.sign=1,Ht.isScientific(f)?this.fromScientific(f):this.convert(f),this):new Ht(f)}Ht.prototype={fromScientific(f){let n=String(f).toLowerCase().split("e");this.coeff=n[0],this.exponent=Number(n[1]);let e=this.coeff.split(".");this.wholes=e[0]||"",this.dec=e[1]||"";let{dec:_}=this;return this.decp=_==="0"?0:_.length,this},convert(f){let n=f.split("."),e=n[0]||"",_=n[1]||"";e=Ht.removeLeadingZeroes(e),_=Ht.removeTrailingZeroes(_);let X=e.length,K=e+_,ne=Ht.leadingZeroes(K).length;this.exponent=X-(ne+1);let Z=Ht.removeLeadingZeroes(K);this.coeff=`${Z.charAt(0)}.${Ht.removeTrailingZeroes(Z.substr(1,Z.length))||"0"}`;let J=this.coeff.split(".")[1]||"";return this.decp=J==="0"?0:J.length,this.dec=_,this.wholes=e,this},round(f){let n=this.copy();if(f=Number(f),f===0)n.coeff=n.coeff.charAt(0);else{let e=this.coeff.substring(0,f+1),_=this.coeff.substring(f+1,f+3),X=Number(_.charAt(0));Number(_.charAt(1))>4&&X++,n.coeff=e+X}return n},copy(){let f=new Ht(0);return f.coeff=this.coeff,f.exponent=this.exponent,f.sign=this.sign,f},toString(f){let n;if(tn.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<f)this.decp===0&&this.wholes!==void 0?n=this.wholes:n=this.coeff;else{let e=typeof f>"u"?this.coeff:Ht.round(this.coeff,Math.min(f,this.decp||1)),_=this.exponent;e.startsWith("10.")&&(e=typeof f>"u"?e.replace(/^10\./u,"1.0"):Ht.round(e.replace(/^10\./u,"1.0"),Math.min(f,this.decp||1)),_=Number(_)+1),n=this.exponent===0?e:`${e}e${_}`}return(this.sign===-1?"-":"")+n}};Ht.isScientific=function(n){return/\d+\.?\d*e[+-]*\d+/iu.test(n)};Ht.leadingZeroes=function(n){let e=n.match(/^(?<zeros>0*).*$/u);return e?e[1]:""};Ht.removeLeadingZeroes=function(n){let e=n.match(/^0*(?<rest>.*)$/u);return e?e[1]:""};Ht.removeTrailingZeroes=function(n){let e=n.match(/0*$/u);return e?n.substring(0,n.length-e[0].length):""};Ht.round=function(n,e){let _=String(tn.nround(n,e)),X=_.includes(".")?_.split(".").pop():"",K=e-X.length;return K>0&&(_.includes(".")||(_+="."),_+=new Array(K+1).join("0")),_};function r0(f){let n=function(e){this.name=f,this.message=e===void 0?"":e;let _=new Error(this.message);_.name=this.name,this.stack=_.stack};return n.prototype=Object.create(Error.prototype),n}function Xt(f){return Array.isArray(f)}function Gt(f){return`(${f})`}function Fn(f,n){return f<0==n<0}function bt(...f){return f.shift().replace(/\{(?<idx>\d+)\}/gu,(_,X)=>{let K=f[X];return typeof K=="function"?K():K})}function Bn(f,n,e){let _=[];e||=1;for(let X=f;X<=n;X++)_.push(X*e);return _}function Vn(f){return f&&String(f)}function Gn(f,n,e,_){return f.substr(0,n)+_+f.substr(e,f.length)}function Xn(f){return f!==void 0&&f.custom}function Hn(f){return Math.max.apply(void 0,f)}function N1(f){return Math.min.apply(void 0,f)}function Bt(f){return Number(f)%2===0}function E1(f){return 1/(f%1)%2===0}function M1(f){let n=f.length,e=[];for(let _=0;_<n;_++){let X=f[_];e.indexOf(X)===-1&&e.push(X)}return e}function jn(f){return[].slice.call(f)}function vt(f){return typeof f=="number"?Number.isInteger(f):typeof f<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(f.toString())}function Zn(f,n){if(f.sort(),n.sort(),f.length===n.length){for(let e=0;e<f.length;e++)if(f[e]!==n[e])return!1;return!0}return!1}function zn(f){let n=[],e=f.length;for(let _=0;_<e;_++)n[_]=f[_].clone();return n}function nn(f){return/^\d+\.?\d*$/u.test(f)}function _0(f,n=14){return vt(f)?Number(f)>=Number.MAX_VALUE?f.toString():Number(f):Math.round(f*10**n)/10**n}function Wn(f,n){n||=20;let e=[],_,X,K;e.push(f[0]);for(let ne=0;ne<f.length-1;ne++){_=f[ne],X=f[ne+1]-_,K=X/n;for(let Z=0;Z<n;Z++)_+=K,e.push(_)}return e}function rn(f,n){if(Xt(f)){let e=f.length;for(let _=0;_<e;_++)n.call(f,_)}else for(let e in f)Object.hasOwn(f,e)&&n.call(f,e)}function T0(f,n){let e;return Xt(f)?e=f.splice(n,1)[0]:(e=f[n],delete f[n]),e}function Qn(f,n){let e={};return e[f]=n,e}function Jn(f){for(let n=0;n<f.length;n++)if(!nn(f[n]))return!1;return!0}function Z0(f){let n=Math.sign(f),e=Math.abs(f);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let X=String(e).toLowerCase().split("e"),K=X.pop(),ne=Math.abs(Number(K)),Z=Math.sign(Number(K)),J=X[0].split(".");if(Z===-1)ne-=J[0].length,ne<0?e=`${J[0].slice(0,ne)}.${J[0].slice(ne)}${J.length===2?J[1]:""}`:e=`0.${new Array(ne+1).join("0")}${J.join("")}`;else{let a=J[1];a&&(ne-=a.length),ne<0?e=`${J[0]+a.slice(0,ne)}.${a.slice(ne)}`:e=J.join("")+new Array(ne+1).join("0")}}return n<0?`-${e}`:String(e)}function l1(f){let n=f[0];for(let e=1,_=f.length;e<_;e++)if(!f[e].equals(n))return!1;return!0}function Yn(f,n){typeof n!=="function"&&(n=function(X,K){return X===K});let _=[];for(;f.length;){let X=f[0];if(f.length===1){_.push(X);break}let K=[];_.push(X);for(let ne=1;ne<f.length;ne++){let Z=f[ne];n(X,Z)||K.push(Z)}f=K}return _}function Kn(f,n){let e=f.length,_=[];for(let ne=0;ne<f.length;ne++)_.push([f[ne],n[ne]]);_.sort((ne,Z)=>Number(ne[0])-Number(Z[0]));let X=[],K=[];for(let ne=0;ne<e;ne++)X.push(_[ne][0]),K.push(_[ne][1]);return[X,K]}var A1=r0("DivisionByZero"),G1=r0("ParseError"),i0=r0("UndefinedError"),_1=r0("OutOfFunctionDomainError"),ei=r0("MaximumIterationsReached"),T1=r0("NerdamerTypeError"),a1=r0("ParityError"),P0=r0("OperatorError"),ti=r0("OutOfRangeError"),I1=r0("DimensionError"),sn=r0("InvalidVariableNameError"),ni=r0("ValueLimitExceededError"),X1=r0("NerdamerValueError"),ii=r0("SolveError"),ri=r0("InfiniteLoopError"),H1=r0("UnexpectedTokenError");function q1(f){return f instanceof Ft}function j1(f){return f instanceof d0}function u1(f,n,e){let X=Object.keys(f)[0];return n?X:e?{key:X,obj:f[X]}:f[X]}var{keys:R1}=Object,h1={N:1,P:2};function D0(f){return f.group===h1.N||f.group===h1.P}var on={S:3};function Z1(f){return f.group===on.S&&f.multiplier.equals(1)&&f.power.equals(1)}var ln={N:1};function O1(f){for(let n=0;n<f.length;n++)if(f[n].group!==ln.N)return!1;return!0}var L1={RESERVED:[]};function c1(f){let n=function(e){L1.RESERVED.indexOf(e)===-1&&L1.RESERVED.push(e)};typeof f=="string"?n(f):rn(f,e=>{n(e)})}var F0={RESERVED:[]};function si(f){let n=F0.RESERVED.indexOf(f);n!==-1&&(F0.RESERVED[n]=void 0)}var g1={ALLOW_CHARS:[],VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function I0(f,n="variable"){if(g1.ALLOW_CHARS.indexOf(f)!==-1)return;if(!g1.VALIDATION_REGEX.test(f))throw new sn(`${f} is not a valid ${n} name`)}var an={RESERVED:[]};function f1(f){return an.RESERVED.indexOf(f)!==-1}var Q0={WARNINGS:[],SHOW_WARNINGS:!1};function C1(f){Q0.WARNINGS.push(f),Q0.SHOW_WARNINGS&&console&&console.warn&&console.warn(f)}function oi(){return Q0.WARNINGS}var un={EXPRESSIONS:[]};function li(){return un.EXPRESSIONS.length}var cn={Settings:{}};function ai(f){return cn.Settings[f]}function ui(f){try{return I0(f),F0.RESERVED.indexOf(f)===-1}catch(n){if(n.message==="timeout")throw n;return!1}}function ci(f){return f?F0.RESERVED:F0.RESERVED.join(", ")}var J0={_version:"",C:{}};function fi(f){if(f)try{return J0.C[f].version}catch(n){if(n.message==="timeout")throw n;return`No module named ${f} found!`}return J0._version}function pi(){return J0.C}var fn={functions:null};function hi(){return R1(fn.functions)}var pn={CONSTANTS:null};function gi(f){return String(pn.CONSTANTS[f])}var R0={VARS:null};function mi(f){return R0.VARS[f]}function di(f,n){f||="text";let e={};if(f==="object")e=R0.VARS;else for(let _ in R0.VARS)Object.hasOwn(R0.VARS,_)&&(f==="latex"?e[_]=R0.VARS[_].latex(n):f==="text"&&(e[_]=R0.VARS[_].text(n)));return e}var t0={_:null,C:null};function wi(f,n){return t0._.toTeX(f,n)}function Si(f){return t0._.getOperator(f)}function vi(f,n){t0._.aliasOperator(f,n)}function yi(f,n){t0._.setOperator(f,n)}function Ni(f,n){t0._.peekers[f]&&t0._.peekers[f].push(n)}function Ei(f,n){let e=t0._.peekers[f];if(e){let _=e.indexOf(n);_!==-1&&T0(e,_)}}function hn(f){return t0._.tree(t0._.toRPN(t0._.tokenize(f)))}function Mi(f){return String(f).split(";").map(n=>t0._.parse(n))}function Ai(f){return t0._.tokenize(t0._.toRPN(f))}function _i(f,n){return`<div class="tree">
    <ul>
        <li>
${hn(f).toHTML(3,n)}
        </li>
    </ul>
</div>`}function Ii(f,n,e){let _=t0._.functions[f],X=typeof e>"u"?_[1]:e;t0._.functions[f]=[n(_[0],t0.C),X]}var Vt={EXPRESSIONS:[],USER_FUNCTIONS:[],LaTeX:{latex:()=>"",parse:()=>""},text:()=>"",functions:{},Math2:{},_:null,Expression:null};function qi(f,n,e){let _=f?{}:[];for(let X=0;X<Vt.EXPRESSIONS.length;X++){let K=n?Vt.LaTeX.latex(Vt.EXPRESSIONS[X],e):Vt.text(Vt.EXPRESSIONS[X],e);f?_[X+1]=K:_.push(K)}return _}function Oi(f,n){let e=f?{}:[];for(let _=0;_<Vt.USER_FUNCTIONS.length;_++){let X,K,ne=Vt.USER_FUNCTIONS[_],Z=Vt.functions[ne][2];if(Z)({params:X,body:K}=Z);else{let ae=Vt.Math2[ne].toString();[,X]=/\((?<params>.*?)\)/u.exec(ae),X=X.split(",").map(H=>H.trim()),K="{JavaScript}"}let J=`${ne}(${X.join(", ")})=${K}`,a=Vt.text(J,n);f?e[_+1]=a:e.push(a)}return e}function Ci(f){f=f.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),f=f.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),f=f.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),f=f.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let n=Vt.LaTeX.parse(Vt._.tokenize(f));return new Vt.Expression(Vt._.parse(n))}var s0={libExports:null,VARS:{},_clearFunctions:()=>{},_initConstants:()=>{},clear:null};function Ti(){for(let f in s0.VARS)Object.hasOwn(s0.VARS,f)&&delete s0.VARS[f];return s0.libExports}function Ri(){return s0._clearFunctions(),s0.libExports}function Li(){return s0.libExports}function Ui(){return s0.clear("all"),s0.libExports}function xi(f){return f.call(s0.libExports),s0.libExports}var z0={libExports:null,CONSTANTS:{}};function $i(f,n){if(I0(f),!f1(f))if(n==="delete"||n==="")delete z0.CONSTANTS[f];else{if(isNaN(n))throw new T1("Constant must be a number!");z0.CONSTANTS[f]=n}return z0.libExports}var g0={libExports:null,VARS:{},CONSTANTS:{},parse:()=>null,isSymbol:()=>!1};function ki(f,n){return I0(f),f in g0.CONSTANTS&&zt(`Cannot set value for constant ${f}`),n==="delete"||n===""?delete g0.VARS[f]:g0.VARS[f]=g0.isSymbol(n)?n:g0.parse(n),g0.libExports}var m1={libExports:null,_setFunction:()=>!1};function Pi(f,n,e){if(!m1._setFunction(f,n,e))throw new Error("Failed to set function!");return m1.libExports}var N0={libExports:null,EXPRESSIONS:[]};function z1(f,n=!1){if(f==="all")N0.EXPRESSIONS.length=0;else if(f==="last")N0.EXPRESSIONS.pop();else if(f==="first")N0.EXPRESSIONS.shift();else{let e=f?f-1:N0.EXPRESSIONS.length;n===!0?N0.EXPRESSIONS[e]=void 0:T0(N0.EXPRESSIONS,e)}return N0.libExports}var L0={libExports:null,Settings:null,functions:null};function gn(f){let n=L0.libExports.getCore();if(Xt(f))for(let e=0;e<f.length;e++)f&&gn(f[e]);else if(f&&L0.Settings.exclude.indexOf(f.name)===-1){if(f.dependencies){for(let X=0;X<f.dependencies.length;X++)if(!n[f.dependencies[X]])throw new Error(bt("{0} requires {1} to be loaded!",f.name,f.dependencies[X]))}let e=f.parent,_=f.build.call(n);if(e){n[e]||(n[f.parent]={});let X=e==="nerdamer"?L0.libExports:n[e];X[f.name]=_}f.visible&&(L0.functions[f.name]=[_,f.numargs])}}var Wt={bigDec:null,Settings:null,functions:null,symfunction:null,NerdamerSymbol:null};function U1(f,n){if(typeof f=="object"&&f!==null){let _=f;for(let X in _)Object.hasOwn(_,X)&&U1(X,_[X])}["SAFE"].indexOf(f)!==-1&&zt(`Cannot modify setting: ${f}`),f==="PRECISION"?(Wt.bigDec.set({precision:n}),Wt.Settings.PRECISION=n,n>21&&U1("USE_BIG",!0)):f==="USE_LN"&&n===!0?(Wt.Settings.LOG="LN",Wt.Settings.LOG10="log",Wt.functions.log=Wt.Settings.LOG_FNS.log10,Wt.functions.log[0]=function(X){return X.isConstant()?new Wt.NerdamerSymbol(Math.log10(X)):Wt.symfunction(Wt.Settings.LOG10,[X])},Wt.functions.LN=Wt.Settings.LOG_FNS.log,delete Wt.functions.log10):Wt.Settings[f]=n}var m0={libExports:null,functions:null,parse:null,callfunction:null,Expression:null};function Di(f=!1){let n=function(_){return function(...K){for(let ne=0;ne<K.length;ne++)K[ne]=m0.parse(K[ne]);return new m0.Expression(f0("PARSE2NUMBER",()=>m0.callfunction(_,K)))}};for(let e in m0.functions)(!(e in m0.libExports)||f)&&(m0.libExports[e]=n(e))}var mn={suppress_errors:!1};function zt(f,n=void 0){if(!mn.suppress_errors)throw n?new n(f):new Error(f)}var dn={PRIMES_SET:{}};function W0(f){if(f in dn.PRIMES_SET)return!0;let n=Math.floor(Math.sqrt(f));for(let e=2;e<=n;e++)if(f%e===0)return!1;return!0}var q0={starttime:0,timeout:0,TIMEOUT:800};function W1(){q0.starttime=Date.now(),q0.timeout=q0.TIMEOUT}function Q1(){q0.starttime=0}function d1(){if(q0.starttime!==0&&Date.now()>q0.starttime+q0.timeout)throw new Error("timeout")}var E0={PRIMES:[],PRIMES_SET:{}};function bi(f){if(d1(),W0(f))return[f];let n=f,e=1,_=[],X=2220446049250313e-31;for(;e<n;){d1();let K=f/e,ne=Math.floor(K);if(K-ne<=X&&e>1){if(W0(e)&&(E0.PRIMES_SET[e]||(E0.PRIMES.push(e),E0.PRIMES_SET[e]=!0),_.push(e)),W0(ne)){_.push(ne);break}n=ne}e++}return _.sort((K,ne)=>K-ne)}function J1(f){let n=E0.PRIMES[E0.PRIMES.length-1]||2;for(let e=n;e<f;e++)W0(e)&&E0.PRIMES.push(e),E0.PRIMES_SET[e]=!0}var p1={Settings:{}};function f0(f,n,e=void 0,_=void 0){let X=p1.Settings[f];p1.Settings[f]=e===void 0?!0:!!e;let K=n.call(_);return p1.Settings[f]=X,K}var wn={_:{parse:()=>{}}};function _t(f,n=void 0){return f0("PARSE2NUMBER",()=>wn._.parse(f,n),!0)}var ct={EXPRESSIONS:[],Settings:{EXPRESSION_DECP:5},LaTeX:{latex:()=>""},text:()=>"",variables:()=>[],isVector:()=>!1,isSymbol:()=>!1,isExpression:()=>!1,isNumericSymbol:()=>!1,isFraction:()=>!1,isArray:Xt,_:{parse:()=>{},add:()=>{},subtract:()=>{},multiply:()=>{},divide:()=>{},pow:()=>{},expand:()=>{}},Build:null};function jt(f){this.symbol=f}jt.getExpression=function(n,e=void 0){(n==="last"||!n)&&(n=ct.EXPRESSIONS.length),n==="first"&&(n=1);let _=Number(n)-1,X=ct.EXPRESSIONS[_];return X&&new jt(X)};jt.prototype={text(f="decimals",n=void 0){n||=ct.Settings.EXPRESSION_DECP;let e=this.symbol;return e.text_?e.text_(f):ct.text(this.symbol,f,void 0,n)},latex(f){return this.symbol.latex?this.symbol.latex(f):ct.LaTeX.latex(this.symbol,f)},valueOf(){return this.symbol.valueOf()},evaluate(...f){if(ct.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let n=f[0],e,_=1;typeof n=="string"?e=n.charAt(0)==="%"?jt.getExpression(n.substr(1)).text():n:n instanceof jt||ct.isSymbol(n)?e=n.text():(e=this.symbol.text(),_--);let X=f[_]||{};return new jt(f0("PARSE2NUMBER",()=>ct._.parse(e,X),!0))},buildFunction(f){return ct.Build.build(this.symbol,f)},isNumber(){return ct.isNumericSymbol(this.symbol)},isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0},isImaginary(){return _t(ct._.parse(this.symbol)).isImaginary()},variables(){return ct.variables(this.symbol)},toString(){try{return ct.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(f){if(f.message==="timeout")throw f;return""}},toDecimal(f){ct.Settings.precision=f;let n=ct.text(this.symbol,"decimals");return ct.Settings.precision=void 0,n},isFraction(){return ct.isFraction(this.symbol)},isPolynomial(){return this.symbol.isPoly()},sub(f,n){return new jt(this.symbol.sub(ct._.parse(f),ct._.parse(n)))},operation(f,n){return ct.isExpression(n)?n=n.symbol:ct.isSymbol(n)||(n=ct._.parse(n)),new jt(ct._[f](this.symbol.clone(),n.clone()))},add(f){return this.operation("add",f)},subtract(f){return this.operation("subtract",f)},multiply(f){return this.operation("multiply",f)},divide(f){return this.operation("divide",f)},pow(f){return this.operation("pow",f)},expand(){return new jt(ct._.expand(this.symbol))},each(f,n){if(this.symbol.each)this.symbol.each(f,n);else if(ct.isArray(this.symbol))for(let e=0;e<this.symbol.length;e++)f.call(this.symbol,this.symbol[e],e);else f.call(this.symbol)},eq(f){ct.isSymbol(f)||(f=ct._.parse(f));try{return ct._.subtract(this.symbol.clone(),f).equals(0)}catch(n){if(n.message==="timeout")throw n;return!1}},lt(f){ct.isSymbol(f)||(f=ct._.parse(f));try{return _t(ct._.subtract(this.symbol.clone(),f)).lessThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gt(f){ct.isSymbol(f)||(f=ct._.parse(f));try{return _t(ct._.subtract(this.symbol.clone(),f)).greaterThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gte(f){return this.gt(f)||this.eq(f)},lte(f){return this.lt(f)||this.eq(f)},numerator(){return new jt(this.symbol.getNum())},denominator(){return new jt(this.symbol.getDenom())},hasFunction(f){return this.symbol.containsFunction(f)},contains(f){return this.symbol.contains(f)}};jt.prototype.toTeX=jt.prototype.latex;var Ke={Frac:je,NerdamerSymbol:null,isVector:()=>!1,isArray:Xt,isMatrix:()=>!1,isSymbol:()=>!1,block:f0,_:null,Settings:{PRECISION:1e-14},text:()=>"",LaTeX:null};function At(f,...n){this.multiplier=new Ke.Frac(1),Ke.isVector(f)?this.elements=f.elements?.slice(0)??[]:Ke.isArray(f)?this.elements=f.slice(0):Ke.isMatrix(f)?f.elements.length===1?(this.elements=[...f.elements[0]],this.rowVector=!0):f.elements.length>1&&Array.isArray(f.elements[0])&&f.elements[0].length===1&&(this.elements=f.elements.map(e=>e[0]),this.rowVector=!1):typeof f>"u"?this.elements=[]:this.elements=[f,...n]}At.arrayPrefill=function(n,e){let _=[];e||=0;for(let X=0;X<n;X++)_[X]=e;return _};At.fromArray=function(n){let e=new At;return e.elements=n,e};At.fromSet=function(n){return At.fromArray(n.elements)};At.prototype={custom:!0,e(f){return f<1||f>this.elements.length?null:this.elements[f-1]},set(f,n){Ke.isSymbol(n)||(n=new Ke.NerdamerSymbol(n)),this.elements[f]=n},dimensions(){return this.elements.length},modulus(){return Ke.block("SAFE",()=>Ke._.pow(this.dot(this.clone()),new Ke.NerdamerSymbol(.5)),void 0,this)},eql(f){let n=this.elements.length,e=f.elements||f;if(n!==e.length)return!1;do if(Math.abs(Ke._.subtract(this.elements[n-1],e[n-1]).valueOf())>Ke.Settings.PRECISION)return!1;while(--n);return!0},clone(){let f=new At,n=this.elements.length;for(let e=0;e<n;e++)f.elements.push(this.elements[e].clone());return f.rowVector=this.rowVector,f},expand(f){return this.elements=this.elements.map(n=>Ke._.expand(n,f)),this},map(f){let n=[];return this.each((e,_)=>{n.push(f(e,_))}),new At(n)},each(f){let n=this.elements.length,e=n,_;do _=e-n,f(this.elements[_],_+1);while(--n)},toUnitVector(){return Ke.block("SAFE",()=>{let f=this.modulus();return f.valueOf()===0?this.clone():this.map(n=>Ke._.divide(n,f))},void 0,this)},angleFrom(f){return Ke.block("SAFE",()=>{let n=f.elements||f;if(this.elements.length!==n.length)return null;let _=new Ke.NerdamerSymbol(0),X=new Ke.NerdamerSymbol(0),K=new Ke.NerdamerSymbol(0);this.each((a,ae)=>{_=Ke._.add(_,Ke._.multiply(a,n[ae-1])),X=Ke._.add(X,Ke._.multiply(a,a)),K=Ke._.add(K,Ke._.multiply(n[ae-1],n[ae-1]))}),X=Ke._.pow(X,new Ke.NerdamerSymbol(.5)),K=Ke._.pow(K,new Ke.NerdamerSymbol(.5));let ne=Ke._.multiply(X,K);if(ne.valueOf()===0)return null;let Z=Ke._.divide(_,ne),J=Z.valueOf();return J<-1&&(Z=-1),J>1&&(Z=1),new Ke.NerdamerSymbol(Math.acos(Z))},void 0,this)},isParallelTo(f){let n=this.angleFrom(f).valueOf();return n===null?null:n<=Ke.Settings.PRECISION},isAntiparallelTo(f){let n=this.angleFrom(f).valueOf();return n===null?null:Math.abs(n-Math.PI)<=Ke.Settings.PRECISION},isPerpendicularTo(f){let n=this.dot(f);return n===null?null:Math.abs(n)<=Ke.Settings.PRECISION},add(f){return Ke.block("SAFE",()=>{let n=f.elements||f;return this.elements.length!==n.length?null:this.map((e,_)=>Ke._.add(e,n[_-1]))},void 0,this)},subtract(f){return Ke.block("SAFE",()=>{let n=f.elements||f;return this.elements.length!==n.length?null:this.map((e,_)=>Ke._.subtract(e,n[_-1]))},void 0,this)},multiply(f){return this.map(n=>n.clone()*f.clone())},x(f){return this.multiply(f)},dot(f){return Ke.block("SAFE",()=>{let n=f.elements||f,e=new Ke.NerdamerSymbol(0),_=this.elements.length;if(_!==n.length)return null;do e=Ke._.add(e,Ke._.multiply(this.elements[_-1],n[_-1]));while(--_);return e},void 0,this)},cross(f){let n=f.elements||f;if(this.elements.length!==3||n.length!==3)return null;let e=this.rowVector&&f.rowVector,_=this.elements;return Ke.block("SAFE",()=>{let X=new At([Ke._.subtract(Ke._.multiply(_[1],n[2]),Ke._.multiply(_[2],n[1])),Ke._.subtract(Ke._.multiply(_[2],n[0]),Ke._.multiply(_[0],n[2])),Ke._.subtract(Ke._.multiply(_[0],n[1]),Ke._.multiply(_[1],n[0]))]);return X.rowVector=e,X},void 0,this)},toUnitMultiplier(){return this},max(){let f=0,n=this.elements.length,e=n,_;do _=e-n,Math.abs(this.elements[_].valueOf())>Math.abs(f.valueOf())&&(f=this.elements[_]);while(--n);return f},magnitude(){let f=new Ke.NerdamerSymbol(0);return this.each(n=>{f=Ke._.add(f,Ke._.pow(n,new Ke.NerdamerSymbol(2)))}),Ke._.sqrt(f)},indexOf(f){let n=null,e=this.elements.length,_=e,X;do X=_-e,n===null&&this.elements[X].valueOf()===f.valueOf()&&(n=X+1);while(--e);return n},text_(f,n){let e=Ke.text(this,n);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},text(f,n){let e=Ke.text(this,n);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},toString(){return this.text()},latex(f){let n=[];for(let e=0;e<this.elements.length;e++)n.push(Ke.LaTeX.latex(this.elements[e],f));return`[${n.join(", ")}]`}};var at={Frac:je,NerdamerSymbol:null,Vector:At,isMatrix:()=>!1,isVector:()=>!1,isArray:Xt,isSymbol:()=>!1,block:f0,_:null,err:()=>{},LaTeX:null};function dt(...f){this.multiplier=new at.Frac(1);let n=f,e=n.length,_,X=[];if(at.isMatrix(n))for(_=0;_<e;_++)X.push(n[_].slice(0));else{let K,ne,Z;for(_=0;_<e;_++)K=n[_],at.isVector(K)&&(K=K.elements),at.isArray(K)||(K=[K]),Z=K.length,ne&&ne!==Z&&at.err("Unable to create Matrix. Row dimensions do not match!"),X.push(K),ne=Z}this.elements=X}dt.identity=function(n){let e=new dt;for(let _=0;_<n;_++){e.elements.push([]);for(let X=0;X<n;X++)e.set(_,X,_===X?new at.NerdamerSymbol(1):new at.NerdamerSymbol(0))}return e};dt.fromArray=function(n){function e(_){return dt.apply(this,_)}return e.prototype=dt.prototype,new e(n)};dt.zeroMatrix=function(n,e){let _=new dt;for(let X=0;X<n;X++)_.elements.push(at.Vector.arrayPrefill(e,new at.NerdamerSymbol(0)));return _};dt.prototype={custom:!0,get(f,n){if(this.elements[f])return this.elements[f][n]},map(f,n){let e=new dt;return this.each((_,X,K)=>{e.set(X,K,f.call(e,_),n)}),e},set(f,n,e,_){this.elements[f]||=[],_||at.isSymbol(e)?this.elements[f][n]=e:this.elements[f][n]=new at.NerdamerSymbol(e)},cols(){return this.elements[0].length},rows(){return this.elements.length},row(f){return!f||f>this.cols()?[]:this.elements[f-1]},col(f){let n=this.rows(),e=[];if(f>this.cols()||!f)return e;for(let _=0;_<n;_++)e.push(this.elements[_][f-1]);return e},eachElement(f){let n=this.rows(),e=this.cols(),_,X;for(_=0;_<n;_++)for(X=0;X<e;X++)f.call(this,this.elements[_][X],_,X)},determinant(){if(!this.isSquare())return null;let f=this.toRightTriangular(),n=f.elements[0][0],e=f.elements.length-1,_=e,X;do X=_-e+1,n=at._.multiply(n,f.elements[X][X]);while(--e);return n},isSquare(){return this.elements.length===this.elements[0].length},isSingular(){return this.isSquare()&&this.determinant()===0},augment(f){let n=this.rows(),e=f.rows();n!==e&&at.err("Cannot augment matrix. Rows don't match.");for(let _=0;_<n;_++)this.elements[_]=this.elements[_].concat(f.elements[_]);return this},clone(){let f=this.rows(),n=this.cols(),e=new dt;for(let _=0;_<f;_++){e.elements[_]=[];for(let X=0;X<n;X++){let K=this.elements[_][X];e.elements[_][X]=at.isSymbol(K)?K.clone():K}}return e},toUnitMultiplier(){return this},expand(f){return this.eachElement(n=>at._.expand(n,f)),this},evaluate(f){return this.eachElement(n=>at._.evaluate(n,f)),this},invert(){return this.isSquare()||at.err("Matrix is not square!"),at.block("SAFE",()=>{let f=this.elements.length,n=f,e,_,X=dt.identity(f),K=this.augment(X).toRightTriangular(),ne,Z=K.elements[0].length,J,a,ae,H=[],Ie;do{e=f-1,a=[],ne=Z,H[e]=[],ae=K.elements[e][e];do J=Z-ne,Ie=at._.divide(K.elements[e][J],ae.clone()),a.push(Ie),J>=n&&H[e].push(Ie);while(--ne);for(K.elements[e]=a,_=0;_<e;_++){a=[],ne=Z;do J=Z-ne,a.push(at._.subtract(K.elements[_][J].clone(),at._.multiply(K.elements[e][J].clone(),K.elements[_][e].clone())));while(--ne);K.elements[_]=a}}while(--f);return dt.fromArray(H)},void 0,this)},toRightTriangular(){return at.block("SAFE",()=>{let f=this.clone(),n,e,_,X=this.elements.length,K=X,ne,Z,J=this.elements[0].length,a;do{if(ne=K-X,e=f.elements[ne][ne],e.valueOf()===0){for(let ae=ne+1;ae<K;ae++)if(_=f.elements[ae][ne],_&&_.valueOf()!==0){n=[],Z=J;do a=J-Z,n.push(at._.add(f.elements[ne][a].clone(),f.elements[ae][a].clone()));while(--Z);f.elements[ne]=n;break}}if(e=f.elements[ne][ne],e.valueOf()!==0)for(let ae=ne+1;ae<K;ae++){let H=at._.divide(f.elements[ae][ne].clone(),f.elements[ne][ne].clone());n=[],Z=J;do a=J-Z,n.push(a<=ne?new at.NerdamerSymbol(0):at._.subtract(f.elements[ae][a].clone(),at._.multiply(f.elements[ne][a].clone(),H.clone())));while(--Z);f.elements[ae]=n}}while(--X);return f},void 0,this)},transpose(){let f=this.elements.length,n=this.elements[0].length,e=new dt,_=n,X,K,ne;do{X=n-_,e.elements[X]=[],K=f;do ne=f-K,e.elements[X][ne]=this.elements[ne][X].clone();while(--K)}while(--_);return e},canMultiplyFromLeft(f){let n=at.isMatrix(f)?f.elements.length:f.length;return this.elements[0].length===n},sameSize(f){return this.rows()===f.rows()&&this.cols()===f.cols()},multiply(f){return at.block("SAFE",()=>{let n=f.elements||f;if(!this.canMultiplyFromLeft(n)){if(this.sameSize(f)){let Ue=new dt,De=this.rows();for(let se=0;se<De;se++){let he=at._.multiply(new at.Vector(this.elements[se]),new at.Vector(f.elements[se]));Ue.elements[se]=he.elements}return Ue}return null}let e=this.elements.length,_=e,X,K,ne=n[0].length,Z,J=this.elements[0].length,a=[],ae,H,Ie;do{X=_-e,a[X]=[],K=ne;do{Z=ne-K,ae=new at.NerdamerSymbol(0),H=J;do Ie=J-H,ae=at._.add(ae,at._.multiply(this.elements[X][Ie],n[Ie][Z]));while(--H);a[X][Z]=ae}while(--K)}while(--e);return dt.fromArray(a)},void 0,this)},add(f,n){let e=new dt;return this.sameSize(f)&&this.eachElement((_,X,K)=>{let ne=at._.add(_.clone(),f.elements[X][K].clone());n&&(ne=n.call(e,ne,_,f.elements[X][K])),e.set(X,K,ne)}),e},subtract(f,n){let e=new dt;return this.sameSize(f)&&this.eachElement((_,X,K)=>{let ne=at._.subtract(_.clone(),f.elements[X][K].clone());n&&(ne=n.call(e,ne,_,f.elements[X][K])),e.set(X,K,ne)}),e},negate(){return this.each(f=>f.negate()),this},toVector(){if(this.rows()===1||this.cols()===1){let f=new at.Vector;return f.elements=this.elements,f}return this},toString(f,n){let e=this.rows(),_=[];f=f===void 0?`
`:f;for(let X=0;X<e;X++)_.push(`[${this.elements[X].map(K=>{let ne=n?K.multiplier.toDecimal():K.toString();return K===void 0?"":ne}).join(",")}]`);return`matrix${Gt(_.join(","))}`},text(){return`matrix(${this.elements.map(f=>`[${f.toString("")}]`)})`},latex(f){let n=this.cols(),{elements:e}=this;return bt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let _=[];for(let X in e){if(!Object.hasOwn(e,X))continue;let K=[];for(let ne=0;ne<n;ne++)K.push(at.LaTeX.latex(e[X][ne],f));_.push(K.join(" & "))}return _.join(" \\cr ")})}};dt.prototype.each=dt.prototype.eachElement;var e0={Math2:{},Frac:je,NerdamerSymbol:null,isInt:()=>!1,nround:(f,n)=>f,even:()=>!1,block:(f,n)=>n(),_:null,variables:()=>[],inBrackets:f=>`(${f})`,FN:5,N:1,S:3,P:2,EX:4,CB:7},o0={dependencies:{},reformat:{},getProperName(f){return{continuedFraction:"continuedFraction"}[f]||f},compileDependencies(f,n){let e=o0.dependencies[f],_=n&&n[1]?n[1]:"",X=n&&n[0]?n[0]:{};for(let K in e){if(typeof e[K]=="object")continue;let ne=K.split("."),Z=e[K];if(typeof Z=="function"){let J=Z.toString();!J.startsWith("function")&&!J.startsWith("(")&&!J.startsWith("async")&&(J=`function ${J}`),Z=J}_+=`let ${ne.length>1?ne[1]:ne[0]}=${Z};`,X[K]=ne.pop()}return[X,_]},getArgsDeps(f,n){let{args:e}=f,_=n,X=function(K){K.group===e0.FN&&(_=o0.compileDependencies(K.fname,_))};for(let K=0;K<e.length;K++)f.args[K].each(X);return _},build(f,n){let{Math2:e,NerdamerSymbol:_,block:X,_:K,variables:ne,inBrackets:Z,FN:J,N:a,S:ae,P:H,EX:Ie,CB:Ue}=e0;f=X("PARSE2NUMBER",()=>K.parse(f),!0);let De=ne(f),se=[],he=[],fe=function(Ge,ke){Ge.fname===""&&(Ge=_.unwrapPARENS(Ge)),ke||=[];let ye=[],{group:Re}=Ge,Se="",W=function(r){let d=r===Ue?"*":"+",S=[];for(let M in Ge.symbols){if(!Object.hasOwn(Ge.symbols,M))continue;let P=Ge.symbols[M],b=fe(P,ke)[0];P.isComposite()&&(b=Z(b)),S.push(b)}let v=S.join(d);return v=v&&!Ge.multiplier.equals(1)?Z(v):v,v},u=function(r){let d;if(r in Math)d=`Math.${r}`;else{if(r=o0.getProperName(r),se.indexOf(r)===-1){let S=e[r].toString();!S.startsWith("function")&&!S.startsWith("(")&&!S.startsWith("async")&&(S=`function ${S}`),ke.push(`let ${r} = ${S}; `),se.push(r)}d=r}return d+=Z(Ge.args.map(S=>fe(S,ke)[0]).join(",")),d};Re===a?ye.push(Ge.multiplier.toDecimal()):Ge.multiplier.equals(-1)?Se="-":Ge.multiplier.equals(1)||ye.push(Ge.multiplier.toDecimal());let g;if(Re===ae||Re===H)g=Ge.value;else if(Re===J)if(he=o0.compileDependencies(Ge.fname,he),he=o0.getArgsDeps(Ge,he),o0.reformat[Ge.fname]){let r=o0.reformat[Ge.fname](Ge,he);he=r[1],g=r[0]}else g=u(Ge.fname);else if(Re===Ie){let r=Ge.previousGroup;r===a||r===ae?g=Ge.value:r===J?(g=u(Ge.fname),he=o0.compileDependencies(Ge.fname,he),he=o0.getArgsDeps(Ge,he)):g=W(Ge.previousGroup)}else g=W(Ge.group);if(Ge.group!==a&&!Ge.power.equals(1)){let r=fe(K.parse(Ge.power));ke.push(r[1]),g=`Math.pow${Z(`${g},${r[0]}`)}`}return g&&ye.push(Se+g),[ye.join("*"),ke.join("").replace(/\n+\s+/gu," ")]};n&&(De=n);let j=fe(f);for(let Ge in he[0]){if(!Object.hasOwn(he[0],Ge))continue;let ke=he[0][Ge];j[1]=j[1].replace(Ge,ke),he[1]=he[1].replace(Ge,ke)}return new Function(...De,`${(he[1]||"")+j[1]} return ${j[0]};`)}},kt={_:null,isArray:()=>!1,isSymbol:()=>!1,isMatrix:()=>!1,isVector:()=>!1,isSet:()=>!1,isNegative:()=>!1,inBrackets:f=>`(${f})`,Settings:{},SQRT:"sqrt",ABS:"abs",PARENTHESIS:"parens",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",FN:5,S:3,P:2,N:1,CB:7,CP:8,EX:4,Parser:null},Et={parser:null,space:"~",dot:" \\cdot ",latex(f,n){let{_:e,isArray:_,isSymbol:X,isMatrix:K,isVector:ne,isSet:Z,isNegative:J,P:a,CB:ae}=kt;if(f.clone&&(f=f.clone()),f instanceof e.classes.Collection&&(f=f.elements),_(f)){let ke=[];for(let ye=0;ye<f.length;ye++){let Re=f[ye];X(Re)||(Re=e.parse(Re)),ke.push(this.latex(Re,n))}return this.brackets(ke.join(", "),"square")}if(K(f)){let ke=`\\begin{pmatrix}
`;for(let ye=0;ye<f.elements.length;ye++){let Re=[],Se=f.elements[ye];for(let W=0;W<Se.length;W++)Re.push(this.latex(Se[W],n));ke+=Re.join(" & "),ye<f.elements.length-1&&(ke+=`\\\\
`)}return ke+="\\end{pmatrix}",ke}if(ne(f)){let ke="\\left[";for(let ye=0;ye<f.elements.length;ye++)ke+=`${this.latex(f.elements[ye],n)} ${ye===f.elements.length-1?"":",\\,"}`;return ke+="\\right]",ke}if(Z(f)){let ke="\\{";for(let ye=0;ye<f.elements.length;ye++)ke+=`${this.latex(f.elements[ye],n)} ${ye===f.elements.length-1?"":",\\,"}`;return ke+="\\}",ke}f=f.clone();let H=n==="decimal"||n==="decimals",{power:Ie}=f,Ue=J(Ie),De=f.multiplier.lessThan(0);if(f.group===a&&H)return String(f.multiplier.toDecimal()*f.value**f.power.toDecimal());f.multiplier=f.multiplier.abs();let se;H?se=[String(f.multiplier.toDecimal()),""]:se=[f.multiplier.num,f.multiplier.den];let he=this.value(f,Ue,n,De),fe;Ue&&Ie.negate(),H?(fe=X(Ie)?Et.latex(Ie,n):String(Ie.toDecimal()),String(fe)==="1"&&(fe="")):X(Ie)?fe=this.latex(Ie,n):fe=this.formatFrac(Ie,!0);let j=["",""],xe=Ue?1:0;return j[xe]=fe,((De?"-":"")+this.set(se,he,j,f.group===ae)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(f,n,e,_){let{isSymbol:X,isNegative:K,Settings:ne,SQRT:Z,ABS:J,PARENTHESIS:a,FACTORIAL:ae,DOUBLEFACTORIAL:H,FN:Ie,S:Ue,P:De,N:se,CB:he,CP:fe,EX:j}=kt,{group:xe}=f,{previousGroup:Ge}=f,ke=["",""],ye=n?1:0;if(f.isInfinity)ke[ye]="\\infty";else if(xe===Ue||xe===De||Ge===Ue||Ge===De||Ge===se){let Re=this.formatSubscripts(f.value);Re.replace&&(Re=Re.replace(/(?<prefix>.+)_$/u,"$1\\_"));let Se=String(Re).split("_"),W=this.greek[Se[0]];W&&(Se[0]=W,Re=Se.join("_"));let u=this.symbols[Se[0]];u&&(Se[0]=u,Re=Se.join("_")),ke[ye]=Re}else if(xe===Ie||Ge===Ie){let Re=[],{fname:Se}=f;for(let W=0;W<f.args.length;W++){let u=f.args[W],g;typeof u=="string"?g=u:g=this.latex(u,e),Re.push(g)}if(Se===Z)ke[ye]=`\\sqrt${this.braces(Re.join(","))}`;else if(Se===J)ke[ye]=this.brackets(Re.join(","),"abs");else if(Se===a)ke[ye]=this.brackets(Re.join(","),"parens");else if(Se==="limit")ke[ye]=` \\lim\\limits_{${Re[1]} \\to ${Re[2]}} ${Re[0]}`;else if(Se==="integrate")ke[ye]=`\\int${this.braces(Re[0])}${this.braces(`d${Re[1]}`)}`;else if(Se==="defint")ke[ye]=`\\int\\limits_${this.braces(Re[1])}^${this.braces(Re[2])} ${Re[0]} d${Re[3]}`;else if(Se===ae||Se===H){let W=f.args[0];W.power.equals(1)&&(W.isComposite()||W.isCombination())&&(Re[0]=this.brackets(Re[0])),ke[ye]=Re[0]+(Se===ae?"!":"!!")}else if(Se==="floor")ke[ye]=`\\left \\lfloor${this.braces(Re[0])}\\right \\rfloor`;else if(Se==="ceil")ke[ye]=`\\left \\lceil${this.braces(Re[0])}\\right \\rceil`;else if(Se===ne.LOG&&Re.length>1)ke[ye]=`\\mathrm${this.braces(ne.LOG)}_${this.braces(Re[1])}${this.brackets(Re[0])}`;else if(Se===ne.LOG10)ke[ye]=`\\mathrm${this.braces(ne.LOG)}_${this.braces("10")}${this.brackets(Re[0])}`;else if(Se===ne.LOG2)ke[ye]=`\\mathrm${this.braces(ne.LOG)}_${this.braces("2")}${this.brackets(Re[0])}`;else if(Se===ne.LOG1P)ke[ye]=`\\ln${this.brackets(`1 + ${Re[0]}`)}`;else if(Se==="sum"){let W=Re[0],u=Re[1],g=Re[2],r=Re[3];ke[ye]=`\\sum\\limits_{${this.braces(u)}=${this.braces(g)}}^${this.braces(r)} ${this.braces(W)}`}else if(Se==="product"){let W=Re[0],u=Re[1],g=Re[2],r=Re[3];ke[ye]=`\\prod\\limits_{${this.braces(u)}=${this.braces(g)}}^${this.braces(r)} ${this.braces(W)}`}else if(Se==="nthroot")ke[ye]=`\\sqrt[${Re[1]}]${this.braces(Re[0])}`;else if(Se==="mod")ke[ye]=`${Re[0]} \\bmod ${Re[1]}`;else if(Se==="realpart")ke[ye]=`\\operatorname{Re}${this.brackets(Re[0])}`;else if(Se==="imagpart")ke[ye]=`\\operatorname{Im}${this.brackets(Re[0])}`;else{let W=Se===""?"":`\\mathrm${this.braces(Se.replace(/_/gu,"\\_"))}`;f.isConversion?ke[ye]=W+this.brackets(Re.join(""),"parens"):ke[ye]=W+this.brackets(Re.join(","),"parens")}}else if(f.isComposite()){let Re=f.collectSymbols().sort(xe===fe||Ge===fe?(g,r)=>r.group-g.group:(g,r)=>{let d=X(g.power)?-1:g.power;return(X(r.power)?-1:r.power)-d}),Se=[],W=Re.length;for(let g=0;g<W;g++)Se.push(Et.latex(Re[g],e));let u=Se.join("+");ke[ye]=!(f.isLinear()&&f.multiplier.equals(1))||_?this.brackets(u,"parens"):u}else if(xe===he||Ge===j||Ge===he){xe===he&&f.distributeExponent();let Re=[],Se=[],W=[],u=[],g=0,r=0,d=function(S,v,M){if(M>1&&v.length>0){let P=v.length;for(let b=0;b<P;b++){let R=v[b],B=S[R];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(B)||/^\\left\(.+\\right\)$/gu.test(B)||(S[R]=Et.brackets(B,"parens"))}}return S};f.each(S=>{let v=K(S.power),M;v?(M=Et.latex(S.invert(),e),r++,S.isComposite()&&(!f.multiplier.den.equals(1)&&Math.abs(S.power)===1&&(M=Et.brackets(M,"parens")),W.push(Re.length)),Re.push(M)):(M=Et.latex(S,e),g++,S.isComposite()&&(!f.multiplier.num.equals(1)&&Math.abs(S.power)===1&&(M=Et.brackets(M,"parens")),u.push(Se.length)),Se.push(M))}),d(Se,u,g),ke[0]=Se.join(this.dot),d(Re,W,r),ke[1]=Re.join(this.dot)}return ke},set(f,n,e,_){let X=function(Ie){return/^\\left\(.+\\right\)$/u.test(Ie)};e&&=this.formatP(e);let K;_&&(K=e[0],e[0]=""),n=this.merge(n,e);let ne=f[0],Z=f[1],J=n[0],a=n[1];J&&Number(ne)===1&&(ne=""),Number(Z)===1&&(Z="");let ae=this.join(ne,J,X(J)?"":this.dot),H=this.join(Z,a,X(a)?"":this.dot);if(ae&&H){let Ie=this.frac(ae,H);return _&&K&&(Ie=this.brackets(Ie)+K),Ie}return ae},merge(f,n){let e=[];for(let _=0;_<2;_++)e[_]=f[_]+n[_];return e},join(f,n,e){return!f&&!n?"":f&&!n?f:n&&!f?n:f+e+n},formatSubscripts(f){let n=f.toString().split("_"),e="";for(;n.length>1;)n.length>0&&(e=`_${this.braces(n.pop()+e)}`);return n[0]+e},formatP(f){for(let n=0;n<2;n++){let e=f[n];e&&(f[n]=`^${this.braces(e)}`)}return f},formatFrac(f,n){let e=f.num.toString(),_=f.den.toString();return n&&e==="1"&&_==="1"?"":_==="1"?e:this.frac(e,_)},frac(f,n){return`\\frac${this.braces(f)}${this.braces(n)}`},braces(f){return`{${f}}`},brackets(f,n){n||="parens";let _={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[n];return`\\left${_[0]}${f}\\right${_[1]}`},filterTokens(f){let{isArray:n}=kt,e=[];n(f)&&(e.type=f.type);let _=["\\","left","right","big","Big","large","Large"];for(let X=0,K=f.length;X<K;X++){let ne=f[X],Z=f[X+1];ne.value==="\\"&&Z.value==="\\"?e.push(ne):n(ne)?e.push(Et.filterTokens(ne)):_.indexOf(ne.value)===-1&&e.push(ne)}return e},parse(f){let{inBrackets:n,SQRT:e}=kt,_,X,K="",ne=this.filterTokens(f),Z={cdot:"",times:"",infty:"Infinity"},J=function(H){return ne[typeof H>"u"?++_:_+=H]},a=function(){return Et.parse(J())},ae=function(H){return H in Z?Z[H]:H==="*"&&ne[_+1].value==="&"?(J(2),","):H==="&"?(J(),","):H==="\\"?"],[":H};for(_=0,X=ne.length;_<X;_++){let H=ne[_];if(H.value==="frac"){let Ie=a(),Ue=a();K+=`${Ie}/${Ue}`}else if(H.value in Et.symbols)if(H.value===e&&ne[_+1].type==="vector"&&ne[_+2].type==="NerdamerSet"){let Ie=a(),Ue=a();K+=`${Ue}^${n(`1/${Ie}`)}`}else K+=H.value+a();else if(H.value==="int"){let Ie=a();_++;let Ue=J().value;Ue=ae(Ue.substring(1,Ue.length)),K+=`integrate${n(`${Ie},${Ue}`)}`}else if(H.value==="int_"){let Ie=a();_++;let Ue=J().value;Ue===void 0&&(_--,Ue=a());let De=a(),se=J().value;se===","&&(se=J().value),se==="differentialD"&&(_++,se=J().value),se==="mathrm"&&(_++,se=J().value),K+=`defint${n(`${De},${Ie},${Ue},${se}`)}`}else if(H.value&&H.value.startsWith("int_")){let Ie=H.value.replace("int_","");_++;let Ue=J().value;Ue===void 0&&(_--,Ue=a());let De=a(),se=J().value;se===","&&(se=J().value),se==="differentialD"&&(_++,se=J().value),se==="mathrm"&&(_++,se=J().value),K+=`defint${n(`${De},${Ie},${Ue},${se}`)}`}else if(H.value==="mathrm"){let Ie=ne[++_][0].value;K+=Ie+a()}else if(H.value==="sum_"||H.value==="prod_"){let Ie=H.value==="sum_"?"sum":"product",Ue=J();_++;let De=a(),se=a();K+=Ie+n([se,ae(Ue[0]),ae(Ue[2]),ae(De)].join(","))}else if(H.value==="lim_"){let Ie=J();K+=`limit${n([a(),ae(Ie[0]),ae(Ie[2])].join(","))}`}else if(H.value==="begin"){let Ie=J();Array.isArray(Ie)&&Ie[0].value==="matrix"&&(K+="matrix([")}else if(H.value==="end"){let Ie=J();Array.isArray(Ie)&&Ie[0].value==="matrix"&&(K+="])")}else Array.isArray(H)?K+=ae(Et.parse(H)):K+=ae(H.value.toString())}return n(K)}},w1={LONG_PI:"",LONG_E:""},Me={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",get LONG_PI(){return w1.LONG_PI},get LONG_E(){return w1.LONG_E},PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800},Sn=(function(n){let e="1.1.16",{bigInt:_}=n,{bigDec:X}=n;X.set({precision:250});let K={},{PRIMES:ne}=n.constants,{PRIMES_SET:Z}=n.constants,J={};w1.LONG_PI=n.constants.LONG_PI,w1.LONG_E=n.constants.LONG_E,(function(){Me.CACHE.roots={};let t=40,i=40;for(let h=2;h<=t;h++)for(let m=2;m<=i;m++){let y=_(h).pow(m);Me.CACHE.roots[`${y}-${m}`]=h}})(),Object.defineProperty(q0,"TIMEOUT",{get:()=>Me.TIMEOUT,configurable:!0});let a=null,ae=null,H=null,Ie=K.N=1,Ue=K.P=2,De=K.S=3,se=K.EX=4,he=K.FN=5,fe=K.PL=6,j=K.CB=7,xe=K.CP=8,Ge=Me.CONST_HASH="#",{PARENTHESIS:ke}=Me,{SQRT:ye}=Me,{ABS:Re}=Me,{FACTORIAL:Se}=Me,{DOUBLEFACTORIAL:W}=Me,u=[],g={},r=[],d=[],S=[];Object.defineProperty(mn,"suppress_errors",{get:()=>Me.suppress_errors,configurable:!0}),an.RESERVED=r,Q0.WARNINGS=d,Object.defineProperty(Q0,"SHOW_WARNINGS",{get:()=>Me.SHOW_WARNINGS,configurable:!0}),Object.defineProperty(un,"EXPRESSIONS",{get:()=>u,configurable:!0}),cn.Settings=Me,J0._version=e,Object.defineProperty(J0,"C",{get:()=>ae,configurable:!0}),g1.ALLOW_CHARS=Me.ALLOW_CHARS,g1.VALIDATION_REGEX=Me.VALIDATION_REGEX,dn.PRIMES_SET=Z,E0.PRIMES=ne,E0.PRIMES_SET=Z;let v=function(l){return H(l)?v(l.multiplier.toDecimal()):Number(l)%1!==0};H=function(l){return l instanceof p};let M=function(l){return l instanceof jt},P=function(l,t=null,i=null){if(i||={c:[],add(h){this.c.indexOf(h)===-1&&isNaN(h)&&this.c.push(h)}},H(l)){let{group:h}=l,m=l.previousGroup;if(h===se&&P(l.power,t,i),h===xe||h===j||m===xe||m===j)for(let y in l.symbols)Object.hasOwn(l.symbols,y)&&P(l.symbols[y],t,i);else if(h===De||m===De)l.value==="e"||l.value==="pi"||l.value===Me.IMAGINARY||i.add(l.value);else if(h===fe||m===fe)P(u1(l.symbols),t,i);else if(h===se)isNaN(Number(l.value))||i.add(l.value),P(l.power,t,i);else if(h===he&&!t&&l.args)for(let y=0;y<l.args.length;y++)P(l.args[y],t,i)}return i.c.sort()},b=function(l,t){let i=new p(0);for(let h=0;h<l.length;h++){let m=l[h];i=a.add(i,H(m)?m:a.parse(m))}return t?Number(i):i},R=function(l,t){l=a.expand(l),t||={};let i=function(h,m){t[h]||=new p(0),t[h]=a.add(t[h],m.clone())};return l.each(h=>{h.isConstant("all")?i("constants",h):h.group===De?i(h.value,h):h.group===he&&(h.fname===Re||h.fname==="")?R(h.args[0]):h.group===se||h.group===he||i(P(h).join(" "),h)}),t},B=function(l,t){t||=l.length;for(let i=0;i<t;i++)l[i]||(l[i]=new p(0));return l},Q=function(l){return l instanceof At},te=function(l){return l instanceof dt};h1.N=Ie,h1.P=Ue,on.S=De;let ue=function(l){return H(l)?l.multiplier.lessThan(0):l<0},qe=function(l,t,i){let m={},y;for(let I=0;I<i.length;I++)m[i[I]]=new p(Math.floor(Math.random()*5)+1);return f0("PARSE2NUMBER",()=>{y=a.parse(l,m).equals(a.parse(t,m))}),y},me=function(l,t,i){if(!t){let h=typeof l;if(h==="string"){let m=l;if(!/:?=/u.test(m))return!1;let y=Me.FUNCTION_REGEX.exec(m);if(!y)return!1;let[,I,x,C]=y;l=I,t=x.split(",").map(O=>O.trim()),i=C}else if(h==="function"){let m=l,y=m.name;return I0(y),f1(y)?!1:(ae.Math2[y]=m,a.functions[y]=[void 0,m.length],S.includes(y)||S.push(y),!0)}else return!1}return l=l.trim(),I0(l),f1(l)?!1:(t||=P(a.parse(i)),t=t.map(h=>h.trim()),a.functions[l]=[a.mappedFunction,t.length,{name:l,params:t,body:i}],S.includes(l)||S.push(l),!0)},Be=function(){for(let l of S)delete ae.Math2[l],delete a.functions[l]},Je=function(l){let t,i,h;if(l.group===he&&l.fname===""?(t=p.unwrapPARENS(a.parse(l).toLinear()),i=a.parse(l.power)):l.group===Ue&&(t=a.parse(l.value),i=a.parse(l.power)),t&&i&&t.group===Ie&&i.group===Ie&&t.multiplier.isNegative()){h=[];let y=p.toPolarFormArray(_t(l))[0],I=a.arg(t),x=i.multiplier.den.toString(),C=i.multiplier.num.toString(),O="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let D=0;D<Number(x);D++){let le=_t(a.parse(bt("(({0})+2*pi*({1}))/({2})",I,D,x))).multiplier.toDecimal();h.push(_t(a.parse(bt(O,y,x,Me.IMAGINARY,le,C))))}return At.fromArray(h)}if(l.isConstant(!0,!0)){let m=l.sign(),y=_t(l.abs()),I=a.sqrt(y);h=[I.clone(),I.negate()],m<0&&(h=h.map(x=>a.multiply(x,p.imaginary())))}else h=[a.parse(l)];return At.fromArray(h)},Ae=function(l,t,i){t=String(t);let h,m;if(l.group===xe){let x=a.expand(l.clone()).stripVar(t);h=a.subtract(l.clone(),x.clone()),m=x}else h=l.clone();let y=h.stripVar(t),I=a.divide(h.clone(),y.clone());return m||=new p(0),i?{a:y,x:I,ax:h,b:m}:[y,I,h,m]},Ve=function(l){let i="u",h=0,m=P(l);for(;!(r.indexOf(i)===-1&&m.indexOf(i)===-1);)i="u"+h++;for(let y=0,I=r.length;y<=I;y++)if(!r[y]){r[y]=i;break}return i};F0.RESERVED=r;let Ze=function(l){let t=P(l[0],null,null);for(let i=1,h=l.length;i<h;i++)t=t.concat(P(l[i]));return t=M1(t).sort(),t};L1.RESERVED=r,p1.Settings=Me;let it=function(){let l={};for(let t in a.functions)Object.hasOwn(a.functions,t)&&(l[t]=a.functions[t][0]);return l},Xe=function(l,t,i){let h=[];l.each(m=>{let y,I;m.contains(t)?(y=m.stripVar(t),I=a.divide(m.clone(),y.clone()).power.toDecimal()):(y=m,I=0);let x=h[I];h[I]=x?a.add(x,y):y},!0);for(let m=0;m<h.length;m++)h[m]||=new p(0);return h},Ye=function(l){if(Xt(l)){let t=new At([]);for(let i=0;i<l.length;i++)t.elements.push(Ye(l[i]));return t}return H(l)?l:a.parse(l)};ln.N=Ie;let rt=function(l){for(let t=0;t<l.length;t++)if(!(l[t].isPi()||l[t].isE())&&!l[t].isConstant(!0))return!1;return!0},Le=function(l,t,i){(t.isComposite()&&!l.isComposite()||t.isLinear()&&!l.isLinear())&&([l,t]=[t,l]);let h=new p(0);return l.isLinear()?l.each(m=>{if(t.isComposite())t.isLinear()?t.each(y=>{let I=a.multiply(a.parse(m),a.parse(y)),x=a.expand(a.parse(I),i);h=a.add(h,x)},!0):h=a.add(h,a.multiply(m,a.parse(t)));else{let y=a.multiply(a.parse(m),a.parse(t));h=a.add(h,a.expand(y,i))}},!0):h=a.multiply(l,t),h},F={DivisionByZero:A1,ParseError:G1,OutOfFunctionDomainError:_1,UndefinedError:i0,MaximumIterationsReached:ei,NerdamerTypeError:T1,ParityError:a1,OperatorError:P0,OutOfRangeError:ti,DimensionError:I1,InvalidVariableNameError:sn,ValueLimitExceededError:ni,NerdamerValueError:X1,SolveError:ii,InfiniteLoopError:ri,UnexpectedTokenError:H1},$={csc(l){return 1/Math.sin(l)},sec(l){return 1/Math.cos(l)},cot(l){return 1/Math.tan(l)},acsc(l){return Math.asin(1/l)},asec(l){return Math.acos(1/l)},acot(l){return Math.PI/2-Math.atan(l)},erf(l){let t=1/(1+.5*Math.abs(l)),i=1-t*Math.exp(-l*l-1.26551223+t*(1.00002368+t*(.37409196+t*(.09678418+t*(-.18628806+t*(.27886807+t*(-1.13520398+t*(1.48851587+t*(-.82215223+t*.17087277)))))))));return l>=0?i:-i},diff(l){return function(h){return(l(h+.001)-l(h-.001))/.002}},median(...l){l.sort((i,h)=>i-h);let t=Math.floor(l.length/2);return l.length%2?l[t]:(l[t-1]+l[t])/2},fromContinued(l){let t=l.fractions.slice(),i=1/t.pop();for(let h=0,m=t.length;h<m;h++)i=1/(t.pop()+i);return l.sign*(l.whole+i)},continuedFraction(l,t){t||=20;let i=Math.sign(l),h=Math.abs(l),m=Math.floor(h),y=h-m,I=0,x=!1,C=1e-14,O=1e7,D,le,ge={whole:m,sign:i,fractions:[]};for(;!x&&y!==0&&(D=1/y,le=Math.floor(D),!(le>O&&$.fromContinued(ge)-l<=Number.EPSILON));)ge.fractions.push(le),y=D-le,(y<=C||I>=t-1)&&(x=!0),I++;let de=ge.fractions.length-1;return ge.fractions[de]===1&&(ge.fractions.pop(),ge.fractions[--de]++),ge},bigpow(l,t){l instanceof je||(l=je.create(l)),t instanceof je||(t=je.create(t));let i=new je(0);if(t.isInteger())i.num=l.num.pow(t.toString()),i.den=l.den.pow(t.toString());else{let h=je.create(l.num**t.num),m=je.create(l.den**t.num);i.num=$.nthroot(h,t.den.toString()),i.den=$.nthroot(m,t.den)}return i},gamma(l){let i=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(l<.5)return Math.PI/(Math.sin(Math.PI*l)*$.gamma(1-l));l-=1;let h=i[0];for(let y=1;y<9;y++)h+=i[y]/(l+y);let m=l+7+.5;return Math.sqrt(2*Math.PI)*m**(l+.5)*Math.exp(-m)*h},bigfactorial(l){let t=new _(1);for(let i=2;i<=l;i++)t=t.times(i);return new je(t)},bigLog(l){let t=n.constants.BIG_LOG_CACHE;if(t[l])return je.quick.apply(null,t[l].split("/"));l=new je(l);let i=80,h=new je(0),m=l.subtract(new je(1)),y=l.add(new je(1));for(let I=0;I<i;I++){let x=new je(2*I+1),C=$.bigpow(m.divide(y),x),O=x.clone().invert().multiply(C);h=h.add(O)}return h.multiply(new je(2))},factorial(l){let t=l%1===0;if(t&&l<0)return NaN;if(!t)return $.gamma(l+1);let i=1;for(let h=2;h<=l;h++)i*=h;return i},dfactorial(l){let t=new je(1);if(vt(l)){let i=l%2===0,h=i?l/2:(l+1)/2;if(i)for(let m=1;m<=h;m++)t=t.multiply(new je(2).multiply(new je(m)));else for(let m=1;m<=h;m++)t=t.multiply(new je(2).multiply(new je(m)).subtract(new je(1)))}else t=2**((1+2*l-Math.cos(Math.PI*l))/4)*Math.PI**((Math.cos(Math.PI*l)-1)/4)*$.gamma(1+l/2);return t},GCD(...l){let t=M1(l.map(m=>Math.abs(m))).sort(),i=Math.abs(t.shift()),h=t.length;for(;h-- >0;){let m=Math.abs(t.shift());for(;;){if(i%=m,i===0){i=m;break}if(m%=i,m===0)break}}return i},QGCD(...l){let t=l[0];for(let i=1;i<l.length;i++){let h=l[i],m=t.isNegative()&&h.isNegative()?-1:1;t=h.gcd(t),m<0&&t.negate()}return t},LCM(l,t){return l*t/$.GCD(l,t)},pow(l,t){return l<0&&Math.abs(t)<1?1/t%2===0?NaN:-(Math.abs(l)**t):l**t},factor(l){l=Number(l);let t=Math.sign(l);l=Math.abs(l);let i=$.ifactor(l),h=new p;h.symbols={},h.group=j;for(let m in i){if(!Object.hasOwn(i,m))continue;let y=new p(1);y.group=Ue,y.value=m;let I=new p(i[m]);y.power=I,h.symbols[m]=y}return h.updateHash(),l===1&&(h=new p(l)),t<0&&h.negate(),h},sfactor(l,t){t||={};let i=Math.floor(Math.sqrt(l)),h=ne[ne.length-1];i>h&&l<1e6&&J1(i);let m=ne.length;for(let y=0;y<m;y++){let I=ne[y];for(;l%I===0;)l/=I,t[I]=(t[I]||0)+1}return l>1&&(t[l]=1),t},ifactor(l){let t=new _(l),i=new _(String(l));if(i.equals(0))return{0:1};let h=i.isNegative()?-1:1;i=i.abs();let m={};if(i.lt("65536"))m=$.sfactor(i,m);else{let y=function(I){I.isPrime()?m[I]=(m[I]||0)+1:m=$.sfactor(I,m)};try{let x={value:0},C=function(O,D,le){let ge=new _(O),de=2,be=new _(O),Ce=new _(1);for(;Ce.equals(1);){for(let Fe=0;Fe<=de&&Ce.equals(1);Fe++){if(le.value++>1e3)throw new Error("stopping");be=be.pow(2).add(1).mod(D),Ce=_.gcd(be.minus(ge).abs(),D)}de*=2,ge=be}return Ce.equals(D)?C(O+1,D,le):Ce};for(;!i.abs().equals(1);)if(i.isPrime()){y(i);break}else{let O=C(2,i,x);y(O),i=i.divide(O)}}catch(I){if(I.message==="timeout")throw I;m={},y(t)}}if(h===-1){let y=N1(R1(m));m[`-${y}`]=m[y],delete m[y]}return m},boxfactor(l,t){t||=200;let i,h,m=Math.floor(5/12*l),y=0,I=!1;for(;i=Math.floor(l/m),h=l%m,h!==0;){if(I)return[l,1];m=Math.max(h,m-h),y++,I=y>t}return[i,m,y]},fib(l){let t=Math.sign(l);l=Math.abs(l),t=Bt(l)?t:Math.abs(t);let i=0,h=1,m=1;for(let y=2;y<=l;y++)m=i+h,i=h,h=m;return m*t},mod(l,t){return l%t},integer_part(l){return Math.sign(l)*Math.floor(Math.abs(l))},simpson(l,t,i,h){let m=function(ge,de,be){let Ce=ge(de),Fe=1e-12;return isNaN(Ce)&&(Ce=ge(be===1?de+Fe:de-Fe)),Ce};h||=1e-4;let y=Math.abs(Math.floor((i-t)/h));y%2!==0&&y++;let I=(i-t)/y,x=m(l,t,1),C=!1,O=t+I,D,le;for(let ge=1;ge<y;ge++)D=C?2:4,le=D*m(l,O,1),x+=le,C=!C,O+=I;return(x+m(l,O,2))*(I/3)},num_integrate(l,t,i,h,m){if(m<0)throw new Error("max depth cannot be negative");function y(C,O,D,le,ge,de,be,Ce,Fe,He,Te){if(Te.nanEncountered)return NaN;let ze=D-O,st=C(O+ze*.25),gt=C(D-ze*.25);if(isNaN(st)){Te.nanEncountered=!0;return}if(isNaN(gt)){Te.nanEncountered=!0;return}let wt=ze*(le+4*st+ge)/12,$t=ze*(ge+4*gt+de)/12,ft=wt+$t,yt=(ft-be)/15;if(Te.maxDepthCount>1e3*Fe)return;if(He>Fe)return Te.maxDepthCount++,ft+yt;if(Math.abs(yt)<Ce)return ft+yt;let It=O+ze*.5,qt=y(C,O,It,le,st,ge,wt,Ce*.5,Fe,He+1,Te);if(isNaN(qt))return Te.nanEncountered=!0,NaN;let Pt=y(C,It,D,ge,gt,de,$t,Ce*.5,Fe,He+1,Te);return isNaN(Pt)?(Te.nanEncountered=!0,NaN):qt+Pt}function I(C,O,D,le,ge){let de={maxDepthCount:0,nanEncountered:!1};le===void 0&&(le=1e-9),ge===void 0&&(ge=45);let be=C(O),Ce=C(.5*(O+D)),Fe=C(D),He=(be+4*Ce+Fe)*(D-O)/6,Te=y(C,O,D,be,Ce,Fe,He,le,ge,1,de);if(de.maxDepthCount>0&&C1(`integrate-adaptive-simpson: Warning: maximum recursion depth (${ge}) reached ${de.maxDepthCount} times`),de.nanEncountered)throw new Error("Function does not converge over interval!");return Te}let x;try{x=I(l,t,i,h,m)}catch(C){if(C.message==="timeout")throw C;return $.simpson(l,t,i)}return _0(x,12)},Ci(l){let i=.5772156649015329,h=0;for(let m=1;m<20;m++){let y=2*m;h+=(-1)**m*l**y/(y*$.factorial(y))}return Math.log(l)+i+h},Si(l){let i=0;for(let h=0;h<20;h++){let m=2*h;i+=(-1)**h*l**(m+1)/((m+1)*$.factorial(m+1))}return i},Ei(l){if(Number(l)===0)return-1/0;let t=30,i=.5772156649015329,h=0;for(let m=1;m<t;m++)h+=l**m/(m*$.factorial(m));return i+Math.abs(Math.log(l))+h},Shi(l){let i=0,h,m;for(let y=0;y<30;y++)h=2*y,m=h+1,i+=l**m/(m*m*$.factorial(h));return i},Chi(l){let i=.5772156649015329,h=function(m){return(Math.cosh(m)-1)/m};return Math.log(l)+i+$.num_integrate(h,.002,l,.001)},Li(l){return $.Ei($.bigLog(l))},gamma_incomplete(l,t){let i=l-1,h=0,m=t||0;for(let y=0;y<i;y++)h+=m**y/$.factorial(y);return $.factorial(i)*Math.exp(-m)*h},step(l){return l>0?1:l<0?0:.5},rect(l){let t=Math.abs(l);return t===.5?t:t>.5?0:1},sinc(l){return l.equals(0)?1:Math.sin(l)/l},tri(l){return l=Math.abs(l),l>=1?0:1-l},nthroot(l,t){if(l instanceof je||(l=new je(l.toString())),t instanceof je||(t=new je(t.toString())),t.equals(1))return l;let i=l.divide(new je(2)),h=new je(1e-15),m,y,I,x=t.clone().invert(),C=t.subtract(new je(1));do{let O=$.bigpow(i,C),D=x.multiply(l.divide(O).subtract(i)).toDecimal(25);if(m=je.create(D),I)break;i=i.add(m),D=m.toDecimal(),I=y?y===D:!1,y=D}while(m.abs().gte(h));return i},sqrt(l){l instanceof je||(l=new je(l));let t,i,h,m,y=0,I=!1,x=new je(1e-20);t=l.divide(new je(2));let C=1e3;do{if(y>C)throw new Error(`Unable to calculate square root for ${l}`);t=t.add(l.divide(t)).divide(new je(2)),t=new je(t.decimal(30)),i=l.subtract(t.multiply(t)),m=h?h.equals(i):!1,(i.clone().abs().lessThan(x)||m)&&(I=!0),h=i,y++}while(!I);return t}};Me.FUNCTION_MODULES.push($),c1($),Math.sign||=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1},Math.cosh||=function(t){let i=Math.exp(t);return(i+1/i)/2},Math.sech||=function(t){return 1/Math.cosh(t)},Math.csch||=function(t){return 1/Math.sinh(t)},Math.coth||=function(t){return 1/Math.tanh(t)},Math.sinh||=function(t){let i=Math.exp(t);return(i-1/i)/2},Math.tanh||=function(t){if(t===1/0)return 1;if(t===-1/0)return-1;let i=Math.exp(2*t);return(i-1)/(i+1)},Math.asinh||=function(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))},Math.acosh||=function(t){return Math.log(t+Math.sqrt(t*t-1))},Math.atanh||=function(t){return Math.log((1+t)/(1-t))/2},Math.trunc||=function(t){return isNaN(t)?NaN:t>0?Math.floor(t):Math.ceil(t)};function G(l,t=void 0,i=void 0,h=void 0){let m=t==="hash",y,I=m?void 0:t,x=I==="decimal"||I==="decimals"||I==="decimals_or_scientific";I==="decimals_or_scientific"&&typeof h>"u"&&(h=Me.DEFAULT_DECP);function C(O,D){switch(t){case"decimals":case"decimal":return y||=function(le){return!1},D?O.toDecimal(D):O.valueOf();case"recurring":{y||=function(wt){return wt.indexOf("'")!==-1};let le=O.toString(),ge=/^-?\d+(?:\/\d+)?$/u.exec(le);if(ge.length===0)return le;let de=ge[0].split("/"),be=!1,Ce=Number(de[0]);Ce<0&&(Ce=-Ce,be=!0);let Fe=Number(de[1]);Fe||=1;let He=Math.floor(Ce/Fe),Te=10*(Ce-He*Fe);for(He=`${He.toString()}.`;Te&&Te<Fe;)Te*=10,He+="0";let ze="",st=[],gt=0;for(;;){if(typeof st[Te]<"u"){let ft=ze.slice(0,st[Te]),yt=ze.slice(st[Te]),It=`${He+ft}'${yt}'`;return(be?"-":"")+It.replace("'0'","").replace(/\.$/u,"")}let wt=Math.floor(Te/Fe),$t=Te-wt*Fe;st[Te]=gt,ze+=wt.toString(),gt+=1,Te=10*$t}}case"mixed":{y||=function(st){return st.indexOf("/")!==-1};let le=O.toString(),ge=/^-?\d+(?:\/\d+)?$/u.exec(le);if(ge.length===0)return le;let de=ge[0].split("/"),be=new _(de[0]),Ce=new _(de[1]);Ce.equals(0)&&(Ce=new _(1));let Fe=be.divmod(Ce),{quotient:He}=Fe,{remainder:Te}=Fe,ze=de[0][0]==="-"||He.equals(0)||Te.equals(0)?"":"+";return(He.equals(0)?"":He.toString())+ze+(Te.equals(0)?"":`${Te.toString()}/${de[1]}`)}case"scientific":return y||=function(le){return!1},new Ht(O.valueOf()).toString(Me.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{y||=function(de){return!1};let le=O.valueOf(),ge=new Ht(le);return Math.abs(ge.exponent)>=Me.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?ge.toString(Me.SCIENTIFIC_MAX_DECIMAL_PLACES):D?O.toDecimal(D):le}default:return y||=function(le){return le.indexOf("/")!==-1},O.toString()}}if(H(l)){let O="",D="",le="",ge=l.group||i,{value:de}=l;if(!m){let Te=C(l.multiplier);String(Te)==="-1"&&String(l.multiplier)==="-1"&&(le="-",Te="1"),String(Te)!=="1"&&(O=Te);let ze=l.power?C(l.power):"";String(ze)!=="1"&&(H(ze)?D=G(ze,I):D=ze)}switch(ge){case Ie:{O="";let Te;I==="decimals_or_scientific"?Te=C(l.multiplier,h):h&&x?Te=l.multiplier.toDecimal(h):Te=C(l.multiplier),de=String(l.multiplier)==="-1"?"1":Te,D="";break}case fe:de=l.collectSymbols().map(Te=>{let ze=G(Te,I,i,h);return ze==="0"&&(ze=""),ze}).sort().join("+").replace(/\+-/gu,"-");break;case xe:de=l.collectSymbols().map(Te=>{let ze=G(Te,I,i,h);return ze==="0"&&(ze=""),ze}).sort().join("+").replace(/\+-/gu,"-");break;case j:de=l.collectSymbols(Te=>{let ze=Te.group;return(ze===fe||ze===xe)&&Te.power.equals(1)&&Te.multiplier.equals(1)?Gt(G(Te,I)):G(Te,I)}).join("*");break;case se:{let Te=l.previousGroup,ze=l.power.group;Te===fe&&(de=l.collectSymbols(G,I).join("+").replace("+-","-")),!(Te===Ie||Te===De||Te===he)&&!m&&(de=Gt(de)),(ze===xe||ze===j||ze===fe||l.power.multiplier.toString()!=="1")&&D&&(D=Gt(D));break}}if(ge===he&&(de=l.fname+Gt(l.args.map(Te=>G(Te,I)).join(","))),ge===he&&l.fname in J){let Te=G(l.args[0]),ze=G(l.args[1]);l.args[0].isComposite()&&(Te=Gt(Te)),l.args[1].isComposite()&&(ze=Gt(ze)),de=Te+J[l.fname]+ze}let be=typeof y=="function"?y(D):!1;if(D&&ge!==se&&be&&(D=Gt(D)),((ge===xe||ge===fe)&&(O&&String(O)!=="1"||le==="-")||(ge===j||ge===xe||ge===fe)&&D&&String(D)!=="1"||!m&&ge===Ue&&String(de)==="-1"||l.fname===ke)&&(de=Gt(de)),h&&(t==="decimal"||(t==="decimals"||t==="decimals_or_scientific")&&O))if(O.toString().includes("e")){if(t!=="decimals_or_scientific"){let Te=Number(O),ze=Te.toExponential(),st=Te.toPrecision(h);O=ze.length<st.length?ze:st}}else O=_0(Number(O),h);let Ce=le+O,Fe=typeof y=="function"?y(O):!1;if(O&&Fe&&(Ce=Gt(Ce)),Number(D)<0&&(D=Gt(D)),O&&(Ce=`${Ce}*`),D){if(de==="e"&&Me.E_TO_EXP)return`${Ce}exp${Gt(D)}`;D=Me.POWER_OPERATOR+D}ge===se&&de.charAt(0)==="-"&&(de=Gt(de));let He=Ce+de;return l.parens&&(He=Gt(He)),He+D}if(Q(l)){let O=l.elements.length,D=[];for(let le=0;le<O;le++)D.push(l.elements[le].text(t));return`[${D.join(",")}]`}try{return l.toString()}catch(O){if(O.message==="timeout")throw O;return""}}ct.EXPRESSIONS=u,ct.Settings=Me,ct.LaTeX=Et,ct.text=G,ct.variables=P,ct.isVector=Q,ct.isSymbol=H,ct.isExpression=M,ct.isNumericSymbol=D0,ct.isFraction=v,ct.isArray=Xt,Ut.bigInt=_,Ut.bigDec=X,Ut.isInt=vt,Ut.scientificToDecimal=Z0,Ut.DivisionByZero=A1,Ut.Settings=Me;function p(l){d1();let t=l==="Infinity";if(!(this instanceof p))return new p(l);typeof l=="object"&&l!==null&&l instanceof X&&(l=l.toString());let i=String(l);return/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(i)||typeof l=="object"&&l!==null&&l instanceof X?(this.group=Ie,this.value=Ge,this.multiplier=new je(l)):(this.group=De,I0(l),this.value=l,this.multiplier=new je(1),this.imaginary=l===Me.IMAGINARY,this.isInfinity=t),this.power=new je(1),this.args=void 0,this.fname=void 0,this.isImgSymbol=void 0,this}p.imaginary=function(){let t=new p(Me.IMAGINARY);return t.imaginary=!0,t},p.infinity=function(t=void 0){let i=new p("Infinity");return t===-1&&i.negate(),i},p.shell=function(t,i){let h=new p(i);return h.group=t,h.symbols={},h.length=0,h},p.unwrapSQRT=function(t,i){let h=t.power;if(t.fname===ye&&(t.isLinear()||i)){let m=t.args[0].clone();m.power=m.power.multiply(new je(1/2)),m.multiplier=m.multiplier.multiply(t.multiplier),t=m,i&&(t.power=h.multiply(new je(1/2)))}return t},p.hyp=function(t,i){return t||=new p(0),i||=new p(0),a.sqrt(a.add(a.pow(t.clone(),new p(2)),a.pow(i.clone(),new p(2))))},p.toPolarFormArray=function(t){let i=t.realpart(),h=t.imagpart(),m=p.hyp(i,h),y=i.equals(0)?a.parse("pi/2"):a.trig.atan(a.divide(h,i));return[m,y]},p.unwrapPARENS=function(t){if(t.fname===""){let i=t.args[0];return i.power=i.power.multiply(t.power),i.multiplier=i.multiplier.multiply(t.multiplier),t.fname===""?p.unwrapPARENS(i):i}return t},p.create=function(t,i){return i=i===void 0?1:i,a.parse(`(${t})^(${i})`)},p.prototype={pushMinus(){let l=this;if((this.group===j||this.group===xe||this.group===fe)&&this.multiplier.lessThan(0)&&!Bt(this.power)){l=this.clone();let t=l.multiplier.clone();t.negate(),l.toUnitMultiplier();for(let i in l.symbols)if(Object.hasOwn(l.symbols,i)&&(l.symbols[i]=l.symbols[i].clone().negate(),l.group===j))break;l.length>0&&l.each(i=>i.pushMinus()),l=a.parse(l),l=a.multiply(a.parse(t),l)}return l},getNth(l){let t=_t(a.pow(a.parse(this.multiplier),a.parse(String(l)).invert())),i=a.parse(_0(t));return _t(a.pow(i,a.parse(String(l)))).equals(a.parse(this.multiplier))?i:t},isToNth(l){let t=this.getNth(l),i=vt(t),h;return this.group===j?(h=!0,this.each(m=>{m.isToNth(l)||(h=!1)})):h=this.group===Ie?!0:vt(a.divide(a.parse(this.power),a.parse(l))),i&&h},isSquare(){return this.isToNth(2)},isCube(){return this.isToNth(3)},isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)},powSimp(){if(this.group===j){let l=[],t=this.multiplier.sign();if(this.each(O=>{let D=O.power;H(D)||D.equals(1)||l.push(D)}),l.length===0)return this.clone();let i=new je(N1(l)),h=this.multiplier.clone().abs(),m=$.ifactor(h.valueOf()),y=new je(1),I=new je(1);for(let O in m){if(!Object.hasOwn(m,O))continue;let D=new je(m[O]);D.lessThan(i)||(D=D.divide(i).subtract(new je(1)),I=I.multiply(new je(O))),y=y.multiply(a.parse(`${Gt(O)}^${Gt(D)}`).multiplier)}let x=new p(I);this.each(O=>{O=O.clone(),O.power=O.power.divide(i),x=a.multiply(x,O)});let C=a.symfunction(ke,[x]);return C.power=i,C.multiplier=t<0?y.negate():y,C}return this.clone()},equals(l){let t;return H(l)?t=l:t=new p(l),this.value===t.value&&this.power.equals(t.power)&&this.multiplier.equals(t.multiplier)&&this.group===t.group},abs(){let l=this.clone();return l.multiplier.abs(),l},gt(l){return H(l)||(l=new p(l)),this.isConstant()&&l.isConstant()&&this.multiplier.greaterThan(l.multiplier)},gte(l){return H(l)||(l=new p(l)),this.equals(l)||this.isConstant()&&l.isConstant()&&this.multiplier.greaterThan(l.multiplier)},lt(l){return H(l)||(l=new p(l)),this.isConstant()&&l.isConstant()&&this.multiplier.lessThan(l.multiplier)},lte(l){return H(l)||(l=new p(l)),this.equals(l)||this.isConstant()&&l.isConstant()&&this.multiplier.lessThan(l.multiplier)},isPoly(l=!1){let t=this.group,i=this.power;if(!vt(i)||Number(i)<0)return!1;if(t===Ie||t===De||this.isConstant(!0))return!0;let h=P(this);if(t===j&&h.length===1){let m=h[0];if(!m)return!0;for(let y in this.symbols){if(!Object.hasOwn(this.symbols,y))continue;let I=this.symbols[y];if(I.group===he&&!I.args[0].isConstant()||!I.contains(m)&&!I.isConstant(!0))return!1}return!0}if(this.isComposite()||t===j&&l){if(!l&&h.length>1)return!1;for(let m in this.symbols)if(!this.symbols[m].isPoly(l))return!1;return!0}return!1},stripVar(l,t=!1){let i;return(this.group===fe||this.group===De)&&this.value===l?i=new p(t?0:this.multiplier):this.group===j&&this.isLinear()?(i=new p(1),this.each(h=>{h.contains(l,!0)||(i=a.multiply(i,h.clone()))}),i.multiplier=i.multiplier.multiply(this.multiplier)):this.group===xe&&!this.isLinear()?i=new p(this.multiplier):this.group===xe&&this.isLinear()?(i=new p(0),this.each(h=>{if(!h.contains(l)){let m=h.clone();m.multiplier=m.multiplier.multiply(this.multiplier),i=a.add(i,m)}}),i.equals(0)&&(i=new p(this.multiplier))):this.group===se&&this.power.contains(l,!0)?i=new p(this.multiplier):this.group===he&&this.contains(l)?i=new p(this.multiplier):i=this.clone(),i},toArray(l,t){t||={arr:[],add(h,m){let y=this.arr[m];this.arr[m]=y?a.add(y,h):h}};let i=this.group;if(i===De&&this.contains(l))t.add(new p(this.multiplier),this.power);else if(i===j){let h=this.stripVar(l),m=a.divide(this.clone(),h.clone()),y=m.isConstant()?0:m.power;t.add(h,y)}else if(i===fe&&this.value===l)this.each((h,m)=>{t.add(h.stripVar(l),m)});else if(i===xe)this.each(h=>{h.toArray(l,t)});else{if(this.contains(l))throw new T1("Cannot convert to array! Exiting");t.add(this.clone(),0)}t=t.arr;for(let h=0;h<t.length;h++)t[h]||=new p(0);return t},hasFunc(l){let t=this.group===he||this.group===se;if(t&&!l||t&&this.contains(l))return!0;if(this.symbols){for(let i in this.symbols)if(this.symbols[i].hasFunc(l))return!0}return!1},sub(l,t){l=H(l)?l.clone():a.parse(l),t=H(t)?t.clone():a.parse(t),(l.group===Ie||l.group===Ue)&&zt("Cannot substitute a number. Must be a variable");let i=!1,h=l.multiplier.equals(1),m=this.multiplier.clone(),y;if(this.value===l.value&&(this.group!==fe&&l.group!==fe||this.group===fe&&l.group===fe))(h||l.multiplier.equals(this.multiplier))&&(l.isLinear()?y=t:l.power.equals(this.power)&&(y=t,i=!0),l.multiplier.equals(this.multiplier)&&(m=new je(1)));else if(this.group===j||this.previousGroup===j)y=new p(1),this.each(I=>{let x=a.parse(I.sub(l,t));y=a.multiply(y,x)});else if(this.isComposite()){let I=this.clone();if(l.isComposite()&&I.isComposite()&&I.isLinear()&&l.isLinear()){let x=function(C,O){for(let D in C.symbols){if(!Object.hasOwn(C.symbols,D))continue;let le=C.symbols[D];if(le.isComposite()&&x(le,O)||le.equals(O))return!0}return!1};for(let C in l.symbols)if(Object.hasOwn(l.symbols,C)&&!x(I,l.symbols[C]))return I.clone();y=a.add(a.subtract(I.clone(),l),t)}else y=new p(0),I.each(x=>{y=a.add(y,x.sub(l,t))})}else if(this.group===se)y=a.parse(this.value).sub(l,t);else if(this.group===he){let I=[];for(let x=0;x<this.args.length;x++){let C=this.args[x];H(C)||(C=a.parse(C)),I.push(C.sub(l,t))}y=a.symfunction(this.fname,I)}if(y){if(!i){let I=this.group===se?this.power.sub(l,t):a.parse(this.power);y=a.pow(y,I)}return y.multiplier=y.multiplier.multiply(m),y}return this.clone()},isMonomial(){if(this.group===De)return!0;if(this.group===j){for(let l in this.symbols)if(this.symbols[l].group!==De)return!1}else return!1;return!0},isPi(){return this.group===De&&this.value==="pi"},sign(){return this.multiplier.sign()},isE(){return this.value==="e"},isSQRT(){return this.fname===ye},isConstant(l,t){if(t&&this.group===j){for(let i in this.symbols)if(this.symbols[i].isConstant(!0))return!0}if(l==="functions"&&this.isComposite()){let i=!0;return this.each(h=>{h.isConstant(l,t)||(i=!1)},!0),i}if(l==="all"&&(this.isPi()||this.isE()))return!0;if(l&&this.group===he){for(let i=0;i<this.args.length;i++)if(!this.args[i].isConstant(l))return!1;return!0}return l?D0(this):this.value===Ge},isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let l in this.symbols)if(this.symbols[l].isImaginary())return!0}return!1},realpart(){if(this.isConstant())return this.clone();if(this.imaginary)return new p(0);if(this.isComposite()){let l=new p(0);return this.each(t=>{l=a.add(l,t.realpart())}),l}return this.isImaginary()?new p(0):this.clone()},imagpart(){if(this.group===De&&this.isImaginary()){let l=this;return this.power.isNegative()&&(l=this.clone(),l.power.negate(),l.multiplier.negate()),new p(l.multiplier)}if(this.isComposite()){let l=new p(0);return this.each(t=>{l=a.add(l,t.imagpart())}),l}return this.group===j?this.stripVar(Me.IMAGINARY):new p(0)},isInteger(){return this.isConstant()&&this.multiplier.isInteger()},isLinear(l){if(l){if(this.isConstant()||!this.contains(l,!0))return!0;if(this.group===De)return this.value===l?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let t in this.symbols)if(!this.symbols[t].isLinear(l))return!1;return!0}return this.group===j?this.symbols[l]?this.symbols[l].isLinear(l):!0:!1}return this.power.equals(1)},containsFunction(l){if(typeof l=="string"&&(l=[l]),this.group===he&&l.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let t in this.symbols)if(this.symbols[t].containsFunction(l))return!0}return!1},multiplyPower(l){if(this.group===Ie&&this.multiplier.equals(1))return this;let t=this.power;if(this.group!==se&&H(l)&&l.group===Ie){let i=l.multiplier;this.group===Ie&&!i.isInteger()&&this.convert(Ue),this.power=t.equals(1)?i.clone():t.multiply(i),this.group===Ue&&vt(this.power)&&(this.value=Number(this.value)**Number(this.power),this.toLinear(),this.convert(Ie))}else{this.group!==se&&(t=new p(t),this.convert(se));let i=a.multiply(t,l);this.power=i}return this},setPower(l,t=!1){if(this.group===Ie&&this.multiplier.equals(1))return this;if(this.group===se&&!H(l))this.group=this.previousGroup,delete this.previousGroup,this.group===Ie?(this.multiplier=new je(this.value),this.value=Ge):this.power=l;else{let i=!1;H(l)&&(l.group===Ie?l=l.multiplier:i=!0);let h=i?se:Ue;this.power=l,this.group===Ie&&h&&this.convert(h,t)}return this},isInverse(){return this.group===se?this.power.multiplier.lessThan(0):Number(this.power)<0},clone(l=void 0){let t=this,i=l||new p(0),h=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],m=h.length,y;if(t.symbols){i.symbols={};for(let I in t.symbols)Object.hasOwn(t.symbols,I)&&(i.symbols[I]=t.symbols[I].clone())}for(y=0;y<m;y++)t[h[y]]!==void 0&&(i[h[y]]=t[h[y]]);return i.power=t.power.clone(),i.multiplier=t.multiplier.clone(),t.isConversion&&(i.isConversion=t.isConversion),t.isUnit&&(i.isUnit=t.isUnit),i},toUnitMultiplier(l=!1){return this.multiplier.num=new _(this.multiplier.num.isNegative()&&l?-1:1),this.multiplier.den=new _(1),this},toLinear(){return this.power.equals(1)?this:(this.setPower(new je(1)),this)},each(l,t=!1){if(this.symbols)for(let i in this.symbols){if(!Object.hasOwn(this.symbols,i))continue;let h=this.symbols[i];if(h.group===fe&&t)for(let m in h.symbols)Object.hasOwn(h.symbols,m)&&l.call(i,h.symbols[m],m);else l.call(this,h,i)}else l.call(this,this,this.value)},valueOf(){return this.group===Ie?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:G(this,"decimals")},contains(l,t=!1){l=String(l);let i=this.group;if(this.value===l)return!0;if(this.symbols){for(let h in this.symbols)if(this.symbols[h].contains(l,t))return!0}if(i===he||this.previousGroup===he){for(let h=0;h<this.args.length;h++)if(this.args[h].contains(l,t))return!0}return i===se&&(t&&this.power.contains(l,t)||this.value===l)?!0:this.value===l},negate(){return this.multiplier.negate(),(this.group===xe||this.group===fe)&&this.distributeMultiplier(),this},invert(l=!1,t=!1){return l||(this.multiplier=this.multiplier.invert()),H(this.power)?this.power.negate():this.group===j&&t?this.each(i=>i.invert()):this.power&&this.group!==Ie&&this.power.negate(),this},distributeMultiplier(l=!1){let t=l?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&t&&this.group!==j&&!this.multiplier.equals(1)){for(let i in this.symbols){if(!Object.hasOwn(this.symbols,i))continue;let h=this.symbols[i];h.multiplier=h.multiplier.multiply(this.multiplier),h.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent(){if(!this.power.equals(1)){let l=this.power;for(let t in this.symbols){if(!Object.hasOwn(this.symbols,t))continue;let i=this.symbols[t];i.group===se?i.power=a.multiply(i.power,new p(l)):H(this.symbols[t].power)?this.symbols[t].power=a.multiply(this.symbols[t].power,new p(l)):this.symbols[t].power=this.symbols[t].power.multiply(l)}this.toLinear()}return this},convert(l,t=void 0){if(l>he){let i=this.clone();this.symbols={},l===j?i.toUnitMultiplier():this.toUnitMultiplier(),this.group===he&&(i.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[i.keyForGroup(l)]=i,this.group=l,this.length=1}else if(l===se)this.group===Ie&&this.multiplier.equals(1)||(this.group!==se&&(this.previousGroup=this.group),this.group===Ie?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=G(this,"hash"),this.group=se);else if(l===Ie){let i=this.multiplier.toDecimal();this.symbols&&=void 0,new p(this.group===Ue?Number(i)*Number(this.value)**Number(this.power):i).clone(this)}else l===Ue&&this.group===Ie&&(this.value=t?this.multiplier.num.toString():Math.abs(Number(this.multiplier.num.toString())),this.toUnitMultiplier(!t),this.group=Ue);return this},insert(l,t){if(H(l)||zt(`Object ${l} is not of type NerdamerSymbol!`),this.symbols){let{group:i}=this;if(i>he){let h=l.keyForGroup(i),m=h in this.symbols?this.symbols[h]:!1;if(t==="add"){let y=h;m?(this.symbols[y]=a.add(m,l),this.symbols[y].multiplier.equals(0)&&(delete this.symbols[y],this.length--,this.length===0&&(this.convert(Ie),this.multiplier=new je(0)))):(this.symbols[h]=l,this.length++)}else l.group===Ue&&vt(l.power)&&l.convert(Ie),l.group===se?(l.parens=l.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(l.multiplier.clone().abs()),l.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(l.multiplier),l.toUnitMultiplier()),m&&(l=a.multiply(T0(this.symbols,h),l),l.isConstant()&&(this.multiplier=this.multiplier.multiply(l.multiplier),l=new p(1)),this.length--),l.isOne(!0)?l.multiplier.lessThan(0)&&this.negate():(this.symbols[h]=l,this.length++);this.length===0&&this.convert(Ie),(this.group===xe||this.group===j)&&this.updateHash()}}return this},attach(l){if(Xt(l)){for(let t=0;t<l.length;t++)this.insert(l[t],"add");return this}return this.insert(l,"add")},combine(l){if(Xt(l)){for(let t=0;t<l.length;t++)this.insert(l[t],"multiply");return this}return this.insert(l,"multiply")},updateHash(){if(this.group!==Ie)if(this.group===he){let l="",{args:t}=this,i=this.fname===ke;for(let m=0;m<t.length;m++)l+=(m===0?"":",")+G(t[m]);let h=i?"":this.fname;this.value=h+(i?l:Gt(l))}else this.group===De||this.group===fe||(this.value=G(this,"hash"))},keyForGroup(l){let t=this.group,i;if(t===Ie)i=this.value;else if(t===De||t===Ue)l===fe?i=this.power.toDecimal():i=this.value;else if(t===he)l===fe?i=this.power.toDecimal():i=G(this,"hash");else{if(t===fe)return l===j?i=G(this,"hash"):l===xe?this.power.equals(1)?i=this.value:i=Gt(G(this,"hash"))+Me.POWER_OPERATOR+this.power.toDecimal():l===fe?i=this.power.toString():i=this.value,i;t===xe?(l===xe&&(i=G(this,"hash")),l===fe?i=this.power.toDecimal():i=this.value):t===j?l===fe?i=this.power.toDecimal():i=G(this,"hash"):t===se&&(l===fe?i=G(this.power):i=G(this,"hash"))}return i},collectSymbols(l,t,i,h){let m=[];if(this.symbols)for(let y in this.symbols){if(!Object.hasOwn(this.symbols,y))continue;let I=this.symbols[y];h&&(I.group===fe||I.group===xe)?m=m.concat(I.collectSymbols()):m.push(l?l(I,t):I)}else m.push(this);return i===null&&(i=void 0),m.sort(i)},collectSummandSymbols(l,t,i,h){let m=[];if(!this.symbols||this.group===j)m.push(this);else for(let y in this.symbols){if(!Object.hasOwn(this.symbols,y))continue;let I=this.symbols[y];h&&(I.group===fe||I.group===xe)?m=m.concat(I.collectSymbols()):m.push(l?l(I,t):I)}return i===null&&(i=void 0),m.sort(i)},latex(l){return Et.latex(this,l)},text(l=void 0){return G(this,l)},isOne(l=!1){let t=l?"absEquals":"equals";return this.group===Ie?this.multiplier[t](1):this.power.equals(0)},isComposite(){let l=this.group,t=this.previousGroup;return l===xe||l===fe||t===fe||t===xe},isCombination(){let l=this.group,t=this.previousGroup;return l===j||t===j},lessThan(l){return this.multiplier.lessThan(l)},greaterThan(l){return H(l)||(l=new p(l)),!this.isConstant(!0)||!l.isConstant(!0)?!1:this.multiplier.greaterThan(l.multiplier)},getDenom(){let l,t;if(t=this.clone(),this.group===j&&this.power.lessThan(0)&&(t=a.expand(t)),t.power.lessThan(0)||t.group===se&&t.power.multiplier.lessThan(0)){let i=a.parse(t.multiplier.den);l=t.toUnitMultiplier(),l.power.negate(),l=a.multiply(i,l)}else if(t.group===j){l=a.parse(t.multiplier.den);for(let i in t.symbols){if(!Object.hasOwn(t.symbols,i))continue;let h=t.symbols[i];(Number(h.power)<0||h.group===se&&h.power.multiplier.lessThan(0))&&(l=a.multiply(l,t.symbols[i].clone().invert()))}}else l=a.parse(t.multiplier.den);return l},getNum(){let l,t;return t=this.clone(),t.group===j&&t.power.lessThan(0)&&(t=a.expand(t)),t.power.greaterThan(0)&&t.group!==j||t.group===se&&t.power.multiplier.greaterThan(0)?l=a.multiply(a.parse(t.multiplier.num),t.toUnitMultiplier()):t.group===j?(l=a.parse(t.multiplier.num),t.each(i=>{(Number(i.power)>0||i.group===se&&i.power.multiplier.greaterThan(0))&&(l=a.multiply(l,i.clone()))})):l=a.parse(t.multiplier.num),l},toString(){return this.text()}};function z(){let l=this,t={},i={names:[],actions:[]};function h(o,s){this.start=o,this.end=s}h.prototype.isConstant=function(){return this.start.isConstant()&&this.end.isConstant()},h.prototype.text=function(){return`${G(this.start)}:${G(this.end)}`};function m(o,s,c){if(this.type=s,this.value=o,c!==void 0&&(this.column=c+1),s===m.OPERATOR){let k=C[o];for(let U in k)Object.hasOwn(k,U)&&(this[U]=k[U])}else s===m.FUNCTION&&(this.precedence=m.MAX_PRECEDENCE,this.leftAssoc=!1)}m.prototype.toString=function(){return this.is_prefix?`\`${this.value}`:this.value},m.OPERATOR="OPERATOR",m.VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL",m.FUNCTION="FUNCTION",m.UNIT="UNIT",m.KEYWORD="KEYWORD",m.MAX_PRECEDENCE=999,this.classes={Collection:Ft,Slice:h,Token:m};let y={prec:void 0,cos(o,s){let c=a.parse(String(Math.cos(o)*Math.cosh(s))),k=a.parse(String(Math.sin(o)*Math.sinh(s)));return a.subtract(c,a.multiply(k,p.imaginary()))},sin(o,s){let c=a.parse(String(Math.sin(o)*Math.cosh(s))),k=a.parse(String(Math.cos(o)*Math.sinh(s)));return a.subtract(c,a.multiply(k,p.imaginary()))},tan(o,s){let c=a.parse(String(Math.sin(2*o)/(Math.cos(2*o)+Math.cosh(2*s)))),k=a.parse(String(Math.sinh(2*s)/(Math.cos(2*o)+Math.cosh(2*s))));return a.add(c,a.multiply(k,p.imaginary()))},sec(o,s){let c=this.removeDen(this.cos(o,s));return a.subtract(c[0],a.multiply(c[1],p.imaginary()))},csc(o,s){let c=this.removeDen(this.sin(o,s));return a.add(c[0],a.multiply(c[1],p.imaginary()))},cot(o,s){let c=this.removeDen(this.tan(o,s));return a.subtract(c[0],a.multiply(c[1],p.imaginary()))},acos(o,s){let c=this.fromArray([o,s]),k=a.pow(c.clone(),new p(2)),U=a.expand(k),ce=a.multiply(Ct(a.subtract(new p(1),U)),p.imaginary()),ie=a.expand(a.add(c.clone(),ce)),ee=re(ie);return a.expand(a.multiply(p.imaginary().negate(),ee))},asin(o,s){return a.subtract(a.parse("pi/2"),this.acos(o,s))},atan(o,s){if(o.equals(0)&&(s.equals(1)||s.equals(-1)))return a.parse(`${p.infinity()}*${Me.IMAGINARY}*${s}`);let c=y.fromArray([o,s]),k=a.expand(a.multiply(p.imaginary(),c.clone())),U=re(a.expand(a.subtract(new p(1),k.clone()))),ce=re(a.expand(a.add(new p(1),k.clone())));return a.expand(a.multiply(a.divide(p.imaginary(),new p(2)),a.subtract(U,ce)))},asec(o,s){let c=this.removeDen([o,s]);return c[1].negate(),this.acos(...c)},acsc(o,s){let c=this.removeDen([o,s]);return c[1].negate(),this.asin(...c)},acot(o,s){let c=this.removeDen([o,s]);return c[1].negate(),this.atan(...c)},cosh(o,s){let c=a.parse(String(Math.cosh(o)*Math.cos(s))),k=a.parse(String(Math.sinh(o)*Math.sin(s)));return a.add(c,a.multiply(k,p.imaginary()))},sinh(o,s){let c=a.parse(String(Math.sinh(o)*Math.cos(s))),k=a.parse(String(Math.cosh(o)*Math.sin(s)));return a.add(c,a.multiply(k,p.imaginary()))},tanh(o,s){let c=a.parse(String(Math.sinh(2*o)/(Math.cos(2*s)+Math.cosh(2*o)))),k=a.parse(String(Math.sin(2*s)/(Math.cos(2*s)+Math.cosh(2*o))));return a.subtract(c,a.multiply(k,p.imaginary()))},sech(o,s){let c=this.removeDen(this.cosh(o,s));return a.subtract(c[0],a.multiply(c[1],p.imaginary()))},csch(o,s){let c=this.removeDen(this.sinh(o,s));return a.subtract(c[0],a.multiply(c[1],p.imaginary()))},coth(o,s){let c=this.removeDen(this.tanh(o,s));return a.add(c[0],a.multiply(c[1],p.imaginary()))},acosh(o,s){let c=this.fromArray([o,s]),k=Ct(a.add(c.clone(),new p(1))),U=Ct(a.subtract(c.clone(),new p(1)));return a.expand(re(a.add(c,a.expand(a.multiply(k,U)))))},asinh(o,s){let c=this.fromArray([o,s]),k=Ct(a.add(new p(1),a.expand(a.pow(c.clone(),new p(2)))));return a.expand(re(a.add(c,k)))},atanh(o,s){let c=this.fromArray([o,s]),k=re(a.add(c.clone(),new p(1))),U=re(a.subtract(new p(1),c));return a.expand(a.divide(a.subtract(k,U),new p(2)))},asech(o,s){let c=this.removeDen([o,s]);return c[1].negate(),this.acosh(...c)},acsch(o,s){let c=this.removeDen([o,s]);return c[1].negate(),this.asinh(...c)},acoth(o,s){let c=this.removeDen([o,s]);return c[1].negate(),this.atanh(...c)},sqrt(o){let s=o.realpart(),c=o.imagpart(),k=p.hyp(s,c),U=a.add(s.clone(),k),ce=Ct(a.multiply(new p(2),U.clone()));return a.add(a.divide(U.clone(),ce.clone()),a.multiply(a.divide(c,ce),p.imaginary()))},log(o,s){let c=re(p.hyp(o,s)),k=Me.USE_BIG?new p(X.atan2(s.multiplier.toDecimal(),o.multiplier.toDecimal())):Math.atan2(s,o),U=a.parse(k);return a.add(c,a.multiply(p.imaginary(),U))},erf(o,s){return a.symfunction("erf",[o])},removeDen(o){let s,c;Xt(o)?(s=o[0],c=o[1]):(s=o.realpart(),c=o.imagpart());let k=s**2+c**2,U=a.parse(String(s/k)),ce=a.parse(String(c/k));return[U,ce]},fromArray(o){return a.add(o[0],a.multiply(p.imaginary(),o[1]))},evaluate(o,s){let c,k,U=o.power.sign();if(o.power=o.power.abs(),o.power.greaterThan(1)&&(o=a.expand(o)),U<0){let ce=this.removeDen(o);c=ce[0],k=ce[1]}else c=o.realpart(),k=o.imagpart();return c.isConstant("all")&&k.isConstant("all")?this[s](c,k):a.symfunction(s,[o])}},I=this.trig={cos(o){if(o.equals("pi")&&o.multiplier.den.equals(2))return new p(0);if(Me.PARSE2NUMBER){if(o.equals(new p(Me.PI/2)))return new p(0);if(o.isConstant())return Me.USE_BIG?new p(X.cos(o.multiplier.toDecimal())):new p(Math.cos(o.valueOf()));if(o.isImaginary())return y.evaluate(o,"cos")}if(o.equals(0))return new p(1);let s,c=!1,k=Oe(o.multiplier.toDecimal()),U=o.multiplier.abs();if(o.multiplier=U,o.isPi()&&o.isLinear())if(vt(U))s=new p(Bt(U)?1:-1);else{let ce=Number(U.num),ie=Number(U.den);ie===2?s=new p(0):ie===3?(s=a.parse("1/2"),c=!0):ie===4?(s=a.parse("1/sqrt(2)"),c=!0):ie===6?(s=a.parse("sqrt(3)/2"),c=!0):s=a.symfunction("cos",[o])}return c&&(k===2||k===3)&&s.negate(),s||=a.symfunction("cos",[o]),s},sin(o){if(Me.PARSE2NUMBER){if(o.isConstant())return Number(o.multiplier.toDecimal())%Math.PI===0?new p(0):Me.USE_BIG?new p(X.sin(o.multiplier.toDecimal())):new p(Math.sin(o.valueOf()));if(o.isImaginary())return y.evaluate(o,"sin")}if(o.equals(0))return new p(0);let s,c=!1,k=Oe(o.multiplier.toDecimal()),U=o.multiplier.sign(),ce=o.multiplier.abs();if(o.multiplier=ce,o.equals("pi"))s=new p(0);else if(o.isPi()&&o.isLinear())if(vt(ce))s=new p(0);else{let ie=ce.num,ee=ce.den;ee.equals(2)?(s=new p(1),c=!0):ee.equals(3)?(s=a.parse("sqrt(3)/2"),c=!0):ee.equals(4)?(s=a.parse("1/sqrt(2)"),c=!0):ee.equals(6)?(s=a.parse("1/2"),c=!0):s=a.multiply(new p(U),a.symfunction("sin",[o]))}return s||=a.multiply(new p(U),a.symfunction("sin",[o])),c&&(k===3||k===4)&&s.negate(),s},tan(o){if(Me.PARSE2NUMBER){if(Number(o.multiplier.toDecimal())%Math.PI===0&&o.isLinear())return new p(0);if(o.isConstant())return Me.USE_BIG?new p(X.tan(o.multiplier.toDecimal())):new p(Math.tan(o.valueOf()));if(o.isImaginary())return y.evaluate(o,"tan")}let s,c=!1,k=Oe(o.multiplier.toDecimal()),U=o.multiplier;if(o.multiplier=U,o.isPi()&&o.isLinear())if(vt(U))s=new p(0);else{let ce=U.num,ie=U.den;if(ie.equals(2))throw new i0(`tan is undefined for ${o.toString()}`);ie.equals(3)?(s=a.parse("sqrt(3)"),c=!0):ie.equals(4)?(s=new p(1),c=!0):ie.equals(6)?(s=a.parse("1/sqrt(3)"),c=!0):s=a.symfunction("tan",[o])}return s||=a.symfunction("tan",[o]),c&&(k===2||k===4)&&s.negate(),s},sec(o){if(Me.PARSE2NUMBER)return o.isConstant()?Me.USE_BIG?new p(new X(1).dividedBy(X.cos(o.multiplier.toDecimal()))):new p($.sec(o.valueOf())):o.isImaginary()?y.evaluate(o,"sec"):a.parse(bt("1/cos({0})",o));let s,c=!1,k=Oe(o.multiplier.toDecimal()),U=o.multiplier.abs();if(o.multiplier=U,o.isPi()&&o.isLinear())if(vt(U))s=new p(Bt(U)?1:-1);else{let ce=U.num,ie=U.den;if(ie.equals(2))throw new i0(`sec is undefined for ${o.toString()}`);ie.equals(3)?(s=new p(2),c=!0):ie.equals(4)?(s=a.parse("sqrt(2)"),c=!0):ie.equals(6)?(s=a.parse("2/sqrt(3)"),c=!0):s=a.symfunction("sec",[o])}return c&&(k===2||k===3)&&s.negate(),s||=a.symfunction("sec",[o]),s},csc(o){if(Me.PARSE2NUMBER)return o.isConstant()?Me.USE_BIG?new p(new X(1).dividedBy(X.sin(o.multiplier.toDecimal()))):new p($.csc(o.valueOf())):o.isImaginary()?y.evaluate(o,"csc"):a.parse(bt("1/sin({0})",o));let s,c=!1,k=Oe(o.multiplier.toDecimal()),U=o.multiplier.sign(),ce=o.multiplier.abs();if(o.multiplier=ce,o.isPi()&&o.isLinear()){if(vt(ce))throw new i0(`csc is undefined for ${o.toString()}`);{let ie=ce.num,ee=ce.den;ee.equals(2)?(s=new p(1),c=!0):ee.equals(3)?(s=a.parse("2/sqrt(3)"),c=!0):ee.equals(4)?(s=a.parse("sqrt(2)"),c=!0):ee.equals(6)?(s=new p(2),c=!0):s=a.multiply(new p(U),a.symfunction("csc",[o]))}}return s||=a.multiply(new p(U),a.symfunction("csc",[o])),c&&(k===3||k===4)&&s.negate(),s},cot(o){if(Me.PARSE2NUMBER)return Number(o.multiplier.toDecimal())%(Math.PI/2)===0?new p(0):o.isConstant()?Me.USE_BIG?new p(new X(1).dividedBy(X.tan(o.multiplier.toDecimal()))):new p($.cot(o.valueOf())):o.isImaginary()?y.evaluate(o,"cot"):a.parse(bt("1/tan({0})",o));let s,c=!1,k=Oe(o.multiplier.toDecimal()),U=o.multiplier;if(o.multiplier=U,o.isPi()&&o.isLinear()){if(vt(U))throw new i0(`cot is undefined for ${o.toString()}`);{let ce=U.num,ie=U.den;ie.equals(2)?s=new p(0):ie.equals(3)?(s=a.parse("1/sqrt(3)"),c=!0):ie.equals(4)?(s=new p(1),c=!0):ie.equals(6)?(s=a.parse("sqrt(3)"),c=!0):s=a.symfunction("cot",[o])}}return s||=a.symfunction("cot",[o]),c&&(k===2||k===4)&&s.negate(),s},acos(o){if(Me.PARSE2NUMBER){if(o.isConstant()){if(o.gt(1)||o.lt(-1)){let s=o.toString();return ot(_t(`pi/2-asin(${s})`))}return Me.USE_BIG?new p(X.acos(o.multiplier.toDecimal())):new p(Math.acos(o.valueOf()))}if(o.isImaginary())return y.evaluate(o,"acos")}return a.symfunction("acos",[o])},asin(o){if(Me.PARSE2NUMBER){if(o.isConstant()){if(o.gt(1)||o.lt(-1)){let s=Me.IMAGINARY,c=o.multiplier.toDecimal();return ot(_t(`${s}*log(sqrt(1-${c}^2)-${s}*${c})`))}return Me.USE_BIG?new p(X.asin(o.multiplier.toDecimal())):new p(Math.asin(o.valueOf()))}if(o.isImaginary())return y.evaluate(o,"asin")}return a.symfunction("asin",[o])},atan(o){let s;if(o.equals(0))s=new p(0);else{if(Me.PARSE2NUMBER)return o.isConstant()?Me.USE_BIG?new p(X.atan(o.multiplier.toDecimal())):new p(Math.atan(o.valueOf())):o.isImaginary()?y.evaluate(o,"atan"):a.symfunction("atan",[o]);o.equals(-1)?s=a.parse("-pi/4"):s=a.symfunction("atan",[o])}return s},asec(o){if(Me.PARSE2NUMBER){if(o.equals(0))throw new _1("Input is out of the domain of sec!");if(o.isConstant())return I.acos(o.invert());if(o.isImaginary())return y.evaluate(o,"asec")}return a.symfunction("asec",[o])},acsc(o){if(Me.PARSE2NUMBER){if(o.isConstant())return I.asin(o.invert());if(o.isImaginary())return y.evaluate(o,"acsc")}return a.symfunction("acsc",[o])},acot(o){if(Me.PARSE2NUMBER){if(o.isConstant())return a.add(a.parse("pi/2"),I.atan(o).negate());if(o.isImaginary())return y.evaluate(o,"acot")}return a.symfunction("acot",[o])},atan2(o,s){if(o.equals(0)&&s.equals(0))throw new i0("atan2 is undefined for 0, 0");return Me.PARSE2NUMBER&&o.isConstant()&&s.isConstant()?new p(Math.atan2(o,s)):a.symfunction("atan2",[o,s])}},x=this.trigh={cosh(o){if(Me.PARSE2NUMBER){if(o.isConstant())return new p(Math.cosh(o.valueOf()));if(o.isImaginary())return y.evaluate(o,"cosh")}return a.symfunction("cosh",[o])},sinh(o){if(Me.PARSE2NUMBER){if(o.isConstant())return new p(Math.sinh(o.valueOf()));if(o.isImaginary())return y.evaluate(o,"sinh")}return a.symfunction("sinh",[o])},tanh(o){if(Me.PARSE2NUMBER){if(o.isConstant())return new p(Math.tanh(o.valueOf()));if(o.isImaginary())return y.evaluate(o,"tanh")}return a.symfunction("tanh",[o])},sech(o){return Me.PARSE2NUMBER?o.isConstant()?new p(Math.sech(o.valueOf())):o.isImaginary()?y.evaluate(o,"sech"):a.parse(bt("1/cosh({0})",o)):a.symfunction("sech",[o])},csch(o){return Me.PARSE2NUMBER?o.isConstant()?new p(Math.csch(o.valueOf())):o.isImaginary()?y.evaluate(o,"csch"):a.parse(bt("1/sinh({0})",o)):a.symfunction("csch",[o])},coth(o){return Me.PARSE2NUMBER?o.isConstant()?new p(Math.coth(o.valueOf())):o.isImaginary()?y.evaluate(o,"coth"):a.parse(bt("1/tanh({0})",o)):a.symfunction("coth",[o])},acosh(o){let s;return Me.PARSE2NUMBER&&o.isImaginary()?s=y.evaluate(o,"acosh"):Me.PARSE2NUMBER?s=_t(a.parse(bt(`${Me.LOG}(({0})+sqrt(({0})^2-1))`,o.toString()))):s=a.symfunction("acosh",[o]),s},asinh(o){let s;return Me.PARSE2NUMBER&&o.isImaginary()?s=y.evaluate(o,"asinh"):Me.PARSE2NUMBER?s=_t(a.parse(bt(`${Me.LOG}(({0})+sqrt(({0})^2+1))`,o.toString()))):s=a.symfunction("asinh",[o]),s},atanh(o){let s;return Me.PARSE2NUMBER&&o.isImaginary()?s=y.evaluate(o,"atanh"):Me.PARSE2NUMBER?s=_t(a.parse(bt(`(1/2)*${Me.LOG}((1+({0}))/(1-({0})))`,o.toString()))):s=a.symfunction("atanh",[o]),s},asech(o){let s;return Me.PARSE2NUMBER&&o.isImaginary()?s=y.evaluate(o,"asech"):Me.PARSE2NUMBER?s=_t(re(a.add(o.clone().invert(),Ct(a.subtract(a.pow(o,new p(-2)),new p(1)))))):s=a.symfunction("asech",[o]),s},acsch(o){let s;return Me.PARSE2NUMBER&&o.isImaginary()?s=y.evaluate(o,"acsch"):Me.PARSE2NUMBER?s=_t(a.parse(bt(`${Me.LOG}((1+sqrt(1+({0})^2))/({0}))`,o.toString()))):s=a.symfunction("acsch",[o]),s},acoth(o){let s;return Me.PARSE2NUMBER&&o.isImaginary()?s=y.evaluate(o,"acoth"):Me.PARSE2NUMBER?o.equals(1)?s=p.infinity():s=_t(a.divide(re(a.divide(a.add(o.clone(),new p(1)),a.subtract(o.clone(),new p(1)))),new p(2))):s=a.symfunction("acoth",[o]),s}};this.units={};let C={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(o){return o}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(o){return a.symfunction(Me.DOUBLEFACTORIAL,[o])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(o){return ze(o)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(o){return a.divide(o,new p(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},O={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},D=this.functions={cos:[I.cos,1],sin:[I.sin,1],tan:[I.tan,1],sec:[I.sec,1],csc:[I.csc,1],cot:[I.cot,1],acos:[I.acos,1],asin:[I.asin,1],atan:[I.atan,1],arccos:[I.acos,1],arcsin:[I.asin,1],arctan:[I.atan,1],asec:[I.asec,1],acsc:[I.acsc,1],acot:[I.acot,1],atan2:[I.atan2,2],acoth:[x.acoth,1],asech:[x.asech,1],acsch:[x.acsch,1],sinh:[x.sinh,1],cosh:[x.cosh,1],tanh:[x.tanh,1],asinh:[x.asinh,1],sech:[x.sech,1],csch:[x.csch,1],coth:[x.coth,1],acosh:[x.acosh,1],atanh:[x.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[It,1],radians:[qt,1],degrees:[Pt,1],min:[Y,-1],max:[T,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[yt,1],tri:[void 0,1],sign:[oe,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[ze,1],factorial:[ze,1],continuedFraction:[st,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[Ee,[1,2]],scientific:[a0,[1,2]],mod:[wt,2],pfactor:[ut,1],vector:[G0,-1],matrix:[c0,-1],NerdamerSet:[$0,-1],imatrix:[n0,-1],parens:[He,-1],sqrt:[Ct,1],cbrt:[l0,1],nthroot:[v0,2],log:[re,[1,2]],expand:[Nt,1],abs:[Te,1],invert:[In,1],determinant:[k0,1],size:[X0,1],transpose:[_n,1],dot:[Jt,2],cross:[Lt,2],vecget:[Dt,2],vecset:[Tt,3],vectrim:[u0,[1,2]],matget:[Qt,3],matset:[C0,4],matgetrow:[U0,2],matsetrow:[h0,3],matgetcol:[V0,2],matsetcol:[x0,3],rationalize:[w0,1],IF:[$t,3],isIn:[ft,2],realpart:[i1,1],imagpart:[r1,1],conjugate:[w,1],arg:[N,1],polarform:[E,1],rectform:[A,1],sort:[pe,[1,2]],integer_part:[void 0,1],union:[qn,2],contains:[Cn,2],intersection:[On,2],difference:[Tn,2],intersects:[Rn,2],isSubset:[Ln,2],primes:[Un,2],print:[xn,-1]};this.error=zt;let le=function(o){let s=Me.FUNCTION_MODULES,c=s.length;for(let k=0;k<c;k++){let U=s[k];if(o in U)return U[o]}return zt(`The function ${o} is undefined!`)};this.override=function(s,c){t[s]||=[],t[s].push(this[s]),this[s]=c},this.restore=function(s){this[s]&&=t[s].pop()},this.extend=function(s,c,k){let U=this;if(typeof this[s]=="function"&&typeof c=="function"){let ie=this[s];this[s]=function(Ne,ve){return H(Ne)&&H(ve)&&!k?ie.call(U,Ne,ve):c.call(U,Ne,ve,ie)}}},this.symfunction=function(s,c){let k=new p(s);return k.group=he,typeof c=="object"&&(c=[].slice.call(c)),k.args=c,k.fname=s===ke?"":s,k.updateHash(),k},this.callfunction=function(s,c,k=void 0){let U=D[s];U||zt(`Nerdamer currently does not support the function ${s}`);let ce=U[1]||k,ie=U[0],ee;if(c instanceof Array||(c=c===void 0?[]:[c]),ce!==-1){let ve=Xt(ce),_e=ve?ce[0]:ce,we=ve?ce[1]:ce,We=c.length,ht=`${s} requires a {0} of {1} arguments. {2} provided!`;We<_e&&zt(bt(ht,"minimum",_e,We)),We>we&&zt(bt(ht,"maximum",we,We))}let Ne=O1(c);return ie?ee=ie.apply(U[2],c):(ie=le(s),Me.PARSE2NUMBER&&Ne?ee=Pe(ie.apply(ie,c)):ee=a.symfunction(s,c)),ee},this.operator_filter_regex=(function(){let s=`^\\${Object.keys(C).filter(c=>c.length===1).join("\\")}`;return new RegExp(`([${s}])\\s+([${s}])`)})(),this.setOperator=function(s,c=void 0,k=void 0){let U=s.operator;if(C[U]=s,c&&(this[s.action]=c),l[U]=s.operation,!s.action&&!(s.prefix||s.postif)&&(s.action=U),k==="over"||k==="under"){let{precedence:ce}=s;for(let ie in C){if(!Object.hasOwn(C,ie))continue;let ee=C[ie];(k==="over"?ee.precedence>=ce:ee.precedence>ce)&&ee.precedence++}}},this.getOperator=function(s){return C[s]},this.aliasOperator=function(s,c){let k={},U=C[s];for(let ce in U)Object.hasOwn(U,ce)&&(k[ce]=U[ce]);k.operator=c,this.setOperator(k)},this.getOperators=function(){return C},this.getBrackets=function(){return O};let ge=function(s,c){s=String(s);for(let k=0;k<i.actions.length;k++)s=i.actions[k].call(c,s);for(s=s.replace(/\s+/gu," "),/e/giu.test(s)&&(s=s.replace(/-+\d+\.?\d*e\+?-?\d+/giu,k=>Z0(k)),s=s.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,k=>Z0(k))),s=s.replace(Me.IMPLIED_MULTIPLICATION_REGEX,(k,U,ce,ie,ee)=>{let Ne=ee.charAt(ie),ve="",_e="*";return Ne.match(/[+\-/*]/u)||(ve=ee.charAt(ie-1)),ve.match(/[a-z]/iu)&&(_e=""),U+_e+ce}).replace(/(?<varname>[a-z0-9_]+)/giu,(k,U)=>Me.USE_MULTICHARACTER_VARS===!1&&!(U in D)&&isNaN(U)?U.split("").join("*"):U).replace(/\)\(/gu,")*(")||"0";;){let k=s;if(s=s.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,(U,ce,ie,ee,Ne)=>{let ve=ce||ee,_e=ie||Ne;return ve in D?ve+_e:`${ve}*${_e}`}),k===s)break}return s};this.initConstants=function(){this.CONSTANTS={E:new p(Me.E),PI:new p(Me.PI)}},this.prettyPrint=function(s){if(Array.isArray(s)){let c=s,k=c.map(U=>a.prettyPrint(U)).join(", ");return c.type==="vector"?`vector<${k}>`:`(${k})`}return s.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(s,...c){if(Me.callPeekers){let k=this.peekers[s],U=c.map(Vn);for(let ce=0;ce<k.length;ce++)k[ce].apply(null,U)}},this.tokenize=function(s){s=String(s),s=s.trim().replace(/\s+/gu," ");for(let mt in O){if(!Object.hasOwn(O,mt))continue;let Ot=new RegExp(O[mt].is_close?`\\s+\\${mt}`:`\\${mt}\\s+`,"g");s=s.replace(Ot,mt)}let c=0,k=s.length,U=0,ce=[],ie=[ce],ee=ie[0],Ne=0,ve=[],_e=!1,we,We=" ",ht="",St=",",Qe="-",$e="*",tt=function(mt=void 0,Ot=void 0){let Rt=[];mt!==void 0&&(Rt.type=mt),Rt.column=Ot,ie.push(Rt),ee.push(Rt),ee=Rt,Ne++},et=function(){ie.pop(),ee=ie[--Ne]},lt=function(mt){mt=mt===void 0?c:mt;let Ot=mt+1;for(;s.charAt(Ot++)in C;);return s.substring(mt,Ot-1)},Mt=function(mt){let Ot=c-mt.length,Rt=[],Kt=mt.charAt(0),j0=mt.length,A0;for(A0=1;A0<j0;A0++){let $1=mt.charAt(A0),k1=Kt+$1;k1 in C?Kt=k1:(Rt.push(new m(Kt,m.OPERATOR,Ot+A0)),Kt=$1)}return Rt.push(new m(Kt,m.OPERATOR,Ot+A0)),Rt},pt=function(mt,Ot=void 0){Ot===void 0&&(Ot=s.substring(U,mt)),Ot in a.units?ee.push(new m(Ot,m.UNIT,U)):Ot!==""&&ee.push(new m(Ot,m.VARIABLE_OR_LITERAL,U))},xt=function(mt){ee.push(new m(mt,m.FUNCTION,U))},Yt=function(mt){U=mt+1},S0=function(){U=U+we.length-2,c=U-1};for(;c<k;c++){let mt=s.charAt(c);if(mt in C){pt(c);let Rt=ee[0]&&nn(ee[0])&&mt===$e;_e&&U<c&&!(mt===St||Rt)&&(_e=!1,et()),Yt(c+1),we=lt(c),S0(),ee.push(...Mt(we))}else if(mt in O){let Ot=O[mt];if(Ot.is_open){ve.push([Ot,U]);let Rt=s.substring(U,c);Rt in D?xt(Rt):Rt!==""&&ee.push(new m(Rt,m.VARIABLE_OR_LITERAL,U)),tt(Ot.maps_to,c)}else if(Ot.is_close){let Rt=ve.pop();if(Rt){if(Rt[0].id!==Ot.id-1)throw new a1("Parity error")}else throw new a1(`Missing open bracket for bracket at: ${c+1}`);pt(c),et()}Yt(c)}else if(mt===We){let Ot=s.substring(U,c),Rt=s.charAt(c+1);if(_e){if(Ot in C)ee.push(new m(Ot,m.OPERATOR,c));else{pt(void 0,Ot),et();let Kt=Rt in C;(Kt&&C[Rt].value===Qe||!Kt)&&ee.push(new m($e,m.OPERATOR,c))}_e=!1}else{let Kt=s.substring(U,c);Kt in D?(_e=!0,xt(Kt),tt()):Kt in C?ee.push(new m(Kt,m.OPERATOR,c)):(pt(void 0,Kt),Rt=s.charAt(c+1),Ot!==ht&&Rt!==ht&&!(Ot in C)&&!(Rt in C)&&ee.push(new m($e,m.OPERATOR,c)))}Yt(c)}}if(ve.length){let mt=ve.pop();throw new a1(`Missing closed bracket for bracket at ${mt[1]+1}`)}return pt(c),ce},this.toRPN=function(s){let c=s.type,k=s.length,U,ce,ie=[],ee=[],Ne=[],ve=function(we,We){for(;we.length;)We.push(we.pop())};for(U=0;U<k;U++){let _e=s[U];if(_e.type!==m.OPERATOR)break;if(!_e.prefix)throw new P0("Not a prefix operator");_e.is_prefix=!0,ee.push(_e)}for(;U<k;U++){if(ce=s[U],ce.type===m.OPERATOR){let _e=ce;if(_e.overloaded){let we=s[U+1];we&&we.type===m.VARIABLE_OR_LITERAL&&(_e.postfix=!1,_e.action=_e.overloadAction,_e.leftAssoc=_e.overloadLeftAssoc)}for(;ee.length;){let we=ee[ee.length-1];if(!(we.precedence>_e.precedence||!_e.leftAssoc&&we.precedence===_e.precedence))break;ie.push(ee.pop())}if((c==="vector"||c==="set")&&"vectorFn"in _e&&(_e.action=_e.vectorFn),_e.postfix){let we=s[U-1];if(we){if(we.type===m.OPERATOR&&!we.postfix)throw new P0(`Unexpected prefix operator '${we.value}'! at ${we.column}`)}else throw new P0(`Unexpected prefix operator '${ce.value}'! at ${ce.column}`)}else{let we;do{let We=s[U+1];if(we=We?We.type===m.OPERATOR:!1,we){if(!We.prefix)throw new P0(`A prefix operator was expected at ${We.column}`);We.is_prefix=!0,Ne.push(We),U++}}while(we)}for(_e.is_prefix?Ne.push(_e):ee.push(_e);Ne.length&&(_e.leftAssoc||!_e.leftAssoc&&Ne[Ne.length-1].precedence>=_e.precedence);)ee.push(Ne.pop())}else if(ce.type===m.VARIABLE_OR_LITERAL){ie.length===0&&ve(Ne,ee),ie.push(ce);let _e=ee[ee.length-1];(!_e||!_e.leftAssoc)&&ve(Ne,ie)}else ce.type===m.FUNCTION?ee.push(ce):ce.type===m.UNIT&&ie.push(ce);if(Array.isArray(ce)){let _e=ce;ie.push(this.toRPN(ce)),_e.type&&ie.push(new m(_e.type,m.FUNCTION,_e.column))}}return ve(ee,ie),ve(Ne,ie),ie},this.parseRPN=function(s,c){try{c||={};for(let ie in c)Object.hasOwn(c,ie)&&(c[ie]=a.parse(c[ie],{}));Me.PARSE2NUMBER&&("e"in c||(c.e=new p(Me.E)),"pi"in c||(c.pi=new p(Me.PI)));let k=[],U;for(let ie=0,ee=s.length;ie<ee;ie++)if(U=s[ie],Array.isArray(U)&&(U=this.parseRPN(U,c)),U)if(U.type===m.OPERATOR)if(U.is_prefix||U.postfix)k.push(U.operation(k.pop()));else{let Ne=k.pop(),ve=k.pop();if(typeof ve>"u")throw new P0(`${U} is not a valid postfix operator at ${U.column}`);let _e=U.action==="comma";ve instanceof d0&&!_e&&(ve=At.fromSet(ve)),Ne instanceof d0&&!_e&&(Ne=At.fromSet(Ne)),this.callPeekers("pre_operator",ve,Ne,U);let we=a[U.action](ve,Ne);this.callPeekers("post_operator",we,ve,Ne,U),k.push(we)}else if(U.type===m.FUNCTION){let Ne=k.pop(),{parent:ve}=Ne;Ne instanceof Ft||(Ne=Ft.create(Ne));let _e=U.value,we=Ne.getItems();this.callPeekers("pre_function",_e,we);let We=a.callfunction(_e,we);this.callPeekers("post_function",We,_e,we);let ht=k[k.length-1],St=s[ie+1],Qe=St&&St.type===m.OPERATOR&&St.value===",";ve&&(We.parent=ve),k.push(We)}else{let Ne,ve=U.value;if(ve in Me.ALIASES)U=a.parse(Me.ALIASES[U]);else if(U.type===m.VARIABLE_OR_LITERAL)U=new p(ve);else if(U.type===m.UNIT){let _e=new p(ve);_e.isUnit=!0,U=_e}ve in a.CONSTANTS?(Ne=U,U=new p(a.CONSTANTS[ve])):ve in c&&ve!==c[ve].toString()?(Ne=U,U=c[ve].clone()):ve in g&&(Ne=U,U=g[ve].clone()),Ne&&(U.subbed=Ne),k.push(U)}let ce=k[0];if(["undefined","string","number"].indexOf(typeof ce)!==-1)throw new H1("Unexpected token!");return ce}catch(k){if(k.message==="timeout")throw k;[_1].forEach(ie=>{if(k instanceof ie){let ee=k.column;throw new ie(`${k.message}${ee?`: ${ee}`:""}`)}});let ce=k.column;throw new G1(`${k.message}${ce?`: ${ce}`:""}`)}};function de(o){this.type=o.type,this.value=o.value,this.left=o.left,this.right=o.right}de.prototype.toString=function(){let s=this.left?`${this.left.toString()}---`:"",c=this.right?`---${this.right.toString()}`:"";return`${s}(${this.value})${c}`},de.prototype.toHTML=function(s,c){s||=0,c=typeof c>"u"?4:c;let k=function(Ne){return" ".repeat(c*Ne)},U="",ce=this.left?`${k(s+1)}<li>
${this.left.toHTML(s+2,c)}${k(s+1)}</li> 
`:"",ie=this.right?`${k(s+1)}<li>
${this.right.toHTML(s+2,c)}${k(s+1)}</li>
`:"";return U=`${k(s)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${k(s)}
`,(ce||ie)&&(U+=`${k(s)}<ul>
${ce}${ie}${k(s)}</ul>
`),U},this.tree=function(s){let c=[];for(let k=0;k<s.length;k++){let U=s[k];if(Array.isArray(U)){U=this.tree(U),c.push(U);continue}if(U.type===m.OPERATOR)if(U.is_prefix||U.postfix){let ce=U.is_prefix?"left":"right",ie=c.pop();U=new de(U),U[ce]=ie,c.push(U)}else U=new de(U),U.right=c.pop(),U.left=c.pop(),c.push(U);else if(U.type===m.FUNCTION){U=new de(U);let ce=c.pop();if(U.right=ce,U.value==="object"){let ie=c[c.length-1];if(ie){for(;ie.right;)ie=ie.right;ie.right=U;continue}}c.push(U)}else c.push(new de(U))}return c[0]},this.parse=function(s,c){s=ge(s,this),c||={};let k=this.tokenize(s),U=this.toRPN(k);return this.parseRPN(U,c)},this.toObject=function(s){return function k(U){let ce=[];for(let ie=0,ee=U.length;ie<ee;ie++){let Ne=U[ie],ve=Ne.value;if(Ne.type===m.VARIABLE_OR_LITERAL)ce.push(new p(ve));else if(Ne.type===m.FUNCTION){ie++;let _e=a.symfunction(ve,k(U[ie]));_e.isConversion=!0,ce.push(_e)}else Ne.type===m.OPERATOR?ce.push(ve):ce.push(k(Ne))}return ce}(a.tokenize(s))};let be=function(s){let c=0,k=[[]];for(let U=0,ce=s.length;U<ce;U++)s[U]===","?(c++,k[c]=[]):k[c].push(s[U]);return k},Ce=function(o){return o.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(s,c)=>c||s)},Fe=function(o){let s=[];for(;o.length;){let c=o.shift(),k=o[0],U=Xt(k),ce=k==="-";if(c==="^"&&(k==="+"?o.shift():U&&k[0]==="+"&&k.shift(),U&&k.length===1&&o.unshift(o.shift()[0])),c==="^"&&(U&&k[0]==="-"||ce)){let ie=s.pop(),ee=s[s.length-1],Ne="1";ee==="*"?(s.pop(),Ne=s.pop()):Xt(ee)&&(Ne=s.pop()),s.push(Ne,"/",ie,c),U?k.shift():o.shift(),U&&k.length===1&&s.push(o.shift()[0])}else s.push(c)}return s};this.toTeX=function(s,c){c||={};let k=c.decimals===!0?"decimals":void 0,U=typeof s=="string"?this.toObject(s):s,ce=[],ie=typeof c.cdot>"u"?"\\cdot":c.cdot;if(U=Fe(U),Xt(U)){let ee=[],Ne,ve;for(let _e=0;_e<U.length;_e++)Ne=U[_e],U[_e+1]==="^"?(ve=U[_e+2],ee.push(`${Et.braces(this.toTeX([Ne]))}^${Et.braces(this.toTeX([ve]))}`),_e+=2):ee.push(Ne);U=ee}for(let ee=0,Ne=U.length;ee<Ne;ee++){let ve=U[ee];if(ve==="*"&&(ve=ie),H(ve))if(ve.group===he){let{fname:_e}=ve,we;if(_e===ye)we=`\\sqrt${Et.braces(this.toTeX(ve.args))}`;else if(_e===Re)we=Et.brackets(this.toTeX(ve.args),"abs");else if(_e===ke)we=Et.brackets(this.toTeX(ve.args),"parens");else if(_e===Me.LOG10)we=`\\${Me.LOG10_LATEX}\\left( ${this.toTeX(ve.args)}\\right)`;else if(_e===Me.LOG2)we=`\\${Me.LOG2_LATEX}\\left( ${this.toTeX(ve.args)}\\right)`;else if(_e===Me.LOG1P)we=`\\${bt(Me.LOG1P_LATEX,this.toTeX(ve.args))}`;else if(_e==="integrate"){let We=be(ve.args),ht=Et.braces(this.toTeX(We[0])),St=this.toTeX(We[1]);we=`\\int ${ht}\\, d${St}`}else if(_e==="defint"){let We=be(ve.args),ht=Et.braces(this.toTeX(We[0])),St=this.toTeX(We[3]),Qe=this.toTeX(We[1]),$e=this.toTeX(We[2]);we=`\\int\\limits_{${Qe}}^{${$e}} ${ht}\\, d${St}`}else if(_e==="diff"){let We=be(ve.args),ht="",St=Et.braces(this.toTeX(We[0]));if(We.length===1){let Qe=[];for(let $e=0;$e<We[0].length;$e++)We[0][$e].group===3&&Qe.push(We[0][$e].value);Qe.sort(),ht=Qe.length>0?`\\frac{d}{d ${Qe[0]}}`:"\\frac{d}{d x}"}else We.length===2?ht=`\\frac{d}{d ${We[1]}}`:ht=`\\frac{d^{${We[2]}}}{d ${this.toTeX(We[1])}^{${We[2]}}}`;we=`${ht}\\left(${St}\\right)`}else if(_e==="sum"||_e==="product"){let We=[[],[],[],[]],ht=0;for(let St=0;St<ve.args.length;St++){if(ve.args[St]===","){ht++;continue}We[ht].push(ve.args[St])}we=(_e==="sum"?"\\sum_":"\\prod_")+Et.braces(`${this.toTeX(We[1])} = ${this.toTeX(We[2])}`),we+=`^${Et.braces(this.toTeX(We[3]))}${Et.braces(this.toTeX(We[0]))}`}else if(_e==="limit"){let We=this.toTeX.bind(this),ht=a,St=be(ve.args).map(Qe=>Array.isArray(Qe)?ht.toTeX(Qe.join("")):We(String(Qe)));we=`\\lim_${Et.braces(`${St[1]}\\to ${St[2]}`)} ${Et.braces(St[0])}`}else _e===Se||_e===W?we=this.toTeX(ve.args)+(_e===Se?"!":"!!"):we=Et.latex(ve,k);ce.push(we)}else ce.push(Et.latex(ve,k));else Xt(ve)?ce.push(Et.brackets(this.toTeX(ve))):ve==="/"?ce.push(Et.frac(Ce(ce.pop()),Ce(this.toTeX([U[++ee]])))):ce.push(ve)}return ce.join(" ")};function He(o){return Me.PARSE2NUMBER?o:a.symfunction("parens",[o])}function Te(o){if(o.isInfinity)return p.infinity();if(o.multiplier.lessThan(0)&&o.multiplier.negate(),o.isImaginary()){let c=o.realpart(),k=o.imagpart();if(c.isConstant()&&k.isConstant())return Ct(a.add(a.pow(c,new p(2)),a.pow(k,new p(2))))}else{if(D0(o)||Bt(o.power))return o;if(Z1(o)&&typeof o.value=="string"&&o.value.startsWith("baseunit_"))return o}if(o.isComposite()){let c=[];o.each(U=>{c.push(U.multiplier)}),$.QGCD.apply(null,c).lessThan(0)&&(o.multiplier=o.multiplier.multiply(new je(-1)),o.distributeMultiplier())}let s=a.parse(o.multiplier);return o.toUnitMultiplier(),a.multiply(s,a.symfunction(Re,[o]))}function ze(o){let s;if(Q(o)){let c=new At;return o.each((k,U)=>{c.set(U-1,ze(k))}),c}if(te(o)){let c=new dt;return o.each((k,U,ce)=>{c.set(U,ce,ze(k))}),c}if(Me.PARSE2NUMBER&&o.isConstant())return vt(o)?s=$.bigfactorial(o):s=$.gamma(o.multiplier.add(new je(1)).toDecimal()),s=Pe(s),s;if(o.isConstant()&&o.getDenom().equals(2)){let k=o.getNum(),U,ce,ie;o.multiplier.isNegative()?(ie=a.subtract(k.negate(),new p(1)).multiplier.divide(new je(2)),U=a.pow(new p(-4),new p(ie)).multiplier.multiply($.bigfactorial(ie)),ce=$.bigfactorial(new je(2).multiply(ie))):(ie=a.add(k,new p(1)).multiplier.divide(new je(2)),U=$.bigfactorial(new je(2).multiply(ie)),ce=a.pow(new p(4),new p(ie)).multiplier.multiply($.bigfactorial(ie)));let ee=U.divide(ce);return a.multiply(a.parse("sqrt(pi)"),new p(ee))}return a.symfunction(Se,[o])}function st(o,s){let c=_t(o);if(c.isConstant()){let k=$.continuedFraction(c,s),U=At.fromArray(k.fractions.map(ce=>new p(ce)));return At.fromArray([new p(k.sign),new p(k.whole),U])}return a.symfunction("continuedFraction",[o,s])}function gt(o){let s=_t(o);return s.isConstant()?new p($.erf(s)):s.isImaginary()?y.erf(o):a.symfunction("erf",[o])}function wt(o,s){if(o.isConstant()&&s.isConstant()){let k=new p(1);return k.multiplier=k.multiplier.multiply(o.multiplier.mod(s.multiplier)),k}let c=a.divide(o.clone(),s.clone());return vt(c)?new p(0):a.symfunction("mod",[o,s])}function $t(o,s,c){return typeof o!="boolean"&&D0(o)&&(o=!!Number(o)),o?s:c}function ft(o,s){if(te(o)){for(let c=0,k=o.rows();c<k;c++)for(let U=0,ce=o.cols();U<ce;U++)if(o.elements[c][U].equals(s))return new p(1)}else if(o.elements){for(let c=0,k=o.elements.length;c<k;c++)if(o.elements[c].equals(s))return new p(1)}return new p(0)}function yt(o){return Me.PARSE2NUMBER?o.isConstant()?new p($.sinc(o)):a.parse(bt("sin({0})/({0})",o)):a.symfunction("sinc",[o])}function It(o){return o.fname===Me.LOG&&o.isLinear()?a.pow(o.args[0],p.create(o.multiplier)):a.parse(bt("e^({0})",o))}function qt(o){return a.parse(bt("({0})*pi/180",o))}function Pt(o){return a.parse(bt("({0})*180/pi",o))}function p0(o){let s,c,k;if(o.group===he&&o.fname===""?(s=p.unwrapPARENS(a.parse(o).toLinear()),c=a.parse(o.power)):o.group===Ue&&(s=a.parse(o.value),c=a.parse(o.power)),s&&c&&s.group===Ie&&c.group===Ie){k=[];let U=p.toPolarFormArray(o),ce=a.parse(s).abs().toString(),ie=N(s).toString(),ee=c.multiplier.den.toString(),Ne=c.multiplier.num.toString(),ve="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let _e=0;_e<Number(ee);_e++){let we=_t(a.parse(bt("(({0})+2*pi*({1}))/({2})",ie,_e,ee))).multiplier.toDecimal();k.push(_t(a.parse(bt(ve,ce,ee,Me.IMAGINARY,we,Ne))))}return At.fromArray(k)}if(o.isConstant(!0)){let U=o.sign(),ce=_t(o.abs()),ie=a.sqrt(ce);k=[ie.clone(),ie.negate()],U<0&&(k=k.map(ee=>a.multiply(ee,p.imaginary())))}else k=[a.parse(o)];return At.fromArray(k)}function w0(o){if(o.isComposite()){let s=new p(0),c,k,U,ce,ie,ee,Ne,ve;return o.each(_e=>{c=_e.getNum(),k=_e.getDenom(),U=s.getNum(),ce=s.getDenom(),ie=a.multiply(k,U),ee=a.multiply(c,ce),Ne=a.expand(a.add(ie,ee)),ve=a.multiply(ce,k),s=a.divide(Ne,ve)},!0),s}return o}function Ct(o){H(o)||(o=a.parse(o));let s=a.symfunction("sqrt",[o]);if(o.group===se)return a.symfunction(ye,[o]);o.fname===""&&o.power.equals(1)&&(o=o.args[0]);let c=o.multiplier.sign()<0;if(Me.PARSE2NUMBER){if(o.isConstant()&&!c)return new p(X.sqrt(o.multiplier.toDecimal()));if(o.isImaginary())return y.sqrt(o);if(o.group===De)return a.symfunction("sqrt",[o])}let k,U,ce=o.isConstant();if(o.group===j&&o.isLinear()){let ie=Ct(new p(o.multiplier));for(let ee in o.symbols){if(!Object.hasOwn(o.symbols,ee))continue;let Ne=o.symbols[ee];ie=a.multiply(ie,Ct(Ne))}U=ie}else if(o.fname===ye){let ie=o.args[0],ee=o.multiplier;ie.setPower(o.power.multiply(new je(.25))),U=ie,ee.equals(1)||(U=a.multiply(Ct(a.parse(ee)),U))}else if(!o.power.isInteger())o.setPower(o.power.multiply(new je(.5))),U=o;else if(Number(o.multiplier)<0&&o.group===De){let ie=a.parse(o.multiplier).negate(),ee=a.parse(o).toUnitMultiplier().negate();U=a.multiply(a.symfunction(Me.SQRT,[ee]),Ct(ie))}else{let ie=o.power.sign();o.power=o.power.abs(),ce&&o.multiplier.lessThan(0)&&(k=p.imaginary(),o.multiplier=o.multiplier.abs());let ee=Number(o.multiplier.toDecimal()),Ne=Math.abs(ee),ve=Math.sqrt(Ne),_e;if(vt(ve))_e=new p(ve);else if(vt(ee)){let we=$.ifactor(ee),We=1;for(let ht in we){if(!Object.hasOwn(we,ht))continue;let St=we[ht],Qe=St-St%2;if(Qe){let $e=Number(ht)**Qe;We*=Number(ht)**(Qe/2),ee/=$e}}_e=a.multiply(a.symfunction(ye,[new p(ee)]),new p(We))}else{let we=[new p(o.multiplier.num),new p(o.multiplier.den)],We=[new p(1),new p(1)],ht=[new p(1),new p(1)],St=a;for(let Qe=0;Qe<2;Qe++){let $e=we[Qe];ut($e).each(tt=>{tt=p.unwrapPARENS(tt);let et=tt.clone().toLinear(),lt=Number(tt.power),Mt=lt%2,pt=(lt-Mt)/2;We[Qe]=St.multiply(We[Qe],St.pow(et,new p(pt))),ht[Qe]=St.multiply(ht[Qe],Ct(St.pow(et,new p(Mt))))})}_e=a.divide(a.multiply(We[0],ht[0]),a.multiply(We[1],ht[1]))}o=o.toUnitMultiplier(!0),o.isOne()?U=o:Bt(o.power.toString())?U=a.pow(o.clone(),new p(.5)):U=a.symfunction(ye,[o]),ie<0&&U.power.negate(),_e&&(U=a.multiply(_e,U)),k&&(U=a.multiply(k,U))}return ue&&Me.PARSE2NUMBER&&U.text()!==s.text()?a.parse(U):U}function l0(o){if(!o.isConstant(!0)){let s,c=Number(o.power)/3,k=a.pow(a.parse(o.multiplier),new p(1/3)),U=o.toUnitMultiplier();return vt(c)?s=a.pow(U.toLinear(),a.parse(String(c))):U.group===j?(s=new p(1),U.each(ce=>{s=a.multiply(s,l0(ce))})):s=a.symfunction("cbrt",[U]),a.multiply(k,s)}return v0(o,new p(3))}function a0(o,s){return o.scientific=s||10,o}function v0(o,s,c=void 0,k=void 0){if(s=_t(a.parse(s)),s.equals(0))throw new i0("Unable to calculate nthroots of zero");if(Number(o)<0&&Bt(s))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!o.isConstant(!0)){let ee=[o,s];return typeof c<"u"&&ee.push(c),typeof k<"u"&&ee.push(k),a.symfunction("nthroot",ee)}o.group!==Ie&&(o=_t(o)),typeof k>"u"&&(k=!0),c||=25;let U=o.sign(),ce,ie;if(U<0&&(o=Te(o)),vt(o)&&s.isConstant())return Number(o)<18446744073709552e3?ie=je.create(Number(o)**(1/Number(s))):ie=$.nthroot(o,s),k?ce=new p(ie):ce=new p(ie.toDecimal(c)),a.multiply(new p(U),ce)}function ut(o){if(o.greaterThan(9999999999998891e26)||o.equals(-1))return o;if(o.equals(Math.PI))return new p(Math.PI);o=_t(o.clone());let s;if(o.isConstant()){s=new p(1);let c=o.toString();if(vt(c)){let k=$.ifactor(c);for(let U in k){if(!Object.hasOwn(k,U))continue;let ce=k[U];s=a.multiply(s,a.symfunction("parens",[new p(U).setPower(new je(ce))]))}}else{let k=ut(new p(o.multiplier.num)),U=ut(new p(o.multiplier.den));s=a.multiply(a.symfunction("parens",[k]),a.symfunction("parens",[U]).invert())}}else s=a.symfunction("pfactor",[o]);return s}function i1(o){return o.realpart()}function r1(o){return o.imagpart()}function w(o){let s=o.realpart(),c=o.imagpart();return a.add(s,a.multiply(c.negate(),p.imaginary()))}function N(o){let s=o.realpart(),c=o.imagpart();return s.isConstant()&&c.isConstant()?c.equals(0)&&s.equals(1)?a.parse("0"):c.equals(1)&&s.equals(0)?a.parse("pi/2"):c.equals(0)&&s.equals(-1)?a.parse("pi"):c.equals(-1)&&s.equals(0)?a.parse("-pi/2"):c.equals(1)&&s.equals(1)?a.parse("pi/4"):c.equals(1)&&s.equals(-1)?a.parse("pi*3/4"):c.equals(-1)&&s.equals(1)?a.parse("-pi/4"):c.equals(-1)&&s.equals(-1)?a.parse("-pi*3/4"):new p(Math.atan2(Number(c),Number(s))):a.symfunction("atan2",[c,s])}function E(o){let s=p.toPolarFormArray(o),c=s[1],k=s[0],U=a.parse(bt("e^({0}*({1}))",Me.IMAGINARY,c));return a.multiply(k,U)}function A(o){let s=o.clone();try{let c=Ae(o,"e",!0),k=a.divide(c.x.power,p.imaginary()),U=_t(I.tan(k)),ce=a.pow(c.a,new p(2)),ie=U.getDenom(!0),ee=U.getNum();return p.hyp(ee,ie).equals(c.a)?a.add(ie,a.multiply(p.imaginary(),ee)):s}catch(c){if(c.message==="timeout")throw c;return s}}function L(o,s){s.forEach(ee=>{ee.numVal=_t(ee).multiplier});let c,k,U,ce,ie;for(;;){if(c=s.length,c<2)return s[0];k=s.pop(),U=s[c-2],(o==="min"?k.numVal<U.numVal:k.numVal>U.numVal)&&(s.pop(),s.push(k))}}function T(...o){return l1(o)?o[0]:O1(o)?new p(Math.max.apply(null,o)):Me.SYMBOLIC_MIN_MAX&&rt(o)?L("max",o):a.symfunction("max",o)}function Y(...o){return l1(o)?o[0]:O1(o)?new p(Math.min.apply(null,o)):Me.SYMBOLIC_MIN_MAX&&rt(o)?L("min",o):a.symfunction("min",o)}function oe(o){return o.isConstant(!0)?new p(Math.sign(_t(o))):a.symfunction("sign",[o])}function pe(o,s){s=s?s.toString():"asc";let c=function(U){return U.group===Ie?U.multiplier:U.group===he?U.fname===""?c(U.args[0]):U.fname:U.group===De?U.power:U.value},k=Q(o)?o.elements:o.collectSymbols();return new At(k.sort((U,ce)=>{let ie=c(U),ee=c(ce);return s==="desc"?ee-ie:ie-ee}))}function re(o,s=void 0){if(o.equals(1))return new p(0);let c;if(o.fname===ye&&o.multiplier.equals(1))return c=a.divide(re(o.args[0]),new p(2)),o.power.sign()<0&&c.negate(),c;if(o.equals(0))throw new i0(`${Me.LOG}(0) is undefined!`);if(o.isImaginary())return y.evaluate(o,Me.LOG);if(o.isConstant()&&typeof s<"u"&&s.isConstant()){let k=Math.log(o),U=Math.log(s);c=new p(k/U)}else if(o.group===se&&o.power.multiplier.lessThan(0)||o.power.toString()==="-1")o.power.negate(),c=re(o).negate();else if(o.value==="e"&&o.multiplier.equals(1)){let k=o.power;c=H(k)?k:new p(k)}else if(o.group===he&&o.fname==="exp"){let k=o.args[0];o.multiplier.equals(1)?c=a.multiply(k,new p(o.power)):c=a.symfunction(Me.LOG,[o])}else if(Me.PARSE2NUMBER&&D0(o)){o=a.parse(o);let k;o.multiplier.lessThan(0)&&(o.negate(),k=a.multiply(new p(Math.PI),new p("i"))),c=new p(Math.log(o.multiplier.toDecimal())),k&&(c=a.add(c,k))}else{let k;!o.power.equals(1)&&!o.contains("e")&&o.multiplier.isOne()&&(k=o.group===se?o.power:new p(o.power),o.toLinear());let U=typeof s>"u"?[o]:[o,s];U.length>1&&l1(U)?c=new p(1):c=a.symfunction(Me.LOG,U),k&&(c=a.multiply(k,c))}return c}function Ee(o,s){let c=s&&s.isConstant()||typeof s>"u";if(o.isConstant()&&c){let U,ce,ie;U=o,s&&s.lessThan(0)&&(s=Te(s),ce=Number(o).toExponential().toString().split("e"),U=ce[0],ie=ce[1]);let ee=new p(_0(Number(U),Number(s)||0));return a.multiply(ee,a.pow(new p(10),new p(ie||0)))}let k=[o];return typeof s<"u"&&k.push(s),a.symfunction("round",k)}function Oe(o){let s=Number(o)%2,c;return s<0&&(s=2+s),s>=0&&s<=.5?c=1:s>.5&&s<=1?c=2:s>1&&s<=1.5?c=3:c=4,c}function Pe(o){if(!isFinite(o)){let c=Math.sign(o),k=new p(String(Math.abs(o)));return k.multiplier=k.multiplier.multiply(new je(c)),k}if(H(o))return o;if(typeof o=="number")try{o=je.simple(o)}catch(c){if(c.message==="timeout")throw c;o=new je(o)}let s=new p(0);return s.multiplier=o,s}function nt(o){let s=o.group,c;if(s===xe){let k=o.getNum(),U=o.getDenom()||new p(1),ce=Number(o.power),ie=new p(1);if(Math.abs(ce)===1){U.each(ve=>{ve.group===j?ie=a.multiply(ie,nt(ve.getDenom())):ve.power.lessThan(0)&&(ie=a.multiply(ie,nt(ve.clone().toUnitMultiplier())))});let ee=new p(0);U.each(ve=>{ee=a.add(a.divide(ve,ie.clone()),ee)}),ie.invert();let Ne;k.isComposite()?(Ne=new p(0),k.each(ve=>{Ne=a.add(a.multiply(nt(ve),ie.clone()),Ne)})):Ne=a.multiply(ie,k),c=a.divide(Ne,ee)}}else s===j?(c=new p(1),o.each(k=>{c=a.multiply(c,a.clean(k))})):s===he&&o.args.length===1&&o.args[0].isConstant()&&(c=f0("PARSE2NUMBER",()=>a.parse(o),!0));return c||=o,c}function Nt(o,s){return s||={expand_denominator:!0,expand_functions:!0},ot(o,s)}function ot(o,s){if(Array.isArray(o))return o.map(k=>ot(k,s));if(o.expand)return o.expand(s);if(s||={},o.group===he&&o.fname===""){let k=ot(o.args[0],s),U=ot(a.pow(k,a.parse(o.power)),s);return a.multiply(a.parse(o.multiplier),U).distributeMultiplier()}if([Ie,Ue,De].indexOf(o.group)!==-1)return o;let c=o.clone();try{let k=o.multiplier.toString(),U=Number(o.power),ce=o;if(o.isComposite()&&vt(o.power)&&o.power>0){let ie=U-1,ee=new p(0);o.each(ve=>{ee=a.add(ee,ot(a.parse(ve),s))});let Ne=a.parse(ee);for(let ve=0;ve<ie;ve++)Ne=Le(Ne,ee,s);ce=a.multiply(a.parse(k),Ne).distributeMultiplier()}else if(o.group===he&&s.expand_functions===!0){let ie=[];o.args.forEach(ee=>{ie.push(ot(ee,s))}),ce=a.pow(a.symfunction(o.fname,ie),a.parse(o.power)),ce=a.multiply(ce,a.parse(o.multiplier))}else if(o.isComposite()&&vt(o.power)&&o.power<0&&s.expand_denominator===!0)o=o.invert(),ce=ot(o,s),ce.invert();else if(o.group===j){let ie=function(ve){switch(ve.group){case xe:return 0;case fe:return 1;case j:return 2;case he:return 3;default:return 4}},ee=o.collectSymbols().sort((ve,_e)=>ie(_e)-ie(ve)).map(ve=>{let _e=a.pow(ve,a.parse(String(U)));return ot(_e,s)}),Ne=ee.pop();Ne.isComposite()&&Ne.isLinear()?(ee.forEach(ve=>{Ne=Le(Ne,ve,s)}),Ne.isComposite()?(Ne.power>1&&(Ne=ot(a.pow(Ne,a.parse(Ne.power)),s)),ce=a.multiply(a.parse(k),Ne).distributeMultiplier()):ce=Ne):(ce=Ne,ee.forEach(ve=>{ce=a.multiply(ce,ve)}),ce=a.multiply(ce,a.parse(k)).distributeMultiplier()),ce.group===j&&(ce=a.parse(ce))}else ce=o;return ce}catch(k){if(k.message==="timeout")throw k;return c}}function n0(o){return dt.identity(o)}function Dt(o,s){return s.isConstant()&&vt(s)?o.elements[Number(s)]:a.symfunction("vecget",[o,s])}function u0(o,s){return s=typeof s>"u"?1e-14:s,o=o.clone(),s=Number(s),o.elements.sort((c,k)=>k.group-c.group),o.elements=Yn(o.elements,(c,k)=>Number(a.subtract(_t(c),_t(k)).abs())<=s),o}function Tt(o,s,c){return s.isConstant?(o.elements[Number(s)]=c,o):a.symfunction("vecset",[o,s,c])}function Qt(o,s,c){return s.isConstant()&&c.isConstant()?o.elements[Number(s)][Number(c)]:a.symfunction("matget",[o,s,c])}function U0(o,s){return s.isConstant()?new dt(o.elements[s]):a.symfunction("matgetrow",[o,s])}function h0(o,s,c){if(!s.isConstant())return a.symfunction("matsetrow",[o,s,c]);if(o.elements[Number(s)].length!==c.elements.length)throw new I1("Matrix row must match row dimensions!");let k=o.clone();return k.elements[Number(s)]=c.clone().elements,k}function V0(o,s){if(!s.isConstant())return a.symfunction("matgetcol",[o,s]);let c=Number(s),k=dt.fromArray([]);return o.each((U,ce,ie)=>{ie===c&&k.elements.push([U.clone()])}),k}function x0(o,s,c){if(!s.isConstant())return a.symfunction("matsetcol",[o,s,c]);let k=Number(s);if(o.rows()!==c.elements.length)throw new I1("Matrix column length must match number of rows!");return c.each(((U,ce)=>{o.set(ce-1,k,U.elements[0].clone())})),o}function C0(o,s,c,k){return o.elements[s][c]=k,o}function G0(...o){return new At(o)}function c0(...o){return dt.fromArray(o)}function $0(...o){return d0.fromArray(o)}function k0(o){return te(o)?o.determinant():o}function X0(o){let s;return te(o)?s=[new p(o.cols()),new p(o.rows())]:Q(o)||j1(o)?s=new p(o.elements.length):zt("size expects a matrix or a vector"),s}function Jt(o,s){return te(o)&&(o=new At(o)),te(s)&&(s=new At(s)),Q(o)&&Q(s)?o.dot(s):a.multiply(o.clone(),s.clone())}function Lt(o,s){return te(o)&&(o=new At(o)),te(s)&&(s=new At(s)),Q(o)&&Q(s)?o.cross(s):a.multiply(o.clone(),s.clone())}function _n(o){return te(o)?o.transpose():zt("function transpose expects a matrix")}function In(o){return te(o)?o.invert():zt("invert expects a matrix")}function qn(o,s){return o.union(s)}function On(o,s){return o.intersection(s)}function Cn(o,s){return o.contains(s)}function Tn(o,s){return o.difference(s)}function Rn(o,s){return new p(Number(o.intersects(s)))}function Ln(o,s){return new p(Number(o.isSubset(s)))}function Un(o,s){s??=o;let c=ne.slice(o,s).map(k=>new p(k));return c.length===1?c[0]:c.length===0?new p(0):new At(c)}function xn(...o){o.forEach(s=>{console.log(s.toString())})}function v1(o){if(!H(o.power)&&o.power.absEquals(.5)){let s=o.power.sign(),c=Ct(o.group===Ue?new p(o.value):o.toLinear());return s<0&&c.invert(),c}return o}function $n(o){if(o.group===Ue){let s=o.value,c=bi(s)[0];if(!c)return C1("Unable to compute prime factors. This should not happen. Please review and report."),o;let U=new je(Math.log(s)/Math.log(c)).multiply(o.power);if(U.den>o.power.den)return o;vt(U)?o=new p(c**Number(U)):o=new p(c).setPower(U)}return o}this.expand=ot,this.round=Ee,this.clean=nt,this.sqrt=Ct,this.cbrt=l0,this.abs=Te,this.log=re,this.rationalize=w0,this.nthroot=v0,this.arg=N,this.conjugate=w,this.imagpart=r1,this.realpart=i1,this.getFunction=function(s){return D[s][0]},this.addPreprocessor=function(s,c,k,U){let{names:ce}=i,{actions:ie}=i;if(typeof c!="function")throw new Error("Incorrect parameters. Function expected!");k?U?(ce.splice(k,0,s),ie.splice(k,0,c)):(ce[k]=s,ie[k]=c):(ce.push(s),ie.push(c))},this.getPreprocessors=function(){let s={};for(let c=0,k=i.names.length;c<k;c++){let U=i.names[c];s[U]={order:c,action:i.actions[c]}}return s},this.removePreprocessor=function(s,c){let k=i.names.indexOf(s);c?(T0(i.names,k),T0(i.actions,k)):(i.names[k]=void 0,i.actions[k]=void 0)},this.mappedFunction=function(...s){let c={},{params:k}=this;for(let U=0;U<k.length;U++)c[k[U]]=String(s[U]);return a.parse(this.body,c)},this.add=function(s,c){let k=H(s),U=H(c);if(k&&U){if(s.unit||c.unit)return a.Unit.add(s,c);if(s.isInfinity||c.isInfinity){let pt=s.multiplier.lessThan(0),xt=c.multiplier.lessThan(0);if(s.isInfinity&&c.isInfinity&&pt!==xt)throw new i0(`(${s})+(${c}) is not defined!`);let Yt=p.infinity();return xt&&Yt.negate(),Yt}if(s.isComposite()&&s.isLinear()&&c.isComposite()&&c.isLinear()&&(s.distributeMultiplier(),c.distributeMultiplier(),c.length>s.length&&s.group===c.group&&([s,c]=[c,s])),s.multiplier.equals(0))return c;if(c.multiplier.equals(0))return s;if(s.isConstant()&&c.isConstant()&&Me.PARSE2NUMBER)return new p(s.multiplier.add(c.multiplier).toDecimal(Me.PRECISION));let ie=s.group,ee=c.group,Ne=s.power.toString(),ve=c.power.toString();if(ie<ee||ie===ee&&Number(Ne)>Number(ve)&&Number(ve)>0)return this.add(c,s);if(ie===j&&ee===fe&&s.value===c.value){let pt=s;s=c,c=pt,ie=s.group,ee=c.group,Ne=s.power.toString(),ve=c.power.toString()}let _e=Ne===ve,we=s.value,We=c.value,ht=s.isComposite(),St=c.isComposite(),Qe,$e,tt;if(ht&&(Qe=G(s,"hash")),St&&($e=G(c,"hash")),ie===xe&&ee===xe&&c.isLinear()&&!s.isLinear()&&Qe!==$e)return this.add(c,s);ie===fe&&ee===fe&&(we=Qe,We=$e);let et=ie===Ue&&ee===Ie,lt=s.value===c.multiplier.toString(),Mt=we===We||Qe===$e&&Qe!==void 0||et&&lt;if(Mt&&_e&&ie===ee)if(et&&(c=c.convert(Ue)),ie===fe&&(ee===De||ee===Ue))s.distributeMultiplier(),tt=s.attach(c);else if(tt=s,s.multiplier.isOne()&&c.multiplier.isOne()&&ie===xe&&s.isLinear()&&c.isLinear())for(let pt in c.symbols){if(!Object.hasOwn(c.symbols,pt))continue;let xt=c.symbols[pt];tt.attach(xt)}else tt.multiplier=tt.multiplier.add(c.multiplier);else if(Mt&&ie!==fe)ie===xe&&ee===fe?(c.insert(s,"add"),tt=c):(tt=p.shell(fe).attach([s,c]),tt.value=ie===fe?Qe:we);else if(ht&&s.isLinear()){let pt=ie===ee,xt=ie===fe&&ee===fe;if(xt&&(pt=s.value===c.value),s.distributeMultiplier(),c.isComposite()&&c.isLinear()&&pt){c.distributeMultiplier();for(let Yt in c.symbols){if(!Object.hasOwn(c.symbols,Yt))continue;let S0=c.symbols[Yt];s.attach(S0)}tt=s}else xt&&s.value!==$e||ie===fe&&!Mt?(tt=p.shell(xe).attach([s,c]),tt.updateHash()):tt=s.attach(c)}else{if(ie===he&&s.fname===ye&&ee!==se&&c.power.equals(.5)){let pt=c.multiplier.clone();c=Ct(c.toUnitMultiplier().toLinear()),c.multiplier=pt}s.length===2&&c.length===2&&Bt(s.power)&&Bt(c.power)?tt=a.add(ot(s),ot(c)):(tt=p.shell(xe).attach([s,c]),tt.updateHash())}if(tt.multiplier.equals(0)&&(tt=new p(0)),tt.length===1){let pt=tt.multiplier;tt=u1(tt.symbols),tt.multiplier=tt.multiplier.multiply(pt)}return tt}if(U&&!k){let ie=s;s=c,c=ie,ie=U,U=k,k=ie}let ce=te(c);if(k&&ce){let ie=new dt;c.eachElement((ee,Ne,ve)=>{ie.set(Ne,ve,a.add(s.clone(),ee))}),c=ie}else if(te(s)&&ce)c=s.add(c);else if(k&&Q(c))c.each((ie,ee)=>{ee--,c.elements[ee]=a.add(s.clone(),c.elements[ee])});else if(Q(s)&&Q(c))c.each((ie,ee)=>{ee--,c.elements[ee]=a.add(s.elements[ee],c.elements[ee])});else{if(Q(s)&&te(c))return a.add(c,s);if(te(s)&&Q(c)){if(c.elements.length===s.rows()){let ie=new dt,ee=s.cols();return c.each((Ne,ve)=>{let _e=[];if(Q(Ne))for(let we=0;we<ee;we++)_e.push(a.add(s.elements[ve-1][we].clone(),Ne.elements[we].clone()));else for(let we=0;we<ee;we++)_e.push(a.add(s.elements[ve-1][we].clone(),Ne.clone()));ie.elements.push(_e)}),ie}zt("Dimensions must match!")}}return c},this.subtract=function(s,c){let k=H(s),U=H(c),ce;if(k&&U){let ie=s,ee=c;return ie.unit||ee.unit?a.Unit.subtract(ie,ee):this.add(ie,ee.negate())}if(U&&Q(s))c=s.map(ie=>a.subtract(ie,c.clone()));else if(k&&Q(c))c=c.map(ie=>a.subtract(s.clone(),ie));else if(Q(s)&&Q(c)||q1(s)&&q1(c))s.dimensions()===c.dimensions()?c=s.subtract(c):a.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(te(s)&&Q(c)){if(c.elements.length===s.rows()){let ie=new dt,ee=s.cols();return c.each((Ne,ve)=>{let _e=[];for(let we=0;we<ee;we++)_e.push(a.subtract(s.elements[ve-1][we].clone(),Ne.clone()));ie.elements.push(_e)}),ie}zt("Dimensions must match!")}else if(Q(s)&&te(c)){let ie=c.clone().negate();return a.add(ie,s)}else if(te(s)&&te(c))c=s.subtract(c);else if(te(s)&&U){let ie=new dt;s.each((ee,Ne,ve)=>{ie.set(Ne,ve,a.subtract(ee,c.clone()))}),c=ie}else if(k&&te(c)){let ie=new dt;c.each((ee,Ne,ve)=>{ie.set(Ne,ve,a.subtract(s.clone(),ee))}),c=ie}return c},this.multiply=function(s,c){let k=H(s),U=H(c);if(k&&c instanceof Ft)return c.elements.push(s),c;if(k&&U){if(c.isUnit){let et=s.clone();return s.unit=c,et}if(s.unit||c.unit)return a.Unit.multiply(s,c);if(s.isInfinity||c.isInfinity){if(s.equals(0)||c.equals(0))throw new i0(`${s}*${c} is undefined!`);if(c.power.lessThan(0)){if(!s.isInfinity)return new p(0);throw new i0("Infinity/Infinity is not defined!")}let et=s.multiplier.multiply(c.multiplier).sign(),lt=p.infinity();if(s.isConstant()||c.isConstant()||s.isInfinity&&c.isInfinity)return et<0&&lt.negate(),lt}if(s.multiplier.equals(0)||c.multiplier.equals(0))return new p(0);if(s.isOne())return c.clone();if(c.isOne())return s.clone();if(s.isConstant()&&c.isConstant()&&Me.PARSE2NUMBER){let et,lt=s.multiplier.num.abs().toString().length,Mt=s.multiplier.den.toString().length,pt=lt-Mt,xt=c.multiplier.num.abs().toString().length,Yt=c.multiplier.den.toString().length,S0=xt-Yt,mt=Me.PRECISION-5;if(pt<-mt||pt>mt||S0<-mt||S0>mt){let Rt=new X(String(s.multiplier.num)),Kt=new X(String(s.multiplier.den)),j0=new X(String(c.multiplier.num)),A0=new X(String(c.multiplier.den));et=new p(Rt.times(j0).dividedBy(Kt).dividedBy(A0).toFixed())}else{let Rt=new X(s.multiplier.toDecimal()),Kt=new X(c.multiplier.toDecimal()),j0=Rt.times(Kt).toFixed();et=new p(j0)}return et}if(c.group>s.group&&c.group!==xe)return this.multiply(c,s);if(s.group===j&&c.group===fe&&s.value===c.value){let et=s;s=c,c=et}let ee=s.group,Ne=c.group,ve=c.multiplier.num,_e=c.multiplier.den;if(ee===he&&s.fname===ye&&!c.isConstant()&&s.args[0].value===c.value&&!s.args[0].multiplier.lessThan(0)){let et=s.power,lt=a.parse(s.multiplier);s=a.multiply(lt,s.args[0].clone()),s.setPower(new je(.5).multiply(et)),ee=s.group}else ee===he&&s.fname===ye&&s.multiplier.equals(1)&&s.power.equals(-1)&&c.isConstant()&&s.args[0].equals(c)&&(s=a.symfunction(ye,[c.clone()]),c=new p(1));let we=s.value,We=c.value,ht=new je(s.sign()),St=ee===Ue&&Ne===Ie&&c.multiplier.equals(s.value),Qe=St?new je(1).multiply(s.multiplier).abs():s.multiplier.multiply(c.multiplier).abs(),$e=s.clone().toUnitMultiplier();if(c=c.clone().toUnitMultiplier(!0),ee===he&&Ne===he){let et=s.args[0].clone(),lt=c.args[0].clone();if(s.fname===ye&&c.fname===ye&&s.isLinear()&&c.isLinear()){let Mt=a.divide(et,lt).invert();Mt.gt(1)&&vt(Mt)&&($e=a.multiply(s.args[0].clone(),Ct(Mt.clone())),c=new p(1))}else if(s.fname===Se&&c.fname===Se&&!et.isConstant()&&!lt.isConstant()&&c.power<0){let Mt=a.subtract(et.clone(),lt.clone());if(Mt.isConstant()){let pt=new p(1);if(Mt<0){for(let xt=0,Yt=Math.abs(Mt);xt<=Yt;xt++){let S0=a.add(et.clone(),new p(xt));pt=a.multiply(pt,S0)}$e=a.multiply(a.pow(et,new p(s.power)),a.pow(pt,new p(c.power))),c=new p(1)}else{for(let xt=0,Yt=Math.abs(Mt);xt<=Yt;xt++){let S0=a.add(lt.clone(),new p(xt));pt=a.multiply(pt,S0)}$e=a.multiply(a.pow(pt,new p(s.power)),a.pow(lt,new p(c.power))),c=new p(1)}}}}if(we===We&&ee===fe&&ee===Ne&&(we=s.text("hash"),We=c.text("hash")),Ne===se&&c.previousGroup===fe&&ee===fe&&(we=G(s,"hash",se)),(we===We||St)&&!(ee===fe&&(Ne===De||Ne===Ue||Ne===he))&&!(ee===fe&&Ne===j)){let et=s.power,lt=c.power,Mt=H(et),pt=H(lt),xt=Mt||pt;ee===fe&&Ne!==fe&&c.previousGroup!==fe&&et.equals(1)?($e=new p(0),s.each(Yt=>{$e=a.add($e,a.multiply(Yt,c.clone()))},!0)):(xt?$e.power=a.add(H(et)?et:new p(et),H(lt)?lt:new p(lt)):ee===Ie?$e.power=et:$e.power=et.add(lt),$e.power.equals(0)&&($e=$e.convert(Ie)),xt&&$e.convert(se),s.imaginary&&c.imaginary&&Bt(Number($e.power)%2)&&($e=new p(1),Qe.negate()),$e.group!==se&&$e.previousGroup&&($e.previousGroup=void 0),$e.multiplier=$e.multiplier.multiply(c.multiplier))}else if(ee===j&&s.isLinear())if(Ne===j&&c.distributeExponent(),Ne===j&&c.isLinear()){for(let et in c.symbols){if(!Object.hasOwn(c.symbols,et))continue;let lt=c.symbols[et];$e=$e.combine(lt)}$e.multiplier=$e.multiplier.multiply(c.multiplier)}else $e.combine(c);else if(ee===Ie)$e=c.clone().toUnitMultiplier(!0);else if(ee===j)$e.distributeExponent(),$e.combine(c);else if(!c.isOne()){let et=c.multiplier.clone();c.toUnitMultiplier(),$e=p.shell(j).combine([$e,c]),$e.multiplier=$e.multiplier.multiply(et)}if($e.group===Ue){let et=Math.log($e.value),lt=Math.log(ve)/et,Mt=Math.log(_e)/et,pt=Qe.num/ve,xt=Qe.den/_e;lt!==0&&vt(lt)&&vt(pt)&&($e.power=$e.power.add(new je(lt)),Qe.num/=ve),Mt!==0&&vt(Mt)&&vt(xt)&&($e.power=$e.power.subtract(new je(Mt)),Qe.den/=_e)}if($e.length===1){let et=$e.multiplier;$e=u1($e.symbols),$e.multiplier=$e.multiplier.multiply(et)}let tt=$e.power.toString();if(Bt(tt)&&$e.fname===ye){ht=ht.multiply(new je($e.sign()));let et=$e.power;$e=$e.args[0],$e=a.multiply(new p(Qe),a.pow($e,new p(et.divide(new je(2))))),ht.lessThan(0)&&$e.negate()}else $e.multiplier=$e.multiplier.multiply(Qe).multiply(ht),$e.group===xe&&$e.isImaginary()&&$e.distributeMultiplier();return $e.group===Ue&&vt($e.power.toDecimal())&&($e=$e.convert(Ie)),$e}if(U&&!k){let ee=s;s=c,c=ee,ee=U,U=k,k=ee}let ce=te(c),ie=te(s);if(k&&ce){let ee=new dt;c.eachElement((Ne,ve,_e)=>{ee.set(ve,_e,a.multiply(s.clone(),Ne))}),c=ee}else if(ie&&ce)c=s.multiply(c);else if(k&&Q(c))c.each((ee,Ne)=>{Ne--,c.elements[Ne]=a.multiply(s.clone(),c.elements[Ne])});else if(Q(s)&&Q(c))c.each((ee,Ne)=>{Ne--,c.elements[Ne]=a.multiply(s.elements[Ne],c.elements[Ne])});else{if(Q(s)&&te(c))return this.multiply(c,s);if(te(s)&&Q(c)){if(c.elements.length===s.rows()){let ee=new dt,Ne=s.cols();return c.each((ve,_e)=>{let we=[];for(let We=0;We<Ne;We++)we.push(a.multiply(s.elements[_e-1][We].clone(),ve.clone()));ee.elements.push(we)}),ee}zt("Dimensions must match!")}}return c},this.divide=function(s,c){let k=H(s),U=H(c);if(k&&U){if(s.unit||c.unit)return a.Unit.divide(s,c);let ee;if(c.equals(0))throw new A1("Division by zero not allowed!");return s.isConstant()&&c.isConstant()?(ee=s.clone(),ee.multiplier=ee.multiplier.divide(c.multiplier)):(c.invert(),ee=a.multiply(s,c)),ee}let ce=Q(s),ie=Q(c);if(k&&ie)c=c.map(ee=>a.divide(s.clone(),ee));else if(ce&&U)c=s.map(ee=>a.divide(ee,c.clone()));else if(ce&&ie)s.dimensions()===c.dimensions()?c=c.map((ee,Ne)=>a.divide(s.elements[--Ne],ee)):a.error("Cannot divide vectors. Dimensions do not match!");else{let ee=te(s),Ne=te(c);if(ee&&U){let ve=new dt;s.eachElement((_e,we,We)=>{ve.set(we,We,a.divide(_e,c.clone()))}),c=ve}else if(k&&Ne){let ve=new dt;c.eachElement((_e,we,We)=>{ve.set(we,We,a.divide(s.clone(),_e))}),c=ve}else if(ee&&Ne){let ve=new dt;s.rows()===c.rows()&&s.cols()===c.cols()?(s.eachElement((_e,we,We)=>{ve.set(we,We,a.divide(_e,c.elements[we][We]))}),c=ve):a.error("Dimensions do not match!")}else if(ee&&ie)if(s.cols()===c.dimensions()){let ve=new dt;s.eachElement((_e,we,We)=>{ve.set(we,We,a.divide(_e,c.elements[we].clone()))}),c=ve}else a.error("Unable to divide matrix by vector.")}return c},this.pow=function(s,c){let k=H(s),U=H(c);if(k&&U){if(s.unit||c.unit)return a.Unit.pow(s,c);if(s.group===he&&s.fname===Re&&Bt(c)){let Qe=s.multiplier.clone(),$e=a.pow(s.args[0],c);return $e.multiplier=Qe,$e}if(s.isInfinity||c.isInfinity){if(s.isInfinity&&c.isInfinity)throw new i0(`(${s})^(${c}) is undefined!`);if(s.isConstant()&&c.isInfinity){if(s.equals(0)){if(c.lessThan(0))throw new i0("0^Infinity is undefined!");return new p(0)}if(s.equals(1))throw new i0(`1^${c.toString()} is undefined!`);if(c.lessThan(0))return new p(0);if(!s.lessThan(0))return p.infinity()}if(s.isInfinity&&c.isConstant()){if(c.equals(0))throw new i0(`${s}^0 is undefined!`);return c.lessThan(0)?new p(0):a.multiply(p.infinity(),a.pow(new p(s.sign()),c.clone()))}}let ce=s.equals(0),ie=c.equals(0);if(ce&&ie)throw new i0("0^0 is undefined!");if(ce&&c.isConstant()&&c.multiplier.greaterThan(0))return new p(0);if(ie)return new p(1);let ee=c.isConstant(),Ne=s.isConstant(),ve=c.isInteger(),_e=s.multiplier,we=s.clone();if(Ne&&ee&&s.equals(0)&&c.lessThan(0))throw new i0("Division by zero is not allowed!");if(Me.PARSE2NUMBER&&Ne&&ee&&s.sign()<0&&E1(c)){let Qe=Math.PI*Number(c.multiplier.toDecimal()),$e=new p(Math.cos(Qe)),tt=a.multiply(p.imaginary(),new p(Math.sin(Qe)));return a.add($e,tt)}if(Me.PARSE2NUMBER&&s.isImaginary()&&ee&&vt(c)&&!c.lessThan(0)){let Qe,$e,tt,et,lt,Mt=s.realpart(),pt=s.imagpart();if(Mt.isConstant("all")&&pt.isConstant("all"))return lt=Me.USE_BIG?new p(X.atan2(pt.multiplier.toDecimal(),Mt.multiplier.toDecimal()).times(c.toString())):Math.atan2(Number(pt.multiplier.toDecimal()),Number(Mt.multiplier.toDecimal()))*Number(c.multiplier.toDecimal()),$e=new p(lt),Qe=a.pow(p.hyp(Mt,pt),c),tt=a.multiply(Qe.clone(),a.trig.cos($e.clone())),et=a.multiply(Qe,a.trig.sin($e)),a.add(tt,a.multiply(p.imaginary(),et))}we.toUnitMultiplier();let We;if(we.group===he&&we.fname===ye&&!ee){let Qe=we.args[0];Qe.multiplyPower(new p(.5)),Qe.multiplier.multiply(we.multiplier),Qe.multiplyPower(c),we=Qe}else We=_e.sign(),E1(c)&&We<0&&(we.negate(),we=a.symfunction(ke,[we]),we.negate()),we.multiplyPower(c);let ht,St;if(Ne&&ee&&Me.PARSE2NUMBER){let Qe;We<0&&(s.negate(),c.multiplier.den.equals(2)?Qe=new p(Me.IMAGINARY):vt(c.multiplier)?Bt(c.multiplier)?Qe=new p(1):Qe=new p(-1):Bt(c.multiplier.den)?Qe=a.pow(a.symfunction(ke,[new p(We)]),c.clone()):Qe=new p(We**c.multiplier.num));let $e=Number(s.multiplier.toDecimal())**Number(c.multiplier.toDecimal());if($e!==0||s.multiplier.equals(0))we=new p($e);else{let tt=new X(s.multiplier.toDecimal()),et=new X(c.multiplier.toDecimal());we=new p(tt.pow(et).toFixed())}Qe&&(we=a.multiply(we,Qe))}else if(ve&&!_e.equals(1)){if(c.abs().gt(Me.MAX_EXP))return c.sign()<0?new p(0):p.infinity();let $e=c.multiplier.toDecimal(),tt=Math.sign(Number($e)),et=Math.abs(Number($e)),lt=new je(1);lt.num=_e.num.pow(et),lt.den=_e.den.pow(et),tt<0&&lt.invert(),we.multiplier=we.multiplier.multiply(lt)}else{let Qe=s.sign();if(c.isConstant()&&s.isConstant()&&!c.multiplier.den.equals(1)&&Qe<0)if(c.multiplier.den.equals(2)){let $e=new p(Me.IMAGINARY);s.negate(),c.lessThan(0)&&($e.negate(),c.negate()),we=a.multiply(a.pow(s,c),$e)}else{let $e=s.clone();$e.multiplier.negate(),we=a.pow(a.symfunction(ke,[new p(We)]),c.clone());let tt=a.pow(new p($e.multiplier.num),c.clone()),et=a.pow(new p($e.multiplier.den),c.clone()),lt=a.divide(tt,et);we=a.multiply(we,lt)}else if(Me.PARSE2NUMBER&&c.isImaginary()){let $e=c.realpart(),tt=c.imagpart(),et=s.clone().toLinear(),lt=a.pow(et.clone(),$e),Mt=re(et.clone()),pt=I.cos(a.multiply(tt.clone(),Mt)),xt=a.multiply(I.sin(a.multiply(tt,re(et))),p.imaginary());we=a.multiply(lt,a.add(pt,xt)),we=a.expand(a.parse(we))}else{let $e=s.group===Ie&&Qe<0;if(ht=v1(new p($e?_e.num:Math.abs(_e.num)).setPower(c.clone())),St=v1(new p(_e.den).setPower(c.clone()).invert()),s.imaginary)if(ve){let tt=Math.sign(c),lt=Te(c)%4;we=new p(Bt(lt)?-1:Me.IMAGINARY),(lt===0||tt<0&&lt===1||tt>0&&lt===3)&&we.negate()}else{let tt=c.multiplier.multiply(je.quick(1,2)),et=(-1)**tt.num;we=Bt(tt.den)?new p(-1).setPower(tt,!0):new p(et)}if(Qe<0&&!$e&&we.negate(),ee&&s.group!==se){let tt=Bt(c.multiplier.den),et=Bt(s.power),lt=we.power.toDecimal(),Mt=Bt(lt);if(tt&&et&&!Mt){if(lt==="1"||lt==="1")typeof we.value=="string"&&we.value.startsWith("baseunit_")||(we=a.symfunction(Re,[we]));else if(vt(lt))we=a.multiply(a.symfunction(Re,[we.clone().toLinear()]),we.clone().setPower(new je(Number(lt)-1)));else{let pt=we.power;we=a.symfunction(Re,[we.toLinear()]).setPower(pt)}Me.POSITIVE_MULTIPLIERS&&we.fname===Re&&(we=we.args[0])}}if(c.equals(2)&&we.group===j){let tt=new p(1);we.each(et=>{tt=a.multiply(tt,a.pow(et,c))}),we=tt}}}if(we=v1(we),ht&&St&&(we=a.multiply(we,$n(a.multiply(ht,St)))),we.fname===ye){let Qe=we.group===se,$e=Qe?we.power.multiplier.toString():we.power.toString();if(Bt($e)){let tt=Qe?a.divide(we.power,new p(2)):new p(we.power.divide(new je(2))),et=we.multiplier;we=a.pow(we.args[0],tt),we.multiplier=we.multiplier.multiply(et)}}else if(!Me.IGNORE_E&&we.isE()&&we.group===se&&we.power.contains("pi")&&we.power.contains(Me.IMAGINARY)&&c.group===j){let Qe=c.stripVar(Me.IMAGINARY);we=a.add(I.cos(Qe),a.multiply(p.imaginary(),I.sin(Qe)))}return we}if(Q(s)&&U)s=s.map(ce=>a.pow(ce,c.clone()));else if(te(s)&&U){let ce=new dt;s.eachElement((ie,ee,Ne)=>{ce.set(ee,Ne,a.pow(ie,c.clone()))}),s=ce}else if(k&&te(c)){let ce=new dt;c.eachElement((ie,ee,Ne)=>{ce.set(ee,Ne,a.pow(s.clone(),ie))}),s=ce}return s},this.comma=function(s,c){return s instanceof Ft||(s=Ft.create(s)),s.append(c),s},this.mod=function(s,c){return wt(s,c)},this.slice=function(s,c){return new h(s,c)},this.equals=function(s,c){return s.group!==De&&!s.isLinear()&&zt(`Cannot set equality for ${s.toString()}`),g[s.value]=c.clone(),c},this.percent=function(s){return a.divide(s,new p(100))},this.assign=function(s,c){if(s instanceof Ft&&c instanceof Ft)return s.elements.map((k,U)=>a.assign(k,c.elements[U])),At.fromArray(c.elements);if(s.parent){let k=s.parent;return k.elements[k.getter]=c,delete k.getter,k}if(s.group!==De)throw new X1(`Cannot complete operation. Incorrect LH value for ${s}`);return g[s.value]=c,c},this.functionAssign=function(s,c){let k=s.elements.pop();return me(k,s.elements,c)};let H0=function(s){return new p(s===!0?1:0)};this.eq=function(s,c){return H0(s.equals(c))},this.gt=function(s,c){return H0(s.gt(c))},this.gte=function(s,c){return H0(s.gte(c))},this.lt=function(s,c){return H0(s.lt(c))},this.lte=function(s,c){return H0(s.lte(c))},this.factorial=function(s){return this.symfunction(Se,[s])},this.dfactorial=function(s){return this.symfunction(W,[s])}}a=new z,wn._=a,ct._=a,Object.defineProperty(fn,"functions",{get:()=>a.functions,configurable:!0}),Object.defineProperty(pn,"CONSTANTS",{get:()=>a.CONSTANTS,configurable:!0}),Object.defineProperty(R0,"VARS",{get:()=>g,configurable:!0}),Object.defineProperty(s0,"VARS",{get:()=>g,configurable:!0}),s0._clearFunctions=Be,s0._initConstants=()=>a.initConstants(),t0._=a,t0.C=ae,kt._=a,kt.isArray=Xt,kt.isSymbol=H,kt.isMatrix=te,kt.isVector=Q,kt.isSet=j1,kt.isNegative=ue,kt.inBrackets=Gt,kt.Settings=Me,kt.SQRT=ye,kt.ABS=Re,kt.PARENTHESIS=ke,kt.FACTORIAL=Se,kt.DOUBLEFACTORIAL=W,kt.FN=he,kt.S=De,kt.P=Ue,kt.N=Ie,kt.CB=j,kt.CP=xe,kt.EX=se,kt.Parser=z,Et.parser=(function(){let t=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],i=new z;for(let m in i)t.indexOf(m)===-1&&delete i[m];i.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(m){return m}}),i.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(m){return m}});let h=i.getBrackets();return h["{"].maps_to=void 0,i})(),Object.defineProperty(Vt,"EXPRESSIONS",{get:()=>u,configurable:!0}),Object.defineProperty(Vt,"USER_FUNCTIONS",{get:()=>S,configurable:!0}),Vt.LaTeX=Et,Vt.text=G,Vt.functions=a.functions,Vt._=a,Ke.Frac=je,Ke.NerdamerSymbol=p,Ke.isVector=Q,Ke.isArray=Xt,Ke.isMatrix=te,Ke.isSymbol=H,Ke.block=f0,Ke._=a,Ke.Settings=Me,Ke.text=G,Ke.LaTeX=Et,at.Frac=je,at.NerdamerSymbol=p,at.Vector=At,at.isMatrix=te,at.isVector=Q,at.isArray=Xt,at.isSymbol=H,at.block=f0,at._=a,at.err=zt,at.LaTeX=Et,b0.isVector=Q,b0.Vector=At,b0.remove=T0,M0._=a,M0.block=f0,e0.Math2=$,e0.Frac=je,e0.NerdamerSymbol=p,e0.isInt=vt,e0.nround=_0,e0.even=Bt,e0.block=f0,e0._=a,e0.variables=P,e0.inBrackets=Gt,e0.FN=he,e0.N=Ie,e0.S=De,e0.P=Ue,e0.EX=se,e0.CB=j,o0.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":$.gamma},gamma_incomplete:{"Math2.factorial":$.factorial},Li:{"Math2.Ei":$.Ei,"Math2.bigLog":$.bigLog,Frac:je},Ci:{"Math2.factorial":$.factorial},Ei:{"Math2.factorial":$.factorial},Si:{"Math2.factorial":$.factorial},Shi:{"Math2.factorial":$.factorial},Chi:{isInt:vt,nround:_0,"Math2.num_integrate":$.num_integrate},factor:{"Math2.ifactor":$.ifactor,NerdamerSymbol:p},num_integrate:{"Math2.simpson":$.simpson,nround:_0},fib:{even:Bt}},o0.reformat={diff(l,t){let i=l.args[1].toString(),h=`let f = ${o0.build(l.args[0].toString(),[i])};`,m=$.diff.toString();return!m.startsWith("function")&&!m.startsWith("(")&&!m.startsWith("async")&&(m=`function ${m}`),t[1]+=`let diff = ${m};`,t[1]+=h,[`diff(f)(${i})`,t]}},ct.Build=o0,(function(){c1(a.CONSTANTS),c1(a.functions),a.initConstants(),a.error||=zt,Me.LOG_FNS={log:a.functions.log,log10:a.functions.log10}})();let V={allSame:l1,allNumeric:Jn,arguments2Array:jn,armTimeout:W1,arrayAddSlices:Wn,arrayClone:zn,arrayMax:Hn,arrayMin:N1,arrayEqual:Zn,arrayUnique:M1,arrayGetVariables:Ze,arraySum:b,block:f0,build:o0.build,checkTimeout:d1,clearU:si,comboSort:Kn,compare:qe,convertToVector:Ye,customError:r0,customType:Xn,decompose_fn:Ae,disarmTimeout:Q1,each:rn,evaluate:_t,even:Bt,evenFraction:E1,fillHoles:B,firstObject:u1,format:bt,generatePrimes:J1,getCoeffs:Xe,getU:Ve,importFunctions:it,inBrackets:Gt,isArray:Xt,isExpression:M,isFraction:v,isInt:vt,isMatrix:te,isNegative:ue,isNumericSymbol:D0,isPrime:W0,isReserved:f1,isSymbol:H,isVariableSymbol:Z1,isVector:Q,isCollection:q1,keys:R1,knownVariable:Qn,nroots:Je,remove:T0,reserveNames:c1,range:Bn,round:_0,sameSign:Fn,scientificToDecimal:Z0,separate:R,stringReplace:Gn,text:G,validateName:I0,variables:P,warn:C1};ae={groups:K,NerdamerSymbol:p,Expression:jt,Collection:Ft,Frac:je,Vector:At,Matrix:dt,Parser:z,Scientific:Ht,Fraction:en,Math2:$,LaTeX:Et,Utils:V,PARSER:a,PARENTHESIS:ke,Settings:Me,err:zt,bigInt:_,bigDec:X,exceptions:F},Vt.Math2=ae.Math2,Vt.Expression=jt;let q=function(l,t,i,h){W1();try{let m=!1;if(me(l))return Sn;l!==null&&typeof l=="object"&&l instanceof jt&&(l=l.toString()),Xt(i)||(i=typeof i>"u"?[]:[i]),i.forEach(I=>{if(I==="numer"){m=!0;return}let x=a.functions[I];x&&x[1]===1&&(l=`${I}(${l})`)});let y=f0("PARSE2NUMBER",()=>a.parse(l,t),m||Me.PARSE2NUMBER);return h?u[h-1]=y:u.push(y),new jt(y)}finally{Q1()}};return s0.libExports=q,z0.libExports=q,z0.CONSTANTS=a.CONSTANTS,g0.libExports=q,g0.VARS=g,g0.CONSTANTS=a.CONSTANTS,g0.parse=a.parse.bind(a),g0.isSymbol=H,m1.libExports=q,m1._setFunction=me,N0.libExports=q,N0.EXPRESSIONS=u,L0.libExports=q,L0.Settings=Me,L0.functions=a.functions,Wt.bigDec=X,Wt.Settings=Me,Wt.functions=a.functions,Wt.symfunction=a.symfunction.bind(a),Wt.NerdamerSymbol=p,m0.libExports=q,m0.functions=a.functions,m0.parse=a.parse.bind(a),m0.callfunction=a.callfunction.bind(a),m0.Expression=jt,q.rpn=Ai,q.convertToLaTeX=wi,q.convertFromLaTeX=Ci,q.version=fi,q.getWarnings=oi,q.setConstant=$i,q.getConstant=gi,q.clearConstants=Li,q.setFunction=Pi,q.clearFunctions=Ri,q.getCore=pi,q.getExpression=q.getEquation=jt.getExpression,q.reserved=ci,q.clear=z1,s0.clear=z1,q.flush=Ui,q.expressions=qi,q.functions=Oi,q.register=gn,q.validateName=I0,q.validVarName=ui,q.supported=hi,q.numEquations=q.numExpressions=li,q.setVar=ki,q.getVar=mi,q.clearVars=Ti,q.load=xi,q.getVars=di,q.set=U1,q.get=ai,q.updateAPI=Di,q.replaceFunction=Ii,q.setOperator=yi,q.getOperator=Si,q.aliasOperator=vi,q.tree=hn,q.htmlTree=_i,q.addPeeker=Ni,q.removePeeker=Ei,q.parse=Mi,q.updateAPI(),q})({bigInt:Y1,bigDec:K1,constants:bn});typeof x1<"u"&&(x1.exports=Sn)});var K0=y0((ji,vn)=>{"use strict";var Y0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof vn<"u"&&Y0===void 0&&(Y0=B0(),e1());(function(){let n=Y0.getCore(),e=n.PARSER,{Frac:_}=n,{Settings:X}=n,{isSymbol:K}=n.Utils,{FN:ne}=n.groups,{NerdamerSymbol:Z}=n,{text:J}=n.Utils,{inBrackets:a}=n.Utils,{isInt:ae}=n.Utils,{format:H}=n.Utils,{even:Ie}=n.Utils,{evaluate:Ue}=n.Utils,{N:De}=n.groups,{S:se}=n.groups,{PL:he}=n.groups,{CP:fe}=n.groups,{CB:j}=n.groups,{EX:xe}=n.groups,{P:Ge}=n.groups,{LOG:ke}=X,ye="exp",Re="abs",Se="sqrt",W="sin",u="cos",g="tan",r="sec",d="csc",S="cot",v="asin",M="acos",P="atan",b="asec",R="acsc",B="acot",Q="sinh",te="cosh",ue="tanh",qe="csch",me="sech",Be="coth",Je="asech",Ae="acsch",Ve="acoth";function Ze($){this.message=$||""}Ze.prototype=new Error,Z.prototype.hasIntegral=function(){return this.containsFunction("integrate")},Z.prototype.fnTransform=function(){if(this.group!==ne)return this;let G,p=this.args[0],z=new Z(this.multiplier),V=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case Q:G=e.parse(H("(e^({0})-e^(-({0})))/2",p));break;case te:G=e.parse(H("(e^({0})+e^(-({0})))/2",p));break;case ue:G=e.parse(H("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",p));break;case g:G=e.parse(H("sin({0})/cos({0})",p));break;case d:G=e.parse(H("1/sin({0})",p));break;case r:G=e.parse(H("1/cos({0})",p));break;default:G=V}else if(this.power.equals(2))switch(this.fname){case W:G=e.parse(H("1/2-cos(2*({0}))/2",p));break;case u:G=e.parse(H("1/2+cos(2*({0}))/2",p));break;case g:G=e.parse(H("sin({0})^2/cos({0})^2",p));break;case te:G=e.parse(H("1/2+cosh(2*({0}))/2",p));break;case Q:G=e.parse(H("-1/2+cosh(2*({0}))/2",p));break;case ue:G=e.parse(H("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",p));break;case r:G=e.parse(H("(1-cos(2*({0})))/(1+cos(2*({0})))+1",p));break;default:G=V}else if(this.fname===r)G=e.parse(H("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===d)G=e.parse(H("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===g)this.power.lessThan(0)?G=e.parse(H("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):G=e.parse(H("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===W&&this.power.lessThan(0))G=e.parse(H("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===u&&this.power.lessThan(0))G=e.parse(H("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===W&&this.power.equals(3))G=e.parse(H("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===u&&this.power.equals(3))G=e.parse(H("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===u||this.fname===W)&&Ie(this.power)){let q=this.power/2,l=e.pow(this.clone().toLinear(),e.parse(2)).fnTransform(),t=e.expand(e.pow(l,e.parse(q)));G=new Z(0),t.each(i=>{let h=i.fnTransform();G=e.add(G,h)},!0)}else G=V;return e.multiply(G,z)},Z.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===se)return!1;if(this.fname&&(n.Utils.inTrig(this.fname)||n.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let G in this.symbols)if(this.symbols[G].hasTrig())return!0}return!1},n.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},n.Utils.toCommonDenominator=function(G){if(G.isComposite()&&G.isLinear()){let p=new Z(G.multiplier),z=new Z(1),V=new Z(0);return G.each(l=>{z=e.multiply(z,l.getDenom())},!0),G.each(l=>{let t=l.getNum(),i=l.getDenom(),h=e.multiply(t,e.divide(z.clone(),i));V=e.add(V,h)}),e.multiply(p,n.Algebra.divide(e.expand(V),e.expand(z)))}return G},n.Utils.inInverseTrig=function(G){return[v,M,P,R,b,B].indexOf(G)!==-1},n.Utils.inTrig=function(G){return[u,W,g,r,d,S].indexOf(G)!==-1},n.Utils.inHtrig=function(G){return[Q,te,ue,Ae,Je,Ve].indexOf(G)!==-1},n.Matrix.jacobian=function(G,p){let z=new n.Matrix;return p||=n.Utils.arrayGetVariables(G),p.forEach((V,q)=>{G.forEach((l,t)=>{let i=n.Calculus.diff(l.clone(),V);z.set(t,q,i)})}),z},n.Matrix.prototype.max=function(){let G=new Z(0);return this.each(p=>{let z=p.abs();z.gt(G)&&(G=z)}),G},n.Matrix.cMatrix=function(G,p){let z=new n.Matrix;return p.forEach((V,q)=>{z.set(q,0,e.parse(G))}),z};let it=n.Utils.allFunctions=function(G){for(let p=0,z=G.length;p<z;p++)if(G[p].group!==ne)return!1;return!0},Xe=n.Utils.cosAsinBtranform=function(G,p){let z=G.args[0],V=p.args[0];return e.parse(H("(sin(({0})+({1}))-sin(({0})-({1})))/2",z,V))},Ye=n.Utils.cosAsinAtranform=function(G,p){if(Number(p.power)!==1)return e.multiply(G,p);let z=G.args[0];return e.parse(H("(sin(2*({0})))/2",z))},rt=n.Utils.cosAsinBtranform=function(G,p){let z=G.args[0],V=p.args[0];return e.parse(H("(cos(({0})+({1}))-cos(({0})-({1})))/2",z,V))},Le=n.Utils.trigTransform=function(G){let p={},z,V,q=new Z(1);for(let l=0,t=G.length;l<t;l++)if(z=G[l],z.group===ne){let{fname:i}=z;i===u&&p[W]?(p[W].args[0].toString()===z.args[0].toString()?V=Ye(z,p[W]):V=Xe(z,p[W]),delete p[W],q=e.multiply(q,V)):i===W&&p[u]?(p[u].args[0].toString()===z.args[0].toString()?V=Ye(z,p[u]):V=Xe(z,p[u]),delete p[u],q=e.multiply(q,V)):i===W&&p[W]?(p[W].args[0].toString()===z.args[0].toString()?(V=e.multiply(z,p[W]),delete p[W]):(V=rt(z,p[W]),delete p[W]),q=V):p[i]=z}else q=e.multiply(q,z);for(let l in p)Object.hasOwn(p,l)&&(q=e.multiply(q,p[l]));return q};n.Settings.integration_depth=10,n.Settings.max_lim_depth=10;let F=n.Calculus={version:"1.4.6",sum($,G,p,z){if(G.group!==n.groups.S)throw new n.exceptions.NerdamerTypeError(`Index must be symbol. ${J(G)} provided`);G=G.value;let V;if(n.Utils.isNumericSymbol(p)&&n.Utils.isNumericSymbol(z)){let q=z-p<200?"":"PARSE2NUMBER";p=Number(p),z=Number(z),V=n.Utils.block(q,()=>{let l=$.text(),t={"~":!0},i=new n.NerdamerSymbol(0);for(let h=p;h<=z;h++){t[G]=new Z(h);let m=e.parse(l,t);i=e.add(i,m)}return i})}else V=e.symfunction("sum",[$,G,p,z]);return V},product($,G,p,z){if(G.group!==n.groups.S)throw new n.exceptions.NerdamerTypeError(`Index must be symbol. ${J(G)} provided`);G=G.value;let V;if(n.Utils.isNumericSymbol(p)&&n.Utils.isNumericSymbol(z)){let q=z-p<200?"":"PARSE2NUMBER";V=n.Utils.block(q,()=>{p=Number(p),z=Number(z.multiplier);let l=$.text(),t={},i=new n.NerdamerSymbol(1);for(let h=p;h<=z;h++)t[G]=new Z(h),i=e.multiply(i,e.parse(l,t));return i})}else V=e.symfunction("product",[$,G,p,z]);return V},diff($,G,p){if(n.Utils.isVector($)){let i=new n.Vector([]);return $.each(h=>{i.elements.push(F.diff(h,G,p))}),i}if(n.Utils.isMatrix($)){let i=new n.Matrix;return $.each((h,m,y)=>{i.set(m,y,F.diff(h,G,p))}),i}if($.LHS&&$.RHS)return new n.Equation(F.diff($.LHS.clone(),G,p),F.diff($.RHS.clone(),G,p));let z=K(G)?G.text():G;if(p=K(p)?p.multiplier:p||1,z===void 0&&(z=n.Utils.variables($)[0]),$.group===ne&&$.fname===Se){let i=$.args[0],h=$.power.clone();(i.group!==De||i.group!==Ge)&&(i.power=K(i.power)?e.multiply(i.power,e.multiply(new Z(1/2)),h):i.power.multiply(new _(.5)).multiply(h),i.multiplier=i.multiplier.multiply($.multiplier)),$=i}if($.group===ne&&!K($.power)){let i=q(e.parse($)),h=F.diff($.args[0].clone(),z);$=e.multiply(i,h)}else $=q($);return p>1&&(p--,$=F.diff($,G,p)),$;function V(i){return(i.value===z||i.contains(z,!0))&&(i.multiplier=i.multiplier.multiply(i.power),i.power=i.power.subtract(new _(1)),i.power.equals(0)&&(i=Z(i.multiplier))),i}function q(i){let h=i.group,m,y,I;if(h===De||h===se&&i.value!==z||h===Ge)i=Z(0);else if(h===se)i=V(i);else if(h===j){let x=i.multiplier.clone();i.toUnitMultiplier();let C=e.multiply(t(i),V(i));return C.multiplier=C.multiplier.multiply(x),C}else if(h===ne&&i.power.equals(1)){let x=i.multiplier.clone();switch(i.toUnitMultiplier(),i.fname){case ke:I=i.clone(),i=i.args[0].clone(),i.power=i.power.negate(),i.multiplier=I.multiplier.divide(i.multiplier);break;case u:i.fname=W,i.multiplier.negate();break;case W:i.fname=u;break;case g:i.fname=r,i.power=new _(2);break;case r:i=l(i,g);break;case d:i=l(i,"-cot");break;case S:i.fname=d,i.multiplier.negate(),i.power=new _(2);break;case v:i=e.parse(`(sqrt(1-(${J(i.args[0])})^2))^(-1)`);break;case M:i=e.parse(`-(sqrt(1-(${J(i.args[0])})^2))^(-1)`);break;case P:i=e.parse(`(1+(${J(i.args[0])})^2)^(-1)`);break;case Re:y=i.args[0].clone(),y.toUnitMultiplier(),i=e.parse(`${a(J(i.args[0]))}/abs${a(J(y))}`);break;case"parens":i=Z(1);break;case"cosh":i.fname="sinh";break;case"sinh":i.fname="cosh";break;case ue:i.fname=me,i.power=new _(2);break;case me:i=l(i,"-tanh");break;case qe:{let C=String(i.args[0]);i=e.parse(`-coth(${C})*csch(${C})`);break}case Be:{let C=String(i.args[0]);i=e.parse(`-csch(${C})^2`);break}case"asinh":i=e.parse(`(sqrt(1+(${J(i.args[0])})^2))^(-1)`);break;case"acosh":i=e.parse(`(sqrt(-1+(${J(i.args[0])})^2))^(-1)`);break;case"atanh":i=e.parse(`(1-(${J(i.args[0])})^2)^(-1)`);break;case Je:{let C=String(i.args[0]);i=e.parse(`-1/(sqrt(1/(${C})^2-1)*(${C})^2)`);break}case Ve:i=e.parse(`-1/((${i.args[0]})^2-1)`);break;case Ae:{let C=String(i.args[0]);i=e.parse(`-1/(sqrt(1/(${C})^2+1)*(${C})^2)`);break}case b:{let C=String(i.args[0]);i=e.parse(`1/(sqrt(1-1/(${C})^2)*(${C})^2)`);break}case R:{let C=String(i.args[0]);i=e.parse(`-1/(sqrt(1-1/(${C})^2)*(${C})^2)`);break}case B:i=e.parse(`-1/((${i.args[0]})^2+1)`);break;case"S":{let C=String(i.args[0]);i=e.parse(`sin((pi*(${C})^2)/2)`);break}case"C":{let C=String(i.args[0]);i=e.parse(`cos((pi*(${C})^2)/2)`);break}case"Si":{let C=i.args[0];i=e.parse(`sin(${C})/(${C})`);break}case"Shi":{let C=i.args[0];i=e.parse(`sinh(${C})/(${C})`);break}case"Ci":{let C=i.args[0];i=e.parse(`cos(${C})/(${C})`);break}case"Chi":{let C=i.args[0];i=e.parse(`cosh(${C})/(${C})`);break}case"Ei":{let C=i.args[0];i=e.parse(`e^(${C})/(${C})`);break}case"Li":{let C=i.args[0];i=e.parse(`1/${X.LOG}(${C})`);break}case"erf":i=e.parse(`(2*e^(-(${i.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let C=String(i.args[0]),O=String(i.args[1]);i=e.parse(`(${O})/((${O})^2+(${C})^2)`);break}case"sign":i=new Z(0);break;case"sinc":i=e.parse(H("(({0})*cos({0})-sin({0}))*({0})^(-2)",i.args[0]));break;case X.LOG10:i=e.parse(`1/((${i.args[0]})*${X.LOG}(10))`);break;default:i=e.symfunction("diff",[i,G])}i.multiplier=i.multiplier.multiply(x)}else if(h===xe||h===ne&&K(i.power)){let x;h===xe?x=i.value:h===ne&&i.contains(z)?x=i.fname+a(J(i.args[0])):x=i.value+a(J(i.args[0])),y=F.diff(e.multiply(e.parse(ke+a(x)),i.power.clone()),z),i=e.multiply(i,y)}else if(h===ne&&!i.power.equals(1))y=i.clone(),y.toLinear(),y.toUnitMultiplier(),i=e.multiply(V(i.clone()),q(y));else if(h===fe||h===he){let x=i.clone(),C=new Z(0);for(let O in i.symbols)Object.hasOwn(i.symbols,O)&&(C=e.add(C,F.diff(i.symbols[O].clone(),z)));i=e.multiply(V(x),C)}return i.updateHash(),i}function l(i,h,m){return e.multiply(i,e.parse(h+a(m||J(i.args[0]))))}function t(i){let h=i.collectSymbols(),m=new Z(0),y=h.length;for(let I=0;I<y;I++){let x=F.diff(h[I].clone(),z);for(let C=0;C<y;C++)I!==C&&(x=e.multiply(x,h[C].clone()));m=e.add(m,x)}return m}},integration:{u_substitution($,G){let p="__u__";function z(m,y,I){let x=F.diff(y,G),C=I?I(m,y):e.divide(m.clone(),x);return C.contains(G,!0)?null:C}function V(m,y){let I=F.integrate(e.symfunction(m,[new Z(p)]),p,0);return I=I.sub(new Z(p),y),I.updateHash(),I}let q=$[0].clone(),l=$[1].clone(),t=q.group,i=l.group,h;if(t===ne&&i!==ne){let m=q.args[0];if(h=z(l,m.clone()),h)return e.multiply(h,V(q.fname,m));if(h=z(l,q),h)return F.integration.poly_integrate(q)}else if(i===ne&&t!==ne){let m=l.args[0];if(h=z(q,m.clone()),h)return e.multiply(h,V(l.fname,m))}else if(t===ne&&i===ne){if(h=z(q.clone(),l.clone()),h||(h=z(l.clone(),q.clone()),h))return e.multiply(F.integration.poly_integrate(l),h)}else if(t===xe&&i!==xe){let m=q.power;if(h=z(l,m.clone()),!h){let x=F.integration.decompose_arg(m.clone(),G),C=F.diff(x[2].clone(),G),O=F.integration.decompose_arg(C.clone(),G);if(e.multiply(x[1],O[1]).power.equals(l.power)){let D=e.divide(x[0].clone(),O[0].clone()),le=e.multiply(D.clone(),e.pow(new Z(q.value),e.multiply(x[0],new Z(p))));return le=e.multiply(le,new Z(p)),F.integration.by_parts(le,p,0,{}).sub(p,x[1].clone())}}let y=F.integrate(q.sub(m.clone(),new Z(p)),p,0);return e.multiply(y.sub(new Z(p),m),h)}else if(i===xe&&t!==xe){let m=l.power;h=z(q,m.clone());let y=F.integrate(l.sub(m,new Z(p)),p,0);return e.multiply(y.sub(new Z(p),m),h)}else if(q.isComposite()||l.isComposite()){let m=function(x,C){let O=F.diff(C,G),D=n.Algebra.Factor.factorInner(x),le=n.Algebra.Factor.factorInner(O);return e.divide(D,le)},y=q.isComposite()?q.clone().toLinear():q.clone(),I=l.isComposite()?l.clone().toLinear():l.clone();if(h=z(y.clone(),I.clone(),m),h)return e.multiply(F.integration.poly_integrate(l),h);if(h=z(I.clone(),y.clone(),m),h)return e.multiply(F.integration.poly_integrate(q),h)}},poly_integrate($){let G=$.power.toString(),p=$.multiplier.toDecimal(),z=$.toUnitMultiplier().toLinear();return Number(G)===-1?e.multiply(new Z(p),e.symfunction(ke,[z])):e.parse(H("({0})*({1})^(({2})+1)/(({2})+1)",p,z,G))},stop($){throw $||="Unable to compute integral!",n.Utils.warn($),new Ze($)},partial_fraction($,G,p,z){K(G)||(G=e.parse(G));let V;V=new Z(0);let q=n.Algebra.PartFrac.partfrac($,G);return q.group===j&&q.isLinear()?(q.each(l=>{l.isLinear()||F.integration.stop()}),q.each(l=>{V=e.add(V,F.integrate(l,G,p,z))})):V=e.add(V,F.integrate(q,G,p,z)),V},get_udv($){let G=[[],[],[],[],[]],p=function(q){let l=q.group;if(l===ne){let{fname:t}=q;n.Utils.inTrig(t)||n.Utils.inHtrig(t)?G[3].push(q):n.Utils.inInverseTrig(t)?G[1].push(q):t===ke?G[0].push(q):F.integration.stop()}else l===se||q.isComposite()&&q.isLinear()||l===j&&q.isLinear()?G[2].push(q):l===xe||q.isComposite()&&!q.isLinear()?G[4].push(q):F.integration.stop()};$.group===j?$.each(q=>{p(Z.unwrapSQRT(q,!0))}):p($);let z,V=new Z(1);for(let q=0;q<5;q++){let l=G[q],t,i=l.length;if(i>0){if(i>1){t=new Z(1);for(let h=0;h<i;h++)t=e.multiply(t,l[h].clone())}else t=l[0].clone();z?V=e.multiply(V,t):(z=t,z.multiplier=z.multiplier.multiply($.multiplier))}}return[z,V]},trig_sub($,G,p,z,V,q){V||=F.integration.decompose_arg($.clone().toLinear(),G);let l=V[3],t=V[2],i=V[0],h=V[1];if(h.power.equals(2)&&i.greaterThan(0)){let m=n.Utils.getU($),y=e.parse(g+a(m)),I=e.parse(`${r+a(m)}^2`),x=e.multiply($.sub(h,y),I),C=F.integrate(x,m,p,z).sub(y,h);return n.Utils.clearU(y),C}},by_parts($,G,p,z){z.previous||=[];let V,q=F.integration.get_udv($),l=q[0],t=q[1],i=Z.unwrapSQRT(e.expand(F.diff(l.clone(),G)),!0),h=i.clone().stripVar(G);i=e.divide(i,h.clone());let m=F.integrate(t.clone(),G,p||0),y=e.multiply(m.clone(),i),I=y.toString();if(z.previous.indexOf(I)!==-1&&n.Utils.inTrig(l.fname)&&t.isE())return z.is_cyclic=!0,new Z(1);z.previous.push(I);let x=e.multiply(l,m),C=y.multiplier.clone();y.toUnitMultiplier();let O=e.multiply(F.integrate(y.clone(),G,p,z),h);if(O.multiplier=O.multiplier.multiply(C),V=e.subtract(x,O),z.is_cyclic&&(z.previous.pop(),z.previous.length===0)){V=e.expand(V);let D=new Z(0);V.each(le=>{le.contains(G)||(D=e.add(D,le.clone()))}),V=e.divide(e.subtract(V,D.clone()),e.subtract(new Z(1),D))}return V},decompose_arg:n.Utils.decompose_fn},integrate($,G,p,z){if(!G){let V=n.Utils.variables($);V.length===1&&(G=V[0]),G||="x"}if(n.Utils.isVector($)){let V=new n.Vector([]);return $.each(q=>{V.elements.push(F.integrate(q,G))}),V}return isNaN(G)||e.error(`variable expected but received ${G}`),$.isConstant(!0)?e.multiply($.clone(),e.parse(G)):(z||={},n.Utils.block("PARSE2NUMBER",()=>{p||=0;let V=K(G)?G.toString():G,q=Z.unwrapSQRT($.clone(),!0),l=q.group,t;try{if(++p>n.Settings.integration_depth&&F.integration.stop("Maximum depth reached. Exiting!"),!q.contains(V,!0))t=e.multiply(q.clone(),e.parse(V));else if(l===se)t=F.integration.poly_integrate(q,V,p);else if(l===xe)if(q.previousGroup===ne&&!(q.fname==="sqrt"||q.fname===X.PARENTHESIS)&&F.integration.stop(),q.contains(V)&&q.previousGroup!==ne)q.power.contains(V)?F.integration.stop():(F.diff(q.clone().toLinear(),V).contains(V)&&F.integration.stop(),t=F.integration.poly_integrate(q,V,p));else{let i=F.diff(q.power.clone(),V);if(i.contains(V)){let h=i.stripVar(V),m=e.divide(i.clone(),h.clone());if(m.group===se&&m.isLinear())return h.multiplier=h.multiplier.divide(new _(2)),e.parse(H("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",h,V,q.multiplier));F.integration.stop()}if(q.isE())i.isLinear()?t=q:i.isE()&&i.power.group===se&&i.power.power.equals(1)?t=e.multiply(e.symfunction("Ei",[q.power.clone()]),q.power):F.integration.stop();else{let h=e.symfunction(ke,[e.parse(q.value)]);t=e.divide(q,h)}t=e.divide(t,i)}else if(q.isComposite()&&q.isLinear()){let i=e.parse(q.multiplier);q.toUnitMultiplier(),t=new Z(0),q.each(h=>{t=e.add(t,F.integrate(h,V,p))}),t=e.multiply(i,t)}else if(l===fe)if(q.power.greaterThan(1)&&(q=e.expand(q)),q.power.equals(1))t=new Z(0),q.each(i=>{t=e.add(t,F.integrate(i,V,p))},!0);else{let i=Number(q.power),h=q.multiplier.clone();q.toUnitMultiplier();let m=q.clone().toLinear(),y=F.integration.decompose_arg(m,V),I=y[3],x=y[2],C=y[0],O=y[1];if(i===-1&&O.group!==he&&O.power.equals(2)){let D=ae(I)?I>0:!0;if(O.group===se&&O.power.equals(2)&&D){let le=function(Fe){let He=new Z(1);return Fe.each(Te=>{He=e.multiply(He,Te.fname==="abs"?Te.args[0]:Te)}),He},ge=C.clone(),de=I.clone();ge=e.pow(ge,new Z(1/2)),de=e.pow(de,new Z(1/2));let be=e.multiply(le(de),le(ge)),Ce=e.symfunction(P,[e.divide(e.multiply(C,O.toLinear()),be.clone())]);t=e.divide(Ce,be)}else if(O.group===se&&O.isLinear())t=e.divide(F.integration.poly_integrate(q),C);else if(O.power.equals(4)){let le=a,ge=e.parse(`${Se+le(C)}*${V}^2`),de=e.parse(`${Se+le(2)}*${le(C)}^${le("1/4")}*${le(I)}^${le("1/4")}*${V}`),be=e.parse(Se+le(I)),Ce=e.add(e.add(ge.clone(),de.clone()),be.clone()),Fe=e.add(e.subtract(ge,de),be),He=e.parse(`${Se+le(2)}*${le(I)}^${le("3/4")}`),Te=e.parse(`${Se+le(I)}*${le(I)}^${le("1/4")}*${V}`),ze=e.parse(`2*${le(I)}*${Se}${le(2)}*${le(I)}^${le("1/4")}`),st=e.divide(e.subtract(He.clone(),Te.clone()),e.multiply(ze.clone(),Fe)),gt=e.divide(e.add(He,Te),e.multiply(ze,Ce.clone()));t=e.add(F.integrate(st,V,p,z),F.integrate(gt,V,p,z))}else t=F.integration.partial_fraction(q,V,p)}else if(i===-1/2)if(O.group===se&&O.power.equals(2))if(x.multiplier.lessThan(0)&&!I.multiplier.lessThan(0))if(C.negate(),I.isConstant()&&C.isConstant()){let D=e.symfunction(Se,[C.clone()]),le=e.symfunction(Se,[e.multiply(C.clone(),I)]);t=e.divide(e.symfunction(v,[e.divide(x.toLinear(),le)]),D)}else{let D=e.symfunction(Se,[C]),le=e.multiply(D.clone(),O.clone().toLinear());t=e.divide(e.symfunction(P,[e.divide(le,e.symfunction(Se,[m.clone()]))]),D)}else F.integration.stop();else F.integration.stop();else if(i===1/2&&O.power.equals(2)&&C.greaterThan(0))F.integration.stop();else if(O.isLinear()&&O.group!==he)t=e.divide(F.integration.poly_integrate(q),C);else if(O.power.equals(2)&&C.greaterThan(0)){let D=e.parse(Se+a(C)),le=e.parse(Se+a(I)),ge=e.multiply(D.clone(),le.clone()).invert(),de=e.pow(I,new Z(q.power)),be=n.Utils.getU(q),Ce=e.multiply(ge,O.clone().toLinear()),Fe=e.symfunction(P,[Ce]),He=(Math.abs(q.power)-1)*2,Te=F.integrate(e.parse(`${u+a(be)}^${He}`));return n.Utils.clearU(be),e.multiply(Te.sub(be,Fe),de)}else if(q.group!==j&&!q.power.lessThan(0))t=F.integration.by_parts(q,V,p,z);else{let D=q.clone().toLinear(),ge=n.Algebra.Factor.factorInner(D).toString()!==D.toString();if(n.Algebra.degree(D,e.parse(V)).equals(2)&&!ge)try{let de=n.Algebra.sqComplete(D,V),be=n.Utils.getU(D),Ce=de.f.sub(de.a,be),Fe=e.pow(Ce,e.parse(q.power));t=F.integrate(Fe,be).sub(be,de.a)}catch(de){if(de.message==="timeout")throw de;F.integration.stop()}else t=F.integration.partial_fraction(q,V,p,z)}t.multiplier=t.multiplier.multiply(h)}else if(l===ne){let i=q.args[0],h=q.multiplier.clone();q.toUnitMultiplier();let m=F.integration.decompose_arg(i,V),y=m[0],I=m[1],{fname:x}=q;if(x===ke||x===v||x===M||x===P&&I.isLinear()){let C=q.power.toString();if(ae(C)&&(p-=C),i.isComposite()){let O=n.Utils.getU(q),D=e.pow(e.parse(ke+a(O)),new Z(C)),le=F.diff(i,V),ge=e.multiply(D,le),de=F.integrate(ge,O,p,z);t=e.multiply(e.parse(h),de.sub(O,i))}else t=e.multiply(e.parse(h),F.integration.by_parts(q,V,p,z))}else if(x===g&&q.power.lessThan(0)){let C=q.clone();return C.power.negate(),C.fname=S,e.multiply(e.parse(h),F.integrate(C,V,p))}else{if(!y.contains(V,!0)&&q.isLinear())if(x===Re){let C=e.divide(i.clone(),y.clone());if(C.group===se&&!C.power.lessThan(0))if(n.Utils.even(C.power))t=F.integrate(i,V,p);else{let O=F.integrate(C,V,p);O.power=O.power.subtract(new _(1)),t=e.multiply(e.multiply(e.symfunction(Re,[C.toLinear()]),O),y)}else F.integration.stop()}else{let C=q.args[0].group,O=F.integration.decompose_arg(i,V);switch((!(C===fe||C===se||C===j)||!O[1].power.equals(1)||i.hasFunc())&&F.integration.stop(),x){case u:t=e.symfunction(W,[i]);break;case W:t=e.symfunction(u,[i]),t.negate();break;case g:t=e.parse(H(`${X.LOG}(sec({0}))`,i));break;case r:t=e.parse(H(`${X.LOG}(tan({0})+sec({0}))`,i));break;case d:t=e.parse(H(`-${X.LOG}(csc({0})+cot({0}))`,i));break;case S:t=e.parse(H(`${X.LOG}(sin({0}))`,i));break;case Q:t=e.symfunction(te,[i]);break;case te:t=e.symfunction(Q,[i]);break;case ue:t=e.parse(H(`${X.LOG}(cosh({0}))`,i));break;case b:t=F.integration.by_parts(q,V,p,z);break;case R:t=F.integration.by_parts(q,V,p,z);break;case B:t=F.integration.by_parts(q,V,p,z);break;case Je:t=F.integration.by_parts(q,V,p,z);break;case Ae:t=F.integration.by_parts(q,V,p,z);break;case Ve:t=F.integration.by_parts(q,V,p,z);break;case me:t=e.parse(H("atan(sinh({0}))",i));break;case qe:t=e.parse(H(`${X.LOG}(tanh(({0})/2))`,i));break;case Be:t=e.parse(H(`${X.LOG}(sinh({0}))`,i));break;case ye:t=F.integrate(e.parse(H("e^({0})",i)),V,p);break;case"S":{let D=q.args[0].clone(),le=F.integration.decompose_arg(D,V),ge=le[1],de=le[0],be=le[3];t=e.parse(H("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",de,be,I));break}case"C":{let D=q.args[0].clone(),le=F.integration.decompose_arg(D,V),ge=le[1],de=le[0],be=le[3];t=e.parse(H("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",de,be,ge));break}case"erf":{let D=q.args[0].clone(),le=F.integration.decompose_arg(D,V),ge=le[1],de=le[0];t=e.parse(H("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",de,ge,D));break}case"sign":t=e.multiply(q.clone(),i.clone());break;default:F.integration.stop()}t=e.divide(t,y)}else if(I.isLinear())if(x===u||x===W){let C=Number(q.power);if(C<0)q.fname=x===W?d:r,q.invert().updateHash(),t=F.integrate(q,V,p);else{let O=q.args[0],D=q.clone(),le=q.clone(),ge=new Z((C-1)/C),de=e.multiply(y.clone(),new Z(C)).invert();D.power=D.power.subtract(new _(1)),le.power=le.power.subtract(new _(2));let be=e.symfunction(x===u?W:u,[i.clone()]);x===W&&be.negate(),t=e.add(e.multiply(e.multiply(de,D),be),e.multiply(ge,F.integrate(e.parse(le),V,p)))}}else if(x===g||x===S){if(q.args[0].isLinear(V)){let C=q.power.subtract(new _(1)).toString(),O=q.clone().toUnitMultiplier(),D=e.parse(H(`${x===S?"-":""}1/({2}*{0})*{3}({1})^({0})`,C,i,y,x));O.power=O.power.subtract(new _(2)),O.power.equals(0)&&(O=e.parse(O)),t=e.subtract(D,F.integrate(O,V,p))}}else if(x===r||x===d){let C=q.power.subtract(new _(1)).toString(),O=q.power.subtract(new _(2)).toString(),D=x===r?g:S,le=q.clone().toUnitMultiplier(),ge=H(`${x===d?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,y,C,O,i,x,D),de=e.parse(ge);le.power=le.power.subtract(new _(2)),le.power.equals(0)&&(le=e.parse(le)),t=e.add(de,e.multiply(new Z(O/C),F.integrate(le,V,p)))}else(x===te||x===Q)&&q.power.equals(2)?t=F.integrate(q.fnTransform(),V,p):F.integration.stop();else F.integration.stop();t.multiplier=t.multiplier.multiply(h)}}else if(l===he)t=F.integration.partial_fraction(q,V,p);else if(l===j){q.getDenom().group===se&&(q=e.expand(q));let h=q.stripVar(V),m=e.divide(q.clone(),h.clone());if(h.contains(V)&&(m=e.multiply(m,h),h=new Z(1)),m.group===j){let y=m.collectSymbols().sort((x,C)=>x.group===C.group?Number(x.power)===Number(C.power)?x<C?1:-1:C.power-x.power:C.group-x.group).map(x=>{let C=Z.unwrapSQRT(x,!0);return C.fname===ye?e.parse(H("({1})*e^({0})",C.args[0],C.multiplier)):C}),I=y.length;if(q.power<0){if(I===2)return F.integrate(e.expand(q),V,p,z)}else if(I===2){try{t=F.integration.u_substitution(y,V)}catch(x){if(x.message==="timeout")throw x}if(!t){let x=y[0].group,C=y[1].group,O=y[0],D=y[1],le=O.fname,ge=D.fname;if(q=e.multiply(O.clone(),D.clone()),x===ne&&C===ne)if(le===ke||ge===ke)t=F.integration.by_parts(q.clone(),V,p,z);else{y.sort((Te,ze)=>ze.fname>Te.fname);let de=O.args[0];(!de.isLinear()||!(de.group===fe||de.group===j||de.group===se))&&F.integration.stop();let be=F.integration.decompose_arg(de,V),Ce=be[1],Fe=be[0];Ce.isLinear()||F.integration.stop();let He=D.args[0];if(de.equals(He))if(le===W&&ge===u||le===u&&ge===W)if(O.power.lessThan(0)&&F.integration.stop(),le===W&&O.power.add(D.power).equals(0))O.fname=g,O.updateHash(),t=F.integrate(O,V,p);else if(Ie(O.power)&&ge===u&&D.power.lessThan(0)){let Te=Number(O.power)/2,ze=e.parse(H("(1-cos({0})^2)^({1})",O.args[0],Te));t=F.integrate(e.expand(e.multiply(ze,D.clone())),V,p,z)}else if(Ie(O.power)&&ge===W&&D.power.lessThan(0)){let Te=Number(O.power)/2,ze=e.parse(H("(1-sin({0})^2)^({1})",O.args[0],Te));t=F.integrate(e.expand(e.multiply(ze,D.clone())),V,p,z)}else{let Te=n.Utils.even(O.power),ze=n.Utils.even(D.power);if(t=new Z(0),!Te||!ze){let st,gt;Te?(st=O,gt=D):(st=D,gt=O);let wt=st.fname===u?-1:1,ft=(gt.power-1)/2,yt=e.parse(`(1-${st.fname}${n.Utils.inBrackets(de)}^2)^${ft}`);e.expand(e.multiply(new Z(wt),e.multiply(st.clone(),yt))).each(qt=>{t=e.add(t,F.integration.poly_integrate(qt.clone()))})}else{let st=function(yt){let qt=yt.power/2,Pt;return yt.fname===u?Pt=`((1/2)+(cos(2*(${yt.args[0]}))/2))^${qt}`:Pt=`((1/2)-(cos(2*(${yt.args[0]}))/2))^${qt}`,e.parse(Pt)},gt=st(O),wt=st(D),$t=e.multiply(gt,wt);return e.expand($t).each(yt=>{t=e.add(t,F.integrate(yt,V,p))}),e.multiply(t,h)}}else if(le===r&&ge===g&&Ce.isLinear()&&D.isLinear())t=e.parse(H("sec({0})^({1})/({1})",O.args[0],O.power));else if(le===g&&ge===r&&Ce.isLinear())if(O.isLinear()&&D.isLinear())t=e.divide(e.symfunction(r,[de.clone()]),Fe);else if(Ie(O.power)){let Te=Number(O.power)/2,ze=e.parse(H("(sec({0})^2-1)^({1})",O.args[0],Te));t=F.integrate(e.expand(e.multiply(ze,D)),V,p)}else F.integration.stop();else if(le===r&&ge===u)O.fname=u,O.invert().updateHash(),t=F.integrate(e.multiply(O,D),V,p);else if(le===W&&ge===d)D.fname=W,D.invert().updateHash(),t=F.integrate(e.multiply(O,D),V,p);else if(le===g&&(ge===u||ge===W)&&D.power.lessThan(0)){let Te=e.multiply(O.fnTransform(),D);t=F.integrate(e.expand(Te),V,p)}else{let Te=e.multiply(O.fnTransform(),D.fnTransform());t=F.integrate(e.expand(Te),V,p)}else if((le===W||le===u)&&(ge===W||ge===u))if(O.isLinear()&&D.isLinear())if(O.args[0].isLinear()&&D.args[0].isLinear()){let Te,ze;ge===W?(Te=O.args[0],ze=D.args[0]):(ze=O.args[0],Te=D.args[0]);let st=e.parse(H("(sin(({1})+({0}))+sin(({1})-({0})))/2",Te.toString(),ze.toString()));t=F.integrate(st,V,p)}else{let Te=Le(y);t=F.integrate(e.expand(Te),V,p)}else{let Te=new Z(1);y.forEach(st=>{let gt=st.fnTransform();Te=e.multiply(Te,gt)});let ze=e.expand(Te);t=F.integrate(ze,V,p),t.hasIntegral()&&(t=F.integrate(Le(Te.collectSymbols()),V,p))}else F.integration.stop()}else if(x===ne&&C===se){let de=O.isLinear();if(O.fname===u&&de&&D.power.equals(-1))t=e.symfunction("Ci",[O.args[0]]);else if(O.fname===u&&D.power.equals(-1))t=F.integrate(e.multiply(O.fnTransform(),D.clone()),V,p);else if(O.fname===te&&de&&D.power.equals(-1))t=e.symfunction("Chi",[O.args[0]]);else if(O.fname===te&&D.power.equals(-1))t=F.integrate(e.multiply(O.fnTransform(),D.clone()),V,p);else if(O.fname===W&&de&&D.power.equals(-1))t=e.symfunction("Si",[O.args[0]]);else if(O.fname===W&&D.power.equals(-1))t=F.integrate(e.multiply(O.fnTransform(),D.clone()),V,p);else if(O.fname===Q&&de&&D.power.equals(-1))t=e.symfunction("Shi",[O.args[0]]);else if(O.fname===Q&&D.power.equals(-1))t=F.integrate(e.multiply(O.fnTransform(),D.clone()),V,p);else if(O.fname===ke&&D.power.equals(-1))t=F.integration.poly_integrate(O,V,p);else if(O.fname==="erf"){if(D.power.equals(1)){let be=F.integration.decompose_arg(O.args[0],V),Ce=be[0],Fe=be[1],He=O.args[0].toString();t=e.parse(H("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",Ce,Fe,He))}}else t=F.integration.by_parts(q,V,p,z)}else if(x===xe&&C===se){let de=le===ke?F.integration.decompose_arg(O.args[0],V)[1]:null;O.isE()&&(O.power.group===se||O.power.group===j)&&D.power.equals(-1)?t=e.symfunction("Ei",[O.power.clone()]):le===ke&&de.value===D.value?t=F.integration.poly_integrate(O,V,p):t=F.integration.by_parts(q,V,p,z)}else if(x===he&&C===se){if(D.value===O.value&&O.power.equals(-1)){let de=Math.min.apply(null,n.Utils.keys(O.symbols)),be=Math.min(de,D.power),Ce=D.clone();Ce.power=new _(be),D=e.divide(D,Ce.clone());let Fe=new Z(0);O.each(He=>{Fe=e.add(Fe,e.divide(He.clone(),Ce.clone()))}),Fe.multiplier=O.multiplier,q=e.divide(D,Fe)}else q=e.expand(q);t=F.integration.partial_fraction(q,V,p)}else if(x===fe&&C===se){let de=O.clone().toLinear(),be=n.Algebra.degree(de,e.parse(V)).equals(1);if(O.power.equals(-1/2)){let Ce=F.integration.decompose_arg(O.clone().toLinear(),V),Fe=Ce[0].negate(),He=Ce[1],Te=Ce[3],ze=Number(O.power),st=Number(D.power);if(ae(st)&&n.Utils.even(st)&&He.power.equals(2)){let gt=e.divide(e.multiply(e.pow(Te.clone(),new Z(2)),e.symfunction(Se,[e.divide(Te.clone(),Fe.clone())])),e.pow(Fe.clone(),new Z(2)));gt=e.multiply(gt,e.symfunction(Se,[Te]).invert());let wt=e.parse("sin(u)");wt.power=wt.power.multiply(D.power);let $t=F.integrate(wt,"u",p),ft=e.parse(`${v}(${Se}(${Fe}/${Te})*${V})`);t=e.multiply(gt,$t.sub(new Z("u"),ft))}else if(ze===-1/2){let gt=function(wt,$t){let ft=e.parse(F.integrate(wt,V,p,z).sub(V,H($t,V)));if(!ft.hasIntegral())return ft};st===-1?t=gt(e.expand(e.expand(e.pow(e.multiply(O.invert(),D.invert()),new Z(2)))).invert(),"sqrt(1-1/({0})^2)"):st===-2&&(t=gt(e.sqrt(e.expand(e.divide(e.pow(q,new Z(2)).invert(),e.pow(new Z(V),new Z(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(O.power.equals(-1)&&D.isLinear()&&be)t=F.integration.partial_fraction(q,V,p);else if(!O.power.lessThan(0)&&ae(O.power)){let Ce=e.expand(O);t=new Z(0),Ce.each(Fe=>{Fe.group===he?Fe.each(He=>{t=e.add(t,F.integrate(e.multiply(D.clone(),He),V,p))}):t=e.add(t,F.integrate(e.multiply(D.clone(),Fe),V,p))})}else if(O.power.lessThan(-2))t=F.integration.by_parts(q,V,p,z);else if(O.power.lessThan(0)&&D.power.greaterThan(1)){let Ce=F.integration.decompose_arg(O.clone().toLinear(),V),Fe=Ce[0].negate(),He=Ce[1],Te=Ce[3],ze=O.clone().toLinear();if(He.group!==he&&He.isLinear()){let st=Number(D.power),gt="_u_",wt=new Z(gt),$t=e.expand(e.divide(e.pow(e.subtract(wt.clone(),Te.clone()),new Z(st)),wt.clone())),ft={};ft[gt]=ze;let yt=e.parse($t,ft);t=F.integrate(yt,V,0)}else if(D.power.greaterThan(He.power)||D.power.equals(He.power)){let st=new n.Algebra.Classes.Factors;O=n.Algebra.Factor.coeffFactor(O.invert(),st);let gt=n.Algebra.divide(D,O);gt.group===j?t=F.integration.by_parts(q,V,p,z):(t=new Z(0),gt.each(wt=>{t=e.add(t,F.integrate(wt,V,p))}),st.each(wt=>{t=e.divide(t,wt)}),t=e.expand(t))}else t=F.integration.partial_fraction(q,V,p)}else if(O.power.den.equals(2)){let Ce=F.integration.decompose_arg(O.clone().toLinear(),V),Fe=Ce[3],He=Ce[1],Te=Ce[0],ze=Ce[2];if(He.power.equals(2)&&Te.lessThan(0)){Fe.equals(1)||(h=e.multiply(h,e.pow(Fe,new Z(2))));let st=V,gt=e.divide(e.pow(Te.clone().negate(),new Z(1/2)),e.pow(Fe,new Z(1/2))),wt=e.symfunction(u,[new Z(st)]),$t=e.pow(e.symfunction(u,[new Z(st)]),new Z(O.power.num)),ft=e.pow(e.symfunction(W,[new Z(st)]),new Z(D.power)),yt=e.multiply(e.multiply($t,wt),ft);t=F.integrate(yt,st,p).sub(st,e.symfunction(v,[e.multiply(new Z(V),gt)]))}else t=F.integration.partial_fraction(q,V,p,z)}else be&&(t=F.integration.partial_fraction(q,V,p))}else if(O.isComposite()&&D.isComposite())if(t=new Z(0),O.power.greaterThan(0)&&D.power.greaterThan(0))e.expand(q).each(be=>{t=e.add(t,F.integrate(be,V,p))},!0);else{let de=Number(O.power),be=Number(D.power);if(de<0&&be>0){let Ce=O;O=D,D=Ce}de===-1&&be===-1?t=F.integration.partial_fraction(q,V):O.each(Ce=>{let Fe=e.multiply(Ce,D.clone()),He=F.integrate(Fe,V,p);t=e.add(t,He)})}else if(x===fe&&y[0].power.greaterThan(0))O=e.expand(O),t=new Z(0),O.each(de=>{t=e.add(t,F.integrate(e.multiply(de,D.clone()),V,p))},!0);else if(x===ne&&C===xe&&n.Utils.inHtrig(O.fname))O=O.fnTransform(),t=F.integrate(e.expand(e.multiply(O,D)),V,p);else if(x===ne&&C===fe||C===ne&&x===fe){if(C===ne&&x===fe){let ze=O;O=D,D=ze}let de,be,Ce,Fe,He=Z.unwrapSQRT(F.diff(O.clone(),V),!0),Te=Z.unwrapSQRT(D,!0);if(He.power.equals(Te.power)){if(de=new Z(D.power),Ce=He.clone().toLinear(),Fe=D.clone().toLinear(),be=n.Algebra.divide(Ce.toLinear(),Fe),be.isConstant()){let ze=e.pow(be,de.negate());t=e.multiply(ze,F.integration.poly_integrate(O.clone()))}}else t=F.integration.by_parts(q,V,p,z)}else{let de=O.clone().toLinear(),be=D.clone().toLinear();x===xe&&C===xe&&O.power.contains(V)&&D.power.contains(V)&&!de.contains(V)&&!be.contains(V)?t=e.parse(H("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",de.toString(),be.toString(),O.power.multiplier.toString(),D.power.multiplier.toString(),V)):t=F.integration.by_parts(q,V,p,z)}}}else if(I===3&&(y[2].group===se&&y[2].power.lessThan(2)||y[0].group===fe)){let x=y[0];if(x.group===fe){x.power.greaterThan(1)&&(x=e.expand(x));let C=e.multiply(y[1],y[2]);t=new Z(0),x.each(O=>{let D=e.multiply(O,C.clone()),le=F.integrate(D,V,p);t=e.add(t,le)},!0)}else t=F.integration.by_parts(q,V,p,z)}else if(it(y)){let x=new Z(1);for(let C=0,O=y.length;C<O;C++)x=e.multiply(x,y[C].fnTransform());x=e.expand(x),t=F.integrate(x,V,p)}else{let x=Le(y);t=F.integrate(e.expand(x),V,p)}}else{if(m.equals(1))return F.integrate(e.expand(q),V,p);m.clone().toLinear().isPoly(!0)&&n.Utils.variables(m).length>1&&(m=n.Algebra.Factor.factorInner(m)),t=F.integrate(m,V,p)}t=e.multiply(t,h)}if(t)return t}catch(i){if(i.message==="timeout"||!(i instanceof Ze||i instanceof n.exceptions.DivisionByZero))throw i}return e.symfunction("integrate",[$,G])},!1))},defint($,G,p,z){z||="x";let V=function(h,m,y){try{return e.parse(h,m)}catch(I){if(I.message==="timeout")throw I;return F.Limit.limit(h,z,y)}},q=n.Utils.variables($),l=$.hasTrig(),t,i;if(q.length===1&&!z&&(z=q[0]),l||(i=F.integrate($,z)),!l&&!i.hasIntegral()){let h={},m={};h[z]=p,m[z]=G;let y=V(i,h,p,z),I=V(i,m,G,z);t=e.subtract(y,I)}else if(q.length===1&&G.isConstant()&&p.isConstant()){let h=n.Utils.build($);t=new Z(n.Math2.num_integrate(h,Number(G),Number(p)))}else t=e.symfunction("defint",[$,G,p,z]);return t},Limit:{interval($,G){return e.parse(H("[{0}, {1}]",$,G))},diverges(){return F.Limit.interval("-Infinity","Infinity")},divide($,G,p,z,V){if(V++>X.max_lim_depth)return;let q=$.clone(),l=G.clone();if(G.fname===Re){let D=$.sign(),le=z.sign();if(z.isInfinity)return e.multiply(new Z(D),new Z(le));if(z.equals(0)){let ge=e.parse($.multiplier),de=e.parse(G.multiplier);return e.divide(e.multiply(ge,F.Limit.interval("-1","1")),de)}return F.Limit.diverges()}let t=function(D){if(n.Utils.isVector(D)){for(let le=0;le<D.elements.length;le++)if(!D.elements[le].isInfinity)return!1;return!0}return D.isInfinity},i=function(D,le){return n.Utils.isVector(D)?!1:D.equals(le)},h,m=0,y,I,x;do if(y=Ue(F.Limit.limit($.clone(),p,z,V)),I=Ue(F.Limit.limit(G.clone(),p,z,V)),x=t(y)&&t(I)||i(y,0)&&i(I,0),x){let D=F.diff($.clone(),p),le=F.diff(G.clone(),p),ge=e.divide(D,le);$=ge.getNum(),G=ge.getDenom()}while(x&&++m<X.max_lim_depth);if(m>=X.max_lim_depth)return;let C=I.equals(0),O=Number(l.power);return z.isConstant(!0)&&C?h=Z.infinity(n.Utils.even(O)&&y.lessThan(0)?-1:void 0):C?h=F.Limit.diverges():h=e.divide(y,I),h},rewriteToLog($){let G=$.power.clone();return $.toLinear(),e.pow(new Z("e"),e.multiply(G,e.symfunction(`${X.LOG}`,[$])))},getSubbed($,G,p){let z;$.group===xe&&($=F.rewriteToLog($));try{z=$.sub(G,p)}catch(V){if(V.message==="timeout")throw V;z=$}return z},isInterval($){return n.Utils.isVector($)},isConvergent($){return!(F.Limit.isInterval($)&&$.elements[0].isInfinity&&$.elements[1].isInfinity||$.containsFunction("limit"))},limit($,G,p,z){if($.isLinear()&&$.isComposite()){let l=new Z(0);return $.each(t=>{l=e.add(l,F.Limit.limit(t,G,p,z))},!0),l}if($=n.Algebra.Simplify.simplify($),z||=1,z++>X.max_lim_depth)return;let V=e.parse($.multiplier);$.toUnitMultiplier();let q;try{if($.isConstant(!0))q=$;else{let l={};l[G]=p;try{let t=e.parse($.sub(G,p),l);(t.isConstant(!0)||t.isInfinity)&&(q=t)}catch(t){if(t.message==="timeout")throw t}if(!q){let t=$.getNum(),i=$.getDenom();if(i.isConstant(!0)){if($.group===xe){let h=$.clone().toLinear(),m=$.power.clone(),y=h.getNum(),I=h.getDenom(),x=n.Utils.decompose_fn(I,G,!0);if(y.group===se&&y.multiplier.isOne()&&x.ax.group===se&&x.b.isConstant(!0)&&x.a.isOne()&&x.b.isConstant(!0))q=e.parse(H("(1/e^({0}))",x.b));else{let C=F.Limit.rewriteToLog($.clone()),O=C.power.clone(),D=C.clone().toLinear(),le=F.Limit.limit(D,G,p,z),ge=F.Limit.limit(O,G,p,z);q=e.pow(le,ge)}}else if($.group===ne&&$.args.length===1){let h,m=F.Limit.limit($.args[0],G,p,z);if(n.Utils.isVector(m))return q=m.map(I=>{let x=$.clone();return x.args[0]=I,F.Limit.limit(e.symfunction($.fname,[I]),G,p,z)}),e.multiply(V,q);let y;if(m.isConstant(!0)){y=e.symfunction($.fname,[m]);try{Ue(y),h=!0}catch(I){if(I.message==="timeout")throw I;h=!1}}if(h)q=y;else if(F.Limit.isConvergent(m)){if($.fname===ke)switch(m.toString()){case"0":q=Z.infinity().negate();break;case"Infinity":q=Z.infinity();break;case"-Infinity":q=Z.infinity();break}else if(($.fname===u||$.fname===W)&&p.isInfinity)q=F.Limit.interval(-1,1);else if($.fname===g){let I=$.args[0],x=I.getNum(),C=I.getDenom(),O=x.toUnitMultiplier();(p.isInfinity||O.equals("pi")&&C.equals(2))&&(q=F.Limit.diverges())}else if($.fname===X.FACTORIAL&&m.isInfinity)return Z.infinity()}}else if($.group===se){if($.power>0)return e.parse($,l);n.Utils.even($.power)?q=Z.infinity():q=F.Limit.diverges()}else if($.group===j){let h,m,y=$.collectSymbols().sort((x,C)=>x.group-C.group),I=y.pop();for(h=Ue(F.Limit.limit(I,G,p,z));y.length;){let x=y.pop();m=Ue(F.Limit.limit(x,G,p,z)),h.isInfinity||!F.Limit.isConvergent(h)&&m.equals(0)||h.equals(0)&&F.Limit.isConvergent(m)?(x.containsFunction(ke)&&(x=[I,I=x][0]),x.invert(),h.isInfinity&&m.isInfinity?h=Z.infinity():h=F.Limit.divide(I,x,G,p,z)):(h=e.multiply(h,m),I=e.multiply(I,x))}q=h}else if($.isComposite()){let h;$.isLinear()||($=e.expand($)),q=new Z(0);let m=$.collectSymbols().sort((x,C)=>C.group-x.group),y=[],I=new Z(0);for(let x=0,C=m.length;x<C;x++){let O=m[x].clone();O.group===ne||O.group===j&&O.hasFunc()?I=e.add(I,O):y.push(O)}y.unshift(I),y.length!==1&&(m=y);for(let x=0,C=m.length;x<C;x++){let O=m[x];try{h=F.Limit.limit(O,G,p,z)}catch(D){if(D.message==="timeout")throw D;h=F.Limit.diverges()}try{q=e.add(q,h)}catch(D){if(D.message==="timeout")throw D;if(z++>X.max_lim_depth)return;q=F.Limit.limit(F.diff($,G),G,p,z)}}}}else q=F.Limit.divide(t,i,G,p,z)}}q||=e.symfunction("limit",[$,G,p])}catch(l){if(l.message==="timeout")throw l;q=e.symfunction("limit",[$,G,p])}return e.multiply(V,q)}},Fresnel:{S($){return $.isConstant(!0)?F.defint(e.parse("sin(pi*x^2/2)"),Z(0),$,"x"):e.symfunction("S",[$])},C($){return $.isConstant(!0)?F.defint(e.parse("cos(pi*x^2/2)"),Z(0),$,"x"):e.symfunction("C",[$])}}};Y0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return F.diff}},{name:"sum",visible:!0,numargs:4,build(){return F.sum}},{name:"product",visible:!0,numargs:4,build(){return F.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return F.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return F.defint}},{name:"S",visible:!0,numargs:1,build(){return F.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return F.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return F.Limit.limit}}]),Y0.updateAPI()})()});var e1=y0((Zi,yn)=>{"use strict";var O0;typeof yn<"u"&&(O0=B0(),K0());(function(){let n=O0.getCore(),e=n.PARSER,{N:_}=n.groups,{P:X}=n.groups,{S:K}=n.groups,{EX:ne}=n.groups,{FN:Z}=n.groups,{PL:J}=n.groups,{CP:a}=n.groups,{CB:ae}=n.groups,{keys:H}=n.Utils,{even:Ie}=n.Utils,{variables:Ue}=n.Utils,{format:De}=n.Utils,{round:se}=n.Utils,{Frac:he}=n,{isInt:fe}=n.Utils,{NerdamerSymbol:j}=n,{CONST_HASH:xe}=n.Settings,Ge=n.Utils.importFunctions(),ke=n.Utils.evaluate;function ye(u,g,r){if(n.Utils.isSymbol(u))this.parse(u),this.variable||=g;else if(isNaN(u))typeof u=="string"&&this.parse(e.parse(u));else{if(r||=0,g===void 0)throw new n.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[r]=u,this.fill(u)}}ye.fromArray=function(g,r){if(typeof r>"u")throw new n.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let d=new ye;return d.coeffs=g,d.variable=r,d},ye.fit=function(g,r,d,S,v,M){let P=new Array(v+1),b=d-r;P[0]=r,P[v]=g,b-=g*S**v;for(let R=v-1;R>0;R--){let B=S**R,Q=b/B,ue=Math.sign(Q)*Math.floor(Math.abs(Q));b-=ue*B,P[R]=ue}if(b!==0)return null;for(let R=0;R<P.length;R++)P[R]=new he(P[R]);return ye.fromArray(P,M)},ye.prototype={parse(u,g){if(this.variable=Ue(u)[0],!u.isPoly())throw n.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${n.Utils.text(u)}`);if(g||=[],u.power.absEquals(1)||(u=e.expand(u)),u.group===n.groups.N)g[0]=u.multiplier;else if(u.group===n.groups.S)g[u.power.toDecimal()]=u.multiplier;else for(let r in u.symbols){if(!Object.hasOwn(u.symbols,r))continue;let d=u.symbols[r],S=d.power;if(n.Utils.isSymbol(S))throw new n.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");S=d.group===_?0:S.toDecimal(),d.symbols?this.parse(d,g):g[S]=d.multiplier}this.coeffs=g,this.fill()},fill(u){u=Number(u)||0;let g=this.coeffs.length;for(let r=0;r<g;r++)this.coeffs[r]===void 0&&(this.coeffs[r]=new he(u));return this},trim(){let u=this.coeffs.length;for(;u--;){let g=this.coeffs[u],r=g.equals(0);if(g&&r){if(u===0)break;this.coeffs.pop()}else break}return this},modP(u){let g=this.coeffs.length;for(let r=0;r<g;r++){let d=this.coeffs[r],S;if(d<0){let P;for(S=r;S<g;S++)if(this.coeffs[S]>0){P=this.coeffs[S];break}if(P){for(;S>r;S--)this.coeffs[S]=this.coeffs[S].subtract(new he(1)),this.coeffs[S-1]=this.coeffs[S-1].add(new he(u));d=this.coeffs[r]}}let v=d.mod(u),M=d.subtract(v).divide(u);if(!M.equals(0)){let P=r+1,b=this.coeffs[P]||new he(0);b=b.add(M),this.coeffs[P]=new he(b),this.coeffs[r]=new he(v)}}return this},add(u){let g=Math.max(this.coeffs.length,u.coeffs.length);for(let r=0;r<g;r++){let d=this.coeffs[r]||new he(0),S=u.coeffs[r]||new he(0);this.coeffs[r]=d.add(S)}return this},subtract(u){let g=Math.max(this.coeffs.length,u.coeffs.length);for(let r=0;r<g;r++){let d=this.coeffs[r]||new he(0),S=u.coeffs[r]||new he(0);this.coeffs[r]=d.subtract(S)}return this},divide(u){let{variable:g}=this,r=n.Utils.arrayClone(this.coeffs),d=n.Utils.arrayClone(u.coeffs),S=r.length,v=d.length-1,M=[];for(let R=0;R<S;R++){let B=S-(R+1),Q=B-v,te=r[B].divide(d[v]);if(Q<0)break;M[Q]=te;for(let ue=0;ue<=v;ue++)r[ue+Q]=r[ue+Q].subtract(d[ue].multiply(te))}let P=ye.fromArray(r,g||"x").trim();return[ye.fromArray(M,g||"x"),P]},multiply(u){let g=this.coeffs.length,r=u.coeffs.length,d=[];for(let S=0;S<g;S++){let v=this.coeffs[S];for(let M=0;M<r;M++){let P=S+M,b=u.coeffs[M],R=d[P]||new he(0);d[P]=R.add(v.multiply(b))}}return this.coeffs=d,this},isZero(){let u=this.coeffs.length;for(let g=0;g<u;g++)if(!this.coeffs[g].equals(0))return!1;return!0},sub(u){let g=new he(0),r=this.coeffs.length;for(let d=0;d<r;d++){let S=this.coeffs[d];S.equals(0)||(g=g.add(S.multiply(new he(u**d))))}return g},clone(){let u=new ye;return u.coeffs=this.coeffs,u.variable=this.variable,u},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let u=this.lc(),g=this.coeffs.length;for(let r=0;r<g;r++)this.coeffs[r]=this.coeffs[r].divide(u);return this},gcd(u){let g=this.coeffs.length-1,r=u.coeffs.length-1,d;if(g<r)return u.gcd(this);let S=this;for(;!u.isZero();){let M=u.clone();S=S.clone(),d=S.divide(M),u=d[1],S=M}let v=n.Math2.QGCD.apply(null,S.coeffs);if(!v.equals(1)){let M=S.coeffs.length;for(let P=0;P<M;P++)S.coeffs[P]=S.coeffs[P].divide(v)}return S},diff(){let u=[],g=this.coeffs.length;for(let r=1;r<g;r++)u.push(this.coeffs[r].multiply(new he(r)));return this.coeffs=u,this},integrate(){let u=[0],g=this.coeffs.length;for(let r=0;r<g;r++){let d=new he(r+1);u[d]=this.coeffs[r].divide(d)}return this.coeffs=u,this},gcf(u){let g=function(S){for(let v=0;v<S.length;v++)if(!S[v].equals(0))return v},r=[];for(let S=0;S<this.coeffs.length;S++){let v=this.coeffs[S];!v.equals(0)&&r.indexOf(v)===-1&&r.push(v)}let d=[n.Math2.QGCD.apply(void 0,r),g(this.coeffs)].toDecimal();if(u){let S=[];S[d[1]-1]=d[0],d=ye.fromArray(S,this.variable).fill()}return d},quad(u){let g=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let r=this.coeffs[2]||0,d=this.coeffs[1]||0,S=this.coeffs[0],v=d*d-4*r*S;return v<0&&!u||(g[0]=(-d+Math.sqrt(v))/(2*r),g[1]=(-d-Math.sqrt(v))/(2*r)),g},squareFree(){let u=this.clone(),g=1,r=u.clone().diff(),d=u.clone().gcd(r),S=u.divide(d)[0],v=ye.fromArray([new he(1)],u.variable);for(;!d.equalsNumber(1);){let M=S.gcd(d),P=S.divide(M)[0];if(!P.equalsNumber(1)&&g>1){let b=P.clone();for(let R=1;R<g;R++)b.multiply(P.clone());P=b}v=v.multiply(P),g++,S=M,d=d.divide(M)[0]}return[v,S,g]},toSymbol(){let u=this.coeffs.length,{variable:g}=this;if(u===0)return new n.NerdamerSymbol(0);let r=u-1,d="";for(let S=0;S<u;S++){let v=S===r?"":"+",M=this.coeffs[S];M.equals(0)||(d+=`${M}*${g}^${S}${v}`)}return e.parse(d)},equalsNumber(u){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(u)},toString(){return this.toSymbol().toString()}},j.prototype.coeffs=function(g,r){r&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),g||=[];let d=this.clone().distributeMultiplier();if(d.isComposite())for(let S in d.symbols){if(!Object.hasOwn(d.symbols,S))continue;let v=d.symbols[S];v.isComposite()?v.clone().distributeMultiplier().coeffs(g,r):r?g[v.isConstant()?0:v.power.toDecimal()]=v.multiplier:g.push(v.multiplier)}else if(r)g[d.isConstant(!0)?0:d.power.toDecimal()]=d.multiplier;else if(d.group===ae&&d.isImaginary()){let S=new j(d.multiplier);d.each(v=>{(v.isConstant(!0)||v.imaginary)&&(S=e.multiply(S,v))}),g.push(S)}else g.push(d.multiplier);if(r)for(let S=0;S<g.length;S++)g[S]===void 0&&(g[S]=new j(0));return g},j.prototype.tBase=function(g){if(typeof g>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let r=[],d=this.collectSymbols(null,null,null,!0),S=d.length;for(let v=0;v<S;v++){let M=d[v],P=M.group,b=new Se(M.multiplier,[],g);if(P===ae)for(let R in M.symbols){if(!Object.hasOwn(M.symbols,R))continue;let B=M.symbols[R];b.terms[g[R]]=B.power}else b.terms[g[M.value]]=M.power;r.push(b.fill()),b.updateCount()}return r},j.prototype.altVar=function(g){let r=this.multiplier.toString(),d=this.power.toString();return(r==="1"?"":`${r}*`)+g+(d==="1"?"":`^${d}`)},j.prototype.sameVars=function(g){if(!(this.symbols||this.group===g.group))return!1;for(let r in this.symbols){if(!Object.hasOwn(this.symbols,r))continue;let d=this.symbols[r],S=g.symbols[r];if(!S||d.value!==S.value)return!1}return!0},j.prototype.groupTerms=function(g){g=String(g);let r,d,S,v=[];return this.each(M=>{if(M.group===J){S=M.groupTerms(g);for(let P=0;P<S.length;P++){let b=S[P];b&&(v[P]=b)}}else r=n.Utils.decompose_fn(M,g,!0),d=r.x.value===g?Number(r.x.power):0,v[d]=e.add(v[d]||new j(0),r.a)}),v},j.prototype.collectFactors=function(){let g=[];return this.group===ae?this.each(r=>{g.push(r.clone())}):g.push(this.clone()),g};function Re(){this.factors={},this.length=0}Re.prototype.getNumberSymbolics=function(){let g=0;return this.each(r=>{r.isConstant(!0)||g++}),g},Re.prototype.add=function(g){if(g.equals(0))return this;if(g.equals(-1)&&this.length>0){let r=n.Utils.firstObject(this.factors,null,!0),d=e.symfunction(n.Settings.PARENTHESIS,[r.obj]).negate();return delete this.factors[r.key],this.add(d),this.length--,this}if(g.group===ae){let r=this;g.multiplier.equals(1)||r.add(new j(g.multiplier)),g.each(d=>{r.add(d)})}else{this.preAdd&&(g=this.preAdd(g)),this.pFactor&&(g=e.pow(g,new j(this.pFactor)));let r=g.isConstant();if(r&&g.equals(1))return this;let d=r?g.value:g.text();d in this.factors?(this.factors[d]=e.multiply(this.factors[d],g),this.factors[d].equals(1)&&(delete this.factors[d],this.length--)):(this.factors[d]=g,this.length++)}return this},Re.prototype.toSymbol=function(){let g=new j(1),r=Object.values(this.factors).sort((d,S)=>d.group>S.group);for(let d=0,S=r.length;d<S;d++){let v=r[d],M=v.power.equals(1)&&v.fname!==""?e.symfunction(n.PARENTHESIS,[v]):v;g=e.multiply(g,M)}return g.fname===""&&(g=j.unwrapPARENS(g)),g},Re.prototype.merge=function(g){for(let r in g)r in this.factors?this.factors[r]=e.multiply(this.factors[r],g[r]):this.factors[r]=g[r];return this},Re.prototype.each=function(g){for(let r in this.factors){if(!Object.hasOwn(this.factors,r))continue;let d=this.factors[r];d.fname===n.PARENTHESIS&&d.isLinear()&&(d=d.args[0]),g.call(this,d,r)}return this},Re.prototype.count=function(){return H(this.factors).length},Re.prototype.clean=function(){try{let g=n.Settings.CONST_HASH;this.factors[g].lessThan(0)&&(this.factors[g].equals(-1)?delete this.factors[g]:this.factors[g].negate(),this.each(r=>{r.negate()}))}catch(g){if(g.message==="timeout")throw g}},Re.prototype.toString=function(){return this.toSymbol().toString()};function Se(u,g,r){this.terms=g||[],this.coeff=u,this.map=r,this.sum=new n.Frac(0),this.image=void 0}Se.prototype.updateCount=function(){this.count||=0;for(let g=0;g<this.terms.length;g++)this.terms[g].equals(0)||this.count++;return this},Se.prototype.getVars=function(){let g=[];for(let r=0;r<this.terms.length;r++){let d=this.terms[r],S=this.getRevMap();d.equals(0)||g.push(this.revMap[r])}return g.join(" ")},Se.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count},Se.prototype.toSymbol=function(g){g||=this.getRevMap();let r=new j(this.coeff);for(let d=0;d<this.terms.length;d++){let S=g[d],v=this.terms[d];if(v.equals(0)||S===xe)continue;let M=new j(S);M.power=v,r=e.multiply(r,M)}return r},Se.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let g={};for(let r in this.map)Object.hasOwn(this.map,r)&&(g[this.map[r]]=r);return this.revMap=g,g},Se.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},Se.prototype.getImg=function(){return this.image||this.generateImage(),this.image},Se.prototype.fill=function(){let g=this.map.length;for(let r=0;r<g;r++)typeof this.terms[r]>"u"?this.terms[r]=new n.Frac(0):this.sum=this.sum.add(this.terms[r]);return this},Se.prototype.divide=function(g){let r=this.coeff.divide(g.coeff),d=this.terms.length,S=new Se(r,[],this.map);for(let v=0;v<d;v++)S.terms[v]=this.terms[v].subtract(g.terms[v]),S.sum=S.sum.add(S.terms[v]);return S},Se.prototype.multiply=function(g){let r=this.coeff.multiply(g.coeff),d=this.terms.length,S=new Se(r,[],this.map);for(let v=0;v<d;v++)S.terms[v]=this.terms[v].add(g.terms[v]),S.sum=S.sum.add(S.terms[v]);return S},Se.prototype.isZero=function(){return this.coeff.equals(0)},Se.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},n.Utils.toMapObj=function(g){let r=0,d={};for(let S=0;S<g.length;S++){let v=g[S];typeof d[v]>"u"&&(d[v]=r,r++)}return d.length=r,d},n.Utils.filledArray=function(g,r,d){let S=[];for(;r--;)S[r]=d?new d(g):g;return S},n.Utils.arrSum=function(g){let r=0,d=g.length;for(let S=0;S<d;S++)r+=g[S];return r},n.Utils.haveIntersection=function(g,r){return r.length>g.length&&([g,r]=[r,g]),g.some(d=>r.indexOf(d)>-1)},n.Utils.subFunctions=function(g,r){r||={};let d=[],S=new Set(Ue(g));return g.each(v=>{if(v.group===Z||v.previousGroup===Z){let M=n.Utils.text(v,"hash"),P=r[M];if(P)d.push(v.altVar(P));else{let b=0,R;do R=v.fname+H(r).length+(b>0?String(b):""),b++;while(S.has(R));r[M]=R,d.push(v.altVar(R))}}else v.group===ae||v.group===J||v.group===a?d.push(n.Utils.subFunctions(v,r)):d.push(v.text())}),g.group===a||g.group===J?g.altVar(n.Utils.inBrackets(d.join("+"))):g.group===ae?g.altVar(n.Utils.inBrackets(d.join("*"))):g.text()},n.Utils.getFunctionsSubs=function(g){let r={};for(let d in g)Object.hasOwn(g,d)&&(r[g[d]]=e.parse(d));return r};let W=n.Algebra={version:"1.4.6",proots(u,g){g||=7;let r=0,d=[],S=function(M,P,b){let R=v(M,P,b).concat(d);for(let B=0;B<r;B++)R.unshift(0);return R};if(u instanceof j&&u.isPoly()){if(u.distributeMultiplier(),u.group===J){let te=n.Utils.arrayMin(H(u.symbols)),ue=u.symbols[te].clone().toUnitMultiplier();u=e.expand(e.divide(u,ue)),d.push(0)}if(u.group===n.groups.S)return[0];if(u.group===n.groups.PL){let te=H(u.symbols),ue=n.Utils.arrayMin(te);u=n.PARSER.divide(u,n.PARSER.parse(`${u.value}^${ue}`))}let M=H(u.symbols).sort().pop(),P=u.group===n.groups.PL?u.symbols:u.symbols[M],b=P.group,R=b===K?[P.power.toDecimal()]:H(P.symbols),B=[],Q=n.Utils.arrayMax(R);for(let te=1;te<=Q;te++){let ue=0;R.indexOf(`${te}`)!==-1&&(b===K?ue=P.multiplier:ue=P.symbols[te].multiplier),B.unshift(ue)}return B.push(u.symbols[xe].multiplier),P.group===K&&(B[0]=P.multiplier),S(B,R,Q)}if(n.Utils.isArray(u)){let M=u,P=[],b=[],R=0;for(let Q=0;Q<M.length;Q++){let te=M[Q][0],ue=M[Q][1],qe=ue-R-1;for(let me=0;me<qe;me++)P.unshift(0);P.unshift(te),ue!==0&&b.push(ue),R=ue}let B=Math.max.apply(void 0,b);return S(P,b,B)}throw new n.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function v(M,P,b){let B,Q=M.slice(0);if(M.unshift(b),b>100)throw new n.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let te=[],ue={};for(ue.Degree=b,B=0;B<b;B++)te.push(0);let qe=te.slice(0);function me(Le,F,$,G,p,z){p[0]=z.b=G[0],p[1]=z.a=-(F*z.b)+G[1];for(let V=2;V<Le;V++)p[V]=-(F*z.a+$*z.b)+G[V],z.b=z.a,z.a=p[V]}function Be(Le,F,$,G,p,z,V,q,l){let t={},i=3;return t.b=t.a=0,me(F,V,q,z,l,t),p.c=t.a,p.d=t.b,Math.abs(p.c)<=100*Le*Math.abs(z[F-1])&&Math.abs(p.d)<=100*Le*Math.abs(z[F-2])||(p.h=q*G,Math.abs(p.d)>=Math.abs(p.c)?(i=2,p.e=$/p.d,p.f=p.c/p.d,p.g=V*G,p.a3=p.e*(p.g+$)+p.h*(G/p.d),p.a1=-$+p.f*G,p.a7=p.h+(p.f+V)*$):(i=1,p.e=$/p.c,p.f=p.d/p.c,p.g=p.e*V,p.a3=p.e*$+(p.g+p.h/p.c)*G,p.a1=-($*(p.d/p.c))+G,p.a7=p.g*p.d+p.h*p.f+$)),i}function Je(Le,F,$,G,p,z,V,q,l){if($===3){V[1]=V[0]=0;for(let i=2;i<F;i++)V[i]=q[i-2];return}let t=$===1?p:G;if(Math.abs(z.a1)>10*Le*Math.abs(t)){z.a7/=z.a1,z.a3/=z.a1,V[0]=l[0],V[1]=-(l[0]*z.a7)+l[1];for(let i=2;i<F;i++)V[i]=-(l[i-1]*z.a7)+q[i-2]*z.a3+l[i]}else{V[0]=0,V[1]=-(l[0]*z.a7);for(let i=2;i<F;i++)V[i]=-(l[i-1]*z.a7)+q[i-2]*z.a3}}function Ae(Le,F,$,G,p,z,V,q,l,t,i,h,m,y,I,x,C){let O,D,le,ge,de,be,Ce,Fe,He;F.b=F.a=0,Le===3||(Le===2?(O=($+i)*t+h,D=(t+m)*q+y*l):(O=$+m*V+h*t,D=q+(m+y*t)*l),le=-(I[x-1]/C[x]),ge=-(I[x-2]+le*C[x-1])/C[x],de=y*ge*G,be=le*z,Ce=le*le*p,Fe=-(be+Ce)+de,He=-Fe+D+le*O,He!==0&&(F.a=-((m*(Ce+be)+y*(le*G+ge*z))/He)+m,F.b=y*(1+Fe/He)))}function Ve(Le,F,$,G){let p,z;if(G.sr=G.si=G.lr=G.li=0,Le===0){G.sr=F===0?G.sr:-($/F);return}if($===0){G.lr=-(F/Le);return}let V=F/2;Math.abs(V)<Math.abs($)?(z=$>=0?Le:-Le,z=-z+V*(V/Math.abs($)),p=Math.sqrt(Math.abs(z))*Math.sqrt(Math.abs($))):(z=-(Le/V*($/V))+1,p=Math.sqrt(Math.abs(z))*Math.abs(V)),z>=0?(p=V>=0?-p:p,G.lr=(-V+p)/Le,G.sr=G.lr===0?G.sr:$/G.lr/Le):(G.lr=G.sr=-(V/Le),G.si=Math.abs(p/Le),G.li=-G.si)}function Ze(Le,F,$,G,p,z,V,q,l,t,i,h){let m={},y,I,x,C,O,D,le,ge,de,be,Ce,Fe=0,He,Te=0;$.NZ=0,D=G,ge=p;do{if(m.li=m.lr=m.si=m.sr=0,Ve(1,D,ge,m),$.szr=m.sr,$.szi=m.si,$.lzr=m.lr,$.lzi=m.li,Math.abs(Math.abs($.szr)-Math.abs($.lzr))>.01*Math.abs($.lzr))break;for(me(V,D,ge,l,z,q),I=Math.abs(-($.szr*q.b)+q.a)+Math.abs($.szi*q.b),be=Math.sqrt(Math.abs(ge)),y=2*Math.abs(z[0]),O=-($.szr*q.b),Ce=1;Ce<F;Ce++)y=y*be+Math.abs(z[Ce]);if(y=y*be+Math.abs(O+q.a),y=(9*y+2*Math.abs(O)-7*(Math.abs(q.a+O)+be*Math.abs(q.b)))*Le,I<=20*y){$.NZ=2;break}if(Fe++,Fe>20)break;if(Fe>=2&&C<=.01&&I>=x&&!Te){for(C=C<Le?Math.sqrt(Le):Math.sqrt(C),D-=D*C,ge+=ge*C,me(V,D,ge,l,z,q),Ce=0;Ce<5;Ce++)He=Be(Le,F,q.a,q.b,i,h,D,ge,t),Je(Le,F,He,q.a,q.b,i,h,t,z);Te=1,Fe=0}x=I,He=Be(Le,F,q.a,q.b,i,h,D,ge,t),Je(Le,F,He,q.a,q.b,i,h,t,z),He=Be(Le,F,q.a,q.b,i,h,D,ge,t),Ae(He,q,q.a,i.a1,i.a3,i.a7,q.b,i.c,i.d,i.f,i.g,i.h,D,ge,h,F,l),le=q.a,de=q.b,de!==0&&(C=Math.abs((-ge+de)/de),D=le,ge=de)}while(de!==0)}function it(Le,F,$,G,p,z,V,q,l){let t,i,h,m,y,I,x,C,O,D,le,ge=G-1;for(F.NZ=le=O=0,x=$.a;;){for(I=p[0],V[0]=I,D=1;D<z;D++)V[D]=I=I*x+p[D];for(h=Math.abs(I),m=Math.abs(x),t=.5*Math.abs(V[0]),D=1;D<z;D++)t=t*m+Math.abs(V[D]);if(h<=20*Le*(2*t-h)){F.NZ=1,F.szr=x,F.szi=0;break}if(le++,le>10)break;if(le>=2&&Math.abs(C)<=.001*Math.abs(-C+x)&&h>y){O=1,F.a=x;break}for(y=h,l[0]=i=q[0],D=1;D<G;D++)l[D]=i=i*x+q[D];if(Math.abs(i)>Math.abs(q[ge])*10*Le)for(C=-(I/i),q[0]=V[0],D=1;D<G;D++)q[D]=C*l[D-1]+V[D];else for(q[0]=0,D=1;D<G;D++)q[D]=l[D-1];for(i=q[0],D=1;D<G;D++)i=i*x+q[D];C=Math.abs(i)>Math.abs(q[ge])*10*Le?-(I/i):0,x+=C}return O}function Xe(Le,F,$,G,p,z,V,q,l,t,i,h){let m={},y={},I=new Array(F),x=new Array(F),C,O,D,le,ge,de,be,Ce,Fe,He,Te,ze,st,gt,wt,$t,ft,yt,It,qt=1,Pt,p0,w0,Ct,l0,a0;for(h.NZ=0,le=D=.25,ge=G,Ce=p,m.b=m.a=0,me(l,i,p,q,t,m),C=m.a,O=m.b,y.h=y.g=y.f=y.e=y.d=y.c=y.a7=y.a3=y.a1=0,Ct=Be(Le,V,C,O,y,z,i,p,I),Pt=0;Pt<$;Pt++){if(yt=1,Je(Le,V,Ct,C,O,y,z,I,t),Ct=Be(Le,V,C,O,y,z,i,p,I),Ae(Ct,m,C,y.a1,y.a3,y.a7,O,y.c,y.d,y.f,y.g,y.h,i,p,z,V,q),wt=m.a,ft=$t=m.b,He=z[V-1]===0?0:-(q[V]/z[V-1]),Te=st=1,Pt!==0&&Ct!==3&&(st=ft===0?st:Math.abs((ft-Ce)/ft),Te=He===0?Te:Math.abs((He-ge)/He),gt=st<be?st*be:1,ze=Te<de?Te*de:1,l0=gt<le?1:0,p0=ze<D?1:0,p0||l0)){for(It=0;It<V;It++)x[It]=z[It];for(Fe=He,w0=a0=0;;){if(!(yt&&(yt=0)==0&&p0&&(!l0||ze<gt))){if(Ze(Le,V,h,wt,$t,t,l,m,q,I,y,z),C=m.a,O=m.b,h.NZ>0)return;if(qt=a0=1,le*=.25,w0||!p0)qt=0;else for(It=0;It<V;It++)z[It]=x[It]}if(qt!==0){if(m.a=Fe,qt=it(Le,h,m,V,q,l,t,z,I),Fe=m.a,h.NZ>0)return;if(w0=1,D*=.25,qt!==0){wt=-(Fe+Fe),$t=Fe*Fe;continue}}for(It=0;It<V;It++)z[It]=x[It];if(!l0||a0)break}me(l,i,p,q,t,m),C=m.a,O=m.b,Ct=Be(Le,V,C,O,y,z,i,p,I)}Ce=ft,ge=He,be=st,de=Te}}function Ye(Le,F,$,G){let p=Le.Degree,z=Math.PI/180,V=Math.LN2,q=Le.Degree+1,l=new Array(q),t=new Array(q),i=new Array(q),h=new Array(q),m={},y={},I,x,C,O,D,le,ge,de,be,Ce,Fe,He,Te,ze,st,gt,wt,$t,ft,yt,It,qt,Pt,p0;He=1;do x=He,He/=2,Te=1+He;while(Te>1);let w0=Number.MIN_VALUE/x,Ct=Math.cos(94*z),l0=Math.sin(94*z),a0=Math.sqrt(.5),v0=-a0;for(y.NZ=ft=0,y.szr=y.szi=y.lzr=y.lzi=0;F[p]===0;)$[ft]=G[ft]=0,p--,ft++;for(Pt=p+1;p>=1;){if(p<=2){p<2?($[Le.Degree-1]=-(F[1]/F[0]),G[Le.Degree-1]=0):(m.li=m.lr=m.si=m.sr=0,Ve(F[0],F[1],F[2],m),$[Le.Degree-2]=m.sr,G[Le.Degree-2]=m.si,$[Le.Degree-1]=m.lr,G[Le.Degree-1]=m.li);break}for(ge=0,de=Number.MAX_VALUE,B=0;B<Pt;B++)Ce=Math.abs(F[B]),Ce>ge&&(ge=Ce),Ce!==0&&Ce<de&&(de=Ce);if(be=w0/de,(be<=1&&ge>=10||be>1&&Number.MAX_VALUE/be>=ge)&&(be=be===0?Number.MIN_VALUE:be,It=Math.floor(Math.log(be)/V+.5),D=2**It,D!==1))for(B=0;B<Pt;B++)F[B]*=D;for(let ut=0;ut<Pt;ut++)t[ut]=Math.abs(F[ut]);t[p]=-t[p],qt=p-1,Ce=Math.exp((Math.log(-t[p])-Math.log(t[0]))/p),t[qt]!==0&&(Fe=-t[p]/t[qt],Ce=Fe<Ce?Fe:Ce),Fe=Ce;do{Ce=Fe,Fe=.1*Ce,le=t[0];for(let ut=1;ut<Pt;ut++)le=le*Fe+t[ut]}while(le>0);O=Ce;do{C=le=t[0];for(let ut=1;ut<p;ut++)le=Ce*le+t[ut],C=Ce*C+le;le=Ce*le+t[p],O=le/C,Ce-=O}while(Math.abs(O/Ce)>.005);I=Ce;for(let ut=1;ut<p;ut++)l[ut]=(p-ut)*F[ut]/p;for(l[0]=F[0],He=F[p],Te=F[qt],p0=l[qt]===0?1:0,yt=0;yt<5;yt++)if(ze=l[qt],p0){for(let ut=0;ut<qt;ut++)ft=qt-ut,l[ft]=l[ft-1];l[0]=0,p0=l[qt]===0?1:0}else{gt=-He/ze;for(let ut=0;ut<qt;ut++)ft=qt-ut,l[ft]=gt*l[ft-1]+F[ft];l[0]=F[0],p0=Math.abs(l[qt])<=Math.abs(Te)*x*10?1:0}for(let ut=0;ut<p;ut++)h[ut]=l[ut];for(yt=1;yt<=20;yt++)if($t=-(l0*v0)+Ct*a0,v0=l0*a0+Ct*v0,a0=$t,st=I*a0,wt=-(2*st),Xe(x,q,20*yt,st,I,l,p,F,Pt,i,wt,y),y.NZ===0)for(let ut=0;ut<p;ut++)l[ut]=h[ut];else{ft=Le.Degree-p,$[ft]=y.szr,G[ft]=y.szi,Pt-=y.NZ,p=Pt-1;for(let ut=0;ut<Pt;ut++)F[ut]=i[ut];y.NZ===1||($[ft+1]=y.lzr,G[ft+1]=y.lzi);break}if(yt>20){Le.Degree-=p;break}}}Ye(ue,Q,qe,te);let rt=te.length;for(B=0;B<rt;B++){let Le=se(te[B],g+8),F=se(qe[B],g+8);F=g-String(F).length>2?F:qe[B];let $=Le<0?"-":"";F===0&&(F=""),Le===0&&(Le=""),Math.abs(Le)===1?Le=`${$}i`:Le?Le=`${Le}*i`:Le="";let G=F&&Le?`${F}+${Le}`:F+Le;qe[B]=G.replace(/\+-/gu,"-")}return qe}},roots(u){if(u.isConstant(!0,!0))return n.Utils.nroots(u);let g=W.proots(u).map(r=>e.parse(r));return n.Vector.fromArray(g)},froot(u,g,r){return function(S){let M=r||n.Utils.build(n.Calculus.diff(u.clone())),P=u instanceof Function?u:n.Utils.build(u),b=1e4,R=!1,B=0;for(;!R;){let Q=S-P(S)/M(S),te=Math.abs(Q)-Math.abs(S),ue=Math.abs(te);S=Q,ue<1e-12?R=!0:B>b&&(S=null,R=!0),B++}return S}(Number(g))},quad(u,g,r){let d=function(S,v,M,P){return e.parse(`-(${v}+${P}*sqrt((${v})^2-4*(${S})*(${M})))/(2*${S})`)};return[d(u,g,r,1),d(u,g,r,-1)]},sumProd(u,g){return W.quad(-g,u,-1).map(r=>r.invert())},coeffs(u,g,r){u=e.expand(u),r||=[new j(0)];let d=Ue(u);g===void 0&&d.length===1&&(g=d[0]),g=String(g),u.group===ne&&u.contains(g,!0)&&e.error(`Unable to get coefficients using expression ${u.toString()}`),d=Ue(u);let S=u.contains("pi")||u.contains("e")||u.containsFunction("sqrt");if(d.length===1&&d[0]===g&&!u.isImaginary()&&!S){let v=new ye(u).coeffs.map(M=>new j(M));for(let M=0,P=v.length;M<P;M++){let b=v[M],R=r[M];R&&(b=e.add(R,b)),r[M]=b}}else if(d.length===1&&d[0]===g&&!u.isImaginary()&&S&&u.group===a){let v=n.Utils.getCoeffs(u,g);for(let M=0,P=v.length;M<P;M++){let b=v[M],R=r[M];R&&(b=e.add(R,b)),r[M]=b}}else if(g||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),d.indexOf(g)===-1)r[0]=e.add(u,r[0]);else{r||=[new j(0)];let v;if(u.group===ae){let M=u.symbols[g];M||e.error("Expression is not a polynomial!");let P=Number(M.power);v=e.divide(u.clone(),M.clone()),(v.contains(g,!0)||P<0||!fe(P))&&e.error("Expression is not a polynomial!");let b=r[P];b&&(v=e.add(b,v)),r[P]=v}else u.group===a&&u.each(M=>{W.coeffs(M.clone(),g,r)},!0)}for(let v=0,M=r.length;v<M;v++)typeof r[v]>"u"&&(r[v]=new j(0));return r},polyPowers(u,g,r){r||=[];let d=u.group;if(d===J&&g===u.value)r=r.concat(H(u.symbols));else if(d===a)for(let S in u.symbols){if(!Object.hasOwn(u.symbols,S))continue;let v=u.symbols[S],M=v.group,P=v.value;if(M===K&&g===P)r.push(v.power);else if(M===J||M===a)r=W.polyPowers(v,g,r);else if(M===ae&&v.contains(g)){let b=v.symbols[g];b&&r.push(b.power)}else(M===_||g!==P)&&r.push(0)}else d===ae&&u.contains(g)&&r.push(n.Utils.decompose_fn(u,g,!0).x.power);return n.Utils.arrayUnique(r).sort()},Factor:{split(u){let g=new j(1),r=new j(1);return W.Factor.factorInner(u,new Re).each(d=>{let S=e.parse(d);d.isConstant(!0)?g=e.multiply(g,S):r=e.multiply(r,S)}),[g,r]},mix(u,g){let r=H(u),d=r.length,S=[];for(let v=0;v<d;v++){let M=r[v],P=u[M],b=S.length;for(let R=0;R<b;R++){let B=S[R]*M;S.push(B),g&&S.push(-B)}for(let R=1;R<=P;R++)S.push(M**R)}return S},common(u,g){try{if(u.group===a){let r=e.expand(u.clone(),!0).collectSymbols(null,null,(P,b)=>(b.length||1)-(P.length||1)),d={},S=[];for(let P=0;P<r.length;P++){let b=r[P];S.push(b.multiplier.clone()),b.each(R=>{let B=Number(R.power);if(isNaN(B))throw new Error("exiting");R.value in d?(B<d[R.value][0]&&(d[R.value][0]=B),d[R.value][1].push(R)):d[R.value]=[B,[R]]})}let v=new j(1);for(let P in d)d[P][1].length===r.length&&(v=e.multiply(v,e.pow(new j(P),new j(d[P][0]))));let M=n.Math2.QGCD.apply(null,S);if(!M.equals(1)){g.add(new j(M));for(let P=0;P<r.length;P++)r[P].multiplier=r[P].multiplier.divide(M)}if(!v.equals(1)){g.add(v),u=new j(0);for(let P=0;P<r.length;P++)u=e.add(u,e.divide(r[P],v.clone()))}}}catch(r){if(r.message==="timeout")throw r}return u},zeroes(u,g){let r=function(){throw new n.exceptions.ValueLimitExceededError("Exiting")};try{let d,S,v;u=e.expand(u.clone());let M=u.toString(),P=Ue(u);S=new j(0);let b=[],R=[];for(let B=0,Q=P.length;B<P.length;B++){let te={};for(let qe=0;qe<Q;qe++)B!==qe&&(te[P[qe]]=0);d=e.parse(M,te);let ue=d.power;fe(ue)||r(),b.push(d),R.push(d.power)}if(n.Utils.allSame(R)){let B=u.length,Q=b.length,te=Math.round((Math.sqrt(8*B-1)-3)/2);Q===2?v=new he(R[0]/(B-1)):Q===3&&te!==0?v=new he(R[0]/te):v=n.Math2.QGCD.apply(null,R)}else v=n.Math2.QGCD.apply(null,R);if(!fe(v))return u;for(let B=0;B<b.length;B++){let Q=b[B],te=Q.power.clone().divide(v);if((Q.multiplier.num<0||Q.multiplier.den<0)&&te%2===0)return u;Q.multiplier=new he(Q.multiplier**(1/te)),Q.power=v.clone(),S=e.add(S,Q)}if(S.group!==a)return u;for(;;){let B=W.div(u.clone(),S.clone());if(B[1].equals(0)){if(u=B[0],g.add(S.clone()),u.equals(1))break}else break}}catch(d){if(d.message==="timeout")throw d}return u},factor(u,g){n.Utils.checkTimeout();let r=g?[...g]:null;try{let d=W.Factor.factorInner(u,g);return d=d.pushMinus(),d}catch(d){if(d.message==="timeout")throw d;return g&&g.splice(0,g.length,...r),u}},factorInner(u,g){if(n.Utils.checkTimeout(),u.isConstant()&&u.isInteger())return n.Math2.factor(u);let r=e.parse(u);if(r.isConstant())return r.isInteger()?n.Math2.factor(r):u;if(r.equals(0)||r.equals(1))return r;let d=W.Factor._factor(r,g);if(d.equals(u)||d.equals(0)||d.equals(1))return d;if(d.group===ae){let S=new j(1),v=e.parse(d.power),M=e.parse(d.multiplier);d.toUnitMultiplier(),d.multiplier.lessThan(0)&&(S.negate(),d.negate()),d.each(b=>{let R=e.parse(W.Factor._factor(b));if(M=e.multiply(M,j.create(R.multiplier)),R.toUnitMultiplier(),R.group===ae){let B=new j(1);R.each(Q=>{let te=e.parse(W.Factor._factor(Q));te.group===ae&&(M=e.multiply(M,j.create(te.multiplier)),te.toUnitMultiplier()),B=e.multiply(B,te)}),B=e.pow(B,new j(R.power)),S=e.multiply(S,B)}else S=e.multiply(S,R)});let P=e.pow(S,v);d=e.multiply(M,P)}return d},quadFactor(u,g){if(u.isPoly()&&W.degree(u.equals(2))){let r=n.Utils.variables(u)[0],d=W.coeffs(u,r);if(d.length<3)return u;let S=W.Factor._factor(d[2].clone());if(S.group===ae){let v=S.collectSymbols();if(v.length>2)return u;let M=e.multiply(e.parse(d[0]),e.parse(v[0])),P=e.parse(d[1]).negate(),b=e.parse(v[1]),R=W.quad(b,P,M).filter(B=>n.Utils.isInt(B));if(R.length===1){let B=R[0],Q=e.divide(d[0],e.parse(B));n.Utils.isInt(Q)&&(g.add(e.parse(De("({0})*({1})+({2})",v[1],r,Q))),g.add(e.parse(De("({0})*({1})+({2})",v[0],r,B))),u=new j(1))}}}return u},cubeFactor(u,g){if(u.isComposite()){let r=u.collectSymbols();if(r.length===2){let d=r[0].sign(),S=r[0].clone().abs(),v=r[1].sign(),M=r[1].clone().abs();if(S.isCube()&&M.isCube()){d<v&&([d,v]=[v,d],[S,M]=[M,S]);let P=e.parse(S.getNth(3)),b=e.parse(M.getNth(3)),R=e.multiply(e.expand(e.pow(S.clone().toUnitMultiplier(),e.parse("1/3"))),P),B=e.multiply(e.expand(e.pow(M.clone().toUnitMultiplier(),e.parse("1/3"))),b);d===1&&v===-1?(g.add(e.parse(De("(({0})-({1}))",R,B))),g.add(e.parse(De("(({0})^2+({0})*({1})+({1})^2)",R,B))),u=j(1)):d===1&&v===1&&(g.add(e.parse(De("(({0})+({1}))",R,B))),g.add(e.parse(De("(({0})^2-({0})*({1})+({1})^2)",R,B))),u=j(1))}}}return u},_factor(u,g){n.Utils.checkTimeout();let r=u.group;if(u.group===Z){let S=u.args[0];if(S.group===K&&S.isSimple())return u}else if(u.group===K&&u.isSimple())return u;if(u.group===a){u.distributeMultiplier(!0);let S=new j(0);u.each(v=>{(v.group===a&&v.power.greaterThan(1)||v.group===ae)&&(v=e.expand(v)),S=e.add(S,v)}),S.power=u.power,u=S}u.group===Z&&u.fname!=="sqrt"&&(u=n.Utils.evaluate(u));let d=u.clone();try{if(u.group===ae){let v=e.parse(u.power),M=W.Simplify.strip(u.getDenom()),P=W.Simplify.strip(u.getNum()),b=M.pop(),R=P.pop();if(R.equals(u))return u;let B=W.Factor.factorInner(R),Q=W.Factor.factorInner(b),te=W.Simplify.unstrip(P,B),ue=W.Simplify.unstrip(M,Q);return e.divide(te,ue)}if(u.group===K)return u;if(u.isConstant())return u.equals(1)||u.equals(0)||!u.isInteger()?u.clone():n.Math2.factor(u);let S=u.power.clone();if(fe(S)&&!(S.lessThan(0)&&u.group===Z)){let v=S.sign();u.toLinear(),g||=new Re;let M={};u=e.parse(n.Utils.subFunctions(u,M)),H(M).length>0&&(g.preAdd=function(qe){return e.parse(qe,n.Utils.getFunctionsSubs(M))}),u.isLinear()||(g.pFactor=u.power.toString(),u.toLinear());let P=Ue(u);u.isImaginary()&&P.push(n.Settings.IMAGINARY);let b=P.length>1;if(b){let ue=!0,qe=!0;if(u.each(me=>{me.group!==K&&(ue=!1),me.multiplier.equals(1)||(qe=!1)}),ue&&qe)return e.pow(e.parse(u,n.Utils.getFunctionsSubs(M)),e.parse(S))}let R=new Re;u=W.Factor.coeffFactor(u,R),R.each(ue=>{Ie(S)&&ue.lessThan(0)&&ue.negate(),v<0&&ue.invert(),g.add(ue)});let B=new Re;if(u=W.Factor.powerFactor(u,B),B.each(ue=>{v<0&&ue.invert(),g.add(ue)}),b)u=W.Factor.cubeFactor(u,g),u=W.Factor.mfactor(u,g),g.each(ue=>{v<0&&ue.power.negate()});else{let ue=P[0];u=W.Factor.squareFree(u,g,ue);let qe=new Re;u=W.Factor.trialAndError(u,qe,ue);let me=qe.toSymbol();if(me.equals(d))return me;for(let Be in qe.factors){if(!Object.hasOwn(qe.factors,Be))continue;let Je=qe.factors[Be];g.add(e.pow(Je,e.parse(S)))}u.equals(d)&&(u=W.Factor.quadFactor(u,g))}u=e.parse(u,n.Utils.getFunctionsSubs(M));let Q=g.length===1;g.add(e.pow(u,e.parse(S)));let te=g.toSymbol();return Q&&u.equals(1)&&te.isLinear()&&(te=e.pow(te,e.parse(S))),te}return u}catch(S){if(S?.message==="timeout")throw S;return d}},reduce(u,g){if(u.group===a&&u.length===2){let r=u.collectSymbols().sort((d,S)=>S.multiplier-d.multiplier);if(r[0].power.equals(r[1].power)){let d=e.parse(r[0].power),S=r[0].clone().toLinear(),v=r[1].clone().toLinear();g.add(e.add(S.clone(),v.clone())),v.negate();let M=Number(d),P=new j(0);for(let b=1;b<=M;b++){let R=e.pow(S.clone(),e.subtract(d.clone(),new j(b))),B=e.pow(v.clone(),e.subtract(new j(b),new j(1)));P=e.add(P,e.multiply(R,B))}return P}}return u},squareFree(u,g,r){if(u.isConstant()||u.group===K||!u.isPoly())return u;let S=new ye(u,r).squareFree(),v=S[2];if(v!==1){let M=S[1].toSymbol();return M.power=M.power.multiply(new he(v)),g.add(W.Factor.factorInner(M)),W.Factor.squareFree(S[0].toSymbol(),g)}return u},powerFactor(u,g){if(u.group!==J||u.previousGroup===ne)return u;let r=H(u.symbols);if(!n.Utils.allNumeric(r))return u;let d=n.Utils.arrayMin(r),S=new j(0),v=e.parse(`${u.value}^${d}`);return u.each(M=>{M=e.divide(M,v.clone()),S=e.add(S,M)}),g.add(v),S},coeffFactor(u,g){if(u.isComposite()){let r=n.Math2.QGCD.apply(null,u.coeffs());if(r.equals(1)){let d=function(M){let P;return M.group===ae?(P=0,M.each(b=>{P+=b.power})):P=Number(M.power),P},S=u.collectSymbols(null,null,null,!0).sort((M,P)=>M.isConstant(!0)?1:P.power-M.power),v=S[0];(d(v)>d(S[1])||S[1].isConstant(!0))&&v.multiplier.lessThan(0)&&(g.add(new j(-1)),u.each(M=>{M.negate()},!0))}else u.each(d=>{d.isComposite()?d.each(S=>{S.multiplier=S.multiplier.divide(r)}):d.multiplier=d.multiplier.divide(r)}),u.updateHash();g&&g.add(new j(r))}return u},trialAndError(u,g,r){let d=u.clone();try{let S=[];if(u.isConstant()||u.group===K||!u.isPoly())return u;let v=new ye(u,r),M=v.coeffs[0],P=n.Math2.ifactor(M),b=W.proots(u);for(let R=0;R<b.length;R++){let B=b[R],Q=1;if(!isNaN(B)){for(let Be in P){if(!Object.hasOwn(P,Be))continue;let Je=n.Utils.round(Math.log(Be)/Math.log(Math.abs(B)),8);if(fe(Je)){B=Be,Q=Je;break}}let te=new he(B),ue=[new he(te.num).negate()];ue[Q]=new he(te.den);let qe=ye.fromArray(ue,v.variable).fill(),me=v.divide(qe);me[1].equalsNumber(0)&&(v=me[0],S.push(qe.toSymbol()))}}return v.equalsNumber(1)||(v=W.Factor.search(v,g)),S.forEach(R=>{g.add(R)}),v.toSymbol()}catch(S){if(S.message==="timeout")throw S;return d}},search(u,g,r){r||=10;let d=u.variable,S=function(me,Be,Je,Ae){let Ve=ye.fit(me,Be,Je,r,Ae,d);if(Ve&&Ve.coeffs.length>1){let Ze=u.divide(Ve);if(Ze[1].equalsNumber(0))return g.add(Ve.toSymbol()),[Ze[0],Ve]}return null},v=u.coeffs[0],M=n.Math2.ifactor(v),P=u.lc(),b=n.Math2.ifactor(P),R=u.sub(r),B=n.Math2.ifactor(R),Q=W.Factor.mix(B,R<0),te=Math.ceil(u.coeffs.length/2),ue=P.lessThan(0),qe=v.lessThan(0);for(b[1]=1,M[1]=1;te--;)for(let me in b)if(Object.hasOwn(b,me)){for(let Be in M)if(Object.hasOwn(M,Be))for(let Je=0;Je<Q.length;Je++){let Ae=S(me,Be,Q[Je],te);if(Ae)return u=Ae[0],n.Utils.isPrime(u.sub(r))||(u=W.Factor.search(u,g)),u;Ae||(ue&&qe?Ae=S(-me,-Be,Q[Je],te):ue?Ae=S(-me,Be,Q[Je],te):qe&&(Ae=S(me,-Be,Q[Je],te)))}}return u},mSqfrFactor(u,g){if(u.group!==Z){let r=Ue(u).reverse();for(let d=0;d<r.length;d++){let S=!1;do{if(r[d]===u.value){g.add(u),u=new j(1);continue}let v=n.Calculus.diff(u,r[d]),M=W.Factor.coeffFactor(v);if(M.equals(0)||M.equals(1)||M.equals(-1))break;let P=!0;M.isConstant()&&u.isComposite()&&u.each(R=>{R.multiplier%M!==0&&(P=!1)},!0);let b;if(P){let R=u.clone();if(b=W.divWithCheck(u,M.clone()),S=b[1].equals(0),u.equals(b[0])&&b[1].equals(0)){u=R;break}if(b[0].isConstant()){g.add(b[0]);break}}else S=!1;S&&(g.add(b[0]),u=M)}while(S)}}return u},sqdiff(u,g){if(u.isConstant("all"))return u;try{let r=function(v){return n.Utils.block("POSITIVE_MULTIPLIERS",()=>j.unwrapPARENS(Ge.sqrt(Ge.abs(v))),!0)},d=n.Utils.separate(u.clone());if(!d)return u;let S=[];for(let v in d)v!=="constants"&&S.push(d[v]);if(S.sort((v,M)=>M.power-v.power),S.length===2){let v,M;if(v=S.pop(),M=S.pop(),Ie(v.power)&&Ie(M.power)&&v.sign()===M.sign()&&v.group===K&&M.group===K)throw new Error("Unable to factor");if(v.isComposite()&&M.power.equals(2)&&v.sign()!==M.sign()){M=r(M);let P=W.Factor.factorInner(e.add(v,d.constants));P.power.equals(2)&&(P.toLinear(),g.add(e.subtract(P.clone(),M.clone())),g.add(e.add(P,M)),u=new j(1))}else if(v=v.powSimp(),M=M.powSimp(),(v.group===K||v.fname==="")&&v.power.equals(2)&&(M.group===K||M.fname==="")&&M.power.equals(2)&&!d.constants){if(v.multiplier.lessThan(0)){let P=M;M=v,v=P}v.multiplier.greaterThan(0)&&(v=r(v),M=r(M)),g.add(e.subtract(v.clone(),M.clone())),g.add(e.add(v,M)),u=new j(1)}}}catch(r){if(r.message==="timeout")throw r}return u},mfactor(u,g){if(u.group===Z)if(u.fname==="sqrt"){let r=new Re,d=W.Factor.common(u.args[0].clone(),r);d=W.Factor.coeffFactor(d,null),u=e.multiply(e.symfunction("sqrt",[d]),e.parse(u.multiplier)),r.each(S=>{u=e.multiply(u,e.parse(n.Utils.format("sqrt({0})",S)))})}else g.add(u),u=new j(1);else{u=W.Factor.mSqfrFactor(u,g);let r=Ue(u),d=u.collectSymbols().map(b=>j.unwrapSQRT(b)),S={},v={},M=r.length,P=d.length;for(let b=0;b<M;b++){let R=r[b];S[R]=new j(0);for(let B=0;B<P;B++){let Q=d[B];if(Q.contains(R)){let te=Q.value===R?Q.power.toDecimal():Q.symbols[R].power.toDecimal();(!v[R]||te<v[R])&&(v[R]=te),S[R]=e.add(S[R],Q.clone())}}}for(let b in S){if(!Object.hasOwn(S,b))continue;let R=e.parse(`${b}^${v[b]}`),B=e.divide(S[b],R),Q=e.expand(B);if(Q.equals(1)||Q.equals(-1))break;let te=W.div(u.clone(),Q);if(te[0].equals(0))break;if(te[1].equals(0)){let qe=!1;if(te[0].each(me=>{fe(me.multiplier)||(qe=!0)}),qe){te[1]=e.expand(e.multiply(te[1],Q));break}}let ue=fe(Q)&&Q.lessThan(0);if(te[1].equals(0)&&!ue){let qe=W.divWithCheck(u.clone(),te[0].clone()),me=qe[0];if(me.equals(0)||(u=qe[1],me.equals(-1)&&!u.equals(0)))return u;let Be=te[0];if(u.equals(Be)){let Je=W.Factor.reduce(Be,g);return u.equals(Je)?Je:W.Factor.mfactor(Je,g)}return g.add(Be),u.equals(0)?me:me.isConstant("all")?(g.add(me),me):(u=W.Factor.mfactor(me,g),u)}}}return u=W.Factor.sqdiff(u,g),u=W.Factor.zeroes(u,g),u}},allLinear(u){let g=u.length;for(let r=0;r<g;r++)if(!W.isLinear(u[r]))return!1;return!0},isLinear(u){let g=!1,r=u.group;if(r===J||r===a){g=!0;for(let d in u.symbols){if(!Object.hasOwn(u.symbols,d))continue;let S=u.symbols[d],v=S.group;if((v===Z||v===ne)&&(g=!1),v===ae)g=Ue(S).length===1;else if(v===J||v===a)g=W.isLinear(S);else if(S.group!==_&&S.power.toString()!=="1"){g=!1;break}}}else r===K&&u.power===1&&(g=!0);return g},gcd(...u){let g;if(u.length===1&&u[0]instanceof n.Vector?g=u[0].elements:g=u,g.length===0)return new j(1);if(g.length===1)return g[0];let r=[],d=!1;for(let S=0;S<g.length;S++)if(g[S].group===Z&&g[S].fname==="gcd")g=g.concat(g[S].args),g.splice(S,1);else{let v=Ue(g[S]);if(n.Utils.haveIntersection(v,r)){d=!0;break}else r=r.concat(v)}if(d||r.length===0){if(g.every(S=>S.getDenom().equals(1))){let S=g[0];for(let v=1;v<g.length;v++)S=W.gcd_(g[v],S);return S}return e.divide(W.gcd.apply(null,g.map(S=>S.getNum())),W.lcm.apply(null,g.map(S=>S.getDenom())))}return e.symfunction("gcd",g)},gcd_(u,g){if((u.group===Z||u.group===X)&&(u=n.Utils.block("PARSE2NUMBER",()=>e.parse(u))),g.group===Z&&(g=n.Utils.block("PARSE2NUMBER",()=>e.parse(g))),u.isConstant()&&g.isConstant())return new j(n.Math2.QGCD(new he(Number(u)),new he(Number(g))));let r=e.multiply(u.getDenom()||new j(1),g.getDenom()||new j(1)).invert();if(u=e.multiply(u.clone(),r.clone()),g=e.multiply(g.clone(),r.clone()),u=e.expand(u),g=e.expand(g),u.group===ae||g.group===ae){let b=e.divide(u.clone(),g.clone()),R=e.multiply(g.clone(),b.getDenom().invert());if(!R.equals(1))return R}if(u.group===ne||g.group===ne){let b=new j(n.Math2.GCD(u.multiplier,g.multiplier)),R=W.gcd_(u.value===xe?new j(1):e.parse(u.value),g.value===xe?new j(1):e.parse(g.value)),B=W.gcd_(e.parse(u.power),e.parse(g.power));return e.multiply(b,e.pow(R,B))}if(u.length<g.length){let b=u;u=g,g=b}let d=Ue(u),S=Ue(g);if(d.length===S.length&&d.length===1&&d[0]===S[0]||d.length===1&&S.length===0||d.length===0&&S.length===1)return u=new ye(u),g=new ye(g),e.divide(u.gcd(g).toSymbol(),r);let v=[];u.each(b=>{v.push(b.multiplier)}),g.each(b=>{v.push(b.multiplier)});let M;for(;!g.equals(0);){let b=g.clone();if(u=u.clone(),M=W.div(u,b),g=M[1],M[0].equals(0))return e.divide(new j(n.Math2.QGCD(u.multiplier,g.multiplier)),r);u=b}let P=n.Math2.QGCD.apply(void 0,v);return P.equals(1)||u.each(b=>{b.multiplier=b.multiplier.divide(P)}),u.equals(1)&&!u.isConstant()&&!g.isConstant()?e.divide(e.symfunction("gcd",[u,g]),r):e.divide(u,r)},lcm(...u){let g;u.length===1?u[0]instanceof n.Vector?g=u[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):g=u;let r=g.reduce((M,P)=>e.multiply(M,P.clone()),new j(1)),d=(function(P,b){b=Number(b);let R=[],B,Q,te,ue=2**P.length;for(Q=b;Q<ue;Q++){B=[],te=P.length-1;do(Q&1<<te)!==0&&B.push(P[te]);while(te--);B.length===b&&R.push(B)}return R})(g,g.length-1).map(M=>M.reduce((P,b)=>e.multiply(P,b.clone()),new j(1))),S;return g.every(M=>n.Utils.isVariableSymbol(M))?S=e.symfunction("gcd",n.Utils.arrayUnique(d)):S=W.gcd.apply(null,d),e.divide(r,S)},divide(u,g){let r,d=n.Algebra.Factor.factorInner(u.clone());r=d.getDenom(),r.isConstant("all")?r=new j(1):u=e.expand(j.unwrapPARENS(e.multiply(d,r.clone())));let S=W.div(u,g),v=e.divide(S[1],g);return e.divide(e.add(S[0],v),r)},divWithCheck(u,g){let r=[new j(0),u.clone()],d=W.div(u,g),S=u.clone(),v=e.multiply(d[0].clone(),g.clone());v=e.add(v,d[1].clone());let M=e.subtract(S,v);return M=e.expand(M),M.equals(0)?d:r},div(u,g){let r=[new j(0),u.clone()];try{if(g.isConstant("all"))return u.each(Q=>{Q.multiplier=Q.multiplier.divide(g.multiplier)}),[u,new j(0)];if(u=e.expand(u),g=e.expand(g),u.group===K&&g.group===a){let Q=u.value,te=n.Utils.decompose_fn(g.clone(),Q,!0);if(u.isLinear()&&te.x&&te.x.isLinear()&&g.isLinear()){let ue=j.create(u.multiplier);return[e.divide(ue.clone(),te.a.clone()),e.divide(e.multiply(ue,te.b),te.a).negate()]}}if(u.group===K&&g.group===K){let Q=e.divide(u.clone(),g.clone());return Q.isConstant()?[Q,new j(0)]:[new j(0),u.clone()]}let d=u.hasFunc(),S=g.hasFunc(),v=!1,M;if(d||S){v=!0;let Q={};u=e.parse(n.Utils.subFunctions(u,Q)),g=e.parse(n.Utils.subFunctions(g,Q)),M=n.Utils.getFunctionsSubs(Q)}let P=n.Utils.arrayUnique(Ue(u).concat(Ue(g))),b,R,B;if((u.isImaginary()||g.isImaginary())&&P.push(n.Settings.IMAGINARY),P.length===1){let Q=new ye(u).divide(new ye(g));b=Q[0].toSymbol(),R=Q[1].toSymbol()}else{P.push(xe);let Q=function(Xe){let Ye=new j(0);for(let rt=0;rt<Xe.length;rt++){let Le=Xe[rt].toSymbol();Ye=e.add(Ye,Le)}return Ye},te=function(Xe,Ye){let rt=Math.max.apply(null,Xe.terms),Le=0,F;if(!Ye){for(let $=0;$<Xe.terms.length;$++)if(Xe.terms[$].equals(rt)&&(F=$,Le++),Le>1)return}if(Ye){for(let $=0;$<Xe.terms.length;$++)if(Xe.terms[$].equals(rt)){F=$;break}}return[rt,F,Xe]},ue=n.Utils.toMapObj(P),qe=function(Xe,Ye){return Ye.sum.subtract(Xe.sum)},me=u.tBase(ue).sort(qe),Be=g.tBase(ue).sort(qe),Je=function(Xe,Ye){Ye||=0;let rt=Xe[Ye],Le=Xe.length;if(!rt)return;let F=te(rt);for(let p=Ye+1;p<Le;p++){let z=Xe[p],V=rt.sum.equals(z.sum);if(!V&&F)break;if(V){let q,l,t,i,h=rt.terms.length;for(let I=0;I<h;I++){let x=rt.terms[I],C=z.terms[I];(typeof q>"u"||x.greaterThan(q))&&(q=x,t=I),(typeof l>"u"||C.greaterThan(l))&&(l=C,i=I)}let m=q.subtract(z.terms[t]),y=l.subtract(rt.terms[i]);if(y>m){F=[l,i,z];break}if(m>y){F=[q,t,rt];break}}else if(F=te(z),F)break;F=te(z)}if(!F)return te(Xe[0],!0);let $,G;for(let p=0;p<Be.length;p++){let z=Be[p].terms;if(G=F[1],G===z.length-1)return;if($=z[G],!$.equals(0))break}return $.equals(0)?Je(Xe,++Ye):F},Ae=function(Xe,Ye){if(!Xe||!Ye)return!1;for(let rt=0;rt<Xe.terms.length;rt++)if(Xe.terms[rt].lessThan(Ye.terms[rt]))return!1;return!0},Ve=Ae(me[0],Be[0])&&me[0].count>Be[0].count?Be:me,Ze=Je(Ve),it=[];if(Ze){let Xe=Ze[1],Ye=function(V,q){return V[0].sum.equals(q[0].sum)?V.length>=q.length:!0},rt=function(V,q,l){let t=[];for(let i=0;i<V.length;i++){let h=V[i];for(let m=0;m<h.terms.length;m++){let y=t[m],I=h.terms[m];i===0?t[m]=I:y&&!y.equals(I)&&(t[m]=void 0)}}for(let i=0;i<t.length;i++){let h=t[i];if(h&&!h.equals(0))return i}return l},Le=function(V,q){let l=V.len(),t=q.len(),i=q.terms[Xe],h=V.terms[Xe];return t>l&&i.greaterThan(h)?t-l:i.subtract(h)};Xe=rt(me,Be,Xe),me.sort(Le),Be.sort(Le);let F=Be[0],$=me[0];if(B=new Se(new he(1),[],$.map),F.sum.greaterThan($.sum)&&$.len()>1)for(let V=0;V<$.terms.length;V++){let q=F.terms[V].subtract($.terms[V]);if(q.equals(0))B.terms[V]=new he(0);else{let l=q.add(new he(1));B.terms[V]=q;for(let t=0;t<me.length;t++)me[t].terms[V]=me[t].terms[V].add(l)}}let G=Ae(me[0],Be[0]),p=0,z=200;for(;G&&Ye(me,Be);){if(p++>z)throw new n.exceptions.InfiniteLoopError("Unable to compute!");let V=me[0].divide(Be[0]);it.push(V),me.shift();for(let q=1;q<Be.length;q++){let l=Be[q].multiply(V).generateImage(),t=me.length;t===0&&(l.coeff=l.coeff.neg(),me.push(l),me.sort(Le));for(let i=0;i<t;i++){let h=me[i];if(h.getImg()===l.getImg()){h.coeff=h.coeff.subtract(l.coeff),h.coeff.equals(0)&&(n.Utils.remove(me,i),i--);break}i===t-1&&(l.coeff=l.coeff.neg(),me.push(l),me.sort(Le))}}if(G=Ae(me[0],Be[0]),!G&&me.length>=Be.length){for(let q=1;q<me.length;q++)if(G=Ae(me[q],Be[0]),G){me.unshift(n.Utils.remove(me,q));break}}}}b=Q(it),R=Q(me),typeof B<"u"&&(B=B.toSymbol(),b=e.divide(b,B.clone()),R=e.divide(R,B))}return v&&(b=e.parse(b.text(),M),R=e.parse(R.text(),M)),[b,R]}catch(d){if(d.message==="timeout")throw d;return r}},line(u,g,r){n.Utils.isArray(u)&&(u=n.Utils.convertToVector(u)),n.Utils.isArray(g)&&(g=n.Utils.convertToVector(g)),r=e.parse(r||"x"),(!n.Utils.isVector(u)||!n.Utils.isVector(g))&&e.error(`Line expects a vector! Received "${u}" & "${g}"`);let d=e.subtract(g.e(1).clone(),u.e(1).clone()),S=e.subtract(g.e(2).clone(),u.e(2).clone()),v=e.divide(S,d),M=e.multiply(r,v.clone()),P=e.multiply(u.e(1).clone(),v);return e.add(e.subtract(M,P),u.e(2).clone())},PartFrac:{createTemplate(u,g,r,d){u=W.Factor.factorInner(u),u.each((Q,te)=>{if(Q.group===Z&&Q.fname===""&&Q.args[0].group===K){let ue=Q.args[0];u.symbols?(delete u.symbols[te],u.symbols[ue.value]=ue):u=Q.args[0]}});let S,v,M,P=g.collectFactors(),b=[],R=[],B=new j(1);for(let Q=0;Q<P.length;Q++){let te=j.unwrapPARENS(P[Q]);if(te.power.greaterThan(1)){v=Number(te.power),S=te.clone().toLinear(),M=Number(W.degree(S,d));for(let ue=0;ue<v;ue++){let qe=e.pow(S.clone(),new j(ue+1));r.push(qe.clone());let me=e.divide(u.clone(),qe.clone());R.push(M),b.push(me)}}else{M=Number(W.degree(te,d)),r.push(te);let ue=e.divide(u.clone(),te.clone());ue=e.expand(j.unwrapPARENS(ue)),R.push(M),b.push(ue)}}return r=r.map(Q=>e.multiply(Q,B.clone())),[r,b,R]},partfrac(u,g,r){let d=Ue(u);g||=e.parse(d[0]);try{let S,v,M,P=e.expand(u.getNum()),b=e.expand(u.getDenom().toUnitMultiplier());if(P.multiplier=u.multiplier,S=P.groupTerms(g),Number(W.degree(P,g))>=Number(W.degree(b,g))?(v=W.div(P.clone(),e.expand(b.clone())),M=v[0],P=v[1],S=P.groupTerms(g)):M=new j(0),Number(W.degree(b,g))===1){let Le=e.divide(P,b);return r?[M,Le]:e.add(M,Le)}let R=W.Factor.factorInner(b),B=W.PartFrac.createTemplate(b.clone(),R,[],g),Q=B[0],te=B[1],ue=B[2],qe=[S.length],me=[],Be=[],Je=[],Ae,Ve;te.forEach((Le,F)=>{Ae=Q[F],Ve=ue[F];for(let $=0;$<Ve;$++){Be.push(Ae.clone());let G=j.create(g,$),p=e.expand(e.multiply(Le,G.clone())).groupTerms(g),z=p.length;qe.push(z),me.push(p),Je.push(G.clone())}});let Ze=n.Utils.arrayMax(qe),it=new n.Matrix(n.Utils.fillHoles(S,Ze)).transpose(),Xe=new n.Matrix;for(let Le=0;Le<me.length;Le++)Xe.elements.push(n.Utils.fillHoles(me[Le],Ze));let Ye=e.multiply(Xe.transpose().invert(),it),rt=r?[M]:M;return Ye.each((Le,F)=>{let $=e.multiply(Je[F],e.divide(Le,Be[F]));r?rt.push($):rt=e.add(rt,$)}),rt}catch(S){if(S.message==="timeout")throw S;try{if(u.isComposite()){let v={};u.each(P=>{let b=P.getDenom(),R=P.getNum(),B=v[b];v[b]=B?e.add(B,R):R});let M=new j(0);for(let P in v)Object.hasOwn(v,P)&&(M=e.add(M,e.divide(v[P],e.parse(P))));u=M}}catch(v){if(v.message==="timeout")throw v}}return u}},degree(u,g,r){if(r||={nd:[],sd:[],depth:0},!g){let v=Ue(u);if(v.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(v.length===0)return new j(0);g=e.parse(v[0])}let d=u.group;u.isComposite()?(u=u.clone(),u.distributeExponent(),u.each(v=>{r.depth++,W.degree(v,g,r),r.depth--})):u.group===ae?u.each(v=>{r.depth++,W.degree(v,g,r),r.depth++}):d===ne&&u.value===g.value?r.sd.push(u.power.clone()):d===K&&u.value===g.value?r.nd.push(e.parse(u.power)):r.nd.push(new j(0));let S=r.nd.length>0?n.Utils.arrayMax(r.nd):void 0;return r.depth===0&&r.sd.length>0?(S!==void 0&&r.sd.unshift(S),e.symfunction("max",r.sd)):(n.Utils.isSymbol(S)||(S=e.parse(S)),S)},sqComplete(u,g,r){n.Utils.isSymbol(g)||(g=e.parse(g));let d=function(me){throw me||="Stopping",new n.exceptions.ValueLimitExceededError(me)};u.isPoly(!0)||d("Must be a polynomial!");let S=n.Utils.inBrackets;u=u.clone();let v=n.Algebra.degree(u,g);v.equals(2)||d(`Cannot complete square for degree ${v}`);let M=n.Algebra.coeffs(u,g),P=M[2],b=M[1].sign(),R=e.divide(M[1],new j(2)),B=e.pow(R.clone(),new j(2)),Q=Ge.sqrt(P),te=e.divide(Ge.sqrt(B),Q.clone()),ue=e.subtract(M[0],e.pow(te.clone(),new j(2)));if(r)return[P,R,ue];let qe=e.parse(S(`${Q.clone()}*${g}${b<0?"-":"+"}${te}`));return{a:qe,c:ue,f:e.add(e.pow(qe.clone(),new j(2)),ue.clone())}},Simplify:{strip(u){let g=e.parse(u.multiplier);u.toUnitMultiplier();let r=e.parse(u.power);return u.toLinear(),[g,r,u]},unstrip(u,g){let r=u[0],d=u[1];return e.multiply(r,e.pow(g,d))},complexSimp(u,g){let r=u.realpart(),d=u.imagpart(),S=g.realpart(),v=g.imagpart(),M=e.multiply(r.clone(),S.clone()),P=e.multiply(d.clone(),v.clone()),b=e.multiply(S.clone(),d),R=e.multiply(r,v.clone()),B=e.add(e.pow(S,new j(2)),e.pow(v,new j(2)));return e.divide(e.add(e.add(M,P),e.multiply(e.subtract(b,R),j.imaginary())),B)},trigSimp(u){let g=!0,r=0;for(;g&&u.containsFunction(["cos","sin","tan"]);){r++,g=!1,u=u.clone();let d=W.Simplify.strip(u);u=d.pop();let S=u.clone();if(u.group===a){let v=new j(0);u.each(M=>{let P=W.Simplify.trigSimp(M.fnTransform());v=e.add(v,P)},!0),S=e.pow(e.multiply(new j(u.multiplier),v),new j(u.power)),g=S.text()!==u.text()}else if(u.group===ae){let v=u.getNum(),M=u.getDenom();if(v.fname==="sin"&&M.fname==="cos"&&v.args[0].equals(M.args[0])&&v.power.equals(M.power))S=e.parse(n.Utils.format("(({1})/({0}))*tan({2})^({3})",M.multiplier,v.multiplier,v.args[0],v.power)),g=!0;else if(v.fname==="tan"&&M.fname==="sin"&&v.args[0].equals(M.args[0])&&v.power.equals(M.power))S=e.parse(n.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",M.multiplier,v.multiplier,v.args[0],v.power)),g=!0;else{let P=new j(1),b={workDone:g};S.each(R=>{if(R.fname==="tan")R=e.parse(n.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",R.multiplier,W.Simplify._simplify(R.args[0]),R.power)),b.workDone=!0;else if(R.containsFunction(["cos","sin","tan"])){let B=W.Simplify.trigSimp(R);R.equals(B)||(R=B,b.workDone=!0)}P=e.multiply(P,R)}),g=b.workDone,S=P}}else if((u.fname==="cos"||u.fname==="sin")&&u.args[0].group===a){let v=0,M=new j(0),P=e.parse("pi/2");if(u.args[0].each(b=>{let R=e.divide(b.clone(),P.clone());R=W.Simplify._simplify(R),R=n.Utils.evaluate(R),fe(R)?v+=R.multiplier.num.toJSNumber():M=e.add(M,b)}),v){v+=u.fname==="cos"?1:0,v%=4,v+=v<0?4:0;let b=["sin({0})","cos({0})","-sin({0})","-cos({0})"],R=n.Utils.format(b[v],M);S=e.parse(R),g=!0}else if(Object.keys(u.args[0].symbols).length>1){let b=u.args[0].clone(),R=Object.values(b.symbols),B=R[0],te=R.slice(1).map(qe=>`(${qe.text()})`).join("+"),ue;u.fname==="sin"?ue=n.Utils.format("sin({0})cos({1})+sin({1})cos({0})",B,te):ue=n.Utils.format("cos({0})cos({1})-sin({1})sin({0})",B,te),S=e.parse(ue),g=!0}}else if((u.fname==="cos"||u.fname==="sin")&&u.args[0].multiplier.sign()===-1){let v=u.args[0].clone().negate(),M=n.Utils.format(`${u.fname}({0})`,v);u.fname==="sin"&&(M=`-${M}`),S=e.parse(M),g=!0}if(u.fname==="sin"&&u.args[0].multiplier.equals(2)&&!u.args[0].equals(2)){let v=u.args[0].clone().toUnitMultiplier(),M=n.Utils.format("2sin({0})cos({0})",v);S=e.parse(M),g=!0}if(S=W.Simplify.unstrip(d,S).distributeMultiplier(),u=S,r>10)break}return u},logArgSimp(u,g){if(g.value==="1"||g.value===1)return new j(0);let r=new j(0),d=g.multiplier.clone();if(g.toUnitMultiplier(),!d.equals(1)){let S=n.Utils.format("({0}({1}))",u,d);r=e.add(r,e.parse(S))}if(g.group===ae)g.each(S=>{S=S.clone();let v=S.power.clone();W.Simplify.strip(S);let M=n.Utils.format("(({1})*{0}({2}))",u,v,S);r=e.add(r,e.parse(M))});else{let S=g.clone(),v=S.power.clone();W.Simplify.strip(S);let M=n.Utils.format("(({1})*{0}({2}))",u,v,S);r=e.add(r,e.parse(M))}return r},logSimp(u){if(u.group===Z&&(u.fname==="log"||u.fname==="log10")){let g=u.clone(),r=W.Simplify.strip(u);u=r.pop();let d=u.args[0].clone(),S=d.getNum().clone(),v=d.getDenom().clone(),M=u.fname,P=W.Simplify.logArgSimp(M,S);if(!v.equals(1)){let b=W.Simplify.logArgSimp(M,v);P=e.subtract(P,b)}P=W.Simplify.unstrip(r,P).distributeMultiplier(),u=P}else if(u.containsFunction(["log","log10"]))for(let g in u.symbols){if(!Object.hasOwn(u.symbols,g))continue;let r=u.symbols[g];u.symbols[g]=W.Simplify.logSimp(r)}return u},_sqrtCompression(u,g,r){let d=W.Simplify.strip(u),S=qe=>qe.fname==="abs",v=qe=>qe.args[0],M=qe=>S(qe)?v(qe):null,P=qe=>qe.type===K&&qe.value.startsWith("baseunit_"),b=(qe,me)=>{let Be=v(me);return Be.equals(M(qe))?[me,null]:Be.equals(qe)&&P(qe)?[me,null]:[null,me]},R,B=!1,Q=(qe,me)=>{for(let Be=0;Be<qe.length;Be++){let Je=qe[Be];if(Je.isSQRT()){for(let Ae=0;Ae<me.length;Ae++){let Ve=me[Ae];if([Ve,Je]=b(Ve,Je),Ve!==null){me[Ae]=Ve,R=!0,B=!0;break}}qe[Be]=Je,qe=qe.filter(Ae=>Ae),me=me.filter(Ae=>Ae)}}return[qe,me]},te=g.collectFactors(),ue=r.collectFactors();do R=!1,[te,ue]=Q(te,ue),[ue,te]=Q(ue,te);while(R);return B&&(u=te.reduce((qe,me)=>qe=e.multiply(qe,me),new j(1)),u=ue.reduce((qe,me)=>qe=e.divide(qe,me),u)),u=W.Simplify.unstrip(d,u),u},fracSimp(u){let g=u.getDenom(),r=u.getNum();if(r.isImaginary()&&g.isImaginary()&&(u=W.Simplify.complexSimp(r,g)),u.isComposite()){u.power>1&&(u=e.expand(u));let d=u.collectSymbols(),S,v,M,P,b,R,B,Q,te,ue,qe;for(v=d.pop();d.length;)M=d.pop(),P=e.parse(v.getDenom()),b=e.parse(M.getDenom()),R=v.getNum(),B=M.getNum(),qe=e.multiply(P.clone(),b.clone()),te=e.multiply(R,b),ue=e.multiply(B,P),Q=e.add(te,ue),v=e.divide(Q,qe);return g=e.expand(v.getDenom()),r=e.expand(v.getNum()),r.isImaginary()&&g.isImaginary()?S=W.Simplify.complexSimp(r,g):S=e.divide(r,g),S.equals(u)?u:W.Simplify._simplify(S)}return u=W.Simplify._sqrtCompression(u,r,g),u=W.Simplify.simpleFracSimp(u),u},simpleFracSimp(u){let g=u.getDenom(),r=u.getNum(),d;return g=e.expand(g),r=e.expand(r),r.isImaginary()&&g.isImaginary()?d=W.Simplify.complexSimp(r,g):d=e.divide(r,g),d.equals(u)?u:d},ratSimp(u){if(u.group===ae){let g=u.getDenom(),r=u.getNum().distributeMultiplier(),d=W.Simplify.fracSimp(g),S=W.Simplify.fracSimp(r);u=e.divide(S,d)}return u},sqrtSimp(u,g){let r,d=!1,S=u.clone();try{if(u.isSQRT()){let v=u.multiplier.clone(),M=u.args[0].clone(),P=W.Factor.factorInner(M),b=e.parse(P.multiplier),R=b.sign();r=new j(1);let B;if(P.group===ae){let Q=new j(1);P.each(ue=>{if(ue=e.parse(ue),ue.group===_){let qe=e.sqrt(ue.clone());fe(qe)?r=e.multiply(r,qe):Q=e.multiply(Q,ue)}else Q=e.multiply(Q,ue)});let te=e.multiply(Q,e.parse(R));B=e.sqrt(te.clone()),B.isImaginary()&&(B=e.sqrt(e.expand(te.clone())))}else B=P.clone().toUnitMultiplier(),B=e.multiply(B,new j(R)),B=e.sqrt(B);r=e.multiply(r,B),r=e.pow(r,e.parse(u.power)),r=e.multiply(r,e.sqrt(b.abs())),r=e.multiply(r,e.parse(v)),d=!0}else u.isComposite()&&u.isLinear()?(r=new j(0),u.each(v=>{r=e.add(r,W.Simplify.sqrtSimp(v))},!0),r=e.pow(r,e.parse(u.power)),r=e.multiply(r,e.parse(u.multiplier)),d=!0):u.group===ae&&(r=new j(1),u.each(v=>{let M=W.Simplify.sqrtSimp(v);r=e.multiply(r,M)}),r=e.pow(r,e.parse(u.power)),r=e.multiply(r,e.parse(u.multiplier)),d=!0);return d||r&&!fe(r)&&(r=null),r||=e.parse(u),r}catch(v){if(v.message==="timeout")throw v;return S}},patternSub(u){let g={},r=function(S){let v=!1;return S.each(M=>{M.group===a?v=!0:M.symbols&&(v=r(M))}),v},d=function(S){S.each(v=>{if(!(!v.symbols&&v.group!==Z)){if(r(v))d(v);else if(!g[v.value]){let M=n.Utils.getU(u);g[v.value]=M,u=u.sub(v.value,M)}}},!0)};return d(u),[u,g]},simplify(u){if(u.simplify)return u.simplify();let g=W.Simplify._simplify(u);return g=g.pushMinus(),g=e.parse(g),g},_simplify(u){let g=W.Simplify.strip(u.clone());if(u=g.pop(),u=W.Simplify.fracSimp(u),u.isConstant()||u.group===n.groups.S)return g.push(u),W.Simplify.unstrip(g,u);let r=u.clone();if(r=W.Simplify.sqrtSimp(r,g),r=W.Simplify.trigSimp(r),r=W.Simplify.logSimp(r),r=W.Simplify.ratSimp(r),r=W.Factor.factorInner(r),r.group===n.groups.CP&&r.isLinear()){let d=r.multiplier.clone();r.toUnitMultiplier();let S=new j(0);return r.each(v=>{let M=W.Simplify._simplify(v);S=e.add(S,M)}),r=S,r=e.multiply(r,new j(d)),r.multiplier.equals(-1)&&r.distributeMultiplier(),r=W.Simplify.unstrip(g,r),r}return r=W.Simplify.unstrip(g,r),r}},Classes:{Polynomial:ye,Factors:Re,MVTerm:Se}};n.Expression.prototype.simplify=function(){n.Utils.armTimeout();try{let g;if(typeof this.symbol.LHS>"u")g=new n.Expression(W.Simplify.simplify(this.symbol));else{let r=this.symbol.clone();r.LHS=W.Simplify.simplify(r.LHS),r.RHS=W.Simplify.simplify(r.RHS),g=r}return g}catch(g){if(g.message==="timeout")throw g;return this}finally{n.Utils.disarmTimeout()}},n.Collection.prototype.simplify=function(){return this.elements=this.elements.map(g=>W.Simplify.simplify(g)),this},n.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(g=>g.map(r=>W.Simplify.simplify(r))),this},O0.useAlgebraDiv=function(){let g=W.divideFn=e.divide,r=0;e.divide=function d(S,v){r++;let M;return r===1?M=n.Algebra.divide(S,v):M=d(S,v),r=0,M}},O0.useParserDiv=function(){W.divideFn&&(e.divide=W.divideFn),delete W.divideFn},O0.register([{name:"factor",visible:!0,numargs:1,build(){return W.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return W.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return W.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return W.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return W.roots}},{name:"divide",visible:!0,numargs:2,build(){return W.divide}},{name:"div",visible:!0,numargs:2,build(){return W.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return W.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return W.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...g){let r=W.coeffs(...g);return new n.Vector(r)}}}]),O0.coeffs=function(...g){let r=n.PARSER;for(let S=0;S<g.length;S++)typeof g[S]=="string"?g[S]=r.parse(g[S]):g[S]&&g[S].symbol?g[S]=g[S].symbol.clone():n.Utils.isSymbol(g[S])&&(g[S]=g[S].clone());let d=W.coeffs(...g);return new n.Expression(new n.Vector(d))},O0.register([{name:"line",visible:!0,numargs:[2,3],build(){return W.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(g,r){try{return r||=Ue(g)[0],W.sqComplete(g.clone(),r).f}catch(d){if(d.message==="timeout")throw d;return g}}}}]),O0.updateAPI()})()});var En=y0((zi,Nn)=>{"use strict";var t1;typeof Nn<"u"&&(t1=B0(),K0(),e1());(function(){let n=t1.getCore(),e=n.PARSER,_=n.Algebra,X=n.Calculus,K=X.integration.decompose_arg,{evaluate:ne}=n.Utils,{remove:Z}=n.Utils,{format:J}=n.Utils,{build:a}=n.Utils,{knownVariable:ae}=n.Utils,{NerdamerSymbol:H}=n,{isSymbol:Ie}=n.Utils,{variables:Ue}=n.Utils,{S:De}=n.groups,{PL:se}=n.groups,{CB:he}=n.groups,{CP:fe}=n.groups,{FN:j}=n.groups,{Settings:xe}=n,{range:Ge}=n.Utils,{isArray:ke}=n.Utils;n.Settings.SOLVE_RADIUS=1e3,n.Settings.ROOTS_PER_SIDE=10,n.Settings.make_pi_conversions=!1,n.Settings.STEP_SIZE=.1,n.Settings.EPSILON=2e-13,n.Settings.MAX_NEWTON_ITERATIONS=200,n.Settings.NEWTON_EPSILON=2e-15,n.Settings.MAX_NON_LINEAR_TRIES=12,n.Settings.NON_LINEAR_JUMP_AT=50,n.Settings.NON_LINEAR_JUMP_SIZE=100,n.Settings.NON_LINEAR_START=.01,n.Settings.NEWTON_SLICES=200,n.Settings.SOLUTION_PROXIMITY=1e-14,n.Settings.FILTER_SOLUTIONS=!0,n.Settings.MAX_SOLVE_DEPTH=10,n.Settings.ZERO_EPSILON=1e-9,n.Settings.MAX_BISECTION_ITER=2e3,n.Settings.BI_SECTION_EPSILON=1e-12,n.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},n.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let d in this.symbols){if(!Object.hasOwn(this.symbols,d))continue;let S=this.symbols[d];if(S.group===se&&S.hasNegativeTerms()||this.symbols[d].power.lessThan(0))return!0}return!1};function ye(r,d){if(d.isConstant()&&r.isConstant()&&!r.equals(d)||r.equals(n.Settings.IMAGINARY)&&d.isConstant(!0)||d.equals(n.Settings.IMAGINARY)&&r.isConstant(!0))throw new n.exceptions.NerdamerValueError(`${r.toString()} does not equal ${d.toString()}`);this.LHS=r,this.RHS=d}ye.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(r){return`${this.LHS.text(r)}=${this.RHS.text(r)}`},toLHS(r){r=!!r;let d=this.removeDenom(),S=d.LHS,v=d.RHS;S.isConstant(!0)&&!v.isConstant(!0)&&([S,v]=[v,S]);let M=e.subtract(S,v),P=r?e.expand(M):M;return P=new ye(P,new H(0)).removeDenom().LHS,P},removeDenom(){let r=this.LHS.clone(),d=this.RHS.clone(),S=e.multiply(r.getDenom(),d.getDenom());if(r=e.expand(e.multiply(r,S.clone())),d=e.expand(e.multiply(d,S)),d.group===fe&&d.group!==fe){let v=r;r=d,d=v}if(r.group===he){let v=new H(r.multiplier),M=d.clone();r.each(P=>{P.power.lessThan(0)?M=e.divide(M,P):v=e.multiply(v,P)}),r=v,d=M}else if(r.group===fe)for(let v in r.symbols){if(!Object.hasOwn(r.symbols,v))continue;let M=r.symbols[v];if(M.group===he)for(let P in M.symbols){if(!Object.hasOwn(M.symbols,P))continue;let b=M.symbols[P];if(b.power.lessThan(0))return new ye(e.expand(e.multiply(b.clone().toLinear(),r)),e.expand(e.multiply(b.clone().toLinear(),d)))}}return new ye(r,d)},clone(){return new ye(this.LHS.clone(),this.RHS.clone())},sub(r,d){let S=this.clone();return S.LHS=S.LHS.sub(r.clone(),d.clone()),S.RHS=S.RHS.sub(r.clone(),d.clone()),S},isZero(){return n.Utils.evaluate(this.toLHS()).equals(0)},latex(r){return[this.LHS.latex(r),this.RHS.latex(r)].join("=")}},e.equals=function(d,S){return new ye(d,S)},(function(){let d=e.functions.simplify[0];e.functions.simplify[0]=function(v){return v instanceof ye?(v.LHS=d(v.LHS),v.RHS=d(v.RHS),v):d(v)}})(),n.Expression.prototype.equals=function(d){return d instanceof n.Expression&&(d=d.symbol),new ye(this.symbol,d)},n.Expression.prototype.solveFor=function(d){n.Utils.armTimeout();try{let{symbol:S}=this;if(this.symbol instanceof ye){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(d))return[new n.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(d))return[new n.Expression(this.symbol.RHS)]}return g(S,d).map(P=>(P=n.Algebra.Simplify.simplify(e.parse(P)),new n.Expression(P)))}finally{n.Utils.disarmTimeout()}},n.Expression.prototype.expand=function(){if(this.symbol instanceof ye){let d=this.symbol.clone();return d.RHS=e.expand(d.RHS),d.LHS=e.expand(d.LHS),new n.Expression(d)}return new n.Expression(e.expand(this.symbol))},n.Expression.prototype.variables=function(){return this.symbol instanceof ye?n.Utils.arrayUnique(n.Utils.variables(this.symbol.LHS).concat(n.Utils.variables(this.symbol.RHS))):n.Utils.variables(this.symbol)};let Re=function(d,S){return e.equals(d,S)};n.Equation=ye;let Se=n.Utils.checkAll=function(d,S){for(let v=0;v<d.length;v++)if(S(d[v]))return!1;return!0},W=n.Solve={version:"2.0.3",solutions:[],solve(r,d){let S=xe.PARSE2NUMBER;xe.PARSE2NUMBER=!1;let v=g(r,String(d));return xe.PARSE2NUMBER=S,new n.Vector(v)},toLHS(r,d){if(Ie(r))return r;if(!(r instanceof ye)){let S=r.split("=");S[1]||="0",r=new ye(e.parse(S[0]),e.parse(S[1]))}return r.toLHS(d)},solveCircle(r,d){let S=d.map(R=>e.parse(R)),v=[],M=[];for(let R=0;R<r.length;R++){let B=[];for(let Q=0;Q<S.length;Q++)B.push(Number(n.Algebra.degree(r[R],S[Q])));B.push(n.Utils.arraySum(B,!0)),v.push(B)}let P=r[0],b=r[1];if(v[0][2]>v[1][2]&&([b,P]=[P,b],[v[1],v[0]]=[v[0],v[1]]),v[0][0]===1&&v[0][2]===2&&v[1][0]===2&&v[1][2]===4){let R=d[0],B=d[1],Q=g(e.parse(b,ae(R,g(e.parse(P),R)[0])),B).map(ue=>ue.toString()),te=[g(e.parse(P,ae(B,Q[0])))[0].toString()];Q[1]&&te.push(g(e.parse(P,ae(B,Q[1])))[0].toString()),xe.SOLUTIONS_AS_OBJECT?(M={},M[R]=te,M[B]=Q):(Q.unshift(B),te.unshift(R),M=[te,Q])}return M},solveNonLinearSystem(r,d,S){if(d<0)return[];S=typeof S>"u"?n.Settings.NON_LINEAR_START:S;let v=n.Settings.MAX_NON_LINEAR_TRIES,M=Math.floor(v/2);d=typeof d>"u"?v:d;let P=n.Settings.NON_LINEAR_JUMP_AT,b=n.Settings.NON_LINEAR_JUMP_SIZE,R=!0,B=function(Le,F){return Le.map(($,G)=>Number(F.get(G,0)))},Q=n.Utils.arrayGetVariables(r),te=n.Matrix.jacobian(r,Q,Le=>a(Le,Q),!0),ue=n.Settings.MAX_NEWTON_ITERATIONS,qe,me,Be,Je,Ae,Ve,Ze,it,Xe=r.map(Le=>a(Le,Q)),Ye=te.map(Le=>a(Le,Q),!0);Je=n.Matrix.cMatrix(0,Q);let rt=n.Matrix.cMatrix(S,Q);Be=0;do{if(Be>ue){R=!1;break}qe=B(Q,rt),Ze=rt.clone();let Le=qe,F=rt;Xe.forEach((G,p)=>{F.set(p,0,G(...Le))});let $=new n.Matrix;if(Ye.each((G,p,z)=>{let V=G(...Le);$.set(p,z,V)}),$=$.invert(),me=e.multiply($,rt).negate(),it=me.subtract(Je,G=>e.parse(Number(G))),Je=Ze.add(me,G=>e.parse(Number(G))),rt=Je,Be>=P&&Ae>1){d===M&&(S=0);let G=d>M?1:-1,p=d%Math.floor(M)+1;return S+=G*p*b,W.solveNonLinearSystem(r,--d,S)}if(Ve=Ae,Be++,Ae=it.max(),Number(Ae)===Number(Ve))break}while(Number(Ae)>=Number.EPSILON);return R?W.systemSolutions(rt,Q,!0,Le=>n.Utils.round(Number(Le),14)):[]},systemSolutions(r,d,S,v){let M=n.Settings.SOLUTIONS_AS_OBJECT?{}:[];return r.each((P,b)=>{let R=(S?e.expand(P):P).valueOf();v&&(R=v.call(P,R));let B=d[b];n.Settings.SOLUTIONS_AS_OBJECT?M[B]=R:M.push([B,R])}),M},solveSystemBySubstitution(r){let d=Ue(r[0]),S=Ue(r[1]);return r.length===2&&d.length===2&&n.Utils.arrayEqual(d,S)?W.solveCircle(r,d):[]},solveSystem(r,d){for(let B=0;B<r.length;B++)r[B]=W.toLHS(r[B]);let S=r.length,v=new n.Matrix,M=new n.Matrix,P=!1,b;if(typeof d>"u"){if(!_.allLinear(r))try{return W.solveNonLinearSystem(r)}catch(B){if(B.message==="timeout")throw B;if(B instanceof n.exceptions.DivisionByZero)return W.solveSystemBySubstitution(r)}if(b=n.Utils.arrayGetVariables(r),b.length===1){let B=0,Q,te;do te=r[B].clone(),B>0&&(te=te.sub(b[0],Q[0])),Q=g(te,b[0]);while(++B<r.length);let ue;return xe.SOLUTIONS_AS_OBJECT?(ue={},ue[b[0]]=Q):Q.length===0?ue=Q:ue=[b[0],Q],ue}if(b.length<r.length){let B=[],Q=r.length;for(let me=0;me<Q-1;me++)B.push(e.parse(r[me]));let te={},ue=W.solveSystem(B,b);Array.isArray(ue)?ue.forEach(me=>{te[me[0]]=me[1]}):te=ue;let qe=!0;for(let me=Q-1;me<Q;me++)e.parse(r[me],te).equals(0)||(qe=!1);if(qe)return ue}for(let B=0;B<b.length;B++)t1.setVar(b[B],"delete");for(let B=0;B<S;B++){let Q=r[B];for(let ue=0;ue<b.length;ue++){let qe=b[ue],me=[];Q.each(Je=>{Je.contains(qe)&&(me=me.concat(Je.coeffs()))});let Be=n.Utils.arraySum(me);v.set(B,ue,Be)}let te=Q.clone();b.forEach(ue=>{te=te.stripVar(ue,!0)}),M.set(B,0,te.negate())}}else{b=d,P=!0;for(let B=0;B<S;B++){M.set(B,0,new H(0));let Q=e.expand(r[B]).collectSummandSymbols();for(let te=0;te<d.length;te++){v.set(B,te,new H(0));let ue=d[te];for(let qe=0;qe<Q.length;qe++){let me=Q[qe],Be=!1;for(let Je=0;Je<d.length;Je++)me.contains(d[Je])&&(Be&&n.err(`Multiple variables found for term ${me}`),Be=!0);if(me.contains(ue)){let Je=K(Z(Q,qe),ue);qe--,v.set(B,te,e.add(v.get(B,te),Je[0]))}}}for(let te=0;te<Q.length;te++)M.set(B,0,e.add(M.get(B,0),Q[te]))}}if(b.length!==r.length||v.determinant().equals(0))throw new n.exceptions.SolveError("System does not have a distinct solution");v=v.invert();let R=v.multiply(M);return n.Utils.isArray(d)&&R.each(B=>B.negate()),W.systemSolutions(R,b,P)},quad(r,d,S){let v=e.subtract(e.pow(d.clone(),H(2)),e.multiply(e.multiply(S.clone(),r.clone()),H(4)));v=e.expand(v);let M=e.pow(v,H(.5)),P=e.parse(e.multiply(new H(2),S.clone()));return[e.parse(J("(-({0})+({1}))/({2})",d,M,P)),e.parse(J("(-({0})-({1}))/({2})",d,M,P))]},cubic(r,d,S,v){let M=v.text(),P=S.text(),b=d.text(),R=r.text(),B=`(-(${P})^3/(27*(${M})^3)+(${P})*(${b})/(6*(${M})^2)-(${R})/(2*(${M})))`,Q=`((${b})/(3*(${M}))-(${P})^2/(9*(${M})^2))`,te=`(${P})/(3*(${M}))`,ue=`((${B})+sqrt((${B})^2+(${Q})^3))^(1/3)+((${B})-sqrt((${B})^2+(${Q})^3))^(1/3)-(${te})`,qe="1/2+sqrt(3)/2*i";return[e.parse(ue),e.parse(`(${ue})(${qe})`),e.parse(`(${ue})(${qe})^2`)]},quartic(r,d,S,v,M){let P={};n.Utils.arrayUnique(Ue(M).concat(Ue(v)).concat(Ue(S)).concat(Ue(d)).concat(Ue(r))).forEach(Ve=>{P[Ve]=1}),M=M.toString(),v=v.toString(),S=S.toString(),d=d.toString(),r=r.toString();let b,R=e.parse(J("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",M,v,S)).toString(),B=e.parse(J("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",M,v,S,d)).toString(),Q=e.parse(J("12*({0})*({4})-3*({1})*({3})+({2})^2",M,v,S,d,r)).toString(),te=e.parse(J("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",M,v,S,d,r)).toString(),ue=e.parse(J("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",Q,te)).toString(),qe=e.parse(J("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",M,R,ue,Q)).toString(),me=e.parse(J("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",M,v,R,B,qe)),Be=e.parse(J("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",M,v,R,B,qe)),Je=e.parse(J("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",M,v,R,B,qe)),Ae=e.parse(J("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",M,v,R,B,qe));return[me,Be,Je,Ae]},divideAndConquer(r,d){let S=[],v=n.Algebra.Factor.factorInner(r);return v.group===he&&v.each(M=>{M=H.unwrapPARENS(M),S=S.concat(g(M,d))}),S},csolve(r,d){return n.Utils.block("IGNORE_E",()=>{let S,v,M,P,b,R,B,Q,te=[],ue=n.Utils.decompose_fn(r,d,!0);if(ue.x.group===De){S=e.parse(ue.x.power),v=Number(S),M=e.pow(e.divide(ue.b.negate(),ue.a),S.invert()),P=H.toPolarFormArray(M),b=P[0],R=P[1],B=b.toString(),Q=S.toString();let qe,me,Be;for(let Je=0;Je<v;Je++)qe=Je,Be=J("({0})*e^(2*{1}*pi*{2}*{3})",B,qe,S,n.Settings.IMAGINARY),me=e.parse(Be),te.push(me)}return te},!0)},getPoints(r,d,S){d||=.01;let v=[],M=a(r),b=Math.round(0),R=M(b),B=n.Settings.ROOTS_PER_SIDE,Q=B;v.push(Math.floor(b/2)),v.push(Math.abs(b)),v.push(b),r.each(me=>{me.containsFunction(n.Settings.LOG)&&v.push(.1)});let te=Ge(-n.Settings.SOLVE_RADIUS,b,d),ue=Ge(b,n.Settings.SOLVE_RADIUS,d),qe=function(me,Be){let Je,Ae,Ve,Ze=[],it=me[0],Xe=Math.sign(M(it));for(let Ye=0,rt=me.length;Ye<rt&&Ze.length<Be;Ye++)Je=me[Ye],Ae=M(Je),Ve=Math.sign(Ae),!isNaN(Ve)&&(Ve!==Xe&&(Ze.push(Je),Ze.push(me[Ye-1])),Xe=Ve);v=v.concat(Ze)};if(qe(te,Q),qe(ue,B),S){let me=n.Settings.SOLVE_RADIUS;qe([me,me*me],1),qe([-me*me,-me],1)}return v},bisection(r,d){let S=r-1,v=r+1;if(Math.sign(d(S))!==Math.sign(d(v))){let M=0,P,b;do{if(P=Math.abs(v-S),M++>n.Settings.MAX_BISECTION_ITER||isNaN(P))return;b=(S+v)/2,d(S)*d(b)>0?S=b:v=b}while(P>=xe.EPSILON);let R=(S+v)/2,B=d(R);return!isNaN(B)&&Math.abs(B)<=n.Settings.BI_SECTION_EPSILON?n.Utils.round(R,13):void 0}},bSearch(r,d,S){let v=S(r),M=S(d);if(Math.sign(v)===Math.sign(M)||isNaN(v)||isNaN(M))return;let P=80,b=0;do{let R=(r+d)/2,B=Math.sign(v),Q=Math.sign(S(R));if(B===Q){if(R===r)break;r=R,v=S(r)}else{if(R===d)break;d=R,M=S(d)}b++}while(r!==d&&b<P);if(!(!isFinite(S(r))||!isFinite(S(d))))return r},Newton(r,d,S,v){let M=n.Settings.MAX_NEWTON_ITERATIONS,P=0,b=r,R,B,Q;do{let te=d(b);if(b===0&&te===0){R=0;break}if(P++,P>M)return;let ue=S(b);if(isNaN(ue)||isNaN(te))return;if(ue===0)R+=Q;else{if(!isFinite(te)||!isFinite(ue)||Math.abs(te)>1e25)return W.bSearch(v,b,d);R=b-te/ue}if(Q=R-b,Q===0&&!isFinite(ue))return;B=Math.abs(Q),b=R}while(B>xe.NEWTON_EPSILON);return R},rewrite(r,d,S){if(d||=new H(0),r.isComposite()&&r.isLinear()){let P=[],b=[];r.each(R=>{R=R.clone(),R.fname==="sqrt"&&R.contains(S)?P.push(R):b.push(R)},!0),P.length===1&&(d=e.expand(e.pow(e.subtract(d,n.Utils.arraySum(b)),new H(2))),r=e.expand(e.pow(H.unwrapSQRT(P[0]),new H(2))))}else r=H.unwrapSQRT(e.expand(r));let v=0,M=r.length;if(r.group===fe&&r.contains(S)&&r.isLinear()){r.distributeMultiplier();let P=new H(0);return r.each(b=>{b.contains(S)?(v++,P=e.add(P,b.clone())):d=e.subtract(d,b.clone())}),r=P,v!==M?W.rewrite(r,d,S):[r,d]}if(r.group===he&&r.contains(S)&&r.isLinear()){if(r.multiplier.lessThan(0)&&(r.multiplier=r.multiplier.multiply(new n.Frac(-1)),d.multiplier=d.multiplier.multiply(new n.Frac(-1))),d.equals(0))return new H(0);let P=new H(1);return r.each(b=>{b.contains(S)?P=e.multiply(P,b.clone()):d=e.divide(d,b.clone())}),r=P,W.rewrite(r,d,S)}if(!r.isLinear()&&r.contains(S)){let P=e.parse(r.power.clone().invert());return r=e.pow(r,P.clone()),d=e.pow(e.expand(d),P.clone()),W.rewrite(r,d,S)}return r.group===j||r.group===De||r.group===se?[r,d]:[r,d]},sqrtSolve(r,d){let S=new H(0),v=new H(0);if(r.isComposite()&&(r.each(M=>{M.fname==="sqrt"&&M.contains(d)?S=e.add(S,M.clone()):v=e.add(v,M.clone())}),!S.equals(0))){let M=e.expand(e.multiply(e.parse(r.multiplier),e.subtract(e.pow(v,new H(2)),e.pow(S,new H(2))))),P=g(M,d);return P=P.filter(b=>{if(b.isImaginary())return!0;let R={};return R[d]=b,!!ne(r,R).equals(0)}),P}}},u=function(r,d,S,v){let M=r.toString(),P=M.match(/(?<![a-z])abs/gu);if(!P||P.length>2||r.LHS.group!==j&&r.RHS.group!==j)return null;let b=r.constructor(M.replace(/(?<![a-z])abs/u,"")),R=r.constructor(M.replace(/(?<![a-z])abs/u,"(-1)")),B=g(b,d,null,S,v);return[g(R,d,null,S,v),B]};function g(r,d,S,v,M){if(v||=0,v++>xe.MAX_SOLVE_DEPTH)return S;S||=[];let P={},b={};b[d]=0;let R=function(Ae,Ve){let Ze=Ie(Ae);if(!(Ae===void 0||typeof Ae=="number"&&isNaN(Ae))){if(ke(Ae))Ae.forEach(it=>{R(it)});else if(Ae.valueOf()!=="null"){if(typeof n.Settings.PRE_ADD_SOLUTION=="function"&&(Ae=n.Settings.PRE_ADD_SOLUTION(Ae)),Ze||(Ae=e.parse(Ae)),n.Settings.make_pi_conversions&&Ve){let Xe=e.divide(Ae.clone(),new H(Math.PI)),Ye=Xe.multiplier,rt=Math.abs(Ye.num),Le=Math.abs(Ye.den);rt<10&&Le<10&&(Ae=e.multiply(Xe,new H("pi")))}let it=Ae.toString();P[it]||S.push(Ae),P[it]=!0}}};if(r instanceof ye){let Ae=u(r,d,S,v,M);if(Ae)return R(Ae),S;if(r.isZero())return[new H(0)];if(r.LHS.equals(d)&&!r.RHS.contains(d,!0))return[r.RHS];if(r.RHS.equals(d)&&!r.LHS.contains(d,!0))return[r.LHS]}if(r instanceof n.Vector&&(r=r.elements),ke(r))return W.solveSystem(r,d);if(d||="x",Ie(r)&&ne(r.getDenom(),b).equals(0)===!0)return S;if(r.group===De&&r.contains(d)){try{let Ae={};Ae[d]=0,ne(M,Ae,"numer"),R(new H(0))}catch(Ae){if(Ae.message==="timeout")throw Ae}return S}if(r.group===he){let Ae=r.getNum();if(Ae.group===he){let Ve=String(d);return Ae.each(Ze=>{Ze.contains(Ve)&&g(Ze,d,S,v,r)}),S}return g(Ae,d,S,v,M)}r.group===j&&r.fname==="sqrt"&&(r=e.pow(H.unwrapSQRT(r),new H(2)));let B=(n.Utils.isSymbol(r)?r:W.toLHS(r,!1)).getNum(),Q=n.Utils.variables(B),te=Q.length;if(n.Utils.isInt(B.power)&&B.power>1&&(B=e.parse(B).toLinear()),(B.group===De||B.group===he)&&B.contains(d))return[new H(0)];let ue={},qe,me=function(Ae){Ae=e.expand(Ae,{expand_denominator:!0,expand_functions:!0});let Ve=Ae.clone();if(Ae.symbols)for(let Ze in Ae.symbols){if(!Object.hasOwn(Ae.symbols,Ze))continue;let it=Ae.symbols[Ze],Xe=it.getDenom();if(!Xe.isConstant(!0)&&Ae.isComposite()){let $=new H(0);return Ae.each(G=>{$=e.add($,e.multiply(G,Xe.clone()))}),me(e.multiply(e.parse(Ae.multiplier),$))}let Ye=K(it,d),rt=Ye[1].fname===n.Settings.SQRT,Le=H.unwrapSQRT(Ye[1]),F=Le.power.clone();if(!Ie(F)&&!F.equals(1/2)){if(F.den.gt(1)){if(rt)return Ae=e.subtract(Ae,it.clone()),Ae=e.add(Ae,e.multiply(Ye[0].clone(),Le)),me(Ae);let $=ue[F.den];ue[F.den]=$?$++:1}else if(F.sign()===-1){let $=e.parse(`${d}^${Math.abs(F)}`),G=Ae;return G.each((p,z)=>{p.contains(d)&&(G.symbols[z]=e.multiply(p,$.clone()))}),ue={},me(e.parse(G))}else if(it.group===se){let $=n.Utils.arrayMin(n.Utils.keys(it.symbols));if($<0){let G=e.parse(`${d}^${Math.abs($)}`),p=new H(0);return Ve.each(z=>{p=e.add(p,e.multiply(z.clone(),G.clone()))},!0),p}}}}return Ae},Be=function(Ae){let Ve=new H(0),Ze=new H(0);return Ae.each(it=>{it.contains(d,!0)?Ve=e.add(Ve,it.clone()):Ze=e.subtract(Ze,it.clone())}),[Ve,Ze]};if(W.inverseFunctionSolve=function(Ve,Ze,it){let Xe=K(Ze.args[0],d);if(Xe[1].group===De)return e.divide(e.symfunction(Ve,[e.divide(it,e.parse(Ze.multiplier))]),Xe[0])},B=me(B),B.equals(0))return[B];let Je=n.Utils.keys(ue);if(Je.length===1&&(qe=Je[0],B.each((Ae,Ve)=>{if(Ae.contains(d)){let Ze=K(Ae,d),it=Ze[1],Xe=it.power;Xe.den.gt(1)&&(it.power=Xe.multiply(new n.Frac(qe)),B.symbols[Ve]=e.multiply(it,Ze[0]))}}),B=e.parse(B)),R(W.sqrtSolve(B,d)),te===1)if(B.isPoly(!0)){let Ae=new n.Algebra.Classes.Factors;if(n.Algebra.Factor.factorInner(B,Ae),Ae.getNumberSymbolics()>1)for(let Ve in Ae.factors)Object.hasOwn(Ae.factors,Ve)&&R(g(Ae.factors[Ve],d));else{let Ve=n.Utils.getCoeffs(B,d),Ze=Ve.length-1,it=!1;if(Q[0]===d){if(Se(Ve,Xe=>Xe.group!==n.groups.N)){let Xe=n.Algebra.proots(B);Se(Xe,Ye=>!n.Utils.isInt(Ye))&&(it=!0,Xe.forEach(Ye=>{R(new H(Ye))}))}if(!it)if(r=e.parse(r),r instanceof n.Equation&&(r=r.toLHS()),Ze===1)R(e.divide(Ve[0],Ve[1].negate()));else if(Ze===2)R(e.expand(W.quad.apply(void 0,Ve)));else if(Ze===3){let Xe=[],Ye=n.Algebra.Factor.factorInner(r);Xe=[],Xe.length>0?R(Xe):R(W.cubic.apply(void 0,Ve))}else _.proots(B).map(R)}}}else{let Ae=B.hasTrig(),Ve=W.getPoints(B,.1),Ze=W.getPoints(B,.05),it=W.getPoints(B,.01,!0),Xe=n.Utils.arrayUnique(Ve.concat(Ze).concat(it)).sort((V,q)=>V-q),Ye,rt,Le,F=a(B.clone()),$=[];for(Ye=0;Ye<Xe.length;Ye++){if(rt=Xe[Ye],Le=W.bisection(rt,F),typeof Le>"u"){$.push(rt);continue}R(Le,Ae)}Xe=$;let G=X.diff(B.clone()),p=a(G),z=Xe[0];for(Ye=0;Ye<Xe.length;Ye++)rt=Xe[Ye],R(W.Newton(rt,F,p,z),Ae),z=rt;S.sort((V,q)=>{let l=V.text("decimals"),t=q.text("decimals"),i=Number(l),h=Number(t);return isNaN(i)&&isNaN(h)?l.localeCompare(t):isNaN(i)&&!isNaN(h)?-1:!isNaN(i)&&isNaN(h)?1:i-h}),S=S.map(V=>V.isConstant()?new H(Number(Number(V).toPrecision(15))):V),S=S.filter((V,q,l)=>{let t=Number(Number(V).toPrecision(15)),i=Number(l[q-1]);return q===0||isNaN(t)||isNaN(i)?!0:Math.abs(t-i)>=xe.EPSILON})}else if(!B.hasFunc(d)&&B.isComposite())try{let Ae=n.Algebra.Factor.factorInner(B.clone()),Ve=e.expand(e.parse(Ae)),Ze=e.expand(B.clone()),it=e.subtract(Ve,Ze),Xe=!0;if(it.equals(0)||(Xe=!1),Xe&&Ae.group===he)Ae.each(Ye=>{R(g(Ye,d))});else{let Ye=n.Utils.getCoeffs(B,d);switch(Ye.length-1){case 0:{let F=Be(B),$=F[0],G=F[1];if($.group===n.groups.EX){let p=n.Settings.LOG,z=`${p}((${G})/(${$.multiplier}))/(${p}(${$.value})*${$.power.multiplier})`,V=e.parse(z);R(V)}break}case 1:R(e.divide(Ye[0],Ye[1].negate()));break;case 2:R(W.quad.apply(void 0,Ye));break;case 3:R(W.cubic.apply(void 0,Ye));break;case 4:R(W.quartic.apply(void 0,Ye));break;default:R(W.csolve(B,d)),S.length===0&&R(W.divideAndConquer(B,d))}S.length===0&&R(g(Ae,d,S,v))}}catch(Ae){if(Ae.message==="timeout")throw Ae}else try{let Ae=W.rewrite(B,null,d),Ve=Ae[0],Ze=Ae[1];if(Ve.group===j)if(Ve.fname==="abs")Ve.args[0].toString()===d&&R([Ze.clone(),Ze.negate()]);else if(Ve.fname==="sin")R(W.inverseFunctionSolve("asin",Ve,Ze));else if(Ve.fname==="cos")R(W.inverseFunctionSolve("acos",Ve,Ze));else if(Ve.fname==="tan")R(W.inverseFunctionSolve("atan",Ve,Ze));else if(Ve.fname===n.Settings.LOG){let it=K(Ve.args[0],d),Xe=it[1];if(Xe.group===De){Ze=e.divide(e.subtract(e.pow(Ve.args.length>1?Ve.args[1]:new H("e"),e.divide(Ze,e.parse(Ve.multiplier))),it[3]),it[0]);let Ye=new ye(Xe,Ze).toLHS();R(g(Ye,d))}}else R(e.subtract(Ve,Ze));else{let it=new ye(Ve,Ze).toLHS();if(it.equals(B))throw new Error("Stopping. No stop condition exists");R(g(it,d))}}catch(Ae){if(Ae.message==="timeout")throw Ae;if(B.group===he)R(0);else if(B.group===fe){let Ve=Be(B),Ze=Ve[0],it=Ve[1];if(Ze.group===n.groups.EX&&Ze.value===d){let Xe=Ze.power.clone().invert();R(e.pow(it,Xe))}}}if(qe&&(S=S.map(Ae=>e.pow(Ae,new H(qe)))),Ie(r)){let Ae={};S=S.filter(Ve=>{try{Ae[d]=Ve;let Ze=Number(ne(r,Ae));return isNaN(Ze),!0}catch(Ze){if(Ze.message==="timeout")throw Ze;return!1}})}return S}t1.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return g}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return n.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return Re}}]),t1.updateAPI()})()});var Mn=y0((Wi,S1)=>{"use strict";var n1;typeof S1<"u"&&(n1=B0(),K0(),e1());(function(){let n=n1.getCore(),e=n.PARSER,{NerdamerSymbol:_}=n,{format:X}=n.Utils,{isVector:K}=n.Utils,{isArray:ne}=n.Utils,Z=n.Vector,{S:J}=n.groups,a=n.groups.EX,{CP:ae}=n.groups,{PL:H}=n.groups,{CB:Ie}=n.groups,{FN:Ue}=n.groups;n.Settings.Laplace_integration_depth=40,_.prototype.findFunction=function(he){if(this.group===Ue&&this.fname===he)return this.clone();let fe;if(this.symbols){for(let j in this.symbols)if(Object.hasOwn(this.symbols,j)&&(fe=this.symbols[j].findFunction(he),fe))break}return fe};let De=n.Extra={version:"1.4.2",LaPlace:{transform(se,he,fe){se=se.clone(),he=he.toString(),se=_.unwrapSQRT(se,!0);let j,xe=se.stripVar(he),Ge=se.group;if(se=e.divide(se,xe.clone()),se.isConstant()||!se.contains(he,!0))j=e.parse(X("({0})/({1})",se,fe));else if(Ge===J&&n.Utils.isInt(se.power)){let ke=String(se.power);j=e.parse(X("factorial({0})/({1})^({0}+1)",ke,fe))}else if(se.group===J&&se.power.equals(1/2))j=e.parse(X("sqrt(pi)/(2*({0})^(3/2))",fe));else if(se.isComposite())j=new _(0),se.each(ke=>{j=e.add(j,De.LaPlace.transform(ke,he,fe))},!0);else if(se.isE()&&(se.power.group===J||se.power.group===Ie)){let ke=se.power.stripVar(he);j=e.parse(X("1/(({1})-({0}))",ke,fe))}else{let ke=["sin","cos","sinh","cosh"];if(se.group===Ue&&ke.indexOf(se.fname)!==-1&&(se.args[0].group===J||se.args[0].group===Ie)){let ye=se.args[0].stripVar(he);switch(se.fname){case"sin":j=e.parse(X("({0})/(({1})^2+({0})^2)",ye,fe));break;case"cos":j=e.parse(X("({1})/(({1})^2+({0})^2)",ye,fe));break;case"sinh":j=e.parse(X("({0})/(({1})^2-({0})^2)",ye,fe));break;case"cosh":j=e.parse(X("({1})/(({1})^2-({0})^2)",ye,fe));break}}else{let ye=n.Settings.integration_depth<n.Settings.Laplace_integration_depth,Re;ye&&(Re=n.Settings.integration_depth,n.Settings.integration_depth=n.Settings.Laplace_integration_depth),n.Utils.block("PARSE2NUMBER",()=>{let Se=he,W=se.sub(he,Se),u=e.parse(`e^(-${fe}*${Se})*${W}`);if(j=n.Calculus.integrate(u,Se),j.hasIntegral()){j=e.symfunction("laplace",[se,he,fe]);return}j=j.sub(he,0),j=e.expand(e.multiply(j,new _(-1))),j=j.sub(Se,he)},!1),j=n.Utils.block("PARSE2NUMBER",()=>e.parse(j),!0),ye&&(n.Settings.integration_depth=Re)}}return e.multiply(j,xe)},inverse(se,he,fe){let j=se.clone();return n.Utils.block("POSITIVE_MULTIPLIERS",()=>{let xe;if(se.group===Ie&&(se=n.Algebra.PartFrac.partfrac(e.expand(se),he)),se.group===J||se.group===Ie||se.isComposite()){let Ge,ke,ye,Re,Se,W,u,g,r=se.multiplier.clone();se.toUnitMultiplier();let d=se.getNum(),S=se.getDenom().toUnitMultiplier();S.group===ae||S.group===H?(ke=S.power.clone(),S.toLinear()):ke=new n.Frac(1);let v=he.toString(),M=n.Utils.decompose_fn(S,v,!0),P=n.Utils.decompose_fn(e.expand(d.clone()),v,!0);d.multiplier=d.multiplier.multiply(r);let b=function(){xe=e.multiply(xe,d),xe.multiplier=xe.multiplier.multiply(se.multiplier),xe=e.divide(xe,M.a)};if((S.group===J||S.group===Ie)&&M.x.value===v&&M.b.equals(0)&&n.Utils.isInt(M.x.power))Ge=M.x.power-1,g=n.Math2.factorial(Ge),xe=e.divide(e.pow(fe,new _(Ge)),new _(g)),b();else if(S.group===ae&&ke.equals(1)){if(M.x.group===n.groups.PL&&n.Algebra.degree(S).equals(2)){let R=n.Algebra.sqComplete(S,v),B=n.Utils.getU(S);ye=n.Utils.decompose_fn(R.a,v,!0).b;let Q=De.LaPlace.inverse(e.parse(`1/((${B})^2+(${R.c}))`),B,fe);xe=e.multiply(Q,e.parse(`(${r})*e^(-(${ye})*(${fe}))`))}else if(M.x.isLinear()&&!d.contains(v))fe=e.divide(fe,M.a.clone()),Ge=ke-1,g=Ge===0||Ge===1?"1":`(${ke}-1)!`,xe=e.parse(X("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",fe,M.a,M.b,ke,g)),b();else if(M.x.group===J&&M.x.power.equals(2))if(d.contains(v)){if(ye=new _(1),d.group===Ie){let me=new _(1);d.each(Be=>{Be.contains(v)?me=e.multiply(me,Be):ye=e.multiply(ye,Be)}),d=me}u=n.Utils.decompose_fn(d,v,!0);let R=u.a,B=u.b,Q=R.containsFunction("sin"),te=R.containsFunction("cos"),ue=B.containsFunction("cos"),qe=B.containsFunction("sin");if(u.x.value===v&&u.x.isLinear()&&!(Q&&ue||te||qe))xe=e.parse(X("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",fe,u.a,M.a,M.b));else if(Q&&ue){let me=R.findFunction("sin"),Be=B.findFunction("cos");if(me.args[0].equals(Be.args[0])&&!me.args[0].contains(v)){Re=e.divide(B,Be.toUnitMultiplier()).toString();let Je=me.args[0].toString();Se=M.b;let Ae=e.divide(R,me.toUnitMultiplier());W="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",xe=e.parse(X(W,fe,ye,Re,Je,Se,Ae))}}}else xe=e.parse(X("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",fe,d,M.a,M.b))}else if(M.x.power.num&&M.x.power.num.equals(3)&&M.x.power.den.equals(2)&&d.contains("sqrt(pi)")&&!d.contains(v)&&d.isLinear())Re=e.divide(d.clone(),e.parse("sqrt(pi)")),xe=e.parse(X("(2*({2})*sqrt({0}))/({1})",fe,M.a,Re,d));else if(ke.equals(2)&&M.x.power.equals(2))if(d.contains(v))if(u=n.Utils.decompose_fn(e.expand(d.clone()),v,!0),u.x.isComposite()){let R=[],B=d.collectSymbols(Q=>{Q=_.unwrapPARENS(Q);let te=n.Utils.decompose_fn(Q,v,!0);return te.symbol=Q,te}).sort((Q,te)=>{let ue=Q.x.value===v?Q.x.power:0;return(te.x.value===v?te.x.power:0)-ue});ye=new _(-1);for(let Q=0;Q<B.length;Q++){let te=B[Q];te.x.value===v?R.push(te):ye=e.multiply(ye,te.symbol)}R[0].x.power.equals(2)&&R[1].x.power.equals(1)&&R[1].b.equals(0)&&!R[0].b.equals(0)&&(Re=R[0].a.negate(),W="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",xe=e.parse(X(W,fe,ye,Re,R[0].b,M.a,M.b)))}else u.x.isLinear()?(ye=e.divide(u.a,new _(2)),W="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",xe=e.parse(X(W,fe,ye,M.a,M.b))):u.x.power.equals(2)&&(u.b.equals(0)?(ye=e.divide(u.a,new _(2)),W="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",xe=e.parse(X(W,fe,ye,M.a,M.b))):(ye=e.divide(u.a,new _(2)),Se=u.b.negate(),W="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",xe=e.parse(X(W,fe,ye,M.a,M.b,Se))));else ye=e.divide(d,new _(2)),W="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",xe=e.parse(X(W,fe,ye,M.a,M.b));else se.isComposite()&&(ke.equals(2)&&M.x.group===J?xe=e.parse(`(${r})*(${fe})*e^(-(${M.b})*(${fe}))`):(xe=new _(0),se=n.Algebra.PartFrac.partfrac(e.expand(se),he),se.each(R=>{xe=e.add(xe,De.LaPlace.inverse(R,he,fe))},!0)))}return xe||=e.symfunction("ilt",[j,he,fe]),xe},!0)}},Statistics:{frequencyMap(se){let he={};for(let fe=0,j=se.length;fe<j;fe++){let Ge=se[fe].toString();he[Ge]||=0,he[Ge]++}return he},sort(se){return se.sort((he,fe)=>((!he.isConstant()||!fe.isConstant())&&e.error("Unable to sort! All values must be numeric"),he.multiplier.subtract(fe.multiplier)))},count(se){return new _(se.length)},sum(se,he){let fe=new _(0);for(let j=0,xe=se.length;j<xe;j++){let Ge=se[j].clone();he?fe=e.add(e.pow(e.subtract(Ge,he.clone()),new _(2)),fe):fe=e.add(Ge,fe)}return fe},mean(...se){return K(se[0])?De.Statistics.mean(...se[0].elements):e.divide(De.Statistics.sum(se),De.Statistics.count(se))},median(...se){let he;if(K(se[0]))return De.Statistics.median(...se[0].elements);try{let fe=De.Statistics.sort(se),j=se.length;if(n.Utils.even(j)){let xe=j/2;he=De.Statistics.mean(fe[xe-1],fe[xe])}else he=fe[Math.floor(j/2)]}catch(fe){if(fe.message==="timeout")throw fe;he=e.symfunction("median",se)}return he},mode(...se){let he;if(K(se[0]))return De.Statistics.mode(...se[0].elements);let fe=De.Statistics.frequencyMap(se);if(n.Utils.keys(fe).length===1)he=se[0];else{let j={};for(let Ge in fe){if(!Object.hasOwn(fe,Ge))continue;let ke=fe[Ge];if(ke in j){let ye=j[ke];ne(ye)?ye.push(Ge):j[ke]=[Ge,j[ke]]}else j[ke]=Ge}let xe=j[Math.max.apply(null,n.Utils.keys(j))];ne(xe)?he=e.symfunction("mode",xe.sort()):he=e.parse(xe)}return he},gVariance(se,he){let fe=De.Statistics.mean(...he),j=De.Statistics.sum(he,fe);return e.multiply(se,j)},variance(...se){if(K(se[0]))return De.Statistics.variance(...se[0].elements);let he=e.divide(new _(1),De.Statistics.count(se));return De.Statistics.gVariance(he,se)},sampleVariance(...se){if(K(se[0]))return De.Statistics.sampleVariance(...se[0].elements);let he=e.divide(new _(1),e.subtract(De.Statistics.count(se),new _(1)));return De.Statistics.gVariance(he,se)},standardDeviation(...se){return K(se[0])?De.Statistics.standardDeviation(...se[0].elements):e.pow(De.Statistics.variance(...se),new _(1/2))},sampleStandardDeviation(...se){return K(se[0])?De.Statistics.sampleStandardDeviation(...se[0].elements):e.pow(De.Statistics.sampleVariance(...se),new _(1/2))},zScore(se,he,fe){return e.divide(e.subtract(se,he),fe)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};n1.register([{name:"laplace",visible:!0,numargs:3,build(){return De.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return De.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return De.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return De.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return De.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return De.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return De.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return De.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return De.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return De.Statistics.zScore}}]),n1.updateAPI()})();typeof S1<"u"&&(S1.exports=n1)});var Bi=y0((Qi,An)=>{var Fi=B0();e1();K0();En();Mn();An.exports=Fi});return Bi();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
