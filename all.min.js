"use strict";var nerdamer=(()=>{var g0=(m,n)=>()=>(n||m((n={exports:{}}).exports,n),n.exports);var R1=g0((Fi,K0)=>{var Xt=(function(m){"use strict";var n=1e7,e=7,$=9007199254740992,z=pt($),me="0123456789abcdefghijklmnopqrstuvwxyz",we=typeof BigInt=="function";function K(f,p,_,t){return typeof f>"u"?K[0]:typeof p<"u"?+p==10&&!_?C(f):Te(f,p,_,t):C(f)}function le(f,p){this.value=f,this.sign=p,this.isSmall=!1}le.prototype=Object.create(K.prototype);function V(f){this.value=f,this.sign=f<0,this.isSmall=!0}V.prototype=Object.create(K.prototype);function u(f){this.value=f}u.prototype=Object.create(K.prototype);function se(f){return-$<f&&f<$}function pt(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function lt(f){ze(f);var p=f.length;if(p<4&&b(f,z)<0)switch(p){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*n;default:return f[0]+(f[1]+f[2]*n)*n}return f}function ze(f){for(var p=f.length;f[--p]===0;);f.length=p+1}function ue(f){for(var p=new Array(f),_=-1;++_<f;)p[_]=0;return p}function ye(f){return f>0?Math.floor(f):Math.ceil(f)}function Ae(f,p){var _=f.length,t=p.length,i=new Array(_),c=0,g=n,h,v;for(v=0;v<t;v++)h=f[v]+p[v]+c,c=h>=g?1:0,i[v]=h-c*g;for(;v<_;)h=f[v]+c,c=h===g?1:0,i[v++]=h-c*g;return c>0&&i.push(c),i}function ee(f,p){return f.length>=p.length?Ae(f,p):Ae(p,f)}function Le(f,p){var _=f.length,t=new Array(_),i=n,c,g;for(g=0;g<_;g++)c=f[g]-i+p,p=Math.floor(c/i),t[g]=c-p*i,p+=1;for(;p>0;)t[g++]=p%i,p=Math.floor(p/i);return t}le.prototype.add=function(f){var p=C(f);if(this.sign!==p.sign)return this.subtract(p.negate());var _=this.value,t=p.value;return p.isSmall?new le(Le(_,Math.abs(t)),this.sign):new le(ee(_,t),this.sign)},le.prototype.plus=le.prototype.add,V.prototype.add=function(f){var p=C(f),_=this.value;if(_<0!==p.sign)return this.subtract(p.negate());var t=p.value;if(p.isSmall){if(se(_+t))return new V(_+t);t=pt(Math.abs(t))}return new le(Le(t,Math.abs(_)),_<0)},V.prototype.plus=V.prototype.add,u.prototype.add=function(f){return new u(this.value+C(f).value)},u.prototype.plus=u.prototype.add;function Xe(f,p){var _=f.length,t=p.length,i=new Array(_),c=0,g=n,h,v;for(h=0;h<t;h++)v=f[h]-c-p[h],v<0?(v+=g,c=1):c=0,i[h]=v;for(h=t;h<_;h++){if(v=f[h]-c,v<0)v+=g;else{i[h++]=v;break}i[h]=v}for(;h<_;h++)i[h]=f[h];return ze(i),i}function Fe(f,p,_){var t;return b(f,p)>=0?t=Xe(f,p):(t=Xe(p,f),_=!_),t=lt(t),typeof t=="number"?(_&&(t=-t),new V(t)):new le(t,_)}function _e(f,p,_){var t=f.length,i=new Array(t),c=-p,g=n,h,v;for(h=0;h<t;h++)v=f[h]+c,c=Math.floor(v/g),v%=g,i[h]=v<0?v+g:v;return i=lt(i),typeof i=="number"?(_&&(i=-i),new V(i)):new le(i,_)}le.prototype.subtract=function(f){var p=C(f);if(this.sign!==p.sign)return this.add(p.negate());var _=this.value,t=p.value;return p.isSmall?_e(_,Math.abs(t),this.sign):Fe(_,t,this.sign)},le.prototype.minus=le.prototype.subtract,V.prototype.subtract=function(f){var p=C(f),_=this.value;if(_<0!==p.sign)return this.add(p.negate());var t=p.value;return p.isSmall?new V(_-t):_e(t,Math.abs(_),_>=0)},V.prototype.minus=V.prototype.subtract,u.prototype.subtract=function(f){return new u(this.value-C(f).value)},u.prototype.minus=u.prototype.subtract,le.prototype.negate=function(){return new le(this.value,!this.sign)},V.prototype.negate=function(){var f=this.sign,p=new V(-this.value);return p.sign=!f,p},u.prototype.negate=function(){return new u(-this.value)},le.prototype.abs=function(){return new le(this.value,!1)},V.prototype.abs=function(){return new V(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)};function He(f,p){var _=f.length,t=p.length,i=_+t,c=ue(i),g=n,h,v,A,H,P;for(A=0;A<_;++A){H=f[A];for(var X=0;X<t;++X)P=p[X],h=H*P+c[A+X],v=Math.floor(h/g),c[A+X]=h-v*g,c[A+X+1]+=v}return ze(c),c}function xe(f,p){var _=f.length,t=new Array(_),i=n,c=0,g,h;for(h=0;h<_;h++)g=f[h]*p+c,c=Math.floor(g/i),t[h]=g-c*i;for(;c>0;)t[h++]=c%i,c=Math.floor(c/i);return t}function Y(f,p){for(var _=[];p-- >0;)_.push(0);return _.concat(f)}function l(f,p){var _=Math.max(f.length,p.length);if(_<=30)return He(f,p);_=Math.ceil(_/2);var t=f.slice(_),i=f.slice(0,_),c=p.slice(_),g=p.slice(0,_),h=l(i,g),v=l(t,c),A=l(ee(i,t),ee(g,c)),H=ee(ee(h,Y(Xe(Xe(A,h),v),_)),Y(v,2*_));return ze(H),H}function S(f,p){return-.012*f-.012*p+15e-6*f*p>0}le.prototype.multiply=function(f){var p=C(f),_=this.value,t=p.value,i=this.sign!==p.sign,c;if(p.isSmall){if(t===0)return K[0];if(t===1)return this;if(t===-1)return this.negate();if(c=Math.abs(t),c<n)return new le(xe(_,c),i);t=pt(c)}return S(_.length,t.length)?new le(l(_,t),i):new le(He(_,t),i)},le.prototype.times=le.prototype.multiply;function o(f,p,_){return f<n?new le(xe(p,f),_):new le(He(p,pt(f)),_)}V.prototype._multiplyBySmall=function(f){return se(f.value*this.value)?new V(f.value*this.value):o(Math.abs(f.value),pt(Math.abs(this.value)),this.sign!==f.sign)},le.prototype._multiplyBySmall=function(f){return f.value===0?K[0]:f.value===1?this:f.value===-1?this.negate():o(Math.abs(f.value),this.value,this.sign!==f.sign)},V.prototype.multiply=function(f){return C(f)._multiplyBySmall(this)},V.prototype.times=V.prototype.multiply,u.prototype.multiply=function(f){return new u(this.value*C(f).value)},u.prototype.times=u.prototype.multiply;function w(f){var p=f.length,_=ue(p+p),t=n,i,c,g,h,v;for(g=0;g<p;g++){h=f[g],c=0-h*h;for(var A=g;A<p;A++)v=f[A],i=2*(h*v)+_[g+A]+c,c=Math.floor(i/t),_[g+A]=i-c*t;_[g+p]=c}return ze(_),_}le.prototype.square=function(){return new le(w(this.value),!1)},V.prototype.square=function(){var f=this.value*this.value;return se(f)?new V(f):new le(w(pt(Math.abs(this.value))),!1)},u.prototype.square=function(f){return new u(this.value*this.value)};function y(f,p){var _=f.length,t=p.length,i=n,c=ue(p.length),g=p[t-1],h=Math.ceil(i/(2*g)),v=xe(f,h),A=xe(p,h),H,P,X,ne,fe,de,Se;for(v.length<=_&&v.push(0),A.push(0),g=A[t-1],P=_-t;P>=0;P--){for(H=i-1,v[P+t]!==g&&(H=Math.floor((v[P+t]*i+v[P+t-1])/g)),X=0,ne=0,de=A.length,fe=0;fe<de;fe++)X+=H*A[fe],Se=Math.floor(X/i),ne+=v[P+fe]-(X-Se*i),X=Se,ne<0?(v[P+fe]=ne+i,ne=-1):(v[P+fe]=ne,ne=0);for(;ne!==0;){for(H-=1,X=0,fe=0;fe<de;fe++)X+=v[P+fe]-i+A[fe],X<0?(v[P+fe]=X+i,X=0):(v[P+fe]=X,X=1);ne+=X}c[P]=H}return v=O(v,h)[0],[lt(c),lt(v)]}function E(f,p){for(var _=f.length,t=p.length,i=[],c=[],g=n,h,v,A,H,P;_;){if(c.unshift(f[--_]),ze(c),b(c,p)<0){i.push(0);continue}v=c.length,A=c[v-1]*g+c[v-2],H=p[t-1]*g+p[t-2],v>t&&(A=(A+1)*g),h=Math.ceil(A/H);do{if(P=xe(p,h),b(P,c)<=0)break;h--}while(h);i.push(h),c=Xe(c,P)}return i.reverse(),[lt(i),lt(c)]}function O(f,p){var _=f.length,t=ue(_),i=n,c,g,h,v;for(h=0,c=_-1;c>=0;--c)v=h*i+f[c],g=ye(v/p),h=v-g*p,t[c]=g|0;return[t,h|0]}function G(f,p){var _,t=C(p);if(we)return[new u(f.value/t.value),new u(f.value%t.value)];var i=f.value,c=t.value,g;if(c===0)throw new Error("Cannot divide by zero");if(f.isSmall)return t.isSmall?[new V(ye(i/c)),new V(i%c)]:[K[0],f];if(t.isSmall){if(c===1)return[f,K[0]];if(c==-1)return[f.negate(),K[0]];var h=Math.abs(c);if(h<n){_=O(i,h),g=lt(_[0]);var v=_[1];return f.sign&&(v=-v),typeof g=="number"?(f.sign!==t.sign&&(g=-g),[new V(g),new V(v)]):[new le(g,f.sign!==t.sign),new V(v)]}c=pt(h)}var A=b(i,c);if(A===-1)return[K[0],f];if(A===0)return[K[f.sign===t.sign?1:-1],K[0]];i.length+c.length<=200?_=y(i,c):_=E(i,c),g=_[0];var H=f.sign!==t.sign,P=_[1],X=f.sign;return typeof g=="number"?(H&&(g=-g),g=new V(g)):g=new le(g,H),typeof P=="number"?(X&&(P=-P),P=new V(P)):P=new le(P,X),[g,P]}le.prototype.divmod=function(f){var p=G(this,f);return{quotient:p[0],remainder:p[1]}},u.prototype.divmod=V.prototype.divmod=le.prototype.divmod,le.prototype.divide=function(f){return G(this,f)[0]},u.prototype.over=u.prototype.divide=function(f){return new u(this.value/C(f).value)},V.prototype.over=V.prototype.divide=le.prototype.over=le.prototype.divide,le.prototype.mod=function(f){return G(this,f)[1]},u.prototype.mod=u.prototype.remainder=function(f){return new u(this.value%C(f).value)},V.prototype.remainder=V.prototype.mod=le.prototype.remainder=le.prototype.mod,le.prototype.pow=function(f){var p=C(f),_=this.value,t=p.value,i,c,g;if(t===0)return K[1];if(_===0)return K[0];if(_===1)return K[1];if(_===-1)return p.isEven()?K[1]:K[-1];if(p.sign)return K[0];if(!p.isSmall)throw new Error("The exponent "+p.toString()+" is too large.");if(this.isSmall&&se(i=Math.pow(_,t)))return new V(ye(i));for(c=this,g=K[1];t&!0&&(g=g.times(c),--t),t!==0;)t/=2,c=c.square();return g},V.prototype.pow=le.prototype.pow,u.prototype.pow=function(f){var p=C(f),_=this.value,t=p.value,i=BigInt(0),c=BigInt(1),g=BigInt(2);if(t===i)return K[1];if(_===i)return K[0];if(_===c)return K[1];if(_===BigInt(-1))return p.isEven()?K[1]:K[-1];if(p.isNegative())return new u(i);for(var h=this,v=K[1];(t&c)===c&&(v=v.times(h),--t),t!==i;)t/=g,h=h.square();return v},le.prototype.modPow=function(f,p){if(f=C(f),p=C(p),p.isZero())throw new Error("Cannot take modPow with modulus 0");var _=K[1],t=this.mod(p);for(f.isNegative()&&(f=f.multiply(K[-1]),t=t.modInv(p));f.isPositive();){if(t.isZero())return K[0];f.isOdd()&&(_=_.multiply(t).mod(p)),f=f.divide(2),t=t.square().mod(p)}return _},u.prototype.modPow=V.prototype.modPow=le.prototype.modPow;function b(f,p){if(f.length!==p.length)return f.length>p.length?1:-1;for(var _=f.length-1;_>=0;_--)if(f[_]!==p[_])return f[_]>p[_]?1:-1;return 0}le.prototype.compareAbs=function(f){var p=C(f),_=this.value,t=p.value;return p.isSmall?1:b(_,t)},V.prototype.compareAbs=function(f){var p=C(f),_=Math.abs(this.value),t=p.value;return p.isSmall?(t=Math.abs(t),_===t?0:_>t?1:-1):-1},u.prototype.compareAbs=function(f){var p=this.value,_=C(f).value;return p=p>=0?p:-p,_=_>=0?_:-_,p===_?0:p>_?1:-1},le.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var p=C(f),_=this.value,t=p.value;return this.sign!==p.sign?p.sign?1:-1:p.isSmall?this.sign?-1:1:b(_,t)*(this.sign?-1:1)},le.prototype.compareTo=le.prototype.compare,V.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var p=C(f),_=this.value,t=p.value;return p.isSmall?_==t?0:_>t?1:-1:_<0!==p.sign?_<0?-1:1:_<0?1:-1},V.prototype.compareTo=V.prototype.compare,u.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var p=this.value,_=C(f).value;return p===_?0:p>_?1:-1},u.prototype.compareTo=u.prototype.compare,le.prototype.equals=function(f){return this.compare(f)===0},u.prototype.eq=u.prototype.equals=V.prototype.eq=V.prototype.equals=le.prototype.eq=le.prototype.equals,le.prototype.notEquals=function(f){return this.compare(f)!==0},u.prototype.neq=u.prototype.notEquals=V.prototype.neq=V.prototype.notEquals=le.prototype.neq=le.prototype.notEquals,le.prototype.greater=function(f){return this.compare(f)>0},u.prototype.gt=u.prototype.greater=V.prototype.gt=V.prototype.greater=le.prototype.gt=le.prototype.greater,le.prototype.lesser=function(f){return this.compare(f)<0},u.prototype.lt=u.prototype.lesser=V.prototype.lt=V.prototype.lesser=le.prototype.lt=le.prototype.lesser,le.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},u.prototype.geq=u.prototype.greaterOrEquals=V.prototype.geq=V.prototype.greaterOrEquals=le.prototype.geq=le.prototype.greaterOrEquals,le.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},u.prototype.leq=u.prototype.lesserOrEquals=V.prototype.leq=V.prototype.lesserOrEquals=le.prototype.leq=le.prototype.lesserOrEquals,le.prototype.isEven=function(){return(this.value[0]&1)===0},V.prototype.isEven=function(){return(this.value&1)===0},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},le.prototype.isOdd=function(){return(this.value[0]&1)===1},V.prototype.isOdd=function(){return(this.value&1)===1},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},le.prototype.isPositive=function(){return!this.sign},V.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=V.prototype.isPositive,le.prototype.isNegative=function(){return this.sign},V.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=V.prototype.isNegative,le.prototype.isUnit=function(){return!1},V.prototype.isUnit=function(){return Math.abs(this.value)===1},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},le.prototype.isZero=function(){return!1},V.prototype.isZero=function(){return this.value===0},u.prototype.isZero=function(){return this.value===BigInt(0)},le.prototype.isDivisibleBy=function(f){var p=C(f);return p.isZero()?!1:p.isUnit()?!0:p.compareAbs(2)===0?this.isEven():this.mod(p).isZero()},u.prototype.isDivisibleBy=V.prototype.isDivisibleBy=le.prototype.isDivisibleBy;function L(f){var p=f.abs();if(p.isUnit())return!1;if(p.equals(2)||p.equals(3)||p.equals(5))return!0;if(p.isEven()||p.isDivisibleBy(3)||p.isDivisibleBy(5))return!1;if(p.lesser(49))return!0}function B(f,p){for(var _=f.prev(),t=_,i=0,c,g,h,v;t.isEven();)t=t.divide(2),i++;e:for(h=0;h<p.length;h++)if(!f.lesser(p[h])&&(v=Xt(p[h]).modPow(t,f),!(v.isUnit()||v.equals(_)))){for(c=i-1;c!=0;c--){if(v=v.square().mod(f),v.isUnit())return!1;if(v.equals(_))continue e}return!1}return!0}le.prototype.isPrime=function(f){var p=L(this);if(p!==m)return p;var _=this.abs(),t=_.bitLength();if(t<=64)return B(_,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*t.toJSNumber(),c=Math.ceil(f===!0?2*Math.pow(i,2):i),g=[],h=0;h<c;h++)g.push(Xt(h+2));return B(_,g)},u.prototype.isPrime=V.prototype.isPrime=le.prototype.isPrime,le.prototype.isProbablePrime=function(f,p){var _=L(this);if(_!==m)return _;for(var t=this.abs(),i=f===m?5:f,c=[],g=0;g<i;g++)c.push(Xt.randBetween(2,t.minus(2),p));return B(t,c)},u.prototype.isProbablePrime=V.prototype.isProbablePrime=le.prototype.isProbablePrime,le.prototype.modInv=function(f){for(var p=Xt.zero,_=Xt.one,t=C(f),i=this.abs(),c,g,h;!i.isZero();)c=t.divide(i),g=p,h=t,p=_,t=i,_=g.subtract(c.multiply(_)),i=h.subtract(c.multiply(i));if(!t.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return p.compare(0)===-1&&(p=p.add(f)),this.isNegative()?p.negate():p},u.prototype.modInv=V.prototype.modInv=le.prototype.modInv,le.prototype.next=function(){var f=this.value;return this.sign?_e(f,1,this.sign):new le(Le(f,1),this.sign)},V.prototype.next=function(){var f=this.value;return f+1<$?new V(f+1):new le(z,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},le.prototype.prev=function(){var f=this.value;return this.sign?new le(Le(f,1),!0):_e(f,1,this.sign)},V.prototype.prev=function(){var f=this.value;return f-1>-$?new V(f-1):new le(z,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var J=[1];2*J[J.length-1]<=n;)J.push(2*J[J.length-1]);var ce=J.length,pe=J[ce-1];function Oe(f){return Math.abs(f)<=n}le.prototype.shiftLeft=function(f){var p=C(f).toJSNumber();if(!Oe(p))throw new Error(String(p)+" is too large for shifting.");if(p<0)return this.shiftRight(-p);var _=this;if(_.isZero())return _;for(;p>=ce;)_=_.multiply(pe),p-=ce-1;return _.multiply(J[p])},u.prototype.shiftLeft=V.prototype.shiftLeft=le.prototype.shiftLeft,le.prototype.shiftRight=function(f){var p,_=C(f).toJSNumber();if(!Oe(_))throw new Error(String(_)+" is too large for shifting.");if(_<0)return this.shiftLeft(-_);for(var t=this;_>=ce;){if(t.isZero()||t.isNegative()&&t.isUnit())return t;p=G(t,pe),t=p[1].isNegative()?p[0].prev():p[0],_-=ce-1}return p=G(t,J[_]),p[1].isNegative()?p[0].prev():p[0]},u.prototype.shiftRight=V.prototype.shiftRight=le.prototype.shiftRight;function ae(f,p,_){p=C(p);for(var t=f.isNegative(),i=p.isNegative(),c=t?f.not():f,g=i?p.not():p,h=0,v=0,A=null,H=null,P=[];!c.isZero()||!g.isZero();)A=G(c,pe),h=A[1].toJSNumber(),t&&(h=pe-1-h),H=G(g,pe),v=H[1].toJSNumber(),i&&(v=pe-1-v),c=A[0],g=H[0],P.push(_(h,v));for(var X=_(t?1:0,i?1:0)!==0?Xt(-1):Xt(0),ne=P.length-1;ne>=0;ne-=1)X=X.multiply(pe).add(Xt(P[ne]));return X}le.prototype.not=function(){return this.negate().prev()},u.prototype.not=V.prototype.not=le.prototype.not,le.prototype.and=function(f){return ae(this,f,function(p,_){return p&_})},u.prototype.and=V.prototype.and=le.prototype.and,le.prototype.or=function(f){return ae(this,f,function(p,_){return p|_})},u.prototype.or=V.prototype.or=le.prototype.or,le.prototype.xor=function(f){return ae(this,f,function(p,_){return p^_})},u.prototype.xor=V.prototype.xor=le.prototype.xor;var Re=1<<30,We=(n&-n)*(n&-n)|Re;function Ie(f){var p=f.value,_=typeof p=="number"?p|Re:typeof p=="bigint"?p|BigInt(Re):p[0]+p[1]*n|We;return _&-_}function Ve(f,p){if(p.compareTo(f)<=0){var _=Ve(f,p.square(p)),t=_.p,i=_.e,c=t.multiply(p);return c.compareTo(f)<=0?{p:c,e:i*2+1}:{p:t,e:i*2}}return{p:Xt(1),e:0}}le.prototype.bitLength=function(){var f=this;return f.compareTo(Xt(0))<0&&(f=f.negate().subtract(Xt(1))),f.compareTo(Xt(0))===0?Xt(0):Xt(Ve(f,Xt(2)).e).add(Xt(1))},u.prototype.bitLength=V.prototype.bitLength=le.prototype.bitLength;function je(f,p){return f=C(f),p=C(p),f.greater(p)?f:p}function st(f,p){return f=C(f),p=C(p),f.lesser(p)?f:p}function Be(f,p){if(f=C(f).abs(),p=C(p).abs(),f.equals(p))return f;if(f.isZero())return p;if(p.isZero())return f;for(var _=K[1],t,i;f.isEven()&&p.isEven();)t=st(Ie(f),Ie(p)),f=f.divide(t),p=p.divide(t),_=_.multiply(t);for(;f.isEven();)f=f.divide(Ie(f));do{for(;p.isEven();)p=p.divide(Ie(p));f.greater(p)&&(i=p,p=f,f=i),p=p.subtract(f)}while(!p.isZero());return _.isUnit()?f:f.multiply(_)}function et(f,p){return f=C(f).abs(),p=C(p).abs(),f.divide(Be(f,p)).multiply(p)}function at(f,p,_){f=C(f),p=C(p);var t=_||Math.random,i=st(f,p),c=je(f,p),g=c.subtract(i).add(1);if(g.isSmall)return i.add(Math.floor(t()*g));for(var h=Z(g,n).value,v=[],A=!0,H=0;H<h.length;H++){var P=A?h[H]+(H+1<h.length?h[H+1]/n:0):n,X=ye(t()*P);v.push(X),X<h[H]&&(A=!1)}return i.add(K.fromArray(v,n,!1))}var Te=function(f,p,_,t){_=_||me,f=String(f),t||(f=f.toLowerCase(),_=_.toLowerCase());var i=f.length,c,g=Math.abs(p),h={};for(c=0;c<_.length;c++)h[_[c]]=c;for(c=0;c<i;c++){var v=f[c];if(v!=="-"&&v in h&&h[v]>=g){if(v==="1"&&g===1)continue;throw new Error(v+" is not a valid digit in base "+p+".")}}p=C(p);var A=[],H=f[0]==="-";for(c=H?1:0;c<f.length;c++){var v=f[c];if(v in h)A.push(C(h[v]));else if(v==="<"){var P=c;do c++;while(f[c]!==">"&&c<f.length);A.push(C(f.slice(P+1,c)))}else throw new Error(v+" is not a valid character")}return F(A,p,H)};function F(f,p,_){var t=K[0],i=K[1],c;for(c=f.length-1;c>=0;c--)t=t.add(f[c].times(i)),i=i.times(p);return _?t.negate():t}function j(f,p){return p=p||me,f<p.length?p[f]:"<"+f+">"}function Z(f,p){if(p=Xt(p),p.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(p.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var _=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return _.unshift([1]),{value:[].concat.apply([],_),isNegative:!1}}var t=!1;if(f.isNegative()&&p.isPositive()&&(t=!0,f=f.abs()),p.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:t};for(var i=[],c=f,g;c.isNegative()||c.compareAbs(p)>=0;){g=c.divmod(p),c=g.quotient;var h=g.remainder;h.isNegative()&&(h=p.minus(h).abs(),c=c.next()),i.push(h.toJSNumber())}return i.push(c.toJSNumber()),{value:i.reverse(),isNegative:t}}function x(f,p,_){var t=Z(f,p);return(t.isNegative?"-":"")+t.value.map(function(i){return j(i,_)}).join("")}le.prototype.toArray=function(f){return Z(this,f)},V.prototype.toArray=function(f){return Z(this,f)},u.prototype.toArray=function(f){return Z(this,f)},le.prototype.toString=function(f,p){if(f===m&&(f=10),f!==10||p)return x(this,f,p);for(var _=this.value,t=_.length,i=String(_[--t]),c="0000000",g;--t>=0;)g=String(_[t]),i+=c.slice(g.length)+g;var h=this.sign?"-":"";return h+i},V.prototype.toString=function(f,p){return f===m&&(f=10),f!=10||p?x(this,f,p):String(this.value)},u.prototype.toString=V.prototype.toString,u.prototype.toJSON=le.prototype.toJSON=V.prototype.toJSON=function(){return this.toString()},le.prototype.valueOf=function(){return parseInt(this.toString(),10)},le.prototype.toJSNumber=le.prototype.valueOf,V.prototype.valueOf=function(){return this.value},V.prototype.toJSNumber=V.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function W(f){if(se(+f)){var p=+f;if(p===ye(p))return we?new u(BigInt(p)):new V(p);throw new Error("Invalid integer: "+f)}var _=f[0]==="-";_&&(f=f.slice(1));var t=f.split(/e/i);if(t.length>2)throw new Error("Invalid integer: "+t.join("e"));if(t.length===2){var i=t[1];if(i[0]==="+"&&(i=i.slice(1)),i=+i,i!==ye(i)||!se(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var c=t[0],g=c.indexOf(".");if(g>=0&&(i-=c.length-g-1,c=c.slice(0,g)+c.slice(g+1)),i<0)throw new Error("Cannot include negative exponent part for integers");c+=new Array(i+1).join("0"),f=c}var h=/^([0-9][0-9]*)$/.test(f);if(!h)throw new Error("Invalid integer: "+f);if(we)return new u(BigInt(_?"-"+f:f));for(var v=[],A=f.length,H=e,P=A-H;A>0;)v.push(+f.slice(P,A)),P-=H,P<0&&(P=0),A-=H;return ze(v),new le(v,_)}function U(f){if(we)return new u(BigInt(f));if(se(f)){if(f!==ye(f))throw new Error(f+" is not an integer.");return new V(f)}return W(f.toString())}function C(f){return typeof f=="number"?U(f):typeof f=="string"?W(f):typeof f=="bigint"?new u(f):f}for(var N=0;N<1e3;N++)K[N]=C(N),N>0&&(K[-N]=C(-N));return K.one=K[1],K.zero=K[0],K.minusOne=K[-1],K.max=je,K.min=st,K.gcd=Be,K.lcm=et,K.isInstance=function(f){return f instanceof le||f instanceof V||f instanceof u},K.randBetween=at,K.fromArray=function(f,p,_){return F(f.map(C),C(p||10),_)},K})();typeof K0<"u"&&K0.hasOwnProperty("exports")&&(K0.exports=Xt);typeof define=="function"&&define.amd&&define(function(){return Xt})});var U1=g0((L1,e1)=>{(function(m){"use strict";var n=9e15,e=1e9,$="0123456789abcdef",z="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",me="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",we={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-n,maxE:n,crypto:!1},K,le,V,u,se=!0,pt="[DecimalError] ",lt=pt+"Invalid argument: ",ze=pt+"Precision limit exceeded",ue=pt+"crypto unavailable",ye="[object Decimal]",Ae=Math.floor,ee=Math.pow,Le=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Xe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Fe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,_e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,He=1e7,xe=7,Y=9007199254740991,l=z.length-1,S=me.length-1,o={toStringTag:ye};o.absoluteValue=o.abs=function(){var d=new this.constructor(this);return d.s<0&&(d.s=1),L(d)},o.ceil=function(){return L(new this.constructor(this),this.e+1,2)},o.clampedTo=o.clamp=function(d,M){var I,q=this,R=q.constructor;if(d=new R(d),M=new R(M),!d.s||!M.s)return new R(NaN);if(d.gt(M))throw Error(lt+M);return I=q.cmp(d),I<0?d:q.cmp(M)>0?M:new R(q)},o.comparedTo=o.cmp=function(d){var M,I,q,R,T=this,Q=T.d,re=(d=new T.constructor(d)).d,ge=T.s,oe=d.s;if(!Q||!re)return!ge||!oe?NaN:ge!==oe?ge:Q===re?0:!Q^ge<0?1:-1;if(!Q[0]||!re[0])return Q[0]?ge:re[0]?-oe:0;if(ge!==oe)return ge;if(T.e!==d.e)return T.e>d.e^ge<0?1:-1;for(q=Q.length,R=re.length,M=0,I=q<R?q:R;M<I;++M)if(Q[M]!==re[M])return Q[M]>re[M]^ge<0?1:-1;return q===R?0:q>R^ge<0?1:-1},o.cosine=o.cos=function(){var d,M,I=this,q=I.constructor;return I.d?I.d[0]?(d=q.precision,M=q.rounding,q.precision=d+Math.max(I.e,I.sd())+xe,q.rounding=1,I=G(q,j(q,I)),q.precision=d,q.rounding=M,L(u==2||u==3?I.neg():I,d,M,!0)):new q(1):new q(NaN)},o.cubeRoot=o.cbrt=function(){var d,M,I,q,R,T,Q,re,ge,oe,Me=this,Ce=Me.constructor;if(!Me.isFinite()||Me.isZero())return new Ce(Me);for(se=!1,T=Me.s*ee(Me.s*Me,1/3),!T||Math.abs(T)==1/0?(I=w(Me.d),d=Me.e,(T=(d-I.length+1)%3)&&(I+=T==1||T==-2?"0":"00"),T=ee(I,1/3),d=Ae((d+1)/3)-(d%3==(d<0?-1:2)),T==1/0?I="5e"+d:(I=T.toExponential(),I=I.slice(0,I.indexOf("e")+1)+d),q=new Ce(I),q.s=Me.s):q=new Ce(T.toString()),Q=(d=Ce.precision)+3;;)if(re=q,ge=re.times(re).times(re),oe=ge.plus(Me),q=b(oe.plus(Me).times(re),oe.plus(ge),Q+2,1),w(re.d).slice(0,Q)===(I=w(q.d)).slice(0,Q))if(I=I.slice(Q-3,Q+1),I=="9999"||!R&&I=="4999"){if(!R&&(L(re,d+1,0),re.times(re).times(re).eq(Me))){q=re;break}Q+=4,R=1}else{(!+I||!+I.slice(1)&&I.charAt(0)=="5")&&(L(q,d+1,1),M=!q.times(q).times(q).eq(Me));break}return se=!0,L(q,d,Ce.rounding,M)},o.decimalPlaces=o.dp=function(){var d,M=this.d,I=NaN;if(M){if(d=M.length-1,I=(d-Ae(this.e/xe))*xe,d=M[d],d)for(;d%10==0;d/=10)I--;I<0&&(I=0)}return I},o.dividedBy=o.div=function(d){return b(this,new this.constructor(d))},o.dividedToIntegerBy=o.divToInt=function(d){var M=this,I=M.constructor;return L(b(M,new I(d),0,1,1),I.precision,I.rounding)},o.equals=o.eq=function(d){return this.cmp(d)===0},o.floor=function(){return L(new this.constructor(this),this.e+1,3)},o.greaterThan=o.gt=function(d){return this.cmp(d)>0},o.greaterThanOrEqualTo=o.gte=function(d){var M=this.cmp(d);return M==1||M===0},o.hyperbolicCosine=o.cosh=function(){var d,M,I,q,R,T=this,Q=T.constructor,re=new Q(1);if(!T.isFinite())return new Q(T.s?1/0:NaN);if(T.isZero())return re;I=Q.precision,q=Q.rounding,Q.precision=I+Math.max(T.e,T.sd())+4,Q.rounding=1,R=T.d.length,R<32?(d=Math.ceil(R/3),M=(1/F(4,d)).toString()):(d=16,M="2.3283064365386962890625e-10"),T=Te(Q,1,T.times(M),new Q(1),!0);for(var ge,oe=d,Me=new Q(8);oe--;)ge=T.times(T),T=re.minus(ge.times(Me.minus(ge.times(Me))));return L(T,Q.precision=I,Q.rounding=q,!0)},o.hyperbolicSine=o.sinh=function(){var d,M,I,q,R=this,T=R.constructor;if(!R.isFinite()||R.isZero())return new T(R);if(M=T.precision,I=T.rounding,T.precision=M+Math.max(R.e,R.sd())+4,T.rounding=1,q=R.d.length,q<3)R=Te(T,2,R,R,!0);else{d=1.4*Math.sqrt(q),d=d>16?16:d|0,R=R.times(1/F(5,d)),R=Te(T,2,R,R,!0);for(var Q,re=new T(5),ge=new T(16),oe=new T(20);d--;)Q=R.times(R),R=R.times(re.plus(Q.times(ge.times(Q).plus(oe))))}return T.precision=M,T.rounding=I,L(R,M,I,!0)},o.hyperbolicTangent=o.tanh=function(){var d,M,I=this,q=I.constructor;return I.isFinite()?I.isZero()?new q(I):(d=q.precision,M=q.rounding,q.precision=d+7,q.rounding=1,b(I.sinh(),I.cosh(),q.precision=d,q.rounding=M)):new q(I.s)},o.inverseCosine=o.acos=function(){var d=this,M=d.constructor,I=d.abs().cmp(1),q=M.precision,R=M.rounding;return I!==-1?I===0?d.isNeg()?pe(M,q,R):new M(0):new M(NaN):d.isZero()?pe(M,q+4,R).times(.5):(M.precision=q+6,M.rounding=1,d=new M(1).minus(d).div(d.plus(1)).sqrt().atan(),M.precision=q,M.rounding=R,d.times(2))},o.inverseHyperbolicCosine=o.acosh=function(){var d,M,I=this,q=I.constructor;return I.lte(1)?new q(I.eq(1)?0:NaN):I.isFinite()?(d=q.precision,M=q.rounding,q.precision=d+Math.max(Math.abs(I.e),I.sd())+4,q.rounding=1,se=!1,I=I.times(I).minus(1).sqrt().plus(I),se=!0,q.precision=d,q.rounding=M,I.ln()):new q(I)},o.inverseHyperbolicSine=o.asinh=function(){var d,M,I=this,q=I.constructor;return!I.isFinite()||I.isZero()?new q(I):(d=q.precision,M=q.rounding,q.precision=d+2*Math.max(Math.abs(I.e),I.sd())+6,q.rounding=1,se=!1,I=I.times(I).plus(1).sqrt().plus(I),se=!0,q.precision=d,q.rounding=M,I.ln())},o.inverseHyperbolicTangent=o.atanh=function(){var d,M,I,q,R=this,T=R.constructor;return R.isFinite()?R.e>=0?new T(R.abs().eq(1)?R.s/0:R.isZero()?R:NaN):(d=T.precision,M=T.rounding,q=R.sd(),Math.max(q,d)<2*-R.e-1?L(new T(R),d,M,!0):(T.precision=I=q-R.e,R=b(R.plus(1),new T(1).minus(R),I+d,1),T.precision=d+4,T.rounding=1,R=R.ln(),T.precision=d,T.rounding=M,R.times(.5))):new T(NaN)},o.inverseSine=o.asin=function(){var d,M,I,q,R=this,T=R.constructor;return R.isZero()?new T(R):(M=R.abs().cmp(1),I=T.precision,q=T.rounding,M!==-1?M===0?(d=pe(T,I+4,q).times(.5),d.s=R.s,d):new T(NaN):(T.precision=I+6,T.rounding=1,R=R.div(new T(1).minus(R.times(R)).sqrt().plus(1)).atan(),T.precision=I,T.rounding=q,R.times(2)))},o.inverseTangent=o.atan=function(){var d,M,I,q,R,T,Q,re,ge,oe=this,Me=oe.constructor,Ce=Me.precision,$e=Me.rounding;if(oe.isFinite()){if(oe.isZero())return new Me(oe);if(oe.abs().eq(1)&&Ce+4<=S)return Q=pe(Me,Ce+4,$e).times(.25),Q.s=oe.s,Q}else{if(!oe.s)return new Me(NaN);if(Ce+4<=S)return Q=pe(Me,Ce+4,$e).times(.5),Q.s=oe.s,Q}for(Me.precision=re=Ce+10,Me.rounding=1,I=Math.min(28,re/xe+2|0),d=I;d;--d)oe=oe.div(oe.times(oe).plus(1).sqrt().plus(1));for(se=!1,M=Math.ceil(re/xe),q=1,ge=oe.times(oe),Q=new Me(oe),R=oe;d!==-1;)if(R=R.times(ge),T=Q.minus(R.div(q+=2)),R=R.times(ge),Q=T.plus(R.div(q+=2)),Q.d[M]!==void 0)for(d=M;Q.d[d]===T.d[d]&&d--;);return I&&(Q=Q.times(2<<I-1)),se=!0,L(Q,Me.precision=Ce,Me.rounding=$e,!0)},o.isFinite=function(){return!!this.d},o.isInteger=o.isInt=function(){return!!this.d&&Ae(this.e/xe)>this.d.length-2},o.isNaN=function(){return!this.s},o.isNegative=o.isNeg=function(){return this.s<0},o.isPositive=o.isPos=function(){return this.s>0},o.isZero=function(){return!!this.d&&this.d[0]===0},o.lessThan=o.lt=function(d){return this.cmp(d)<0},o.lessThanOrEqualTo=o.lte=function(d){return this.cmp(d)<1},o.logarithm=o.log=function(d){var M,I,q,R,T,Q,re,ge,oe=this,Me=oe.constructor,Ce=Me.precision,$e=Me.rounding,Ke=5;if(d==null)d=new Me(10),M=!0;else{if(d=new Me(d),I=d.d,d.s<0||!I||!I[0]||d.eq(1))return new Me(NaN);M=d.eq(10)}if(I=oe.d,oe.s<0||!I||!I[0]||oe.eq(1))return new Me(I&&!I[0]?-1/0:oe.s!=1?NaN:I?0:1/0);if(M)if(I.length>1)T=!0;else{for(R=I[0];R%10===0;)R/=10;T=R!==1}if(se=!1,re=Ce+Ke,Q=je(oe,re),q=M?ce(Me,re+10):je(d,re),ge=b(Q,q,re,1),E(ge.d,R=Ce,$e))do if(re+=10,Q=je(oe,re),q=M?ce(Me,re+10):je(d,re),ge=b(Q,q,re,1),!T){+w(ge.d).slice(R+1,R+15)+1==1e14&&(ge=L(ge,Ce+1,0));break}while(E(ge.d,R+=10,$e));return se=!0,L(ge,Ce,$e)},o.minus=o.sub=function(d){var M,I,q,R,T,Q,re,ge,oe,Me,Ce,$e,Ke=this,Nt=Ke.constructor;if(d=new Nt(d),!Ke.d||!d.d)return!Ke.s||!d.s?d=new Nt(NaN):Ke.d?d.s=-d.s:d=new Nt(d.d||Ke.s!==d.s?Ke:NaN),d;if(Ke.s!=d.s)return d.s=-d.s,Ke.plus(d);if(oe=Ke.d,$e=d.d,re=Nt.precision,ge=Nt.rounding,!oe[0]||!$e[0]){if($e[0])d.s=-d.s;else if(oe[0])d=new Nt(Ke);else return new Nt(ge===3?-0:0);return se?L(d,re,ge):d}if(I=Ae(d.e/xe),Me=Ae(Ke.e/xe),oe=oe.slice(),T=Me-I,T){for(Ce=T<0,Ce?(M=oe,T=-T,Q=$e.length):(M=$e,I=Me,Q=oe.length),q=Math.max(Math.ceil(re/xe),Q)+2,T>q&&(T=q,M.length=1),M.reverse(),q=T;q--;)M.push(0);M.reverse()}else{for(q=oe.length,Q=$e.length,Ce=q<Q,Ce&&(Q=q),q=0;q<Q;q++)if(oe[q]!=$e[q]){Ce=oe[q]<$e[q];break}T=0}for(Ce&&(M=oe,oe=$e,$e=M,d.s=-d.s),Q=oe.length,q=$e.length-Q;q>0;--q)oe[Q++]=0;for(q=$e.length;q>T;){if(oe[--q]<$e[q]){for(R=q;R&&oe[--R]===0;)oe[R]=He-1;--oe[R],oe[q]+=He}oe[q]-=$e[q]}for(;oe[--Q]===0;)oe.pop();for(;oe[0]===0;oe.shift())--I;return oe[0]?(d.d=oe,d.e=J(oe,I),se?L(d,re,ge):d):new Nt(ge===3?-0:0)},o.modulo=o.mod=function(d){var M,I=this,q=I.constructor;return d=new q(d),!I.d||!d.s||d.d&&!d.d[0]?new q(NaN):!d.d||I.d&&!I.d[0]?L(new q(I),q.precision,q.rounding):(se=!1,q.modulo==9?(M=b(I,d.abs(),0,3,1),M.s*=d.s):M=b(I,d,0,q.modulo,1),M=M.times(d),se=!0,I.minus(M))},o.naturalExponential=o.exp=function(){return Ve(this)},o.naturalLogarithm=o.ln=function(){return je(this)},o.negated=o.neg=function(){var d=new this.constructor(this);return d.s=-d.s,L(d)},o.plus=o.add=function(d){var M,I,q,R,T,Q,re,ge,oe,Me,Ce=this,$e=Ce.constructor;if(d=new $e(d),!Ce.d||!d.d)return!Ce.s||!d.s?d=new $e(NaN):Ce.d||(d=new $e(d.d||Ce.s===d.s?Ce:NaN)),d;if(Ce.s!=d.s)return d.s=-d.s,Ce.minus(d);if(oe=Ce.d,Me=d.d,re=$e.precision,ge=$e.rounding,!oe[0]||!Me[0])return Me[0]||(d=new $e(Ce)),se?L(d,re,ge):d;if(T=Ae(Ce.e/xe),q=Ae(d.e/xe),oe=oe.slice(),R=T-q,R){for(R<0?(I=oe,R=-R,Q=Me.length):(I=Me,q=T,Q=oe.length),T=Math.ceil(re/xe),Q=T>Q?T+1:Q+1,R>Q&&(R=Q,I.length=1),I.reverse();R--;)I.push(0);I.reverse()}for(Q=oe.length,R=Me.length,Q-R<0&&(R=Q,I=Me,Me=oe,oe=I),M=0;R;)M=(oe[--R]=oe[R]+Me[R]+M)/He|0,oe[R]%=He;for(M&&(oe.unshift(M),++q),Q=oe.length;oe[--Q]==0;)oe.pop();return d.d=oe,d.e=J(oe,q),se?L(d,re,ge):d},o.precision=o.sd=function(d){var M,I=this;if(d!==void 0&&d!==!!d&&d!==1&&d!==0)throw Error(lt+d);return I.d?(M=Oe(I.d),d&&I.e+1>M&&(M=I.e+1)):M=NaN,M},o.round=function(){var d=this,M=d.constructor;return L(new M(d),d.e+1,M.rounding)},o.sine=o.sin=function(){var d,M,I=this,q=I.constructor;return I.isFinite()?I.isZero()?new q(I):(d=q.precision,M=q.rounding,q.precision=d+Math.max(I.e,I.sd())+xe,q.rounding=1,I=at(q,j(q,I)),q.precision=d,q.rounding=M,L(u>2?I.neg():I,d,M,!0)):new q(NaN)},o.squareRoot=o.sqrt=function(){var d,M,I,q,R,T,Q=this,re=Q.d,ge=Q.e,oe=Q.s,Me=Q.constructor;if(oe!==1||!re||!re[0])return new Me(!oe||oe<0&&(!re||re[0])?NaN:re?Q:1/0);for(se=!1,oe=Math.sqrt(+Q),oe==0||oe==1/0?(M=w(re),(M.length+ge)%2==0&&(M+="0"),oe=Math.sqrt(M),ge=Ae((ge+1)/2)-(ge<0||ge%2),oe==1/0?M="5e"+ge:(M=oe.toExponential(),M=M.slice(0,M.indexOf("e")+1)+ge),q=new Me(M)):q=new Me(oe.toString()),I=(ge=Me.precision)+3;;)if(T=q,q=T.plus(b(Q,T,I+2,1)).times(.5),w(T.d).slice(0,I)===(M=w(q.d)).slice(0,I))if(M=M.slice(I-3,I+1),M=="9999"||!R&&M=="4999"){if(!R&&(L(T,ge+1,0),T.times(T).eq(Q))){q=T;break}I+=4,R=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(L(q,ge+1,1),d=!q.times(q).eq(Q));break}return se=!0,L(q,ge,Me.rounding,d)},o.tangent=o.tan=function(){var d,M,I=this,q=I.constructor;return I.isFinite()?I.isZero()?new q(I):(d=q.precision,M=q.rounding,q.precision=d+10,q.rounding=1,I=I.sin(),I.s=1,I=b(I,new q(1).minus(I.times(I)).sqrt(),d+10,0),q.precision=d,q.rounding=M,L(u==2||u==4?I.neg():I,d,M,!0)):new q(NaN)},o.times=o.mul=function(d){var M,I,q,R,T,Q,re,ge,oe,Me=this,Ce=Me.constructor,$e=Me.d,Ke=(d=new Ce(d)).d;if(d.s*=Me.s,!$e||!$e[0]||!Ke||!Ke[0])return new Ce(!d.s||$e&&!$e[0]&&!Ke||Ke&&!Ke[0]&&!$e?NaN:!$e||!Ke?d.s/0:d.s*0);for(I=Ae(Me.e/xe)+Ae(d.e/xe),ge=$e.length,oe=Ke.length,ge<oe&&(T=$e,$e=Ke,Ke=T,Q=ge,ge=oe,oe=Q),T=[],Q=ge+oe,q=Q;q--;)T.push(0);for(q=oe;--q>=0;){for(M=0,R=ge+q;R>q;)re=T[R]+Ke[q]*$e[R-q-1]+M,T[R--]=re%He|0,M=re/He|0;T[R]=(T[R]+M)%He|0}for(;!T[--Q];)T.pop();return M?++I:T.shift(),d.d=T,d.e=J(T,I),se?L(d,Ce.precision,Ce.rounding):d},o.toBinary=function(d,M){return Z(this,2,d,M)},o.toDecimalPlaces=o.toDP=function(d,M){var I=this,q=I.constructor;return I=new q(I),d===void 0?I:(y(d,0,e),M===void 0?M=q.rounding:y(M,0,8),L(I,d+I.e+1,M))},o.toExponential=function(d,M){var I,q=this,R=q.constructor;return d===void 0?I=B(q,!0):(y(d,0,e),M===void 0?M=R.rounding:y(M,0,8),q=L(new R(q),d+1,M),I=B(q,!0,d+1)),q.isNeg()&&!q.isZero()?"-"+I:I},o.toFixed=function(d,M){var I,q,R=this,T=R.constructor;return d===void 0?I=B(R):(y(d,0,e),M===void 0?M=T.rounding:y(M,0,8),q=L(new T(R),d+R.e+1,M),I=B(q,!1,d+q.e+1)),R.isNeg()&&!R.isZero()?"-"+I:I},o.toFraction=function(d){var M,I,q,R,T,Q,re,ge,oe,Me,Ce,$e,Ke=this,Nt=Ke.d,ct=Ke.constructor;if(!Nt)return new ct(Ke);if(oe=I=new ct(1),q=ge=new ct(0),M=new ct(q),T=M.e=Oe(Nt)-Ke.e-1,Q=T%xe,M.d[0]=ee(10,Q<0?xe+Q:Q),d==null)d=T>0?M:oe;else{if(re=new ct(d),!re.isInt()||re.lt(oe))throw Error(lt+re);d=re.gt(M)?T>0?M:oe:re}for(se=!1,re=new ct(w(Nt)),Me=ct.precision,ct.precision=T=Nt.length*xe*2;Ce=b(re,M,0,1,1),R=I.plus(Ce.times(q)),R.cmp(d)!=1;)I=q,q=R,R=oe,oe=ge.plus(Ce.times(R)),ge=R,R=M,M=re.minus(Ce.times(R)),re=R;return R=b(d.minus(I),q,0,1,1),ge=ge.plus(R.times(oe)),I=I.plus(R.times(q)),ge.s=oe.s=Ke.s,$e=b(oe,q,T,1).minus(Ke).abs().cmp(b(ge,I,T,1).minus(Ke).abs())<1?[oe,q]:[ge,I],ct.precision=Me,se=!0,$e},o.toHexadecimal=o.toHex=function(d,M){return Z(this,16,d,M)},o.toNearest=function(d,M){var I=this,q=I.constructor;if(I=new q(I),d==null){if(!I.d)return I;d=new q(1),M=q.rounding}else{if(d=new q(d),M===void 0?M=q.rounding:y(M,0,8),!I.d)return d.s?I:d;if(!d.d)return d.s&&(d.s=I.s),d}return d.d[0]?(se=!1,I=b(I,d,0,M,1).times(d),se=!0,L(I)):(d.s=I.s,I=d),I},o.toNumber=function(){return+this},o.toOctal=function(d,M){return Z(this,8,d,M)},o.toPower=o.pow=function(d){var M,I,q,R,T,Q,re=this,ge=re.constructor,oe=+(d=new ge(d));if(!re.d||!d.d||!re.d[0]||!d.d[0])return new ge(ee(+re,oe));if(re=new ge(re),re.eq(1))return re;if(q=ge.precision,T=ge.rounding,d.eq(1))return L(re,q,T);if(M=Ae(d.e/xe),M>=d.d.length-1&&(I=oe<0?-oe:oe)<=Y)return R=Re(ge,re,I,q),d.s<0?new ge(1).div(R):L(R,q,T);if(Q=re.s,Q<0){if(M<d.d.length-1)return new ge(NaN);if((d.d[M]&1)==0&&(Q=1),re.e==0&&re.d[0]==1&&re.d.length==1)return re.s=Q,re}return I=ee(+re,oe),M=I==0||!isFinite(I)?Ae(oe*(Math.log("0."+w(re.d))/Math.LN10+re.e+1)):new ge(I+"").e,M>ge.maxE+1||M<ge.minE-1?new ge(M>0?Q/0:0):(se=!1,ge.rounding=re.s=1,I=Math.min(12,(M+"").length),R=Ve(d.times(je(re,q+I)),q),R.d&&(R=L(R,q+5,1),E(R.d,q,T)&&(M=q+10,R=L(Ve(d.times(je(re,M+I)),M),M+5,1),+w(R.d).slice(q+1,q+15)+1==1e14&&(R=L(R,q+1,0)))),R.s=Q,se=!0,ge.rounding=T,L(R,q,T))},o.toPrecision=function(d,M){var I,q=this,R=q.constructor;return d===void 0?I=B(q,q.e<=R.toExpNeg||q.e>=R.toExpPos):(y(d,1,e),M===void 0?M=R.rounding:y(M,0,8),q=L(new R(q),d,M),I=B(q,d<=q.e||q.e<=R.toExpNeg,d)),q.isNeg()&&!q.isZero()?"-"+I:I},o.toSignificantDigits=o.toSD=function(d,M){var I=this,q=I.constructor;return d===void 0?(d=q.precision,M=q.rounding):(y(d,1,e),M===void 0?M=q.rounding:y(M,0,8)),L(new q(I),d,M)},o.toString=function(){var d=this,M=d.constructor,I=B(d,d.e<=M.toExpNeg||d.e>=M.toExpPos);return d.isNeg()&&!d.isZero()?"-"+I:I},o.truncated=o.trunc=function(){return L(new this.constructor(this),this.e+1,1)},o.valueOf=o.toJSON=function(){var d=this,M=d.constructor,I=B(d,d.e<=M.toExpNeg||d.e>=M.toExpPos);return d.isNeg()?"-"+I:I};function w(d){var M,I,q,R=d.length-1,T="",Q=d[0];if(R>0){for(T+=Q,M=1;M<R;M++)q=d[M]+"",I=xe-q.length,I&&(T+=ae(I)),T+=q;Q=d[M],q=Q+"",I=xe-q.length,I&&(T+=ae(I))}else if(Q===0)return"0";for(;Q%10===0;)Q/=10;return T+Q}function y(d,M,I){if(d!==~~d||d<M||d>I)throw Error(lt+d)}function E(d,M,I,q){var R,T,Q,re;for(T=d[0];T>=10;T/=10)--M;return--M<0?(M+=xe,R=0):(R=Math.ceil((M+1)/xe),M%=xe),T=ee(10,xe-M),re=d[R]%T|0,q==null?M<3?(M==0?re=re/100|0:M==1&&(re=re/10|0),Q=I<4&&re==99999||I>3&&re==49999||re==5e4||re==0):Q=(I<4&&re+1==T||I>3&&re+1==T/2)&&(d[R+1]/T/100|0)==ee(10,M-2)-1||(re==T/2||re==0)&&(d[R+1]/T/100|0)==0:M<4?(M==0?re=re/1e3|0:M==1?re=re/100|0:M==2&&(re=re/10|0),Q=(q||I<4)&&re==9999||!q&&I>3&&re==4999):Q=((q||I<4)&&re+1==T||!q&&I>3&&re+1==T/2)&&(d[R+1]/T/1e3|0)==ee(10,M-3)-1,Q}function O(d,M,I){for(var q,R=[0],T,Q=0,re=d.length;Q<re;){for(T=R.length;T--;)R[T]*=M;for(R[0]+=$.indexOf(d.charAt(Q++)),q=0;q<R.length;q++)R[q]>I-1&&(R[q+1]===void 0&&(R[q+1]=0),R[q+1]+=R[q]/I|0,R[q]%=I)}return R.reverse()}function G(d,M){var I,q,R;if(M.isZero())return M;q=M.d.length,q<32?(I=Math.ceil(q/3),R=(1/F(4,I)).toString()):(I=16,R="2.3283064365386962890625e-10"),d.precision+=I,M=Te(d,1,M.times(R),new d(1));for(var T=I;T--;){var Q=M.times(M);M=Q.times(Q).minus(Q).times(8).plus(1)}return d.precision-=I,M}var b=(function(){function d(q,R,T){var Q,re=0,ge=q.length;for(q=q.slice();ge--;)Q=q[ge]*R+re,q[ge]=Q%T|0,re=Q/T|0;return re&&q.unshift(re),q}function M(q,R,T,Q){var re,ge;if(T!=Q)ge=T>Q?1:-1;else for(re=ge=0;re<T;re++)if(q[re]!=R[re]){ge=q[re]>R[re]?1:-1;break}return ge}function I(q,R,T,Q){for(var re=0;T--;)q[T]-=re,re=q[T]<R[T]?1:0,q[T]=re*Q+q[T]-R[T];for(;!q[0]&&q.length>1;)q.shift()}return function(q,R,T,Q,re,ge){var oe,Me,Ce,$e,Ke,Nt,ct,Zt,Ut,s0,dt,zt,O0,u0,P0,C0,M0,b0,o0,T0,R0=q.constructor,F0=q.s==R.s?1:-1,Wt=q.d,xt=R.d;if(!Wt||!Wt[0]||!xt||!xt[0])return new R0(!q.s||!R.s||(Wt?xt&&Wt[0]==xt[0]:!xt)?NaN:Wt&&Wt[0]==0||!xt?F0*0:F0/0);for(ge?(Ke=1,Me=q.e-R.e):(ge=He,Ke=xe,Me=Ae(q.e/Ke)-Ae(R.e/Ke)),o0=xt.length,M0=Wt.length,Ut=new R0(F0),s0=Ut.d=[],Ce=0;xt[Ce]==(Wt[Ce]||0);Ce++);if(xt[Ce]>(Wt[Ce]||0)&&Me--,T==null?(u0=T=R0.precision,Q=R0.rounding):re?u0=T+(q.e-R.e)+1:u0=T,u0<0)s0.push(1),Nt=!0;else{if(u0=u0/Ke+2|0,Ce=0,o0==1){for($e=0,xt=xt[0],u0++;(Ce<M0||$e)&&u0--;Ce++)P0=$e*ge+(Wt[Ce]||0),s0[Ce]=P0/xt|0,$e=P0%xt|0;Nt=$e||Ce<M0}else{for($e=ge/(xt[0]+1)|0,$e>1&&(xt=d(xt,$e,ge),Wt=d(Wt,$e,ge),o0=xt.length,M0=Wt.length),C0=o0,dt=Wt.slice(0,o0),zt=dt.length;zt<o0;)dt[zt++]=0;T0=xt.slice(),T0.unshift(0),b0=xt[0],xt[1]>=ge/2&&++b0;do $e=0,oe=M(xt,dt,o0,zt),oe<0?(O0=dt[0],o0!=zt&&(O0=O0*ge+(dt[1]||0)),$e=O0/b0|0,$e>1?($e>=ge&&($e=ge-1),ct=d(xt,$e,ge),Zt=ct.length,zt=dt.length,oe=M(ct,dt,Zt,zt),oe==1&&($e--,I(ct,o0<Zt?T0:xt,Zt,ge))):($e==0&&(oe=$e=1),ct=xt.slice()),Zt=ct.length,Zt<zt&&ct.unshift(0),I(dt,ct,zt,ge),oe==-1&&(zt=dt.length,oe=M(xt,dt,o0,zt),oe<1&&($e++,I(dt,o0<zt?T0:xt,zt,ge))),zt=dt.length):oe===0&&($e++,dt=[0]),s0[Ce++]=$e,oe&&dt[0]?dt[zt++]=Wt[C0]||0:(dt=[Wt[C0]],zt=1);while((C0++<M0||dt[0]!==void 0)&&u0--);Nt=dt[0]!==void 0}s0[0]||s0.shift()}if(Ke==1)Ut.e=Me,le=Nt;else{for(Ce=1,$e=s0[0];$e>=10;$e/=10)Ce++;Ut.e=Ce+Me*Ke-1,L(Ut,re?T+Ut.e+1:T,Q,Nt)}return Ut}})();function L(d,M,I,q){var R,T,Q,re,ge,oe,Me,Ce,$e,Ke=d.constructor;e:if(M!=null){if(Ce=d.d,!Ce)return d;for(R=1,re=Ce[0];re>=10;re/=10)R++;if(T=M-R,T<0)T+=xe,Q=M,Me=Ce[$e=0],ge=Me/ee(10,R-Q-1)%10|0;else if($e=Math.ceil((T+1)/xe),re=Ce.length,$e>=re)if(q){for(;re++<=$e;)Ce.push(0);Me=ge=0,R=1,T%=xe,Q=T-xe+1}else break e;else{for(Me=re=Ce[$e],R=1;re>=10;re/=10)R++;T%=xe,Q=T-xe+R,ge=Q<0?0:Me/ee(10,R-Q-1)%10|0}if(q=q||M<0||Ce[$e+1]!==void 0||(Q<0?Me:Me%ee(10,R-Q-1)),oe=I<4?(ge||q)&&(I==0||I==(d.s<0?3:2)):ge>5||ge==5&&(I==4||q||I==6&&(T>0?Q>0?Me/ee(10,R-Q):0:Ce[$e-1])%10&1||I==(d.s<0?8:7)),M<1||!Ce[0])return Ce.length=0,oe?(M-=d.e+1,Ce[0]=ee(10,(xe-M%xe)%xe),d.e=-M||0):Ce[0]=d.e=0,d;if(T==0?(Ce.length=$e,re=1,$e--):(Ce.length=$e+1,re=ee(10,xe-T),Ce[$e]=Q>0?(Me/ee(10,R-Q)%ee(10,Q)|0)*re:0),oe)for(;;)if($e==0){for(T=1,Q=Ce[0];Q>=10;Q/=10)T++;for(Q=Ce[0]+=re,re=1;Q>=10;Q/=10)re++;T!=re&&(d.e++,Ce[0]==He&&(Ce[0]=1));break}else{if(Ce[$e]+=re,Ce[$e]!=He)break;Ce[$e--]=0,re=1}for(T=Ce.length;Ce[--T]===0;)Ce.pop()}return se&&(d.e>Ke.maxE?(d.d=null,d.e=NaN):d.e<Ke.minE&&(d.e=0,d.d=[0])),d}function B(d,M,I){if(!d.isFinite())return st(d);var q,R=d.e,T=w(d.d),Q=T.length;return M?(I&&(q=I-Q)>0?T=T.charAt(0)+"."+T.slice(1)+ae(q):Q>1&&(T=T.charAt(0)+"."+T.slice(1)),T=T+(d.e<0?"e":"e+")+d.e):R<0?(T="0."+ae(-R-1)+T,I&&(q=I-Q)>0&&(T+=ae(q))):R>=Q?(T+=ae(R+1-Q),I&&(q=I-R-1)>0&&(T=T+"."+ae(q))):((q=R+1)<Q&&(T=T.slice(0,q)+"."+T.slice(q)),I&&(q=I-Q)>0&&(R+1===Q&&(T+="."),T+=ae(q))),T}function J(d,M){var I=d[0];for(M*=xe;I>=10;I/=10)M++;return M}function ce(d,M,I){if(M>l)throw se=!0,I&&(d.precision=I),Error(ze);return L(new d(z),M,1,!0)}function pe(d,M,I){if(M>S)throw Error(ze);return L(new d(me),M,I,!0)}function Oe(d){var M=d.length-1,I=M*xe+1;if(M=d[M],M){for(;M%10==0;M/=10)I--;for(M=d[0];M>=10;M/=10)I++}return I}function ae(d){for(var M="";d--;)M+="0";return M}function Re(d,M,I,q){var R,T=new d(1),Q=Math.ceil(q/xe+4);for(se=!1;;){if(I%2&&(T=T.times(M),x(T.d,Q)&&(R=!0)),I=Ae(I/2),I===0){I=T.d.length-1,R&&T.d[I]===0&&++T.d[I];break}M=M.times(M),x(M.d,Q)}return se=!0,T}function We(d){return d.d[d.d.length-1]&1}function Ie(d,M,I){for(var q,R,T=new d(M[0]),Q=0;++Q<M.length;){if(R=new d(M[Q]),!R.s){T=R;break}q=T.cmp(R),(q===I||q===0&&T.s===I)&&(T=R)}return T}function Ve(d,M){var I,q,R,T,Q,re,ge,oe=0,Me=0,Ce=0,$e=d.constructor,Ke=$e.rounding,Nt=$e.precision;if(!d.d||!d.d[0]||d.e>17)return new $e(d.d?d.d[0]?d.s<0?0:1/0:1:d.s?d.s<0?0:d:NaN);for(M==null?(se=!1,ge=Nt):ge=M,re=new $e(.03125);d.e>-2;)d=d.times(re),Ce+=5;for(q=Math.log(ee(2,Ce))/Math.LN10*2+5|0,ge+=q,I=T=Q=new $e(1),$e.precision=ge;;){if(T=L(T.times(d),ge,1),I=I.times(++Me),re=Q.plus(b(T,I,ge,1)),w(re.d).slice(0,ge)===w(Q.d).slice(0,ge)){for(R=Ce;R--;)Q=L(Q.times(Q),ge,1);if(M==null)if(oe<3&&E(Q.d,ge-q,Ke,oe))$e.precision=ge+=10,I=T=re=new $e(1),Me=0,oe++;else return L(Q,$e.precision=Nt,Ke,se=!0);else return $e.precision=Nt,Q}Q=re}}function je(d,M){var I,q,R,T,Q,re,ge,oe,Me,Ce,$e,Ke=1,Nt=10,ct=d,Zt=ct.d,Ut=ct.constructor,s0=Ut.rounding,dt=Ut.precision;if(ct.s<0||!Zt||!Zt[0]||!ct.e&&Zt[0]==1&&Zt.length==1)return new Ut(Zt&&!Zt[0]?-1/0:ct.s!=1?NaN:Zt?0:ct);if(M==null?(se=!1,Me=dt):Me=M,Ut.precision=Me+=Nt,I=w(Zt),q=I.charAt(0),Math.abs(T=ct.e)<15e14){for(;q<7&&q!=1||q==1&&I.charAt(1)>3;)ct=ct.times(d),I=w(ct.d),q=I.charAt(0),Ke++;T=ct.e,q>1?(ct=new Ut("0."+I),T++):ct=new Ut(q+"."+I.slice(1))}else return oe=ce(Ut,Me+2,dt).times(T+""),ct=je(new Ut(q+"."+I.slice(1)),Me-Nt).plus(oe),Ut.precision=dt,M==null?L(ct,dt,s0,se=!0):ct;for(Ce=ct,ge=Q=ct=b(ct.minus(1),ct.plus(1),Me,1),$e=L(ct.times(ct),Me,1),R=3;;){if(Q=L(Q.times($e),Me,1),oe=ge.plus(b(Q,new Ut(R),Me,1)),w(oe.d).slice(0,Me)===w(ge.d).slice(0,Me))if(ge=ge.times(2),T!==0&&(ge=ge.plus(ce(Ut,Me+2,dt).times(T+""))),ge=b(ge,new Ut(Ke),Me,1),M==null)if(E(ge.d,Me-Nt,s0,re))Ut.precision=Me+=Nt,oe=Q=ct=b(Ce.minus(1),Ce.plus(1),Me,1),$e=L(ct.times(ct),Me,1),R=re=1;else return L(ge,Ut.precision=dt,s0,se=!0);else return Ut.precision=dt,ge;ge=oe,R+=2}}function st(d){return String(d.s*d.s/0)}function Be(d,M){var I,q,R;for((I=M.indexOf("."))>-1&&(M=M.replace(".","")),(q=M.search(/e/i))>0?(I<0&&(I=q),I+=+M.slice(q+1),M=M.substring(0,q)):I<0&&(I=M.length),q=0;M.charCodeAt(q)===48;q++);for(R=M.length;M.charCodeAt(R-1)===48;--R);if(M=M.slice(q,R),M){if(R-=q,d.e=I=I-q-1,d.d=[],q=(I+1)%xe,I<0&&(q+=xe),q<R){for(q&&d.d.push(+M.slice(0,q)),R-=xe;q<R;)d.d.push(+M.slice(q,q+=xe));M=M.slice(q),q=xe-M.length}else q-=R;for(;q--;)M+="0";d.d.push(+M),se&&(d.e>d.constructor.maxE?(d.d=null,d.e=NaN):d.e<d.constructor.minE&&(d.e=0,d.d=[0]))}else d.e=0,d.d=[0];return d}function et(d,M){var I,q,R,T,Q,re,ge,oe,Me;if(M.indexOf("_")>-1){if(M=M.replace(/(\d)_(?=\d)/g,"$1"),_e.test(M))return Be(d,M)}else if(M==="Infinity"||M==="NaN")return+M||(d.s=NaN),d.e=NaN,d.d=null,d;if(Xe.test(M))I=16,M=M.toLowerCase();else if(Le.test(M))I=2;else if(Fe.test(M))I=8;else throw Error(lt+M);for(T=M.search(/p/i),T>0?(ge=+M.slice(T+1),M=M.substring(2,T)):M=M.slice(2),T=M.indexOf("."),Q=T>=0,q=d.constructor,Q&&(M=M.replace(".",""),re=M.length,T=re-T,R=Re(q,new q(I),T,T*2)),oe=O(M,I,He),Me=oe.length-1,T=Me;oe[T]===0;--T)oe.pop();return T<0?new q(d.s*0):(d.e=J(oe,Me),d.d=oe,se=!1,Q&&(d=b(d,R,re*4)),ge&&(d=d.times(Math.abs(ge)<54?ee(2,ge):K.pow(2,ge))),se=!0,d)}function at(d,M){var I,q=M.d.length;if(q<3)return M.isZero()?M:Te(d,2,M,M);I=1.4*Math.sqrt(q),I=I>16?16:I|0,M=M.times(1/F(5,I)),M=Te(d,2,M,M);for(var R,T=new d(5),Q=new d(16),re=new d(20);I--;)R=M.times(M),M=M.times(T.plus(R.times(Q.times(R).minus(re))));return M}function Te(d,M,I,q,R){var T,Q,re,ge,oe=1,Me=d.precision,Ce=Math.ceil(Me/xe);for(se=!1,ge=I.times(I),re=new d(q);;){if(Q=b(re.times(ge),new d(M++*M++),Me,1),re=R?q.plus(Q):q.minus(Q),q=b(Q.times(ge),new d(M++*M++),Me,1),Q=re.plus(q),Q.d[Ce]!==void 0){for(T=Ce;Q.d[T]===re.d[T]&&T--;);if(T==-1)break}T=re,re=q,q=Q,Q=T,oe++}return se=!0,Q.d.length=Ce+1,Q}function F(d,M){for(var I=d;--M;)I*=d;return I}function j(d,M){var I,q=M.s<0,R=pe(d,d.precision,1),T=R.times(.5);if(M=M.abs(),M.lte(T))return u=q?4:1,M;if(I=M.divToInt(R),I.isZero())u=q?3:2;else{if(M=M.minus(I.times(R)),M.lte(T))return u=We(I)?q?2:3:q?4:1,M;u=We(I)?q?1:4:q?3:2}return M.minus(R).abs()}function Z(d,M,I,q){var R,T,Q,re,ge,oe,Me,Ce,$e,Ke=d.constructor,Nt=I!==void 0;if(Nt?(y(I,1,e),q===void 0?q=Ke.rounding:y(q,0,8)):(I=Ke.precision,q=Ke.rounding),!d.isFinite())Me=st(d);else{for(Me=B(d),Q=Me.indexOf("."),Nt?(R=2,M==16?I=I*4-3:M==8&&(I=I*3-2)):R=M,Q>=0&&(Me=Me.replace(".",""),$e=new Ke(1),$e.e=Me.length-Q,$e.d=O(B($e),10,R),$e.e=$e.d.length),Ce=O(Me,10,R),T=ge=Ce.length;Ce[--ge]==0;)Ce.pop();if(!Ce[0])Me=Nt?"0p+0":"0";else{if(Q<0?T--:(d=new Ke(d),d.d=Ce,d.e=T,d=b(d,$e,I,q,0,R),Ce=d.d,T=d.e,oe=le),Q=Ce[I],re=R/2,oe=oe||Ce[I+1]!==void 0,oe=q<4?(Q!==void 0||oe)&&(q===0||q===(d.s<0?3:2)):Q>re||Q===re&&(q===4||oe||q===6&&Ce[I-1]&1||q===(d.s<0?8:7)),Ce.length=I,oe)for(;++Ce[--I]>R-1;)Ce[I]=0,I||(++T,Ce.unshift(1));for(ge=Ce.length;!Ce[ge-1];--ge);for(Q=0,Me="";Q<ge;Q++)Me+=$.charAt(Ce[Q]);if(Nt){if(ge>1)if(M==16||M==8){for(Q=M==16?4:3,--ge;ge%Q;ge++)Me+="0";for(Ce=O(Me,R,M),ge=Ce.length;!Ce[ge-1];--ge);for(Q=1,Me="1.";Q<ge;Q++)Me+=$.charAt(Ce[Q])}else Me=Me.charAt(0)+"."+Me.slice(1);Me=Me+(T<0?"p":"p+")+T}else if(T<0){for(;++T;)Me="0"+Me;Me="0."+Me}else if(++T>ge)for(T-=ge;T--;)Me+="0";else T<ge&&(Me=Me.slice(0,T)+"."+Me.slice(T))}Me=(M==16?"0x":M==2?"0b":M==8?"0o":"")+Me}return d.s<0?"-"+Me:Me}function x(d,M){if(d.length>M)return d.length=M,!0}function W(d){return new this(d).abs()}function U(d){return new this(d).acos()}function C(d){return new this(d).acosh()}function N(d,M){return new this(d).plus(M)}function f(d){return new this(d).asin()}function p(d){return new this(d).asinh()}function _(d){return new this(d).atan()}function t(d){return new this(d).atanh()}function i(d,M){d=new this(d),M=new this(M);var I,q=this.precision,R=this.rounding,T=q+4;return!d.s||!M.s?I=new this(NaN):!d.d&&!M.d?(I=pe(this,T,1).times(M.s>0?.25:.75),I.s=d.s):!M.d||d.isZero()?(I=M.s<0?pe(this,q,R):new this(0),I.s=d.s):!d.d||M.isZero()?(I=pe(this,T,1).times(.5),I.s=d.s):M.s<0?(this.precision=T,this.rounding=1,I=this.atan(b(d,M,T,1)),M=pe(this,T,1),this.precision=q,this.rounding=R,I=d.s<0?I.minus(M):I.plus(M)):I=this.atan(b(d,M,T,1)),I}function c(d){return new this(d).cbrt()}function g(d){return L(d=new this(d),d.e+1,2)}function h(d,M,I){return new this(d).clamp(M,I)}function v(d){if(!d||typeof d!="object")throw Error(pt+"Object expected");var M,I,q,R=d.defaults===!0,T=["precision",1,e,"rounding",0,8,"toExpNeg",-n,0,"toExpPos",0,n,"maxE",0,n,"minE",-n,0,"modulo",0,9];for(M=0;M<T.length;M+=3)if(I=T[M],R&&(this[I]=we[I]),(q=d[I])!==void 0)if(Ae(q)===q&&q>=T[M+1]&&q<=T[M+2])this[I]=q;else throw Error(lt+I+": "+q);if(I="crypto",R&&(this[I]=we[I]),(q=d[I])!==void 0)if(q===!0||q===!1||q===0||q===1)if(q)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[I]=!0;else throw Error(ue);else this[I]=!1;else throw Error(lt+I+": "+q);return this}function A(d){return new this(d).cos()}function H(d){return new this(d).cosh()}function P(d){var M,I,q;function R(T){var Q,re,ge,oe=this;if(!(oe instanceof R))return new R(T);if(oe.constructor=R,Se(T)){oe.s=T.s,se?!T.d||T.e>R.maxE?(oe.e=NaN,oe.d=null):T.e<R.minE?(oe.e=0,oe.d=[0]):(oe.e=T.e,oe.d=T.d.slice()):(oe.e=T.e,oe.d=T.d?T.d.slice():T.d);return}if(ge=typeof T,ge==="number"){if(T===0){oe.s=1/T<0?-1:1,oe.e=0,oe.d=[0];return}if(T<0?(T=-T,oe.s=-1):oe.s=1,T===~~T&&T<1e7){for(Q=0,re=T;re>=10;re/=10)Q++;se?Q>R.maxE?(oe.e=NaN,oe.d=null):Q<R.minE?(oe.e=0,oe.d=[0]):(oe.e=Q,oe.d=[T]):(oe.e=Q,oe.d=[T]);return}if(T*0!==0){T||(oe.s=NaN),oe.e=NaN,oe.d=null;return}return Be(oe,T.toString())}if(ge==="string")return(re=T.charCodeAt(0))===45?(T=T.slice(1),oe.s=-1):(re===43&&(T=T.slice(1)),oe.s=1),_e.test(T)?Be(oe,T):et(oe,T);if(ge==="bigint")return T<0?(T=-T,oe.s=-1):oe.s=1,Be(oe,T.toString());throw Error(lt+T)}if(R.prototype=o,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=v,R.clone=P,R.isDecimal=Se,R.abs=W,R.acos=U,R.acosh=C,R.add=N,R.asin=f,R.asinh=p,R.atan=_,R.atanh=t,R.atan2=i,R.cbrt=c,R.ceil=g,R.clamp=h,R.cos=A,R.cosh=H,R.div=X,R.exp=ne,R.floor=fe,R.hypot=de,R.ln=ke,R.log=be,R.log10=Je,R.log2=Pe,R.max=De,R.min=Qe,R.mod=ot,R.mul=mt,R.pow=yt,R.random=_t,R.round=Lt,R.sign=Gt,R.sin=i0,R.sinh=t0,R.sqrt=r0,R.sub=a0,R.sum=S0,R.tan=rt,R.tanh=D0,R.trunc=p1,d===void 0&&(d={}),d&&d.defaults!==!0)for(q=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],M=0;M<q.length;)d.hasOwnProperty(I=q[M++])||(d[I]=this[I]);return R.config(d),R}function X(d,M){return new this(d).div(M)}function ne(d){return new this(d).exp()}function fe(d){return L(d=new this(d),d.e+1,3)}function de(){var d,M,I=new this(0);for(se=!1,d=0;d<arguments.length;)if(M=new this(arguments[d++]),M.d)I.d&&(I=I.plus(M.times(M)));else{if(M.s)return se=!0,new this(1/0);I=M}return se=!0,I.sqrt()}function Se(d){return d instanceof K||d&&d.toStringTag===ye||!1}function ke(d){return new this(d).ln()}function be(d,M){return new this(d).log(M)}function Pe(d){return new this(d).log(2)}function Je(d){return new this(d).log(10)}function De(){return Ie(this,arguments,-1)}function Qe(){return Ie(this,arguments,1)}function ot(d,M){return new this(d).mod(M)}function mt(d,M){return new this(d).mul(M)}function yt(d,M){return new this(d).pow(M)}function _t(d){var M,I,q,R,T=0,Q=new this(1),re=[];if(d===void 0?d=this.precision:y(d,1,e),q=Math.ceil(d/xe),this.crypto)if(crypto.getRandomValues)for(M=crypto.getRandomValues(new Uint32Array(q));T<q;)R=M[T],R>=429e7?M[T]=crypto.getRandomValues(new Uint32Array(1))[0]:re[T++]=R%1e7;else if(crypto.randomBytes){for(M=crypto.randomBytes(q*=4);T<q;)R=M[T]+(M[T+1]<<8)+(M[T+2]<<16)+((M[T+3]&127)<<24),R>=214e7?crypto.randomBytes(4).copy(M,T):(re.push(R%1e7),T+=4);T=q/4}else throw Error(ue);else for(;T<q;)re[T++]=Math.random()*1e7|0;for(q=re[--T],d%=xe,q&&d&&(R=ee(10,xe-d),re[T]=(q/R|0)*R);re[T]===0;T--)re.pop();if(T<0)I=0,re=[0];else{for(I=-1;re[0]===0;I-=xe)re.shift();for(q=1,R=re[0];R>=10;R/=10)q++;q<xe&&(I-=xe-q)}return Q.e=I,Q.d=re,Q}function Lt(d){return L(d=new this(d),d.e+1,this.rounding)}function Gt(d){return d=new this(d),d.d?d.d[0]?d.s:0*d.s:d.s||NaN}function i0(d){return new this(d).sin()}function t0(d){return new this(d).sinh()}function r0(d){return new this(d).sqrt()}function a0(d,M){return new this(d).sub(M)}function S0(){var d=0,M=arguments,I=new this(M[d]);for(se=!1;I.s&&++d<M.length;)I=I.plus(M[d]);return se=!0,L(I,this.precision,this.rounding)}function rt(d){return new this(d).tan()}function D0(d){return new this(d).tanh()}function p1(d){return L(d=new this(d),d.e+1,1)}K=P(we),K.prototype.constructor=K,K.default=K.Decimal=K,z=new K(z),me=new K(me),typeof define=="function"&&define.amd?define(function(){return K}):typeof e1<"u"&&e1.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(o[Symbol.for("nodejs.util.inspect.custom")]=o.toString,o[Symbol.toStringTag]="Decimal"),e1.exports=K):(m||(m=typeof self<"u"&&self&&self.self==self?self:window),V=m.Decimal,K.noConflict=function(){return m.Decimal=V,K},m.Decimal=K)})(L1)});var k1=g0((Vi,g1)=>{"use strict";var x1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],$1={};for(let m of x1)$1[m]=!0;var Un="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",xn="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",$n=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof g1<"u"&&(g1.exports={PRIMES:x1,PRIMES_SET:$1,LONG_PI:Un,LONG_E:xn,BIG_LOG_CACHE:$n})});var k0=g0((Bi,O1)=>{"use strict";var j1=typeof globalThis.nerdamerBigInt>"u"?R1():globalThis.nerdamerBigInt,Z1=typeof globalThis.nerdamerBigDecimal>"u"?U1():globalThis.nerdamerBigDecimal,kn=typeof globalThis.nerdamerConstants>"u"?k1():globalThis.nerdamerConstants,Rt={bigInt:j1,bigDec:Z1,isInt:()=>!1,scientificToDecimal:()=>"",DivisionByZero:Error,Settings:{PRECISION:21,USE_BIG:!1},Fraction:{convert:()=>[0,1],quickConversion:()=>[0,1],fullConversion:()=>[0,1]}},Ge=class m{constructor(n){if(this.num,this.den,n instanceof m)return n;if(n===void 0)return this;try{if(Rt.isInt(n))try{this.num=Rt.bigInt(n),this.den=Rt.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return m.simple(n)}else{let e=n instanceof Rt.bigDec?Rt.Fraction.quickConversion(n):Rt.Fraction.convert(n);this.num=new Rt.bigInt(e[0]),this.den=new Rt.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return m.simple(n)}}static create(n){if(n instanceof m)return n;n=n.toString();let e=n.charAt(0)==="-";e&&(n=n.substr(1,n.length-1));let $=new m(n);return e&&$.negate(),$}static isFrac(n){return n instanceof m}static quick(n,e){let $=new m;return $.num=new Rt.bigInt(n),$.den=new Rt.bigInt(e),$}static simple(n){let $=String(Rt.scientificToDecimal(n)).split("."),z=$.join(""),me="1",we=($[1]||"").length;for(let le=0;le<we;le++)me+="0";return m.quick(z,me).simplify()}multiply(n){if(this.isOne())return n.clone();if(n.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(n.num),e.den=e.den.multiply(n.den),e.simplify()}divide(n){if(n.equals(0))throw new Rt.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(n.clone().invert()).simplify()}subtract(n){return this.clone().add(n.clone().neg())}sub(n){return this.subtract(n)}neg(){return this.num=this.num.multiply(-1),this}add(n){let e=this.den,$=n.den,z=this.clone(),me=z.num,we=n.num;return e.equals($)?z.num=me.add(we):(z.num=me.multiply($).add(we.multiply(e)),z.den=e.multiply($)),z.simplify()}mod(n){let e=this.clone(),$=n.clone();return e.num=e.num.multiply($.den),e.den=e.den.multiply($.den),$.num=$.num.multiply(this.den),$.den=$.den.multiply(this.den),e.num=e.num.mod($.num),e.simplify()}simplify(){let n=Rt.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(n),this.den=this.den.divide(n),this}clone(){let n=new m;return n.num=new Rt.bigInt(this.num),n.den=new Rt.bigInt(this.den),n}decimal(n){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";n||=Rt.Settings.PRECISION,n+=2;let $=[],z=this.num.abs(),me=this.den,we;for(we=0;we<n;we++){let V=z.divide(me),u=z.subtract(V.multiply(me));if($.push(V),u.equals(0))break;z=u.times(10)}let K=$.shift();if($.length===0)return e+K.toString();if(we===n){let V=[];for(let u=0;u<2;u++)V.unshift($.pop());$.push(Math.round(Number(V.join("."))))}let le=`${K.toString()}.${$.join("")}`;return e+le}toDecimal(n){return n||=Rt.Settings.PRECISION,n?this.decimal(n):this.num.valueOf()/this.den.valueOf()}qcompare(n){return[this.num.multiply(n.den),n.num.multiply(this.den)]}equals(n){isNaN(n)||(n=new m(n));let e=this.qcompare(n);return e[0].equals(e[1])}absEquals(n){isNaN(n)||(n=new m(n));let e=this.qcompare(n);return e[0].abs().equals(e[1])}greaterThan(n){isNaN(n)||(n=new m(n));let e=this.qcompare(n);return e[0].gt(e[1])}gt(n){return this.greaterThan(n)}gte(n){return this.greaterThan(n)||this.equals(n)}lte(n){return this.lessThan(n)||this.equals(n)}lessThan(n){isNaN(n)||(n=new m(n));let e=this.qcompare(n);return e[0].lt(e[1])}lt(n){return this.lessThan(n)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let n=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=n,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(n){return m.quick(Rt.bigInt.gcd(n.num,this.num),Rt.bigInt.lcm(n.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Rt.Settings.USE_BIG?new Rt.bigDec(this.num.toString()).div(new Rt.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(n){let e=typeof n=="number"?new m(n):n;return this.mod(e).equals(0)}},x0={isVector:()=>!1,Vector:{fromArray:()=>({})},remove:()=>{}};function p0(m,...n){if(this.elements=[],typeof m>"u")return;let e=m;if(x0.isVector(e)||(e=x0.Vector.fromArray([e,...n])),e){let{elements:$}=e;for(let z=0,me=$.length;z<me;z++)this.add($[z])}}p0.fromArray=function(n){function e($){return p0.apply(this,$)}return e.prototype=p0.prototype,new e(n)};p0.prototype={elements:[],add(m){this.contains(m)||this.elements.push(m.clone())},contains(m){for(let n=0;n<this.elements.length;n++){let e=this.elements[n];if(m.equals(e))return!0}return!1},each(m){let{elements:n}=this,e=new p0;for(let $=0,z=n.length;$<z;$++){let me=n[$];m.call(this,me,e,$)}return e},clone(){let m=new p0;return this.each(n=>{m.add(n.clone())}),m},union(m){let n=this.clone();return m.each(e=>{n.add(e)}),n},difference(m){let n=this.clone();return m.each(e=>{n.remove(e)}),n},remove(m){for(let n=0,e=this.elements.length;n<e;n++)if(this.elements[n].equals(m))return x0.remove(this.elements,n),!0;return!1},intersection(m){let n=new p0,e=this;return m.each($=>{e.contains($)&&n.add($)}),n},intersects(m){return this.intersection(m).elements.length>0},isSubset(m){let{elements:n}=m;for(let e=0,$=n.length;e<$;e++)if(!this.contains(n[e]))return!1;return!0},toString(){return`{${this.elements.join(",")}}`}};var w0={_:null,block:()=>{}};function Dt(){this.elements=[]}Dt.prototype.append=function(n){this.elements.push(n)};Dt.prototype.getItems=function(){return this.elements};Dt.prototype.toString=function(){return w0._.prettyPrint(this.elements)};Dt.prototype.dimensions=function(){return this.elements.length};Dt.prototype.text=function(m){return`(${this.elements.map(n=>n.text(m)).join(",")})`};Dt.create=function(n){let e=new Dt;return n&&e.append(n),e};Dt.prototype.clone=function(n){let e=Dt.create();return e.elements=this.elements.map($=>$.clone()),e};Dt.prototype.expand=function(n){return this.elements=this.elements.map(e=>w0._.expand(e,n)),this};Dt.prototype.evaluate=function(m){return this.elements=this.elements.map(n=>w0._.evaluate(n,m)),this};Dt.prototype.map=function(n){let e=this.clone();return e.elements=e.elements.map(($,z)=>n($,z+1)),e};Dt.prototype.add=function(n){return w0.block("SAFE",()=>{let e=n.elements||n;return this.elements.length!==e.length?null:this.map(($,z)=>w0._.add($,e[z-1]))},void 0,this)};Dt.prototype.subtract=function(n){return w0.block("SAFE",()=>{let e=n.elements||n;return this.elements.length!==e.length?null:this.map(($,z)=>w0._.subtract($,e[z-1]))},void 0,this)};var z1={Settings:{SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0},nround:(m,n)=>Math.round(m*10**n)/10**n};function Vt(m){return this instanceof Vt?(m=String(typeof m>"u"?0:m),m.startsWith("-")?(this.sign=-1,m=m.substr(1,m.length)):this.sign=1,Vt.isScientific(m)?this.fromScientific(m):this.convert(m),this):new Vt(m)}Vt.prototype={fromScientific(m){let n=String(m).toLowerCase().split("e");this.coeff=n[0],this.exponent=Number(n[1]);let e=this.coeff.split(".");this.wholes=e[0]||"",this.dec=e[1]||"";let{dec:$}=this;return this.decp=$==="0"?0:$.length,this},convert(m){let n=m.split("."),e=n[0]||"",$=n[1]||"";e=Vt.removeLeadingZeroes(e),$=Vt.removeTrailingZeroes($);let z=e.length,me=e+$,we=Vt.leadingZeroes(me).length;this.exponent=z-(we+1);let K=Vt.removeLeadingZeroes(me);this.coeff=`${K.charAt(0)}.${Vt.removeTrailingZeroes(K.substr(1,K.length))||"0"}`;let le=this.coeff.split(".")[1]||"";return this.decp=le==="0"?0:le.length,this.dec=$,this.wholes=e,this},round(m){let n=this.copy();if(m=Number(m),m===0)n.coeff=n.coeff.charAt(0);else{let e=this.coeff.substring(0,m+1),$=this.coeff.substring(m+1,m+3),z=Number($.charAt(0));Number($.charAt(1))>4&&z++,n.coeff=e+z}return n},copy(){let m=new Vt(0);return m.coeff=this.coeff,m.exponent=this.exponent,m.sign=this.sign,m},toString(m){let n;if(z1.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<m)this.decp===0&&this.wholes!==void 0?n=this.wholes:n=this.coeff;else{let e=typeof m>"u"?this.coeff:Vt.round(this.coeff,Math.min(m,this.decp||1)),$=this.exponent;e.startsWith("10.")&&(e=typeof m>"u"?e.replace(/^10\./u,"1.0"):Vt.round(e.replace(/^10\./u,"1.0"),Math.min(m,this.decp||1)),$=Number($)+1),n=this.exponent===0?e:`${e}e${$}`}return(this.sign===-1?"-":"")+n}};Vt.isScientific=function(n){return/\d+\.?\d*e[+-]*\d+/iu.test(n)};Vt.leadingZeroes=function(n){let e=n.match(/^(?<zeros>0*).*$/u);return e?e[1]:""};Vt.removeLeadingZeroes=function(n){let e=n.match(/^0*(?<rest>.*)$/u);return e?e[1]:""};Vt.removeTrailingZeroes=function(n){let e=n.match(/0*$/u);return e?n.substring(0,n.length-e[0].length):""};Vt.round=function(n,e){let $=String(z1.nround(n,e)),z=$.includes(".")?$.split(".").pop():"",me=e-z.length;return me>0&&($.includes(".")||($+="."),$+=new Array(me+1).join("0")),$};function e0(m){let n=function(e){this.name=m,this.message=e===void 0?"":e;let $=new Error(this.message);$.name=this.name,this.stack=$.stack};return n.prototype=Object.create(Error.prototype),n}function Pt(m){return Array.isArray(m)}function Ct(m){return`(${m})`}function Dn(m,n){return m<0==n<0}function kt(...m){return m.shift().replace(/\{(?<idx>\d+)\}/gu,($,z)=>{let me=m[z];return typeof me=="function"?me():me})}function Pn(m,n,e){let $=[];e||=1;for(let z=m;z<=n;z++)$.push(z*e);return $}function bn(m){return m&&String(m)}function Fn(m,n,e,$){return m.substr(0,n)+$+m.substr(e,m.length)}function Vn(m){return m!==void 0&&m.custom}function Bn(m){return Math.max.apply(void 0,m)}function m1(m){return Math.min.apply(void 0,m)}function bt(m){return Number(m)%2===0}function d1(m){return 1/(m%1)%2===0}function w1(m){let n=m.length,e=[];for(let $=0;$<n;$++){let z=m[$];e.indexOf(z)===-1&&e.push(z)}return e}function Gn(m){return[].slice.call(m)}function Mt(m){return typeof m=="number"?Number.isInteger(m):typeof m<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(m.toString())}function Xn(m,n){if(m.sort(),n.sort(),m.length===n.length){for(let e=0;e<m.length;e++)if(m[e]!==n[e])return!1;return!0}return!1}function Hn(m){let n=[],e=m.length;for(let $=0;$<e;$++)n[$]=m[$].clone();return n}function W1(m){return/^\d+\.?\d*$/u.test(m)}function A0(m,n=14){return Mt(m)?Number(m)>=Number.MAX_VALUE?m.toString():Number(m):Math.round(m*10**n)/10**n}function jn(m,n){n||=20;let e=[],$,z,me;e.push(m[0]);for(let we=0;we<m.length-1;we++){$=m[we],z=m[we+1]-$,me=z/n;for(let K=0;K<n;K++)$+=me,e.push($)}return e}function Q1(m,n){if(Pt(m)){let e=m.length;for(let $=0;$<e;$++)n.call(m,$)}else for(let e in m)Object.hasOwn(m,e)&&n.call(m,e)}function _0(m,n){let e;return Pt(m)?e=m.splice(n,1)[0]:(e=m[n],delete m[n]),e}function Zn(m,n){let e={};return e[m]=n,e}function zn(m){for(let n=0;n<m.length;n++)if(!W1(m[n]))return!1;return!0}function G0(m){let n=Math.sign(m),e=Math.abs(m);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let z=String(e).toLowerCase().split("e"),me=z.pop(),we=Math.abs(Number(me)),K=Math.sign(Number(me)),le=z[0].split(".");if(K===-1)we-=le[0].length,we<0?e=`${le[0].slice(0,we)}.${le[0].slice(we)}${le.length===2?le[1]:""}`:e=`0.${new Array(we+1).join("0")}${le.join("")}`;else{let V=le[1];V&&(we-=V.length),we<0?e=`${le[0]+V.slice(0,we)}.${V.slice(we)}`:e=le.join("")+new Array(we+1).join("0")}}return n<0?`-${e}`:String(e)}function t1(m){let n=m[0];for(let e=1,$=m.length;e<$;e++)if(!m[e].equals(n))return!1;return!0}function Wn(m,n){typeof n!=="function"&&(n=function(z,me){return z===me});let $=[];for(;m.length;){let z=m[0];if(m.length===1){$.push(z);break}let me=[];$.push(z);for(let we=1;we<m.length;we++){let K=m[we];n(z,K)||me.push(K)}m=me}return $}function Qn(m,n){let e=m.length,$=[];for(let we=0;we<m.length;we++)$.push([m[we],n[we]]);$.sort((we,K)=>Number(we[0])-Number(K[0]));let z=[],me=[];for(let we=0;we<e;we++)z.push($[we][0]),me.push($[we][1]);return[z,me]}var S1=e0("DivisionByZero"),D1=e0("ParseError"),Kt=e0("UndefinedError"),v1=e0("OutOfFunctionDomainError"),Jn=e0("MaximumIterationsReached"),A1=e0("NerdamerTypeError"),n1=e0("ParityError"),L0=e0("OperatorError"),Yn=e0("OutOfRangeError"),y1=e0("DimensionError"),J1=e0("InvalidVariableNameError"),Kn=e0("ValueLimitExceededError"),P1=e0("NerdamerValueError"),ei=e0("SolveError"),ti=e0("InfiniteLoopError"),b1=e0("UnexpectedTokenError");function E1(m){return m instanceof Dt}function F1(m){return m instanceof p0}function i1(m,n,e){let z=Object.keys(m)[0];return n?z:e?{key:z,obj:m[z]}:m[z]}var{keys:_1}=Object,l1={N:1,P:2};function U0(m){return m.group===l1.N||m.group===l1.P}var Y1={S:3};function V1(m){return m.group===Y1.S&&m.multiplier.equals(1)&&m.power.equals(1)}var K1={N:1};function N1(m){for(let n=0;n<m.length;n++)if(m[n].group!==K1.N)return!1;return!0}var I1={RESERVED:[]};function r1(m){let n=function(e){I1.RESERVED.indexOf(e)===-1&&I1.RESERVED.push(e)};typeof m=="string"?n(m):Q1(m,e=>{n(e)})}var $0={RESERVED:[]};function ni(m){let n=$0.RESERVED.indexOf(m);n!==-1&&($0.RESERVED[n]=void 0)}var a1={ALLOW_CHARS:[],VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function y0(m,n="variable"){if(a1.ALLOW_CHARS.indexOf(m)!==-1)return;if(!a1.VALIDATION_REGEX.test(m))throw new J1(`${m} is not a valid ${n} name`)}var en={RESERVED:[]};function s1(m){return en.RESERVED.indexOf(m)!==-1}var j0={WARNINGS:[],SHOW_WARNINGS:!1};function M1(m){j0.WARNINGS.push(m),j0.SHOW_WARNINGS&&console&&console.warn&&console.warn(m)}function ii(){return j0.WARNINGS}var tn={EXPRESSIONS:[]};function ri(){return tn.EXPRESSIONS.length}var nn={Settings:{}};function si(m){return nn.Settings[m]}function oi(m){try{return y0(m),$0.RESERVED.indexOf(m)===-1}catch(n){if(n.message==="timeout")throw n;return!1}}function li(m){return m?$0.RESERVED:$0.RESERVED.join(", ")}var Z0={_version:"",C:{}};function ai(m){if(m)try{return Z0.C[m].version}catch(n){if(n.message==="timeout")throw n;return`No module named ${m} found!`}return Z0._version}function ui(){return Z0.C}var rn={functions:null};function ci(){return _1(rn.functions)}var sn={CONSTANTS:null};function fi(m){return String(sn.CONSTANTS[m])}var I0={VARS:null};function pi(m){return I0.VARS[m]}function hi(m,n){m||="text";let e={};if(m==="object")e=I0.VARS;else for(let $ in I0.VARS)Object.hasOwn(I0.VARS,$)&&(m==="latex"?e[$]=I0.VARS[$].latex(n):m==="text"&&(e[$]=I0.VARS[$].text(n)));return e}var Yt={_:null,C:null};function gi(m,n){return Yt._.toTeX(m,n)}function mi(m){return Yt._.getOperator(m)}function di(m,n){Yt._.aliasOperator(m,n)}function wi(m,n){Yt._.setOperator(m,n)}function Si(m,n){Yt._.peekers[m]&&Yt._.peekers[m].push(n)}function vi(m,n){let e=Yt._.peekers[m];if(e){let $=e.indexOf(n);$!==-1&&_0(e,$)}}function on(m){return Yt._.tree(Yt._.toRPN(Yt._.tokenize(m)))}function yi(m){return String(m).split(";").map(n=>Yt._.parse(n))}function Ei(m){return Yt._.tokenize(Yt._.toRPN(m))}function Ni(m,n){return`<div class="tree">
    <ul>
        <li>
${on(m).toHTML(3,n)}
        </li>
    </ul>
</div>`}function Mi(m,n,e){let $=Yt._.functions[m],z=typeof e>"u"?$[1]:e;Yt._.functions[m]=[n($[0],Yt.C),z]}var Ft={EXPRESSIONS:[],USER_FUNCTIONS:[],LaTeX:{latex:()=>"",parse:()=>""},text:()=>"",functions:{},Math2:{},_:null,Expression:null};function Ai(m,n,e){let $=m?{}:[];for(let z=0;z<Ft.EXPRESSIONS.length;z++){let me=n?Ft.LaTeX.latex(Ft.EXPRESSIONS[z],e):Ft.text(Ft.EXPRESSIONS[z],e);m?$[z+1]=me:$.push(me)}return $}function _i(m,n){let e=m?{}:[];for(let $=0;$<Ft.USER_FUNCTIONS.length;$++){let z,me,we=Ft.USER_FUNCTIONS[$],K=Ft.functions[we][2];if(K)({params:z,body:me}=K);else{let u=Ft.Math2[we].toString();[,z]=/\((?<params>.*?)\)/u.exec(u),z=z.split(",").map(se=>se.trim()),me="{JavaScript}"}let le=`${we}(${z.join(", ")})=${me}`,V=Ft.text(le,n);m?e[$+1]=V:e.push(V)}return e}function Ii(m){m=m.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),m=m.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),m=m.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),m=m.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let n=Ft.LaTeX.parse(Ft._.tokenize(m));return new Ft.Expression(Ft._.parse(n))}var n0={libExports:null,VARS:{},_clearFunctions:()=>{},_initConstants:()=>{},clear:null};function qi(){for(let m in n0.VARS)Object.hasOwn(n0.VARS,m)&&delete n0.VARS[m];return n0.libExports}function Oi(){return n0._clearFunctions(),n0.libExports}function Ci(){return n0.libExports}function Ti(){return n0.clear("all"),n0.libExports}function Ri(m){return m.call(n0.libExports),n0.libExports}var X0={libExports:null,CONSTANTS:{}};function Li(m,n){if(y0(m),!s1(m))if(n==="delete"||n==="")delete X0.CONSTANTS[m];else{if(isNaN(n))throw new A1("Constant must be a number!");X0.CONSTANTS[m]=n}return X0.libExports}var c0={libExports:null,VARS:{},CONSTANTS:{},parse:()=>null,isSymbol:()=>!1};function Ui(m,n){return y0(m),m in c0.CONSTANTS&&Ht(`Cannot set value for constant ${m}`),n==="delete"||n===""?delete c0.VARS[m]:c0.VARS[m]=c0.isSymbol(n)?n:c0.parse(n),c0.libExports}var u1={libExports:null,_setFunction:()=>!1};function xi(m,n,e){if(!u1._setFunction(m,n,e))throw new Error("Failed to set function!");return u1.libExports}var m0={libExports:null,EXPRESSIONS:[]};function B1(m,n=!1){if(m==="all")m0.EXPRESSIONS.length=0;else if(m==="last")m0.EXPRESSIONS.pop();else if(m==="first")m0.EXPRESSIONS.shift();else{let e=m?m-1:m0.EXPRESSIONS.length;n===!0?m0.EXPRESSIONS[e]=void 0:_0(m0.EXPRESSIONS,e)}return m0.libExports}var q0={libExports:null,Settings:null,functions:null};function ln(m){let n=q0.libExports.getCore();if(Pt(m))for(let e=0;e<m.length;e++)m&&ln(m[e]);else if(m&&q0.Settings.exclude.indexOf(m.name)===-1){if(m.dependencies){for(let z=0;z<m.dependencies.length;z++)if(!n[m.dependencies[z]])throw new Error(kt("{0} requires {1} to be loaded!",m.name,m.dependencies[z]))}let e=m.parent,$=m.build.call(n);if(e){n[e]||(n[m.parent]={});let z=e==="nerdamer"?q0.libExports:n[e];z[m.name]=$}m.visible&&(q0.functions[m.name]=[$,m.numargs])}}var jt={bigDec:null,Settings:null,functions:null,symfunction:null,NerdamerSymbol:null};function q1(m,n){if(typeof m=="object"&&m!==null){let $=m;for(let z in $)Object.hasOwn($,z)&&q1(z,$[z])}["SAFE"].indexOf(m)!==-1&&Ht(`Cannot modify setting: ${m}`),m==="PRECISION"?(jt.bigDec.set({precision:n}),jt.Settings.PRECISION=n,n>21&&q1("USE_BIG",!0)):m==="USE_LN"&&n===!0?(jt.Settings.LOG="LN",jt.Settings.LOG10="log",jt.functions.log=jt.Settings.LOG_FNS.log10,jt.functions.log[0]=function(z){return z.isConstant()?new jt.NerdamerSymbol(Math.log10(z)):jt.symfunction(jt.Settings.LOG10,[z])},jt.functions.LN=jt.Settings.LOG_FNS.log,delete jt.functions.log10):jt.Settings[m]=n}var f0={libExports:null,functions:null,parse:null,callfunction:null,Expression:null};function $i(m=!1){let n=function($){return function(...me){for(let we=0;we<me.length;we++)me[we]=f0.parse(me[we]);return new f0.Expression(l0("PARSE2NUMBER",()=>f0.callfunction($,me)))}};for(let e in f0.functions)(!(e in f0.libExports)||m)&&(f0.libExports[e]=n(e))}var an={suppress_errors:!1};function Ht(m,n=void 0){if(!an.suppress_errors)throw n?new n(m):new Error(m)}var un={PRIMES_SET:{}};function H0(m){if(m in un.PRIMES_SET)return!0;let n=Math.floor(Math.sqrt(m));for(let e=2;e<=n;e++)if(m%e===0)return!1;return!0}var E0={starttime:0,timeout:0,TIMEOUT:800};function G1(){E0.starttime=Date.now(),E0.timeout=E0.TIMEOUT}function X1(){E0.starttime=0}function c1(){if(E0.starttime!==0&&Date.now()>E0.starttime+E0.timeout)throw new Error("timeout")}var d0={PRIMES:[],PRIMES_SET:{}};function ki(m){if(c1(),H0(m))return[m];let n=m,e=1,$=[],z=2220446049250313e-31;for(;e<n;){c1();let me=m/e,we=Math.floor(me);if(me-we<=z&&e>1){if(H0(e)&&(d0.PRIMES_SET[e]||(d0.PRIMES.push(e),d0.PRIMES_SET[e]=!0),$.push(e)),H0(we)){$.push(we);break}n=we}e++}return $.sort((me,we)=>me-we)}function H1(m){let n=d0.PRIMES[d0.PRIMES.length-1]||2;for(let e=n;e<m;e++)H0(e)&&d0.PRIMES.push(e),d0.PRIMES_SET[e]=!0}var o1={Settings:{}};function l0(m,n,e=void 0,$=void 0){let z=o1.Settings[m];o1.Settings[m]=e===void 0?!0:!!e;let me=n.call($);return o1.Settings[m]=z,me}var cn={_:{parse:()=>{}}};function qt(m,n=void 0){return l0("PARSE2NUMBER",()=>cn._.parse(m,n),!0)}var ht={EXPRESSIONS:[],Settings:{EXPRESSION_DECP:5},LaTeX:{latex:()=>""},text:()=>"",variables:()=>[],isVector:()=>!1,isSymbol:()=>!1,isExpression:()=>!1,isNumericSymbol:()=>!1,isFraction:()=>!1,isArray:Pt,_:{parse:()=>{},add:()=>{},subtract:()=>{},multiply:()=>{},divide:()=>{},pow:()=>{},expand:()=>{}},Build:null};function Bt(m){this.symbol=m}Bt.getExpression=function(n,e=void 0){(n==="last"||!n)&&(n=ht.EXPRESSIONS.length),n==="first"&&(n=1);let $=Number(n)-1,z=ht.EXPRESSIONS[$];return z&&new Bt(z)};Bt.prototype={text(m="decimals",n=void 0){n||=ht.Settings.EXPRESSION_DECP;let e=this.symbol;return e.text_?e.text_(m):ht.text(this.symbol,m,void 0,n)},latex(m){return this.symbol.latex?this.symbol.latex(m):ht.LaTeX.latex(this.symbol,m)},valueOf(){return this.symbol.valueOf()},evaluate(...m){if(ht.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let n=m[0],e,$=1;typeof n=="string"?e=n.charAt(0)==="%"?Bt.getExpression(n.substr(1)).text():n:n instanceof Bt||ht.isSymbol(n)?e=n.text():(e=this.symbol.text(),$--);let z=m[$]||{};return new Bt(l0("PARSE2NUMBER",()=>ht._.parse(e,z),!0))},buildFunction(m){return ht.Build.build(this.symbol,m)},isNumber(){return ht.isNumericSymbol(this.symbol)},isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0},isImaginary(){return qt(ht._.parse(this.symbol)).isImaginary()},variables(){return ht.variables(this.symbol)},toString(){try{return ht.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(m){if(m.message==="timeout")throw m;return""}},toDecimal(m){ht.Settings.precision=m;let n=ht.text(this.symbol,"decimals");return ht.Settings.precision=void 0,n},isFraction(){return ht.isFraction(this.symbol)},isPolynomial(){return this.symbol.isPoly()},sub(m,n){return new Bt(this.symbol.sub(ht._.parse(m),ht._.parse(n)))},operation(m,n){return ht.isExpression(n)?n=n.symbol:ht.isSymbol(n)||(n=ht._.parse(n)),new Bt(ht._[m](this.symbol.clone(),n.clone()))},add(m){return this.operation("add",m)},subtract(m){return this.operation("subtract",m)},multiply(m){return this.operation("multiply",m)},divide(m){return this.operation("divide",m)},pow(m){return this.operation("pow",m)},expand(){return new Bt(ht._.expand(this.symbol))},each(m,n){if(this.symbol.each)this.symbol.each(m,n);else if(ht.isArray(this.symbol))for(let e=0;e<this.symbol.length;e++)m.call(this.symbol,this.symbol[e],e);else m.call(this.symbol)},eq(m){ht.isSymbol(m)||(m=ht._.parse(m));try{return ht._.subtract(this.symbol.clone(),m).equals(0)}catch(n){if(n.message==="timeout")throw n;return!1}},lt(m){ht.isSymbol(m)||(m=ht._.parse(m));try{return qt(ht._.subtract(this.symbol.clone(),m)).lessThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gt(m){ht.isSymbol(m)||(m=ht._.parse(m));try{return qt(ht._.subtract(this.symbol.clone(),m)).greaterThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gte(m){return this.gt(m)||this.eq(m)},lte(m){return this.lt(m)||this.eq(m)},numerator(){return new Bt(this.symbol.getNum())},denominator(){return new Bt(this.symbol.getDenom())},hasFunction(m){return this.symbol.containsFunction(m)},contains(m){return this.symbol.contains(m)}};Bt.prototype.toTeX=Bt.prototype.latex;var tt={Frac:Ge,NerdamerSymbol:null,isVector:()=>!1,isArray:Pt,isMatrix:()=>!1,isSymbol:()=>!1,block:l0,_:null,Settings:{PRECISION:1e-14},text:()=>"",LaTeX:null};function It(m,...n){this.multiplier=new tt.Frac(1),tt.isVector(m)?this.elements=m.elements?.slice(0)??[]:tt.isArray(m)?this.elements=m.slice(0):tt.isMatrix(m)?m.elements.length===1?(this.elements=[...m.elements[0]],this.rowVector=!0):m.elements.length>1&&Array.isArray(m.elements[0])&&m.elements[0].length===1&&(this.elements=m.elements.map(e=>e[0]),this.rowVector=!1):typeof m>"u"?this.elements=[]:this.elements=[m,...n]}It.arrayPrefill=function(n,e){let $=[];e||=0;for(let z=0;z<n;z++)$[z]=e;return $};It.fromArray=function(n){let e=new It;return e.elements=n,e};It.fromSet=function(n){return It.fromArray(n.elements)};It.prototype={custom:!0,e(m){return m<1||m>this.elements.length?null:this.elements[m-1]},set(m,n){tt.isSymbol(n)||(n=new tt.NerdamerSymbol(n)),this.elements[m]=n},dimensions(){return this.elements.length},modulus(){return tt.block("SAFE",()=>tt._.pow(this.dot(this.clone()),new tt.NerdamerSymbol(.5)),void 0,this)},eql(m){let n=this.elements.length,e=m.elements||m;if(n!==e.length)return!1;do if(Math.abs(tt._.subtract(this.elements[n-1],e[n-1]).valueOf())>tt.Settings.PRECISION)return!1;while(--n);return!0},clone(){let m=new It,n=this.elements.length;for(let e=0;e<n;e++)m.elements.push(this.elements[e].clone());return m.rowVector=this.rowVector,m},expand(m){return this.elements=this.elements.map(n=>tt._.expand(n,m)),this},map(m){let n=[];return this.each((e,$)=>{n.push(m(e,$))}),new It(n)},each(m){let n=this.elements.length,e=n,$;do $=e-n,m(this.elements[$],$+1);while(--n)},toUnitVector(){return tt.block("SAFE",()=>{let m=this.modulus();return m.valueOf()===0?this.clone():this.map(n=>tt._.divide(n,m))},void 0,this)},angleFrom(m){return tt.block("SAFE",()=>{let n=m.elements||m;if(this.elements.length!==n.length)return null;let $=new tt.NerdamerSymbol(0),z=new tt.NerdamerSymbol(0),me=new tt.NerdamerSymbol(0);this.each((V,u)=>{$=tt._.add($,tt._.multiply(V,n[u-1])),z=tt._.add(z,tt._.multiply(V,V)),me=tt._.add(me,tt._.multiply(n[u-1],n[u-1]))}),z=tt._.pow(z,new tt.NerdamerSymbol(.5)),me=tt._.pow(me,new tt.NerdamerSymbol(.5));let we=tt._.multiply(z,me);if(we.valueOf()===0)return null;let K=tt._.divide($,we),le=K.valueOf();return le<-1&&(K=-1),le>1&&(K=1),new tt.NerdamerSymbol(Math.acos(K))},void 0,this)},isParallelTo(m){let n=this.angleFrom(m).valueOf();return n===null?null:n<=tt.Settings.PRECISION},isAntiparallelTo(m){let n=this.angleFrom(m).valueOf();return n===null?null:Math.abs(n-Math.PI)<=tt.Settings.PRECISION},isPerpendicularTo(m){let n=this.dot(m);return n===null?null:Math.abs(n)<=tt.Settings.PRECISION},add(m){return tt.block("SAFE",()=>{let n=m.elements||m;return this.elements.length!==n.length?null:this.map((e,$)=>tt._.add(e,n[$-1]))},void 0,this)},subtract(m){return tt.block("SAFE",()=>{let n=m.elements||m;return this.elements.length!==n.length?null:this.map((e,$)=>tt._.subtract(e,n[$-1]))},void 0,this)},multiply(m){return this.map(n=>n.clone()*m.clone())},x(m){return this.multiply(m)},dot(m){return tt.block("SAFE",()=>{let n=m.elements||m,e=new tt.NerdamerSymbol(0),$=this.elements.length;if($!==n.length)return null;do e=tt._.add(e,tt._.multiply(this.elements[$-1],n[$-1]));while(--$);return e},void 0,this)},cross(m){let n=m.elements||m;if(this.elements.length!==3||n.length!==3)return null;let e=this.rowVector&&m.rowVector,$=this.elements;return tt.block("SAFE",()=>{let z=new It([tt._.subtract(tt._.multiply($[1],n[2]),tt._.multiply($[2],n[1])),tt._.subtract(tt._.multiply($[2],n[0]),tt._.multiply($[0],n[2])),tt._.subtract(tt._.multiply($[0],n[1]),tt._.multiply($[1],n[0]))]);return z.rowVector=e,z},void 0,this)},toUnitMultiplier(){return this},max(){let m=0,n=this.elements.length,e=n,$;do $=e-n,Math.abs(this.elements[$].valueOf())>Math.abs(m.valueOf())&&(m=this.elements[$]);while(--n);return m},magnitude(){let m=new tt.NerdamerSymbol(0);return this.each(n=>{m=tt._.add(m,tt._.pow(n,new tt.NerdamerSymbol(2)))}),tt._.sqrt(m)},indexOf(m){let n=null,e=this.elements.length,$=e,z;do z=$-e,n===null&&this.elements[z].valueOf()===m.valueOf()&&(n=z+1);while(--e);return n},text_(m,n){let e=tt.text(this,n);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},text(m,n){let e=tt.text(this,n);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},toString(){return this.text()},latex(m){let n=[];for(let e=0;e<this.elements.length;e++)n.push(tt.LaTeX.latex(this.elements[e],m));return`[${n.join(", ")}]`}};var ft={Frac:Ge,NerdamerSymbol:null,Vector:It,isMatrix:()=>!1,isVector:()=>!1,isArray:Pt,isSymbol:()=>!1,block:l0,_:null,err:()=>{},LaTeX:null};function vt(...m){this.multiplier=new ft.Frac(1);let n=m,e=n.length,$,z=[];if(ft.isMatrix(n))for($=0;$<e;$++)z.push(n[$].slice(0));else{let me,we,K;for($=0;$<e;$++)me=n[$],ft.isVector(me)&&(me=me.elements),ft.isArray(me)||(me=[me]),K=me.length,we&&we!==K&&ft.err("Unable to create Matrix. Row dimensions do not match!"),z.push(me),we=K}this.elements=z}vt.identity=function(n){let e=new vt;for(let $=0;$<n;$++){e.elements.push([]);for(let z=0;z<n;z++)e.set($,z,$===z?new ft.NerdamerSymbol(1):new ft.NerdamerSymbol(0))}return e};vt.fromArray=function(n){function e($){return vt.apply(this,$)}return e.prototype=vt.prototype,new e(n)};vt.zeroMatrix=function(n,e){let $=new vt;for(let z=0;z<n;z++)$.elements.push(ft.Vector.arrayPrefill(e,new ft.NerdamerSymbol(0)));return $};vt.prototype={custom:!0,get(m,n){if(this.elements[m])return this.elements[m][n]},map(m,n){let e=new vt;return this.each(($,z,me)=>{e.set(z,me,m.call(e,$),n)}),e},set(m,n,e,$){this.elements[m]||=[],$||ft.isSymbol(e)?this.elements[m][n]=e:this.elements[m][n]=new ft.NerdamerSymbol(e)},cols(){return this.elements[0].length},rows(){return this.elements.length},row(m){return!m||m>this.cols()?[]:this.elements[m-1]},col(m){let n=this.rows(),e=[];if(m>this.cols()||!m)return e;for(let $=0;$<n;$++)e.push(this.elements[$][m-1]);return e},eachElement(m){let n=this.rows(),e=this.cols(),$,z;for($=0;$<n;$++)for(z=0;z<e;z++)m.call(this,this.elements[$][z],$,z)},determinant(){if(!this.isSquare())return null;let m=this.toRightTriangular(),n=m.elements[0][0],e=m.elements.length-1,$=e,z;do z=$-e+1,n=ft._.multiply(n,m.elements[z][z]);while(--e);return n},isSquare(){return this.elements.length===this.elements[0].length},isSingular(){return this.isSquare()&&this.determinant()===0},augment(m){let n=this.rows(),e=m.rows();n!==e&&ft.err("Cannot augment matrix. Rows don't match.");for(let $=0;$<n;$++)this.elements[$]=this.elements[$].concat(m.elements[$]);return this},clone(){let m=this.rows(),n=this.cols(),e=new vt;for(let $=0;$<m;$++){e.elements[$]=[];for(let z=0;z<n;z++){let me=this.elements[$][z];e.elements[$][z]=ft.isSymbol(me)?me.clone():me}}return e},toUnitMultiplier(){return this},expand(m){return this.eachElement(n=>ft._.expand(n,m)),this},evaluate(m){return this.eachElement(n=>ft._.evaluate(n,m)),this},invert(){return this.isSquare()||ft.err("Matrix is not square!"),ft.block("SAFE",()=>{let m=this.elements.length,n=m,e,$,z=vt.identity(m),me=this.augment(z).toRightTriangular(),we,K=me.elements[0].length,le,V,u,se=[],pt;do{e=m-1,V=[],we=K,se[e]=[],u=me.elements[e][e];do le=K-we,pt=ft._.divide(me.elements[e][le],u.clone()),V.push(pt),le>=n&&se[e].push(pt);while(--we);for(me.elements[e]=V,$=0;$<e;$++){V=[],we=K;do le=K-we,V.push(ft._.subtract(me.elements[$][le].clone(),ft._.multiply(me.elements[e][le].clone(),me.elements[$][e].clone())));while(--we);me.elements[$]=V}}while(--m);return vt.fromArray(se)},void 0,this)},toRightTriangular(){return ft.block("SAFE",()=>{let m=this.clone(),n,e,$,z=this.elements.length,me=z,we,K,le=this.elements[0].length,V;do{if(we=me-z,e=m.elements[we][we],e.valueOf()===0){for(let u=we+1;u<me;u++)if($=m.elements[u][we],$&&$.valueOf()!==0){n=[],K=le;do V=le-K,n.push(ft._.add(m.elements[we][V].clone(),m.elements[u][V].clone()));while(--K);m.elements[we]=n;break}}if(e=m.elements[we][we],e.valueOf()!==0)for(let u=we+1;u<me;u++){let se=ft._.divide(m.elements[u][we].clone(),m.elements[we][we].clone());n=[],K=le;do V=le-K,n.push(V<=we?new ft.NerdamerSymbol(0):ft._.subtract(m.elements[u][V].clone(),ft._.multiply(m.elements[we][V].clone(),se.clone())));while(--K);m.elements[u]=n}}while(--z);return m},void 0,this)},transpose(){let m=this.elements.length,n=this.elements[0].length,e=new vt,$=n,z,me,we;do{z=n-$,e.elements[z]=[],me=m;do we=m-me,e.elements[z][we]=this.elements[we][z].clone();while(--me)}while(--$);return e},canMultiplyFromLeft(m){let n=ft.isMatrix(m)?m.elements.length:m.length;return this.elements[0].length===n},sameSize(m){return this.rows()===m.rows()&&this.cols()===m.cols()},multiply(m){return ft.block("SAFE",()=>{let n=m.elements||m;if(!this.canMultiplyFromLeft(n)){if(this.sameSize(m)){let lt=new vt,ze=this.rows();for(let ue=0;ue<ze;ue++){let ye=ft._.multiply(new ft.Vector(this.elements[ue]),new ft.Vector(m.elements[ue]));lt.elements[ue]=ye.elements}return lt}return null}let e=this.elements.length,$=e,z,me,we=n[0].length,K,le=this.elements[0].length,V=[],u,se,pt;do{z=$-e,V[z]=[],me=we;do{K=we-me,u=new ft.NerdamerSymbol(0),se=le;do pt=le-se,u=ft._.add(u,ft._.multiply(this.elements[z][pt],n[pt][K]));while(--se);V[z][K]=u}while(--me)}while(--e);return vt.fromArray(V)},void 0,this)},add(m,n){let e=new vt;return this.sameSize(m)&&this.eachElement(($,z,me)=>{let we=ft._.add($.clone(),m.elements[z][me].clone());n&&(we=n.call(e,we,$,m.elements[z][me])),e.set(z,me,we)}),e},subtract(m,n){let e=new vt;return this.sameSize(m)&&this.eachElement(($,z,me)=>{let we=ft._.subtract($.clone(),m.elements[z][me].clone());n&&(we=n.call(e,we,$,m.elements[z][me])),e.set(z,me,we)}),e},negate(){return this.each(m=>m.negate()),this},toVector(){if(this.rows()===1||this.cols()===1){let m=new ft.Vector;return m.elements=this.elements,m}return this},toString(m,n){let e=this.rows(),$=[];m=m===void 0?`
`:m;for(let z=0;z<e;z++)$.push(`[${this.elements[z].map(me=>{let we=n?me.multiplier.toDecimal():me.toString();return me===void 0?"":we}).join(",")}]`);return`matrix${Ct($.join(","))}`},text(){return`matrix(${this.elements.map(m=>`[${m.toString("")}]`)})`},latex(m){let n=this.cols(),{elements:e}=this;return kt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let $=[];for(let z in e){if(!Object.hasOwn(e,z))continue;let me=[];for(let we=0;we<n;we++)me.push(ft.LaTeX.latex(e[z][we],m));$.push(me.join(" & "))}return $.join(" \\cr ")})}};vt.prototype.each=vt.prototype.eachElement;var fn=(function(n){let e="1.1.16",{bigInt:$}=n,{bigDec:z}=n;z.set({precision:250});let me={},{PRIMES:we}=n.constants,{PRIMES_SET:K}=n.constants,le={},V={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",LONG_PI:n.constants.LONG_PI,LONG_E:n.constants.LONG_E,PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800};(function(){V.CACHE.roots={};let i=40,c=40;for(let g=2;g<=i;g++)for(let h=2;h<=c;h++){let v=$(g).pow(h);V.CACHE.roots[`${v}-${h}`]=g}})(),Object.defineProperty(E0,"TIMEOUT",{get:()=>V.TIMEOUT,configurable:!0});let u=null,se=null,pt=null,lt=null,ze=null,ue=null,ye=me.N=1,Ae=me.P=2,ee=me.S=3,Le=me.EX=4,Xe=me.FN=5,Fe=me.PL=6,_e=me.CB=7,He=me.CP=8,xe=V.CONST_HASH="#",{PARENTHESIS:Y}=V,{SQRT:l}=V,{ABS:S}=V,{FACTORIAL:o}=V,{DOUBLEFACTORIAL:w}=V,y=[],E={},O=[],G=[],b=[];Object.defineProperty(an,"suppress_errors",{get:()=>V.suppress_errors,configurable:!0}),en.RESERVED=O,j0.WARNINGS=G,Object.defineProperty(j0,"SHOW_WARNINGS",{get:()=>V.SHOW_WARNINGS,configurable:!0}),Object.defineProperty(tn,"EXPRESSIONS",{get:()=>y,configurable:!0}),nn.Settings=V,Z0._version=e,Object.defineProperty(Z0,"C",{get:()=>pt,configurable:!0}),a1.ALLOW_CHARS=V.ALLOW_CHARS,a1.VALIDATION_REGEX=V.VALIDATION_REGEX,un.PRIMES_SET=K,d0.PRIMES=we,d0.PRIMES_SET=K;let L=function(t){return ue(t)?L(t.multiplier.toDecimal()):Number(t)%1!==0};ue=function(t){return t instanceof N};let B=function(t){return t instanceof Bt},J=function(t,i=null,c=null){if(c||={c:[],add(g){this.c.indexOf(g)===-1&&isNaN(g)&&this.c.push(g)}},ue(t)){let{group:g}=t,h=t.previousGroup;if(g===Le&&J(t.power,i,c),g===He||g===_e||h===He||h===_e)for(let v in t.symbols)Object.hasOwn(t.symbols,v)&&J(t.symbols[v],i,c);else if(g===ee||h===ee)t.value==="e"||t.value==="pi"||t.value===V.IMAGINARY||c.add(t.value);else if(g===Fe||h===Fe)J(i1(t.symbols),i,c);else if(g===Le)isNaN(Number(t.value))||c.add(t.value),J(t.power,i,c);else if(g===Xe&&!i&&t.args)for(let v=0;v<t.args.length;v++)J(t.args[v],i,c)}return c.c.sort()},ce=function(t,i){let c=new N(0);for(let g=0;g<t.length;g++){let h=t[g];c=u.add(c,ue(h)?h:u.parse(h))}return i?Number(c):c},pe=function(t,i){t=u.expand(t),i||={};let c=function(g,h){i[g]||=new N(0),i[g]=u.add(i[g],h.clone())};return t.each(g=>{g.isConstant("all")?c("constants",g):g.group===ee?c(g.value,g):g.group===Xe&&(g.fname===S||g.fname==="")?pe(g.args[0]):g.group===Le||g.group===Xe||c(J(g).join(" "),g)}),i},Oe=function(t,i){i||=t.length;for(let c=0;c<i;c++)t[c]||(t[c]=new N(0));return t},ae=function(t){return t instanceof It},Re=function(t){return t instanceof vt};l1.N=ye,l1.P=Ae,Y1.S=ee;let We=function(t){return ue(t)?t.multiplier.lessThan(0):t<0},Ie=function(t,i,c){let h={},v;for(let A=0;A<c.length;A++)h[c[A]]=new N(Math.floor(Math.random()*5)+1);return l0("PARSE2NUMBER",()=>{v=u.parse(t,h).equals(u.parse(i,h))}),v},Ve=function(t,i,c){if(!i){let g=typeof t;if(g==="string"){let h=t;if(!/:?=/u.test(h))return!1;let v=V.FUNCTION_REGEX.exec(h);if(!v)return!1;let[,A,H,P]=v;t=A,i=H.split(",").map(X=>X.trim()),c=P}else if(g==="function"){let h=t,v=h.name;return y0(v),s1(v)?!1:(pt.Math2[v]=h,u.functions[v]=[void 0,h.length],b.includes(v)||b.push(v),!0)}else return!1}return t=t.trim(),y0(t),s1(t)?!1:(i||=J(u.parse(c)),i=i.map(g=>g.trim()),u.functions[t]=[u.mappedFunction,i.length,{name:t,params:i,body:c}],b.includes(t)||b.push(t),!0)},je=function(){for(let t of b)delete pt.Math2[t],delete u.functions[t]},st=function(t){let i,c,g;if(t.group===Xe&&t.fname===""?(i=N.unwrapPARENS(u.parse(t).toLinear()),c=u.parse(t.power)):t.group===Ae&&(i=u.parse(t.value),c=u.parse(t.power)),i&&c&&i.group===ye&&c.group===ye&&i.multiplier.isNegative()){g=[];let v=N.toPolarFormArray(qt(t))[0],A=u.arg(i),H=c.multiplier.den.toString(),P=c.multiplier.num.toString(),X="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let ne=0;ne<Number(H);ne++){let fe=qt(u.parse(kt("(({0})+2*pi*({1}))/({2})",A,ne,H))).multiplier.toDecimal();g.push(qt(u.parse(kt(X,v,H,V.IMAGINARY,fe,P))))}return It.fromArray(g)}if(t.isConstant(!0,!0)){let h=t.sign(),v=qt(t.abs()),A=u.sqrt(v);g=[A.clone(),A.negate()],h<0&&(g=g.map(H=>u.multiply(H,N.imaginary())))}else g=[u.parse(t)];return It.fromArray(g)},Be=function(t,i,c){i=String(i);let g,h;if(t.group===He){let H=u.expand(t.clone()).stripVar(i);g=u.subtract(t.clone(),H.clone()),h=H}else g=t.clone();let v=g.stripVar(i),A=u.divide(g.clone(),v.clone());return h||=new N(0),c?{a:v,x:A,ax:g,b:h}:[v,A,g,h]},et=function(t){let c="u",g=0,h=J(t);for(;!(O.indexOf(c)===-1&&h.indexOf(c)===-1);)c="u"+g++;for(let v=0,A=O.length;v<=A;v++)if(!O[v]){O[v]=c;break}return c};$0.RESERVED=O;let at=function(t){let i=J(t[0],null,null);for(let c=1,g=t.length;c<g;c++)i=i.concat(J(t[c]));return i=w1(i).sort(),i};I1.RESERVED=O,o1.Settings=V;let Te=function(){let t={};for(let i in u.functions)Object.hasOwn(u.functions,i)&&(t[i]=u.functions[i][0]);return t},F=function(t,i,c){let g=[];t.each(h=>{let v,A;h.contains(i)?(v=h.stripVar(i),A=u.divide(h.clone(),v.clone()).power.toDecimal()):(v=h,A=0);let H=g[A];g[A]=H?u.add(H,v):v},!0);for(let h=0;h<g.length;h++)g[h]||=new N(0);return g},j=function(t){if(Pt(t)){let i=new It([]);for(let c=0;c<t.length;c++)i.elements.push(j(t[c]));return i}return ue(t)?t:u.parse(t)};K1.N=ye;let Z=function(t){for(let i=0;i<t.length;i++)if(!(t[i].isPi()||t[i].isE())&&!t[i].isConstant(!0))return!1;return!0},x=function(t,i,c){(i.isComposite()&&!t.isComposite()||i.isLinear()&&!t.isLinear())&&([t,i]=[i,t]);let g=new N(0);return t.isLinear()?t.each(h=>{if(i.isComposite())i.isLinear()?i.each(v=>{let A=u.multiply(u.parse(h),u.parse(v)),H=u.expand(u.parse(A),c);g=u.add(g,H)},!0):g=u.add(g,u.multiply(h,u.parse(i)));else{let v=u.multiply(u.parse(h),u.parse(i));g=u.add(g,u.expand(v,c))}},!0):g=u.multiply(t,i),g},W={DivisionByZero:S1,ParseError:D1,OutOfFunctionDomainError:v1,UndefinedError:Kt,MaximumIterationsReached:Jn,NerdamerTypeError:A1,ParityError:n1,OperatorError:L0,OutOfRangeError:Yn,DimensionError:y1,InvalidVariableNameError:J1,ValueLimitExceededError:Kn,NerdamerValueError:P1,SolveError:ei,InfiniteLoopError:ti,UnexpectedTokenError:b1},U={csc(t){return 1/Math.sin(t)},sec(t){return 1/Math.cos(t)},cot(t){return 1/Math.tan(t)},acsc(t){return Math.asin(1/t)},asec(t){return Math.acos(1/t)},acot(t){return Math.PI/2-Math.atan(t)},erf(t){let i=1/(1+.5*Math.abs(t)),c=1-i*Math.exp(-t*t-1.26551223+i*(1.00002368+i*(.37409196+i*(.09678418+i*(-.18628806+i*(.27886807+i*(-1.13520398+i*(1.48851587+i*(-.82215223+i*.17087277)))))))));return t>=0?c:-c},diff(t){return function(g){return(t(g+.001)-t(g-.001))/.002}},median(...t){t.sort((c,g)=>c-g);let i=Math.floor(t.length/2);return t.length%2?t[i]:(t[i-1]+t[i])/2},fromContinued(t){let i=t.fractions.slice(),c=1/i.pop();for(let g=0,h=i.length;g<h;g++)c=1/(i.pop()+c);return t.sign*(t.whole+c)},continuedFraction(t,i){i||=20;let c=Math.sign(t),g=Math.abs(t),h=Math.floor(g),v=g-h,A=0,H=!1,P=1e-14,X=1e7,ne,fe,de={whole:h,sign:c,fractions:[]};for(;!H&&v!==0&&(ne=1/v,fe=Math.floor(ne),!(fe>X&&U.fromContinued(de)-t<=Number.EPSILON));)de.fractions.push(fe),v=ne-fe,(v<=P||A>=i-1)&&(H=!0),A++;let Se=de.fractions.length-1;return de.fractions[Se]===1&&(de.fractions.pop(),de.fractions[--Se]++),de},bigpow(t,i){t instanceof Ge||(t=Ge.create(t)),i instanceof Ge||(i=Ge.create(i));let c=new Ge(0);if(i.isInteger())c.num=t.num.pow(i.toString()),c.den=t.den.pow(i.toString());else{let g=Ge.create(t.num**i.num),h=Ge.create(t.den**i.num);c.num=U.nthroot(g,i.den.toString()),c.den=U.nthroot(h,i.den)}return c},gamma(t){let c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*U.gamma(1-t));t-=1;let g=c[0];for(let v=1;v<9;v++)g+=c[v]/(t+v);let h=t+7+.5;return Math.sqrt(2*Math.PI)*h**(t+.5)*Math.exp(-h)*g},bigfactorial(t){let i=new $(1);for(let c=2;c<=t;c++)i=i.times(c);return new Ge(i)},bigLog(t){let i=n.constants.BIG_LOG_CACHE;if(i[t])return Ge.quick.apply(null,i[t].split("/"));t=new Ge(t);let c=80,g=new Ge(0),h=t.subtract(new Ge(1)),v=t.add(new Ge(1));for(let A=0;A<c;A++){let H=new Ge(2*A+1),P=U.bigpow(h.divide(v),H),X=H.clone().invert().multiply(P);g=g.add(X)}return g.multiply(new Ge(2))},factorial(t){let i=t%1===0;if(i&&t<0)return NaN;if(!i)return U.gamma(t+1);let c=1;for(let g=2;g<=t;g++)c*=g;return c},dfactorial(t){let i=new Ge(1);if(Mt(t)){let c=t%2===0,g=c?t/2:(t+1)/2;if(c)for(let h=1;h<=g;h++)i=i.multiply(new Ge(2).multiply(new Ge(h)));else for(let h=1;h<=g;h++)i=i.multiply(new Ge(2).multiply(new Ge(h)).subtract(new Ge(1)))}else i=2**((1+2*t-Math.cos(Math.PI*t))/4)*Math.PI**((Math.cos(Math.PI*t)-1)/4)*U.gamma(1+t/2);return i},GCD(...t){let i=w1(t.map(h=>Math.abs(h))).sort(),c=Math.abs(i.shift()),g=i.length;for(;g-- >0;){let h=Math.abs(i.shift());for(;;){if(c%=h,c===0){c=h;break}if(h%=c,h===0)break}}return c},QGCD(...t){let i=t[0];for(let c=1;c<t.length;c++){let g=t[c],h=i.isNegative()&&g.isNegative()?-1:1;i=g.gcd(i),h<0&&i.negate()}return i},LCM(t,i){return t*i/U.GCD(t,i)},pow(t,i){return t<0&&Math.abs(i)<1?1/i%2===0?NaN:-(Math.abs(t)**i):t**i},factor(t){t=Number(t);let i=Math.sign(t);t=Math.abs(t);let c=U.ifactor(t),g=new N;g.symbols={},g.group=_e;for(let h in c){if(!Object.hasOwn(c,h))continue;let v=new N(1);v.group=Ae,v.value=h;let A=new N(c[h]);v.power=A,g.symbols[h]=v}return g.updateHash(),t===1&&(g=new N(t)),i<0&&g.negate(),g},sfactor(t,i){i||={};let c=Math.floor(Math.sqrt(t)),g=we[we.length-1];c>g&&t<1e6&&H1(c);let h=we.length;for(let v=0;v<h;v++){let A=we[v];for(;t%A===0;)t/=A,i[A]=(i[A]||0)+1}return t>1&&(i[t]=1),i},ifactor(t){let i=new $(t),c=new $(String(t));if(c.equals(0))return{0:1};let g=c.isNegative()?-1:1;c=c.abs();let h={};if(c.lt("65536"))h=U.sfactor(c,h);else{let v=function(A){A.isPrime()?h[A]=(h[A]||0)+1:h=U.sfactor(A,h)};try{let H={value:0},P=function(X,ne,fe){let de=new $(X),Se=2,ke=new $(X),be=new $(1);for(;be.equals(1);){for(let Pe=0;Pe<=Se&&be.equals(1);Pe++){if(fe.value++>1e3)throw new Error("stopping");ke=ke.pow(2).add(1).mod(ne),be=$.gcd(ke.minus(de).abs(),ne)}Se*=2,de=ke}return be.equals(ne)?P(X+1,ne,fe):be};for(;!c.abs().equals(1);)if(c.isPrime()){v(c);break}else{let X=P(2,c,H);v(X),c=c.divide(X)}}catch(A){if(A.message==="timeout")throw A;h={},v(i)}}if(g===-1){let v=m1(_1(h));h[`-${v}`]=h[v],delete h[v]}return h},boxfactor(t,i){i||=200;let c,g,h=Math.floor(5/12*t),v=0,A=!1;for(;c=Math.floor(t/h),g=t%h,g!==0;){if(A)return[t,1];h=Math.max(g,h-g),v++,A=v>i}return[c,h,v]},fib(t){let i=Math.sign(t);t=Math.abs(t),i=bt(t)?i:Math.abs(i);let c=0,g=1,h=1;for(let v=2;v<=t;v++)h=c+g,c=g,g=h;return h*i},mod(t,i){return t%i},integer_part(t){return Math.sign(t)*Math.floor(Math.abs(t))},simpson(t,i,c,g){let h=function(de,Se,ke){let be=de(Se),Pe=1e-12;return isNaN(be)&&(be=de(ke===1?Se+Pe:Se-Pe)),be};g||=1e-4;let v=Math.abs(Math.floor((c-i)/g));v%2!==0&&v++;let A=(c-i)/v,H=h(t,i,1),P=!1,X=i+A,ne,fe;for(let de=1;de<v;de++)ne=P?2:4,fe=ne*h(t,X,1),H+=fe,P=!P,X+=A;return(H+h(t,X,2))*(A/3)},num_integrate(t,i,c,g,h){if(h<0)throw new Error("max depth cannot be negative");function v(P,X,ne,fe,de,Se,ke,be,Pe,Je,De){if(De.nanEncountered)return NaN;let Qe=ne-X,ot=P(X+Qe*.25),mt=P(ne-Qe*.25);if(isNaN(ot)){De.nanEncountered=!0;return}if(isNaN(mt)){De.nanEncountered=!0;return}let yt=Qe*(fe+4*ot+de)/12,_t=Qe*(de+4*mt+Se)/12,Lt=yt+_t,Gt=(Lt-ke)/15;if(De.maxDepthCount>1e3*Pe)return;if(Je>Pe)return De.maxDepthCount++,Lt+Gt;if(Math.abs(Gt)<be)return Lt+Gt;let i0=X+Qe*.5,t0=v(P,X,i0,fe,ot,de,yt,be*.5,Pe,Je+1,De);if(isNaN(t0))return De.nanEncountered=!0,NaN;let r0=v(P,i0,ne,de,mt,Se,_t,be*.5,Pe,Je+1,De);return isNaN(r0)?(De.nanEncountered=!0,NaN):t0+r0}function A(P,X,ne,fe,de){let Se={maxDepthCount:0,nanEncountered:!1};fe===void 0&&(fe=1e-9),de===void 0&&(de=45);let ke=P(X),be=P(.5*(X+ne)),Pe=P(ne),Je=(ke+4*be+Pe)*(ne-X)/6,De=v(P,X,ne,ke,be,Pe,Je,fe,de,1,Se);if(Se.maxDepthCount>0&&M1(`integrate-adaptive-simpson: Warning: maximum recursion depth (${de}) reached ${Se.maxDepthCount} times`),Se.nanEncountered)throw new Error("Function does not converge over interval!");return De}let H;try{H=A(t,i,c,g,h)}catch(P){if(P.message==="timeout")throw P;return U.simpson(t,i,c)}return A0(H,12)},Ci(t){let c=.5772156649015329,g=0;for(let h=1;h<20;h++){let v=2*h;g+=(-1)**h*t**v/(v*U.factorial(v))}return Math.log(t)+c+g},Si(t){let c=0;for(let g=0;g<20;g++){let h=2*g;c+=(-1)**g*t**(h+1)/((h+1)*U.factorial(h+1))}return c},Ei(t){if(Number(t)===0)return-1/0;let i=30,c=.5772156649015329,g=0;for(let h=1;h<i;h++)g+=t**h/(h*U.factorial(h));return c+Math.abs(Math.log(t))+g},Shi(t){let c=0,g,h;for(let v=0;v<30;v++)g=2*v,h=g+1,c+=t**h/(h*h*U.factorial(g));return c},Chi(t){let c=.5772156649015329,g=function(h){return(Math.cosh(h)-1)/h};return Math.log(t)+c+U.num_integrate(g,.002,t,.001)},Li(t){return U.Ei(U.bigLog(t))},gamma_incomplete(t,i){let c=t-1,g=0,h=i||0;for(let v=0;v<c;v++)g+=h**v/U.factorial(v);return U.factorial(c)*Math.exp(-h)*g},step(t){return t>0?1:t<0?0:.5},rect(t){let i=Math.abs(t);return i===.5?i:i>.5?0:1},sinc(t){return t.equals(0)?1:Math.sin(t)/t},tri(t){return t=Math.abs(t),t>=1?0:1-t},nthroot(t,i){if(t instanceof Ge||(t=new Ge(t.toString())),i instanceof Ge||(i=new Ge(i.toString())),i.equals(1))return t;let c=t.divide(new Ge(2)),g=new Ge(1e-15),h,v,A,H=i.clone().invert(),P=i.subtract(new Ge(1));do{let X=U.bigpow(c,P),ne=H.multiply(t.divide(X).subtract(c)).toDecimal(25);if(h=Ge.create(ne),A)break;c=c.add(h),ne=h.toDecimal(),A=v?v===ne:!1,v=ne}while(h.abs().gte(g));return c},sqrt(t){t instanceof Ge||(t=new Ge(t));let i,c,g,h,v=0,A=!1,H=new Ge(1e-20);i=t.divide(new Ge(2));let P=1e3;do{if(v>P)throw new Error(`Unable to calculate square root for ${t}`);i=i.add(t.divide(i)).divide(new Ge(2)),i=new Ge(i.decimal(30)),c=t.subtract(i.multiply(i)),h=g?g.equals(c):!1,(c.clone().abs().lessThan(H)||h)&&(A=!0),g=c,v++}while(!A);return i}};V.FUNCTION_MODULES.push(U),r1(U),Math.sign||=function(i){return i=Number(i),i===0||isNaN(i)?i:i>0?1:-1},Math.cosh||=function(i){let c=Math.exp(i);return(c+1/c)/2},Math.sech||=function(i){return 1/Math.cosh(i)},Math.csch||=function(i){return 1/Math.sinh(i)},Math.coth||=function(i){return 1/Math.tanh(i)},Math.sinh||=function(i){let c=Math.exp(i);return(c-1/c)/2},Math.tanh||=function(i){if(i===1/0)return 1;if(i===-1/0)return-1;let c=Math.exp(2*i);return(c-1)/(c+1)},Math.asinh||=function(i){return i===-1/0?i:Math.log(i+Math.sqrt(i*i+1))},Math.acosh||=function(i){return Math.log(i+Math.sqrt(i*i-1))},Math.atanh||=function(i){return Math.log((1+i)/(1-i))/2},Math.trunc||=function(i){return isNaN(i)?NaN:i>0?Math.floor(i):Math.ceil(i)};function C(t,i=void 0,c=void 0,g=void 0){let h=i==="hash",v,A=h?void 0:i,H=A==="decimal"||A==="decimals"||A==="decimals_or_scientific";A==="decimals_or_scientific"&&typeof g>"u"&&(g=V.DEFAULT_DECP);function P(X,ne){switch(i){case"decimals":case"decimal":return v||=function(fe){return!1},ne?X.toDecimal(ne):X.valueOf();case"recurring":{v||=function(yt){return yt.indexOf("'")!==-1};let fe=X.toString(),de=/^-?\d+(?:\/\d+)?$/u.exec(fe);if(de.length===0)return fe;let Se=de[0].split("/"),ke=!1,be=Number(Se[0]);be<0&&(be=-be,ke=!0);let Pe=Number(Se[1]);Pe||=1;let Je=Math.floor(be/Pe),De=10*(be-Je*Pe);for(Je=`${Je.toString()}.`;De&&De<Pe;)De*=10,Je+="0";let Qe="",ot=[],mt=0;for(;;){if(typeof ot[De]<"u"){let Lt=Qe.slice(0,ot[De]),Gt=Qe.slice(ot[De]),i0=`${Je+Lt}'${Gt}'`;return(ke?"-":"")+i0.replace("'0'","").replace(/\.$/u,"")}let yt=Math.floor(De/Pe),_t=De-yt*Pe;ot[De]=mt,Qe+=yt.toString(),mt+=1,De=10*_t}}case"mixed":{v||=function(ot){return ot.indexOf("/")!==-1};let fe=X.toString(),de=/^-?\d+(?:\/\d+)?$/u.exec(fe);if(de.length===0)return fe;let Se=de[0].split("/"),ke=new $(Se[0]),be=new $(Se[1]);be.equals(0)&&(be=new $(1));let Pe=ke.divmod(be),{quotient:Je}=Pe,{remainder:De}=Pe,Qe=Se[0][0]==="-"||Je.equals(0)||De.equals(0)?"":"+";return(Je.equals(0)?"":Je.toString())+Qe+(De.equals(0)?"":`${De.toString()}/${Se[1]}`)}case"scientific":return v||=function(fe){return!1},new Vt(X.valueOf()).toString(V.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{v||=function(Se){return!1};let fe=X.valueOf(),de=new Vt(fe);return Math.abs(de.exponent)>=V.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?de.toString(V.SCIENTIFIC_MAX_DECIMAL_PLACES):ne?X.toDecimal(ne):fe}default:return v||=function(fe){return fe.indexOf("/")!==-1},X.toString()}}if(ue(t)){let X="",ne="",fe="",de=t.group||c,{value:Se}=t;if(!h){let De=P(t.multiplier);String(De)==="-1"&&String(t.multiplier)==="-1"&&(fe="-",De="1"),String(De)!=="1"&&(X=De);let Qe=t.power?P(t.power):"";String(Qe)!=="1"&&(ue(Qe)?ne=C(Qe,A):ne=Qe)}switch(de){case ye:{X="";let De;A==="decimals_or_scientific"?De=P(t.multiplier,g):g&&H?De=t.multiplier.toDecimal(g):De=P(t.multiplier),Se=String(t.multiplier)==="-1"?"1":De,ne="";break}case Fe:Se=t.collectSymbols().map(De=>{let Qe=C(De,A,c,g);return Qe==="0"&&(Qe=""),Qe}).sort().join("+").replace(/\+-/gu,"-");break;case He:Se=t.collectSymbols().map(De=>{let Qe=C(De,A,c,g);return Qe==="0"&&(Qe=""),Qe}).sort().join("+").replace(/\+-/gu,"-");break;case _e:Se=t.collectSymbols(De=>{let Qe=De.group;return(Qe===Fe||Qe===He)&&De.power.equals(1)&&De.multiplier.equals(1)?Ct(C(De,A)):C(De,A)}).join("*");break;case Le:{let De=t.previousGroup,Qe=t.power.group;De===Fe&&(Se=t.collectSymbols(C,A).join("+").replace("+-","-")),!(De===ye||De===ee||De===Xe)&&!h&&(Se=Ct(Se)),(Qe===He||Qe===_e||Qe===Fe||t.power.multiplier.toString()!=="1")&&ne&&(ne=Ct(ne));break}}if(de===Xe&&(Se=t.fname+Ct(t.args.map(De=>C(De,A)).join(","))),de===Xe&&t.fname in le){let De=C(t.args[0]),Qe=C(t.args[1]);t.args[0].isComposite()&&(De=Ct(De)),t.args[1].isComposite()&&(Qe=Ct(Qe)),Se=De+le[t.fname]+Qe}let ke=typeof v=="function"?v(ne):!1;if(ne&&de!==Le&&ke&&(ne=Ct(ne)),((de===He||de===Fe)&&(X&&String(X)!=="1"||fe==="-")||(de===_e||de===He||de===Fe)&&ne&&String(ne)!=="1"||!h&&de===Ae&&String(Se)==="-1"||t.fname===Y)&&(Se=Ct(Se)),g&&(i==="decimal"||(i==="decimals"||i==="decimals_or_scientific")&&X))if(X.toString().includes("e")){if(i!=="decimals_or_scientific"){let De=Number(X),Qe=De.toExponential(),ot=De.toPrecision(g);X=Qe.length<ot.length?Qe:ot}}else X=A0(Number(X),g);let be=fe+X,Pe=typeof v=="function"?v(X):!1;if(X&&Pe&&(be=Ct(be)),Number(ne)<0&&(ne=Ct(ne)),X&&(be=`${be}*`),ne){if(Se==="e"&&V.E_TO_EXP)return`${be}exp${Ct(ne)}`;ne=V.POWER_OPERATOR+ne}de===Le&&Se.charAt(0)==="-"&&(Se=Ct(Se));let Je=be+Se;return t.parens&&(Je=Ct(Je)),Je+ne}if(ae(t)){let X=t.elements.length,ne=[];for(let fe=0;fe<X;fe++)ne.push(t.elements[fe].text(i));return`[${ne.join(",")}]`}try{return t.toString()}catch(X){if(X.message==="timeout")throw X;return""}}ht.EXPRESSIONS=y,ht.Settings=V,ht.LaTeX=se,ht.text=C,ht.variables=J,ht.isVector=ae,ht.isSymbol=ue,ht.isExpression=B,ht.isNumericSymbol=U0,ht.isFraction=L,ht.isArray=Pt,Rt.bigInt=$,Rt.bigDec=z,Rt.isInt=Mt,Rt.scientificToDecimal=G0,Rt.DivisionByZero=S1,Rt.Settings=V;function N(t){c1();let i=t==="Infinity";if(!(this instanceof N))return new N(t);typeof t=="object"&&t!==null&&t instanceof z&&(t=t.toString());let c=String(t);return/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(c)||typeof t=="object"&&t!==null&&t instanceof z?(this.group=ye,this.value=xe,this.multiplier=new Ge(t)):(this.group=ee,y0(t),this.value=t,this.multiplier=new Ge(1),this.imaginary=t===V.IMAGINARY,this.isInfinity=i),this.power=new Ge(1),this.args=void 0,this.fname=void 0,this.isImgSymbol=void 0,this}N.imaginary=function(){let i=new N(V.IMAGINARY);return i.imaginary=!0,i},N.infinity=function(i=void 0){let c=new N("Infinity");return i===-1&&c.negate(),c},N.shell=function(i,c){let g=new N(c);return g.group=i,g.symbols={},g.length=0,g},N.unwrapSQRT=function(i,c){let g=i.power;if(i.fname===l&&(i.isLinear()||c)){let h=i.args[0].clone();h.power=h.power.multiply(new Ge(1/2)),h.multiplier=h.multiplier.multiply(i.multiplier),i=h,c&&(i.power=g.multiply(new Ge(1/2)))}return i},N.hyp=function(i,c){return i||=new N(0),c||=new N(0),u.sqrt(u.add(u.pow(i.clone(),new N(2)),u.pow(c.clone(),new N(2))))},N.toPolarFormArray=function(i){let c=i.realpart(),g=i.imagpart(),h=N.hyp(c,g),v=c.equals(0)?u.parse("pi/2"):u.trig.atan(u.divide(g,c));return[h,v]},N.unwrapPARENS=function(i){if(i.fname===""){let c=i.args[0];return c.power=c.power.multiply(i.power),c.multiplier=c.multiplier.multiply(i.multiplier),i.fname===""?N.unwrapPARENS(c):c}return i},N.create=function(i,c){return c=c===void 0?1:c,u.parse(`(${i})^(${c})`)},N.prototype={pushMinus(){let t=this;if((this.group===_e||this.group===He||this.group===Fe)&&this.multiplier.lessThan(0)&&!bt(this.power)){t=this.clone();let i=t.multiplier.clone();i.negate(),t.toUnitMultiplier();for(let c in t.symbols)if(Object.hasOwn(t.symbols,c)&&(t.symbols[c]=t.symbols[c].clone().negate(),t.group===_e))break;t.length>0&&t.each(c=>c.pushMinus()),t=u.parse(t),t=u.multiply(u.parse(i),t)}return t},getNth(t){let i=qt(u.pow(u.parse(this.multiplier),u.parse(String(t)).invert())),c=u.parse(A0(i));return qt(u.pow(c,u.parse(String(t)))).equals(u.parse(this.multiplier))?c:i},isToNth(t){let i=this.getNth(t),c=Mt(i),g;return this.group===_e?(g=!0,this.each(h=>{h.isToNth(t)||(g=!1)})):g=this.group===ye?!0:Mt(u.divide(u.parse(this.power),u.parse(t))),c&&g},isSquare(){return this.isToNth(2)},isCube(){return this.isToNth(3)},isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)},powSimp(){if(this.group===_e){let t=[],i=this.multiplier.sign();if(this.each(X=>{let ne=X.power;ue(ne)||ne.equals(1)||t.push(ne)}),t.length===0)return this.clone();let c=new Ge(m1(t)),g=this.multiplier.clone().abs(),h=U.ifactor(g.valueOf()),v=new Ge(1),A=new Ge(1);for(let X in h){if(!Object.hasOwn(h,X))continue;let ne=new Ge(h[X]);ne.lessThan(c)||(ne=ne.divide(c).subtract(new Ge(1)),A=A.multiply(new Ge(X))),v=v.multiply(u.parse(`${Ct(X)}^${Ct(ne)}`).multiplier)}let H=new N(A);this.each(X=>{X=X.clone(),X.power=X.power.divide(c),H=u.multiply(H,X)});let P=u.symfunction(Y,[H]);return P.power=c,P.multiplier=i<0?v.negate():v,P}return this.clone()},equals(t){let i;return ue(t)?i=t:i=new N(t),this.value===i.value&&this.power.equals(i.power)&&this.multiplier.equals(i.multiplier)&&this.group===i.group},abs(){let t=this.clone();return t.multiplier.abs(),t},gt(t){return ue(t)||(t=new N(t)),this.isConstant()&&t.isConstant()&&this.multiplier.greaterThan(t.multiplier)},gte(t){return ue(t)||(t=new N(t)),this.equals(t)||this.isConstant()&&t.isConstant()&&this.multiplier.greaterThan(t.multiplier)},lt(t){return ue(t)||(t=new N(t)),this.isConstant()&&t.isConstant()&&this.multiplier.lessThan(t.multiplier)},lte(t){return ue(t)||(t=new N(t)),this.equals(t)||this.isConstant()&&t.isConstant()&&this.multiplier.lessThan(t.multiplier)},isPoly(t=!1){let i=this.group,c=this.power;if(!Mt(c)||Number(c)<0)return!1;if(i===ye||i===ee||this.isConstant(!0))return!0;let g=J(this);if(i===_e&&g.length===1){let h=g[0];if(!h)return!0;for(let v in this.symbols){if(!Object.hasOwn(this.symbols,v))continue;let A=this.symbols[v];if(A.group===Xe&&!A.args[0].isConstant()||!A.contains(h)&&!A.isConstant(!0))return!1}return!0}if(this.isComposite()||i===_e&&t){if(!t&&g.length>1)return!1;for(let h in this.symbols)if(!this.symbols[h].isPoly(t))return!1;return!0}return!1},stripVar(t,i=!1){let c;return(this.group===Fe||this.group===ee)&&this.value===t?c=new N(i?0:this.multiplier):this.group===_e&&this.isLinear()?(c=new N(1),this.each(g=>{g.contains(t,!0)||(c=u.multiply(c,g.clone()))}),c.multiplier=c.multiplier.multiply(this.multiplier)):this.group===He&&!this.isLinear()?c=new N(this.multiplier):this.group===He&&this.isLinear()?(c=new N(0),this.each(g=>{if(!g.contains(t)){let h=g.clone();h.multiplier=h.multiplier.multiply(this.multiplier),c=u.add(c,h)}}),c.equals(0)&&(c=new N(this.multiplier))):this.group===Le&&this.power.contains(t,!0)?c=new N(this.multiplier):this.group===Xe&&this.contains(t)?c=new N(this.multiplier):c=this.clone(),c},toArray(t,i){i||={arr:[],add(g,h){let v=this.arr[h];this.arr[h]=v?u.add(v,g):g}};let c=this.group;if(c===ee&&this.contains(t))i.add(new N(this.multiplier),this.power);else if(c===_e){let g=this.stripVar(t),h=u.divide(this.clone(),g.clone()),v=h.isConstant()?0:h.power;i.add(g,v)}else if(c===Fe&&this.value===t)this.each((g,h)=>{i.add(g.stripVar(t),h)});else if(c===He)this.each(g=>{g.toArray(t,i)});else{if(this.contains(t))throw new A1("Cannot convert to array! Exiting");i.add(this.clone(),0)}i=i.arr;for(let g=0;g<i.length;g++)i[g]||=new N(0);return i},hasFunc(t){let i=this.group===Xe||this.group===Le;if(i&&!t||i&&this.contains(t))return!0;if(this.symbols){for(let c in this.symbols)if(this.symbols[c].hasFunc(t))return!0}return!1},sub(t,i){t=ue(t)?t.clone():u.parse(t),i=ue(i)?i.clone():u.parse(i),(t.group===ye||t.group===Ae)&&Ht("Cannot substitute a number. Must be a variable");let c=!1,g=t.multiplier.equals(1),h=this.multiplier.clone(),v;if(this.value===t.value&&(this.group!==Fe&&t.group!==Fe||this.group===Fe&&t.group===Fe))(g||t.multiplier.equals(this.multiplier))&&(t.isLinear()?v=i:t.power.equals(this.power)&&(v=i,c=!0),t.multiplier.equals(this.multiplier)&&(h=new Ge(1)));else if(this.group===_e||this.previousGroup===_e)v=new N(1),this.each(A=>{let H=u.parse(A.sub(t,i));v=u.multiply(v,H)});else if(this.isComposite()){let A=this.clone();if(t.isComposite()&&A.isComposite()&&A.isLinear()&&t.isLinear()){let H=function(P,X){for(let ne in P.symbols){if(!Object.hasOwn(P.symbols,ne))continue;let fe=P.symbols[ne];if(fe.isComposite()&&H(fe,X)||fe.equals(X))return!0}return!1};for(let P in t.symbols)if(Object.hasOwn(t.symbols,P)&&!H(A,t.symbols[P]))return A.clone();v=u.add(u.subtract(A.clone(),t),i)}else v=new N(0),A.each(H=>{v=u.add(v,H.sub(t,i))})}else if(this.group===Le)v=u.parse(this.value).sub(t,i);else if(this.group===Xe){let A=[];for(let H=0;H<this.args.length;H++){let P=this.args[H];ue(P)||(P=u.parse(P)),A.push(P.sub(t,i))}v=u.symfunction(this.fname,A)}if(v){if(!c){let A=this.group===Le?this.power.sub(t,i):u.parse(this.power);v=u.pow(v,A)}return v.multiplier=v.multiplier.multiply(h),v}return this.clone()},isMonomial(){if(this.group===ee)return!0;if(this.group===_e){for(let t in this.symbols)if(this.symbols[t].group!==ee)return!1}else return!1;return!0},isPi(){return this.group===ee&&this.value==="pi"},sign(){return this.multiplier.sign()},isE(){return this.value==="e"},isSQRT(){return this.fname===l},isConstant(t,i){if(i&&this.group===_e){for(let c in this.symbols)if(this.symbols[c].isConstant(!0))return!0}if(t==="functions"&&this.isComposite()){let c=!0;return this.each(g=>{g.isConstant(t,i)||(c=!1)},!0),c}if(t==="all"&&(this.isPi()||this.isE()))return!0;if(t&&this.group===Xe){for(let c=0;c<this.args.length;c++)if(!this.args[c].isConstant(t))return!1;return!0}return t?U0(this):this.value===xe},isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let t in this.symbols)if(this.symbols[t].isImaginary())return!0}return!1},realpart(){if(this.isConstant())return this.clone();if(this.imaginary)return new N(0);if(this.isComposite()){let t=new N(0);return this.each(i=>{t=u.add(t,i.realpart())}),t}return this.isImaginary()?new N(0):this.clone()},imagpart(){if(this.group===ee&&this.isImaginary()){let t=this;return this.power.isNegative()&&(t=this.clone(),t.power.negate(),t.multiplier.negate()),new N(t.multiplier)}if(this.isComposite()){let t=new N(0);return this.each(i=>{t=u.add(t,i.imagpart())}),t}return this.group===_e?this.stripVar(V.IMAGINARY):new N(0)},isInteger(){return this.isConstant()&&this.multiplier.isInteger()},isLinear(t){if(t){if(this.isConstant()||!this.contains(t,!0))return!0;if(this.group===ee)return this.value===t?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let i in this.symbols)if(!this.symbols[i].isLinear(t))return!1;return!0}return this.group===_e?this.symbols[t]?this.symbols[t].isLinear(t):!0:!1}return this.power.equals(1)},containsFunction(t){if(typeof t=="string"&&(t=[t]),this.group===Xe&&t.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let i in this.symbols)if(this.symbols[i].containsFunction(t))return!0}return!1},multiplyPower(t){if(this.group===ye&&this.multiplier.equals(1))return this;let i=this.power;if(this.group!==Le&&ue(t)&&t.group===ye){let c=t.multiplier;this.group===ye&&!c.isInteger()&&this.convert(Ae),this.power=i.equals(1)?c.clone():i.multiply(c),this.group===Ae&&Mt(this.power)&&(this.value=Number(this.value)**Number(this.power),this.toLinear(),this.convert(ye))}else{this.group!==Le&&(i=new N(i),this.convert(Le));let c=u.multiply(i,t);this.power=c}return this},setPower(t,i=!1){if(this.group===ye&&this.multiplier.equals(1))return this;if(this.group===Le&&!ue(t))this.group=this.previousGroup,delete this.previousGroup,this.group===ye?(this.multiplier=new Ge(this.value),this.value=xe):this.power=t;else{let c=!1;ue(t)&&(t.group===ye?t=t.multiplier:c=!0);let g=c?Le:Ae;this.power=t,this.group===ye&&g&&this.convert(g,i)}return this},isInverse(){return this.group===Le?this.power.multiplier.lessThan(0):Number(this.power)<0},clone(t=void 0){let i=this,c=t||new N(0),g=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],h=g.length,v;if(i.symbols){c.symbols={};for(let A in i.symbols)Object.hasOwn(i.symbols,A)&&(c.symbols[A]=i.symbols[A].clone())}for(v=0;v<h;v++)i[g[v]]!==void 0&&(c[g[v]]=i[g[v]]);return c.power=i.power.clone(),c.multiplier=i.multiplier.clone(),i.isConversion&&(c.isConversion=i.isConversion),i.isUnit&&(c.isUnit=i.isUnit),c},toUnitMultiplier(t=!1){return this.multiplier.num=new $(this.multiplier.num.isNegative()&&t?-1:1),this.multiplier.den=new $(1),this},toLinear(){return this.power.equals(1)?this:(this.setPower(new Ge(1)),this)},each(t,i=!1){if(this.symbols)for(let c in this.symbols){if(!Object.hasOwn(this.symbols,c))continue;let g=this.symbols[c];if(g.group===Fe&&i)for(let h in g.symbols)Object.hasOwn(g.symbols,h)&&t.call(c,g.symbols[h],h);else t.call(this,g,c)}else t.call(this,this,this.value)},valueOf(){return this.group===ye?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:C(this,"decimals")},contains(t,i=!1){t=String(t);let c=this.group;if(this.value===t)return!0;if(this.symbols){for(let g in this.symbols)if(this.symbols[g].contains(t,i))return!0}if(c===Xe||this.previousGroup===Xe){for(let g=0;g<this.args.length;g++)if(this.args[g].contains(t,i))return!0}return c===Le&&(i&&this.power.contains(t,i)||this.value===t)?!0:this.value===t},negate(){return this.multiplier.negate(),(this.group===He||this.group===Fe)&&this.distributeMultiplier(),this},invert(t=!1,i=!1){return t||(this.multiplier=this.multiplier.invert()),ue(this.power)?this.power.negate():this.group===_e&&i?this.each(c=>c.invert()):this.power&&this.group!==ye&&this.power.negate(),this},distributeMultiplier(t=!1){let i=t?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&i&&this.group!==_e&&!this.multiplier.equals(1)){for(let c in this.symbols){if(!Object.hasOwn(this.symbols,c))continue;let g=this.symbols[c];g.multiplier=g.multiplier.multiply(this.multiplier),g.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent(){if(!this.power.equals(1)){let t=this.power;for(let i in this.symbols){if(!Object.hasOwn(this.symbols,i))continue;let c=this.symbols[i];c.group===Le?c.power=u.multiply(c.power,new N(t)):ue(this.symbols[i].power)?this.symbols[i].power=u.multiply(this.symbols[i].power,new N(t)):this.symbols[i].power=this.symbols[i].power.multiply(t)}this.toLinear()}return this},convert(t,i=void 0){if(t>Xe){let c=this.clone();this.symbols={},t===_e?c.toUnitMultiplier():this.toUnitMultiplier(),this.group===Xe&&(c.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[c.keyForGroup(t)]=c,this.group=t,this.length=1}else if(t===Le)this.group===ye&&this.multiplier.equals(1)||(this.group!==Le&&(this.previousGroup=this.group),this.group===ye?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=C(this,"hash"),this.group=Le);else if(t===ye){let c=this.multiplier.toDecimal();this.symbols&&=void 0,new N(this.group===Ae?Number(c)*Number(this.value)**Number(this.power):c).clone(this)}else t===Ae&&this.group===ye&&(this.value=i?this.multiplier.num.toString():Math.abs(Number(this.multiplier.num.toString())),this.toUnitMultiplier(!i),this.group=Ae);return this},insert(t,i){if(ue(t)||Ht(`Object ${t} is not of type NerdamerSymbol!`),this.symbols){let{group:c}=this;if(c>Xe){let g=t.keyForGroup(c),h=g in this.symbols?this.symbols[g]:!1;if(i==="add"){let v=g;h?(this.symbols[v]=u.add(h,t),this.symbols[v].multiplier.equals(0)&&(delete this.symbols[v],this.length--,this.length===0&&(this.convert(ye),this.multiplier=new Ge(0)))):(this.symbols[g]=t,this.length++)}else t.group===Ae&&Mt(t.power)&&t.convert(ye),t.group===Le?(t.parens=t.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(t.multiplier.clone().abs()),t.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(t.multiplier),t.toUnitMultiplier()),h&&(t=u.multiply(_0(this.symbols,g),t),t.isConstant()&&(this.multiplier=this.multiplier.multiply(t.multiplier),t=new N(1)),this.length--),t.isOne(!0)?t.multiplier.lessThan(0)&&this.negate():(this.symbols[g]=t,this.length++);this.length===0&&this.convert(ye),(this.group===He||this.group===_e)&&this.updateHash()}}return this},attach(t){if(Pt(t)){for(let i=0;i<t.length;i++)this.insert(t[i],"add");return this}return this.insert(t,"add")},combine(t){if(Pt(t)){for(let i=0;i<t.length;i++)this.insert(t[i],"multiply");return this}return this.insert(t,"multiply")},updateHash(){if(this.group!==ye)if(this.group===Xe){let t="",{args:i}=this,c=this.fname===Y;for(let h=0;h<i.length;h++)t+=(h===0?"":",")+C(i[h]);let g=c?"":this.fname;this.value=g+(c?t:Ct(t))}else this.group===ee||this.group===Fe||(this.value=C(this,"hash"))},keyForGroup(t){let i=this.group,c;if(i===ye)c=this.value;else if(i===ee||i===Ae)t===Fe?c=this.power.toDecimal():c=this.value;else if(i===Xe)t===Fe?c=this.power.toDecimal():c=C(this,"hash");else{if(i===Fe)return t===_e?c=C(this,"hash"):t===He?this.power.equals(1)?c=this.value:c=Ct(C(this,"hash"))+V.POWER_OPERATOR+this.power.toDecimal():t===Fe?c=this.power.toString():c=this.value,c;i===He?(t===He&&(c=C(this,"hash")),t===Fe?c=this.power.toDecimal():c=this.value):i===_e?t===Fe?c=this.power.toDecimal():c=C(this,"hash"):i===Le&&(t===Fe?c=C(this.power):c=C(this,"hash"))}return c},collectSymbols(t,i,c,g){let h=[];if(this.symbols)for(let v in this.symbols){if(!Object.hasOwn(this.symbols,v))continue;let A=this.symbols[v];g&&(A.group===Fe||A.group===He)?h=h.concat(A.collectSymbols()):h.push(t?t(A,i):A)}else h.push(this);return c===null&&(c=void 0),h.sort(c)},collectSummandSymbols(t,i,c,g){let h=[];if(!this.symbols||this.group===_e)h.push(this);else for(let v in this.symbols){if(!Object.hasOwn(this.symbols,v))continue;let A=this.symbols[v];g&&(A.group===Fe||A.group===He)?h=h.concat(A.collectSymbols()):h.push(t?t(A,i):A)}return c===null&&(c=void 0),h.sort(c)},latex(t){return se.latex(this,t)},text(t=void 0){return C(this,t)},isOne(t=!1){let i=t?"absEquals":"equals";return this.group===ye?this.multiplier[i](1):this.power.equals(0)},isComposite(){let t=this.group,i=this.previousGroup;return t===He||t===Fe||i===Fe||i===He},isCombination(){let t=this.group,i=this.previousGroup;return t===_e||i===_e},lessThan(t){return this.multiplier.lessThan(t)},greaterThan(t){return ue(t)||(t=new N(t)),!this.isConstant(!0)||!t.isConstant(!0)?!1:this.multiplier.greaterThan(t.multiplier)},getDenom(){let t,i;if(i=this.clone(),this.group===_e&&this.power.lessThan(0)&&(i=u.expand(i)),i.power.lessThan(0)||i.group===Le&&i.power.multiplier.lessThan(0)){let c=u.parse(i.multiplier.den);t=i.toUnitMultiplier(),t.power.negate(),t=u.multiply(c,t)}else if(i.group===_e){t=u.parse(i.multiplier.den);for(let c in i.symbols){if(!Object.hasOwn(i.symbols,c))continue;let g=i.symbols[c];(Number(g.power)<0||g.group===Le&&g.power.multiplier.lessThan(0))&&(t=u.multiply(t,i.symbols[c].clone().invert()))}}else t=u.parse(i.multiplier.den);return t},getNum(){let t,i;return i=this.clone(),i.group===_e&&i.power.lessThan(0)&&(i=u.expand(i)),i.power.greaterThan(0)&&i.group!==_e||i.group===Le&&i.power.multiplier.greaterThan(0)?t=u.multiply(u.parse(i.multiplier.num),i.toUnitMultiplier()):i.group===_e?(t=u.parse(i.multiplier.num),i.each(c=>{(Number(c.power)>0||c.group===Le&&c.power.multiplier.greaterThan(0))&&(t=u.multiply(t,c.clone()))})):t=u.parse(i.multiplier.num),t},toString(){return this.text()}};function f(){let t=this,i={},c={names:[],actions:[]};function g(s,r){this.start=s,this.end=r}g.prototype.isConstant=function(){return this.start.isConstant()&&this.end.isConstant()},g.prototype.text=function(){return`${C(this.start)}:${C(this.end)}`};function h(s,r,a){if(this.type=r,this.value=s,a!==void 0&&(this.column=a+1),r===h.OPERATOR){let D=P[s];for(let k in D)Object.hasOwn(D,k)&&(this[k]=D[k])}else r===h.FUNCTION&&(this.precedence=h.MAX_PRECEDENCE,this.leftAssoc=!1)}h.prototype.toString=function(){return this.is_prefix?`\`${this.value}`:this.value},h.OPERATOR="OPERATOR",h.VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL",h.FUNCTION="FUNCTION",h.UNIT="UNIT",h.KEYWORD="KEYWORD",h.MAX_PRECEDENCE=999,this.classes={Collection:Dt,Slice:g,Token:h};let v={prec:void 0,cos(s,r){let a=u.parse(String(Math.cos(s)*Math.cosh(r))),D=u.parse(String(Math.sin(s)*Math.sinh(r)));return u.subtract(a,u.multiply(D,N.imaginary()))},sin(s,r){let a=u.parse(String(Math.sin(s)*Math.cosh(r))),D=u.parse(String(Math.cos(s)*Math.sinh(r)));return u.subtract(a,u.multiply(D,N.imaginary()))},tan(s,r){let a=u.parse(String(Math.sin(2*s)/(Math.cos(2*s)+Math.cosh(2*r)))),D=u.parse(String(Math.sinh(2*r)/(Math.cos(2*s)+Math.cosh(2*r))));return u.add(a,u.multiply(D,N.imaginary()))},sec(s,r){let a=this.removeDen(this.cos(s,r));return u.subtract(a[0],u.multiply(a[1],N.imaginary()))},csc(s,r){let a=this.removeDen(this.sin(s,r));return u.add(a[0],u.multiply(a[1],N.imaginary()))},cot(s,r){let a=this.removeDen(this.tan(s,r));return u.subtract(a[0],u.multiply(a[1],N.imaginary()))},acos(s,r){let a=this.fromArray([s,r]),D=u.pow(a.clone(),new N(2)),k=u.expand(D),he=u.multiply(rt(u.subtract(new N(1),k)),N.imaginary()),ie=u.expand(u.add(a.clone(),he)),te=Ke(ie);return u.expand(u.multiply(N.imaginary().negate(),te))},asin(s,r){return u.subtract(u.parse("pi/2"),this.acos(s,r))},atan(s,r){if(s.equals(0)&&(r.equals(1)||r.equals(-1)))return u.parse(`${N.infinity()}*${V.IMAGINARY}*${r}`);let a=v.fromArray([s,r]),D=u.expand(u.multiply(N.imaginary(),a.clone())),k=Ke(u.expand(u.subtract(new N(1),D.clone()))),he=Ke(u.expand(u.add(new N(1),D.clone())));return u.expand(u.multiply(u.divide(N.imaginary(),new N(2)),u.subtract(k,he)))},asec(s,r){let a=this.removeDen([s,r]);return a[1].negate(),this.acos(...a)},acsc(s,r){let a=this.removeDen([s,r]);return a[1].negate(),this.asin(...a)},acot(s,r){let a=this.removeDen([s,r]);return a[1].negate(),this.atan(...a)},cosh(s,r){let a=u.parse(String(Math.cosh(s)*Math.cos(r))),D=u.parse(String(Math.sinh(s)*Math.sin(r)));return u.add(a,u.multiply(D,N.imaginary()))},sinh(s,r){let a=u.parse(String(Math.sinh(s)*Math.cos(r))),D=u.parse(String(Math.cosh(s)*Math.sin(r)));return u.add(a,u.multiply(D,N.imaginary()))},tanh(s,r){let a=u.parse(String(Math.sinh(2*s)/(Math.cos(2*r)+Math.cosh(2*s)))),D=u.parse(String(Math.sin(2*r)/(Math.cos(2*r)+Math.cosh(2*s))));return u.subtract(a,u.multiply(D,N.imaginary()))},sech(s,r){let a=this.removeDen(this.cosh(s,r));return u.subtract(a[0],u.multiply(a[1],N.imaginary()))},csch(s,r){let a=this.removeDen(this.sinh(s,r));return u.subtract(a[0],u.multiply(a[1],N.imaginary()))},coth(s,r){let a=this.removeDen(this.tanh(s,r));return u.add(a[0],u.multiply(a[1],N.imaginary()))},acosh(s,r){let a=this.fromArray([s,r]),D=rt(u.add(a.clone(),new N(1))),k=rt(u.subtract(a.clone(),new N(1)));return u.expand(Ke(u.add(a,u.expand(u.multiply(D,k)))))},asinh(s,r){let a=this.fromArray([s,r]),D=rt(u.add(new N(1),u.expand(u.pow(a.clone(),new N(2)))));return u.expand(Ke(u.add(a,D)))},atanh(s,r){let a=this.fromArray([s,r]),D=Ke(u.add(a.clone(),new N(1))),k=Ke(u.subtract(new N(1),a));return u.expand(u.divide(u.subtract(D,k),new N(2)))},asech(s,r){let a=this.removeDen([s,r]);return a[1].negate(),this.acosh(...a)},acsch(s,r){let a=this.removeDen([s,r]);return a[1].negate(),this.asinh(...a)},acoth(s,r){let a=this.removeDen([s,r]);return a[1].negate(),this.atanh(...a)},sqrt(s){let r=s.realpart(),a=s.imagpart(),D=N.hyp(r,a),k=u.add(r.clone(),D),he=rt(u.multiply(new N(2),k.clone()));return u.add(u.divide(k.clone(),he.clone()),u.multiply(u.divide(a,he),N.imaginary()))},log(s,r){let a=Ke(N.hyp(s,r)),D=V.USE_BIG?new N(z.atan2(r.multiplier.toDecimal(),s.multiplier.toDecimal())):Math.atan2(r,s),k=u.parse(D);return u.add(a,u.multiply(N.imaginary(),k))},erf(s,r){return u.symfunction("erf",[s])},removeDen(s){let r,a;Pt(s)?(r=s[0],a=s[1]):(r=s.realpart(),a=s.imagpart());let D=r**2+a**2,k=u.parse(String(r/D)),he=u.parse(String(a/D));return[k,he]},fromArray(s){return u.add(s[0],u.multiply(N.imaginary(),s[1]))},evaluate(s,r){let a,D,k=s.power.sign();if(s.power=s.power.abs(),s.power.greaterThan(1)&&(s=u.expand(s)),k<0){let he=this.removeDen(s);a=he[0],D=he[1]}else a=s.realpart(),D=s.imagpart();return a.isConstant("all")&&D.isConstant("all")?this[r](a,D):u.symfunction(r,[s])}},A=this.trig={cos(s){if(s.equals("pi")&&s.multiplier.den.equals(2))return new N(0);if(V.PARSE2NUMBER){if(s.equals(new N(V.PI/2)))return new N(0);if(s.isConstant())return V.USE_BIG?new N(z.cos(s.multiplier.toDecimal())):new N(Math.cos(s.valueOf()));if(s.isImaginary())return v.evaluate(s,"cos")}if(s.equals(0))return new N(1);let r,a=!1,D=ct(s.multiplier.toDecimal()),k=s.multiplier.abs();if(s.multiplier=k,s.isPi()&&s.isLinear())if(Mt(k))r=new N(bt(k)?1:-1);else{let he=Number(k.num),ie=Number(k.den);ie===2?r=new N(0):ie===3?(r=u.parse("1/2"),a=!0):ie===4?(r=u.parse("1/sqrt(2)"),a=!0):ie===6?(r=u.parse("sqrt(3)/2"),a=!0):r=u.symfunction("cos",[s])}return a&&(D===2||D===3)&&r.negate(),r||=u.symfunction("cos",[s]),r},sin(s){if(V.PARSE2NUMBER){if(s.isConstant())return Number(s.multiplier.toDecimal())%Math.PI===0?new N(0):V.USE_BIG?new N(z.sin(s.multiplier.toDecimal())):new N(Math.sin(s.valueOf()));if(s.isImaginary())return v.evaluate(s,"sin")}if(s.equals(0))return new N(0);let r,a=!1,D=ct(s.multiplier.toDecimal()),k=s.multiplier.sign(),he=s.multiplier.abs();if(s.multiplier=he,s.equals("pi"))r=new N(0);else if(s.isPi()&&s.isLinear())if(Mt(he))r=new N(0);else{let ie=he.num,te=he.den;te.equals(2)?(r=new N(1),a=!0):te.equals(3)?(r=u.parse("sqrt(3)/2"),a=!0):te.equals(4)?(r=u.parse("1/sqrt(2)"),a=!0):te.equals(6)?(r=u.parse("1/2"),a=!0):r=u.multiply(new N(k),u.symfunction("sin",[s]))}return r||=u.multiply(new N(k),u.symfunction("sin",[s])),a&&(D===3||D===4)&&r.negate(),r},tan(s){if(V.PARSE2NUMBER){if(Number(s.multiplier.toDecimal())%Math.PI===0&&s.isLinear())return new N(0);if(s.isConstant())return V.USE_BIG?new N(z.tan(s.multiplier.toDecimal())):new N(Math.tan(s.valueOf()));if(s.isImaginary())return v.evaluate(s,"tan")}let r,a=!1,D=ct(s.multiplier.toDecimal()),k=s.multiplier;if(s.multiplier=k,s.isPi()&&s.isLinear())if(Mt(k))r=new N(0);else{let he=k.num,ie=k.den;if(ie.equals(2))throw new Kt(`tan is undefined for ${s.toString()}`);ie.equals(3)?(r=u.parse("sqrt(3)"),a=!0):ie.equals(4)?(r=new N(1),a=!0):ie.equals(6)?(r=u.parse("1/sqrt(3)"),a=!0):r=u.symfunction("tan",[s])}return r||=u.symfunction("tan",[s]),a&&(D===2||D===4)&&r.negate(),r},sec(s){if(V.PARSE2NUMBER)return s.isConstant()?V.USE_BIG?new N(new z(1).dividedBy(z.cos(s.multiplier.toDecimal()))):new N(U.sec(s.valueOf())):s.isImaginary()?v.evaluate(s,"sec"):u.parse(kt("1/cos({0})",s));let r,a=!1,D=ct(s.multiplier.toDecimal()),k=s.multiplier.abs();if(s.multiplier=k,s.isPi()&&s.isLinear())if(Mt(k))r=new N(bt(k)?1:-1);else{let he=k.num,ie=k.den;if(ie.equals(2))throw new Kt(`sec is undefined for ${s.toString()}`);ie.equals(3)?(r=new N(2),a=!0):ie.equals(4)?(r=u.parse("sqrt(2)"),a=!0):ie.equals(6)?(r=u.parse("2/sqrt(3)"),a=!0):r=u.symfunction("sec",[s])}return a&&(D===2||D===3)&&r.negate(),r||=u.symfunction("sec",[s]),r},csc(s){if(V.PARSE2NUMBER)return s.isConstant()?V.USE_BIG?new N(new z(1).dividedBy(z.sin(s.multiplier.toDecimal()))):new N(U.csc(s.valueOf())):s.isImaginary()?v.evaluate(s,"csc"):u.parse(kt("1/sin({0})",s));let r,a=!1,D=ct(s.multiplier.toDecimal()),k=s.multiplier.sign(),he=s.multiplier.abs();if(s.multiplier=he,s.isPi()&&s.isLinear()){if(Mt(he))throw new Kt(`csc is undefined for ${s.toString()}`);{let ie=he.num,te=he.den;te.equals(2)?(r=new N(1),a=!0):te.equals(3)?(r=u.parse("2/sqrt(3)"),a=!0):te.equals(4)?(r=u.parse("sqrt(2)"),a=!0):te.equals(6)?(r=new N(2),a=!0):r=u.multiply(new N(k),u.symfunction("csc",[s]))}}return r||=u.multiply(new N(k),u.symfunction("csc",[s])),a&&(D===3||D===4)&&r.negate(),r},cot(s){if(V.PARSE2NUMBER)return Number(s.multiplier.toDecimal())%(Math.PI/2)===0?new N(0):s.isConstant()?V.USE_BIG?new N(new z(1).dividedBy(z.tan(s.multiplier.toDecimal()))):new N(U.cot(s.valueOf())):s.isImaginary()?v.evaluate(s,"cot"):u.parse(kt("1/tan({0})",s));let r,a=!1,D=ct(s.multiplier.toDecimal()),k=s.multiplier;if(s.multiplier=k,s.isPi()&&s.isLinear()){if(Mt(k))throw new Kt(`cot is undefined for ${s.toString()}`);{let he=k.num,ie=k.den;ie.equals(2)?r=new N(0):ie.equals(3)?(r=u.parse("1/sqrt(3)"),a=!0):ie.equals(4)?(r=new N(1),a=!0):ie.equals(6)?(r=u.parse("sqrt(3)"),a=!0):r=u.symfunction("cot",[s])}}return r||=u.symfunction("cot",[s]),a&&(D===2||D===4)&&r.negate(),r},acos(s){if(V.PARSE2NUMBER){if(s.isConstant()){if(s.gt(1)||s.lt(-1)){let r=s.toString();return dt(qt(`pi/2-asin(${r})`))}return V.USE_BIG?new N(z.acos(s.multiplier.toDecimal())):new N(Math.acos(s.valueOf()))}if(s.isImaginary())return v.evaluate(s,"acos")}return u.symfunction("acos",[s])},asin(s){if(V.PARSE2NUMBER){if(s.isConstant()){if(s.gt(1)||s.lt(-1)){let r=V.IMAGINARY,a=s.multiplier.toDecimal();return dt(qt(`${r}*log(sqrt(1-${a}^2)-${r}*${a})`))}return V.USE_BIG?new N(z.asin(s.multiplier.toDecimal())):new N(Math.asin(s.valueOf()))}if(s.isImaginary())return v.evaluate(s,"asin")}return u.symfunction("asin",[s])},atan(s){let r;if(s.equals(0))r=new N(0);else{if(V.PARSE2NUMBER)return s.isConstant()?V.USE_BIG?new N(z.atan(s.multiplier.toDecimal())):new N(Math.atan(s.valueOf())):s.isImaginary()?v.evaluate(s,"atan"):u.symfunction("atan",[s]);s.equals(-1)?r=u.parse("-pi/4"):r=u.symfunction("atan",[s])}return r},asec(s){if(V.PARSE2NUMBER){if(s.equals(0))throw new v1("Input is out of the domain of sec!");if(s.isConstant())return A.acos(s.invert());if(s.isImaginary())return v.evaluate(s,"asec")}return u.symfunction("asec",[s])},acsc(s){if(V.PARSE2NUMBER){if(s.isConstant())return A.asin(s.invert());if(s.isImaginary())return v.evaluate(s,"acsc")}return u.symfunction("acsc",[s])},acot(s){if(V.PARSE2NUMBER){if(s.isConstant())return u.add(u.parse("pi/2"),A.atan(s).negate());if(s.isImaginary())return v.evaluate(s,"acot")}return u.symfunction("acot",[s])},atan2(s,r){if(s.equals(0)&&r.equals(0))throw new Kt("atan2 is undefined for 0, 0");return V.PARSE2NUMBER&&s.isConstant()&&r.isConstant()?new N(Math.atan2(s,r)):u.symfunction("atan2",[s,r])}},H=this.trigh={cosh(s){if(V.PARSE2NUMBER){if(s.isConstant())return new N(Math.cosh(s.valueOf()));if(s.isImaginary())return v.evaluate(s,"cosh")}return u.symfunction("cosh",[s])},sinh(s){if(V.PARSE2NUMBER){if(s.isConstant())return new N(Math.sinh(s.valueOf()));if(s.isImaginary())return v.evaluate(s,"sinh")}return u.symfunction("sinh",[s])},tanh(s){if(V.PARSE2NUMBER){if(s.isConstant())return new N(Math.tanh(s.valueOf()));if(s.isImaginary())return v.evaluate(s,"tanh")}return u.symfunction("tanh",[s])},sech(s){return V.PARSE2NUMBER?s.isConstant()?new N(Math.sech(s.valueOf())):s.isImaginary()?v.evaluate(s,"sech"):u.parse(kt("1/cosh({0})",s)):u.symfunction("sech",[s])},csch(s){return V.PARSE2NUMBER?s.isConstant()?new N(Math.csch(s.valueOf())):s.isImaginary()?v.evaluate(s,"csch"):u.parse(kt("1/sinh({0})",s)):u.symfunction("csch",[s])},coth(s){return V.PARSE2NUMBER?s.isConstant()?new N(Math.coth(s.valueOf())):s.isImaginary()?v.evaluate(s,"coth"):u.parse(kt("1/tanh({0})",s)):u.symfunction("coth",[s])},acosh(s){let r;return V.PARSE2NUMBER&&s.isImaginary()?r=v.evaluate(s,"acosh"):V.PARSE2NUMBER?r=qt(u.parse(kt(`${V.LOG}(({0})+sqrt(({0})^2-1))`,s.toString()))):r=u.symfunction("acosh",[s]),r},asinh(s){let r;return V.PARSE2NUMBER&&s.isImaginary()?r=v.evaluate(s,"asinh"):V.PARSE2NUMBER?r=qt(u.parse(kt(`${V.LOG}(({0})+sqrt(({0})^2+1))`,s.toString()))):r=u.symfunction("asinh",[s]),r},atanh(s){let r;return V.PARSE2NUMBER&&s.isImaginary()?r=v.evaluate(s,"atanh"):V.PARSE2NUMBER?r=qt(u.parse(kt(`(1/2)*${V.LOG}((1+({0}))/(1-({0})))`,s.toString()))):r=u.symfunction("atanh",[s]),r},asech(s){let r;return V.PARSE2NUMBER&&s.isImaginary()?r=v.evaluate(s,"asech"):V.PARSE2NUMBER?r=qt(Ke(u.add(s.clone().invert(),rt(u.subtract(u.pow(s,new N(-2)),new N(1)))))):r=u.symfunction("asech",[s]),r},acsch(s){let r;return V.PARSE2NUMBER&&s.isImaginary()?r=v.evaluate(s,"acsch"):V.PARSE2NUMBER?r=qt(u.parse(kt(`${V.LOG}((1+sqrt(1+({0})^2))/({0}))`,s.toString()))):r=u.symfunction("acsch",[s]),r},acoth(s){let r;return V.PARSE2NUMBER&&s.isImaginary()?r=v.evaluate(s,"acoth"):V.PARSE2NUMBER?s.equals(1)?r=N.infinity():r=qt(u.divide(Ke(u.divide(u.add(s.clone(),new N(1)),u.subtract(s.clone(),new N(1)))),new N(2))):r=u.symfunction("acoth",[s]),r}};this.units={};let P={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(s){return s}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(s){return u.symfunction(V.DOUBLEFACTORIAL,[s])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(s){return Qe(s)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(s){return u.divide(s,new N(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(s){return s}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(s){return s}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(s){return s.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},X={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},ne=this.functions={cos:[A.cos,1],sin:[A.sin,1],tan:[A.tan,1],sec:[A.sec,1],csc:[A.csc,1],cot:[A.cot,1],acos:[A.acos,1],asin:[A.asin,1],atan:[A.atan,1],arccos:[A.acos,1],arcsin:[A.asin,1],arctan:[A.atan,1],asec:[A.asec,1],acsc:[A.acsc,1],acot:[A.acot,1],atan2:[A.atan2,2],acoth:[H.acoth,1],asech:[H.asech,1],acsch:[H.acsch,1],sinh:[H.sinh,1],cosh:[H.cosh,1],tanh:[H.tanh,1],asinh:[H.asinh,1],sech:[H.sech,1],csch:[H.csch,1],coth:[H.coth,1],acosh:[H.acosh,1],atanh:[H.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[i0,1],radians:[t0,1],degrees:[r0,1],min:[Me,-1],max:[oe,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[Gt,1],tri:[void 0,1],sign:[Ce,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[Qe,1],factorial:[Qe,1],continuedFraction:[ot,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[Nt,[1,2]],scientific:[p1,[1,2]],mod:[yt,2],pfactor:[M,1],vector:[F0,-1],matrix:[Wt,-1],NerdamerSet:[xt,-1],imatrix:[zt,-1],parens:[Je,-1],sqrt:[rt,1],cbrt:[D0,1],nthroot:[d,2],log:[Ke,[1,2]],expand:[s0,1],abs:[De,1],invert:[Mn,1],determinant:[Sn,1],size:[vn,1],transpose:[Nn,1],dot:[yn,2],cross:[En,2],vecget:[O0,2],vecset:[P0,3],vectrim:[u0,[1,2]],matget:[C0,3],matset:[R0,4],matgetrow:[M0,2],matsetrow:[b0,3],matgetcol:[o0,2],matsetcol:[T0,3],rationalize:[S0,1],IF:[_t,3],isIn:[Lt,2],realpart:[I,1],imagpart:[q,1],conjugate:[R,1],arg:[T,1],polarform:[Q,1],rectform:[re,1],sort:[$e,[1,2]],integer_part:[void 0,1],union:[An,2],contains:[In,2],intersection:[_n,2],difference:[qn,2],intersects:[On,2],isSubset:[Cn,2],primes:[Tn,2],print:[Rn,-1]};this.error=Ht;let fe=function(s){let r=V.FUNCTION_MODULES,a=r.length;for(let D=0;D<a;D++){let k=r[D];if(s in k)return k[s]}return Ht(`The function ${s} is undefined!`)};this.override=function(r,a){i[r]||=[],i[r].push(this[r]),this[r]=a},this.restore=function(r){this[r]&&=i[r].pop()},this.extend=function(r,a,D){let k=this;if(typeof this[r]=="function"&&typeof a=="function"){let ie=this[r];this[r]=function(Ne,Ee){return ue(Ne)&&ue(Ee)&&!D?ie.call(k,Ne,Ee):a.call(k,Ne,Ee,ie)}}},this.symfunction=function(r,a){let D=new N(r);return D.group=Xe,typeof a=="object"&&(a=[].slice.call(a)),D.args=a,D.fname=r===Y?"":r,D.updateHash(),D},this.callfunction=function(r,a,D=void 0){let k=ne[r];k||Ht(`Nerdamer currently does not support the function ${r}`);let he=k[1]||D,ie=k[0],te;if(a instanceof Array||(a=a===void 0?[]:[a]),he!==-1){let Ee=Pt(he),qe=Ee?he[0]:he,ve=Ee?he[1]:he,Ze=a.length,wt=`${r} requires a {0} of {1} arguments. {2} provided!`;Ze<qe&&Ht(kt(wt,"minimum",qe,Ze)),Ze>ve&&Ht(kt(wt,"maximum",ve,Ze))}let Ne=N1(a);return ie?te=ie.apply(k[2],a):(ie=fe(r),V.PARSE2NUMBER&&Ne?te=Zt(ie.apply(ie,a)):te=u.symfunction(r,a)),te},this.operator_filter_regex=(function(){let r=`^\\${Object.keys(P).filter(a=>a.length===1).join("\\")}`;return new RegExp(`([${r}])\\s+([${r}])`)})(),this.setOperator=function(r,a=void 0,D=void 0){let k=r.operator;if(P[k]=r,a&&(this[r.action]=a),t[k]=r.operation,!r.action&&!(r.prefix||r.postif)&&(r.action=k),D==="over"||D==="under"){let{precedence:he}=r;for(let ie in P){if(!Object.hasOwn(P,ie))continue;let te=P[ie];(D==="over"?te.precedence>=he:te.precedence>he)&&te.precedence++}}},this.getOperator=function(r){return P[r]},this.aliasOperator=function(r,a){let D={},k=P[r];for(let he in k)Object.hasOwn(k,he)&&(D[he]=k[he]);D.operator=a,this.setOperator(D)},this.getOperators=function(){return P},this.getBrackets=function(){return X};let de=function(r,a){r=String(r);for(let D=0;D<c.actions.length;D++)r=c.actions[D].call(a,r);for(r=r.replace(/\s+/gu," "),/e/giu.test(r)&&(r=r.replace(/-+\d+\.?\d*e\+?-?\d+/giu,D=>G0(D)),r=r.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,D=>G0(D))),r=r.replace(V.IMPLIED_MULTIPLICATION_REGEX,(D,k,he,ie,te)=>{let Ne=te.charAt(ie),Ee="",qe="*";return Ne.match(/[+\-/*]/u)||(Ee=te.charAt(ie-1)),Ee.match(/[a-z]/iu)&&(qe=""),k+qe+he}).replace(/(?<varname>[a-z0-9_]+)/giu,(D,k)=>V.USE_MULTICHARACTER_VARS===!1&&!(k in ne)&&isNaN(k)?k.split("").join("*"):k).replace(/\)\(/gu,")*(")||"0";;){let D=r;if(r=r.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,(k,he,ie,te,Ne)=>{let Ee=he||te,qe=ie||Ne;return Ee in ne?Ee+qe:`${Ee}*${qe}`}),D===r)break}return r};this.initConstants=function(){this.CONSTANTS={E:new N(V.E),PI:new N(V.PI)}},this.prettyPrint=function(r){if(Array.isArray(r)){let a=r,D=a.map(k=>u.prettyPrint(k)).join(", ");return a.type==="vector"?`vector<${D}>`:`(${D})`}return r.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(r,...a){if(V.callPeekers){let D=this.peekers[r],k=a.map(bn);for(let he=0;he<D.length;he++)D[he].apply(null,k)}},this.tokenize=function(r){r=String(r),r=r.trim().replace(/\s+/gu," ");for(let St in X){if(!Object.hasOwn(X,St))continue;let Ot=new RegExp(X[St].is_close?`\\s+\\${St}`:`\\${St}\\s+`,"g");r=r.replace(Ot,St)}let a=0,D=r.length,k=0,he=[],ie=[he],te=ie[0],Ne=0,Ee=[],qe=!1,ve,Ze=" ",wt="",Et=",",Ye="-",Ue="*",it=function(St=void 0,Ot=void 0){let Tt=[];St!==void 0&&(Tt.type=St),Tt.column=Ot,ie.push(Tt),te.push(Tt),te=Tt,Ne++},nt=function(){ie.pop(),te=ie[--Ne]},ut=function(St){St=St===void 0?a:St;let Ot=St+1;for(;r.charAt(Ot++)in P;);return r.substring(St,Ot-1)},At=function(St){let Ot=a-St.length,Tt=[],Jt=St.charAt(0),B0=St.length,v0;for(v0=1;v0<B0;v0++){let C1=St.charAt(v0),T1=Jt+C1;T1 in P?Jt=T1:(Tt.push(new h(Jt,h.OPERATOR,Ot+v0)),Jt=C1)}return Tt.push(new h(Jt,h.OPERATOR,Ot+v0)),Tt},gt=function(St,Ot=void 0){Ot===void 0&&(Ot=r.substring(k,St)),Ot in u.units?te.push(new h(Ot,h.UNIT,k)):Ot!==""&&te.push(new h(Ot,h.VARIABLE_OR_LITERAL,k))},$t=function(St){te.push(new h(St,h.FUNCTION,k))},Qt=function(St){k=St+1},h0=function(){k=k+ve.length-2,a=k-1};for(;a<D;a++){let St=r.charAt(a);if(St in P){gt(a);let Tt=te[0]&&W1(te[0])&&St===Ue;qe&&k<a&&!(St===Et||Tt)&&(qe=!1,nt()),Qt(a+1),ve=ut(a),h0(),te.push(...At(ve))}else if(St in X){let Ot=X[St];if(Ot.is_open){Ee.push([Ot,k]);let Tt=r.substring(k,a);Tt in ne?$t(Tt):Tt!==""&&te.push(new h(Tt,h.VARIABLE_OR_LITERAL,k)),it(Ot.maps_to,a)}else if(Ot.is_close){let Tt=Ee.pop();if(Tt){if(Tt[0].id!==Ot.id-1)throw new n1("Parity error")}else throw new n1(`Missing open bracket for bracket at: ${a+1}`);gt(a),nt()}Qt(a)}else if(St===Ze){let Ot=r.substring(k,a),Tt=r.charAt(a+1);if(qe){if(Ot in P)te.push(new h(Ot,h.OPERATOR,a));else{gt(void 0,Ot),nt();let Jt=Tt in P;(Jt&&P[Tt].value===Ye||!Jt)&&te.push(new h(Ue,h.OPERATOR,a))}qe=!1}else{let Jt=r.substring(k,a);Jt in ne?(qe=!0,$t(Jt),it()):Jt in P?te.push(new h(Jt,h.OPERATOR,a)):(gt(void 0,Jt),Tt=r.charAt(a+1),Ot!==wt&&Tt!==wt&&!(Ot in P)&&!(Tt in P)&&te.push(new h(Ue,h.OPERATOR,a)))}Qt(a)}}if(Ee.length){let St=Ee.pop();throw new n1(`Missing closed bracket for bracket at ${St[1]+1}`)}return gt(a),he},this.toRPN=function(r){let a=r.type,D=r.length,k,he,ie=[],te=[],Ne=[],Ee=function(ve,Ze){for(;ve.length;)Ze.push(ve.pop())};for(k=0;k<D;k++){let qe=r[k];if(qe.type!==h.OPERATOR)break;if(!qe.prefix)throw new L0("Not a prefix operator");qe.is_prefix=!0,te.push(qe)}for(;k<D;k++){if(he=r[k],he.type===h.OPERATOR){let qe=he;if(qe.overloaded){let ve=r[k+1];ve&&ve.type===h.VARIABLE_OR_LITERAL&&(qe.postfix=!1,qe.action=qe.overloadAction,qe.leftAssoc=qe.overloadLeftAssoc)}for(;te.length;){let ve=te[te.length-1];if(!(ve.precedence>qe.precedence||!qe.leftAssoc&&ve.precedence===qe.precedence))break;ie.push(te.pop())}if((a==="vector"||a==="set")&&"vectorFn"in qe&&(qe.action=qe.vectorFn),qe.postfix){let ve=r[k-1];if(ve){if(ve.type===h.OPERATOR&&!ve.postfix)throw new L0(`Unexpected prefix operator '${ve.value}'! at ${ve.column}`)}else throw new L0(`Unexpected prefix operator '${he.value}'! at ${he.column}`)}else{let ve;do{let Ze=r[k+1];if(ve=Ze?Ze.type===h.OPERATOR:!1,ve){if(!Ze.prefix)throw new L0(`A prefix operator was expected at ${Ze.column}`);Ze.is_prefix=!0,Ne.push(Ze),k++}}while(ve)}for(qe.is_prefix?Ne.push(qe):te.push(qe);Ne.length&&(qe.leftAssoc||!qe.leftAssoc&&Ne[Ne.length-1].precedence>=qe.precedence);)te.push(Ne.pop())}else if(he.type===h.VARIABLE_OR_LITERAL){ie.length===0&&Ee(Ne,te),ie.push(he);let qe=te[te.length-1];(!qe||!qe.leftAssoc)&&Ee(Ne,ie)}else he.type===h.FUNCTION?te.push(he):he.type===h.UNIT&&ie.push(he);if(Array.isArray(he)){let qe=he;ie.push(this.toRPN(he)),qe.type&&ie.push(new h(qe.type,h.FUNCTION,qe.column))}}return Ee(te,ie),Ee(Ne,ie),ie},this.parseRPN=function(r,a){try{a||={};for(let ie in a)Object.hasOwn(a,ie)&&(a[ie]=u.parse(a[ie],{}));V.PARSE2NUMBER&&("e"in a||(a.e=new N(V.E)),"pi"in a||(a.pi=new N(V.PI)));let D=[],k;for(let ie=0,te=r.length;ie<te;ie++)if(k=r[ie],Array.isArray(k)&&(k=this.parseRPN(k,a)),k)if(k.type===h.OPERATOR)if(k.is_prefix||k.postfix)D.push(k.operation(D.pop()));else{let Ne=D.pop(),Ee=D.pop();if(typeof Ee>"u")throw new L0(`${k} is not a valid postfix operator at ${k.column}`);let qe=k.action==="comma";Ee instanceof p0&&!qe&&(Ee=It.fromSet(Ee)),Ne instanceof p0&&!qe&&(Ne=It.fromSet(Ne)),this.callPeekers("pre_operator",Ee,Ne,k);let ve=u[k.action](Ee,Ne);this.callPeekers("post_operator",ve,Ee,Ne,k),D.push(ve)}else if(k.type===h.FUNCTION){let Ne=D.pop(),{parent:Ee}=Ne;Ne instanceof Dt||(Ne=Dt.create(Ne));let qe=k.value,ve=Ne.getItems();this.callPeekers("pre_function",qe,ve);let Ze=u.callfunction(qe,ve);this.callPeekers("post_function",Ze,qe,ve);let wt=D[D.length-1],Et=r[ie+1],Ye=Et&&Et.type===h.OPERATOR&&Et.value===",";Ee&&(Ze.parent=Ee),D.push(Ze)}else{let Ne,Ee=k.value;if(Ee in V.ALIASES)k=u.parse(V.ALIASES[k]);else if(k.type===h.VARIABLE_OR_LITERAL)k=new N(Ee);else if(k.type===h.UNIT){let qe=new N(Ee);qe.isUnit=!0,k=qe}Ee in u.CONSTANTS?(Ne=k,k=new N(u.CONSTANTS[Ee])):Ee in a&&Ee!==a[Ee].toString()?(Ne=k,k=a[Ee].clone()):Ee in E&&(Ne=k,k=E[Ee].clone()),Ne&&(k.subbed=Ne),D.push(k)}let he=D[0];if(["undefined","string","number"].indexOf(typeof he)!==-1)throw new b1("Unexpected token!");return he}catch(D){if(D.message==="timeout")throw D;[v1].forEach(ie=>{if(D instanceof ie){let te=D.column;throw new ie(`${D.message}${te?`: ${te}`:""}`)}});let he=D.column;throw new D1(`${D.message}${he?`: ${he}`:""}`)}};function Se(s){this.type=s.type,this.value=s.value,this.left=s.left,this.right=s.right}Se.prototype.toString=function(){let r=this.left?`${this.left.toString()}---`:"",a=this.right?`---${this.right.toString()}`:"";return`${r}(${this.value})${a}`},Se.prototype.toHTML=function(r,a){r||=0,a=typeof a>"u"?4:a;let D=function(Ne){return" ".repeat(a*Ne)},k="",he=this.left?`${D(r+1)}<li>
${this.left.toHTML(r+2,a)}${D(r+1)}</li> 
`:"",ie=this.right?`${D(r+1)}<li>
${this.right.toHTML(r+2,a)}${D(r+1)}</li>
`:"";return k=`${D(r)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${D(r)}
`,(he||ie)&&(k+=`${D(r)}<ul>
${he}${ie}${D(r)}</ul>
`),k},this.tree=function(r){let a=[];for(let D=0;D<r.length;D++){let k=r[D];if(Array.isArray(k)){k=this.tree(k),a.push(k);continue}if(k.type===h.OPERATOR)if(k.is_prefix||k.postfix){let he=k.is_prefix?"left":"right",ie=a.pop();k=new Se(k),k[he]=ie,a.push(k)}else k=new Se(k),k.right=a.pop(),k.left=a.pop(),a.push(k);else if(k.type===h.FUNCTION){k=new Se(k);let he=a.pop();if(k.right=he,k.value==="object"){let ie=a[a.length-1];if(ie){for(;ie.right;)ie=ie.right;ie.right=k;continue}}a.push(k)}else a.push(new Se(k))}return a[0]},this.parse=function(r,a){r=de(r,this),a||={};let D=this.tokenize(r),k=this.toRPN(D);return this.parseRPN(k,a)},this.toObject=function(r){return function D(k){let he=[];for(let ie=0,te=k.length;ie<te;ie++){let Ne=k[ie],Ee=Ne.value;if(Ne.type===h.VARIABLE_OR_LITERAL)he.push(new N(Ee));else if(Ne.type===h.FUNCTION){ie++;let qe=u.symfunction(Ee,D(k[ie]));qe.isConversion=!0,he.push(qe)}else Ne.type===h.OPERATOR?he.push(Ee):he.push(D(Ne))}return he}(u.tokenize(r))};let ke=function(r){let a=0,D=[[]];for(let k=0,he=r.length;k<he;k++)r[k]===","?(a++,D[a]=[]):D[a].push(r[k]);return D},be=function(s){return s.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(r,a)=>a||r)},Pe=function(s){let r=[];for(;s.length;){let a=s.shift(),D=s[0],k=Pt(D),he=D==="-";if(a==="^"&&(D==="+"?s.shift():k&&D[0]==="+"&&D.shift(),k&&D.length===1&&s.unshift(s.shift()[0])),a==="^"&&(k&&D[0]==="-"||he)){let ie=r.pop(),te=r[r.length-1],Ne="1";te==="*"?(r.pop(),Ne=r.pop()):Pt(te)&&(Ne=r.pop()),r.push(Ne,"/",ie,a),k?D.shift():s.shift(),k&&D.length===1&&r.push(s.shift()[0])}else r.push(a)}return r};this.toTeX=function(r,a){a||={};let D=a.decimals===!0?"decimals":void 0,k=typeof r=="string"?this.toObject(r):r,he=[],ie=typeof a.cdot>"u"?"\\cdot":a.cdot;if(k=Pe(k),Pt(k)){let te=[],Ne,Ee;for(let qe=0;qe<k.length;qe++)Ne=k[qe],k[qe+1]==="^"?(Ee=k[qe+2],te.push(`${se.braces(this.toTeX([Ne]))}^${se.braces(this.toTeX([Ee]))}`),qe+=2):te.push(Ne);k=te}for(let te=0,Ne=k.length;te<Ne;te++){let Ee=k[te];if(Ee==="*"&&(Ee=ie),ue(Ee))if(Ee.group===Xe){let{fname:qe}=Ee,ve;if(qe===l)ve=`\\sqrt${se.braces(this.toTeX(Ee.args))}`;else if(qe===S)ve=se.brackets(this.toTeX(Ee.args),"abs");else if(qe===Y)ve=se.brackets(this.toTeX(Ee.args),"parens");else if(qe===V.LOG10)ve=`\\${V.LOG10_LATEX}\\left( ${this.toTeX(Ee.args)}\\right)`;else if(qe===V.LOG2)ve=`\\${V.LOG2_LATEX}\\left( ${this.toTeX(Ee.args)}\\right)`;else if(qe===V.LOG1P)ve=`\\${kt(V.LOG1P_LATEX,this.toTeX(Ee.args))}`;else if(qe==="integrate"){let Ze=ke(Ee.args),wt=se.braces(this.toTeX(Ze[0])),Et=this.toTeX(Ze[1]);ve=`\\int ${wt}\\, d${Et}`}else if(qe==="defint"){let Ze=ke(Ee.args),wt=se.braces(this.toTeX(Ze[0])),Et=this.toTeX(Ze[3]),Ye=this.toTeX(Ze[1]),Ue=this.toTeX(Ze[2]);ve=`\\int\\limits_{${Ye}}^{${Ue}} ${wt}\\, d${Et}`}else if(qe==="diff"){let Ze=ke(Ee.args),wt="",Et=se.braces(this.toTeX(Ze[0]));if(Ze.length===1){let Ye=[];for(let Ue=0;Ue<Ze[0].length;Ue++)Ze[0][Ue].group===3&&Ye.push(Ze[0][Ue].value);Ye.sort(),wt=Ye.length>0?`\\frac{d}{d ${Ye[0]}}`:"\\frac{d}{d x}"}else Ze.length===2?wt=`\\frac{d}{d ${Ze[1]}}`:wt=`\\frac{d^{${Ze[2]}}}{d ${this.toTeX(Ze[1])}^{${Ze[2]}}}`;ve=`${wt}\\left(${Et}\\right)`}else if(qe==="sum"||qe==="product"){let Ze=[[],[],[],[]],wt=0;for(let Et=0;Et<Ee.args.length;Et++){if(Ee.args[Et]===","){wt++;continue}Ze[wt].push(Ee.args[Et])}ve=(qe==="sum"?"\\sum_":"\\prod_")+se.braces(`${this.toTeX(Ze[1])} = ${this.toTeX(Ze[2])}`),ve+=`^${se.braces(this.toTeX(Ze[3]))}${se.braces(this.toTeX(Ze[0]))}`}else if(qe==="limit"){let Ze=this.toTeX.bind(this),wt=u,Et=ke(Ee.args).map(Ye=>Array.isArray(Ye)?wt.toTeX(Ye.join("")):Ze(String(Ye)));ve=`\\lim_${se.braces(`${Et[1]}\\to ${Et[2]}`)} ${se.braces(Et[0])}`}else qe===o||qe===w?ve=this.toTeX(Ee.args)+(qe===o?"!":"!!"):ve=se.latex(Ee,D);he.push(ve)}else he.push(se.latex(Ee,D));else Pt(Ee)?he.push(se.brackets(this.toTeX(Ee))):Ee==="/"?he.push(se.frac(be(he.pop()),be(this.toTeX([k[++te]])))):he.push(Ee)}return he.join(" ")};function Je(s){return V.PARSE2NUMBER?s:u.symfunction("parens",[s])}function De(s){if(s.isInfinity)return N.infinity();if(s.multiplier.lessThan(0)&&s.multiplier.negate(),s.isImaginary()){let a=s.realpart(),D=s.imagpart();if(a.isConstant()&&D.isConstant())return rt(u.add(u.pow(a,new N(2)),u.pow(D,new N(2))))}else{if(U0(s)||bt(s.power))return s;if(V1(s)&&typeof s.value=="string"&&s.value.startsWith("baseunit_"))return s}if(s.isComposite()){let a=[];s.each(k=>{a.push(k.multiplier)}),U.QGCD.apply(null,a).lessThan(0)&&(s.multiplier=s.multiplier.multiply(new Ge(-1)),s.distributeMultiplier())}let r=u.parse(s.multiplier);return s.toUnitMultiplier(),u.multiply(r,u.symfunction(S,[s]))}function Qe(s){let r;if(ae(s)){let a=new It;return s.each((D,k)=>{a.set(k-1,Qe(D))}),a}if(Re(s)){let a=new vt;return s.each((D,k,he)=>{a.set(k,he,Qe(D))}),a}if(V.PARSE2NUMBER&&s.isConstant())return Mt(s)?r=U.bigfactorial(s):r=U.gamma(s.multiplier.add(new Ge(1)).toDecimal()),r=Zt(r),r;if(s.isConstant()&&s.getDenom().equals(2)){let D=s.getNum(),k,he,ie;s.multiplier.isNegative()?(ie=u.subtract(D.negate(),new N(1)).multiplier.divide(new Ge(2)),k=u.pow(new N(-4),new N(ie)).multiplier.multiply(U.bigfactorial(ie)),he=U.bigfactorial(new Ge(2).multiply(ie))):(ie=u.add(D,new N(1)).multiplier.divide(new Ge(2)),k=U.bigfactorial(new Ge(2).multiply(ie)),he=u.pow(new N(4),new N(ie)).multiplier.multiply(U.bigfactorial(ie)));let te=k.divide(he);return u.multiply(u.parse("sqrt(pi)"),new N(te))}return u.symfunction(o,[s])}function ot(s,r){let a=qt(s);if(a.isConstant()){let D=U.continuedFraction(a,r),k=It.fromArray(D.fractions.map(he=>new N(he)));return It.fromArray([new N(D.sign),new N(D.whole),k])}return u.symfunction("continuedFraction",[s,r])}function mt(s){let r=qt(s);return r.isConstant()?new N(U.erf(r)):r.isImaginary()?v.erf(s):u.symfunction("erf",[s])}function yt(s,r){if(s.isConstant()&&r.isConstant()){let D=new N(1);return D.multiplier=D.multiplier.multiply(s.multiplier.mod(r.multiplier)),D}let a=u.divide(s.clone(),r.clone());return Mt(a)?new N(0):u.symfunction("mod",[s,r])}function _t(s,r,a){return typeof s!="boolean"&&U0(s)&&(s=!!Number(s)),s?r:a}function Lt(s,r){if(Re(s)){for(let a=0,D=s.rows();a<D;a++)for(let k=0,he=s.cols();k<he;k++)if(s.elements[a][k].equals(r))return new N(1)}else if(s.elements){for(let a=0,D=s.elements.length;a<D;a++)if(s.elements[a].equals(r))return new N(1)}return new N(0)}function Gt(s){return V.PARSE2NUMBER?s.isConstant()?new N(U.sinc(s)):u.parse(kt("sin({0})/({0})",s)):u.symfunction("sinc",[s])}function i0(s){return s.fname===V.LOG&&s.isLinear()?u.pow(s.args[0],N.create(s.multiplier)):u.parse(kt("e^({0})",s))}function t0(s){return u.parse(kt("({0})*pi/180",s))}function r0(s){return u.parse(kt("({0})*180/pi",s))}function a0(s){let r,a,D;if(s.group===Xe&&s.fname===""?(r=N.unwrapPARENS(u.parse(s).toLinear()),a=u.parse(s.power)):s.group===Ae&&(r=u.parse(s.value),a=u.parse(s.power)),r&&a&&r.group===ye&&a.group===ye){D=[];let k=N.toPolarFormArray(s),he=u.parse(r).abs().toString(),ie=T(r).toString(),te=a.multiplier.den.toString(),Ne=a.multiplier.num.toString(),Ee="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let qe=0;qe<Number(te);qe++){let ve=qt(u.parse(kt("(({0})+2*pi*({1}))/({2})",ie,qe,te))).multiplier.toDecimal();D.push(qt(u.parse(kt(Ee,he,te,V.IMAGINARY,ve,Ne))))}return It.fromArray(D)}if(s.isConstant(!0)){let k=s.sign(),he=qt(s.abs()),ie=u.sqrt(he);D=[ie.clone(),ie.negate()],k<0&&(D=D.map(te=>u.multiply(te,N.imaginary())))}else D=[u.parse(s)];return It.fromArray(D)}function S0(s){if(s.isComposite()){let r=new N(0),a,D,k,he,ie,te,Ne,Ee;return s.each(qe=>{a=qe.getNum(),D=qe.getDenom(),k=r.getNum(),he=r.getDenom(),ie=u.multiply(D,k),te=u.multiply(a,he),Ne=u.expand(u.add(ie,te)),Ee=u.multiply(he,D),r=u.divide(Ne,Ee)},!0),r}return s}function rt(s){ue(s)||(s=u.parse(s));let r=u.symfunction("sqrt",[s]);if(s.group===Le)return u.symfunction(l,[s]);s.fname===""&&s.power.equals(1)&&(s=s.args[0]);let a=s.multiplier.sign()<0;if(V.PARSE2NUMBER){if(s.isConstant()&&!a)return new N(z.sqrt(s.multiplier.toDecimal()));if(s.isImaginary())return v.sqrt(s);if(s.group===ee)return u.symfunction("sqrt",[s])}let D,k,he=s.isConstant();if(s.group===_e&&s.isLinear()){let ie=rt(new N(s.multiplier));for(let te in s.symbols){if(!Object.hasOwn(s.symbols,te))continue;let Ne=s.symbols[te];ie=u.multiply(ie,rt(Ne))}k=ie}else if(s.fname===l){let ie=s.args[0],te=s.multiplier;ie.setPower(s.power.multiply(new Ge(.25))),k=ie,te.equals(1)||(k=u.multiply(rt(u.parse(te)),k))}else if(!s.power.isInteger())s.setPower(s.power.multiply(new Ge(.5))),k=s;else if(Number(s.multiplier)<0&&s.group===ee){let ie=u.parse(s.multiplier).negate(),te=u.parse(s).toUnitMultiplier().negate();k=u.multiply(u.symfunction(V.SQRT,[te]),rt(ie))}else{let ie=s.power.sign();s.power=s.power.abs(),he&&s.multiplier.lessThan(0)&&(D=N.imaginary(),s.multiplier=s.multiplier.abs());let te=Number(s.multiplier.toDecimal()),Ne=Math.abs(te),Ee=Math.sqrt(Ne),qe;if(Mt(Ee))qe=new N(Ee);else if(Mt(te)){let ve=U.ifactor(te),Ze=1;for(let wt in ve){if(!Object.hasOwn(ve,wt))continue;let Et=ve[wt],Ye=Et-Et%2;if(Ye){let Ue=Number(wt)**Ye;Ze*=Number(wt)**(Ye/2),te/=Ue}}qe=u.multiply(u.symfunction(l,[new N(te)]),new N(Ze))}else{let ve=[new N(s.multiplier.num),new N(s.multiplier.den)],Ze=[new N(1),new N(1)],wt=[new N(1),new N(1)],Et=u;for(let Ye=0;Ye<2;Ye++){let Ue=ve[Ye];M(Ue).each(it=>{it=N.unwrapPARENS(it);let nt=it.clone().toLinear(),ut=Number(it.power),At=ut%2,gt=(ut-At)/2;Ze[Ye]=Et.multiply(Ze[Ye],Et.pow(nt,new N(gt))),wt[Ye]=Et.multiply(wt[Ye],rt(Et.pow(nt,new N(At))))})}qe=u.divide(u.multiply(Ze[0],wt[0]),u.multiply(Ze[1],wt[1]))}s=s.toUnitMultiplier(!0),s.isOne()?k=s:bt(s.power.toString())?k=u.pow(s.clone(),new N(.5)):k=u.symfunction(l,[s]),ie<0&&k.power.negate(),qe&&(k=u.multiply(qe,k)),D&&(k=u.multiply(D,k))}return We&&V.PARSE2NUMBER&&k.text()!==r.text()?u.parse(k):k}function D0(s){if(!s.isConstant(!0)){let r,a=Number(s.power)/3,D=u.pow(u.parse(s.multiplier),new N(1/3)),k=s.toUnitMultiplier();return Mt(a)?r=u.pow(k.toLinear(),u.parse(String(a))):k.group===_e?(r=new N(1),k.each(he=>{r=u.multiply(r,D0(he))})):r=u.symfunction("cbrt",[k]),u.multiply(D,r)}return d(s,new N(3))}function p1(s,r){return s.scientific=r||10,s}function d(s,r,a=void 0,D=void 0){if(r=qt(u.parse(r)),r.equals(0))throw new Kt("Unable to calculate nthroots of zero");if(Number(s)<0&&bt(r))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!s.isConstant(!0)){let te=[s,r];return typeof a<"u"&&te.push(a),typeof D<"u"&&te.push(D),u.symfunction("nthroot",te)}s.group!==ye&&(s=qt(s)),typeof D>"u"&&(D=!0),a||=25;let k=s.sign(),he,ie;if(k<0&&(s=De(s)),Mt(s)&&r.isConstant())return Number(s)<18446744073709552e3?ie=Ge.create(Number(s)**(1/Number(r))):ie=U.nthroot(s,r),D?he=new N(ie):he=new N(ie.toDecimal(a)),u.multiply(new N(k),he)}function M(s){if(s.greaterThan(9999999999998891e26)||s.equals(-1))return s;if(s.equals(Math.PI))return new N(Math.PI);s=qt(s.clone());let r;if(s.isConstant()){r=new N(1);let a=s.toString();if(Mt(a)){let D=U.ifactor(a);for(let k in D){if(!Object.hasOwn(D,k))continue;let he=D[k];r=u.multiply(r,u.symfunction("parens",[new N(k).setPower(new Ge(he))]))}}else{let D=M(new N(s.multiplier.num)),k=M(new N(s.multiplier.den));r=u.multiply(u.symfunction("parens",[D]),u.symfunction("parens",[k]).invert())}}else r=u.symfunction("pfactor",[s]);return r}function I(s){return s.realpart()}function q(s){return s.imagpart()}function R(s){let r=s.realpart(),a=s.imagpart();return u.add(r,u.multiply(a.negate(),N.imaginary()))}function T(s){let r=s.realpart(),a=s.imagpart();return r.isConstant()&&a.isConstant()?a.equals(0)&&r.equals(1)?u.parse("0"):a.equals(1)&&r.equals(0)?u.parse("pi/2"):a.equals(0)&&r.equals(-1)?u.parse("pi"):a.equals(-1)&&r.equals(0)?u.parse("-pi/2"):a.equals(1)&&r.equals(1)?u.parse("pi/4"):a.equals(1)&&r.equals(-1)?u.parse("pi*3/4"):a.equals(-1)&&r.equals(1)?u.parse("-pi/4"):a.equals(-1)&&r.equals(-1)?u.parse("-pi*3/4"):new N(Math.atan2(Number(a),Number(r))):u.symfunction("atan2",[a,r])}function Q(s){let r=N.toPolarFormArray(s),a=r[1],D=r[0],k=u.parse(kt("e^({0}*({1}))",V.IMAGINARY,a));return u.multiply(D,k)}function re(s){let r=s.clone();try{let a=Be(s,"e",!0),D=u.divide(a.x.power,N.imaginary()),k=qt(A.tan(D)),he=u.pow(a.a,new N(2)),ie=k.getDenom(!0),te=k.getNum();return N.hyp(te,ie).equals(a.a)?u.add(ie,u.multiply(N.imaginary(),te)):r}catch(a){if(a.message==="timeout")throw a;return r}}function ge(s,r){r.forEach(te=>{te.numVal=qt(te).multiplier});let a,D,k,he,ie;for(;;){if(a=r.length,a<2)return r[0];D=r.pop(),k=r[a-2],(s==="min"?D.numVal<k.numVal:D.numVal>k.numVal)&&(r.pop(),r.push(D))}}function oe(...s){return t1(s)?s[0]:N1(s)?new N(Math.max.apply(null,s)):V.SYMBOLIC_MIN_MAX&&Z(s)?ge("max",s):u.symfunction("max",s)}function Me(...s){return t1(s)?s[0]:N1(s)?new N(Math.min.apply(null,s)):V.SYMBOLIC_MIN_MAX&&Z(s)?ge("min",s):u.symfunction("min",s)}function Ce(s){return s.isConstant(!0)?new N(Math.sign(qt(s))):u.symfunction("sign",[s])}function $e(s,r){r=r?r.toString():"asc";let a=function(k){return k.group===ye?k.multiplier:k.group===Xe?k.fname===""?a(k.args[0]):k.fname:k.group===ee?k.power:k.value},D=ae(s)?s.elements:s.collectSymbols();return new It(D.sort((k,he)=>{let ie=a(k),te=a(he);return r==="desc"?te-ie:ie-te}))}function Ke(s,r=void 0){if(s.equals(1))return new N(0);let a;if(s.fname===l&&s.multiplier.equals(1))return a=u.divide(Ke(s.args[0]),new N(2)),s.power.sign()<0&&a.negate(),a;if(s.equals(0))throw new Kt(`${V.LOG}(0) is undefined!`);if(s.isImaginary())return v.evaluate(s,V.LOG);if(s.isConstant()&&typeof r<"u"&&r.isConstant()){let D=Math.log(s),k=Math.log(r);a=new N(D/k)}else if(s.group===Le&&s.power.multiplier.lessThan(0)||s.power.toString()==="-1")s.power.negate(),a=Ke(s).negate();else if(s.value==="e"&&s.multiplier.equals(1)){let D=s.power;a=ue(D)?D:new N(D)}else if(s.group===Xe&&s.fname==="exp"){let D=s.args[0];s.multiplier.equals(1)?a=u.multiply(D,new N(s.power)):a=u.symfunction(V.LOG,[s])}else if(V.PARSE2NUMBER&&U0(s)){s=u.parse(s);let D;s.multiplier.lessThan(0)&&(s.negate(),D=u.multiply(new N(Math.PI),new N("i"))),a=new N(Math.log(s.multiplier.toDecimal())),D&&(a=u.add(a,D))}else{let D;!s.power.equals(1)&&!s.contains("e")&&s.multiplier.isOne()&&(D=s.group===Le?s.power:new N(s.power),s.toLinear());let k=typeof r>"u"?[s]:[s,r];k.length>1&&t1(k)?a=new N(1):a=u.symfunction(V.LOG,k),D&&(a=u.multiply(D,a))}return a}function Nt(s,r){let a=r&&r.isConstant()||typeof r>"u";if(s.isConstant()&&a){let k,he,ie;k=s,r&&r.lessThan(0)&&(r=De(r),he=Number(s).toExponential().toString().split("e"),k=he[0],ie=he[1]);let te=new N(A0(Number(k),Number(r)||0));return u.multiply(te,u.pow(new N(10),new N(ie||0)))}let D=[s];return typeof r<"u"&&D.push(r),u.symfunction("round",D)}function ct(s){let r=Number(s)%2,a;return r<0&&(r=2+r),r>=0&&r<=.5?a=1:r>.5&&r<=1?a=2:r>1&&r<=1.5?a=3:a=4,a}function Zt(s){if(!isFinite(s)){let a=Math.sign(s),D=new N(String(Math.abs(s)));return D.multiplier=D.multiplier.multiply(new Ge(a)),D}if(ue(s))return s;if(typeof s=="number")try{s=Ge.simple(s)}catch(a){if(a.message==="timeout")throw a;s=new Ge(s)}let r=new N(0);return r.multiplier=s,r}function Ut(s){let r=s.group,a;if(r===He){let D=s.getNum(),k=s.getDenom()||new N(1),he=Number(s.power),ie=new N(1);if(Math.abs(he)===1){k.each(Ee=>{Ee.group===_e?ie=u.multiply(ie,Ut(Ee.getDenom())):Ee.power.lessThan(0)&&(ie=u.multiply(ie,Ut(Ee.clone().toUnitMultiplier())))});let te=new N(0);k.each(Ee=>{te=u.add(u.divide(Ee,ie.clone()),te)}),ie.invert();let Ne;D.isComposite()?(Ne=new N(0),D.each(Ee=>{Ne=u.add(u.multiply(Ut(Ee),ie.clone()),Ne)})):Ne=u.multiply(ie,D),a=u.divide(Ne,te)}}else r===_e?(a=new N(1),s.each(D=>{a=u.multiply(a,u.clean(D))})):r===Xe&&s.args.length===1&&s.args[0].isConstant()&&(a=l0("PARSE2NUMBER",()=>u.parse(s),!0));return a||=s,a}function s0(s,r){return r||={expand_denominator:!0,expand_functions:!0},dt(s,r)}function dt(s,r){if(Array.isArray(s))return s.map(D=>dt(D,r));if(s.expand)return s.expand(r);if(r||={},s.group===Xe&&s.fname===""){let D=dt(s.args[0],r),k=dt(u.pow(D,u.parse(s.power)),r);return u.multiply(u.parse(s.multiplier),k).distributeMultiplier()}if([ye,Ae,ee].indexOf(s.group)!==-1)return s;let a=s.clone();try{let D=s.multiplier.toString(),k=Number(s.power),he=s;if(s.isComposite()&&Mt(s.power)&&s.power>0){let ie=k-1,te=new N(0);s.each(Ee=>{te=u.add(te,dt(u.parse(Ee),r))});let Ne=u.parse(te);for(let Ee=0;Ee<ie;Ee++)Ne=x(Ne,te,r);he=u.multiply(u.parse(D),Ne).distributeMultiplier()}else if(s.group===Xe&&r.expand_functions===!0){let ie=[];s.args.forEach(te=>{ie.push(dt(te,r))}),he=u.pow(u.symfunction(s.fname,ie),u.parse(s.power)),he=u.multiply(he,u.parse(s.multiplier))}else if(s.isComposite()&&Mt(s.power)&&s.power<0&&r.expand_denominator===!0)s=s.invert(),he=dt(s,r),he.invert();else if(s.group===_e){let ie=function(Ee){switch(Ee.group){case He:return 0;case Fe:return 1;case _e:return 2;case Xe:return 3;default:return 4}},te=s.collectSymbols().sort((Ee,qe)=>ie(qe)-ie(Ee)).map(Ee=>{let qe=u.pow(Ee,u.parse(String(k)));return dt(qe,r)}),Ne=te.pop();Ne.isComposite()&&Ne.isLinear()?(te.forEach(Ee=>{Ne=x(Ne,Ee,r)}),Ne.isComposite()?(Ne.power>1&&(Ne=dt(u.pow(Ne,u.parse(Ne.power)),r)),he=u.multiply(u.parse(D),Ne).distributeMultiplier()):he=Ne):(he=Ne,te.forEach(Ee=>{he=u.multiply(he,Ee)}),he=u.multiply(he,u.parse(D)).distributeMultiplier()),he.group===_e&&(he=u.parse(he))}else he=s;return he}catch(D){if(D.message==="timeout")throw D;return a}}function zt(s){return vt.identity(s)}function O0(s,r){return r.isConstant()&&Mt(r)?s.elements[Number(r)]:u.symfunction("vecget",[s,r])}function u0(s,r){return r=typeof r>"u"?1e-14:r,s=s.clone(),r=Number(r),s.elements.sort((a,D)=>D.group-a.group),s.elements=Wn(s.elements,(a,D)=>Number(u.subtract(qt(a),qt(D)).abs())<=r),s}function P0(s,r,a){return r.isConstant?(s.elements[Number(r)]=a,s):u.symfunction("vecset",[s,r,a])}function C0(s,r,a){return r.isConstant()&&a.isConstant()?s.elements[Number(r)][Number(a)]:u.symfunction("matget",[s,r,a])}function M0(s,r){return r.isConstant()?new vt(s.elements[r]):u.symfunction("matgetrow",[s,r])}function b0(s,r,a){if(!r.isConstant())return u.symfunction("matsetrow",[s,r,a]);if(s.elements[Number(r)].length!==a.elements.length)throw new y1("Matrix row must match row dimensions!");let D=s.clone();return D.elements[Number(r)]=a.clone().elements,D}function o0(s,r){if(!r.isConstant())return u.symfunction("matgetcol",[s,r]);let a=Number(r),D=vt.fromArray([]);return s.each((k,he,ie)=>{ie===a&&D.elements.push([k.clone()])}),D}function T0(s,r,a){if(!r.isConstant())return u.symfunction("matsetcol",[s,r,a]);let D=Number(r);if(s.rows()!==a.elements.length)throw new y1("Matrix column length must match number of rows!");return a.each(((k,he)=>{s.set(he-1,D,k.elements[0].clone())})),s}function R0(s,r,a,D){return s.elements[r][a]=D,s}function F0(...s){return new It(s)}function Wt(...s){return vt.fromArray(s)}function xt(...s){return p0.fromArray(s)}function Sn(s){return Re(s)?s.determinant():s}function vn(s){let r;return Re(s)?r=[new N(s.cols()),new N(s.rows())]:ae(s)||F1(s)?r=new N(s.elements.length):Ht("size expects a matrix or a vector"),r}function yn(s,r){return Re(s)&&(s=new It(s)),Re(r)&&(r=new It(r)),ae(s)&&ae(r)?s.dot(r):u.multiply(s.clone(),r.clone())}function En(s,r){return Re(s)&&(s=new It(s)),Re(r)&&(r=new It(r)),ae(s)&&ae(r)?s.cross(r):u.multiply(s.clone(),r.clone())}function Nn(s){return Re(s)?s.transpose():Ht("function transpose expects a matrix")}function Mn(s){return Re(s)?s.invert():Ht("invert expects a matrix")}function An(s,r){return s.union(r)}function _n(s,r){return s.intersection(r)}function In(s,r){return s.contains(r)}function qn(s,r){return s.difference(r)}function On(s,r){return new N(Number(s.intersects(r)))}function Cn(s,r){return new N(Number(s.isSubset(r)))}function Tn(s,r){r??=s;let a=we.slice(s,r).map(D=>new N(D));return a.length===1?a[0]:a.length===0?new N(0):new It(a)}function Rn(...s){s.forEach(r=>{console.log(r.toString())})}function h1(s){if(!ue(s.power)&&s.power.absEquals(.5)){let r=s.power.sign(),a=rt(s.group===Ae?new N(s.value):s.toLinear());return r<0&&a.invert(),a}return s}function Ln(s){if(s.group===Ae){let r=s.value,a=ki(r)[0];if(!a)return M1("Unable to compute prime factors. This should not happen. Please review and report."),s;let k=new Ge(Math.log(r)/Math.log(a)).multiply(s.power);if(k.den>s.power.den)return s;Mt(k)?s=new N(a**Number(k)):s=new N(a).setPower(k)}return s}this.expand=dt,this.round=Nt,this.clean=Ut,this.sqrt=rt,this.cbrt=D0,this.abs=De,this.log=Ke,this.rationalize=S0,this.nthroot=d,this.arg=T,this.conjugate=R,this.imagpart=q,this.realpart=I,this.getFunction=function(r){return ne[r][0]},this.addPreprocessor=function(r,a,D,k){let{names:he}=c,{actions:ie}=c;if(typeof a!="function")throw new Error("Incorrect parameters. Function expected!");D?k?(he.splice(D,0,r),ie.splice(D,0,a)):(he[D]=r,ie[D]=a):(he.push(r),ie.push(a))},this.getPreprocessors=function(){let r={};for(let a=0,D=c.names.length;a<D;a++){let k=c.names[a];r[k]={order:a,action:c.actions[a]}}return r},this.removePreprocessor=function(r,a){let D=c.names.indexOf(r);a?(_0(c.names,D),_0(c.actions,D)):(c.names[D]=void 0,c.actions[D]=void 0)},this.mappedFunction=function(...r){let a={},{params:D}=this;for(let k=0;k<D.length;k++)a[D[k]]=String(r[k]);return u.parse(this.body,a)},this.add=function(r,a){let D=ue(r),k=ue(a);if(D&&k){if(r.unit||a.unit)return u.Unit.add(r,a);if(r.isInfinity||a.isInfinity){let gt=r.multiplier.lessThan(0),$t=a.multiplier.lessThan(0);if(r.isInfinity&&a.isInfinity&&gt!==$t)throw new Kt(`(${r})+(${a}) is not defined!`);let Qt=N.infinity();return $t&&Qt.negate(),Qt}if(r.isComposite()&&r.isLinear()&&a.isComposite()&&a.isLinear()&&(r.distributeMultiplier(),a.distributeMultiplier(),a.length>r.length&&r.group===a.group&&([r,a]=[a,r])),r.multiplier.equals(0))return a;if(a.multiplier.equals(0))return r;if(r.isConstant()&&a.isConstant()&&V.PARSE2NUMBER)return new N(r.multiplier.add(a.multiplier).toDecimal(V.PRECISION));let ie=r.group,te=a.group,Ne=r.power.toString(),Ee=a.power.toString();if(ie<te||ie===te&&Number(Ne)>Number(Ee)&&Number(Ee)>0)return this.add(a,r);if(ie===_e&&te===Fe&&r.value===a.value){let gt=r;r=a,a=gt,ie=r.group,te=a.group,Ne=r.power.toString(),Ee=a.power.toString()}let qe=Ne===Ee,ve=r.value,Ze=a.value,wt=r.isComposite(),Et=a.isComposite(),Ye,Ue,it;if(wt&&(Ye=C(r,"hash")),Et&&(Ue=C(a,"hash")),ie===He&&te===He&&a.isLinear()&&!r.isLinear()&&Ye!==Ue)return this.add(a,r);ie===Fe&&te===Fe&&(ve=Ye,Ze=Ue);let nt=ie===Ae&&te===ye,ut=r.value===a.multiplier.toString(),At=ve===Ze||Ye===Ue&&Ye!==void 0||nt&&ut;if(At&&qe&&ie===te)if(nt&&(a=a.convert(Ae)),ie===Fe&&(te===ee||te===Ae))r.distributeMultiplier(),it=r.attach(a);else if(it=r,r.multiplier.isOne()&&a.multiplier.isOne()&&ie===He&&r.isLinear()&&a.isLinear())for(let gt in a.symbols){if(!Object.hasOwn(a.symbols,gt))continue;let $t=a.symbols[gt];it.attach($t)}else it.multiplier=it.multiplier.add(a.multiplier);else if(At&&ie!==Fe)ie===He&&te===Fe?(a.insert(r,"add"),it=a):(it=N.shell(Fe).attach([r,a]),it.value=ie===Fe?Ye:ve);else if(wt&&r.isLinear()){let gt=ie===te,$t=ie===Fe&&te===Fe;if($t&&(gt=r.value===a.value),r.distributeMultiplier(),a.isComposite()&&a.isLinear()&&gt){a.distributeMultiplier();for(let Qt in a.symbols){if(!Object.hasOwn(a.symbols,Qt))continue;let h0=a.symbols[Qt];r.attach(h0)}it=r}else $t&&r.value!==Ue||ie===Fe&&!At?(it=N.shell(He).attach([r,a]),it.updateHash()):it=r.attach(a)}else{if(ie===Xe&&r.fname===l&&te!==Le&&a.power.equals(.5)){let gt=a.multiplier.clone();a=rt(a.toUnitMultiplier().toLinear()),a.multiplier=gt}r.length===2&&a.length===2&&bt(r.power)&&bt(a.power)?it=u.add(dt(r),dt(a)):(it=N.shell(He).attach([r,a]),it.updateHash())}if(it.multiplier.equals(0)&&(it=new N(0)),it.length===1){let gt=it.multiplier;it=i1(it.symbols),it.multiplier=it.multiplier.multiply(gt)}return it}if(k&&!D){let ie=r;r=a,a=ie,ie=k,k=D,D=ie}let he=Re(a);if(D&&he){let ie=new vt;a.eachElement((te,Ne,Ee)=>{ie.set(Ne,Ee,u.add(r.clone(),te))}),a=ie}else if(Re(r)&&he)a=r.add(a);else if(D&&ae(a))a.each((ie,te)=>{te--,a.elements[te]=u.add(r.clone(),a.elements[te])});else if(ae(r)&&ae(a))a.each((ie,te)=>{te--,a.elements[te]=u.add(r.elements[te],a.elements[te])});else{if(ae(r)&&Re(a))return u.add(a,r);if(Re(r)&&ae(a)){if(a.elements.length===r.rows()){let ie=new vt,te=r.cols();return a.each((Ne,Ee)=>{let qe=[];if(ae(Ne))for(let ve=0;ve<te;ve++)qe.push(u.add(r.elements[Ee-1][ve].clone(),Ne.elements[ve].clone()));else for(let ve=0;ve<te;ve++)qe.push(u.add(r.elements[Ee-1][ve].clone(),Ne.clone()));ie.elements.push(qe)}),ie}Ht("Dimensions must match!")}}return a},this.subtract=function(r,a){let D=ue(r),k=ue(a),he;if(D&&k){let ie=r,te=a;return ie.unit||te.unit?u.Unit.subtract(ie,te):this.add(ie,te.negate())}if(k&&ae(r))a=r.map(ie=>u.subtract(ie,a.clone()));else if(D&&ae(a))a=a.map(ie=>u.subtract(r.clone(),ie));else if(ae(r)&&ae(a)||E1(r)&&E1(a))r.dimensions()===a.dimensions()?a=r.subtract(a):u.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(Re(r)&&ae(a)){if(a.elements.length===r.rows()){let ie=new vt,te=r.cols();return a.each((Ne,Ee)=>{let qe=[];for(let ve=0;ve<te;ve++)qe.push(u.subtract(r.elements[Ee-1][ve].clone(),Ne.clone()));ie.elements.push(qe)}),ie}Ht("Dimensions must match!")}else if(ae(r)&&Re(a)){let ie=a.clone().negate();return u.add(ie,r)}else if(Re(r)&&Re(a))a=r.subtract(a);else if(Re(r)&&k){let ie=new vt;r.each((te,Ne,Ee)=>{ie.set(Ne,Ee,u.subtract(te,a.clone()))}),a=ie}else if(D&&Re(a)){let ie=new vt;a.each((te,Ne,Ee)=>{ie.set(Ne,Ee,u.subtract(r.clone(),te))}),a=ie}return a},this.multiply=function(r,a){let D=ue(r),k=ue(a);if(D&&a instanceof Dt)return a.elements.push(r),a;if(D&&k){if(a.isUnit){let nt=r.clone();return r.unit=a,nt}if(r.unit||a.unit)return u.Unit.multiply(r,a);if(r.isInfinity||a.isInfinity){if(r.equals(0)||a.equals(0))throw new Kt(`${r}*${a} is undefined!`);if(a.power.lessThan(0)){if(!r.isInfinity)return new N(0);throw new Kt("Infinity/Infinity is not defined!")}let nt=r.multiplier.multiply(a.multiplier).sign(),ut=N.infinity();if(r.isConstant()||a.isConstant()||r.isInfinity&&a.isInfinity)return nt<0&&ut.negate(),ut}if(r.multiplier.equals(0)||a.multiplier.equals(0))return new N(0);if(r.isOne())return a.clone();if(a.isOne())return r.clone();if(r.isConstant()&&a.isConstant()&&V.PARSE2NUMBER){let nt,ut=r.multiplier.num.abs().toString().length,At=r.multiplier.den.toString().length,gt=ut-At,$t=a.multiplier.num.abs().toString().length,Qt=a.multiplier.den.toString().length,h0=$t-Qt,St=V.PRECISION-5;if(gt<-St||gt>St||h0<-St||h0>St){let Tt=new z(String(r.multiplier.num)),Jt=new z(String(r.multiplier.den)),B0=new z(String(a.multiplier.num)),v0=new z(String(a.multiplier.den));nt=new N(Tt.times(B0).dividedBy(Jt).dividedBy(v0).toFixed())}else{let Tt=new z(r.multiplier.toDecimal()),Jt=new z(a.multiplier.toDecimal()),B0=Tt.times(Jt).toFixed();nt=new N(B0)}return nt}if(a.group>r.group&&a.group!==He)return this.multiply(a,r);if(r.group===_e&&a.group===Fe&&r.value===a.value){let nt=r;r=a,a=nt}let te=r.group,Ne=a.group,Ee=a.multiplier.num,qe=a.multiplier.den;if(te===Xe&&r.fname===l&&!a.isConstant()&&r.args[0].value===a.value&&!r.args[0].multiplier.lessThan(0)){let nt=r.power,ut=u.parse(r.multiplier);r=u.multiply(ut,r.args[0].clone()),r.setPower(new Ge(.5).multiply(nt)),te=r.group}else te===Xe&&r.fname===l&&r.multiplier.equals(1)&&r.power.equals(-1)&&a.isConstant()&&r.args[0].equals(a)&&(r=u.symfunction(l,[a.clone()]),a=new N(1));let ve=r.value,Ze=a.value,wt=new Ge(r.sign()),Et=te===Ae&&Ne===ye&&a.multiplier.equals(r.value),Ye=Et?new Ge(1).multiply(r.multiplier).abs():r.multiplier.multiply(a.multiplier).abs(),Ue=r.clone().toUnitMultiplier();if(a=a.clone().toUnitMultiplier(!0),te===Xe&&Ne===Xe){let nt=r.args[0].clone(),ut=a.args[0].clone();if(r.fname===l&&a.fname===l&&r.isLinear()&&a.isLinear()){let At=u.divide(nt,ut).invert();At.gt(1)&&Mt(At)&&(Ue=u.multiply(r.args[0].clone(),rt(At.clone())),a=new N(1))}else if(r.fname===o&&a.fname===o&&!nt.isConstant()&&!ut.isConstant()&&a.power<0){let At=u.subtract(nt.clone(),ut.clone());if(At.isConstant()){let gt=new N(1);if(At<0){for(let $t=0,Qt=Math.abs(At);$t<=Qt;$t++){let h0=u.add(nt.clone(),new N($t));gt=u.multiply(gt,h0)}Ue=u.multiply(u.pow(nt,new N(r.power)),u.pow(gt,new N(a.power))),a=new N(1)}else{for(let $t=0,Qt=Math.abs(At);$t<=Qt;$t++){let h0=u.add(ut.clone(),new N($t));gt=u.multiply(gt,h0)}Ue=u.multiply(u.pow(gt,new N(r.power)),u.pow(ut,new N(a.power))),a=new N(1)}}}}if(ve===Ze&&te===Fe&&te===Ne&&(ve=r.text("hash"),Ze=a.text("hash")),Ne===Le&&a.previousGroup===Fe&&te===Fe&&(ve=C(r,"hash",Le)),(ve===Ze||Et)&&!(te===Fe&&(Ne===ee||Ne===Ae||Ne===Xe))&&!(te===Fe&&Ne===_e)){let nt=r.power,ut=a.power,At=ue(nt),gt=ue(ut),$t=At||gt;te===Fe&&Ne!==Fe&&a.previousGroup!==Fe&&nt.equals(1)?(Ue=new N(0),r.each(Qt=>{Ue=u.add(Ue,u.multiply(Qt,a.clone()))},!0)):($t?Ue.power=u.add(ue(nt)?nt:new N(nt),ue(ut)?ut:new N(ut)):te===ye?Ue.power=nt:Ue.power=nt.add(ut),Ue.power.equals(0)&&(Ue=Ue.convert(ye)),$t&&Ue.convert(Le),r.imaginary&&a.imaginary&&bt(Number(Ue.power)%2)&&(Ue=new N(1),Ye.negate()),Ue.group!==Le&&Ue.previousGroup&&(Ue.previousGroup=void 0),Ue.multiplier=Ue.multiplier.multiply(a.multiplier))}else if(te===_e&&r.isLinear())if(Ne===_e&&a.distributeExponent(),Ne===_e&&a.isLinear()){for(let nt in a.symbols){if(!Object.hasOwn(a.symbols,nt))continue;let ut=a.symbols[nt];Ue=Ue.combine(ut)}Ue.multiplier=Ue.multiplier.multiply(a.multiplier)}else Ue.combine(a);else if(te===ye)Ue=a.clone().toUnitMultiplier(!0);else if(te===_e)Ue.distributeExponent(),Ue.combine(a);else if(!a.isOne()){let nt=a.multiplier.clone();a.toUnitMultiplier(),Ue=N.shell(_e).combine([Ue,a]),Ue.multiplier=Ue.multiplier.multiply(nt)}if(Ue.group===Ae){let nt=Math.log(Ue.value),ut=Math.log(Ee)/nt,At=Math.log(qe)/nt,gt=Ye.num/Ee,$t=Ye.den/qe;ut!==0&&Mt(ut)&&Mt(gt)&&(Ue.power=Ue.power.add(new Ge(ut)),Ye.num/=Ee),At!==0&&Mt(At)&&Mt($t)&&(Ue.power=Ue.power.subtract(new Ge(At)),Ye.den/=qe)}if(Ue.length===1){let nt=Ue.multiplier;Ue=i1(Ue.symbols),Ue.multiplier=Ue.multiplier.multiply(nt)}let it=Ue.power.toString();if(bt(it)&&Ue.fname===l){wt=wt.multiply(new Ge(Ue.sign()));let nt=Ue.power;Ue=Ue.args[0],Ue=u.multiply(new N(Ye),u.pow(Ue,new N(nt.divide(new Ge(2))))),wt.lessThan(0)&&Ue.negate()}else Ue.multiplier=Ue.multiplier.multiply(Ye).multiply(wt),Ue.group===He&&Ue.isImaginary()&&Ue.distributeMultiplier();return Ue.group===Ae&&Mt(Ue.power.toDecimal())&&(Ue=Ue.convert(ye)),Ue}if(k&&!D){let te=r;r=a,a=te,te=k,k=D,D=te}let he=Re(a),ie=Re(r);if(D&&he){let te=new vt;a.eachElement((Ne,Ee,qe)=>{te.set(Ee,qe,u.multiply(r.clone(),Ne))}),a=te}else if(ie&&he)a=r.multiply(a);else if(D&&ae(a))a.each((te,Ne)=>{Ne--,a.elements[Ne]=u.multiply(r.clone(),a.elements[Ne])});else if(ae(r)&&ae(a))a.each((te,Ne)=>{Ne--,a.elements[Ne]=u.multiply(r.elements[Ne],a.elements[Ne])});else{if(ae(r)&&Re(a))return this.multiply(a,r);if(Re(r)&&ae(a)){if(a.elements.length===r.rows()){let te=new vt,Ne=r.cols();return a.each((Ee,qe)=>{let ve=[];for(let Ze=0;Ze<Ne;Ze++)ve.push(u.multiply(r.elements[qe-1][Ze].clone(),Ee.clone()));te.elements.push(ve)}),te}Ht("Dimensions must match!")}}return a},this.divide=function(r,a){let D=ue(r),k=ue(a);if(D&&k){if(r.unit||a.unit)return u.Unit.divide(r,a);let te;if(a.equals(0))throw new S1("Division by zero not allowed!");return r.isConstant()&&a.isConstant()?(te=r.clone(),te.multiplier=te.multiplier.divide(a.multiplier)):(a.invert(),te=u.multiply(r,a)),te}let he=ae(r),ie=ae(a);if(D&&ie)a=a.map(te=>u.divide(r.clone(),te));else if(he&&k)a=r.map(te=>u.divide(te,a.clone()));else if(he&&ie)r.dimensions()===a.dimensions()?a=a.map((te,Ne)=>u.divide(r.elements[--Ne],te)):u.error("Cannot divide vectors. Dimensions do not match!");else{let te=Re(r),Ne=Re(a);if(te&&k){let Ee=new vt;r.eachElement((qe,ve,Ze)=>{Ee.set(ve,Ze,u.divide(qe,a.clone()))}),a=Ee}else if(D&&Ne){let Ee=new vt;a.eachElement((qe,ve,Ze)=>{Ee.set(ve,Ze,u.divide(r.clone(),qe))}),a=Ee}else if(te&&Ne){let Ee=new vt;r.rows()===a.rows()&&r.cols()===a.cols()?(r.eachElement((qe,ve,Ze)=>{Ee.set(ve,Ze,u.divide(qe,a.elements[ve][Ze]))}),a=Ee):u.error("Dimensions do not match!")}else if(te&&ie)if(r.cols()===a.dimensions()){let Ee=new vt;r.eachElement((qe,ve,Ze)=>{Ee.set(ve,Ze,u.divide(qe,a.elements[ve].clone()))}),a=Ee}else u.error("Unable to divide matrix by vector.")}return a},this.pow=function(r,a){let D=ue(r),k=ue(a);if(D&&k){if(r.unit||a.unit)return u.Unit.pow(r,a);if(r.group===Xe&&r.fname===S&&bt(a)){let Ye=r.multiplier.clone(),Ue=u.pow(r.args[0],a);return Ue.multiplier=Ye,Ue}if(r.isInfinity||a.isInfinity){if(r.isInfinity&&a.isInfinity)throw new Kt(`(${r})^(${a}) is undefined!`);if(r.isConstant()&&a.isInfinity){if(r.equals(0)){if(a.lessThan(0))throw new Kt("0^Infinity is undefined!");return new N(0)}if(r.equals(1))throw new Kt(`1^${a.toString()} is undefined!`);if(a.lessThan(0))return new N(0);if(!r.lessThan(0))return N.infinity()}if(r.isInfinity&&a.isConstant()){if(a.equals(0))throw new Kt(`${r}^0 is undefined!`);return a.lessThan(0)?new N(0):u.multiply(N.infinity(),u.pow(new N(r.sign()),a.clone()))}}let he=r.equals(0),ie=a.equals(0);if(he&&ie)throw new Kt("0^0 is undefined!");if(he&&a.isConstant()&&a.multiplier.greaterThan(0))return new N(0);if(ie)return new N(1);let te=a.isConstant(),Ne=r.isConstant(),Ee=a.isInteger(),qe=r.multiplier,ve=r.clone();if(Ne&&te&&r.equals(0)&&a.lessThan(0))throw new Kt("Division by zero is not allowed!");if(V.PARSE2NUMBER&&Ne&&te&&r.sign()<0&&d1(a)){let Ye=Math.PI*Number(a.multiplier.toDecimal()),Ue=new N(Math.cos(Ye)),it=u.multiply(N.imaginary(),new N(Math.sin(Ye)));return u.add(Ue,it)}if(V.PARSE2NUMBER&&r.isImaginary()&&te&&Mt(a)&&!a.lessThan(0)){let Ye,Ue,it,nt,ut,At=r.realpart(),gt=r.imagpart();if(At.isConstant("all")&&gt.isConstant("all"))return ut=V.USE_BIG?new N(z.atan2(gt.multiplier.toDecimal(),At.multiplier.toDecimal()).times(a.toString())):Math.atan2(Number(gt.multiplier.toDecimal()),Number(At.multiplier.toDecimal()))*Number(a.multiplier.toDecimal()),Ue=new N(ut),Ye=u.pow(N.hyp(At,gt),a),it=u.multiply(Ye.clone(),u.trig.cos(Ue.clone())),nt=u.multiply(Ye,u.trig.sin(Ue)),u.add(it,u.multiply(N.imaginary(),nt))}ve.toUnitMultiplier();let Ze;if(ve.group===Xe&&ve.fname===l&&!te){let Ye=ve.args[0];Ye.multiplyPower(new N(.5)),Ye.multiplier.multiply(ve.multiplier),Ye.multiplyPower(a),ve=Ye}else Ze=qe.sign(),d1(a)&&Ze<0&&(ve.negate(),ve=u.symfunction(Y,[ve]),ve.negate()),ve.multiplyPower(a);let wt,Et;if(Ne&&te&&V.PARSE2NUMBER){let Ye;Ze<0&&(r.negate(),a.multiplier.den.equals(2)?Ye=new N(V.IMAGINARY):Mt(a.multiplier)?bt(a.multiplier)?Ye=new N(1):Ye=new N(-1):bt(a.multiplier.den)?Ye=u.pow(u.symfunction(Y,[new N(Ze)]),a.clone()):Ye=new N(Ze**a.multiplier.num));let Ue=Number(r.multiplier.toDecimal())**Number(a.multiplier.toDecimal());if(Ue!==0||r.multiplier.equals(0))ve=new N(Ue);else{let it=new z(r.multiplier.toDecimal()),nt=new z(a.multiplier.toDecimal());ve=new N(it.pow(nt).toFixed())}Ye&&(ve=u.multiply(ve,Ye))}else if(Ee&&!qe.equals(1)){if(a.abs().gt(V.MAX_EXP))return a.sign()<0?new N(0):N.infinity();let Ue=a.multiplier.toDecimal(),it=Math.sign(Number(Ue)),nt=Math.abs(Number(Ue)),ut=new Ge(1);ut.num=qe.num.pow(nt),ut.den=qe.den.pow(nt),it<0&&ut.invert(),ve.multiplier=ve.multiplier.multiply(ut)}else{let Ye=r.sign();if(a.isConstant()&&r.isConstant()&&!a.multiplier.den.equals(1)&&Ye<0)if(a.multiplier.den.equals(2)){let Ue=new N(V.IMAGINARY);r.negate(),a.lessThan(0)&&(Ue.negate(),a.negate()),ve=u.multiply(u.pow(r,a),Ue)}else{let Ue=r.clone();Ue.multiplier.negate(),ve=u.pow(u.symfunction(Y,[new N(Ze)]),a.clone());let it=u.pow(new N(Ue.multiplier.num),a.clone()),nt=u.pow(new N(Ue.multiplier.den),a.clone()),ut=u.divide(it,nt);ve=u.multiply(ve,ut)}else if(V.PARSE2NUMBER&&a.isImaginary()){let Ue=a.realpart(),it=a.imagpart(),nt=r.clone().toLinear(),ut=u.pow(nt.clone(),Ue),At=Ke(nt.clone()),gt=A.cos(u.multiply(it.clone(),At)),$t=u.multiply(A.sin(u.multiply(it,Ke(nt))),N.imaginary());ve=u.multiply(ut,u.add(gt,$t)),ve=u.expand(u.parse(ve))}else{let Ue=r.group===ye&&Ye<0;if(wt=h1(new N(Ue?qe.num:Math.abs(qe.num)).setPower(a.clone())),Et=h1(new N(qe.den).setPower(a.clone()).invert()),r.imaginary)if(Ee){let it=Math.sign(a),ut=De(a)%4;ve=new N(bt(ut)?-1:V.IMAGINARY),(ut===0||it<0&&ut===1||it>0&&ut===3)&&ve.negate()}else{let it=a.multiplier.multiply(Ge.quick(1,2)),nt=(-1)**it.num;ve=bt(it.den)?new N(-1).setPower(it,!0):new N(nt)}if(Ye<0&&!Ue&&ve.negate(),te&&r.group!==Le){let it=bt(a.multiplier.den),nt=bt(r.power),ut=ve.power.toDecimal(),At=bt(ut);if(it&&nt&&!At){if(ut==="1"||ut==="1")typeof ve.value=="string"&&ve.value.startsWith("baseunit_")||(ve=u.symfunction(S,[ve]));else if(Mt(ut))ve=u.multiply(u.symfunction(S,[ve.clone().toLinear()]),ve.clone().setPower(new Ge(Number(ut)-1)));else{let gt=ve.power;ve=u.symfunction(S,[ve.toLinear()]).setPower(gt)}V.POSITIVE_MULTIPLIERS&&ve.fname===S&&(ve=ve.args[0])}}if(a.equals(2)&&ve.group===_e){let it=new N(1);ve.each(nt=>{it=u.multiply(it,u.pow(nt,a))}),ve=it}}}if(ve=h1(ve),wt&&Et&&(ve=u.multiply(ve,Ln(u.multiply(wt,Et)))),ve.fname===l){let Ye=ve.group===Le,Ue=Ye?ve.power.multiplier.toString():ve.power.toString();if(bt(Ue)){let it=Ye?u.divide(ve.power,new N(2)):new N(ve.power.divide(new Ge(2))),nt=ve.multiplier;ve=u.pow(ve.args[0],it),ve.multiplier=ve.multiplier.multiply(nt)}}else if(!V.IGNORE_E&&ve.isE()&&ve.group===Le&&ve.power.contains("pi")&&ve.power.contains(V.IMAGINARY)&&a.group===_e){let Ye=a.stripVar(V.IMAGINARY);ve=u.add(A.cos(Ye),u.multiply(N.imaginary(),A.sin(Ye)))}return ve}if(ae(r)&&k)r=r.map(he=>u.pow(he,a.clone()));else if(Re(r)&&k){let he=new vt;r.eachElement((ie,te,Ne)=>{he.set(te,Ne,u.pow(ie,a.clone()))}),r=he}else if(D&&Re(a)){let he=new vt;a.eachElement((ie,te,Ne)=>{he.set(te,Ne,u.pow(r.clone(),ie))}),r=he}return r},this.comma=function(r,a){return r instanceof Dt||(r=Dt.create(r)),r.append(a),r},this.mod=function(r,a){return yt(r,a)},this.slice=function(r,a){return new g(r,a)},this.equals=function(r,a){return r.group!==ee&&!r.isLinear()&&Ht(`Cannot set equality for ${r.toString()}`),E[r.value]=a.clone(),a},this.percent=function(r){return u.divide(r,new N(100))},this.assign=function(r,a){if(r instanceof Dt&&a instanceof Dt)return r.elements.map((D,k)=>u.assign(D,a.elements[k])),It.fromArray(a.elements);if(r.parent){let D=r.parent;return D.elements[D.getter]=a,delete D.getter,D}if(r.group!==ee)throw new P1(`Cannot complete operation. Incorrect LH value for ${r}`);return E[r.value]=a,a},this.functionAssign=function(r,a){let D=r.elements.pop();return Ve(D,r.elements,a)};let V0=function(r){return new N(r===!0?1:0)};this.eq=function(r,a){return V0(r.equals(a))},this.gt=function(r,a){return V0(r.gt(a))},this.gte=function(r,a){return V0(r.gte(a))},this.lt=function(r,a){return V0(r.lt(a))},this.lte=function(r,a){return V0(r.lte(a))},this.factorial=function(r){return this.symfunction(o,[r])},this.dfactorial=function(r){return this.symfunction(w,[r])}}u=new f,cn._=u,ht._=u,Object.defineProperty(rn,"functions",{get:()=>u.functions,configurable:!0}),Object.defineProperty(sn,"CONSTANTS",{get:()=>u.CONSTANTS,configurable:!0}),Object.defineProperty(I0,"VARS",{get:()=>E,configurable:!0}),Object.defineProperty(n0,"VARS",{get:()=>E,configurable:!0}),n0._clearFunctions=je,n0._initConstants=()=>u.initConstants(),Yt._=u,Yt.C=pt,lt={convert(t,i){let c;if(t===0)c=[0,1];else if(Math.abs(t)<1e-6||Math.abs(t)>1e20){let g=this.quickConversion(Number(t));if(g[1]<=1e16){let h=Math.abs(t),v=t/h;c=this.fullConversion(h.toFixed(`${g[1]}`.length-1)),c[0]*=v}else c=g}else c=this.fullConversion(t);return c},quickConversion(t){let i=function(g){typeof g!="string"&&(g=g.toString());let h="",v=g.charAt(0);return v==="-"?(g=g.substr(1,g.length),h="-"):v==="+"&&(g=g.substr(1,g.length)),{sign:h,value:g}};function c(g){Vt.isScientific(g)&&(g=G0(g));let h=i(g),v=h.value.split("."),A;v.length===1?A=v[0]:A=v[0]+v[1];let H=v[1]?v[1].length:0,P=`1${"0".repeat(H)}`;return A!=="0"&&(A=A.replace(/^0+/u,"")),[h.sign+A,P]}return c(t)},fullConversion(t){let i=Math.abs(t)>1e10?1e-16:1e-30,c=!1,g=0,h=1,v=1,A=0,H=0,P=t,X,ne,fe=1e-14;for(;!c;){H++;let de;if(Math.abs(P)>1e10){let ke=Math.round(P);de=Math.abs(P-ke)/Math.abs(ke)<fe?ke:Math.floor(P)}else de=Math.floor(P);X=g+de*v,ne=h+de*A;let Se=P-de;Se<i&&(c=!0),P=1/Se,g=v,h=A,v=X,A=ne,(Math.abs(X/ne-t)<i||H>30)&&(c=!0)}return[X,ne]}},Rt.Fraction=lt,se={parser:(function(){let i=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],c=new f;for(let h in c)i.indexOf(h)===-1&&delete c[h];c.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(h){return h}}),c.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(h){return h}});let g=c.getBrackets();return g["{"].maps_to=void 0,c})(),space:"~",dot:" \\cdot ",latex(t,i){if(t.clone&&(t=t.clone()),t instanceof u.classes.Collection&&(t=t.elements),Pt(t)){let de=[];for(let Se=0;Se<t.length;Se++){let ke=t[Se];ue(ke)||(ke=u.parse(ke)),de.push(this.latex(ke,i))}return this.brackets(de.join(", "),"square")}if(Re(t)){let de=`\\begin{pmatrix}
`;for(let Se=0;Se<t.elements.length;Se++){let ke=[],be=t.elements[Se];for(let Pe=0;Pe<be.length;Pe++)ke.push(this.latex(be[Pe],i));de+=ke.join(" & "),Se<t.elements.length-1&&(de+=`\\\\
`)}return de+="\\end{pmatrix}",de}if(ae(t)){let de="\\left[";for(let Se=0;Se<t.elements.length;Se++)de+=`${this.latex(t.elements[Se],i)} ${Se===t.elements.length-1?"":",\\,"}`;return de+="\\right]",de}if(F1(t)){let de="\\{";for(let Se=0;Se<t.elements.length;Se++)de+=`${this.latex(t.elements[Se],i)} ${Se===t.elements.length-1?"":",\\,"}`;return de+="\\}",de}t=t.clone();let c=i==="decimal"||i==="decimals",{power:g}=t,h=We(g),v=t.multiplier.lessThan(0);if(t.group===Ae&&c)return String(t.multiplier.toDecimal()*t.value**t.power.toDecimal());t.multiplier=t.multiplier.abs();let A;c?A=[String(t.multiplier.toDecimal()),""]:A=[t.multiplier.num,t.multiplier.den];let H=this.value(t,h,i,v),P;h&&g.negate(),c?(P=ue(g)?se.latex(g,i):String(g.toDecimal()),String(P)==="1"&&(P="")):ue(g)?P=this.latex(g,i):P=this.formatFrac(g,!0);let X=["",""],ne=h?1:0;return X[ne]=P,((v?"-":"")+this.set(A,H,X,t.group===_e)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(t,i,c,g){let{group:h}=t,{previousGroup:v}=t,A=["",""],H=i?1:0;if(t.isInfinity)A[H]="\\infty";else if(h===ee||h===Ae||v===ee||v===Ae||v===ye){let P=this.formatSubscripts(t.value);P.replace&&(P=P.replace(/(?<prefix>.+)_$/u,"$1\\_"));let X=String(P).split("_"),ne=this.greek[X[0]];ne&&(X[0]=ne,P=X.join("_"));let fe=this.symbols[X[0]];fe&&(X[0]=fe,P=X.join("_")),A[H]=P}else if(h===Xe||v===Xe){let P=[],{fname:X}=t;for(let ne=0;ne<t.args.length;ne++){let fe=t.args[ne],de;typeof fe=="string"?de=fe:de=this.latex(fe,c),P.push(de)}if(X===l)A[H]=`\\sqrt${this.braces(P.join(","))}`;else if(X===S)A[H]=this.brackets(P.join(","),"abs");else if(X===Y)A[H]=this.brackets(P.join(","),"parens");else if(X==="limit")A[H]=` \\lim\\limits_{${P[1]} \\to ${P[2]}} ${P[0]}`;else if(X==="integrate")A[H]=`\\int${this.braces(P[0])}${this.braces(`d${P[1]}`)}`;else if(X==="defint")A[H]=`\\int\\limits_${this.braces(P[1])}^${this.braces(P[2])} ${P[0]} d${P[3]}`;else if(X===o||X===w){let ne=t.args[0];ne.power.equals(1)&&(ne.isComposite()||ne.isCombination())&&(P[0]=this.brackets(P[0])),A[H]=P[0]+(X===o?"!":"!!")}else if(X==="floor")A[H]=`\\left \\lfloor${this.braces(P[0])}\\right \\rfloor`;else if(X==="ceil")A[H]=`\\left \\lceil${this.braces(P[0])}\\right \\rceil`;else if(X===V.LOG&&P.length>1)A[H]=`\\mathrm${this.braces(V.LOG)}_${this.braces(P[1])}${this.brackets(P[0])}`;else if(X===V.LOG10)A[H]=`\\mathrm${this.braces(V.LOG)}_${this.braces(10)}${this.brackets(P[0])}`;else if(X===V.LOG2)A[H]=`\\mathrm${this.braces(V.LOG)}_${this.braces(2)}${this.brackets(P[0])}`;else if(X===V.LOG1P)A[H]=`\\ln${this.brackets(`1 + ${P[0]}`)}`;else if(X==="sum"){let ne=P[0],fe=P[1],de=P[2],Se=P[3];A[H]=`\\sum\\limits_{${this.braces(fe)}=${this.braces(de)}}^${this.braces(Se)} ${this.braces(ne)}`}else if(X==="product"){let ne=P[0],fe=P[1],de=P[2],Se=P[3];A[H]=`\\prod\\limits_{${this.braces(fe)}=${this.braces(de)}}^${this.braces(Se)} ${this.braces(ne)}`}else if(X==="nthroot")A[H]=`\\sqrt[${P[1]}]${this.braces(P[0])}`;else if(X==="mod")A[H]=`${P[0]} \\bmod ${P[1]}`;else if(X==="realpart")A[H]=`\\operatorname{Re}${this.brackets(P[0])}`;else if(X==="imagpart")A[H]=`\\operatorname{Im}${this.brackets(P[0])}`;else{let ne=X===""?"":`\\mathrm${this.braces(X.replace(/_/gu,"\\_"))}`;t.isConversion?A[H]=ne+this.brackets(P.join(""),"parens"):A[H]=ne+this.brackets(P.join(","),"parens")}}else if(t.isComposite()){let P=t.collectSymbols().sort(h===He||v===He?(de,Se)=>Se.group-de.group:(de,Se)=>{let ke=ue(de.power)?-1:de.power;return(ue(Se.power)?-1:Se.power)-ke}),X=[],ne=P.length;for(let de=0;de<ne;de++)X.push(se.latex(P[de],c));let fe=X.join("+");A[H]=!(t.isLinear()&&t.multiplier.equals(1))||g?this.brackets(fe,"parens"):fe}else if(h===_e||v===Le||v===_e){h===_e&&t.distributeExponent();let P=[],X=[],ne=[],fe=[],de=0,Se=0,ke=function(be,Pe,Je){if(Je>1&&Pe.length>0){let De=Pe.length;for(let Qe=0;Qe<De;Qe++){let ot=Pe[Qe],mt=be[ot];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(mt)||/^\\left\(.+\\right\)$/gu.test(mt)||(be[ot]=se.brackets(mt,"parens"))}}return be};t.each(be=>{let Pe=We(be.power),Je;Pe?(Je=se.latex(be.invert(),c),Se++,be.isComposite()&&(!t.multiplier.den.equals(1)&&Math.abs(be.power)===1&&(Je=se.brackets(Je,"parens")),ne.push(P.length)),P.push(Je)):(Je=se.latex(be,c),de++,be.isComposite()&&(!t.multiplier.num.equals(1)&&Math.abs(be.power)===1&&(Je=se.brackets(Je,"parens")),fe.push(X.length)),X.push(Je))}),ke(X,fe,de),A[0]=X.join(this.dot),ke(P,ne,Se),A[1]=P.join(this.dot)}return A},set(t,i,c,g){let h=function(de){return/^\\left\(.+\\right\)$/u.test(de)};c&&=this.formatP(c);let v;g&&(v=c[0],c[0]=""),i=this.merge(i,c);let A=t[0],H=t[1],P=i[0],X=i[1];P&&Number(A)===1&&(A=""),Number(H)===1&&(H="");let ne=this.join(A,P,h(P)?"":this.dot),fe=this.join(H,X,h(X)?"":this.dot);if(ne&&fe){let de=this.frac(ne,fe);return g&&v&&(de=this.brackets(de)+v),de}return ne},merge(t,i){let c=[];for(let g=0;g<2;g++)c[g]=t[g]+i[g];return c},join(t,i,c){return!t&&!i?"":t&&!i?t:i&&!t?i:t+c+i},formatSubscripts(t){let i=t.toString().split("_"),c="";for(;i.length>1;)i.length>0&&(c=`_${this.braces(i.pop()+c)}`);return i[0]+c},formatP(t){for(let i=0;i<2;i++){let c=t[i];c&&(t[i]=`^${this.braces(c)}`)}return t},formatFrac(t,i){let c=t.num.toString(),g=t.den.toString();return i&&c==="1"&&g==="1"?"":g==="1"?c:this.frac(c,g)},frac(t,i){return`\\frac${this.braces(t)}${this.braces(i)}`},braces(t){return`{${t}}`},brackets(t,i){i||="parens";let g={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[i];return`\\left${g[0]}${t}\\right${g[1]}`},filterTokens(t){let i=[];Pt(t)&&(i.type=t.type);let c=["\\","left","right","big","Big","large","Large"];for(let g=0,h=t.length;g<h;g++){let v=t[g],A=t[g+1];v.value==="\\"&&A.value==="\\"?i.push(v):Pt(v)?i.push(se.filterTokens(v)):c.indexOf(v.value)===-1&&i.push(v)}return i},parse(t){let i,c,g="",h=this.filterTokens(t),v={cdot:"",times:"",infty:"Infinity"},A=function(X){return h[typeof X>"u"?++i:i+=X]},H=function(){return se.parse(A())},P=function(X){return X in v?v[X]:X==="*"&&h[i+1].value==="&"?(A(2),","):X==="&"?(A(),","):X==="\\"?"],[":X};for(i=0,c=h.length;i<c;i++){let X=h[i];if(X.value==="frac"){let ne=H(),fe=H();g+=`${ne}/${fe}`}else if(X.value in se.symbols)if(X.value===l&&h[i+1].type==="vector"&&h[i+2].type==="NerdamerSet"){let ne=H(),fe=H();g+=`${fe}^${Ct(`1/${ne}`)}`}else g+=X.value+H();else if(X.value==="int"){let ne=H();i++;let fe=A().value;fe=P(fe.substring(1,fe.length)),g+=`integrate${Ct(`${ne},${fe}`)}`}else if(X.value==="int_"){let ne=H();i++;let fe=A().value;fe===void 0&&(i--,fe=H());let de=H(),Se=A().value;Se===","&&(Se=A().value),Se==="differentialD"&&(i++,Se=A().value),Se==="mathrm"&&(i++,Se=A().value),g+=`defint${Ct(`${de},${ne},${fe},${Se}`)}`}else if(X.value&&X.value.startsWith("int_")){let ne=X.value.replace("int_","");i++;let fe=A().value;fe===void 0&&(i--,fe=H());let de=H(),Se=A().value;Se===","&&(Se=A().value),Se==="differentialD"&&(i++,Se=A().value),Se==="mathrm"&&(i++,Se=A().value),g+=`defint${Ct(`${de},${ne},${fe},${Se}`)}`}else if(X.value==="mathrm"){let ne=h[++i][0].value;g+=ne+H()}else if(X.value==="sum_"||X.value==="prod_"){let ne=X.value==="sum_"?"sum":"product",fe=A();i++;let de=H(),Se=H();g+=ne+Ct([Se,P(fe[0]),P(fe[2]),P(de)].join(","))}else if(X.value==="lim_"){let ne=A();g+=`limit${Ct([H(),P(ne[0]),P(ne[2])].join(","))}`}else if(X.value==="begin"){let ne=A();Array.isArray(ne)&&ne[0].value==="matrix"&&(g+="matrix([")}else if(X.value==="end"){let ne=A();Array.isArray(ne)&&ne[0].value==="matrix"&&(g+="])")}else Array.isArray(X)?g+=P(se.parse(X)):g+=P(X.value.toString())}return Ct(g)}},Object.defineProperty(Ft,"EXPRESSIONS",{get:()=>y,configurable:!0}),Object.defineProperty(Ft,"USER_FUNCTIONS",{get:()=>b,configurable:!0}),Ft.LaTeX=se,Ft.text=C,Ft.functions=u.functions,Ft._=u,tt.Frac=Ge,tt.NerdamerSymbol=N,tt.isVector=ae,tt.isArray=Pt,tt.isMatrix=Re,tt.isSymbol=ue,tt.block=l0,tt._=u,tt.Settings=V,tt.text=C,tt.LaTeX=se,ft.Frac=Ge,ft.NerdamerSymbol=N,ft.Vector=It,ft.isMatrix=Re,ft.isVector=ae,ft.isArray=Pt,ft.isSymbol=ue,ft.block=l0,ft._=u,ft.err=Ht,ft.LaTeX=se,x0.isVector=ae,x0.Vector=It,x0.remove=_0,w0._=u,w0.block=l0,ze={dependencies:{_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":U.gamma},gamma_incomplete:{"Math2.factorial":U.factorial},Li:{"Math2.Ei":U.Ei,"Math2.bigLog":U.bigLog,Frac:Ge},Ci:{"Math2.factorial":U.factorial},Ei:{"Math2.factorial":U.factorial},Si:{"Math2.factorial":U.factorial},Shi:{"Math2.factorial":U.factorial},Chi:{isInt:Mt,nround:A0,"Math2.num_integrate":U.num_integrate},factor:{"Math2.ifactor":U.ifactor,NerdamerSymbol:N},num_integrate:{"Math2.simpson":U.simpson,nround:A0},fib:{even:bt}},reformat:{diff(t,i){let c=t.args[1].toString(),g=`let f = ${ze.build(t.args[0].toString(),[c])};`,h=U.diff.toString();return!h.startsWith("function")&&!h.startsWith("(")&&!h.startsWith("async")&&(h=`function ${h}`),i[1]+=`let diff = ${h};`,i[1]+=g,[`diff(f)(${c})`,i]}},getProperName(t){return{continuedFraction:"continuedFraction"}[t]||t},compileDependencies(t,i){let c=ze.dependencies[t],g=i&&i[1]?i[1]:"",h=i&&i[0]?i[0]:{};for(let v in c){if(typeof c[v]=="object")continue;let A=v.split("."),H=c[v];if(typeof H=="function"){let P=H.toString();!P.startsWith("function")&&!P.startsWith("(")&&!P.startsWith("async")&&(P=`function ${P}`),H=P}g+=`let ${A.length>1?A[1]:A[0]}=${H};`,h[v]=A.pop()}return[h,g]},getArgsDeps(t,i){let{args:c}=t,g=i,h=function(v){v.group===Xe&&(g=ze.compileDependencies(v.fname,g))};for(let v=0;v<c.length;v++)t.args[v].each(h);return g},build(t,i){t=l0("PARSE2NUMBER",()=>u.parse(t),!0);let c=J(t),g=[],h=[],v=function(P,X){P.fname===""&&(P=N.unwrapPARENS(P)),X||=[];let ne=[],{group:fe}=P,de="",Se=function(Pe){let Je=Pe===_e?"*":"+",De=[];for(let ot in P.symbols){if(!Object.hasOwn(P.symbols,ot))continue;let mt=P.symbols[ot],yt=v(mt,X)[0];mt.isComposite()&&(yt=Ct(yt)),De.push(yt)}let Qe=De.join(Je);return Qe=Qe&&!P.multiplier.equals(1)?Ct(Qe):Qe,Qe},ke=function(Pe){let Je;if(Pe in Math)Je=`Math.${Pe}`;else{if(Pe=ze.getProperName(Pe),g.indexOf(Pe)===-1){let De=U[Pe].toString();!De.startsWith("function")&&!De.startsWith("(")&&!De.startsWith("async")&&(De=`function ${De}`),X.push(`let ${Pe} = ${De}; `),g.push(Pe)}Je=Pe}return Je+=Ct(P.args.map(De=>v(De,X)[0]).join(",")),Je};fe===ye?ne.push(P.multiplier.toDecimal()):P.multiplier.equals(-1)?de="-":P.multiplier.equals(1)||ne.push(P.multiplier.toDecimal());let be;if(fe===ee||fe===Ae)be=P.value;else if(fe===Xe)if(h=ze.compileDependencies(P.fname,h),h=ze.getArgsDeps(P,h),ze.reformat[P.fname]){let Pe=ze.reformat[P.fname](P,h);h=Pe[1],be=Pe[0]}else be=ke(P.fname);else if(fe===Le){let Pe=P.previousGroup;Pe===ye||Pe===ee?be=P.value:Pe===Xe?(be=ke(P.fname),h=ze.compileDependencies(P.fname,h),h=ze.getArgsDeps(P,h)):be=Se(P.previousGroup)}else be=Se(P.group);if(P.group!==ye&&!P.power.equals(1)){let Pe=v(u.parse(P.power));X.push(Pe[1]),be=`Math.pow${Ct(`${be},${Pe[0]}`)}`}return be&&ne.push(de+be),[ne.join("*"),X.join("").replace(/\n+\s+/gu," ")]};i&&(c=i);let A=v(t);for(let P in h[0]){if(!Object.hasOwn(h[0],P))continue;let X=h[0][P];A[1]=A[1].replace(P,X),h[1]=h[1].replace(P,X)}return new Function(...c,`${(h[1]||"")+A[1]} return ${A[0]};`)}},ht.Build=ze,(function(){r1(u.CONSTANTS),r1(u.functions),u.initConstants(),u.error||=Ht,V.LOG_FNS={log:u.functions.log,log10:u.functions.log10}})();let p={allSame:t1,allNumeric:zn,arguments2Array:Gn,armTimeout:G1,arrayAddSlices:jn,arrayClone:Hn,arrayMax:Bn,arrayMin:m1,arrayEqual:Xn,arrayUnique:w1,arrayGetVariables:at,arraySum:ce,block:l0,build:ze.build,checkTimeout:c1,clearU:ni,comboSort:Qn,compare:Ie,convertToVector:j,customError:e0,customType:Vn,decompose_fn:Be,disarmTimeout:X1,each:Q1,evaluate:qt,even:bt,evenFraction:d1,fillHoles:Oe,firstObject:i1,format:kt,generatePrimes:H1,getCoeffs:F,getU:et,importFunctions:Te,inBrackets:Ct,isArray:Pt,isExpression:B,isFraction:L,isInt:Mt,isMatrix:Re,isNegative:We,isNumericSymbol:U0,isPrime:H0,isReserved:s1,isSymbol:ue,isVariableSymbol:V1,isVector:ae,isCollection:E1,keys:_1,knownVariable:Zn,nroots:st,remove:_0,reserveNames:r1,range:Pn,round:A0,sameSign:Dn,scientificToDecimal:G0,separate:pe,stringReplace:Fn,text:C,validateName:y0,variables:J,warn:M1};pt={groups:me,NerdamerSymbol:N,Expression:Bt,Collection:Dt,Frac:Ge,Vector:It,Matrix:vt,Parser:f,Scientific:Vt,Fraction:lt,Math2:U,LaTeX:se,Utils:p,PARSER:u,PARENTHESIS:Y,Settings:V,err:Ht,bigInt:$,bigDec:z,exceptions:W},Ft.Math2=pt.Math2,Ft.Expression=Bt;let _=function(t,i,c,g){G1();try{let h=!1;if(Ve(t))return fn;t!==null&&typeof t=="object"&&t instanceof Bt&&(t=t.toString()),Pt(c)||(c=typeof c>"u"?[]:[c]),c.forEach(A=>{if(A==="numer"){h=!0;return}let H=u.functions[A];H&&H[1]===1&&(t=`${A}(${t})`)});let v=l0("PARSE2NUMBER",()=>u.parse(t,i),h||V.PARSE2NUMBER);return g?y[g-1]=v:y.push(v),new Bt(v)}finally{X1()}};return n0.libExports=_,X0.libExports=_,X0.CONSTANTS=u.CONSTANTS,c0.libExports=_,c0.VARS=E,c0.CONSTANTS=u.CONSTANTS,c0.parse=u.parse.bind(u),c0.isSymbol=ue,u1.libExports=_,u1._setFunction=Ve,m0.libExports=_,m0.EXPRESSIONS=y,q0.libExports=_,q0.Settings=V,q0.functions=u.functions,jt.bigDec=z,jt.Settings=V,jt.functions=u.functions,jt.symfunction=u.symfunction.bind(u),jt.NerdamerSymbol=N,f0.libExports=_,f0.functions=u.functions,f0.parse=u.parse.bind(u),f0.callfunction=u.callfunction.bind(u),f0.Expression=Bt,_.rpn=Ei,_.convertToLaTeX=gi,_.convertFromLaTeX=Ii,_.version=ai,_.getWarnings=ii,_.setConstant=Li,_.getConstant=fi,_.clearConstants=Ci,_.setFunction=xi,_.clearFunctions=Oi,_.getCore=ui,_.getExpression=_.getEquation=Bt.getExpression,_.reserved=li,_.clear=B1,n0.clear=B1,_.flush=Ti,_.expressions=Ai,_.functions=_i,_.register=ln,_.validateName=y0,_.validVarName=oi,_.supported=ci,_.numEquations=_.numExpressions=ri,_.setVar=Ui,_.getVar=pi,_.clearVars=qi,_.load=Ri,_.getVars=hi,_.set=q1,_.get=si,_.updateAPI=$i,_.replaceFunction=Mi,_.setOperator=wi,_.getOperator=mi,_.aliasOperator=di,_.tree=on,_.htmlTree=Ni,_.addPeeker=Si,_.removePeeker=vi,_.parse=yi,_.updateAPI(),_})({bigInt:j1,bigDec:Z1,constants:kn});typeof O1<"u"&&(O1.exports=fn)});var W0=g0((Gi,pn)=>{"use strict";var z0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof pn<"u"&&z0===void 0&&(z0=k0(),Q0());(function(){let n=z0.getCore(),e=n.PARSER,{Frac:$}=n,{Settings:z}=n,{isSymbol:me}=n.Utils,{FN:we}=n.groups,{NerdamerSymbol:K}=n,{text:le}=n.Utils,{inBrackets:V}=n.Utils,{isInt:u}=n.Utils,{format:se}=n.Utils,{even:pt}=n.Utils,{evaluate:lt}=n.Utils,{N:ze}=n.groups,{S:ue}=n.groups,{PL:ye}=n.groups,{CP:Ae}=n.groups,{CB:ee}=n.groups,{EX:Le}=n.groups,{P:Xe}=n.groups,{LOG:Fe}=z,_e="exp",He="abs",xe="sqrt",Y="sin",l="cos",S="tan",o="sec",w="csc",y="cot",E="asin",O="acos",G="atan",b="asec",L="acsc",B="acot",J="sinh",ce="cosh",pe="tanh",Oe="csch",ae="sech",Re="coth",We="asech",Ie="acsch",Ve="acoth";function je(j){this.message=j||""}je.prototype=new Error,K.prototype.hasIntegral=function(){return this.containsFunction("integrate")},K.prototype.fnTransform=function(){if(this.group!==we)return this;let Z,x=this.args[0],W=new K(this.multiplier),U=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case J:Z=e.parse(se("(e^({0})-e^(-({0})))/2",x));break;case ce:Z=e.parse(se("(e^({0})+e^(-({0})))/2",x));break;case pe:Z=e.parse(se("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",x));break;case S:Z=e.parse(se("sin({0})/cos({0})",x));break;case w:Z=e.parse(se("1/sin({0})",x));break;case o:Z=e.parse(se("1/cos({0})",x));break;default:Z=U}else if(this.power.equals(2))switch(this.fname){case Y:Z=e.parse(se("1/2-cos(2*({0}))/2",x));break;case l:Z=e.parse(se("1/2+cos(2*({0}))/2",x));break;case S:Z=e.parse(se("sin({0})^2/cos({0})^2",x));break;case ce:Z=e.parse(se("1/2+cosh(2*({0}))/2",x));break;case J:Z=e.parse(se("-1/2+cosh(2*({0}))/2",x));break;case pe:Z=e.parse(se("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",x));break;case o:Z=e.parse(se("(1-cos(2*({0})))/(1+cos(2*({0})))+1",x));break;default:Z=U}else if(this.fname===o)Z=e.parse(se("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===w)Z=e.parse(se("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===S)this.power.lessThan(0)?Z=e.parse(se("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):Z=e.parse(se("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===Y&&this.power.lessThan(0))Z=e.parse(se("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===l&&this.power.lessThan(0))Z=e.parse(se("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===Y&&this.power.equals(3))Z=e.parse(se("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===l&&this.power.equals(3))Z=e.parse(se("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===l||this.fname===Y)&&pt(this.power)){let C=this.power/2,N=e.pow(this.clone().toLinear(),e.parse(2)).fnTransform(),f=e.expand(e.pow(N,e.parse(C)));Z=new K(0),f.each(p=>{let _=p.fnTransform();Z=e.add(Z,_)},!0)}else Z=U;return e.multiply(Z,W)},K.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===ue)return!1;if(this.fname&&(n.Utils.inTrig(this.fname)||n.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let Z in this.symbols)if(this.symbols[Z].hasTrig())return!0}return!1},n.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},n.Utils.toCommonDenominator=function(Z){if(Z.isComposite()&&Z.isLinear()){let x=new K(Z.multiplier),W=new K(1),U=new K(0);return Z.each(N=>{W=e.multiply(W,N.getDenom())},!0),Z.each(N=>{let f=N.getNum(),p=N.getDenom(),_=e.multiply(f,e.divide(W.clone(),p));U=e.add(U,_)}),e.multiply(x,n.Algebra.divide(e.expand(U),e.expand(W)))}return Z},n.Utils.inInverseTrig=function(Z){return[E,O,G,L,b,B].indexOf(Z)!==-1},n.Utils.inTrig=function(Z){return[l,Y,S,o,w,y].indexOf(Z)!==-1},n.Utils.inHtrig=function(Z){return[J,ce,pe,Ie,We,Ve].indexOf(Z)!==-1},n.Matrix.jacobian=function(Z,x){let W=new n.Matrix;return x||=n.Utils.arrayGetVariables(Z),x.forEach((U,C)=>{Z.forEach((N,f)=>{let p=n.Calculus.diff(N.clone(),U);W.set(f,C,p)})}),W},n.Matrix.prototype.max=function(){let Z=new K(0);return this.each(x=>{let W=x.abs();W.gt(Z)&&(Z=W)}),Z},n.Matrix.cMatrix=function(Z,x){let W=new n.Matrix;return x.forEach((U,C)=>{W.set(C,0,e.parse(Z))}),W};let st=n.Utils.allFunctions=function(Z){for(let x=0,W=Z.length;x<W;x++)if(Z[x].group!==we)return!1;return!0},Be=n.Utils.cosAsinBtranform=function(Z,x){let W=Z.args[0],U=x.args[0];return e.parse(se("(sin(({0})+({1}))-sin(({0})-({1})))/2",W,U))},et=n.Utils.cosAsinAtranform=function(Z,x){if(Number(x.power)!==1)return e.multiply(Z,x);let W=Z.args[0];return e.parse(se("(sin(2*({0})))/2",W))},at=n.Utils.cosAsinBtranform=function(Z,x){let W=Z.args[0],U=x.args[0];return e.parse(se("(cos(({0})+({1}))-cos(({0})-({1})))/2",W,U))},Te=n.Utils.trigTransform=function(Z){let x={},W,U,C=new K(1);for(let N=0,f=Z.length;N<f;N++)if(W=Z[N],W.group===we){let{fname:p}=W;p===l&&x[Y]?(x[Y].args[0].toString()===W.args[0].toString()?U=et(W,x[Y]):U=Be(W,x[Y]),delete x[Y],C=e.multiply(C,U)):p===Y&&x[l]?(x[l].args[0].toString()===W.args[0].toString()?U=et(W,x[l]):U=Be(W,x[l]),delete x[l],C=e.multiply(C,U)):p===Y&&x[Y]?(x[Y].args[0].toString()===W.args[0].toString()?(U=e.multiply(W,x[Y]),delete x[Y]):(U=at(W,x[Y]),delete x[Y]),C=U):x[p]=W}else C=e.multiply(C,W);for(let N in x)Object.hasOwn(x,N)&&(C=e.multiply(C,x[N]));return C};n.Settings.integration_depth=10,n.Settings.max_lim_depth=10;let F=n.Calculus={version:"1.4.6",sum(j,Z,x,W){if(Z.group!==n.groups.S)throw new n.exceptions.NerdamerTypeError(`Index must be symbol. ${le(Z)} provided`);Z=Z.value;let U;if(n.Utils.isNumericSymbol(x)&&n.Utils.isNumericSymbol(W)){let C=W-x<200?"":"PARSE2NUMBER";x=Number(x),W=Number(W),U=n.Utils.block(C,()=>{let N=j.text(),f={"~":!0},p=new n.NerdamerSymbol(0);for(let _=x;_<=W;_++){f[Z]=new K(_);let t=e.parse(N,f);p=e.add(p,t)}return p})}else U=e.symfunction("sum",[j,Z,x,W]);return U},product(j,Z,x,W){if(Z.group!==n.groups.S)throw new n.exceptions.NerdamerTypeError(`Index must be symbol. ${le(Z)} provided`);Z=Z.value;let U;if(n.Utils.isNumericSymbol(x)&&n.Utils.isNumericSymbol(W)){let C=W-x<200?"":"PARSE2NUMBER";U=n.Utils.block(C,()=>{x=Number(x),W=Number(W.multiplier);let N=j.text(),f={},p=new n.NerdamerSymbol(1);for(let _=x;_<=W;_++)f[Z]=new K(_),p=e.multiply(p,e.parse(N,f));return p})}else U=e.symfunction("product",[j,Z,x,W]);return U},diff(j,Z,x){if(n.Utils.isVector(j)){let p=new n.Vector([]);return j.each(_=>{p.elements.push(F.diff(_,Z,x))}),p}if(n.Utils.isMatrix(j)){let p=new n.Matrix;return j.each((_,t,i)=>{p.set(t,i,F.diff(_,Z,x))}),p}if(j.LHS&&j.RHS)return new n.Equation(F.diff(j.LHS.clone(),Z,x),F.diff(j.RHS.clone(),Z,x));let W=me(Z)?Z.text():Z;if(x=me(x)?x.multiplier:x||1,W===void 0&&(W=n.Utils.variables(j)[0]),j.group===we&&j.fname===xe){let p=j.args[0],_=j.power.clone();(p.group!==ze||p.group!==Xe)&&(p.power=me(p.power)?e.multiply(p.power,e.multiply(new K(1/2)),_):p.power.multiply(new $(.5)).multiply(_),p.multiplier=p.multiplier.multiply(j.multiplier)),j=p}if(j.group===we&&!me(j.power)){let p=C(e.parse(j)),_=F.diff(j.args[0].clone(),W);j=e.multiply(p,_)}else j=C(j);return x>1&&(x--,j=F.diff(j,Z,x)),j;function U(p){return(p.value===W||p.contains(W,!0))&&(p.multiplier=p.multiplier.multiply(p.power),p.power=p.power.subtract(new $(1)),p.power.equals(0)&&(p=K(p.multiplier))),p}function C(p){let _=p.group,t,i,c;if(_===ze||_===ue&&p.value!==W||_===Xe)p=K(0);else if(_===ue)p=U(p);else if(_===ee){let g=p.multiplier.clone();p.toUnitMultiplier();let h=e.multiply(f(p),U(p));return h.multiplier=h.multiplier.multiply(g),h}else if(_===we&&p.power.equals(1)){let g=p.multiplier.clone();switch(p.toUnitMultiplier(),p.fname){case Fe:c=p.clone(),p=p.args[0].clone(),p.power=p.power.negate(),p.multiplier=c.multiplier.divide(p.multiplier);break;case l:p.fname=Y,p.multiplier.negate();break;case Y:p.fname=l;break;case S:p.fname=o,p.power=new $(2);break;case o:p=N(p,S);break;case w:p=N(p,"-cot");break;case y:p.fname=w,p.multiplier.negate(),p.power=new $(2);break;case E:p=e.parse(`(sqrt(1-(${le(p.args[0])})^2))^(-1)`);break;case O:p=e.parse(`-(sqrt(1-(${le(p.args[0])})^2))^(-1)`);break;case G:p=e.parse(`(1+(${le(p.args[0])})^2)^(-1)`);break;case He:i=p.args[0].clone(),i.toUnitMultiplier(),p=e.parse(`${V(le(p.args[0]))}/abs${V(le(i))}`);break;case"parens":p=K(1);break;case"cosh":p.fname="sinh";break;case"sinh":p.fname="cosh";break;case pe:p.fname=ae,p.power=new $(2);break;case ae:p=N(p,"-tanh");break;case Oe:{let h=String(p.args[0]);p=e.parse(`-coth(${h})*csch(${h})`);break}case Re:{let h=String(p.args[0]);p=e.parse(`-csch(${h})^2`);break}case"asinh":p=e.parse(`(sqrt(1+(${le(p.args[0])})^2))^(-1)`);break;case"acosh":p=e.parse(`(sqrt(-1+(${le(p.args[0])})^2))^(-1)`);break;case"atanh":p=e.parse(`(1-(${le(p.args[0])})^2)^(-1)`);break;case We:{let h=String(p.args[0]);p=e.parse(`-1/(sqrt(1/(${h})^2-1)*(${h})^2)`);break}case Ve:p=e.parse(`-1/((${p.args[0]})^2-1)`);break;case Ie:{let h=String(p.args[0]);p=e.parse(`-1/(sqrt(1/(${h})^2+1)*(${h})^2)`);break}case b:{let h=String(p.args[0]);p=e.parse(`1/(sqrt(1-1/(${h})^2)*(${h})^2)`);break}case L:{let h=String(p.args[0]);p=e.parse(`-1/(sqrt(1-1/(${h})^2)*(${h})^2)`);break}case B:p=e.parse(`-1/((${p.args[0]})^2+1)`);break;case"S":{let h=String(p.args[0]);p=e.parse(`sin((pi*(${h})^2)/2)`);break}case"C":{let h=String(p.args[0]);p=e.parse(`cos((pi*(${h})^2)/2)`);break}case"Si":{let h=p.args[0];p=e.parse(`sin(${h})/(${h})`);break}case"Shi":{let h=p.args[0];p=e.parse(`sinh(${h})/(${h})`);break}case"Ci":{let h=p.args[0];p=e.parse(`cos(${h})/(${h})`);break}case"Chi":{let h=p.args[0];p=e.parse(`cosh(${h})/(${h})`);break}case"Ei":{let h=p.args[0];p=e.parse(`e^(${h})/(${h})`);break}case"Li":{let h=p.args[0];p=e.parse(`1/${z.LOG}(${h})`);break}case"erf":p=e.parse(`(2*e^(-(${p.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let h=String(p.args[0]),v=String(p.args[1]);p=e.parse(`(${v})/((${v})^2+(${h})^2)`);break}case"sign":p=new K(0);break;case"sinc":p=e.parse(se("(({0})*cos({0})-sin({0}))*({0})^(-2)",p.args[0]));break;case z.LOG10:p=e.parse(`1/((${p.args[0]})*${z.LOG}(10))`);break;default:p=e.symfunction("diff",[p,Z])}p.multiplier=p.multiplier.multiply(g)}else if(_===Le||_===we&&me(p.power)){let g;_===Le?g=p.value:_===we&&p.contains(W)?g=p.fname+V(le(p.args[0])):g=p.value+V(le(p.args[0])),i=F.diff(e.multiply(e.parse(Fe+V(g)),p.power.clone()),W),p=e.multiply(p,i)}else if(_===we&&!p.power.equals(1))i=p.clone(),i.toLinear(),i.toUnitMultiplier(),p=e.multiply(U(p.clone()),C(i));else if(_===Ae||_===ye){let g=p.clone(),h=new K(0);for(let v in p.symbols)Object.hasOwn(p.symbols,v)&&(h=e.add(h,F.diff(p.symbols[v].clone(),W)));p=e.multiply(U(g),h)}return p.updateHash(),p}function N(p,_,t){return e.multiply(p,e.parse(_+V(t||le(p.args[0]))))}function f(p){let _=p.collectSymbols(),t=new K(0),i=_.length;for(let c=0;c<i;c++){let g=F.diff(_[c].clone(),W);for(let h=0;h<i;h++)c!==h&&(g=e.multiply(g,_[h].clone()));t=e.add(t,g)}return t}},integration:{u_substitution(j,Z){let x="__u__";function W(t,i,c){let g=F.diff(i,Z),h=c?c(t,i):e.divide(t.clone(),g);return h.contains(Z,!0)?null:h}function U(t,i){let c=F.integrate(e.symfunction(t,[new K(x)]),x,0);return c=c.sub(new K(x),i),c.updateHash(),c}let C=j[0].clone(),N=j[1].clone(),f=C.group,p=N.group,_;if(f===we&&p!==we){let t=C.args[0];if(_=W(N,t.clone()),_)return e.multiply(_,U(C.fname,t));if(_=W(N,C),_)return F.integration.poly_integrate(C)}else if(p===we&&f!==we){let t=N.args[0];if(_=W(C,t.clone()),_)return e.multiply(_,U(N.fname,t))}else if(f===we&&p===we){if(_=W(C.clone(),N.clone()),_||(_=W(N.clone(),C.clone()),_))return e.multiply(F.integration.poly_integrate(N),_)}else if(f===Le&&p!==Le){let t=C.power;if(_=W(N,t.clone()),!_){let g=F.integration.decompose_arg(t.clone(),Z),h=F.diff(g[2].clone(),Z),v=F.integration.decompose_arg(h.clone(),Z);if(e.multiply(g[1],v[1]).power.equals(N.power)){let A=e.divide(g[0].clone(),v[0].clone()),H=e.multiply(A.clone(),e.pow(new K(C.value),e.multiply(g[0],new K(x))));return H=e.multiply(H,new K(x)),F.integration.by_parts(H,x,0,{}).sub(x,g[1].clone())}}let i=F.integrate(C.sub(t.clone(),new K(x)),x,0);return e.multiply(i.sub(new K(x),t),_)}else if(p===Le&&f!==Le){let t=N.power;_=W(C,t.clone());let i=F.integrate(N.sub(t,new K(x)),x,0);return e.multiply(i.sub(new K(x),t),_)}else if(C.isComposite()||N.isComposite()){let t=function(g,h){let v=F.diff(h,Z),A=n.Algebra.Factor.factorInner(g),H=n.Algebra.Factor.factorInner(v);return e.divide(A,H)},i=C.isComposite()?C.clone().toLinear():C.clone(),c=N.isComposite()?N.clone().toLinear():N.clone();if(_=W(i.clone(),c.clone(),t),_)return e.multiply(F.integration.poly_integrate(N),_);if(_=W(c.clone(),i.clone(),t),_)return e.multiply(F.integration.poly_integrate(C),_)}},poly_integrate(j){let Z=j.power.toString(),x=j.multiplier.toDecimal(),W=j.toUnitMultiplier().toLinear();return Number(Z)===-1?e.multiply(new K(x),e.symfunction(Fe,[W])):e.parse(se("({0})*({1})^(({2})+1)/(({2})+1)",x,W,Z))},stop(j){throw j||="Unable to compute integral!",n.Utils.warn(j),new je(j)},partial_fraction(j,Z,x,W){me(Z)||(Z=e.parse(Z));let U;U=new K(0);let C=n.Algebra.PartFrac.partfrac(j,Z);return C.group===ee&&C.isLinear()?(C.each(N=>{N.isLinear()||F.integration.stop()}),C.each(N=>{U=e.add(U,F.integrate(N,Z,x,W))})):U=e.add(U,F.integrate(C,Z,x,W)),U},get_udv(j){let Z=[[],[],[],[],[]],x=function(C){let N=C.group;if(N===we){let{fname:f}=C;n.Utils.inTrig(f)||n.Utils.inHtrig(f)?Z[3].push(C):n.Utils.inInverseTrig(f)?Z[1].push(C):f===Fe?Z[0].push(C):F.integration.stop()}else N===ue||C.isComposite()&&C.isLinear()||N===ee&&C.isLinear()?Z[2].push(C):N===Le||C.isComposite()&&!C.isLinear()?Z[4].push(C):F.integration.stop()};j.group===ee?j.each(C=>{x(K.unwrapSQRT(C,!0))}):x(j);let W,U=new K(1);for(let C=0;C<5;C++){let N=Z[C],f,p=N.length;if(p>0){if(p>1){f=new K(1);for(let _=0;_<p;_++)f=e.multiply(f,N[_].clone())}else f=N[0].clone();W?U=e.multiply(U,f):(W=f,W.multiplier=W.multiplier.multiply(j.multiplier))}}return[W,U]},trig_sub(j,Z,x,W,U,C){U||=F.integration.decompose_arg(j.clone().toLinear(),Z);let N=U[3],f=U[2],p=U[0],_=U[1];if(_.power.equals(2)&&p.greaterThan(0)){let t=n.Utils.getU(j),i=e.parse(S+V(t)),c=e.parse(`${o+V(t)}^2`),g=e.multiply(j.sub(_,i),c),h=F.integrate(g,t,x,W).sub(i,_);return n.Utils.clearU(i),h}},by_parts(j,Z,x,W){W.previous||=[];let U,C=F.integration.get_udv(j),N=C[0],f=C[1],p=K.unwrapSQRT(e.expand(F.diff(N.clone(),Z)),!0),_=p.clone().stripVar(Z);p=e.divide(p,_.clone());let t=F.integrate(f.clone(),Z,x||0),i=e.multiply(t.clone(),p),c=i.toString();if(W.previous.indexOf(c)!==-1&&n.Utils.inTrig(N.fname)&&f.isE())return W.is_cyclic=!0,new K(1);W.previous.push(c);let g=e.multiply(N,t),h=i.multiplier.clone();i.toUnitMultiplier();let v=e.multiply(F.integrate(i.clone(),Z,x,W),_);if(v.multiplier=v.multiplier.multiply(h),U=e.subtract(g,v),W.is_cyclic&&(W.previous.pop(),W.previous.length===0)){U=e.expand(U);let A=new K(0);U.each(H=>{H.contains(Z)||(A=e.add(A,H.clone()))}),U=e.divide(e.subtract(U,A.clone()),e.subtract(new K(1),A))}return U},decompose_arg:n.Utils.decompose_fn},integrate(j,Z,x,W){if(!Z){let U=n.Utils.variables(j);U.length===1&&(Z=U[0]),Z||="x"}if(n.Utils.isVector(j)){let U=new n.Vector([]);return j.each(C=>{U.elements.push(F.integrate(C,Z))}),U}return isNaN(Z)||e.error(`variable expected but received ${Z}`),j.isConstant(!0)?e.multiply(j.clone(),e.parse(Z)):(W||={},n.Utils.block("PARSE2NUMBER",()=>{x||=0;let U=me(Z)?Z.toString():Z,C=K.unwrapSQRT(j.clone(),!0),N=C.group,f;try{if(++x>n.Settings.integration_depth&&F.integration.stop("Maximum depth reached. Exiting!"),!C.contains(U,!0))f=e.multiply(C.clone(),e.parse(U));else if(N===ue)f=F.integration.poly_integrate(C,U,x);else if(N===Le)if(C.previousGroup===we&&!(C.fname==="sqrt"||C.fname===z.PARENTHESIS)&&F.integration.stop(),C.contains(U)&&C.previousGroup!==we)C.power.contains(U)?F.integration.stop():(F.diff(C.clone().toLinear(),U).contains(U)&&F.integration.stop(),f=F.integration.poly_integrate(C,U,x));else{let p=F.diff(C.power.clone(),U);if(p.contains(U)){let _=p.stripVar(U),t=e.divide(p.clone(),_.clone());if(t.group===ue&&t.isLinear())return _.multiplier=_.multiplier.divide(new $(2)),e.parse(se("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",_,U,C.multiplier));F.integration.stop()}if(C.isE())p.isLinear()?f=C:p.isE()&&p.power.group===ue&&p.power.power.equals(1)?f=e.multiply(e.symfunction("Ei",[C.power.clone()]),C.power):F.integration.stop();else{let _=e.symfunction(Fe,[e.parse(C.value)]);f=e.divide(C,_)}f=e.divide(f,p)}else if(C.isComposite()&&C.isLinear()){let p=e.parse(C.multiplier);C.toUnitMultiplier(),f=new K(0),C.each(_=>{f=e.add(f,F.integrate(_,U,x))}),f=e.multiply(p,f)}else if(N===Ae)if(C.power.greaterThan(1)&&(C=e.expand(C)),C.power.equals(1))f=new K(0),C.each(p=>{f=e.add(f,F.integrate(p,U,x))},!0);else{let p=Number(C.power),_=C.multiplier.clone();C.toUnitMultiplier();let t=C.clone().toLinear(),i=F.integration.decompose_arg(t,U),c=i[3],g=i[2],h=i[0],v=i[1];if(p===-1&&v.group!==ye&&v.power.equals(2)){let A=u(c)?c>0:!0;if(v.group===ue&&v.power.equals(2)&&A){let H=function(de){let Se=new K(1);return de.each(ke=>{Se=e.multiply(Se,ke.fname==="abs"?ke.args[0]:ke)}),Se},P=h.clone(),X=c.clone();P=e.pow(P,new K(1/2)),X=e.pow(X,new K(1/2));let ne=e.multiply(H(X),H(P)),fe=e.symfunction(G,[e.divide(e.multiply(h,v.toLinear()),ne.clone())]);f=e.divide(fe,ne)}else if(v.group===ue&&v.isLinear())f=e.divide(F.integration.poly_integrate(C),h);else if(v.power.equals(4)){let H=V,P=e.parse(`${xe+H(h)}*${U}^2`),X=e.parse(`${xe+H(2)}*${H(h)}^${H("1/4")}*${H(c)}^${H("1/4")}*${U}`),ne=e.parse(xe+H(c)),fe=e.add(e.add(P.clone(),X.clone()),ne.clone()),de=e.add(e.subtract(P,X),ne),Se=e.parse(`${xe+H(2)}*${H(c)}^${H("3/4")}`),ke=e.parse(`${xe+H(c)}*${H(c)}^${H("1/4")}*${U}`),be=e.parse(`2*${H(c)}*${xe}${H(2)}*${H(c)}^${H("1/4")}`),Pe=e.divide(e.subtract(Se.clone(),ke.clone()),e.multiply(be.clone(),de)),Je=e.divide(e.add(Se,ke),e.multiply(be,fe.clone()));f=e.add(F.integrate(Pe,U,x,W),F.integrate(Je,U,x,W))}else f=F.integration.partial_fraction(C,U,x)}else if(p===-1/2)if(v.group===ue&&v.power.equals(2))if(g.multiplier.lessThan(0)&&!c.multiplier.lessThan(0))if(h.negate(),c.isConstant()&&h.isConstant()){let A=e.symfunction(xe,[h.clone()]),H=e.symfunction(xe,[e.multiply(h.clone(),c)]);f=e.divide(e.symfunction(E,[e.divide(g.toLinear(),H)]),A)}else{let A=e.symfunction(xe,[h]),H=e.multiply(A.clone(),v.clone().toLinear());f=e.divide(e.symfunction(G,[e.divide(H,e.symfunction(xe,[t.clone()]))]),A)}else F.integration.stop();else F.integration.stop();else if(p===1/2&&v.power.equals(2)&&h.greaterThan(0))F.integration.stop();else if(v.isLinear()&&v.group!==ye)f=e.divide(F.integration.poly_integrate(C),h);else if(v.power.equals(2)&&h.greaterThan(0)){let A=e.parse(xe+V(h)),H=e.parse(xe+V(c)),P=e.multiply(A.clone(),H.clone()).invert(),X=e.pow(c,new K(C.power)),ne=n.Utils.getU(C),fe=e.multiply(P,v.clone().toLinear()),de=e.symfunction(G,[fe]),Se=(Math.abs(C.power)-1)*2,ke=F.integrate(e.parse(`${l+V(ne)}^${Se}`));return n.Utils.clearU(ne),e.multiply(ke.sub(ne,de),X)}else if(C.group!==ee&&!C.power.lessThan(0))f=F.integration.by_parts(C,U,x,W);else{let A=C.clone().toLinear(),P=n.Algebra.Factor.factorInner(A).toString()!==A.toString();if(n.Algebra.degree(A,e.parse(U)).equals(2)&&!P)try{let X=n.Algebra.sqComplete(A,U),ne=n.Utils.getU(A),fe=X.f.sub(X.a,ne),de=e.pow(fe,e.parse(C.power));f=F.integrate(de,ne).sub(ne,X.a)}catch(X){if(X.message==="timeout")throw X;F.integration.stop()}else f=F.integration.partial_fraction(C,U,x,W)}f.multiplier=f.multiplier.multiply(_)}else if(N===we){let p=C.args[0],_=C.multiplier.clone();C.toUnitMultiplier();let t=F.integration.decompose_arg(p,U),i=t[0],c=t[1],{fname:g}=C;if(g===Fe||g===E||g===O||g===G&&c.isLinear()){let h=C.power.toString();if(u(h)&&(x-=h),p.isComposite()){let v=n.Utils.getU(C),A=e.pow(e.parse(Fe+V(v)),new K(h)),H=F.diff(p,U),P=e.multiply(A,H),X=F.integrate(P,v,x,W);f=e.multiply(e.parse(_),X.sub(v,p))}else f=e.multiply(e.parse(_),F.integration.by_parts(C,U,x,W))}else if(g===S&&C.power.lessThan(0)){let h=C.clone();return h.power.negate(),h.fname=y,e.multiply(e.parse(_),F.integrate(h,U,x))}else{if(!i.contains(U,!0)&&C.isLinear())if(g===He){let h=e.divide(p.clone(),i.clone());if(h.group===ue&&!h.power.lessThan(0))if(n.Utils.even(h.power))f=F.integrate(p,U,x);else{let v=F.integrate(h,U,x);v.power=v.power.subtract(new $(1)),f=e.multiply(e.multiply(e.symfunction(He,[h.toLinear()]),v),i)}else F.integration.stop()}else{let h=C.args[0].group,v=F.integration.decompose_arg(p,U);switch((!(h===Ae||h===ue||h===ee)||!v[1].power.equals(1)||p.hasFunc())&&F.integration.stop(),g){case l:f=e.symfunction(Y,[p]);break;case Y:f=e.symfunction(l,[p]),f.negate();break;case S:f=e.parse(se(`${z.LOG}(sec({0}))`,p));break;case o:f=e.parse(se(`${z.LOG}(tan({0})+sec({0}))`,p));break;case w:f=e.parse(se(`-${z.LOG}(csc({0})+cot({0}))`,p));break;case y:f=e.parse(se(`${z.LOG}(sin({0}))`,p));break;case J:f=e.symfunction(ce,[p]);break;case ce:f=e.symfunction(J,[p]);break;case pe:f=e.parse(se(`${z.LOG}(cosh({0}))`,p));break;case b:f=F.integration.by_parts(C,U,x,W);break;case L:f=F.integration.by_parts(C,U,x,W);break;case B:f=F.integration.by_parts(C,U,x,W);break;case We:f=F.integration.by_parts(C,U,x,W);break;case Ie:f=F.integration.by_parts(C,U,x,W);break;case Ve:f=F.integration.by_parts(C,U,x,W);break;case ae:f=e.parse(se("atan(sinh({0}))",p));break;case Oe:f=e.parse(se(`${z.LOG}(tanh(({0})/2))`,p));break;case Re:f=e.parse(se(`${z.LOG}(sinh({0}))`,p));break;case _e:f=F.integrate(e.parse(se("e^({0})",p)),U,x);break;case"S":{let A=C.args[0].clone(),H=F.integration.decompose_arg(A,U),P=H[1],X=H[0],ne=H[3];f=e.parse(se("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",X,ne,c));break}case"C":{let A=C.args[0].clone(),H=F.integration.decompose_arg(A,U),P=H[1],X=H[0],ne=H[3];f=e.parse(se("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",X,ne,P));break}case"erf":{let A=C.args[0].clone(),H=F.integration.decompose_arg(A,U),P=H[1],X=H[0];f=e.parse(se("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",X,P,A));break}case"sign":f=e.multiply(C.clone(),p.clone());break;default:F.integration.stop()}f=e.divide(f,i)}else if(c.isLinear())if(g===l||g===Y){let h=Number(C.power);if(h<0)C.fname=g===Y?w:o,C.invert().updateHash(),f=F.integrate(C,U,x);else{let v=C.args[0],A=C.clone(),H=C.clone(),P=new K((h-1)/h),X=e.multiply(i.clone(),new K(h)).invert();A.power=A.power.subtract(new $(1)),H.power=H.power.subtract(new $(2));let ne=e.symfunction(g===l?Y:l,[p.clone()]);g===Y&&ne.negate(),f=e.add(e.multiply(e.multiply(X,A),ne),e.multiply(P,F.integrate(e.parse(H),U,x)))}}else if(g===S||g===y){if(C.args[0].isLinear(U)){let h=C.power.subtract(new $(1)).toString(),v=C.clone().toUnitMultiplier(),A=e.parse(se(`${g===y?"-":""}1/({2}*{0})*{3}({1})^({0})`,h,p,i,g));v.power=v.power.subtract(new $(2)),v.power.equals(0)&&(v=e.parse(v)),f=e.subtract(A,F.integrate(v,U,x))}}else if(g===o||g===w){let h=C.power.subtract(new $(1)).toString(),v=C.power.subtract(new $(2)).toString(),A=g===o?S:y,H=C.clone().toUnitMultiplier(),P=se(`${g===w?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,i,h,v,p,g,A),X=e.parse(P);H.power=H.power.subtract(new $(2)),H.power.equals(0)&&(H=e.parse(H)),f=e.add(X,e.multiply(new K(v/h),F.integrate(H,U,x)))}else(g===ce||g===J)&&C.power.equals(2)?f=F.integrate(C.fnTransform(),U,x):F.integration.stop();else F.integration.stop();f.multiplier=f.multiplier.multiply(_)}}else if(N===ye)f=F.integration.partial_fraction(C,U,x);else if(N===ee){C.getDenom().group===ue&&(C=e.expand(C));let _=C.stripVar(U),t=e.divide(C.clone(),_.clone());if(_.contains(U)&&(t=e.multiply(t,_),_=new K(1)),t.group===ee){let i=t.collectSymbols().sort((g,h)=>g.group===h.group?Number(g.power)===Number(h.power)?g<h?1:-1:h.power-g.power:h.group-g.group).map(g=>{let h=K.unwrapSQRT(g,!0);return h.fname===_e?e.parse(se("({1})*e^({0})",h.args[0],h.multiplier)):h}),c=i.length;if(C.power<0){if(c===2)return F.integrate(e.expand(C),U,x,W)}else if(c===2){try{f=F.integration.u_substitution(i,U)}catch(g){if(g.message==="timeout")throw g}if(!f){let g=i[0].group,h=i[1].group,v=i[0],A=i[1],H=v.fname,P=A.fname;if(C=e.multiply(v.clone(),A.clone()),g===we&&h===we)if(H===Fe||P===Fe)f=F.integration.by_parts(C.clone(),U,x,W);else{i.sort((ke,be)=>be.fname>ke.fname);let X=v.args[0];(!X.isLinear()||!(X.group===Ae||X.group===ee||X.group===ue))&&F.integration.stop();let ne=F.integration.decompose_arg(X,U),fe=ne[1],de=ne[0];fe.isLinear()||F.integration.stop();let Se=A.args[0];if(X.equals(Se))if(H===Y&&P===l||H===l&&P===Y)if(v.power.lessThan(0)&&F.integration.stop(),H===Y&&v.power.add(A.power).equals(0))v.fname=S,v.updateHash(),f=F.integrate(v,U,x);else if(pt(v.power)&&P===l&&A.power.lessThan(0)){let ke=Number(v.power)/2,be=e.parse(se("(1-cos({0})^2)^({1})",v.args[0],ke));f=F.integrate(e.expand(e.multiply(be,A.clone())),U,x,W)}else if(pt(v.power)&&P===Y&&A.power.lessThan(0)){let ke=Number(v.power)/2,be=e.parse(se("(1-sin({0})^2)^({1})",v.args[0],ke));f=F.integrate(e.expand(e.multiply(be,A.clone())),U,x,W)}else{let ke=n.Utils.even(v.power),be=n.Utils.even(A.power);if(f=new K(0),!ke||!be){let Pe,Je;ke?(Pe=v,Je=A):(Pe=A,Je=v);let De=Pe.fname===l?-1:1,ot=(Je.power-1)/2,mt=e.parse(`(1-${Pe.fname}${n.Utils.inBrackets(X)}^2)^${ot}`);e.expand(e.multiply(new K(De),e.multiply(Pe.clone(),mt))).each(_t=>{f=e.add(f,F.integration.poly_integrate(_t.clone()))})}else{let Pe=function(mt){let _t=mt.power/2,Lt;return mt.fname===l?Lt=`((1/2)+(cos(2*(${mt.args[0]}))/2))^${_t}`:Lt=`((1/2)-(cos(2*(${mt.args[0]}))/2))^${_t}`,e.parse(Lt)},Je=Pe(v),De=Pe(A),Qe=e.multiply(Je,De);return e.expand(Qe).each(mt=>{f=e.add(f,F.integrate(mt,U,x))}),e.multiply(f,_)}}else if(H===o&&P===S&&fe.isLinear()&&A.isLinear())f=e.parse(se("sec({0})^({1})/({1})",v.args[0],v.power));else if(H===S&&P===o&&fe.isLinear())if(v.isLinear()&&A.isLinear())f=e.divide(e.symfunction(o,[X.clone()]),de);else if(pt(v.power)){let ke=Number(v.power)/2,be=e.parse(se("(sec({0})^2-1)^({1})",v.args[0],ke));f=F.integrate(e.expand(e.multiply(be,A)),U,x)}else F.integration.stop();else if(H===o&&P===l)v.fname=l,v.invert().updateHash(),f=F.integrate(e.multiply(v,A),U,x);else if(H===Y&&P===w)A.fname=Y,A.invert().updateHash(),f=F.integrate(e.multiply(v,A),U,x);else if(H===S&&(P===l||P===Y)&&A.power.lessThan(0)){let ke=e.multiply(v.fnTransform(),A);f=F.integrate(e.expand(ke),U,x)}else{let ke=e.multiply(v.fnTransform(),A.fnTransform());f=F.integrate(e.expand(ke),U,x)}else if((H===Y||H===l)&&(P===Y||P===l))if(v.isLinear()&&A.isLinear())if(v.args[0].isLinear()&&A.args[0].isLinear()){let ke,be;P===Y?(ke=v.args[0],be=A.args[0]):(be=v.args[0],ke=A.args[0]);let Pe=e.parse(se("(sin(({1})+({0}))+sin(({1})-({0})))/2",ke.toString(),be.toString()));f=F.integrate(Pe,U,x)}else{let ke=Te(i);f=F.integrate(e.expand(ke),U,x)}else{let ke=new K(1);i.forEach(Pe=>{let Je=Pe.fnTransform();ke=e.multiply(ke,Je)});let be=e.expand(ke);f=F.integrate(be,U,x),f.hasIntegral()&&(f=F.integrate(Te(ke.collectSymbols()),U,x))}else F.integration.stop()}else if(g===we&&h===ue){let X=v.isLinear();if(v.fname===l&&X&&A.power.equals(-1))f=e.symfunction("Ci",[v.args[0]]);else if(v.fname===l&&A.power.equals(-1))f=F.integrate(e.multiply(v.fnTransform(),A.clone()),U,x);else if(v.fname===ce&&X&&A.power.equals(-1))f=e.symfunction("Chi",[v.args[0]]);else if(v.fname===ce&&A.power.equals(-1))f=F.integrate(e.multiply(v.fnTransform(),A.clone()),U,x);else if(v.fname===Y&&X&&A.power.equals(-1))f=e.symfunction("Si",[v.args[0]]);else if(v.fname===Y&&A.power.equals(-1))f=F.integrate(e.multiply(v.fnTransform(),A.clone()),U,x);else if(v.fname===J&&X&&A.power.equals(-1))f=e.symfunction("Shi",[v.args[0]]);else if(v.fname===J&&A.power.equals(-1))f=F.integrate(e.multiply(v.fnTransform(),A.clone()),U,x);else if(v.fname===Fe&&A.power.equals(-1))f=F.integration.poly_integrate(v,U,x);else if(v.fname==="erf"){if(A.power.equals(1)){let ne=F.integration.decompose_arg(v.args[0],U),fe=ne[0],de=ne[1],Se=v.args[0].toString();f=e.parse(se("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",fe,de,Se))}}else f=F.integration.by_parts(C,U,x,W)}else if(g===Le&&h===ue){let X=H===Fe?F.integration.decompose_arg(v.args[0],U)[1]:null;v.isE()&&(v.power.group===ue||v.power.group===ee)&&A.power.equals(-1)?f=e.symfunction("Ei",[v.power.clone()]):H===Fe&&X.value===A.value?f=F.integration.poly_integrate(v,U,x):f=F.integration.by_parts(C,U,x,W)}else if(g===ye&&h===ue){if(A.value===v.value&&v.power.equals(-1)){let X=Math.min.apply(null,n.Utils.keys(v.symbols)),ne=Math.min(X,A.power),fe=A.clone();fe.power=new $(ne),A=e.divide(A,fe.clone());let de=new K(0);v.each(Se=>{de=e.add(de,e.divide(Se.clone(),fe.clone()))}),de.multiplier=v.multiplier,C=e.divide(A,de)}else C=e.expand(C);f=F.integration.partial_fraction(C,U,x)}else if(g===Ae&&h===ue){let X=v.clone().toLinear(),ne=n.Algebra.degree(X,e.parse(U)).equals(1);if(v.power.equals(-1/2)){let fe=F.integration.decompose_arg(v.clone().toLinear(),U),de=fe[0].negate(),Se=fe[1],ke=fe[3],be=Number(v.power),Pe=Number(A.power);if(u(Pe)&&n.Utils.even(Pe)&&Se.power.equals(2)){let Je=e.divide(e.multiply(e.pow(ke.clone(),new K(2)),e.symfunction(xe,[e.divide(ke.clone(),de.clone())])),e.pow(de.clone(),new K(2)));Je=e.multiply(Je,e.symfunction(xe,[ke]).invert());let De=e.parse("sin(u)");De.power=De.power.multiply(A.power);let Qe=F.integrate(De,"u",x),ot=e.parse(`${E}(${xe}(${de}/${ke})*${U})`);f=e.multiply(Je,Qe.sub(new K("u"),ot))}else if(be===-1/2){let Je=function(De,Qe){let ot=e.parse(F.integrate(De,U,x,W).sub(U,se(Qe,U)));if(!ot.hasIntegral())return ot};Pe===-1?f=Je(e.expand(e.expand(e.pow(e.multiply(v.invert(),A.invert()),new K(2)))).invert(),"sqrt(1-1/({0})^2)"):Pe===-2&&(f=Je(e.sqrt(e.expand(e.divide(e.pow(C,new K(2)).invert(),e.pow(new K(U),new K(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(v.power.equals(-1)&&A.isLinear()&&ne)f=F.integration.partial_fraction(C,U,x);else if(!v.power.lessThan(0)&&u(v.power)){let fe=e.expand(v);f=new K(0),fe.each(de=>{de.group===ye?de.each(Se=>{f=e.add(f,F.integrate(e.multiply(A.clone(),Se),U,x))}):f=e.add(f,F.integrate(e.multiply(A.clone(),de),U,x))})}else if(v.power.lessThan(-2))f=F.integration.by_parts(C,U,x,W);else if(v.power.lessThan(0)&&A.power.greaterThan(1)){let fe=F.integration.decompose_arg(v.clone().toLinear(),U),de=fe[0].negate(),Se=fe[1],ke=fe[3],be=v.clone().toLinear();if(Se.group!==ye&&Se.isLinear()){let Pe=Number(A.power),Je="_u_",De=new K(Je),Qe=e.expand(e.divide(e.pow(e.subtract(De.clone(),ke.clone()),new K(Pe)),De.clone())),ot={};ot[Je]=be;let mt=e.parse(Qe,ot);f=F.integrate(mt,U,0)}else if(A.power.greaterThan(Se.power)||A.power.equals(Se.power)){let Pe=new n.Algebra.Classes.Factors;v=n.Algebra.Factor.coeffFactor(v.invert(),Pe);let Je=n.Algebra.divide(A,v);Je.group===ee?f=F.integration.by_parts(C,U,x,W):(f=new K(0),Je.each(De=>{f=e.add(f,F.integrate(De,U,x))}),Pe.each(De=>{f=e.divide(f,De)}),f=e.expand(f))}else f=F.integration.partial_fraction(C,U,x)}else if(v.power.den.equals(2)){let fe=F.integration.decompose_arg(v.clone().toLinear(),U),de=fe[3],Se=fe[1],ke=fe[0],be=fe[2];if(Se.power.equals(2)&&ke.lessThan(0)){de.equals(1)||(_=e.multiply(_,e.pow(de,new K(2))));let Pe=U,Je=e.divide(e.pow(ke.clone().negate(),new K(1/2)),e.pow(de,new K(1/2))),De=e.symfunction(l,[new K(Pe)]),Qe=e.pow(e.symfunction(l,[new K(Pe)]),new K(v.power.num)),ot=e.pow(e.symfunction(Y,[new K(Pe)]),new K(A.power)),mt=e.multiply(e.multiply(Qe,De),ot);f=F.integrate(mt,Pe,x).sub(Pe,e.symfunction(E,[e.multiply(new K(U),Je)]))}else f=F.integration.partial_fraction(C,U,x,W)}else ne&&(f=F.integration.partial_fraction(C,U,x))}else if(v.isComposite()&&A.isComposite())if(f=new K(0),v.power.greaterThan(0)&&A.power.greaterThan(0))e.expand(C).each(ne=>{f=e.add(f,F.integrate(ne,U,x))},!0);else{let X=Number(v.power),ne=Number(A.power);if(X<0&&ne>0){let fe=v;v=A,A=fe}X===-1&&ne===-1?f=F.integration.partial_fraction(C,U):v.each(fe=>{let de=e.multiply(fe,A.clone()),Se=F.integrate(de,U,x);f=e.add(f,Se)})}else if(g===Ae&&i[0].power.greaterThan(0))v=e.expand(v),f=new K(0),v.each(X=>{f=e.add(f,F.integrate(e.multiply(X,A.clone()),U,x))},!0);else if(g===we&&h===Le&&n.Utils.inHtrig(v.fname))v=v.fnTransform(),f=F.integrate(e.expand(e.multiply(v,A)),U,x);else if(g===we&&h===Ae||h===we&&g===Ae){if(h===we&&g===Ae){let be=v;v=A,A=be}let X,ne,fe,de,Se=K.unwrapSQRT(F.diff(v.clone(),U),!0),ke=K.unwrapSQRT(A,!0);if(Se.power.equals(ke.power)){if(X=new K(A.power),fe=Se.clone().toLinear(),de=A.clone().toLinear(),ne=n.Algebra.divide(fe.toLinear(),de),ne.isConstant()){let be=e.pow(ne,X.negate());f=e.multiply(be,F.integration.poly_integrate(v.clone()))}}else f=F.integration.by_parts(C,U,x,W)}else{let X=v.clone().toLinear(),ne=A.clone().toLinear();g===Le&&h===Le&&v.power.contains(U)&&A.power.contains(U)&&!X.contains(U)&&!ne.contains(U)?f=e.parse(se("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",X.toString(),ne.toString(),v.power.multiplier.toString(),A.power.multiplier.toString(),U)):f=F.integration.by_parts(C,U,x,W)}}}else if(c===3&&(i[2].group===ue&&i[2].power.lessThan(2)||i[0].group===Ae)){let g=i[0];if(g.group===Ae){g.power.greaterThan(1)&&(g=e.expand(g));let h=e.multiply(i[1],i[2]);f=new K(0),g.each(v=>{let A=e.multiply(v,h.clone()),H=F.integrate(A,U,x);f=e.add(f,H)},!0)}else f=F.integration.by_parts(C,U,x,W)}else if(st(i)){let g=new K(1);for(let h=0,v=i.length;h<v;h++)g=e.multiply(g,i[h].fnTransform());g=e.expand(g),f=F.integrate(g,U,x)}else{let g=Te(i);f=F.integrate(e.expand(g),U,x)}}else{if(t.equals(1))return F.integrate(e.expand(C),U,x);t.clone().toLinear().isPoly(!0)&&n.Utils.variables(t).length>1&&(t=n.Algebra.Factor.factorInner(t)),f=F.integrate(t,U,x)}f=e.multiply(f,_)}if(f)return f}catch(p){if(p.message==="timeout"||!(p instanceof je||p instanceof n.exceptions.DivisionByZero))throw p}return e.symfunction("integrate",[j,Z])},!1))},defint(j,Z,x,W){W||="x";let U=function(_,t,i){try{return e.parse(_,t)}catch(c){if(c.message==="timeout")throw c;return F.Limit.limit(_,W,i)}},C=n.Utils.variables(j),N=j.hasTrig(),f,p;if(C.length===1&&!W&&(W=C[0]),N||(p=F.integrate(j,W)),!N&&!p.hasIntegral()){let _={},t={};_[W]=x,t[W]=Z;let i=U(p,_,x,W),c=U(p,t,Z,W);f=e.subtract(i,c)}else if(C.length===1&&Z.isConstant()&&x.isConstant()){let _=n.Utils.build(j);f=new K(n.Math2.num_integrate(_,Number(Z),Number(x)))}else f=e.symfunction("defint",[j,Z,x,W]);return f},Limit:{interval(j,Z){return e.parse(se("[{0}, {1}]",j,Z))},diverges(){return F.Limit.interval("-Infinity","Infinity")},divide(j,Z,x,W,U){if(U++>z.max_lim_depth)return;let C=j.clone(),N=Z.clone();if(Z.fname===He){let A=j.sign(),H=W.sign();if(W.isInfinity)return e.multiply(new K(A),new K(H));if(W.equals(0)){let P=e.parse(j.multiplier),X=e.parse(Z.multiplier);return e.divide(e.multiply(P,F.Limit.interval("-1","1")),X)}return F.Limit.diverges()}let f=function(A){if(n.Utils.isVector(A)){for(let H=0;H<A.elements.length;H++)if(!A.elements[H].isInfinity)return!1;return!0}return A.isInfinity},p=function(A,H){return n.Utils.isVector(A)?!1:A.equals(H)},_,t=0,i,c,g;do if(i=lt(F.Limit.limit(j.clone(),x,W,U)),c=lt(F.Limit.limit(Z.clone(),x,W,U)),g=f(i)&&f(c)||p(i,0)&&p(c,0),g){let A=F.diff(j.clone(),x),H=F.diff(Z.clone(),x),P=e.divide(A,H);j=P.getNum(),Z=P.getDenom()}while(g&&++t<z.max_lim_depth);if(t>=z.max_lim_depth)return;let h=c.equals(0),v=Number(N.power);return W.isConstant(!0)&&h?_=K.infinity(n.Utils.even(v)&&i.lessThan(0)?-1:void 0):h?_=F.Limit.diverges():_=e.divide(i,c),_},rewriteToLog(j){let Z=j.power.clone();return j.toLinear(),e.pow(new K("e"),e.multiply(Z,e.symfunction(`${z.LOG}`,[j])))},getSubbed(j,Z,x){let W;j.group===Le&&(j=F.rewriteToLog(j));try{W=j.sub(Z,x)}catch(U){if(U.message==="timeout")throw U;W=j}return W},isInterval(j){return n.Utils.isVector(j)},isConvergent(j){return!(F.Limit.isInterval(j)&&j.elements[0].isInfinity&&j.elements[1].isInfinity||j.containsFunction("limit"))},limit(j,Z,x,W){if(j.isLinear()&&j.isComposite()){let N=new K(0);return j.each(f=>{N=e.add(N,F.Limit.limit(f,Z,x,W))},!0),N}if(j=n.Algebra.Simplify.simplify(j),W||=1,W++>z.max_lim_depth)return;let U=e.parse(j.multiplier);j.toUnitMultiplier();let C;try{if(j.isConstant(!0))C=j;else{let N={};N[Z]=x;try{let f=e.parse(j.sub(Z,x),N);(f.isConstant(!0)||f.isInfinity)&&(C=f)}catch(f){if(f.message==="timeout")throw f}if(!C){let f=j.getNum(),p=j.getDenom();if(p.isConstant(!0)){if(j.group===Le){let _=j.clone().toLinear(),t=j.power.clone(),i=_.getNum(),c=_.getDenom(),g=n.Utils.decompose_fn(c,Z,!0);if(i.group===ue&&i.multiplier.isOne()&&g.ax.group===ue&&g.b.isConstant(!0)&&g.a.isOne()&&g.b.isConstant(!0))C=e.parse(se("(1/e^({0}))",g.b));else{let h=F.Limit.rewriteToLog(j.clone()),v=h.power.clone(),A=h.clone().toLinear(),H=F.Limit.limit(A,Z,x,W),P=F.Limit.limit(v,Z,x,W);C=e.pow(H,P)}}else if(j.group===we&&j.args.length===1){let _,t=F.Limit.limit(j.args[0],Z,x,W);if(n.Utils.isVector(t))return C=t.map(c=>{let g=j.clone();return g.args[0]=c,F.Limit.limit(e.symfunction(j.fname,[c]),Z,x,W)}),e.multiply(U,C);let i;if(t.isConstant(!0)){i=e.symfunction(j.fname,[t]);try{lt(i),_=!0}catch(c){if(c.message==="timeout")throw c;_=!1}}if(_)C=i;else if(F.Limit.isConvergent(t)){if(j.fname===Fe)switch(t.toString()){case"0":C=K.infinity().negate();break;case"Infinity":C=K.infinity();break;case"-Infinity":C=K.infinity();break}else if((j.fname===l||j.fname===Y)&&x.isInfinity)C=F.Limit.interval(-1,1);else if(j.fname===S){let c=j.args[0],g=c.getNum(),h=c.getDenom(),v=g.toUnitMultiplier();(x.isInfinity||v.equals("pi")&&h.equals(2))&&(C=F.Limit.diverges())}else if(j.fname===z.FACTORIAL&&t.isInfinity)return K.infinity()}}else if(j.group===ue){if(j.power>0)return e.parse(j,N);n.Utils.even(j.power)?C=K.infinity():C=F.Limit.diverges()}else if(j.group===ee){let _,t,i=j.collectSymbols().sort((g,h)=>g.group-h.group),c=i.pop();for(_=lt(F.Limit.limit(c,Z,x,W));i.length;){let g=i.pop();t=lt(F.Limit.limit(g,Z,x,W)),_.isInfinity||!F.Limit.isConvergent(_)&&t.equals(0)||_.equals(0)&&F.Limit.isConvergent(t)?(g.containsFunction(Fe)&&(g=[c,c=g][0]),g.invert(),_.isInfinity&&t.isInfinity?_=K.infinity():_=F.Limit.divide(c,g,Z,x,W)):(_=e.multiply(_,t),c=e.multiply(c,g))}C=_}else if(j.isComposite()){let _;j.isLinear()||(j=e.expand(j)),C=new K(0);let t=j.collectSymbols().sort((g,h)=>h.group-g.group),i=[],c=new K(0);for(let g=0,h=t.length;g<h;g++){let v=t[g].clone();v.group===we||v.group===ee&&v.hasFunc()?c=e.add(c,v):i.push(v)}i.unshift(c),i.length!==1&&(t=i);for(let g=0,h=t.length;g<h;g++){let v=t[g];try{_=F.Limit.limit(v,Z,x,W)}catch(A){if(A.message==="timeout")throw A;_=F.Limit.diverges()}try{C=e.add(C,_)}catch(A){if(A.message==="timeout")throw A;if(W++>z.max_lim_depth)return;C=F.Limit.limit(F.diff(j,Z),Z,x,W)}}}}else C=F.Limit.divide(f,p,Z,x,W)}}C||=e.symfunction("limit",[j,Z,x])}catch(N){if(N.message==="timeout")throw N;C=e.symfunction("limit",[j,Z,x])}return e.multiply(U,C)}},Fresnel:{S(j){return j.isConstant(!0)?F.defint(e.parse("sin(pi*x^2/2)"),K(0),j,"x"):e.symfunction("S",[j])},C(j){return j.isConstant(!0)?F.defint(e.parse("cos(pi*x^2/2)"),K(0),j,"x"):e.symfunction("C",[j])}}};z0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return F.diff}},{name:"sum",visible:!0,numargs:4,build(){return F.sum}},{name:"product",visible:!0,numargs:4,build(){return F.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return F.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return F.defint}},{name:"S",visible:!0,numargs:1,build(){return F.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return F.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return F.Limit.limit}}]),z0.updateAPI()})()});var Q0=g0((Xi,hn)=>{"use strict";var N0;typeof hn<"u"&&(N0=k0(),W0());(function(){let n=N0.getCore(),e=n.PARSER,{N:$}=n.groups,{P:z}=n.groups,{S:me}=n.groups,{EX:we}=n.groups,{FN:K}=n.groups,{PL:le}=n.groups,{CP:V}=n.groups,{CB:u}=n.groups,{keys:se}=n.Utils,{even:pt}=n.Utils,{variables:lt}=n.Utils,{format:ze}=n.Utils,{round:ue}=n.Utils,{Frac:ye}=n,{isInt:Ae}=n.Utils,{NerdamerSymbol:ee}=n,{CONST_HASH:Le}=n.Settings,Xe=n.Utils.importFunctions(),Fe=n.Utils.evaluate;function _e(l,S,o){if(n.Utils.isSymbol(l))this.parse(l),this.variable||=S;else if(isNaN(l))typeof l=="string"&&this.parse(e.parse(l));else{if(o||=0,S===void 0)throw new n.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[o]=l,this.fill(l)}}_e.fromArray=function(S,o){if(typeof o>"u")throw new n.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let w=new _e;return w.coeffs=S,w.variable=o,w},_e.fit=function(S,o,w,y,E,O){let G=new Array(E+1),b=w-o;G[0]=o,G[E]=S,b-=S*y**E;for(let L=E-1;L>0;L--){let B=y**L,J=b/B,pe=Math.sign(J)*Math.floor(Math.abs(J));b-=pe*B,G[L]=pe}if(b!==0)return null;for(let L=0;L<G.length;L++)G[L]=new ye(G[L]);return _e.fromArray(G,O)},_e.prototype={parse(l,S){if(this.variable=lt(l)[0],!l.isPoly())throw n.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${n.Utils.text(l)}`);if(S||=[],l.power.absEquals(1)||(l=e.expand(l)),l.group===n.groups.N)S[0]=l.multiplier;else if(l.group===n.groups.S)S[l.power.toDecimal()]=l.multiplier;else for(let o in l.symbols){if(!Object.hasOwn(l.symbols,o))continue;let w=l.symbols[o],y=w.power;if(n.Utils.isSymbol(y))throw new n.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");y=w.group===$?0:y.toDecimal(),w.symbols?this.parse(w,S):S[y]=w.multiplier}this.coeffs=S,this.fill()},fill(l){l=Number(l)||0;let S=this.coeffs.length;for(let o=0;o<S;o++)this.coeffs[o]===void 0&&(this.coeffs[o]=new ye(l));return this},trim(){let l=this.coeffs.length;for(;l--;){let S=this.coeffs[l],o=S.equals(0);if(S&&o){if(l===0)break;this.coeffs.pop()}else break}return this},modP(l){let S=this.coeffs.length;for(let o=0;o<S;o++){let w=this.coeffs[o],y;if(w<0){let G;for(y=o;y<S;y++)if(this.coeffs[y]>0){G=this.coeffs[y];break}if(G){for(;y>o;y--)this.coeffs[y]=this.coeffs[y].subtract(new ye(1)),this.coeffs[y-1]=this.coeffs[y-1].add(new ye(l));w=this.coeffs[o]}}let E=w.mod(l),O=w.subtract(E).divide(l);if(!O.equals(0)){let G=o+1,b=this.coeffs[G]||new ye(0);b=b.add(O),this.coeffs[G]=new ye(b),this.coeffs[o]=new ye(E)}}return this},add(l){let S=Math.max(this.coeffs.length,l.coeffs.length);for(let o=0;o<S;o++){let w=this.coeffs[o]||new ye(0),y=l.coeffs[o]||new ye(0);this.coeffs[o]=w.add(y)}return this},subtract(l){let S=Math.max(this.coeffs.length,l.coeffs.length);for(let o=0;o<S;o++){let w=this.coeffs[o]||new ye(0),y=l.coeffs[o]||new ye(0);this.coeffs[o]=w.subtract(y)}return this},divide(l){let{variable:S}=this,o=n.Utils.arrayClone(this.coeffs),w=n.Utils.arrayClone(l.coeffs),y=o.length,E=w.length-1,O=[];for(let L=0;L<y;L++){let B=y-(L+1),J=B-E,ce=o[B].divide(w[E]);if(J<0)break;O[J]=ce;for(let pe=0;pe<=E;pe++)o[pe+J]=o[pe+J].subtract(w[pe].multiply(ce))}let G=_e.fromArray(o,S||"x").trim();return[_e.fromArray(O,S||"x"),G]},multiply(l){let S=this.coeffs.length,o=l.coeffs.length,w=[];for(let y=0;y<S;y++){let E=this.coeffs[y];for(let O=0;O<o;O++){let G=y+O,b=l.coeffs[O],L=w[G]||new ye(0);w[G]=L.add(E.multiply(b))}}return this.coeffs=w,this},isZero(){let l=this.coeffs.length;for(let S=0;S<l;S++)if(!this.coeffs[S].equals(0))return!1;return!0},sub(l){let S=new ye(0),o=this.coeffs.length;for(let w=0;w<o;w++){let y=this.coeffs[w];y.equals(0)||(S=S.add(y.multiply(new ye(l**w))))}return S},clone(){let l=new _e;return l.coeffs=this.coeffs,l.variable=this.variable,l},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let l=this.lc(),S=this.coeffs.length;for(let o=0;o<S;o++)this.coeffs[o]=this.coeffs[o].divide(l);return this},gcd(l){let S=this.coeffs.length-1,o=l.coeffs.length-1,w;if(S<o)return l.gcd(this);let y=this;for(;!l.isZero();){let O=l.clone();y=y.clone(),w=y.divide(O),l=w[1],y=O}let E=n.Math2.QGCD.apply(null,y.coeffs);if(!E.equals(1)){let O=y.coeffs.length;for(let G=0;G<O;G++)y.coeffs[G]=y.coeffs[G].divide(E)}return y},diff(){let l=[],S=this.coeffs.length;for(let o=1;o<S;o++)l.push(this.coeffs[o].multiply(new ye(o)));return this.coeffs=l,this},integrate(){let l=[0],S=this.coeffs.length;for(let o=0;o<S;o++){let w=new ye(o+1);l[w]=this.coeffs[o].divide(w)}return this.coeffs=l,this},gcf(l){let S=function(y){for(let E=0;E<y.length;E++)if(!y[E].equals(0))return E},o=[];for(let y=0;y<this.coeffs.length;y++){let E=this.coeffs[y];!E.equals(0)&&o.indexOf(E)===-1&&o.push(E)}let w=[n.Math2.QGCD.apply(void 0,o),S(this.coeffs)].toDecimal();if(l){let y=[];y[w[1]-1]=w[0],w=_e.fromArray(y,this.variable).fill()}return w},quad(l){let S=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let o=this.coeffs[2]||0,w=this.coeffs[1]||0,y=this.coeffs[0],E=w*w-4*o*y;return E<0&&!l||(S[0]=(-w+Math.sqrt(E))/(2*o),S[1]=(-w-Math.sqrt(E))/(2*o)),S},squareFree(){let l=this.clone(),S=1,o=l.clone().diff(),w=l.clone().gcd(o),y=l.divide(w)[0],E=_e.fromArray([new ye(1)],l.variable);for(;!w.equalsNumber(1);){let O=y.gcd(w),G=y.divide(O)[0];if(!G.equalsNumber(1)&&S>1){let b=G.clone();for(let L=1;L<S;L++)b.multiply(G.clone());G=b}E=E.multiply(G),S++,y=O,w=w.divide(O)[0]}return[E,y,S]},toSymbol(){let l=this.coeffs.length,{variable:S}=this;if(l===0)return new n.NerdamerSymbol(0);let o=l-1,w="";for(let y=0;y<l;y++){let E=y===o?"":"+",O=this.coeffs[y];O.equals(0)||(w+=`${O}*${S}^${y}${E}`)}return e.parse(w)},equalsNumber(l){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(l)},toString(){return this.toSymbol().toString()}},ee.prototype.coeffs=function(S,o){o&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),S||=[];let w=this.clone().distributeMultiplier();if(w.isComposite())for(let y in w.symbols){if(!Object.hasOwn(w.symbols,y))continue;let E=w.symbols[y];E.isComposite()?E.clone().distributeMultiplier().coeffs(S,o):o?S[E.isConstant()?0:E.power.toDecimal()]=E.multiplier:S.push(E.multiplier)}else if(o)S[w.isConstant(!0)?0:w.power.toDecimal()]=w.multiplier;else if(w.group===u&&w.isImaginary()){let y=new ee(w.multiplier);w.each(E=>{(E.isConstant(!0)||E.imaginary)&&(y=e.multiply(y,E))}),S.push(y)}else S.push(w.multiplier);if(o)for(let y=0;y<S.length;y++)S[y]===void 0&&(S[y]=new ee(0));return S},ee.prototype.tBase=function(S){if(typeof S>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let o=[],w=this.collectSymbols(null,null,null,!0),y=w.length;for(let E=0;E<y;E++){let O=w[E],G=O.group,b=new xe(O.multiplier,[],S);if(G===u)for(let L in O.symbols){if(!Object.hasOwn(O.symbols,L))continue;let B=O.symbols[L];b.terms[S[L]]=B.power}else b.terms[S[O.value]]=O.power;o.push(b.fill()),b.updateCount()}return o},ee.prototype.altVar=function(S){let o=this.multiplier.toString(),w=this.power.toString();return(o==="1"?"":`${o}*`)+S+(w==="1"?"":`^${w}`)},ee.prototype.sameVars=function(S){if(!(this.symbols||this.group===S.group))return!1;for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let w=this.symbols[o],y=S.symbols[o];if(!y||w.value!==y.value)return!1}return!0},ee.prototype.groupTerms=function(S){S=String(S);let o,w,y,E=[];return this.each(O=>{if(O.group===le){y=O.groupTerms(S);for(let G=0;G<y.length;G++){let b=y[G];b&&(E[G]=b)}}else o=n.Utils.decompose_fn(O,S,!0),w=o.x.value===S?Number(o.x.power):0,E[w]=e.add(E[w]||new ee(0),o.a)}),E},ee.prototype.collectFactors=function(){let S=[];return this.group===u?this.each(o=>{S.push(o.clone())}):S.push(this.clone()),S};function He(){this.factors={},this.length=0}He.prototype.getNumberSymbolics=function(){let S=0;return this.each(o=>{o.isConstant(!0)||S++}),S},He.prototype.add=function(S){if(S.equals(0))return this;if(S.equals(-1)&&this.length>0){let o=n.Utils.firstObject(this.factors,null,!0),w=e.symfunction(n.Settings.PARENTHESIS,[o.obj]).negate();return delete this.factors[o.key],this.add(w),this.length--,this}if(S.group===u){let o=this;S.multiplier.equals(1)||o.add(new ee(S.multiplier)),S.each(w=>{o.add(w)})}else{this.preAdd&&(S=this.preAdd(S)),this.pFactor&&(S=e.pow(S,new ee(this.pFactor)));let o=S.isConstant();if(o&&S.equals(1))return this;let w=o?S.value:S.text();w in this.factors?(this.factors[w]=e.multiply(this.factors[w],S),this.factors[w].equals(1)&&(delete this.factors[w],this.length--)):(this.factors[w]=S,this.length++)}return this},He.prototype.toSymbol=function(){let S=new ee(1),o=Object.values(this.factors).sort((w,y)=>w.group>y.group);for(let w=0,y=o.length;w<y;w++){let E=o[w],O=E.power.equals(1)&&E.fname!==""?e.symfunction(n.PARENTHESIS,[E]):E;S=e.multiply(S,O)}return S.fname===""&&(S=ee.unwrapPARENS(S)),S},He.prototype.merge=function(S){for(let o in S)o in this.factors?this.factors[o]=e.multiply(this.factors[o],S[o]):this.factors[o]=S[o];return this},He.prototype.each=function(S){for(let o in this.factors){if(!Object.hasOwn(this.factors,o))continue;let w=this.factors[o];w.fname===n.PARENTHESIS&&w.isLinear()&&(w=w.args[0]),S.call(this,w,o)}return this},He.prototype.count=function(){return se(this.factors).length},He.prototype.clean=function(){try{let S=n.Settings.CONST_HASH;this.factors[S].lessThan(0)&&(this.factors[S].equals(-1)?delete this.factors[S]:this.factors[S].negate(),this.each(o=>{o.negate()}))}catch(S){if(S.message==="timeout")throw S}},He.prototype.toString=function(){return this.toSymbol().toString()};function xe(l,S,o){this.terms=S||[],this.coeff=l,this.map=o,this.sum=new n.Frac(0),this.image=void 0}xe.prototype.updateCount=function(){this.count||=0;for(let S=0;S<this.terms.length;S++)this.terms[S].equals(0)||this.count++;return this},xe.prototype.getVars=function(){let S=[];for(let o=0;o<this.terms.length;o++){let w=this.terms[o],y=this.getRevMap();w.equals(0)||S.push(this.revMap[o])}return S.join(" ")},xe.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count},xe.prototype.toSymbol=function(S){S||=this.getRevMap();let o=new ee(this.coeff);for(let w=0;w<this.terms.length;w++){let y=S[w],E=this.terms[w];if(E.equals(0)||y===Le)continue;let O=new ee(y);O.power=E,o=e.multiply(o,O)}return o},xe.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let S={};for(let o in this.map)Object.hasOwn(this.map,o)&&(S[this.map[o]]=o);return this.revMap=S,S},xe.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},xe.prototype.getImg=function(){return this.image||this.generateImage(),this.image},xe.prototype.fill=function(){let S=this.map.length;for(let o=0;o<S;o++)typeof this.terms[o]>"u"?this.terms[o]=new n.Frac(0):this.sum=this.sum.add(this.terms[o]);return this},xe.prototype.divide=function(S){let o=this.coeff.divide(S.coeff),w=this.terms.length,y=new xe(o,[],this.map);for(let E=0;E<w;E++)y.terms[E]=this.terms[E].subtract(S.terms[E]),y.sum=y.sum.add(y.terms[E]);return y},xe.prototype.multiply=function(S){let o=this.coeff.multiply(S.coeff),w=this.terms.length,y=new xe(o,[],this.map);for(let E=0;E<w;E++)y.terms[E]=this.terms[E].add(S.terms[E]),y.sum=y.sum.add(y.terms[E]);return y},xe.prototype.isZero=function(){return this.coeff.equals(0)},xe.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},n.Utils.toMapObj=function(S){let o=0,w={};for(let y=0;y<S.length;y++){let E=S[y];typeof w[E]>"u"&&(w[E]=o,o++)}return w.length=o,w},n.Utils.filledArray=function(S,o,w){let y=[];for(;o--;)y[o]=w?new w(S):S;return y},n.Utils.arrSum=function(S){let o=0,w=S.length;for(let y=0;y<w;y++)o+=S[y];return o},n.Utils.haveIntersection=function(S,o){return o.length>S.length&&([S,o]=[o,S]),S.some(w=>o.indexOf(w)>-1)},n.Utils.subFunctions=function(S,o){o||={};let w=[],y=new Set(lt(S));return S.each(E=>{if(E.group===K||E.previousGroup===K){let O=n.Utils.text(E,"hash"),G=o[O];if(G)w.push(E.altVar(G));else{let b=0,L;do L=E.fname+se(o).length+(b>0?String(b):""),b++;while(y.has(L));o[O]=L,w.push(E.altVar(L))}}else E.group===u||E.group===le||E.group===V?w.push(n.Utils.subFunctions(E,o)):w.push(E.text())}),S.group===V||S.group===le?S.altVar(n.Utils.inBrackets(w.join("+"))):S.group===u?S.altVar(n.Utils.inBrackets(w.join("*"))):S.text()},n.Utils.getFunctionsSubs=function(S){let o={};for(let w in S)Object.hasOwn(S,w)&&(o[S[w]]=e.parse(w));return o};let Y=n.Algebra={version:"1.4.6",proots(l,S){S||=7;let o=0,w=[],y=function(O,G,b){let L=E(O,G,b).concat(w);for(let B=0;B<o;B++)L.unshift(0);return L};if(l instanceof ee&&l.isPoly()){if(l.distributeMultiplier(),l.group===le){let ce=n.Utils.arrayMin(se(l.symbols)),pe=l.symbols[ce].clone().toUnitMultiplier();l=e.expand(e.divide(l,pe)),w.push(0)}if(l.group===n.groups.S)return[0];if(l.group===n.groups.PL){let ce=se(l.symbols),pe=n.Utils.arrayMin(ce);l=n.PARSER.divide(l,n.PARSER.parse(`${l.value}^${pe}`))}let O=se(l.symbols).sort().pop(),G=l.group===n.groups.PL?l.symbols:l.symbols[O],b=G.group,L=b===me?[G.power.toDecimal()]:se(G.symbols),B=[],J=n.Utils.arrayMax(L);for(let ce=1;ce<=J;ce++){let pe=0;L.indexOf(`${ce}`)!==-1&&(b===me?pe=G.multiplier:pe=G.symbols[ce].multiplier),B.unshift(pe)}return B.push(l.symbols[Le].multiplier),G.group===me&&(B[0]=G.multiplier),y(B,L,J)}if(n.Utils.isArray(l)){let O=l,G=[],b=[],L=0;for(let J=0;J<O.length;J++){let ce=O[J][0],pe=O[J][1],Oe=pe-L-1;for(let ae=0;ae<Oe;ae++)G.unshift(0);G.unshift(ce),pe!==0&&b.push(pe),L=pe}let B=Math.max.apply(void 0,b);return y(G,b,B)}throw new n.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function E(O,G,b){let B,J=O.slice(0);if(O.unshift(b),b>100)throw new n.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let ce=[],pe={};for(pe.Degree=b,B=0;B<b;B++)ce.push(0);let Oe=ce.slice(0);function ae(Te,F,j,Z,x,W){x[0]=W.b=Z[0],x[1]=W.a=-(F*W.b)+Z[1];for(let U=2;U<Te;U++)x[U]=-(F*W.a+j*W.b)+Z[U],W.b=W.a,W.a=x[U]}function Re(Te,F,j,Z,x,W,U,C,N){let f={},p=3;return f.b=f.a=0,ae(F,U,C,W,N,f),x.c=f.a,x.d=f.b,Math.abs(x.c)<=100*Te*Math.abs(W[F-1])&&Math.abs(x.d)<=100*Te*Math.abs(W[F-2])||(x.h=C*Z,Math.abs(x.d)>=Math.abs(x.c)?(p=2,x.e=j/x.d,x.f=x.c/x.d,x.g=U*Z,x.a3=x.e*(x.g+j)+x.h*(Z/x.d),x.a1=-j+x.f*Z,x.a7=x.h+(x.f+U)*j):(p=1,x.e=j/x.c,x.f=x.d/x.c,x.g=x.e*U,x.a3=x.e*j+(x.g+x.h/x.c)*Z,x.a1=-(j*(x.d/x.c))+Z,x.a7=x.g*x.d+x.h*x.f+j)),p}function We(Te,F,j,Z,x,W,U,C,N){if(j===3){U[1]=U[0]=0;for(let p=2;p<F;p++)U[p]=C[p-2];return}let f=j===1?x:Z;if(Math.abs(W.a1)>10*Te*Math.abs(f)){W.a7/=W.a1,W.a3/=W.a1,U[0]=N[0],U[1]=-(N[0]*W.a7)+N[1];for(let p=2;p<F;p++)U[p]=-(N[p-1]*W.a7)+C[p-2]*W.a3+N[p]}else{U[0]=0,U[1]=-(N[0]*W.a7);for(let p=2;p<F;p++)U[p]=-(N[p-1]*W.a7)+C[p-2]*W.a3}}function Ie(Te,F,j,Z,x,W,U,C,N,f,p,_,t,i,c,g,h){let v,A,H,P,X,ne,fe,de,Se;F.b=F.a=0,Te===3||(Te===2?(v=(j+p)*f+_,A=(f+t)*C+i*N):(v=j+t*U+_*f,A=C+(t+i*f)*N),H=-(c[g-1]/h[g]),P=-(c[g-2]+H*h[g-1])/h[g],X=i*P*Z,ne=H*W,fe=H*H*x,de=-(ne+fe)+X,Se=-de+A+H*v,Se!==0&&(F.a=-((t*(fe+ne)+i*(H*Z+P*W))/Se)+t,F.b=i*(1+de/Se)))}function Ve(Te,F,j,Z){let x,W;if(Z.sr=Z.si=Z.lr=Z.li=0,Te===0){Z.sr=F===0?Z.sr:-(j/F);return}if(j===0){Z.lr=-(F/Te);return}let U=F/2;Math.abs(U)<Math.abs(j)?(W=j>=0?Te:-Te,W=-W+U*(U/Math.abs(j)),x=Math.sqrt(Math.abs(W))*Math.sqrt(Math.abs(j))):(W=-(Te/U*(j/U))+1,x=Math.sqrt(Math.abs(W))*Math.abs(U)),W>=0?(x=U>=0?-x:x,Z.lr=(-U+x)/Te,Z.sr=Z.lr===0?Z.sr:j/Z.lr/Te):(Z.lr=Z.sr=-(U/Te),Z.si=Math.abs(x/Te),Z.li=-Z.si)}function je(Te,F,j,Z,x,W,U,C,N,f,p,_){let t={},i,c,g,h,v,A,H,P,X,ne,fe,de=0,Se,ke=0;j.NZ=0,A=Z,P=x;do{if(t.li=t.lr=t.si=t.sr=0,Ve(1,A,P,t),j.szr=t.sr,j.szi=t.si,j.lzr=t.lr,j.lzi=t.li,Math.abs(Math.abs(j.szr)-Math.abs(j.lzr))>.01*Math.abs(j.lzr))break;for(ae(U,A,P,N,W,C),c=Math.abs(-(j.szr*C.b)+C.a)+Math.abs(j.szi*C.b),ne=Math.sqrt(Math.abs(P)),i=2*Math.abs(W[0]),v=-(j.szr*C.b),fe=1;fe<F;fe++)i=i*ne+Math.abs(W[fe]);if(i=i*ne+Math.abs(v+C.a),i=(9*i+2*Math.abs(v)-7*(Math.abs(C.a+v)+ne*Math.abs(C.b)))*Te,c<=20*i){j.NZ=2;break}if(de++,de>20)break;if(de>=2&&h<=.01&&c>=g&&!ke){for(h=h<Te?Math.sqrt(Te):Math.sqrt(h),A-=A*h,P+=P*h,ae(U,A,P,N,W,C),fe=0;fe<5;fe++)Se=Re(Te,F,C.a,C.b,p,_,A,P,f),We(Te,F,Se,C.a,C.b,p,_,f,W);ke=1,de=0}g=c,Se=Re(Te,F,C.a,C.b,p,_,A,P,f),We(Te,F,Se,C.a,C.b,p,_,f,W),Se=Re(Te,F,C.a,C.b,p,_,A,P,f),Ie(Se,C,C.a,p.a1,p.a3,p.a7,C.b,p.c,p.d,p.f,p.g,p.h,A,P,_,F,N),H=C.a,X=C.b,X!==0&&(h=Math.abs((-P+X)/X),A=H,P=X)}while(X!==0)}function st(Te,F,j,Z,x,W,U,C,N){let f,p,_,t,i,c,g,h,v,A,H,P=Z-1;for(F.NZ=H=v=0,g=j.a;;){for(c=x[0],U[0]=c,A=1;A<W;A++)U[A]=c=c*g+x[A];for(_=Math.abs(c),t=Math.abs(g),f=.5*Math.abs(U[0]),A=1;A<W;A++)f=f*t+Math.abs(U[A]);if(_<=20*Te*(2*f-_)){F.NZ=1,F.szr=g,F.szi=0;break}if(H++,H>10)break;if(H>=2&&Math.abs(h)<=.001*Math.abs(-h+g)&&_>i){v=1,F.a=g;break}for(i=_,N[0]=p=C[0],A=1;A<Z;A++)N[A]=p=p*g+C[A];if(Math.abs(p)>Math.abs(C[P])*10*Te)for(h=-(c/p),C[0]=U[0],A=1;A<Z;A++)C[A]=h*N[A-1]+U[A];else for(C[0]=0,A=1;A<Z;A++)C[A]=N[A-1];for(p=C[0],A=1;A<Z;A++)p=p*g+C[A];h=Math.abs(p)>Math.abs(C[P])*10*Te?-(c/p):0,g+=h}return v}function Be(Te,F,j,Z,x,W,U,C,N,f,p,_){let t={},i={},c=new Array(F),g=new Array(F),h,v,A,H,P,X,ne,fe,de,Se,ke,be,Pe,Je,De,Qe,ot,mt,yt,_t=1,Lt,Gt,i0,t0,r0,a0;for(_.NZ=0,H=A=.25,P=Z,fe=x,t.b=t.a=0,ae(N,p,x,C,f,t),h=t.a,v=t.b,i.h=i.g=i.f=i.e=i.d=i.c=i.a7=i.a3=i.a1=0,t0=Re(Te,U,h,v,i,W,p,x,c),Lt=0;Lt<j;Lt++){if(mt=1,We(Te,U,t0,h,v,i,W,c,f),t0=Re(Te,U,h,v,i,W,p,x,c),Ie(t0,t,h,i.a1,i.a3,i.a7,v,i.c,i.d,i.f,i.g,i.h,p,x,W,U,C),De=t.a,ot=Qe=t.b,Se=W[U-1]===0?0:-(C[U]/W[U-1]),ke=Pe=1,Lt!==0&&t0!==3&&(Pe=ot===0?Pe:Math.abs((ot-fe)/ot),ke=Se===0?ke:Math.abs((Se-P)/Se),Je=Pe<ne?Pe*ne:1,be=ke<X?ke*X:1,r0=Je<H?1:0,Gt=be<A?1:0,Gt||r0)){for(yt=0;yt<U;yt++)g[yt]=W[yt];for(de=Se,i0=a0=0;;){if(!(mt&&(mt=0)==0&&Gt&&(!r0||be<Je))){if(je(Te,U,_,De,Qe,f,N,t,C,c,i,W),h=t.a,v=t.b,_.NZ>0)return;if(_t=a0=1,H*=.25,i0||!Gt)_t=0;else for(yt=0;yt<U;yt++)W[yt]=g[yt]}if(_t!==0){if(t.a=de,_t=st(Te,_,t,U,C,N,f,W,c),de=t.a,_.NZ>0)return;if(i0=1,A*=.25,_t!==0){De=-(de+de),Qe=de*de;continue}}for(yt=0;yt<U;yt++)W[yt]=g[yt];if(!r0||a0)break}ae(N,p,x,C,f,t),h=t.a,v=t.b,t0=Re(Te,U,h,v,i,W,p,x,c)}fe=ot,P=Se,ne=Pe,X=ke}}function et(Te,F,j,Z){let x=Te.Degree,W=Math.PI/180,U=Math.LN2,C=Te.Degree+1,N=new Array(C),f=new Array(C),p=new Array(C),_=new Array(C),t={},i={},c,g,h,v,A,H,P,X,ne,fe,de,Se,ke,be,Pe,Je,De,Qe,ot,mt,yt,_t,Lt,Gt;Se=1;do g=Se,Se/=2,ke=1+Se;while(ke>1);let i0=Number.MIN_VALUE/g,t0=Math.cos(94*W),r0=Math.sin(94*W),a0=Math.sqrt(.5),S0=-a0;for(i.NZ=ot=0,i.szr=i.szi=i.lzr=i.lzi=0;F[x]===0;)j[ot]=Z[ot]=0,x--,ot++;for(Lt=x+1;x>=1;){if(x<=2){x<2?(j[Te.Degree-1]=-(F[1]/F[0]),Z[Te.Degree-1]=0):(t.li=t.lr=t.si=t.sr=0,Ve(F[0],F[1],F[2],t),j[Te.Degree-2]=t.sr,Z[Te.Degree-2]=t.si,j[Te.Degree-1]=t.lr,Z[Te.Degree-1]=t.li);break}for(P=0,X=Number.MAX_VALUE,B=0;B<Lt;B++)fe=Math.abs(F[B]),fe>P&&(P=fe),fe!==0&&fe<X&&(X=fe);if(ne=i0/X,(ne<=1&&P>=10||ne>1&&Number.MAX_VALUE/ne>=P)&&(ne=ne===0?Number.MIN_VALUE:ne,yt=Math.floor(Math.log(ne)/U+.5),A=2**yt,A!==1))for(B=0;B<Lt;B++)F[B]*=A;for(let rt=0;rt<Lt;rt++)f[rt]=Math.abs(F[rt]);f[x]=-f[x],_t=x-1,fe=Math.exp((Math.log(-f[x])-Math.log(f[0]))/x),f[_t]!==0&&(de=-f[x]/f[_t],fe=de<fe?de:fe),de=fe;do{fe=de,de=.1*fe,H=f[0];for(let rt=1;rt<Lt;rt++)H=H*de+f[rt]}while(H>0);v=fe;do{h=H=f[0];for(let rt=1;rt<x;rt++)H=fe*H+f[rt],h=fe*h+H;H=fe*H+f[x],v=H/h,fe-=v}while(Math.abs(v/fe)>.005);c=fe;for(let rt=1;rt<x;rt++)N[rt]=(x-rt)*F[rt]/x;for(N[0]=F[0],Se=F[x],ke=F[_t],Gt=N[_t]===0?1:0,mt=0;mt<5;mt++)if(be=N[_t],Gt){for(let rt=0;rt<_t;rt++)ot=_t-rt,N[ot]=N[ot-1];N[0]=0,Gt=N[_t]===0?1:0}else{Je=-Se/be;for(let rt=0;rt<_t;rt++)ot=_t-rt,N[ot]=Je*N[ot-1]+F[ot];N[0]=F[0],Gt=Math.abs(N[_t])<=Math.abs(ke)*g*10?1:0}for(let rt=0;rt<x;rt++)_[rt]=N[rt];for(mt=1;mt<=20;mt++)if(Qe=-(r0*S0)+t0*a0,S0=r0*a0+t0*S0,a0=Qe,Pe=c*a0,De=-(2*Pe),Be(g,C,20*mt,Pe,c,N,x,F,Lt,p,De,i),i.NZ===0)for(let rt=0;rt<x;rt++)N[rt]=_[rt];else{ot=Te.Degree-x,j[ot]=i.szr,Z[ot]=i.szi,Lt-=i.NZ,x=Lt-1;for(let rt=0;rt<Lt;rt++)F[rt]=p[rt];i.NZ===1||(j[ot+1]=i.lzr,Z[ot+1]=i.lzi);break}if(mt>20){Te.Degree-=x;break}}}et(pe,J,Oe,ce);let at=ce.length;for(B=0;B<at;B++){let Te=ue(ce[B],S+8),F=ue(Oe[B],S+8);F=S-String(F).length>2?F:Oe[B];let j=Te<0?"-":"";F===0&&(F=""),Te===0&&(Te=""),Math.abs(Te)===1?Te=`${j}i`:Te?Te=`${Te}*i`:Te="";let Z=F&&Te?`${F}+${Te}`:F+Te;Oe[B]=Z.replace(/\+-/gu,"-")}return Oe}},roots(l){if(l.isConstant(!0,!0))return n.Utils.nroots(l);let S=Y.proots(l).map(o=>e.parse(o));return n.Vector.fromArray(S)},froot(l,S,o){return function(y){let O=o||n.Utils.build(n.Calculus.diff(l.clone())),G=l instanceof Function?l:n.Utils.build(l),b=1e4,L=!1,B=0;for(;!L;){let J=y-G(y)/O(y),ce=Math.abs(J)-Math.abs(y),pe=Math.abs(ce);y=J,pe<1e-12?L=!0:B>b&&(y=null,L=!0),B++}return y}(Number(S))},quad(l,S,o){let w=function(y,E,O,G){return e.parse(`-(${E}+${G}*sqrt((${E})^2-4*(${y})*(${O})))/(2*${y})`)};return[w(l,S,o,1),w(l,S,o,-1)]},sumProd(l,S){return Y.quad(-S,l,-1).map(o=>o.invert())},coeffs(l,S,o){l=e.expand(l),o||=[new ee(0)];let w=lt(l);S===void 0&&w.length===1&&(S=w[0]),S=String(S),l.group===we&&l.contains(S,!0)&&e.error(`Unable to get coefficients using expression ${l.toString()}`),w=lt(l);let y=l.contains("pi")||l.contains("e")||l.containsFunction("sqrt");if(w.length===1&&w[0]===S&&!l.isImaginary()&&!y){let E=new _e(l).coeffs.map(O=>new ee(O));for(let O=0,G=E.length;O<G;O++){let b=E[O],L=o[O];L&&(b=e.add(L,b)),o[O]=b}}else if(w.length===1&&w[0]===S&&!l.isImaginary()&&y&&l.group===V){let E=n.Utils.getCoeffs(l,S);for(let O=0,G=E.length;O<G;O++){let b=E[O],L=o[O];L&&(b=e.add(L,b)),o[O]=b}}else if(S||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),w.indexOf(S)===-1)o[0]=e.add(l,o[0]);else{o||=[new ee(0)];let E;if(l.group===u){let O=l.symbols[S];O||e.error("Expression is not a polynomial!");let G=Number(O.power);E=e.divide(l.clone(),O.clone()),(E.contains(S,!0)||G<0||!Ae(G))&&e.error("Expression is not a polynomial!");let b=o[G];b&&(E=e.add(b,E)),o[G]=E}else l.group===V&&l.each(O=>{Y.coeffs(O.clone(),S,o)},!0)}for(let E=0,O=o.length;E<O;E++)typeof o[E]>"u"&&(o[E]=new ee(0));return o},polyPowers(l,S,o){o||=[];let w=l.group;if(w===le&&S===l.value)o=o.concat(se(l.symbols));else if(w===V)for(let y in l.symbols){if(!Object.hasOwn(l.symbols,y))continue;let E=l.symbols[y],O=E.group,G=E.value;if(O===me&&S===G)o.push(E.power);else if(O===le||O===V)o=Y.polyPowers(E,S,o);else if(O===u&&E.contains(S)){let b=E.symbols[S];b&&o.push(b.power)}else(O===$||S!==G)&&o.push(0)}else w===u&&l.contains(S)&&o.push(n.Utils.decompose_fn(l,S,!0).x.power);return n.Utils.arrayUnique(o).sort()},Factor:{split(l){let S=new ee(1),o=new ee(1);return Y.Factor.factorInner(l,new He).each(w=>{let y=e.parse(w);w.isConstant(!0)?S=e.multiply(S,y):o=e.multiply(o,y)}),[S,o]},mix(l,S){let o=se(l),w=o.length,y=[];for(let E=0;E<w;E++){let O=o[E],G=l[O],b=y.length;for(let L=0;L<b;L++){let B=y[L]*O;y.push(B),S&&y.push(-B)}for(let L=1;L<=G;L++)y.push(O**L)}return y},common(l,S){try{if(l.group===V){let o=e.expand(l.clone(),!0).collectSymbols(null,null,(G,b)=>(b.length||1)-(G.length||1)),w={},y=[];for(let G=0;G<o.length;G++){let b=o[G];y.push(b.multiplier.clone()),b.each(L=>{let B=Number(L.power);if(isNaN(B))throw new Error("exiting");L.value in w?(B<w[L.value][0]&&(w[L.value][0]=B),w[L.value][1].push(L)):w[L.value]=[B,[L]]})}let E=new ee(1);for(let G in w)w[G][1].length===o.length&&(E=e.multiply(E,e.pow(new ee(G),new ee(w[G][0]))));let O=n.Math2.QGCD.apply(null,y);if(!O.equals(1)){S.add(new ee(O));for(let G=0;G<o.length;G++)o[G].multiplier=o[G].multiplier.divide(O)}if(!E.equals(1)){S.add(E),l=new ee(0);for(let G=0;G<o.length;G++)l=e.add(l,e.divide(o[G],E.clone()))}}}catch(o){if(o.message==="timeout")throw o}return l},zeroes(l,S){let o=function(){throw new n.exceptions.ValueLimitExceededError("Exiting")};try{let w,y,E;l=e.expand(l.clone());let O=l.toString(),G=lt(l);y=new ee(0);let b=[],L=[];for(let B=0,J=G.length;B<G.length;B++){let ce={};for(let Oe=0;Oe<J;Oe++)B!==Oe&&(ce[G[Oe]]=0);w=e.parse(O,ce);let pe=w.power;Ae(pe)||o(),b.push(w),L.push(w.power)}if(n.Utils.allSame(L)){let B=l.length,J=b.length,ce=Math.round((Math.sqrt(8*B-1)-3)/2);J===2?E=new ye(L[0]/(B-1)):J===3&&ce!==0?E=new ye(L[0]/ce):E=n.Math2.QGCD.apply(null,L)}else E=n.Math2.QGCD.apply(null,L);if(!Ae(E))return l;for(let B=0;B<b.length;B++){let J=b[B],ce=J.power.clone().divide(E);if((J.multiplier.num<0||J.multiplier.den<0)&&ce%2===0)return l;J.multiplier=new ye(J.multiplier**(1/ce)),J.power=E.clone(),y=e.add(y,J)}if(y.group!==V)return l;for(;;){let B=Y.div(l.clone(),y.clone());if(B[1].equals(0)){if(l=B[0],S.add(y.clone()),l.equals(1))break}else break}}catch(w){if(w.message==="timeout")throw w}return l},factor(l,S){n.Utils.checkTimeout();let o=S?[...S]:null;try{let w=Y.Factor.factorInner(l,S);return w=w.pushMinus(),w}catch(w){if(w.message==="timeout")throw w;return S&&S.splice(0,S.length,...o),l}},factorInner(l,S){if(n.Utils.checkTimeout(),l.isConstant()&&l.isInteger())return n.Math2.factor(l);let o=e.parse(l);if(o.isConstant())return o.isInteger()?n.Math2.factor(o):l;if(o.equals(0)||o.equals(1))return o;let w=Y.Factor._factor(o,S);if(w.equals(l)||w.equals(0)||w.equals(1))return w;if(w.group===u){let y=new ee(1),E=e.parse(w.power),O=e.parse(w.multiplier);w.toUnitMultiplier(),w.multiplier.lessThan(0)&&(y.negate(),w.negate()),w.each(b=>{let L=e.parse(Y.Factor._factor(b));if(O=e.multiply(O,ee.create(L.multiplier)),L.toUnitMultiplier(),L.group===u){let B=new ee(1);L.each(J=>{let ce=e.parse(Y.Factor._factor(J));ce.group===u&&(O=e.multiply(O,ee.create(ce.multiplier)),ce.toUnitMultiplier()),B=e.multiply(B,ce)}),B=e.pow(B,new ee(L.power)),y=e.multiply(y,B)}else y=e.multiply(y,L)});let G=e.pow(y,E);w=e.multiply(O,G)}return w},quadFactor(l,S){if(l.isPoly()&&Y.degree(l.equals(2))){let o=n.Utils.variables(l)[0],w=Y.coeffs(l,o);if(w.length<3)return l;let y=Y.Factor._factor(w[2].clone());if(y.group===u){let E=y.collectSymbols();if(E.length>2)return l;let O=e.multiply(e.parse(w[0]),e.parse(E[0])),G=e.parse(w[1]).negate(),b=e.parse(E[1]),L=Y.quad(b,G,O).filter(B=>n.Utils.isInt(B));if(L.length===1){let B=L[0],J=e.divide(w[0],e.parse(B));n.Utils.isInt(J)&&(S.add(e.parse(ze("({0})*({1})+({2})",E[1],o,J))),S.add(e.parse(ze("({0})*({1})+({2})",E[0],o,B))),l=new ee(1))}}}return l},cubeFactor(l,S){if(l.isComposite()){let o=l.collectSymbols();if(o.length===2){let w=o[0].sign(),y=o[0].clone().abs(),E=o[1].sign(),O=o[1].clone().abs();if(y.isCube()&&O.isCube()){w<E&&([w,E]=[E,w],[y,O]=[O,y]);let G=e.parse(y.getNth(3)),b=e.parse(O.getNth(3)),L=e.multiply(e.expand(e.pow(y.clone().toUnitMultiplier(),e.parse("1/3"))),G),B=e.multiply(e.expand(e.pow(O.clone().toUnitMultiplier(),e.parse("1/3"))),b);w===1&&E===-1?(S.add(e.parse(ze("(({0})-({1}))",L,B))),S.add(e.parse(ze("(({0})^2+({0})*({1})+({1})^2)",L,B))),l=ee(1)):w===1&&E===1&&(S.add(e.parse(ze("(({0})+({1}))",L,B))),S.add(e.parse(ze("(({0})^2-({0})*({1})+({1})^2)",L,B))),l=ee(1))}}}return l},_factor(l,S){n.Utils.checkTimeout();let o=l.group;if(l.group===K){let y=l.args[0];if(y.group===me&&y.isSimple())return l}else if(l.group===me&&l.isSimple())return l;if(l.group===V){l.distributeMultiplier(!0);let y=new ee(0);l.each(E=>{(E.group===V&&E.power.greaterThan(1)||E.group===u)&&(E=e.expand(E)),y=e.add(y,E)}),y.power=l.power,l=y}l.group===K&&l.fname!=="sqrt"&&(l=n.Utils.evaluate(l));let w=l.clone();try{if(l.group===u){let E=e.parse(l.power),O=Y.Simplify.strip(l.getDenom()),G=Y.Simplify.strip(l.getNum()),b=O.pop(),L=G.pop();if(L.equals(l))return l;let B=Y.Factor.factorInner(L),J=Y.Factor.factorInner(b),ce=Y.Simplify.unstrip(G,B),pe=Y.Simplify.unstrip(O,J);return e.divide(ce,pe)}if(l.group===me)return l;if(l.isConstant())return l.equals(1)||l.equals(0)||!l.isInteger()?l.clone():n.Math2.factor(l);let y=l.power.clone();if(Ae(y)&&!(y.lessThan(0)&&l.group===K)){let E=y.sign();l.toLinear(),S||=new He;let O={};l=e.parse(n.Utils.subFunctions(l,O)),se(O).length>0&&(S.preAdd=function(Oe){return e.parse(Oe,n.Utils.getFunctionsSubs(O))}),l.isLinear()||(S.pFactor=l.power.toString(),l.toLinear());let G=lt(l);l.isImaginary()&&G.push(n.Settings.IMAGINARY);let b=G.length>1;if(b){let pe=!0,Oe=!0;if(l.each(ae=>{ae.group!==me&&(pe=!1),ae.multiplier.equals(1)||(Oe=!1)}),pe&&Oe)return e.pow(e.parse(l,n.Utils.getFunctionsSubs(O)),e.parse(y))}let L=new He;l=Y.Factor.coeffFactor(l,L),L.each(pe=>{pt(y)&&pe.lessThan(0)&&pe.negate(),E<0&&pe.invert(),S.add(pe)});let B=new He;if(l=Y.Factor.powerFactor(l,B),B.each(pe=>{E<0&&pe.invert(),S.add(pe)}),b)l=Y.Factor.cubeFactor(l,S),l=Y.Factor.mfactor(l,S),S.each(pe=>{E<0&&pe.power.negate()});else{let pe=G[0];l=Y.Factor.squareFree(l,S,pe);let Oe=new He;l=Y.Factor.trialAndError(l,Oe,pe);let ae=Oe.toSymbol();if(ae.equals(w))return ae;for(let Re in Oe.factors){if(!Object.hasOwn(Oe.factors,Re))continue;let We=Oe.factors[Re];S.add(e.pow(We,e.parse(y)))}l.equals(w)&&(l=Y.Factor.quadFactor(l,S))}l=e.parse(l,n.Utils.getFunctionsSubs(O));let J=S.length===1;S.add(e.pow(l,e.parse(y)));let ce=S.toSymbol();return J&&l.equals(1)&&ce.isLinear()&&(ce=e.pow(ce,e.parse(y))),ce}return l}catch(y){if(y?.message==="timeout")throw y;return w}},reduce(l,S){if(l.group===V&&l.length===2){let o=l.collectSymbols().sort((w,y)=>y.multiplier-w.multiplier);if(o[0].power.equals(o[1].power)){let w=e.parse(o[0].power),y=o[0].clone().toLinear(),E=o[1].clone().toLinear();S.add(e.add(y.clone(),E.clone())),E.negate();let O=Number(w),G=new ee(0);for(let b=1;b<=O;b++){let L=e.pow(y.clone(),e.subtract(w.clone(),new ee(b))),B=e.pow(E.clone(),e.subtract(new ee(b),new ee(1)));G=e.add(G,e.multiply(L,B))}return G}}return l},squareFree(l,S,o){if(l.isConstant()||l.group===me||!l.isPoly())return l;let y=new _e(l,o).squareFree(),E=y[2];if(E!==1){let O=y[1].toSymbol();return O.power=O.power.multiply(new ye(E)),S.add(Y.Factor.factorInner(O)),Y.Factor.squareFree(y[0].toSymbol(),S)}return l},powerFactor(l,S){if(l.group!==le||l.previousGroup===we)return l;let o=se(l.symbols);if(!n.Utils.allNumeric(o))return l;let w=n.Utils.arrayMin(o),y=new ee(0),E=e.parse(`${l.value}^${w}`);return l.each(O=>{O=e.divide(O,E.clone()),y=e.add(y,O)}),S.add(E),y},coeffFactor(l,S){if(l.isComposite()){let o=n.Math2.QGCD.apply(null,l.coeffs());if(o.equals(1)){let w=function(O){let G;return O.group===u?(G=0,O.each(b=>{G+=b.power})):G=Number(O.power),G},y=l.collectSymbols(null,null,null,!0).sort((O,G)=>O.isConstant(!0)?1:G.power-O.power),E=y[0];(w(E)>w(y[1])||y[1].isConstant(!0))&&E.multiplier.lessThan(0)&&(S.add(new ee(-1)),l.each(O=>{O.negate()},!0))}else l.each(w=>{w.isComposite()?w.each(y=>{y.multiplier=y.multiplier.divide(o)}):w.multiplier=w.multiplier.divide(o)}),l.updateHash();S&&S.add(new ee(o))}return l},trialAndError(l,S,o){let w=l.clone();try{let y=[];if(l.isConstant()||l.group===me||!l.isPoly())return l;let E=new _e(l,o),O=E.coeffs[0],G=n.Math2.ifactor(O),b=Y.proots(l);for(let L=0;L<b.length;L++){let B=b[L],J=1;if(!isNaN(B)){for(let Re in G){if(!Object.hasOwn(G,Re))continue;let We=n.Utils.round(Math.log(Re)/Math.log(Math.abs(B)),8);if(Ae(We)){B=Re,J=We;break}}let ce=new ye(B),pe=[new ye(ce.num).negate()];pe[J]=new ye(ce.den);let Oe=_e.fromArray(pe,E.variable).fill(),ae=E.divide(Oe);ae[1].equalsNumber(0)&&(E=ae[0],y.push(Oe.toSymbol()))}}return E.equalsNumber(1)||(E=Y.Factor.search(E,S)),y.forEach(L=>{S.add(L)}),E.toSymbol()}catch(y){if(y.message==="timeout")throw y;return w}},search(l,S,o){o||=10;let w=l.variable,y=function(ae,Re,We,Ie){let Ve=_e.fit(ae,Re,We,o,Ie,w);if(Ve&&Ve.coeffs.length>1){let je=l.divide(Ve);if(je[1].equalsNumber(0))return S.add(Ve.toSymbol()),[je[0],Ve]}return null},E=l.coeffs[0],O=n.Math2.ifactor(E),G=l.lc(),b=n.Math2.ifactor(G),L=l.sub(o),B=n.Math2.ifactor(L),J=Y.Factor.mix(B,L<0),ce=Math.ceil(l.coeffs.length/2),pe=G.lessThan(0),Oe=E.lessThan(0);for(b[1]=1,O[1]=1;ce--;)for(let ae in b)if(Object.hasOwn(b,ae)){for(let Re in O)if(Object.hasOwn(O,Re))for(let We=0;We<J.length;We++){let Ie=y(ae,Re,J[We],ce);if(Ie)return l=Ie[0],n.Utils.isPrime(l.sub(o))||(l=Y.Factor.search(l,S)),l;Ie||(pe&&Oe?Ie=y(-ae,-Re,J[We],ce):pe?Ie=y(-ae,Re,J[We],ce):Oe&&(Ie=y(ae,-Re,J[We],ce)))}}return l},mSqfrFactor(l,S){if(l.group!==K){let o=lt(l).reverse();for(let w=0;w<o.length;w++){let y=!1;do{if(o[w]===l.value){S.add(l),l=new ee(1);continue}let E=n.Calculus.diff(l,o[w]),O=Y.Factor.coeffFactor(E);if(O.equals(0)||O.equals(1)||O.equals(-1))break;let G=!0;O.isConstant()&&l.isComposite()&&l.each(L=>{L.multiplier%O!==0&&(G=!1)},!0);let b;if(G){let L=l.clone();if(b=Y.divWithCheck(l,O.clone()),y=b[1].equals(0),l.equals(b[0])&&b[1].equals(0)){l=L;break}if(b[0].isConstant()){S.add(b[0]);break}}else y=!1;y&&(S.add(b[0]),l=O)}while(y)}}return l},sqdiff(l,S){if(l.isConstant("all"))return l;try{let o=function(E){return n.Utils.block("POSITIVE_MULTIPLIERS",()=>ee.unwrapPARENS(Xe.sqrt(Xe.abs(E))),!0)},w=n.Utils.separate(l.clone());if(!w)return l;let y=[];for(let E in w)E!=="constants"&&y.push(w[E]);if(y.sort((E,O)=>O.power-E.power),y.length===2){let E,O;if(E=y.pop(),O=y.pop(),pt(E.power)&&pt(O.power)&&E.sign()===O.sign()&&E.group===me&&O.group===me)throw new Error("Unable to factor");if(E.isComposite()&&O.power.equals(2)&&E.sign()!==O.sign()){O=o(O);let G=Y.Factor.factorInner(e.add(E,w.constants));G.power.equals(2)&&(G.toLinear(),S.add(e.subtract(G.clone(),O.clone())),S.add(e.add(G,O)),l=new ee(1))}else if(E=E.powSimp(),O=O.powSimp(),(E.group===me||E.fname==="")&&E.power.equals(2)&&(O.group===me||O.fname==="")&&O.power.equals(2)&&!w.constants){if(E.multiplier.lessThan(0)){let G=O;O=E,E=G}E.multiplier.greaterThan(0)&&(E=o(E),O=o(O)),S.add(e.subtract(E.clone(),O.clone())),S.add(e.add(E,O)),l=new ee(1)}}}catch(o){if(o.message==="timeout")throw o}return l},mfactor(l,S){if(l.group===K)if(l.fname==="sqrt"){let o=new He,w=Y.Factor.common(l.args[0].clone(),o);w=Y.Factor.coeffFactor(w,null),l=e.multiply(e.symfunction("sqrt",[w]),e.parse(l.multiplier)),o.each(y=>{l=e.multiply(l,e.parse(n.Utils.format("sqrt({0})",y)))})}else S.add(l),l=new ee(1);else{l=Y.Factor.mSqfrFactor(l,S);let o=lt(l),w=l.collectSymbols().map(b=>ee.unwrapSQRT(b)),y={},E={},O=o.length,G=w.length;for(let b=0;b<O;b++){let L=o[b];y[L]=new ee(0);for(let B=0;B<G;B++){let J=w[B];if(J.contains(L)){let ce=J.value===L?J.power.toDecimal():J.symbols[L].power.toDecimal();(!E[L]||ce<E[L])&&(E[L]=ce),y[L]=e.add(y[L],J.clone())}}}for(let b in y){if(!Object.hasOwn(y,b))continue;let L=e.parse(`${b}^${E[b]}`),B=e.divide(y[b],L),J=e.expand(B);if(J.equals(1)||J.equals(-1))break;let ce=Y.div(l.clone(),J);if(ce[0].equals(0))break;if(ce[1].equals(0)){let Oe=!1;if(ce[0].each(ae=>{Ae(ae.multiplier)||(Oe=!0)}),Oe){ce[1]=e.expand(e.multiply(ce[1],J));break}}let pe=Ae(J)&&J.lessThan(0);if(ce[1].equals(0)&&!pe){let Oe=Y.divWithCheck(l.clone(),ce[0].clone()),ae=Oe[0];if(ae.equals(0)||(l=Oe[1],ae.equals(-1)&&!l.equals(0)))return l;let Re=ce[0];if(l.equals(Re)){let We=Y.Factor.reduce(Re,S);return l.equals(We)?We:Y.Factor.mfactor(We,S)}return S.add(Re),l.equals(0)?ae:ae.isConstant("all")?(S.add(ae),ae):(l=Y.Factor.mfactor(ae,S),l)}}}return l=Y.Factor.sqdiff(l,S),l=Y.Factor.zeroes(l,S),l}},allLinear(l){let S=l.length;for(let o=0;o<S;o++)if(!Y.isLinear(l[o]))return!1;return!0},isLinear(l){let S=!1,o=l.group;if(o===le||o===V){S=!0;for(let w in l.symbols){if(!Object.hasOwn(l.symbols,w))continue;let y=l.symbols[w],E=y.group;if((E===K||E===we)&&(S=!1),E===u)S=lt(y).length===1;else if(E===le||E===V)S=Y.isLinear(y);else if(y.group!==$&&y.power.toString()!=="1"){S=!1;break}}}else o===me&&l.power===1&&(S=!0);return S},gcd(...l){let S;if(l.length===1&&l[0]instanceof n.Vector?S=l[0].elements:S=l,S.length===0)return new ee(1);if(S.length===1)return S[0];let o=[],w=!1;for(let y=0;y<S.length;y++)if(S[y].group===K&&S[y].fname==="gcd")S=S.concat(S[y].args),S.splice(y,1);else{let E=lt(S[y]);if(n.Utils.haveIntersection(E,o)){w=!0;break}else o=o.concat(E)}if(w||o.length===0){if(S.every(y=>y.getDenom().equals(1))){let y=S[0];for(let E=1;E<S.length;E++)y=Y.gcd_(S[E],y);return y}return e.divide(Y.gcd.apply(null,S.map(y=>y.getNum())),Y.lcm.apply(null,S.map(y=>y.getDenom())))}return e.symfunction("gcd",S)},gcd_(l,S){if((l.group===K||l.group===z)&&(l=n.Utils.block("PARSE2NUMBER",()=>e.parse(l))),S.group===K&&(S=n.Utils.block("PARSE2NUMBER",()=>e.parse(S))),l.isConstant()&&S.isConstant())return new ee(n.Math2.QGCD(new ye(Number(l)),new ye(Number(S))));let o=e.multiply(l.getDenom()||new ee(1),S.getDenom()||new ee(1)).invert();if(l=e.multiply(l.clone(),o.clone()),S=e.multiply(S.clone(),o.clone()),l=e.expand(l),S=e.expand(S),l.group===u||S.group===u){let b=e.divide(l.clone(),S.clone()),L=e.multiply(S.clone(),b.getDenom().invert());if(!L.equals(1))return L}if(l.group===we||S.group===we){let b=new ee(n.Math2.GCD(l.multiplier,S.multiplier)),L=Y.gcd_(l.value===Le?new ee(1):e.parse(l.value),S.value===Le?new ee(1):e.parse(S.value)),B=Y.gcd_(e.parse(l.power),e.parse(S.power));return e.multiply(b,e.pow(L,B))}if(l.length<S.length){let b=l;l=S,S=b}let w=lt(l),y=lt(S);if(w.length===y.length&&w.length===1&&w[0]===y[0]||w.length===1&&y.length===0||w.length===0&&y.length===1)return l=new _e(l),S=new _e(S),e.divide(l.gcd(S).toSymbol(),o);let E=[];l.each(b=>{E.push(b.multiplier)}),S.each(b=>{E.push(b.multiplier)});let O;for(;!S.equals(0);){let b=S.clone();if(l=l.clone(),O=Y.div(l,b),S=O[1],O[0].equals(0))return e.divide(new ee(n.Math2.QGCD(l.multiplier,S.multiplier)),o);l=b}let G=n.Math2.QGCD.apply(void 0,E);return G.equals(1)||l.each(b=>{b.multiplier=b.multiplier.divide(G)}),l.equals(1)&&!l.isConstant()&&!S.isConstant()?e.divide(e.symfunction("gcd",[l,S]),o):e.divide(l,o)},lcm(...l){let S;l.length===1?l[0]instanceof n.Vector?S=l[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):S=l;let o=S.reduce((O,G)=>e.multiply(O,G.clone()),new ee(1)),w=(function(G,b){b=Number(b);let L=[],B,J,ce,pe=2**G.length;for(J=b;J<pe;J++){B=[],ce=G.length-1;do(J&1<<ce)!==0&&B.push(G[ce]);while(ce--);B.length===b&&L.push(B)}return L})(S,S.length-1).map(O=>O.reduce((G,b)=>e.multiply(G,b.clone()),new ee(1))),y;return S.every(O=>n.Utils.isVariableSymbol(O))?y=e.symfunction("gcd",n.Utils.arrayUnique(w)):y=Y.gcd.apply(null,w),e.divide(o,y)},divide(l,S){let o,w=n.Algebra.Factor.factorInner(l.clone());o=w.getDenom(),o.isConstant("all")?o=new ee(1):l=e.expand(ee.unwrapPARENS(e.multiply(w,o.clone())));let y=Y.div(l,S),E=e.divide(y[1],S);return e.divide(e.add(y[0],E),o)},divWithCheck(l,S){let o=[new ee(0),l.clone()],w=Y.div(l,S),y=l.clone(),E=e.multiply(w[0].clone(),S.clone());E=e.add(E,w[1].clone());let O=e.subtract(y,E);return O=e.expand(O),O.equals(0)?w:o},div(l,S){let o=[new ee(0),l.clone()];try{if(S.isConstant("all"))return l.each(J=>{J.multiplier=J.multiplier.divide(S.multiplier)}),[l,new ee(0)];if(l=e.expand(l),S=e.expand(S),l.group===me&&S.group===V){let J=l.value,ce=n.Utils.decompose_fn(S.clone(),J,!0);if(l.isLinear()&&ce.x&&ce.x.isLinear()&&S.isLinear()){let pe=ee.create(l.multiplier);return[e.divide(pe.clone(),ce.a.clone()),e.divide(e.multiply(pe,ce.b),ce.a).negate()]}}if(l.group===me&&S.group===me){let J=e.divide(l.clone(),S.clone());return J.isConstant()?[J,new ee(0)]:[new ee(0),l.clone()]}let w=l.hasFunc(),y=S.hasFunc(),E=!1,O;if(w||y){E=!0;let J={};l=e.parse(n.Utils.subFunctions(l,J)),S=e.parse(n.Utils.subFunctions(S,J)),O=n.Utils.getFunctionsSubs(J)}let G=n.Utils.arrayUnique(lt(l).concat(lt(S))),b,L,B;if((l.isImaginary()||S.isImaginary())&&G.push(n.Settings.IMAGINARY),G.length===1){let J=new _e(l).divide(new _e(S));b=J[0].toSymbol(),L=J[1].toSymbol()}else{G.push(Le);let J=function(Be){let et=new ee(0);for(let at=0;at<Be.length;at++){let Te=Be[at].toSymbol();et=e.add(et,Te)}return et},ce=function(Be,et){let at=Math.max.apply(null,Be.terms),Te=0,F;if(!et){for(let j=0;j<Be.terms.length;j++)if(Be.terms[j].equals(at)&&(F=j,Te++),Te>1)return}if(et){for(let j=0;j<Be.terms.length;j++)if(Be.terms[j].equals(at)){F=j;break}}return[at,F,Be]},pe=n.Utils.toMapObj(G),Oe=function(Be,et){return et.sum.subtract(Be.sum)},ae=l.tBase(pe).sort(Oe),Re=S.tBase(pe).sort(Oe),We=function(Be,et){et||=0;let at=Be[et],Te=Be.length;if(!at)return;let F=ce(at);for(let x=et+1;x<Te;x++){let W=Be[x],U=at.sum.equals(W.sum);if(!U&&F)break;if(U){let C,N,f,p,_=at.terms.length;for(let c=0;c<_;c++){let g=at.terms[c],h=W.terms[c];(typeof C>"u"||g.greaterThan(C))&&(C=g,f=c),(typeof N>"u"||h.greaterThan(N))&&(N=h,p=c)}let t=C.subtract(W.terms[f]),i=N.subtract(at.terms[p]);if(i>t){F=[N,p,W];break}if(t>i){F=[C,f,at];break}}else if(F=ce(W),F)break;F=ce(W)}if(!F)return ce(Be[0],!0);let j,Z;for(let x=0;x<Re.length;x++){let W=Re[x].terms;if(Z=F[1],Z===W.length-1)return;if(j=W[Z],!j.equals(0))break}return j.equals(0)?We(Be,++et):F},Ie=function(Be,et){if(!Be||!et)return!1;for(let at=0;at<Be.terms.length;at++)if(Be.terms[at].lessThan(et.terms[at]))return!1;return!0},Ve=Ie(ae[0],Re[0])&&ae[0].count>Re[0].count?Re:ae,je=We(Ve),st=[];if(je){let Be=je[1],et=function(U,C){return U[0].sum.equals(C[0].sum)?U.length>=C.length:!0},at=function(U,C,N){let f=[];for(let p=0;p<U.length;p++){let _=U[p];for(let t=0;t<_.terms.length;t++){let i=f[t],c=_.terms[t];p===0?f[t]=c:i&&!i.equals(c)&&(f[t]=void 0)}}for(let p=0;p<f.length;p++){let _=f[p];if(_&&!_.equals(0))return p}return N},Te=function(U,C){let N=U.len(),f=C.len(),p=C.terms[Be],_=U.terms[Be];return f>N&&p.greaterThan(_)?f-N:p.subtract(_)};Be=at(ae,Re,Be),ae.sort(Te),Re.sort(Te);let F=Re[0],j=ae[0];if(B=new xe(new ye(1),[],j.map),F.sum.greaterThan(j.sum)&&j.len()>1)for(let U=0;U<j.terms.length;U++){let C=F.terms[U].subtract(j.terms[U]);if(C.equals(0))B.terms[U]=new ye(0);else{let N=C.add(new ye(1));B.terms[U]=C;for(let f=0;f<ae.length;f++)ae[f].terms[U]=ae[f].terms[U].add(N)}}let Z=Ie(ae[0],Re[0]),x=0,W=200;for(;Z&&et(ae,Re);){if(x++>W)throw new n.exceptions.InfiniteLoopError("Unable to compute!");let U=ae[0].divide(Re[0]);st.push(U),ae.shift();for(let C=1;C<Re.length;C++){let N=Re[C].multiply(U).generateImage(),f=ae.length;f===0&&(N.coeff=N.coeff.neg(),ae.push(N),ae.sort(Te));for(let p=0;p<f;p++){let _=ae[p];if(_.getImg()===N.getImg()){_.coeff=_.coeff.subtract(N.coeff),_.coeff.equals(0)&&(n.Utils.remove(ae,p),p--);break}p===f-1&&(N.coeff=N.coeff.neg(),ae.push(N),ae.sort(Te))}}if(Z=Ie(ae[0],Re[0]),!Z&&ae.length>=Re.length){for(let C=1;C<ae.length;C++)if(Z=Ie(ae[C],Re[0]),Z){ae.unshift(n.Utils.remove(ae,C));break}}}}b=J(st),L=J(ae),typeof B<"u"&&(B=B.toSymbol(),b=e.divide(b,B.clone()),L=e.divide(L,B))}return E&&(b=e.parse(b.text(),O),L=e.parse(L.text(),O)),[b,L]}catch(w){if(w.message==="timeout")throw w;return o}},line(l,S,o){n.Utils.isArray(l)&&(l=n.Utils.convertToVector(l)),n.Utils.isArray(S)&&(S=n.Utils.convertToVector(S)),o=e.parse(o||"x"),(!n.Utils.isVector(l)||!n.Utils.isVector(S))&&e.error(`Line expects a vector! Received "${l}" & "${S}"`);let w=e.subtract(S.e(1).clone(),l.e(1).clone()),y=e.subtract(S.e(2).clone(),l.e(2).clone()),E=e.divide(y,w),O=e.multiply(o,E.clone()),G=e.multiply(l.e(1).clone(),E);return e.add(e.subtract(O,G),l.e(2).clone())},PartFrac:{createTemplate(l,S,o,w){l=Y.Factor.factorInner(l),l.each((J,ce)=>{if(J.group===K&&J.fname===""&&J.args[0].group===me){let pe=J.args[0];l.symbols?(delete l.symbols[ce],l.symbols[pe.value]=pe):l=J.args[0]}});let y,E,O,G=S.collectFactors(),b=[],L=[],B=new ee(1);for(let J=0;J<G.length;J++){let ce=ee.unwrapPARENS(G[J]);if(ce.power.greaterThan(1)){E=Number(ce.power),y=ce.clone().toLinear(),O=Number(Y.degree(y,w));for(let pe=0;pe<E;pe++){let Oe=e.pow(y.clone(),new ee(pe+1));o.push(Oe.clone());let ae=e.divide(l.clone(),Oe.clone());L.push(O),b.push(ae)}}else{O=Number(Y.degree(ce,w)),o.push(ce);let pe=e.divide(l.clone(),ce.clone());pe=e.expand(ee.unwrapPARENS(pe)),L.push(O),b.push(pe)}}return o=o.map(J=>e.multiply(J,B.clone())),[o,b,L]},partfrac(l,S,o){let w=lt(l);S||=e.parse(w[0]);try{let y,E,O,G=e.expand(l.getNum()),b=e.expand(l.getDenom().toUnitMultiplier());if(G.multiplier=l.multiplier,y=G.groupTerms(S),Number(Y.degree(G,S))>=Number(Y.degree(b,S))?(E=Y.div(G.clone(),e.expand(b.clone())),O=E[0],G=E[1],y=G.groupTerms(S)):O=new ee(0),Number(Y.degree(b,S))===1){let Te=e.divide(G,b);return o?[O,Te]:e.add(O,Te)}let L=Y.Factor.factorInner(b),B=Y.PartFrac.createTemplate(b.clone(),L,[],S),J=B[0],ce=B[1],pe=B[2],Oe=[y.length],ae=[],Re=[],We=[],Ie,Ve;ce.forEach((Te,F)=>{Ie=J[F],Ve=pe[F];for(let j=0;j<Ve;j++){Re.push(Ie.clone());let Z=ee.create(S,j),x=e.expand(e.multiply(Te,Z.clone())).groupTerms(S),W=x.length;Oe.push(W),ae.push(x),We.push(Z.clone())}});let je=n.Utils.arrayMax(Oe),st=new n.Matrix(n.Utils.fillHoles(y,je)).transpose(),Be=new n.Matrix;for(let Te=0;Te<ae.length;Te++)Be.elements.push(n.Utils.fillHoles(ae[Te],je));let et=e.multiply(Be.transpose().invert(),st),at=o?[O]:O;return et.each((Te,F)=>{let j=e.multiply(We[F],e.divide(Te,Re[F]));o?at.push(j):at=e.add(at,j)}),at}catch(y){if(y.message==="timeout")throw y;try{if(l.isComposite()){let E={};l.each(G=>{let b=G.getDenom(),L=G.getNum(),B=E[b];E[b]=B?e.add(B,L):L});let O=new ee(0);for(let G in E)Object.hasOwn(E,G)&&(O=e.add(O,e.divide(E[G],e.parse(G))));l=O}}catch(E){if(E.message==="timeout")throw E}}return l}},degree(l,S,o){if(o||={nd:[],sd:[],depth:0},!S){let E=lt(l);if(E.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(E.length===0)return new ee(0);S=e.parse(E[0])}let w=l.group;l.isComposite()?(l=l.clone(),l.distributeExponent(),l.each(E=>{o.depth++,Y.degree(E,S,o),o.depth--})):l.group===u?l.each(E=>{o.depth++,Y.degree(E,S,o),o.depth++}):w===we&&l.value===S.value?o.sd.push(l.power.clone()):w===me&&l.value===S.value?o.nd.push(e.parse(l.power)):o.nd.push(new ee(0));let y=o.nd.length>0?n.Utils.arrayMax(o.nd):void 0;return o.depth===0&&o.sd.length>0?(y!==void 0&&o.sd.unshift(y),e.symfunction("max",o.sd)):(n.Utils.isSymbol(y)||(y=e.parse(y)),y)},sqComplete(l,S,o){n.Utils.isSymbol(S)||(S=e.parse(S));let w=function(ae){throw ae||="Stopping",new n.exceptions.ValueLimitExceededError(ae)};l.isPoly(!0)||w("Must be a polynomial!");let y=n.Utils.inBrackets;l=l.clone();let E=n.Algebra.degree(l,S);E.equals(2)||w(`Cannot complete square for degree ${E}`);let O=n.Algebra.coeffs(l,S),G=O[2],b=O[1].sign(),L=e.divide(O[1],new ee(2)),B=e.pow(L.clone(),new ee(2)),J=Xe.sqrt(G),ce=e.divide(Xe.sqrt(B),J.clone()),pe=e.subtract(O[0],e.pow(ce.clone(),new ee(2)));if(o)return[G,L,pe];let Oe=e.parse(y(`${J.clone()}*${S}${b<0?"-":"+"}${ce}`));return{a:Oe,c:pe,f:e.add(e.pow(Oe.clone(),new ee(2)),pe.clone())}},Simplify:{strip(l){let S=e.parse(l.multiplier);l.toUnitMultiplier();let o=e.parse(l.power);return l.toLinear(),[S,o,l]},unstrip(l,S){let o=l[0],w=l[1];return e.multiply(o,e.pow(S,w))},complexSimp(l,S){let o=l.realpart(),w=l.imagpart(),y=S.realpart(),E=S.imagpart(),O=e.multiply(o.clone(),y.clone()),G=e.multiply(w.clone(),E.clone()),b=e.multiply(y.clone(),w),L=e.multiply(o,E.clone()),B=e.add(e.pow(y,new ee(2)),e.pow(E,new ee(2)));return e.divide(e.add(e.add(O,G),e.multiply(e.subtract(b,L),ee.imaginary())),B)},trigSimp(l){let S=!0,o=0;for(;S&&l.containsFunction(["cos","sin","tan"]);){o++,S=!1,l=l.clone();let w=Y.Simplify.strip(l);l=w.pop();let y=l.clone();if(l.group===V){let E=new ee(0);l.each(O=>{let G=Y.Simplify.trigSimp(O.fnTransform());E=e.add(E,G)},!0),y=e.pow(e.multiply(new ee(l.multiplier),E),new ee(l.power)),S=y.text()!==l.text()}else if(l.group===u){let E=l.getNum(),O=l.getDenom();if(E.fname==="sin"&&O.fname==="cos"&&E.args[0].equals(O.args[0])&&E.power.equals(O.power))y=e.parse(n.Utils.format("(({1})/({0}))*tan({2})^({3})",O.multiplier,E.multiplier,E.args[0],E.power)),S=!0;else if(E.fname==="tan"&&O.fname==="sin"&&E.args[0].equals(O.args[0])&&E.power.equals(O.power))y=e.parse(n.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",O.multiplier,E.multiplier,E.args[0],E.power)),S=!0;else{let G=new ee(1),b={workDone:S};y.each(L=>{if(L.fname==="tan")L=e.parse(n.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",L.multiplier,Y.Simplify._simplify(L.args[0]),L.power)),b.workDone=!0;else if(L.containsFunction(["cos","sin","tan"])){let B=Y.Simplify.trigSimp(L);L.equals(B)||(L=B,b.workDone=!0)}G=e.multiply(G,L)}),S=b.workDone,y=G}}else if((l.fname==="cos"||l.fname==="sin")&&l.args[0].group===V){let E=0,O=new ee(0),G=e.parse("pi/2");if(l.args[0].each(b=>{let L=e.divide(b.clone(),G.clone());L=Y.Simplify._simplify(L),L=n.Utils.evaluate(L),Ae(L)?E+=L.multiplier.num.toJSNumber():O=e.add(O,b)}),E){E+=l.fname==="cos"?1:0,E%=4,E+=E<0?4:0;let b=["sin({0})","cos({0})","-sin({0})","-cos({0})"],L=n.Utils.format(b[E],O);y=e.parse(L),S=!0}else if(Object.keys(l.args[0].symbols).length>1){let b=l.args[0].clone(),L=Object.values(b.symbols),B=L[0],ce=L.slice(1).map(Oe=>`(${Oe.text()})`).join("+"),pe;l.fname==="sin"?pe=n.Utils.format("sin({0})cos({1})+sin({1})cos({0})",B,ce):pe=n.Utils.format("cos({0})cos({1})-sin({1})sin({0})",B,ce),y=e.parse(pe),S=!0}}else if((l.fname==="cos"||l.fname==="sin")&&l.args[0].multiplier.sign()===-1){let E=l.args[0].clone().negate(),O=n.Utils.format(`${l.fname}({0})`,E);l.fname==="sin"&&(O=`-${O}`),y=e.parse(O),S=!0}if(l.fname==="sin"&&l.args[0].multiplier.equals(2)&&!l.args[0].equals(2)){let E=l.args[0].clone().toUnitMultiplier(),O=n.Utils.format("2sin({0})cos({0})",E);y=e.parse(O),S=!0}if(y=Y.Simplify.unstrip(w,y).distributeMultiplier(),l=y,o>10)break}return l},logArgSimp(l,S){if(S.value==="1"||S.value===1)return new ee(0);let o=new ee(0),w=S.multiplier.clone();if(S.toUnitMultiplier(),!w.equals(1)){let y=n.Utils.format("({0}({1}))",l,w);o=e.add(o,e.parse(y))}if(S.group===u)S.each(y=>{y=y.clone();let E=y.power.clone();Y.Simplify.strip(y);let O=n.Utils.format("(({1})*{0}({2}))",l,E,y);o=e.add(o,e.parse(O))});else{let y=S.clone(),E=y.power.clone();Y.Simplify.strip(y);let O=n.Utils.format("(({1})*{0}({2}))",l,E,y);o=e.add(o,e.parse(O))}return o},logSimp(l){if(l.group===K&&(l.fname==="log"||l.fname==="log10")){let S=l.clone(),o=Y.Simplify.strip(l);l=o.pop();let w=l.args[0].clone(),y=w.getNum().clone(),E=w.getDenom().clone(),O=l.fname,G=Y.Simplify.logArgSimp(O,y);if(!E.equals(1)){let b=Y.Simplify.logArgSimp(O,E);G=e.subtract(G,b)}G=Y.Simplify.unstrip(o,G).distributeMultiplier(),l=G}else if(l.containsFunction(["log","log10"]))for(let S in l.symbols){if(!Object.hasOwn(l.symbols,S))continue;let o=l.symbols[S];l.symbols[S]=Y.Simplify.logSimp(o)}return l},_sqrtCompression(l,S,o){let w=Y.Simplify.strip(l),y=Oe=>Oe.fname==="abs",E=Oe=>Oe.args[0],O=Oe=>y(Oe)?E(Oe):null,G=Oe=>Oe.type===me&&Oe.value.startsWith("baseunit_"),b=(Oe,ae)=>{let Re=E(ae);return Re.equals(O(Oe))?[ae,null]:Re.equals(Oe)&&G(Oe)?[ae,null]:[null,ae]},L,B=!1,J=(Oe,ae)=>{for(let Re=0;Re<Oe.length;Re++){let We=Oe[Re];if(We.isSQRT()){for(let Ie=0;Ie<ae.length;Ie++){let Ve=ae[Ie];if([Ve,We]=b(Ve,We),Ve!==null){ae[Ie]=Ve,L=!0,B=!0;break}}Oe[Re]=We,Oe=Oe.filter(Ie=>Ie),ae=ae.filter(Ie=>Ie)}}return[Oe,ae]},ce=S.collectFactors(),pe=o.collectFactors();do L=!1,[ce,pe]=J(ce,pe),[pe,ce]=J(pe,ce);while(L);return B&&(l=ce.reduce((Oe,ae)=>Oe=e.multiply(Oe,ae),new ee(1)),l=pe.reduce((Oe,ae)=>Oe=e.divide(Oe,ae),l)),l=Y.Simplify.unstrip(w,l),l},fracSimp(l){let S=l.getDenom(),o=l.getNum();if(o.isImaginary()&&S.isImaginary()&&(l=Y.Simplify.complexSimp(o,S)),l.isComposite()){l.power>1&&(l=e.expand(l));let w=l.collectSymbols(),y,E,O,G,b,L,B,J,ce,pe,Oe;for(E=w.pop();w.length;)O=w.pop(),G=e.parse(E.getDenom()),b=e.parse(O.getDenom()),L=E.getNum(),B=O.getNum(),Oe=e.multiply(G.clone(),b.clone()),ce=e.multiply(L,b),pe=e.multiply(B,G),J=e.add(ce,pe),E=e.divide(J,Oe);return S=e.expand(E.getDenom()),o=e.expand(E.getNum()),o.isImaginary()&&S.isImaginary()?y=Y.Simplify.complexSimp(o,S):y=e.divide(o,S),y.equals(l)?l:Y.Simplify._simplify(y)}return l=Y.Simplify._sqrtCompression(l,o,S),l=Y.Simplify.simpleFracSimp(l),l},simpleFracSimp(l){let S=l.getDenom(),o=l.getNum(),w;return S=e.expand(S),o=e.expand(o),o.isImaginary()&&S.isImaginary()?w=Y.Simplify.complexSimp(o,S):w=e.divide(o,S),w.equals(l)?l:w},ratSimp(l){if(l.group===u){let S=l.getDenom(),o=l.getNum().distributeMultiplier(),w=Y.Simplify.fracSimp(S),y=Y.Simplify.fracSimp(o);l=e.divide(y,w)}return l},sqrtSimp(l,S){let o,w=!1,y=l.clone();try{if(l.isSQRT()){let E=l.multiplier.clone(),O=l.args[0].clone(),G=Y.Factor.factorInner(O),b=e.parse(G.multiplier),L=b.sign();o=new ee(1);let B;if(G.group===u){let J=new ee(1);G.each(pe=>{if(pe=e.parse(pe),pe.group===$){let Oe=e.sqrt(pe.clone());Ae(Oe)?o=e.multiply(o,Oe):J=e.multiply(J,pe)}else J=e.multiply(J,pe)});let ce=e.multiply(J,e.parse(L));B=e.sqrt(ce.clone()),B.isImaginary()&&(B=e.sqrt(e.expand(ce.clone())))}else B=G.clone().toUnitMultiplier(),B=e.multiply(B,new ee(L)),B=e.sqrt(B);o=e.multiply(o,B),o=e.pow(o,e.parse(l.power)),o=e.multiply(o,e.sqrt(b.abs())),o=e.multiply(o,e.parse(E)),w=!0}else l.isComposite()&&l.isLinear()?(o=new ee(0),l.each(E=>{o=e.add(o,Y.Simplify.sqrtSimp(E))},!0),o=e.pow(o,e.parse(l.power)),o=e.multiply(o,e.parse(l.multiplier)),w=!0):l.group===u&&(o=new ee(1),l.each(E=>{let O=Y.Simplify.sqrtSimp(E);o=e.multiply(o,O)}),o=e.pow(o,e.parse(l.power)),o=e.multiply(o,e.parse(l.multiplier)),w=!0);return w||o&&!Ae(o)&&(o=null),o||=e.parse(l),o}catch(E){if(E.message==="timeout")throw E;return y}},patternSub(l){let S={},o=function(y){let E=!1;return y.each(O=>{O.group===V?E=!0:O.symbols&&(E=o(O))}),E},w=function(y){y.each(E=>{if(!(!E.symbols&&E.group!==K)){if(o(E))w(E);else if(!S[E.value]){let O=n.Utils.getU(l);S[E.value]=O,l=l.sub(E.value,O)}}},!0)};return w(l),[l,S]},simplify(l){if(l.simplify)return l.simplify();let S=Y.Simplify._simplify(l);return S=S.pushMinus(),S=e.parse(S),S},_simplify(l){let S=Y.Simplify.strip(l.clone());if(l=S.pop(),l=Y.Simplify.fracSimp(l),l.isConstant()||l.group===n.groups.S)return S.push(l),Y.Simplify.unstrip(S,l);let o=l.clone();if(o=Y.Simplify.sqrtSimp(o,S),o=Y.Simplify.trigSimp(o),o=Y.Simplify.logSimp(o),o=Y.Simplify.ratSimp(o),o=Y.Factor.factorInner(o),o.group===n.groups.CP&&o.isLinear()){let w=o.multiplier.clone();o.toUnitMultiplier();let y=new ee(0);return o.each(E=>{let O=Y.Simplify._simplify(E);y=e.add(y,O)}),o=y,o=e.multiply(o,new ee(w)),o.multiplier.equals(-1)&&o.distributeMultiplier(),o=Y.Simplify.unstrip(S,o),o}return o=Y.Simplify.unstrip(S,o),o}},Classes:{Polynomial:_e,Factors:He,MVTerm:xe}};n.Expression.prototype.simplify=function(){n.Utils.armTimeout();try{let S;if(typeof this.symbol.LHS>"u")S=new n.Expression(Y.Simplify.simplify(this.symbol));else{let o=this.symbol.clone();o.LHS=Y.Simplify.simplify(o.LHS),o.RHS=Y.Simplify.simplify(o.RHS),S=o}return S}catch(S){if(S.message==="timeout")throw S;return this}finally{n.Utils.disarmTimeout()}},n.Collection.prototype.simplify=function(){return this.elements=this.elements.map(S=>Y.Simplify.simplify(S)),this},n.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(S=>S.map(o=>Y.Simplify.simplify(o))),this},N0.useAlgebraDiv=function(){let S=Y.divideFn=e.divide,o=0;e.divide=function w(y,E){o++;let O;return o===1?O=n.Algebra.divide(y,E):O=w(y,E),o=0,O}},N0.useParserDiv=function(){Y.divideFn&&(e.divide=Y.divideFn),delete Y.divideFn},N0.register([{name:"factor",visible:!0,numargs:1,build(){return Y.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return Y.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return Y.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return Y.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return Y.roots}},{name:"divide",visible:!0,numargs:2,build(){return Y.divide}},{name:"div",visible:!0,numargs:2,build(){return Y.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return Y.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return Y.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...S){let o=Y.coeffs(...S);return new n.Vector(o)}}}]),N0.coeffs=function(...S){let o=n.PARSER;for(let y=0;y<S.length;y++)typeof S[y]=="string"?S[y]=o.parse(S[y]):S[y]&&S[y].symbol?S[y]=S[y].symbol.clone():n.Utils.isSymbol(S[y])&&(S[y]=S[y].clone());let w=Y.coeffs(...S);return new n.Expression(new n.Vector(w))},N0.register([{name:"line",visible:!0,numargs:[2,3],build(){return Y.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(S,o){try{return o||=lt(S)[0],Y.sqComplete(S.clone(),o).f}catch(w){if(w.message==="timeout")throw w;return S}}}}]),N0.updateAPI()})()});var mn=g0((Hi,gn)=>{"use strict";var J0;typeof gn<"u"&&(J0=k0(),W0(),Q0());(function(){let n=J0.getCore(),e=n.PARSER,$=n.Algebra,z=n.Calculus,me=z.integration.decompose_arg,{evaluate:we}=n.Utils,{remove:K}=n.Utils,{format:le}=n.Utils,{build:V}=n.Utils,{knownVariable:u}=n.Utils,{NerdamerSymbol:se}=n,{isSymbol:pt}=n.Utils,{variables:lt}=n.Utils,{S:ze}=n.groups,{PL:ue}=n.groups,{CB:ye}=n.groups,{CP:Ae}=n.groups,{FN:ee}=n.groups,{Settings:Le}=n,{range:Xe}=n.Utils,{isArray:Fe}=n.Utils;n.Settings.SOLVE_RADIUS=1e3,n.Settings.ROOTS_PER_SIDE=10,n.Settings.make_pi_conversions=!1,n.Settings.STEP_SIZE=.1,n.Settings.EPSILON=2e-13,n.Settings.MAX_NEWTON_ITERATIONS=200,n.Settings.NEWTON_EPSILON=2e-15,n.Settings.MAX_NON_LINEAR_TRIES=12,n.Settings.NON_LINEAR_JUMP_AT=50,n.Settings.NON_LINEAR_JUMP_SIZE=100,n.Settings.NON_LINEAR_START=.01,n.Settings.NEWTON_SLICES=200,n.Settings.SOLUTION_PROXIMITY=1e-14,n.Settings.FILTER_SOLUTIONS=!0,n.Settings.MAX_SOLVE_DEPTH=10,n.Settings.ZERO_EPSILON=1e-9,n.Settings.MAX_BISECTION_ITER=2e3,n.Settings.BI_SECTION_EPSILON=1e-12,n.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},n.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let w in this.symbols){if(!Object.hasOwn(this.symbols,w))continue;let y=this.symbols[w];if(y.group===ue&&y.hasNegativeTerms()||this.symbols[w].power.lessThan(0))return!0}return!1};function _e(o,w){if(w.isConstant()&&o.isConstant()&&!o.equals(w)||o.equals(n.Settings.IMAGINARY)&&w.isConstant(!0)||w.equals(n.Settings.IMAGINARY)&&o.isConstant(!0))throw new n.exceptions.NerdamerValueError(`${o.toString()} does not equal ${w.toString()}`);this.LHS=o,this.RHS=w}_e.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(o){return`${this.LHS.text(o)}=${this.RHS.text(o)}`},toLHS(o){o=!!o;let w=this.removeDenom(),y=w.LHS,E=w.RHS;y.isConstant(!0)&&!E.isConstant(!0)&&([y,E]=[E,y]);let O=e.subtract(y,E),G=o?e.expand(O):O;return G=new _e(G,new se(0)).removeDenom().LHS,G},removeDenom(){let o=this.LHS.clone(),w=this.RHS.clone(),y=e.multiply(o.getDenom(),w.getDenom());if(o=e.expand(e.multiply(o,y.clone())),w=e.expand(e.multiply(w,y)),w.group===Ae&&w.group!==Ae){let E=o;o=w,w=E}if(o.group===ye){let E=new se(o.multiplier),O=w.clone();o.each(G=>{G.power.lessThan(0)?O=e.divide(O,G):E=e.multiply(E,G)}),o=E,w=O}else if(o.group===Ae)for(let E in o.symbols){if(!Object.hasOwn(o.symbols,E))continue;let O=o.symbols[E];if(O.group===ye)for(let G in O.symbols){if(!Object.hasOwn(O.symbols,G))continue;let b=O.symbols[G];if(b.power.lessThan(0))return new _e(e.expand(e.multiply(b.clone().toLinear(),o)),e.expand(e.multiply(b.clone().toLinear(),w)))}}return new _e(o,w)},clone(){return new _e(this.LHS.clone(),this.RHS.clone())},sub(o,w){let y=this.clone();return y.LHS=y.LHS.sub(o.clone(),w.clone()),y.RHS=y.RHS.sub(o.clone(),w.clone()),y},isZero(){return n.Utils.evaluate(this.toLHS()).equals(0)},latex(o){return[this.LHS.latex(o),this.RHS.latex(o)].join("=")}},e.equals=function(w,y){return new _e(w,y)},(function(){let w=e.functions.simplify[0];e.functions.simplify[0]=function(E){return E instanceof _e?(E.LHS=w(E.LHS),E.RHS=w(E.RHS),E):w(E)}})(),n.Expression.prototype.equals=function(w){return w instanceof n.Expression&&(w=w.symbol),new _e(this.symbol,w)},n.Expression.prototype.solveFor=function(w){n.Utils.armTimeout();try{let{symbol:y}=this;if(this.symbol instanceof _e){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(w))return[new n.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(w))return[new n.Expression(this.symbol.RHS)]}return S(y,w).map(G=>(G=n.Algebra.Simplify.simplify(e.parse(G)),new n.Expression(G)))}finally{n.Utils.disarmTimeout()}},n.Expression.prototype.expand=function(){if(this.symbol instanceof _e){let w=this.symbol.clone();return w.RHS=e.expand(w.RHS),w.LHS=e.expand(w.LHS),new n.Expression(w)}return new n.Expression(e.expand(this.symbol))},n.Expression.prototype.variables=function(){return this.symbol instanceof _e?n.Utils.arrayUnique(n.Utils.variables(this.symbol.LHS).concat(n.Utils.variables(this.symbol.RHS))):n.Utils.variables(this.symbol)};let He=function(w,y){return e.equals(w,y)};n.Equation=_e;let xe=n.Utils.checkAll=function(w,y){for(let E=0;E<w.length;E++)if(y(w[E]))return!1;return!0},Y=n.Solve={version:"2.0.3",solutions:[],solve(o,w){let y=Le.PARSE2NUMBER;Le.PARSE2NUMBER=!1;let E=S(o,String(w));return Le.PARSE2NUMBER=y,new n.Vector(E)},toLHS(o,w){if(pt(o))return o;if(!(o instanceof _e)){let y=o.split("=");y[1]||="0",o=new _e(e.parse(y[0]),e.parse(y[1]))}return o.toLHS(w)},solveCircle(o,w){let y=w.map(L=>e.parse(L)),E=[],O=[];for(let L=0;L<o.length;L++){let B=[];for(let J=0;J<y.length;J++)B.push(Number(n.Algebra.degree(o[L],y[J])));B.push(n.Utils.arraySum(B,!0)),E.push(B)}let G=o[0],b=o[1];if(E[0][2]>E[1][2]&&([b,G]=[G,b],[E[1],E[0]]=[E[0],E[1]]),E[0][0]===1&&E[0][2]===2&&E[1][0]===2&&E[1][2]===4){let L=w[0],B=w[1],J=S(e.parse(b,u(L,S(e.parse(G),L)[0])),B).map(pe=>pe.toString()),ce=[S(e.parse(G,u(B,J[0])))[0].toString()];J[1]&&ce.push(S(e.parse(G,u(B,J[1])))[0].toString()),Le.SOLUTIONS_AS_OBJECT?(O={},O[L]=ce,O[B]=J):(J.unshift(B),ce.unshift(L),O=[ce,J])}return O},solveNonLinearSystem(o,w,y){if(w<0)return[];y=typeof y>"u"?n.Settings.NON_LINEAR_START:y;let E=n.Settings.MAX_NON_LINEAR_TRIES,O=Math.floor(E/2);w=typeof w>"u"?E:w;let G=n.Settings.NON_LINEAR_JUMP_AT,b=n.Settings.NON_LINEAR_JUMP_SIZE,L=!0,B=function(Te,F){return Te.map((j,Z)=>Number(F.get(Z,0)))},J=n.Utils.arrayGetVariables(o),ce=n.Matrix.jacobian(o,J,Te=>V(Te,J),!0),pe=n.Settings.MAX_NEWTON_ITERATIONS,Oe,ae,Re,We,Ie,Ve,je,st,Be=o.map(Te=>V(Te,J)),et=ce.map(Te=>V(Te,J),!0);We=n.Matrix.cMatrix(0,J);let at=n.Matrix.cMatrix(y,J);Re=0;do{if(Re>pe){L=!1;break}Oe=B(J,at),je=at.clone();let Te=Oe,F=at;Be.forEach((Z,x)=>{F.set(x,0,Z(...Te))});let j=new n.Matrix;if(et.each((Z,x,W)=>{let U=Z(...Te);j.set(x,W,U)}),j=j.invert(),ae=e.multiply(j,at).negate(),st=ae.subtract(We,Z=>e.parse(Number(Z))),We=je.add(ae,Z=>e.parse(Number(Z))),at=We,Re>=G&&Ie>1){w===O&&(y=0);let Z=w>O?1:-1,x=w%Math.floor(O)+1;return y+=Z*x*b,Y.solveNonLinearSystem(o,--w,y)}if(Ve=Ie,Re++,Ie=st.max(),Number(Ie)===Number(Ve))break}while(Number(Ie)>=Number.EPSILON);return L?Y.systemSolutions(at,J,!0,Te=>n.Utils.round(Number(Te),14)):[]},systemSolutions(o,w,y,E){let O=n.Settings.SOLUTIONS_AS_OBJECT?{}:[];return o.each((G,b)=>{let L=(y?e.expand(G):G).valueOf();E&&(L=E.call(G,L));let B=w[b];n.Settings.SOLUTIONS_AS_OBJECT?O[B]=L:O.push([B,L])}),O},solveSystemBySubstitution(o){let w=lt(o[0]),y=lt(o[1]);return o.length===2&&w.length===2&&n.Utils.arrayEqual(w,y)?Y.solveCircle(o,w):[]},solveSystem(o,w){for(let B=0;B<o.length;B++)o[B]=Y.toLHS(o[B]);let y=o.length,E=new n.Matrix,O=new n.Matrix,G=!1,b;if(typeof w>"u"){if(!$.allLinear(o))try{return Y.solveNonLinearSystem(o)}catch(B){if(B.message==="timeout")throw B;if(B instanceof n.exceptions.DivisionByZero)return Y.solveSystemBySubstitution(o)}if(b=n.Utils.arrayGetVariables(o),b.length===1){let B=0,J,ce;do ce=o[B].clone(),B>0&&(ce=ce.sub(b[0],J[0])),J=S(ce,b[0]);while(++B<o.length);let pe;return Le.SOLUTIONS_AS_OBJECT?(pe={},pe[b[0]]=J):J.length===0?pe=J:pe=[b[0],J],pe}if(b.length<o.length){let B=[],J=o.length;for(let ae=0;ae<J-1;ae++)B.push(e.parse(o[ae]));let ce={},pe=Y.solveSystem(B,b);Array.isArray(pe)?pe.forEach(ae=>{ce[ae[0]]=ae[1]}):ce=pe;let Oe=!0;for(let ae=J-1;ae<J;ae++)e.parse(o[ae],ce).equals(0)||(Oe=!1);if(Oe)return pe}for(let B=0;B<b.length;B++)J0.setVar(b[B],"delete");for(let B=0;B<y;B++){let J=o[B];for(let pe=0;pe<b.length;pe++){let Oe=b[pe],ae=[];J.each(We=>{We.contains(Oe)&&(ae=ae.concat(We.coeffs()))});let Re=n.Utils.arraySum(ae);E.set(B,pe,Re)}let ce=J.clone();b.forEach(pe=>{ce=ce.stripVar(pe,!0)}),O.set(B,0,ce.negate())}}else{b=w,G=!0;for(let B=0;B<y;B++){O.set(B,0,new se(0));let J=e.expand(o[B]).collectSummandSymbols();for(let ce=0;ce<w.length;ce++){E.set(B,ce,new se(0));let pe=w[ce];for(let Oe=0;Oe<J.length;Oe++){let ae=J[Oe],Re=!1;for(let We=0;We<w.length;We++)ae.contains(w[We])&&(Re&&n.err(`Multiple variables found for term ${ae}`),Re=!0);if(ae.contains(pe)){let We=me(K(J,Oe),pe);Oe--,E.set(B,ce,e.add(E.get(B,ce),We[0]))}}}for(let ce=0;ce<J.length;ce++)O.set(B,0,e.add(O.get(B,0),J[ce]))}}if(b.length!==o.length||E.determinant().equals(0))throw new n.exceptions.SolveError("System does not have a distinct solution");E=E.invert();let L=E.multiply(O);return n.Utils.isArray(w)&&L.each(B=>B.negate()),Y.systemSolutions(L,b,G)},quad(o,w,y){let E=e.subtract(e.pow(w.clone(),se(2)),e.multiply(e.multiply(y.clone(),o.clone()),se(4)));E=e.expand(E);let O=e.pow(E,se(.5)),G=e.parse(e.multiply(new se(2),y.clone()));return[e.parse(le("(-({0})+({1}))/({2})",w,O,G)),e.parse(le("(-({0})-({1}))/({2})",w,O,G))]},cubic(o,w,y,E){let O=E.text(),G=y.text(),b=w.text(),L=o.text(),B=`(-(${G})^3/(27*(${O})^3)+(${G})*(${b})/(6*(${O})^2)-(${L})/(2*(${O})))`,J=`((${b})/(3*(${O}))-(${G})^2/(9*(${O})^2))`,ce=`(${G})/(3*(${O}))`,pe=`((${B})+sqrt((${B})^2+(${J})^3))^(1/3)+((${B})-sqrt((${B})^2+(${J})^3))^(1/3)-(${ce})`,Oe="1/2+sqrt(3)/2*i";return[e.parse(pe),e.parse(`(${pe})(${Oe})`),e.parse(`(${pe})(${Oe})^2`)]},quartic(o,w,y,E,O){let G={};n.Utils.arrayUnique(lt(O).concat(lt(E)).concat(lt(y)).concat(lt(w)).concat(lt(o))).forEach(Ve=>{G[Ve]=1}),O=O.toString(),E=E.toString(),y=y.toString(),w=w.toString(),o=o.toString();let b,L=e.parse(le("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",O,E,y)).toString(),B=e.parse(le("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",O,E,y,w)).toString(),J=e.parse(le("12*({0})*({4})-3*({1})*({3})+({2})^2",O,E,y,w,o)).toString(),ce=e.parse(le("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",O,E,y,w,o)).toString(),pe=e.parse(le("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",J,ce)).toString(),Oe=e.parse(le("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",O,L,pe,J)).toString(),ae=e.parse(le("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",O,E,L,B,Oe)),Re=e.parse(le("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",O,E,L,B,Oe)),We=e.parse(le("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",O,E,L,B,Oe)),Ie=e.parse(le("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",O,E,L,B,Oe));return[ae,Re,We,Ie]},divideAndConquer(o,w){let y=[],E=n.Algebra.Factor.factorInner(o);return E.group===ye&&E.each(O=>{O=se.unwrapPARENS(O),y=y.concat(S(O,w))}),y},csolve(o,w){return n.Utils.block("IGNORE_E",()=>{let y,E,O,G,b,L,B,J,ce=[],pe=n.Utils.decompose_fn(o,w,!0);if(pe.x.group===ze){y=e.parse(pe.x.power),E=Number(y),O=e.pow(e.divide(pe.b.negate(),pe.a),y.invert()),G=se.toPolarFormArray(O),b=G[0],L=G[1],B=b.toString(),J=y.toString();let Oe,ae,Re;for(let We=0;We<E;We++)Oe=We,Re=le("({0})*e^(2*{1}*pi*{2}*{3})",B,Oe,y,n.Settings.IMAGINARY),ae=e.parse(Re),ce.push(ae)}return ce},!0)},getPoints(o,w,y){w||=.01;let E=[],O=V(o),b=Math.round(0),L=O(b),B=n.Settings.ROOTS_PER_SIDE,J=B;E.push(Math.floor(b/2)),E.push(Math.abs(b)),E.push(b),o.each(ae=>{ae.containsFunction(n.Settings.LOG)&&E.push(.1)});let ce=Xe(-n.Settings.SOLVE_RADIUS,b,w),pe=Xe(b,n.Settings.SOLVE_RADIUS,w),Oe=function(ae,Re){let We,Ie,Ve,je=[],st=ae[0],Be=Math.sign(O(st));for(let et=0,at=ae.length;et<at&&je.length<Re;et++)We=ae[et],Ie=O(We),Ve=Math.sign(Ie),!isNaN(Ve)&&(Ve!==Be&&(je.push(We),je.push(ae[et-1])),Be=Ve);E=E.concat(je)};if(Oe(ce,J),Oe(pe,B),y){let ae=n.Settings.SOLVE_RADIUS;Oe([ae,ae*ae],1),Oe([-ae*ae,-ae],1)}return E},bisection(o,w){let y=o-1,E=o+1;if(Math.sign(w(y))!==Math.sign(w(E))){let O=0,G,b;do{if(G=Math.abs(E-y),O++>n.Settings.MAX_BISECTION_ITER||isNaN(G))return;b=(y+E)/2,w(y)*w(b)>0?y=b:E=b}while(G>=Le.EPSILON);let L=(y+E)/2,B=w(L);return!isNaN(B)&&Math.abs(B)<=n.Settings.BI_SECTION_EPSILON?n.Utils.round(L,13):void 0}},bSearch(o,w,y){let E=y(o),O=y(w);if(Math.sign(E)===Math.sign(O)||isNaN(E)||isNaN(O))return;let G=80,b=0;do{let L=(o+w)/2,B=Math.sign(E),J=Math.sign(y(L));if(B===J){if(L===o)break;o=L,E=y(o)}else{if(L===w)break;w=L,O=y(w)}b++}while(o!==w&&b<G);if(!(!isFinite(y(o))||!isFinite(y(w))))return o},Newton(o,w,y,E){let O=n.Settings.MAX_NEWTON_ITERATIONS,G=0,b=o,L,B,J;do{let ce=w(b);if(b===0&&ce===0){L=0;break}if(G++,G>O)return;let pe=y(b);if(isNaN(pe)||isNaN(ce))return;if(pe===0)L+=J;else{if(!isFinite(ce)||!isFinite(pe)||Math.abs(ce)>1e25)return Y.bSearch(E,b,w);L=b-ce/pe}if(J=L-b,J===0&&!isFinite(pe))return;B=Math.abs(J),b=L}while(B>Le.NEWTON_EPSILON);return L},rewrite(o,w,y){if(w||=new se(0),o.isComposite()&&o.isLinear()){let G=[],b=[];o.each(L=>{L=L.clone(),L.fname==="sqrt"&&L.contains(y)?G.push(L):b.push(L)},!0),G.length===1&&(w=e.expand(e.pow(e.subtract(w,n.Utils.arraySum(b)),new se(2))),o=e.expand(e.pow(se.unwrapSQRT(G[0]),new se(2))))}else o=se.unwrapSQRT(e.expand(o));let E=0,O=o.length;if(o.group===Ae&&o.contains(y)&&o.isLinear()){o.distributeMultiplier();let G=new se(0);return o.each(b=>{b.contains(y)?(E++,G=e.add(G,b.clone())):w=e.subtract(w,b.clone())}),o=G,E!==O?Y.rewrite(o,w,y):[o,w]}if(o.group===ye&&o.contains(y)&&o.isLinear()){if(o.multiplier.lessThan(0)&&(o.multiplier=o.multiplier.multiply(new n.Frac(-1)),w.multiplier=w.multiplier.multiply(new n.Frac(-1))),w.equals(0))return new se(0);let G=new se(1);return o.each(b=>{b.contains(y)?G=e.multiply(G,b.clone()):w=e.divide(w,b.clone())}),o=G,Y.rewrite(o,w,y)}if(!o.isLinear()&&o.contains(y)){let G=e.parse(o.power.clone().invert());return o=e.pow(o,G.clone()),w=e.pow(e.expand(w),G.clone()),Y.rewrite(o,w,y)}return o.group===ee||o.group===ze||o.group===ue?[o,w]:[o,w]},sqrtSolve(o,w){let y=new se(0),E=new se(0);if(o.isComposite()&&(o.each(O=>{O.fname==="sqrt"&&O.contains(w)?y=e.add(y,O.clone()):E=e.add(E,O.clone())}),!y.equals(0))){let O=e.expand(e.multiply(e.parse(o.multiplier),e.subtract(e.pow(E,new se(2)),e.pow(y,new se(2))))),G=S(O,w);return G=G.filter(b=>{if(b.isImaginary())return!0;let L={};return L[w]=b,!!we(o,L).equals(0)}),G}}},l=function(o,w,y,E){let O=o.toString(),G=O.match(/(?<![a-z])abs/gu);if(!G||G.length>2||o.LHS.group!==ee&&o.RHS.group!==ee)return null;let b=o.constructor(O.replace(/(?<![a-z])abs/u,"")),L=o.constructor(O.replace(/(?<![a-z])abs/u,"(-1)")),B=S(b,w,null,y,E);return[S(L,w,null,y,E),B]};function S(o,w,y,E,O){if(E||=0,E++>Le.MAX_SOLVE_DEPTH)return y;y||=[];let G={},b={};b[w]=0;let L=function(Ie,Ve){let je=pt(Ie);if(!(Ie===void 0||typeof Ie=="number"&&isNaN(Ie))){if(Fe(Ie))Ie.forEach(st=>{L(st)});else if(Ie.valueOf()!=="null"){if(typeof n.Settings.PRE_ADD_SOLUTION=="function"&&(Ie=n.Settings.PRE_ADD_SOLUTION(Ie)),je||(Ie=e.parse(Ie)),n.Settings.make_pi_conversions&&Ve){let Be=e.divide(Ie.clone(),new se(Math.PI)),et=Be.multiplier,at=Math.abs(et.num),Te=Math.abs(et.den);at<10&&Te<10&&(Ie=e.multiply(Be,new se("pi")))}let st=Ie.toString();G[st]||y.push(Ie),G[st]=!0}}};if(o instanceof _e){let Ie=l(o,w,y,E,O);if(Ie)return L(Ie),y;if(o.isZero())return[new se(0)];if(o.LHS.equals(w)&&!o.RHS.contains(w,!0))return[o.RHS];if(o.RHS.equals(w)&&!o.LHS.contains(w,!0))return[o.LHS]}if(o instanceof n.Vector&&(o=o.elements),Fe(o))return Y.solveSystem(o,w);if(w||="x",pt(o)&&we(o.getDenom(),b).equals(0)===!0)return y;if(o.group===ze&&o.contains(w)){try{let Ie={};Ie[w]=0,we(O,Ie,"numer"),L(new se(0))}catch(Ie){if(Ie.message==="timeout")throw Ie}return y}if(o.group===ye){let Ie=o.getNum();if(Ie.group===ye){let Ve=String(w);return Ie.each(je=>{je.contains(Ve)&&S(je,w,y,E,o)}),y}return S(Ie,w,y,E,O)}o.group===ee&&o.fname==="sqrt"&&(o=e.pow(se.unwrapSQRT(o),new se(2)));let B=(n.Utils.isSymbol(o)?o:Y.toLHS(o,!1)).getNum(),J=n.Utils.variables(B),ce=J.length;if(n.Utils.isInt(B.power)&&B.power>1&&(B=e.parse(B).toLinear()),(B.group===ze||B.group===ye)&&B.contains(w))return[new se(0)];let pe={},Oe,ae=function(Ie){Ie=e.expand(Ie,{expand_denominator:!0,expand_functions:!0});let Ve=Ie.clone();if(Ie.symbols)for(let je in Ie.symbols){if(!Object.hasOwn(Ie.symbols,je))continue;let st=Ie.symbols[je],Be=st.getDenom();if(!Be.isConstant(!0)&&Ie.isComposite()){let j=new se(0);return Ie.each(Z=>{j=e.add(j,e.multiply(Z,Be.clone()))}),ae(e.multiply(e.parse(Ie.multiplier),j))}let et=me(st,w),at=et[1].fname===n.Settings.SQRT,Te=se.unwrapSQRT(et[1]),F=Te.power.clone();if(!pt(F)&&!F.equals(1/2)){if(F.den.gt(1)){if(at)return Ie=e.subtract(Ie,st.clone()),Ie=e.add(Ie,e.multiply(et[0].clone(),Te)),ae(Ie);let j=pe[F.den];pe[F.den]=j?j++:1}else if(F.sign()===-1){let j=e.parse(`${w}^${Math.abs(F)}`),Z=Ie;return Z.each((x,W)=>{x.contains(w)&&(Z.symbols[W]=e.multiply(x,j.clone()))}),pe={},ae(e.parse(Z))}else if(st.group===ue){let j=n.Utils.arrayMin(n.Utils.keys(st.symbols));if(j<0){let Z=e.parse(`${w}^${Math.abs(j)}`),x=new se(0);return Ve.each(W=>{x=e.add(x,e.multiply(W.clone(),Z.clone()))},!0),x}}}}return Ie},Re=function(Ie){let Ve=new se(0),je=new se(0);return Ie.each(st=>{st.contains(w,!0)?Ve=e.add(Ve,st.clone()):je=e.subtract(je,st.clone())}),[Ve,je]};if(Y.inverseFunctionSolve=function(Ve,je,st){let Be=me(je.args[0],w);if(Be[1].group===ze)return e.divide(e.symfunction(Ve,[e.divide(st,e.parse(je.multiplier))]),Be[0])},B=ae(B),B.equals(0))return[B];let We=n.Utils.keys(pe);if(We.length===1&&(Oe=We[0],B.each((Ie,Ve)=>{if(Ie.contains(w)){let je=me(Ie,w),st=je[1],Be=st.power;Be.den.gt(1)&&(st.power=Be.multiply(new n.Frac(Oe)),B.symbols[Ve]=e.multiply(st,je[0]))}}),B=e.parse(B)),L(Y.sqrtSolve(B,w)),ce===1)if(B.isPoly(!0)){let Ie=new n.Algebra.Classes.Factors;if(n.Algebra.Factor.factorInner(B,Ie),Ie.getNumberSymbolics()>1)for(let Ve in Ie.factors)Object.hasOwn(Ie.factors,Ve)&&L(S(Ie.factors[Ve],w));else{let Ve=n.Utils.getCoeffs(B,w),je=Ve.length-1,st=!1;if(J[0]===w){if(xe(Ve,Be=>Be.group!==n.groups.N)){let Be=n.Algebra.proots(B);xe(Be,et=>!n.Utils.isInt(et))&&(st=!0,Be.forEach(et=>{L(new se(et))}))}if(!st)if(o=e.parse(o),o instanceof n.Equation&&(o=o.toLHS()),je===1)L(e.divide(Ve[0],Ve[1].negate()));else if(je===2)L(e.expand(Y.quad.apply(void 0,Ve)));else if(je===3){let Be=[],et=n.Algebra.Factor.factorInner(o);Be=[],Be.length>0?L(Be):L(Y.cubic.apply(void 0,Ve))}else $.proots(B).map(L)}}}else{let Ie=B.hasTrig(),Ve=Y.getPoints(B,.1),je=Y.getPoints(B,.05),st=Y.getPoints(B,.01,!0),Be=n.Utils.arrayUnique(Ve.concat(je).concat(st)).sort((U,C)=>U-C),et,at,Te,F=V(B.clone()),j=[];for(et=0;et<Be.length;et++){if(at=Be[et],Te=Y.bisection(at,F),typeof Te>"u"){j.push(at);continue}L(Te,Ie)}Be=j;let Z=z.diff(B.clone()),x=V(Z),W=Be[0];for(et=0;et<Be.length;et++)at=Be[et],L(Y.Newton(at,F,x,W),Ie),W=at;y.sort((U,C)=>{let N=U.text("decimals"),f=C.text("decimals"),p=Number(N),_=Number(f);return isNaN(p)&&isNaN(_)?N.localeCompare(f):isNaN(p)&&!isNaN(_)?-1:!isNaN(p)&&isNaN(_)?1:p-_}),y=y.map(U=>U.isConstant()?new se(Number(Number(U).toPrecision(15))):U),y=y.filter((U,C,N)=>{let f=Number(Number(U).toPrecision(15)),p=Number(N[C-1]);return C===0||isNaN(f)||isNaN(p)?!0:Math.abs(f-p)>=Le.EPSILON})}else if(!B.hasFunc(w)&&B.isComposite())try{let Ie=n.Algebra.Factor.factorInner(B.clone()),Ve=e.expand(e.parse(Ie)),je=e.expand(B.clone()),st=e.subtract(Ve,je),Be=!0;if(st.equals(0)||(Be=!1),Be&&Ie.group===ye)Ie.each(et=>{L(S(et,w))});else{let et=n.Utils.getCoeffs(B,w);switch(et.length-1){case 0:{let F=Re(B),j=F[0],Z=F[1];if(j.group===n.groups.EX){let x=n.Settings.LOG,W=`${x}((${Z})/(${j.multiplier}))/(${x}(${j.value})*${j.power.multiplier})`,U=e.parse(W);L(U)}break}case 1:L(e.divide(et[0],et[1].negate()));break;case 2:L(Y.quad.apply(void 0,et));break;case 3:L(Y.cubic.apply(void 0,et));break;case 4:L(Y.quartic.apply(void 0,et));break;default:L(Y.csolve(B,w)),y.length===0&&L(Y.divideAndConquer(B,w))}y.length===0&&L(S(Ie,w,y,E))}}catch(Ie){if(Ie.message==="timeout")throw Ie}else try{let Ie=Y.rewrite(B,null,w),Ve=Ie[0],je=Ie[1];if(Ve.group===ee)if(Ve.fname==="abs")Ve.args[0].toString()===w&&L([je.clone(),je.negate()]);else if(Ve.fname==="sin")L(Y.inverseFunctionSolve("asin",Ve,je));else if(Ve.fname==="cos")L(Y.inverseFunctionSolve("acos",Ve,je));else if(Ve.fname==="tan")L(Y.inverseFunctionSolve("atan",Ve,je));else if(Ve.fname===n.Settings.LOG){let st=me(Ve.args[0],w),Be=st[1];if(Be.group===ze){je=e.divide(e.subtract(e.pow(Ve.args.length>1?Ve.args[1]:new se("e"),e.divide(je,e.parse(Ve.multiplier))),st[3]),st[0]);let et=new _e(Be,je).toLHS();L(S(et,w))}}else L(e.subtract(Ve,je));else{let st=new _e(Ve,je).toLHS();if(st.equals(B))throw new Error("Stopping. No stop condition exists");L(S(st,w))}}catch(Ie){if(Ie.message==="timeout")throw Ie;if(B.group===ye)L(0);else if(B.group===Ae){let Ve=Re(B),je=Ve[0],st=Ve[1];if(je.group===n.groups.EX&&je.value===w){let Be=je.power.clone().invert();L(e.pow(st,Be))}}}if(Oe&&(y=y.map(Ie=>e.pow(Ie,new se(Oe)))),pt(o)){let Ie={};y=y.filter(Ve=>{try{Ie[w]=Ve;let je=Number(we(o,Ie));return isNaN(je),!0}catch(je){if(je.message==="timeout")throw je;return!1}})}return y}J0.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return S}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return n.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return He}}]),J0.updateAPI()})()});var dn=g0((ji,f1)=>{"use strict";var Y0;typeof f1<"u"&&(Y0=k0(),W0(),Q0());(function(){let n=Y0.getCore(),e=n.PARSER,{NerdamerSymbol:$}=n,{format:z}=n.Utils,{isVector:me}=n.Utils,{isArray:we}=n.Utils,K=n.Vector,{S:le}=n.groups,V=n.groups.EX,{CP:u}=n.groups,{PL:se}=n.groups,{CB:pt}=n.groups,{FN:lt}=n.groups;n.Settings.Laplace_integration_depth=40,$.prototype.findFunction=function(ye){if(this.group===lt&&this.fname===ye)return this.clone();let Ae;if(this.symbols){for(let ee in this.symbols)if(Object.hasOwn(this.symbols,ee)&&(Ae=this.symbols[ee].findFunction(ye),Ae))break}return Ae};let ze=n.Extra={version:"1.4.2",LaPlace:{transform(ue,ye,Ae){ue=ue.clone(),ye=ye.toString(),ue=$.unwrapSQRT(ue,!0);let ee,Le=ue.stripVar(ye),Xe=ue.group;if(ue=e.divide(ue,Le.clone()),ue.isConstant()||!ue.contains(ye,!0))ee=e.parse(z("({0})/({1})",ue,Ae));else if(Xe===le&&n.Utils.isInt(ue.power)){let Fe=String(ue.power);ee=e.parse(z("factorial({0})/({1})^({0}+1)",Fe,Ae))}else if(ue.group===le&&ue.power.equals(1/2))ee=e.parse(z("sqrt(pi)/(2*({0})^(3/2))",Ae));else if(ue.isComposite())ee=new $(0),ue.each(Fe=>{ee=e.add(ee,ze.LaPlace.transform(Fe,ye,Ae))},!0);else if(ue.isE()&&(ue.power.group===le||ue.power.group===pt)){let Fe=ue.power.stripVar(ye);ee=e.parse(z("1/(({1})-({0}))",Fe,Ae))}else{let Fe=["sin","cos","sinh","cosh"];if(ue.group===lt&&Fe.indexOf(ue.fname)!==-1&&(ue.args[0].group===le||ue.args[0].group===pt)){let _e=ue.args[0].stripVar(ye);switch(ue.fname){case"sin":ee=e.parse(z("({0})/(({1})^2+({0})^2)",_e,Ae));break;case"cos":ee=e.parse(z("({1})/(({1})^2+({0})^2)",_e,Ae));break;case"sinh":ee=e.parse(z("({0})/(({1})^2-({0})^2)",_e,Ae));break;case"cosh":ee=e.parse(z("({1})/(({1})^2-({0})^2)",_e,Ae));break}}else{let _e=n.Settings.integration_depth<n.Settings.Laplace_integration_depth,He;_e&&(He=n.Settings.integration_depth,n.Settings.integration_depth=n.Settings.Laplace_integration_depth),n.Utils.block("PARSE2NUMBER",()=>{let xe=ye,Y=ue.sub(ye,xe),l=e.parse(`e^(-${Ae}*${xe})*${Y}`);if(ee=n.Calculus.integrate(l,xe),ee.hasIntegral()){ee=e.symfunction("laplace",[ue,ye,Ae]);return}ee=ee.sub(ye,0),ee=e.expand(e.multiply(ee,new $(-1))),ee=ee.sub(xe,ye)},!1),ee=n.Utils.block("PARSE2NUMBER",()=>e.parse(ee),!0),_e&&(n.Settings.integration_depth=He)}}return e.multiply(ee,Le)},inverse(ue,ye,Ae){let ee=ue.clone();return n.Utils.block("POSITIVE_MULTIPLIERS",()=>{let Le;if(ue.group===pt&&(ue=n.Algebra.PartFrac.partfrac(e.expand(ue),ye)),ue.group===le||ue.group===pt||ue.isComposite()){let Xe,Fe,_e,He,xe,Y,l,S,o=ue.multiplier.clone();ue.toUnitMultiplier();let w=ue.getNum(),y=ue.getDenom().toUnitMultiplier();y.group===u||y.group===se?(Fe=y.power.clone(),y.toLinear()):Fe=new n.Frac(1);let E=ye.toString(),O=n.Utils.decompose_fn(y,E,!0),G=n.Utils.decompose_fn(e.expand(w.clone()),E,!0);w.multiplier=w.multiplier.multiply(o);let b=function(){Le=e.multiply(Le,w),Le.multiplier=Le.multiplier.multiply(ue.multiplier),Le=e.divide(Le,O.a)};if((y.group===le||y.group===pt)&&O.x.value===E&&O.b.equals(0)&&n.Utils.isInt(O.x.power))Xe=O.x.power-1,S=n.Math2.factorial(Xe),Le=e.divide(e.pow(Ae,new $(Xe)),new $(S)),b();else if(y.group===u&&Fe.equals(1)){if(O.x.group===n.groups.PL&&n.Algebra.degree(y).equals(2)){let L=n.Algebra.sqComplete(y,E),B=n.Utils.getU(y);_e=n.Utils.decompose_fn(L.a,E,!0).b;let J=ze.LaPlace.inverse(e.parse(`1/((${B})^2+(${L.c}))`),B,Ae);Le=e.multiply(J,e.parse(`(${o})*e^(-(${_e})*(${Ae}))`))}else if(O.x.isLinear()&&!w.contains(E))Ae=e.divide(Ae,O.a.clone()),Xe=Fe-1,S=Xe===0||Xe===1?"1":`(${Fe}-1)!`,Le=e.parse(z("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",Ae,O.a,O.b,Fe,S)),b();else if(O.x.group===le&&O.x.power.equals(2))if(w.contains(E)){if(_e=new $(1),w.group===pt){let ae=new $(1);w.each(Re=>{Re.contains(E)?ae=e.multiply(ae,Re):_e=e.multiply(_e,Re)}),w=ae}l=n.Utils.decompose_fn(w,E,!0);let L=l.a,B=l.b,J=L.containsFunction("sin"),ce=L.containsFunction("cos"),pe=B.containsFunction("cos"),Oe=B.containsFunction("sin");if(l.x.value===E&&l.x.isLinear()&&!(J&&pe||ce||Oe))Le=e.parse(z("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",Ae,l.a,O.a,O.b));else if(J&&pe){let ae=L.findFunction("sin"),Re=B.findFunction("cos");if(ae.args[0].equals(Re.args[0])&&!ae.args[0].contains(E)){He=e.divide(B,Re.toUnitMultiplier()).toString();let We=ae.args[0].toString();xe=O.b;let Ie=e.divide(L,ae.toUnitMultiplier());Y="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",Le=e.parse(z(Y,Ae,_e,He,We,xe,Ie))}}}else Le=e.parse(z("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",Ae,w,O.a,O.b))}else if(O.x.power.num&&O.x.power.num.equals(3)&&O.x.power.den.equals(2)&&w.contains("sqrt(pi)")&&!w.contains(E)&&w.isLinear())He=e.divide(w.clone(),e.parse("sqrt(pi)")),Le=e.parse(z("(2*({2})*sqrt({0}))/({1})",Ae,O.a,He,w));else if(Fe.equals(2)&&O.x.power.equals(2))if(w.contains(E))if(l=n.Utils.decompose_fn(e.expand(w.clone()),E,!0),l.x.isComposite()){let L=[],B=w.collectSymbols(J=>{J=$.unwrapPARENS(J);let ce=n.Utils.decompose_fn(J,E,!0);return ce.symbol=J,ce}).sort((J,ce)=>{let pe=J.x.value===E?J.x.power:0;return(ce.x.value===E?ce.x.power:0)-pe});_e=new $(-1);for(let J=0;J<B.length;J++){let ce=B[J];ce.x.value===E?L.push(ce):_e=e.multiply(_e,ce.symbol)}L[0].x.power.equals(2)&&L[1].x.power.equals(1)&&L[1].b.equals(0)&&!L[0].b.equals(0)&&(He=L[0].a.negate(),Y="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",Le=e.parse(z(Y,Ae,_e,He,L[0].b,O.a,O.b)))}else l.x.isLinear()?(_e=e.divide(l.a,new $(2)),Y="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",Le=e.parse(z(Y,Ae,_e,O.a,O.b))):l.x.power.equals(2)&&(l.b.equals(0)?(_e=e.divide(l.a,new $(2)),Y="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Le=e.parse(z(Y,Ae,_e,O.a,O.b))):(_e=e.divide(l.a,new $(2)),xe=l.b.negate(),Y="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Le=e.parse(z(Y,Ae,_e,O.a,O.b,xe))));else _e=e.divide(w,new $(2)),Y="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",Le=e.parse(z(Y,Ae,_e,O.a,O.b));else ue.isComposite()&&(Fe.equals(2)&&O.x.group===le?Le=e.parse(`(${o})*(${Ae})*e^(-(${O.b})*(${Ae}))`):(Le=new $(0),ue=n.Algebra.PartFrac.partfrac(e.expand(ue),ye),ue.each(L=>{Le=e.add(Le,ze.LaPlace.inverse(L,ye,Ae))},!0)))}return Le||=e.symfunction("ilt",[ee,ye,Ae]),Le},!0)}},Statistics:{frequencyMap(ue){let ye={};for(let Ae=0,ee=ue.length;Ae<ee;Ae++){let Xe=ue[Ae].toString();ye[Xe]||=0,ye[Xe]++}return ye},sort(ue){return ue.sort((ye,Ae)=>((!ye.isConstant()||!Ae.isConstant())&&e.error("Unable to sort! All values must be numeric"),ye.multiplier.subtract(Ae.multiplier)))},count(ue){return new $(ue.length)},sum(ue,ye){let Ae=new $(0);for(let ee=0,Le=ue.length;ee<Le;ee++){let Xe=ue[ee].clone();ye?Ae=e.add(e.pow(e.subtract(Xe,ye.clone()),new $(2)),Ae):Ae=e.add(Xe,Ae)}return Ae},mean(...ue){return me(ue[0])?ze.Statistics.mean(...ue[0].elements):e.divide(ze.Statistics.sum(ue),ze.Statistics.count(ue))},median(...ue){let ye;if(me(ue[0]))return ze.Statistics.median(...ue[0].elements);try{let Ae=ze.Statistics.sort(ue),ee=ue.length;if(n.Utils.even(ee)){let Le=ee/2;ye=ze.Statistics.mean(Ae[Le-1],Ae[Le])}else ye=Ae[Math.floor(ee/2)]}catch(Ae){if(Ae.message==="timeout")throw Ae;ye=e.symfunction("median",ue)}return ye},mode(...ue){let ye;if(me(ue[0]))return ze.Statistics.mode(...ue[0].elements);let Ae=ze.Statistics.frequencyMap(ue);if(n.Utils.keys(Ae).length===1)ye=ue[0];else{let ee={};for(let Xe in Ae){if(!Object.hasOwn(Ae,Xe))continue;let Fe=Ae[Xe];if(Fe in ee){let _e=ee[Fe];we(_e)?_e.push(Xe):ee[Fe]=[Xe,ee[Fe]]}else ee[Fe]=Xe}let Le=ee[Math.max.apply(null,n.Utils.keys(ee))];we(Le)?ye=e.symfunction("mode",Le.sort()):ye=e.parse(Le)}return ye},gVariance(ue,ye){let Ae=ze.Statistics.mean(...ye),ee=ze.Statistics.sum(ye,Ae);return e.multiply(ue,ee)},variance(...ue){if(me(ue[0]))return ze.Statistics.variance(...ue[0].elements);let ye=e.divide(new $(1),ze.Statistics.count(ue));return ze.Statistics.gVariance(ye,ue)},sampleVariance(...ue){if(me(ue[0]))return ze.Statistics.sampleVariance(...ue[0].elements);let ye=e.divide(new $(1),e.subtract(ze.Statistics.count(ue),new $(1)));return ze.Statistics.gVariance(ye,ue)},standardDeviation(...ue){return me(ue[0])?ze.Statistics.standardDeviation(...ue[0].elements):e.pow(ze.Statistics.variance(...ue),new $(1/2))},sampleStandardDeviation(...ue){return me(ue[0])?ze.Statistics.sampleStandardDeviation(...ue[0].elements):e.pow(ze.Statistics.sampleVariance(...ue),new $(1/2))},zScore(ue,ye,Ae){return e.divide(e.subtract(ue,ye),Ae)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};Y0.register([{name:"laplace",visible:!0,numargs:3,build(){return ze.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return ze.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return ze.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return ze.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return ze.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return ze.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return ze.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return ze.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return ze.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return ze.Statistics.zScore}}]),Y0.updateAPI()})();typeof f1<"u"&&(f1.exports=Y0)});var Pi=g0((Zi,wn)=>{var Di=k0();Q0();W0();mn();dn();wn.exports=Di});return Pi();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
