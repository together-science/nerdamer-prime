"use strict";var nerdamer=(()=>{var f0=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var qn=f0((zi,H0)=>{var kt=(function(s){"use strict";var t=1e7,e=7,o=9007199254740992,h=we(o),y="0123456789abcdefghijklmnopqrstuvwxyz",L=typeof BigInt=="function";function C(g,p,P,d){return typeof g>"u"?C[0]:typeof p<"u"?+p==10&&!P?O(g):rt(g,p,P,d):O(g)}function D(g,p){this.value=g,this.sign=p,this.isSmall=!1}D.prototype=Object.create(C.prototype);function G(g){this.value=g,this.sign=g<0,this.isSmall=!0}G.prototype=Object.create(C.prototype);function V(g){this.value=g}V.prototype=Object.create(C.prototype);function B(g){return-o<g&&g<o}function we(g){return g<1e7?[g]:g<1e14?[g%1e7,Math.floor(g/1e7)]:[g%1e7,Math.floor(g/1e7)%1e7,Math.floor(g/1e14)]}function Ee(g){Me(g);var p=g.length;if(p<4&&_(g,h)<0)switch(p){case 0:return 0;case 1:return g[0];case 2:return g[0]+g[1]*t;default:return g[0]+(g[1]+g[2]*t)*t}return g}function Me(g){for(var p=g.length;g[--p]===0;);g.length=p+1}function ce(g){for(var p=new Array(g),P=-1;++P<g;)p[P]=0;return p}function pe(g){return g>0?Math.floor(g):Math.ceil(g)}function fe(g,p){var P=g.length,d=p.length,x=new Array(P),X=0,W=t,Q,ee;for(ee=0;ee<d;ee++)Q=g[ee]+p[ee]+X,X=Q>=W?1:0,x[ee]=Q-X*W;for(;ee<P;)Q=g[ee]+X,X=Q===W?1:0,x[ee++]=Q-X*W;return X>0&&x.push(X),x}function u(g,p){return g.length>=p.length?fe(g,p):fe(p,g)}function Ne(g,p){var P=g.length,d=new Array(P),x=t,X,W;for(W=0;W<P;W++)X=g[W]-x+p,p=Math.floor(X/x),d[W]=X-p*x,p+=1;for(;p>0;)d[W++]=p%x,p=Math.floor(p/x);return d}D.prototype.add=function(g){var p=O(g);if(this.sign!==p.sign)return this.subtract(p.negate());var P=this.value,d=p.value;return p.isSmall?new D(Ne(P,Math.abs(d)),this.sign):new D(u(P,d),this.sign)},D.prototype.plus=D.prototype.add,G.prototype.add=function(g){var p=O(g),P=this.value;if(P<0!==p.sign)return this.subtract(p.negate());var d=p.value;if(p.isSmall){if(B(P+d))return new G(P+d);d=we(Math.abs(d))}return new D(Ne(d,Math.abs(P)),P<0)},G.prototype.plus=G.prototype.add,V.prototype.add=function(g){return new V(this.value+O(g).value)},V.prototype.plus=V.prototype.add;function _e(g,p){var P=g.length,d=p.length,x=new Array(P),X=0,W=t,Q,ee;for(Q=0;Q<d;Q++)ee=g[Q]-X-p[Q],ee<0?(ee+=W,X=1):X=0,x[Q]=ee;for(Q=d;Q<P;Q++){if(ee=g[Q]-X,ee<0)ee+=W;else{x[Q++]=ee;break}x[Q]=ee}for(;Q<P;Q++)x[Q]=g[Q];return Me(x),x}function xe(g,p,P){var d;return _(g,p)>=0?d=_e(g,p):(d=_e(p,g),P=!P),d=Ee(d),typeof d=="number"?(P&&(d=-d),new G(d)):new D(d,P)}function ye(g,p,P){var d=g.length,x=new Array(d),X=-p,W=t,Q,ee;for(Q=0;Q<d;Q++)ee=g[Q]+X,X=Math.floor(ee/W),ee%=W,x[Q]=ee<0?ee+W:ee;return x=Ee(x),typeof x=="number"?(P&&(x=-x),new G(x)):new D(x,P)}D.prototype.subtract=function(g){var p=O(g);if(this.sign!==p.sign)return this.add(p.negate());var P=this.value,d=p.value;return p.isSmall?ye(P,Math.abs(d),this.sign):xe(P,d,this.sign)},D.prototype.minus=D.prototype.subtract,G.prototype.subtract=function(g){var p=O(g),P=this.value;if(P<0!==p.sign)return this.add(p.negate());var d=p.value;return p.isSmall?new G(P-d):ye(d,Math.abs(P),P>=0)},G.prototype.minus=G.prototype.subtract,V.prototype.subtract=function(g){return new V(this.value-O(g).value)},V.prototype.minus=V.prototype.subtract,D.prototype.negate=function(){return new D(this.value,!this.sign)},G.prototype.negate=function(){var g=this.sign,p=new G(-this.value);return p.sign=!g,p},V.prototype.negate=function(){return new V(-this.value)},D.prototype.abs=function(){return new D(this.value,!1)},G.prototype.abs=function(){return new G(Math.abs(this.value))},V.prototype.abs=function(){return new V(this.value>=0?this.value:-this.value)};function $e(g,p){var P=g.length,d=p.length,x=P+d,X=ce(x),W=t,Q,ee,re,Y,se;for(re=0;re<P;++re){Y=g[re];for(var me=0;me<d;++me)se=p[me],Q=Y*se+X[re+me],ee=Math.floor(Q/W),X[re+me]=Q-ee*W,X[re+me+1]+=ee}return Me(X),X}function ge(g,p){var P=g.length,d=new Array(P),x=t,X=0,W,Q;for(Q=0;Q<P;Q++)W=g[Q]*p+X,X=Math.floor(W/x),d[Q]=W-X*x;for(;X>0;)d[Q++]=X%x,X=Math.floor(X/x);return d}function ve(g,p){for(var P=[];p-- >0;)P.push(0);return P.concat(g)}function Ie(g,p){var P=Math.max(g.length,p.length);if(P<=30)return $e(g,p);P=Math.ceil(P/2);var d=g.slice(P),x=g.slice(0,P),X=p.slice(P),W=p.slice(0,P),Q=Ie(x,W),ee=Ie(d,X),re=Ie(u(x,d),u(W,X)),Y=u(u(Q,ve(_e(_e(re,Q),ee),P)),ve(ee,2*P));return Me(Y),Y}function le(g,p){return-.012*g-.012*p+15e-6*g*p>0}D.prototype.multiply=function(g){var p=O(g),P=this.value,d=p.value,x=this.sign!==p.sign,X;if(p.isSmall){if(d===0)return C[0];if(d===1)return this;if(d===-1)return this.negate();if(X=Math.abs(d),X<t)return new D(ge(P,X),x);d=we(X)}return le(P.length,d.length)?new D(Ie(P,d),x):new D($e(P,d),x)},D.prototype.times=D.prototype.multiply;function i(g,p,P){return g<t?new D(ge(p,g),P):new D($e(p,we(g)),P)}G.prototype._multiplyBySmall=function(g){return B(g.value*this.value)?new G(g.value*this.value):i(Math.abs(g.value),we(Math.abs(this.value)),this.sign!==g.sign)},D.prototype._multiplyBySmall=function(g){return g.value===0?C[0]:g.value===1?this:g.value===-1?this.negate():i(Math.abs(g.value),this.value,this.sign!==g.sign)},G.prototype.multiply=function(g){return O(g)._multiplyBySmall(this)},G.prototype.times=G.prototype.multiply,V.prototype.multiply=function(g){return new V(this.value*O(g).value)},V.prototype.times=V.prototype.multiply;function a(g){var p=g.length,P=ce(p+p),d=t,x,X,W,Q,ee;for(W=0;W<p;W++){Q=g[W],X=0-Q*Q;for(var re=W;re<p;re++)ee=g[re],x=2*(Q*ee)+P[W+re]+X,X=Math.floor(x/d),P[W+re]=x-X*d;P[W+p]=X}return Me(P),P}D.prototype.square=function(){return new D(a(this.value),!1)},G.prototype.square=function(){var g=this.value*this.value;return B(g)?new G(g):new D(a(we(Math.abs(this.value))),!1)},V.prototype.square=function(g){return new V(this.value*this.value)};function c(g,p){var P=g.length,d=p.length,x=t,X=ce(p.length),W=p[d-1],Q=Math.ceil(x/(2*W)),ee=ge(g,Q),re=ge(p,Q),Y,se,me,De,Te,je,Ze;for(ee.length<=P&&ee.push(0),re.push(0),W=re[d-1],se=P-d;se>=0;se--){for(Y=x-1,ee[se+d]!==W&&(Y=Math.floor((ee[se+d]*x+ee[se+d-1])/W)),me=0,De=0,je=re.length,Te=0;Te<je;Te++)me+=Y*re[Te],Ze=Math.floor(me/x),De+=ee[se+Te]-(me-Ze*x),me=Ze,De<0?(ee[se+Te]=De+x,De=-1):(ee[se+Te]=De,De=0);for(;De!==0;){for(Y-=1,me=0,Te=0;Te<je;Te++)me+=ee[se+Te]-x+re[Te],me<0?(ee[se+Te]=me+x,me=0):(ee[se+Te]=me,me=1);De+=me}X[se]=Y}return ee=w(ee,Q)[0],[Ee(X),Ee(ee)]}function S(g,p){for(var P=g.length,d=p.length,x=[],X=[],W=t,Q,ee,re,Y,se;P;){if(X.unshift(g[--P]),Me(X),_(X,p)<0){x.push(0);continue}ee=X.length,re=X[ee-1]*W+X[ee-2],Y=p[d-1]*W+p[d-2],ee>d&&(re=(re+1)*W),Q=Math.ceil(re/Y);do{if(se=ge(p,Q),_(se,X)<=0)break;Q--}while(Q);x.push(Q),X=_e(X,se)}return x.reverse(),[Ee(x),Ee(X)]}function w(g,p){var P=g.length,d=ce(P),x=t,X,W,Q,ee;for(Q=0,X=P-1;X>=0;--X)ee=Q*x+g[X],W=pe(ee/p),Q=ee-W*p,d[X]=W|0;return[d,Q|0]}function N(g,p){var P,d=O(p);if(L)return[new V(g.value/d.value),new V(g.value%d.value)];var x=g.value,X=d.value,W;if(X===0)throw new Error("Cannot divide by zero");if(g.isSmall)return d.isSmall?[new G(pe(x/X)),new G(x%X)]:[C[0],g];if(d.isSmall){if(X===1)return[g,C[0]];if(X==-1)return[g.negate(),C[0]];var Q=Math.abs(X);if(Q<t){P=w(x,Q),W=Ee(P[0]);var ee=P[1];return g.sign&&(ee=-ee),typeof W=="number"?(g.sign!==d.sign&&(W=-W),[new G(W),new G(ee)]):[new D(W,g.sign!==d.sign),new G(ee)]}X=we(Q)}var re=_(x,X);if(re===-1)return[C[0],g];if(re===0)return[C[g.sign===d.sign?1:-1],C[0]];x.length+X.length<=200?P=c(x,X):P=S(x,X),W=P[0];var Y=g.sign!==d.sign,se=P[1],me=g.sign;return typeof W=="number"?(Y&&(W=-W),W=new G(W)):W=new D(W,Y),typeof se=="number"?(me&&(se=-se),se=new G(se)):se=new D(se,me),[W,se]}D.prototype.divmod=function(g){var p=N(this,g);return{quotient:p[0],remainder:p[1]}},V.prototype.divmod=G.prototype.divmod=D.prototype.divmod,D.prototype.divide=function(g){return N(this,g)[0]},V.prototype.over=V.prototype.divide=function(g){return new V(this.value/O(g).value)},G.prototype.over=G.prototype.divide=D.prototype.over=D.prototype.divide,D.prototype.mod=function(g){return N(this,g)[1]},V.prototype.mod=V.prototype.remainder=function(g){return new V(this.value%O(g).value)},G.prototype.remainder=G.prototype.mod=D.prototype.remainder=D.prototype.mod,D.prototype.pow=function(g){var p=O(g),P=this.value,d=p.value,x,X,W;if(d===0)return C[1];if(P===0)return C[0];if(P===1)return C[1];if(P===-1)return p.isEven()?C[1]:C[-1];if(p.sign)return C[0];if(!p.isSmall)throw new Error("The exponent "+p.toString()+" is too large.");if(this.isSmall&&B(x=Math.pow(P,d)))return new G(pe(x));for(X=this,W=C[1];d&!0&&(W=W.times(X),--d),d!==0;)d/=2,X=X.square();return W},G.prototype.pow=D.prototype.pow,V.prototype.pow=function(g){var p=O(g),P=this.value,d=p.value,x=BigInt(0),X=BigInt(1),W=BigInt(2);if(d===x)return C[1];if(P===x)return C[0];if(P===X)return C[1];if(P===BigInt(-1))return p.isEven()?C[1]:C[-1];if(p.isNegative())return new V(x);for(var Q=this,ee=C[1];(d&X)===X&&(ee=ee.times(Q),--d),d!==x;)d/=W,Q=Q.square();return ee},D.prototype.modPow=function(g,p){if(g=O(g),p=O(p),p.isZero())throw new Error("Cannot take modPow with modulus 0");var P=C[1],d=this.mod(p);for(g.isNegative()&&(g=g.multiply(C[-1]),d=d.modInv(p));g.isPositive();){if(d.isZero())return C[0];g.isOdd()&&(P=P.multiply(d).mod(p)),g=g.divide(2),d=d.square().mod(p)}return P},V.prototype.modPow=G.prototype.modPow=D.prototype.modPow;function _(g,p){if(g.length!==p.length)return g.length>p.length?1:-1;for(var P=g.length-1;P>=0;P--)if(g[P]!==p[P])return g[P]>p[P]?1:-1;return 0}D.prototype.compareAbs=function(g){var p=O(g),P=this.value,d=p.value;return p.isSmall?1:_(P,d)},G.prototype.compareAbs=function(g){var p=O(g),P=Math.abs(this.value),d=p.value;return p.isSmall?(d=Math.abs(d),P===d?0:P>d?1:-1):-1},V.prototype.compareAbs=function(g){var p=this.value,P=O(g).value;return p=p>=0?p:-p,P=P>=0?P:-P,p===P?0:p>P?1:-1},D.prototype.compare=function(g){if(g===1/0)return-1;if(g===-1/0)return 1;var p=O(g),P=this.value,d=p.value;return this.sign!==p.sign?p.sign?1:-1:p.isSmall?this.sign?-1:1:_(P,d)*(this.sign?-1:1)},D.prototype.compareTo=D.prototype.compare,G.prototype.compare=function(g){if(g===1/0)return-1;if(g===-1/0)return 1;var p=O(g),P=this.value,d=p.value;return p.isSmall?P==d?0:P>d?1:-1:P<0!==p.sign?P<0?-1:1:P<0?1:-1},G.prototype.compareTo=G.prototype.compare,V.prototype.compare=function(g){if(g===1/0)return-1;if(g===-1/0)return 1;var p=this.value,P=O(g).value;return p===P?0:p>P?1:-1},V.prototype.compareTo=V.prototype.compare,D.prototype.equals=function(g){return this.compare(g)===0},V.prototype.eq=V.prototype.equals=G.prototype.eq=G.prototype.equals=D.prototype.eq=D.prototype.equals,D.prototype.notEquals=function(g){return this.compare(g)!==0},V.prototype.neq=V.prototype.notEquals=G.prototype.neq=G.prototype.notEquals=D.prototype.neq=D.prototype.notEquals,D.prototype.greater=function(g){return this.compare(g)>0},V.prototype.gt=V.prototype.greater=G.prototype.gt=G.prototype.greater=D.prototype.gt=D.prototype.greater,D.prototype.lesser=function(g){return this.compare(g)<0},V.prototype.lt=V.prototype.lesser=G.prototype.lt=G.prototype.lesser=D.prototype.lt=D.prototype.lesser,D.prototype.greaterOrEquals=function(g){return this.compare(g)>=0},V.prototype.geq=V.prototype.greaterOrEquals=G.prototype.geq=G.prototype.greaterOrEquals=D.prototype.geq=D.prototype.greaterOrEquals,D.prototype.lesserOrEquals=function(g){return this.compare(g)<=0},V.prototype.leq=V.prototype.lesserOrEquals=G.prototype.leq=G.prototype.lesserOrEquals=D.prototype.leq=D.prototype.lesserOrEquals,D.prototype.isEven=function(){return(this.value[0]&1)===0},G.prototype.isEven=function(){return(this.value&1)===0},V.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},D.prototype.isOdd=function(){return(this.value[0]&1)===1},G.prototype.isOdd=function(){return(this.value&1)===1},V.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},D.prototype.isPositive=function(){return!this.sign},G.prototype.isPositive=function(){return this.value>0},V.prototype.isPositive=G.prototype.isPositive,D.prototype.isNegative=function(){return this.sign},G.prototype.isNegative=function(){return this.value<0},V.prototype.isNegative=G.prototype.isNegative,D.prototype.isUnit=function(){return!1},G.prototype.isUnit=function(){return Math.abs(this.value)===1},V.prototype.isUnit=function(){return this.abs().value===BigInt(1)},D.prototype.isZero=function(){return!1},G.prototype.isZero=function(){return this.value===0},V.prototype.isZero=function(){return this.value===BigInt(0)},D.prototype.isDivisibleBy=function(g){var p=O(g);return p.isZero()?!1:p.isUnit()?!0:p.compareAbs(2)===0?this.isEven():this.mod(p).isZero()},V.prototype.isDivisibleBy=G.prototype.isDivisibleBy=D.prototype.isDivisibleBy;function R(g){var p=g.abs();if(p.isUnit())return!1;if(p.equals(2)||p.equals(3)||p.equals(5))return!0;if(p.isEven()||p.isDivisibleBy(3)||p.isDivisibleBy(5))return!1;if(p.lesser(49))return!0}function U(g,p){for(var P=g.prev(),d=P,x=0,X,W,Q,ee;d.isEven();)d=d.divide(2),x++;e:for(Q=0;Q<p.length;Q++)if(!g.lesser(p[Q])&&(ee=kt(p[Q]).modPow(d,g),!(ee.isUnit()||ee.equals(P)))){for(X=x-1;X!=0;X--){if(ee=ee.square().mod(g),ee.isUnit())return!1;if(ee.equals(P))continue e}return!1}return!0}D.prototype.isPrime=function(g){var p=R(this);if(p!==s)return p;var P=this.abs(),d=P.bitLength();if(d<=64)return U(P,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var x=Math.log(2)*d.toJSNumber(),X=Math.ceil(g===!0?2*Math.pow(x,2):x),W=[],Q=0;Q<X;Q++)W.push(kt(Q+2));return U(P,W)},V.prototype.isPrime=G.prototype.isPrime=D.prototype.isPrime,D.prototype.isProbablePrime=function(g,p){var P=R(this);if(P!==s)return P;for(var d=this.abs(),x=g===s?5:g,X=[],W=0;W<x;W++)X.push(kt.randBetween(2,d.minus(2),p));return U(d,X)},V.prototype.isProbablePrime=G.prototype.isProbablePrime=D.prototype.isProbablePrime,D.prototype.modInv=function(g){for(var p=kt.zero,P=kt.one,d=O(g),x=this.abs(),X,W,Q;!x.isZero();)X=d.divide(x),W=p,Q=d,p=P,d=x,P=W.subtract(X.multiply(P)),x=Q.subtract(X.multiply(x));if(!d.isUnit())throw new Error(this.toString()+" and "+g.toString()+" are not co-prime");return p.compare(0)===-1&&(p=p.add(g)),this.isNegative()?p.negate():p},V.prototype.modInv=G.prototype.modInv=D.prototype.modInv,D.prototype.next=function(){var g=this.value;return this.sign?ye(g,1,this.sign):new D(Ne(g,1),this.sign)},G.prototype.next=function(){var g=this.value;return g+1<o?new G(g+1):new D(h,!1)},V.prototype.next=function(){return new V(this.value+BigInt(1))},D.prototype.prev=function(){var g=this.value;return this.sign?new D(Ne(g,1),!0):ye(g,1,this.sign)},G.prototype.prev=function(){var g=this.value;return g-1>-o?new G(g-1):new D(h,!0)},V.prototype.prev=function(){return new V(this.value-BigInt(1))};for(var F=[1];2*F[F.length-1]<=t;)F.push(2*F[F.length-1]);var ie=F.length,oe=F[ie-1];function Se(g){return Math.abs(g)<=t}D.prototype.shiftLeft=function(g){var p=O(g).toJSNumber();if(!Se(p))throw new Error(String(p)+" is too large for shifting.");if(p<0)return this.shiftRight(-p);var P=this;if(P.isZero())return P;for(;p>=ie;)P=P.multiply(oe),p-=ie-1;return P.multiply(F[p])},V.prototype.shiftLeft=G.prototype.shiftLeft=D.prototype.shiftLeft,D.prototype.shiftRight=function(g){var p,P=O(g).toJSNumber();if(!Se(P))throw new Error(String(P)+" is too large for shifting.");if(P<0)return this.shiftLeft(-P);for(var d=this;P>=ie;){if(d.isZero()||d.isNegative()&&d.isUnit())return d;p=N(d,oe),d=p[1].isNegative()?p[0].prev():p[0],P-=ie-1}return p=N(d,F[P]),p[1].isNegative()?p[0].prev():p[0]},V.prototype.shiftRight=G.prototype.shiftRight=D.prototype.shiftRight;function he(g,p,P){p=O(p);for(var d=g.isNegative(),x=p.isNegative(),X=d?g.not():g,W=x?p.not():p,Q=0,ee=0,re=null,Y=null,se=[];!X.isZero()||!W.isZero();)re=N(X,oe),Q=re[1].toJSNumber(),d&&(Q=oe-1-Q),Y=N(W,oe),ee=Y[1].toJSNumber(),x&&(ee=oe-1-ee),X=re[0],W=Y[0],se.push(P(Q,ee));for(var me=P(d?1:0,x?1:0)!==0?kt(-1):kt(0),De=se.length-1;De>=0;De-=1)me=me.multiply(oe).add(kt(se[De]));return me}D.prototype.not=function(){return this.negate().prev()},V.prototype.not=G.prototype.not=D.prototype.not,D.prototype.and=function(g){return he(this,g,function(p,P){return p&P})},V.prototype.and=G.prototype.and=D.prototype.and,D.prototype.or=function(g){return he(this,g,function(p,P){return p|P})},V.prototype.or=G.prototype.or=D.prototype.or,D.prototype.xor=function(g){return he(this,g,function(p,P){return p^P})},V.prototype.xor=G.prototype.xor=D.prototype.xor;var Ce=1<<30,Ae=(t&-t)*(t&-t)|Ce;function de(g){var p=g.value,P=typeof p=="number"?p|Ce:typeof p=="bigint"?p|BigInt(Ce):p[0]+p[1]*t|Ae;return P&-P}function Le(g,p){if(p.compareTo(g)<=0){var P=Le(g,p.square(p)),d=P.p,x=P.e,X=d.multiply(p);return X.compareTo(g)<=0?{p:X,e:x*2+1}:{p:d,e:x*2}}return{p:kt(1),e:0}}D.prototype.bitLength=function(){var g=this;return g.compareTo(kt(0))<0&&(g=g.negate().subtract(kt(1))),g.compareTo(kt(0))===0?kt(0):kt(Le(g,kt(2)).e).add(kt(1))},V.prototype.bitLength=G.prototype.bitLength=D.prototype.bitLength;function Pe(g,p){return g=O(g),p=O(p),g.greater(p)?g:p}function Ge(g,p){return g=O(g),p=O(p),g.lesser(p)?g:p}function We(g,p){if(g=O(g).abs(),p=O(p).abs(),g.equals(p))return g;if(g.isZero())return p;if(p.isZero())return g;for(var P=C[1],d,x;g.isEven()&&p.isEven();)d=Ge(de(g),de(p)),g=g.divide(d),p=p.divide(d),P=P.multiply(d);for(;g.isEven();)g=g.divide(de(g));do{for(;p.isEven();)p=p.divide(de(p));g.greater(p)&&(x=p,p=g,g=x),p=p.subtract(g)}while(!p.isZero());return P.isUnit()?g:g.multiply(P)}function He(g,p){return g=O(g).abs(),p=O(p).abs(),g.divide(We(g,p)).multiply(p)}function Qe(g,p,P){g=O(g),p=O(p);var d=P||Math.random,x=Ge(g,p),X=Pe(g,p),W=X.subtract(x).add(1);if(W.isSmall)return x.add(Math.floor(d()*W));for(var Q=Z(W,t).value,ee=[],re=!0,Y=0;Y<Q.length;Y++){var se=re?Q[Y]+(Y+1<Q.length?Q[Y+1]/t:0):t,me=pe(d()*se);ee.push(me),me<Q[Y]&&(re=!1)}return x.add(C.fromArray(ee,t,!1))}var rt=function(g,p,P,d){P=P||y,g=String(g),d||(g=g.toLowerCase(),P=P.toLowerCase());var x=g.length,X,W=Math.abs(p),Q={};for(X=0;X<P.length;X++)Q[P[X]]=X;for(X=0;X<x;X++){var ee=g[X];if(ee!=="-"&&ee in Q&&Q[ee]>=W){if(ee==="1"&&W===1)continue;throw new Error(ee+" is not a valid digit in base "+p+".")}}p=O(p);var re=[],Y=g[0]==="-";for(X=Y?1:0;X<g.length;X++){var ee=g[X];if(ee in Q)re.push(O(Q[ee]));else if(ee==="<"){var se=X;do X++;while(g[X]!==">"&&X<g.length);re.push(O(g.slice(se+1,X)))}else throw new Error(ee+" is not a valid character")}return Je(re,p,Y)};function Je(g,p,P){var d=C[0],x=C[1],X;for(X=g.length-1;X>=0;X--)d=d.add(g[X].times(x)),x=x.times(p);return P?d.negate():d}function J(g,p){return p=p||y,g<p.length?p[g]:"<"+g+">"}function Z(g,p){if(p=kt(p),p.isZero()){if(g.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(p.equals(-1)){if(g.isZero())return{value:[0],isNegative:!1};if(g.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-g.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var P=Array.apply(null,Array(g.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return P.unshift([1]),{value:[].concat.apply([],P),isNegative:!1}}var d=!1;if(g.isNegative()&&p.isPositive()&&(d=!0,g=g.abs()),p.isUnit())return g.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(g.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:d};for(var x=[],X=g,W;X.isNegative()||X.compareAbs(p)>=0;){W=X.divmod(p),X=W.quotient;var Q=W.remainder;Q.isNegative()&&(Q=p.minus(Q).abs(),X=X.next()),x.push(Q.toJSNumber())}return x.push(X.toJSNumber()),{value:x.reverse(),isNegative:d}}function j(g,p,P){var d=Z(g,p);return(d.isNegative?"-":"")+d.value.map(function(x){return J(x,P)}).join("")}D.prototype.toArray=function(g){return Z(this,g)},G.prototype.toArray=function(g){return Z(this,g)},V.prototype.toArray=function(g){return Z(this,g)},D.prototype.toString=function(g,p){if(g===s&&(g=10),g!==10||p)return j(this,g,p);for(var P=this.value,d=P.length,x=String(P[--d]),X="0000000",W;--d>=0;)W=String(P[d]),x+=X.slice(W.length)+W;var Q=this.sign?"-":"";return Q+x},G.prototype.toString=function(g,p){return g===s&&(g=10),g!=10||p?j(this,g,p):String(this.value)},V.prototype.toString=G.prototype.toString,V.prototype.toJSON=D.prototype.toJSON=G.prototype.toJSON=function(){return this.toString()},D.prototype.valueOf=function(){return parseInt(this.toString(),10)},D.prototype.toJSNumber=D.prototype.valueOf,G.prototype.valueOf=function(){return this.value},G.prototype.toJSNumber=G.prototype.valueOf,V.prototype.valueOf=V.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function k(g){if(B(+g)){var p=+g;if(p===pe(p))return L?new V(BigInt(p)):new G(p);throw new Error("Invalid integer: "+g)}var P=g[0]==="-";P&&(g=g.slice(1));var d=g.split(/e/i);if(d.length>2)throw new Error("Invalid integer: "+d.join("e"));if(d.length===2){var x=d[1];if(x[0]==="+"&&(x=x.slice(1)),x=+x,x!==pe(x)||!B(x))throw new Error("Invalid integer: "+x+" is not a valid exponent.");var X=d[0],W=X.indexOf(".");if(W>=0&&(x-=X.length-W-1,X=X.slice(0,W)+X.slice(W+1)),x<0)throw new Error("Cannot include negative exponent part for integers");X+=new Array(x+1).join("0"),g=X}var Q=/^([0-9][0-9]*)$/.test(g);if(!Q)throw new Error("Invalid integer: "+g);if(L)return new V(BigInt(P?"-"+g:g));for(var ee=[],re=g.length,Y=e,se=re-Y;re>0;)ee.push(+g.slice(se,re)),se-=Y,se<0&&(se=0),re-=Y;return Me(ee),new D(ee,P)}function K(g){if(L)return new V(BigInt(g));if(B(g)){if(g!==pe(g))throw new Error(g+" is not an integer.");return new G(g)}return k(g.toString())}function O(g){return typeof g=="number"?K(g):typeof g=="string"?k(g):typeof g=="bigint"?new V(g):g}for(var $=0;$<1e3;$++)C[$]=O($),$>0&&(C[-$]=O(-$));return C.one=C[1],C.zero=C[0],C.minusOne=C[-1],C.max=Pe,C.min=Ge,C.gcd=We,C.lcm=He,C.isInstance=function(g){return g instanceof D||g instanceof G||g instanceof V},C.randBetween=Qe,C.fromArray=function(g,p,P){return Je(g.map(O),O(p||10),P)},C})();typeof H0<"u"&&H0.hasOwnProperty("exports")&&(H0.exports=kt);typeof define=="function"&&define.amd&&define(function(){return kt})});var Rn=f0((Tn,j0)=>{(function(s){"use strict";var t=9e15,e=1e9,o="0123456789abcdef",h="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",y="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",L={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-t,maxE:t,crypto:!1},C,D,G,V,B=!0,we="[DecimalError] ",Ee=we+"Invalid argument: ",Me=we+"Precision limit exceeded",ce=we+"crypto unavailable",pe="[object Decimal]",fe=Math.floor,u=Math.pow,Ne=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,_e=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,xe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,ye=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$e=1e7,ge=7,ve=9007199254740991,Ie=h.length-1,le=y.length-1,i={toStringTag:pe};i.absoluteValue=i.abs=function(){var f=new this.constructor(this);return f.s<0&&(f.s=1),R(f)},i.ceil=function(){return R(new this.constructor(this),this.e+1,2)},i.clampedTo=i.clamp=function(f,E){var A,b=this,T=b.constructor;if(f=new T(f),E=new T(E),!f.s||!E.s)return new T(NaN);if(f.gt(E))throw Error(Ee+E);return A=b.cmp(f),A<0?f:b.cmp(E)>0?E:new T(b)},i.comparedTo=i.cmp=function(f){var E,A,b,T,n=this,r=n.d,l=(f=new n.constructor(f)).d,v=n.s,m=f.s;if(!r||!l)return!v||!m?NaN:v!==m?v:r===l?0:!r^v<0?1:-1;if(!r[0]||!l[0])return r[0]?v:l[0]?-m:0;if(v!==m)return v;if(n.e!==f.e)return n.e>f.e^v<0?1:-1;for(b=r.length,T=l.length,E=0,A=b<T?b:T;E<A;++E)if(r[E]!==l[E])return r[E]>l[E]^v<0?1:-1;return b===T?0:b>T^v<0?1:-1},i.cosine=i.cos=function(){var f,E,A=this,b=A.constructor;return A.d?A.d[0]?(f=b.precision,E=b.rounding,b.precision=f+Math.max(A.e,A.sd())+ge,b.rounding=1,A=N(b,J(b,A)),b.precision=f,b.rounding=E,R(V==2||V==3?A.neg():A,f,E,!0)):new b(1):new b(NaN)},i.cubeRoot=i.cbrt=function(){var f,E,A,b,T,n,r,l,v,m,q=this,M=q.constructor;if(!q.isFinite()||q.isZero())return new M(q);for(B=!1,n=q.s*u(q.s*q,1/3),!n||Math.abs(n)==1/0?(A=a(q.d),f=q.e,(n=(f-A.length+1)%3)&&(A+=n==1||n==-2?"0":"00"),n=u(A,1/3),f=fe((f+1)/3)-(f%3==(f<0?-1:2)),n==1/0?A="5e"+f:(A=n.toExponential(),A=A.slice(0,A.indexOf("e")+1)+f),b=new M(A),b.s=q.s):b=new M(n.toString()),r=(f=M.precision)+3;;)if(l=b,v=l.times(l).times(l),m=v.plus(q),b=_(m.plus(q).times(l),m.plus(v),r+2,1),a(l.d).slice(0,r)===(A=a(b.d)).slice(0,r))if(A=A.slice(r-3,r+1),A=="9999"||!T&&A=="4999"){if(!T&&(R(l,f+1,0),l.times(l).times(l).eq(q))){b=l;break}r+=4,T=1}else{(!+A||!+A.slice(1)&&A.charAt(0)=="5")&&(R(b,f+1,1),E=!b.times(b).times(b).eq(q));break}return B=!0,R(b,f,M.rounding,E)},i.decimalPlaces=i.dp=function(){var f,E=this.d,A=NaN;if(E){if(f=E.length-1,A=(f-fe(this.e/ge))*ge,f=E[f],f)for(;f%10==0;f/=10)A--;A<0&&(A=0)}return A},i.dividedBy=i.div=function(f){return _(this,new this.constructor(f))},i.dividedToIntegerBy=i.divToInt=function(f){var E=this,A=E.constructor;return R(_(E,new A(f),0,1,1),A.precision,A.rounding)},i.equals=i.eq=function(f){return this.cmp(f)===0},i.floor=function(){return R(new this.constructor(this),this.e+1,3)},i.greaterThan=i.gt=function(f){return this.cmp(f)>0},i.greaterThanOrEqualTo=i.gte=function(f){var E=this.cmp(f);return E==1||E===0},i.hyperbolicCosine=i.cosh=function(){var f,E,A,b,T,n=this,r=n.constructor,l=new r(1);if(!n.isFinite())return new r(n.s?1/0:NaN);if(n.isZero())return l;A=r.precision,b=r.rounding,r.precision=A+Math.max(n.e,n.sd())+4,r.rounding=1,T=n.d.length,T<32?(f=Math.ceil(T/3),E=(1/Je(4,f)).toString()):(f=16,E="2.3283064365386962890625e-10"),n=rt(r,1,n.times(E),new r(1),!0);for(var v,m=f,q=new r(8);m--;)v=n.times(n),n=l.minus(v.times(q.minus(v.times(q))));return R(n,r.precision=A,r.rounding=b,!0)},i.hyperbolicSine=i.sinh=function(){var f,E,A,b,T=this,n=T.constructor;if(!T.isFinite()||T.isZero())return new n(T);if(E=n.precision,A=n.rounding,n.precision=E+Math.max(T.e,T.sd())+4,n.rounding=1,b=T.d.length,b<3)T=rt(n,2,T,T,!0);else{f=1.4*Math.sqrt(b),f=f>16?16:f|0,T=T.times(1/Je(5,f)),T=rt(n,2,T,T,!0);for(var r,l=new n(5),v=new n(16),m=new n(20);f--;)r=T.times(T),T=T.times(l.plus(r.times(v.times(r).plus(m))))}return n.precision=E,n.rounding=A,R(T,E,A,!0)},i.hyperbolicTangent=i.tanh=function(){var f,E,A=this,b=A.constructor;return A.isFinite()?A.isZero()?new b(A):(f=b.precision,E=b.rounding,b.precision=f+7,b.rounding=1,_(A.sinh(),A.cosh(),b.precision=f,b.rounding=E)):new b(A.s)},i.inverseCosine=i.acos=function(){var f=this,E=f.constructor,A=f.abs().cmp(1),b=E.precision,T=E.rounding;return A!==-1?A===0?f.isNeg()?oe(E,b,T):new E(0):new E(NaN):f.isZero()?oe(E,b+4,T).times(.5):(E.precision=b+6,E.rounding=1,f=new E(1).minus(f).div(f.plus(1)).sqrt().atan(),E.precision=b,E.rounding=T,f.times(2))},i.inverseHyperbolicCosine=i.acosh=function(){var f,E,A=this,b=A.constructor;return A.lte(1)?new b(A.eq(1)?0:NaN):A.isFinite()?(f=b.precision,E=b.rounding,b.precision=f+Math.max(Math.abs(A.e),A.sd())+4,b.rounding=1,B=!1,A=A.times(A).minus(1).sqrt().plus(A),B=!0,b.precision=f,b.rounding=E,A.ln()):new b(A)},i.inverseHyperbolicSine=i.asinh=function(){var f,E,A=this,b=A.constructor;return!A.isFinite()||A.isZero()?new b(A):(f=b.precision,E=b.rounding,b.precision=f+2*Math.max(Math.abs(A.e),A.sd())+6,b.rounding=1,B=!1,A=A.times(A).plus(1).sqrt().plus(A),B=!0,b.precision=f,b.rounding=E,A.ln())},i.inverseHyperbolicTangent=i.atanh=function(){var f,E,A,b,T=this,n=T.constructor;return T.isFinite()?T.e>=0?new n(T.abs().eq(1)?T.s/0:T.isZero()?T:NaN):(f=n.precision,E=n.rounding,b=T.sd(),Math.max(b,f)<2*-T.e-1?R(new n(T),f,E,!0):(n.precision=A=b-T.e,T=_(T.plus(1),new n(1).minus(T),A+f,1),n.precision=f+4,n.rounding=1,T=T.ln(),n.precision=f,n.rounding=E,T.times(.5))):new n(NaN)},i.inverseSine=i.asin=function(){var f,E,A,b,T=this,n=T.constructor;return T.isZero()?new n(T):(E=T.abs().cmp(1),A=n.precision,b=n.rounding,E!==-1?E===0?(f=oe(n,A+4,b).times(.5),f.s=T.s,f):new n(NaN):(n.precision=A+6,n.rounding=1,T=T.div(new n(1).minus(T.times(T)).sqrt().plus(1)).atan(),n.precision=A,n.rounding=b,T.times(2)))},i.inverseTangent=i.atan=function(){var f,E,A,b,T,n,r,l,v,m=this,q=m.constructor,M=q.precision,I=q.rounding;if(m.isFinite()){if(m.isZero())return new q(m);if(m.abs().eq(1)&&M+4<=le)return r=oe(q,M+4,I).times(.25),r.s=m.s,r}else{if(!m.s)return new q(NaN);if(M+4<=le)return r=oe(q,M+4,I).times(.5),r.s=m.s,r}for(q.precision=l=M+10,q.rounding=1,A=Math.min(28,l/ge+2|0),f=A;f;--f)m=m.div(m.times(m).plus(1).sqrt().plus(1));for(B=!1,E=Math.ceil(l/ge),b=1,v=m.times(m),r=new q(m),T=m;f!==-1;)if(T=T.times(v),n=r.minus(T.div(b+=2)),T=T.times(v),r=n.plus(T.div(b+=2)),r.d[E]!==void 0)for(f=E;r.d[f]===n.d[f]&&f--;);return A&&(r=r.times(2<<A-1)),B=!0,R(r,q.precision=M,q.rounding=I,!0)},i.isFinite=function(){return!!this.d},i.isInteger=i.isInt=function(){return!!this.d&&fe(this.e/ge)>this.d.length-2},i.isNaN=function(){return!this.s},i.isNegative=i.isNeg=function(){return this.s<0},i.isPositive=i.isPos=function(){return this.s>0},i.isZero=function(){return!!this.d&&this.d[0]===0},i.lessThan=i.lt=function(f){return this.cmp(f)<0},i.lessThanOrEqualTo=i.lte=function(f){return this.cmp(f)<1},i.logarithm=i.log=function(f){var E,A,b,T,n,r,l,v,m=this,q=m.constructor,M=q.precision,I=q.rounding,H=5;if(f==null)f=new q(10),E=!0;else{if(f=new q(f),A=f.d,f.s<0||!A||!A[0]||f.eq(1))return new q(NaN);E=f.eq(10)}if(A=m.d,m.s<0||!A||!A[0]||m.eq(1))return new q(A&&!A[0]?-1/0:m.s!=1?NaN:A?0:1/0);if(E)if(A.length>1)n=!0;else{for(T=A[0];T%10===0;)T/=10;n=T!==1}if(B=!1,l=M+H,r=Pe(m,l),b=E?ie(q,l+10):Pe(f,l),v=_(r,b,l,1),S(v.d,T=M,I))do if(l+=10,r=Pe(m,l),b=E?ie(q,l+10):Pe(f,l),v=_(r,b,l,1),!n){+a(v.d).slice(T+1,T+15)+1==1e14&&(v=R(v,M+1,0));break}while(S(v.d,T+=10,I));return B=!0,R(v,M,I)},i.minus=i.sub=function(f){var E,A,b,T,n,r,l,v,m,q,M,I,H=this,ne=H.constructor;if(f=new ne(f),!H.d||!f.d)return!H.s||!f.s?f=new ne(NaN):H.d?f.s=-f.s:f=new ne(f.d||H.s!==f.s?H:NaN),f;if(H.s!=f.s)return f.s=-f.s,H.plus(f);if(m=H.d,I=f.d,l=ne.precision,v=ne.rounding,!m[0]||!I[0]){if(I[0])f.s=-f.s;else if(m[0])f=new ne(H);else return new ne(v===3?-0:0);return B?R(f,l,v):f}if(A=fe(f.e/ge),q=fe(H.e/ge),m=m.slice(),n=q-A,n){for(M=n<0,M?(E=m,n=-n,r=I.length):(E=I,A=q,r=m.length),b=Math.max(Math.ceil(l/ge),r)+2,n>b&&(n=b,E.length=1),E.reverse(),b=n;b--;)E.push(0);E.reverse()}else{for(b=m.length,r=I.length,M=b<r,M&&(r=b),b=0;b<r;b++)if(m[b]!=I[b]){M=m[b]<I[b];break}n=0}for(M&&(E=m,m=I,I=E,f.s=-f.s),r=m.length,b=I.length-r;b>0;--b)m[r++]=0;for(b=I.length;b>n;){if(m[--b]<I[b]){for(T=b;T&&m[--T]===0;)m[T]=$e-1;--m[T],m[b]+=$e}m[b]-=I[b]}for(;m[--r]===0;)m.pop();for(;m[0]===0;m.shift())--A;return m[0]?(f.d=m,f.e=F(m,A),B?R(f,l,v):f):new ne(v===3?-0:0)},i.modulo=i.mod=function(f){var E,A=this,b=A.constructor;return f=new b(f),!A.d||!f.s||f.d&&!f.d[0]?new b(NaN):!f.d||A.d&&!A.d[0]?R(new b(A),b.precision,b.rounding):(B=!1,b.modulo==9?(E=_(A,f.abs(),0,3,1),E.s*=f.s):E=_(A,f,0,b.modulo,1),E=E.times(f),B=!0,A.minus(E))},i.naturalExponential=i.exp=function(){return Le(this)},i.naturalLogarithm=i.ln=function(){return Pe(this)},i.negated=i.neg=function(){var f=new this.constructor(this);return f.s=-f.s,R(f)},i.plus=i.add=function(f){var E,A,b,T,n,r,l,v,m,q,M=this,I=M.constructor;if(f=new I(f),!M.d||!f.d)return!M.s||!f.s?f=new I(NaN):M.d||(f=new I(f.d||M.s===f.s?M:NaN)),f;if(M.s!=f.s)return f.s=-f.s,M.minus(f);if(m=M.d,q=f.d,l=I.precision,v=I.rounding,!m[0]||!q[0])return q[0]||(f=new I(M)),B?R(f,l,v):f;if(n=fe(M.e/ge),b=fe(f.e/ge),m=m.slice(),T=n-b,T){for(T<0?(A=m,T=-T,r=q.length):(A=q,b=n,r=m.length),n=Math.ceil(l/ge),r=n>r?n+1:r+1,T>r&&(T=r,A.length=1),A.reverse();T--;)A.push(0);A.reverse()}for(r=m.length,T=q.length,r-T<0&&(T=r,A=q,q=m,m=A),E=0;T;)E=(m[--T]=m[T]+q[T]+E)/$e|0,m[T]%=$e;for(E&&(m.unshift(E),++b),r=m.length;m[--r]==0;)m.pop();return f.d=m,f.e=F(m,b),B?R(f,l,v):f},i.precision=i.sd=function(f){var E,A=this;if(f!==void 0&&f!==!!f&&f!==1&&f!==0)throw Error(Ee+f);return A.d?(E=Se(A.d),f&&A.e+1>E&&(E=A.e+1)):E=NaN,E},i.round=function(){var f=this,E=f.constructor;return R(new E(f),f.e+1,E.rounding)},i.sine=i.sin=function(){var f,E,A=this,b=A.constructor;return A.isFinite()?A.isZero()?new b(A):(f=b.precision,E=b.rounding,b.precision=f+Math.max(A.e,A.sd())+ge,b.rounding=1,A=Qe(b,J(b,A)),b.precision=f,b.rounding=E,R(V>2?A.neg():A,f,E,!0)):new b(NaN)},i.squareRoot=i.sqrt=function(){var f,E,A,b,T,n,r=this,l=r.d,v=r.e,m=r.s,q=r.constructor;if(m!==1||!l||!l[0])return new q(!m||m<0&&(!l||l[0])?NaN:l?r:1/0);for(B=!1,m=Math.sqrt(+r),m==0||m==1/0?(E=a(l),(E.length+v)%2==0&&(E+="0"),m=Math.sqrt(E),v=fe((v+1)/2)-(v<0||v%2),m==1/0?E="5e"+v:(E=m.toExponential(),E=E.slice(0,E.indexOf("e")+1)+v),b=new q(E)):b=new q(m.toString()),A=(v=q.precision)+3;;)if(n=b,b=n.plus(_(r,n,A+2,1)).times(.5),a(n.d).slice(0,A)===(E=a(b.d)).slice(0,A))if(E=E.slice(A-3,A+1),E=="9999"||!T&&E=="4999"){if(!T&&(R(n,v+1,0),n.times(n).eq(r))){b=n;break}A+=4,T=1}else{(!+E||!+E.slice(1)&&E.charAt(0)=="5")&&(R(b,v+1,1),f=!b.times(b).eq(r));break}return B=!0,R(b,v,q.rounding,f)},i.tangent=i.tan=function(){var f,E,A=this,b=A.constructor;return A.isFinite()?A.isZero()?new b(A):(f=b.precision,E=b.rounding,b.precision=f+10,b.rounding=1,A=A.sin(),A.s=1,A=_(A,new b(1).minus(A.times(A)).sqrt(),f+10,0),b.precision=f,b.rounding=E,R(V==2||V==4?A.neg():A,f,E,!0)):new b(NaN)},i.times=i.mul=function(f){var E,A,b,T,n,r,l,v,m,q=this,M=q.constructor,I=q.d,H=(f=new M(f)).d;if(f.s*=q.s,!I||!I[0]||!H||!H[0])return new M(!f.s||I&&!I[0]&&!H||H&&!H[0]&&!I?NaN:!I||!H?f.s/0:f.s*0);for(A=fe(q.e/ge)+fe(f.e/ge),v=I.length,m=H.length,v<m&&(n=I,I=H,H=n,r=v,v=m,m=r),n=[],r=v+m,b=r;b--;)n.push(0);for(b=m;--b>=0;){for(E=0,T=v+b;T>b;)l=n[T]+H[b]*I[T-b-1]+E,n[T--]=l%$e|0,E=l/$e|0;n[T]=(n[T]+E)%$e|0}for(;!n[--r];)n.pop();return E?++A:n.shift(),f.d=n,f.e=F(n,A),B?R(f,M.precision,M.rounding):f},i.toBinary=function(f,E){return Z(this,2,f,E)},i.toDecimalPlaces=i.toDP=function(f,E){var A=this,b=A.constructor;return A=new b(A),f===void 0?A:(c(f,0,e),E===void 0?E=b.rounding:c(E,0,8),R(A,f+A.e+1,E))},i.toExponential=function(f,E){var A,b=this,T=b.constructor;return f===void 0?A=U(b,!0):(c(f,0,e),E===void 0?E=T.rounding:c(E,0,8),b=R(new T(b),f+1,E),A=U(b,!0,f+1)),b.isNeg()&&!b.isZero()?"-"+A:A},i.toFixed=function(f,E){var A,b,T=this,n=T.constructor;return f===void 0?A=U(T):(c(f,0,e),E===void 0?E=n.rounding:c(E,0,8),b=R(new n(T),f+T.e+1,E),A=U(b,!1,f+b.e+1)),T.isNeg()&&!T.isZero()?"-"+A:A},i.toFraction=function(f){var E,A,b,T,n,r,l,v,m,q,M,I,H=this,ne=H.d,ae=H.constructor;if(!ne)return new ae(H);if(m=A=new ae(1),b=v=new ae(0),E=new ae(b),n=E.e=Se(ne)-H.e-1,r=n%ge,E.d[0]=u(10,r<0?ge+r:r),f==null)f=n>0?E:m;else{if(l=new ae(f),!l.isInt()||l.lt(m))throw Error(Ee+l);f=l.gt(E)?n>0?E:m:l}for(B=!1,l=new ae(a(ne)),q=ae.precision,ae.precision=n=ne.length*ge*2;M=_(l,E,0,1,1),T=A.plus(M.times(b)),T.cmp(f)!=1;)A=b,b=T,T=m,m=v.plus(M.times(T)),v=T,T=E,E=l.minus(M.times(T)),l=T;return T=_(f.minus(A),b,0,1,1),v=v.plus(T.times(m)),A=A.plus(T.times(b)),v.s=m.s=H.s,I=_(m,b,n,1).minus(H).abs().cmp(_(v,A,n,1).minus(H).abs())<1?[m,b]:[v,A],ae.precision=q,B=!0,I},i.toHexadecimal=i.toHex=function(f,E){return Z(this,16,f,E)},i.toNearest=function(f,E){var A=this,b=A.constructor;if(A=new b(A),f==null){if(!A.d)return A;f=new b(1),E=b.rounding}else{if(f=new b(f),E===void 0?E=b.rounding:c(E,0,8),!A.d)return f.s?A:f;if(!f.d)return f.s&&(f.s=A.s),f}return f.d[0]?(B=!1,A=_(A,f,0,E,1).times(f),B=!0,R(A)):(f.s=A.s,A=f),A},i.toNumber=function(){return+this},i.toOctal=function(f,E){return Z(this,8,f,E)},i.toPower=i.pow=function(f){var E,A,b,T,n,r,l=this,v=l.constructor,m=+(f=new v(f));if(!l.d||!f.d||!l.d[0]||!f.d[0])return new v(u(+l,m));if(l=new v(l),l.eq(1))return l;if(b=v.precision,n=v.rounding,f.eq(1))return R(l,b,n);if(E=fe(f.e/ge),E>=f.d.length-1&&(A=m<0?-m:m)<=ve)return T=Ce(v,l,A,b),f.s<0?new v(1).div(T):R(T,b,n);if(r=l.s,r<0){if(E<f.d.length-1)return new v(NaN);if((f.d[E]&1)==0&&(r=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=r,l}return A=u(+l,m),E=A==0||!isFinite(A)?fe(m*(Math.log("0."+a(l.d))/Math.LN10+l.e+1)):new v(A+"").e,E>v.maxE+1||E<v.minE-1?new v(E>0?r/0:0):(B=!1,v.rounding=l.s=1,A=Math.min(12,(E+"").length),T=Le(f.times(Pe(l,b+A)),b),T.d&&(T=R(T,b+5,1),S(T.d,b,n)&&(E=b+10,T=R(Le(f.times(Pe(l,E+A)),E),E+5,1),+a(T.d).slice(b+1,b+15)+1==1e14&&(T=R(T,b+1,0)))),T.s=r,B=!0,v.rounding=n,R(T,b,n))},i.toPrecision=function(f,E){var A,b=this,T=b.constructor;return f===void 0?A=U(b,b.e<=T.toExpNeg||b.e>=T.toExpPos):(c(f,1,e),E===void 0?E=T.rounding:c(E,0,8),b=R(new T(b),f,E),A=U(b,f<=b.e||b.e<=T.toExpNeg,f)),b.isNeg()&&!b.isZero()?"-"+A:A},i.toSignificantDigits=i.toSD=function(f,E){var A=this,b=A.constructor;return f===void 0?(f=b.precision,E=b.rounding):(c(f,1,e),E===void 0?E=b.rounding:c(E,0,8)),R(new b(A),f,E)},i.toString=function(){var f=this,E=f.constructor,A=U(f,f.e<=E.toExpNeg||f.e>=E.toExpPos);return f.isNeg()&&!f.isZero()?"-"+A:A},i.truncated=i.trunc=function(){return R(new this.constructor(this),this.e+1,1)},i.valueOf=i.toJSON=function(){var f=this,E=f.constructor,A=U(f,f.e<=E.toExpNeg||f.e>=E.toExpPos);return f.isNeg()?"-"+A:A};function a(f){var E,A,b,T=f.length-1,n="",r=f[0];if(T>0){for(n+=r,E=1;E<T;E++)b=f[E]+"",A=ge-b.length,A&&(n+=he(A)),n+=b;r=f[E],b=r+"",A=ge-b.length,A&&(n+=he(A))}else if(r===0)return"0";for(;r%10===0;)r/=10;return n+r}function c(f,E,A){if(f!==~~f||f<E||f>A)throw Error(Ee+f)}function S(f,E,A,b){var T,n,r,l;for(n=f[0];n>=10;n/=10)--E;return--E<0?(E+=ge,T=0):(T=Math.ceil((E+1)/ge),E%=ge),n=u(10,ge-E),l=f[T]%n|0,b==null?E<3?(E==0?l=l/100|0:E==1&&(l=l/10|0),r=A<4&&l==99999||A>3&&l==49999||l==5e4||l==0):r=(A<4&&l+1==n||A>3&&l+1==n/2)&&(f[T+1]/n/100|0)==u(10,E-2)-1||(l==n/2||l==0)&&(f[T+1]/n/100|0)==0:E<4?(E==0?l=l/1e3|0:E==1?l=l/100|0:E==2&&(l=l/10|0),r=(b||A<4)&&l==9999||!b&&A>3&&l==4999):r=((b||A<4)&&l+1==n||!b&&A>3&&l+1==n/2)&&(f[T+1]/n/1e3|0)==u(10,E-3)-1,r}function w(f,E,A){for(var b,T=[0],n,r=0,l=f.length;r<l;){for(n=T.length;n--;)T[n]*=E;for(T[0]+=o.indexOf(f.charAt(r++)),b=0;b<T.length;b++)T[b]>A-1&&(T[b+1]===void 0&&(T[b+1]=0),T[b+1]+=T[b]/A|0,T[b]%=A)}return T.reverse()}function N(f,E){var A,b,T;if(E.isZero())return E;b=E.d.length,b<32?(A=Math.ceil(b/3),T=(1/Je(4,A)).toString()):(A=16,T="2.3283064365386962890625e-10"),f.precision+=A,E=rt(f,1,E.times(T),new f(1));for(var n=A;n--;){var r=E.times(E);E=r.times(r).minus(r).times(8).plus(1)}return f.precision-=A,E}var _=(function(){function f(b,T,n){var r,l=0,v=b.length;for(b=b.slice();v--;)r=b[v]*T+l,b[v]=r%n|0,l=r/n|0;return l&&b.unshift(l),b}function E(b,T,n,r){var l,v;if(n!=r)v=n>r?1:-1;else for(l=v=0;l<n;l++)if(b[l]!=T[l]){v=b[l]>T[l]?1:-1;break}return v}function A(b,T,n,r){for(var l=0;n--;)b[n]-=l,l=b[n]<T[n]?1:0,b[n]=l*r+b[n]-T[n];for(;!b[0]&&b.length>1;)b.shift()}return function(b,T,n,r,l,v){var m,q,M,I,H,ne,ae,qe,Ue,be,ke,st,bt,ze,Re,Ke,Xe,Ye,at,dt,ht=b.constructor,tt=b.s==T.s?1:-1,nt=b.d,it=T.d;if(!nt||!nt[0]||!it||!it[0])return new ht(!b.s||!T.s||(nt?it&&nt[0]==it[0]:!it)?NaN:nt&&nt[0]==0||!it?tt*0:tt/0);for(v?(H=1,q=b.e-T.e):(v=$e,H=ge,q=fe(b.e/H)-fe(T.e/H)),at=it.length,Xe=nt.length,Ue=new ht(tt),be=Ue.d=[],M=0;it[M]==(nt[M]||0);M++);if(it[M]>(nt[M]||0)&&q--,n==null?(ze=n=ht.precision,r=ht.rounding):l?ze=n+(b.e-T.e)+1:ze=n,ze<0)be.push(1),ne=!0;else{if(ze=ze/H+2|0,M=0,at==1){for(I=0,it=it[0],ze++;(M<Xe||I)&&ze--;M++)Re=I*v+(nt[M]||0),be[M]=Re/it|0,I=Re%it|0;ne=I||M<Xe}else{for(I=v/(it[0]+1)|0,I>1&&(it=f(it,I,v),nt=f(nt,I,v),at=it.length,Xe=nt.length),Ke=at,ke=nt.slice(0,at),st=ke.length;st<at;)ke[st++]=0;dt=it.slice(),dt.unshift(0),Ye=it[0],it[1]>=v/2&&++Ye;do I=0,m=E(it,ke,at,st),m<0?(bt=ke[0],at!=st&&(bt=bt*v+(ke[1]||0)),I=bt/Ye|0,I>1?(I>=v&&(I=v-1),ae=f(it,I,v),qe=ae.length,st=ke.length,m=E(ae,ke,qe,st),m==1&&(I--,A(ae,at<qe?dt:it,qe,v))):(I==0&&(m=I=1),ae=it.slice()),qe=ae.length,qe<st&&ae.unshift(0),A(ke,ae,st,v),m==-1&&(st=ke.length,m=E(it,ke,at,st),m<1&&(I++,A(ke,at<st?dt:it,st,v))),st=ke.length):m===0&&(I++,ke=[0]),be[M++]=I,m&&ke[0]?ke[st++]=nt[Ke]||0:(ke=[nt[Ke]],st=1);while((Ke++<Xe||ke[0]!==void 0)&&ze--);ne=ke[0]!==void 0}be[0]||be.shift()}if(H==1)Ue.e=q,D=ne;else{for(M=1,I=be[0];I>=10;I/=10)M++;Ue.e=M+q*H-1,R(Ue,l?n+Ue.e+1:n,r,ne)}return Ue}})();function R(f,E,A,b){var T,n,r,l,v,m,q,M,I,H=f.constructor;e:if(E!=null){if(M=f.d,!M)return f;for(T=1,l=M[0];l>=10;l/=10)T++;if(n=E-T,n<0)n+=ge,r=E,q=M[I=0],v=q/u(10,T-r-1)%10|0;else if(I=Math.ceil((n+1)/ge),l=M.length,I>=l)if(b){for(;l++<=I;)M.push(0);q=v=0,T=1,n%=ge,r=n-ge+1}else break e;else{for(q=l=M[I],T=1;l>=10;l/=10)T++;n%=ge,r=n-ge+T,v=r<0?0:q/u(10,T-r-1)%10|0}if(b=b||E<0||M[I+1]!==void 0||(r<0?q:q%u(10,T-r-1)),m=A<4?(v||b)&&(A==0||A==(f.s<0?3:2)):v>5||v==5&&(A==4||b||A==6&&(n>0?r>0?q/u(10,T-r):0:M[I-1])%10&1||A==(f.s<0?8:7)),E<1||!M[0])return M.length=0,m?(E-=f.e+1,M[0]=u(10,(ge-E%ge)%ge),f.e=-E||0):M[0]=f.e=0,f;if(n==0?(M.length=I,l=1,I--):(M.length=I+1,l=u(10,ge-n),M[I]=r>0?(q/u(10,T-r)%u(10,r)|0)*l:0),m)for(;;)if(I==0){for(n=1,r=M[0];r>=10;r/=10)n++;for(r=M[0]+=l,l=1;r>=10;r/=10)l++;n!=l&&(f.e++,M[0]==$e&&(M[0]=1));break}else{if(M[I]+=l,M[I]!=$e)break;M[I--]=0,l=1}for(n=M.length;M[--n]===0;)M.pop()}return B&&(f.e>H.maxE?(f.d=null,f.e=NaN):f.e<H.minE&&(f.e=0,f.d=[0])),f}function U(f,E,A){if(!f.isFinite())return Ge(f);var b,T=f.e,n=a(f.d),r=n.length;return E?(A&&(b=A-r)>0?n=n.charAt(0)+"."+n.slice(1)+he(b):r>1&&(n=n.charAt(0)+"."+n.slice(1)),n=n+(f.e<0?"e":"e+")+f.e):T<0?(n="0."+he(-T-1)+n,A&&(b=A-r)>0&&(n+=he(b))):T>=r?(n+=he(T+1-r),A&&(b=A-T-1)>0&&(n=n+"."+he(b))):((b=T+1)<r&&(n=n.slice(0,b)+"."+n.slice(b)),A&&(b=A-r)>0&&(T+1===r&&(n+="."),n+=he(b))),n}function F(f,E){var A=f[0];for(E*=ge;A>=10;A/=10)E++;return E}function ie(f,E,A){if(E>Ie)throw B=!0,A&&(f.precision=A),Error(Me);return R(new f(h),E,1,!0)}function oe(f,E,A){if(E>le)throw Error(Me);return R(new f(y),E,A,!0)}function Se(f){var E=f.length-1,A=E*ge+1;if(E=f[E],E){for(;E%10==0;E/=10)A--;for(E=f[0];E>=10;E/=10)A++}return A}function he(f){for(var E="";f--;)E+="0";return E}function Ce(f,E,A,b){var T,n=new f(1),r=Math.ceil(b/ge+4);for(B=!1;;){if(A%2&&(n=n.times(E),j(n.d,r)&&(T=!0)),A=fe(A/2),A===0){A=n.d.length-1,T&&n.d[A]===0&&++n.d[A];break}E=E.times(E),j(E.d,r)}return B=!0,n}function Ae(f){return f.d[f.d.length-1]&1}function de(f,E,A){for(var b,T,n=new f(E[0]),r=0;++r<E.length;){if(T=new f(E[r]),!T.s){n=T;break}b=n.cmp(T),(b===A||b===0&&n.s===A)&&(n=T)}return n}function Le(f,E){var A,b,T,n,r,l,v,m=0,q=0,M=0,I=f.constructor,H=I.rounding,ne=I.precision;if(!f.d||!f.d[0]||f.e>17)return new I(f.d?f.d[0]?f.s<0?0:1/0:1:f.s?f.s<0?0:f:NaN);for(E==null?(B=!1,v=ne):v=E,l=new I(.03125);f.e>-2;)f=f.times(l),M+=5;for(b=Math.log(u(2,M))/Math.LN10*2+5|0,v+=b,A=n=r=new I(1),I.precision=v;;){if(n=R(n.times(f),v,1),A=A.times(++q),l=r.plus(_(n,A,v,1)),a(l.d).slice(0,v)===a(r.d).slice(0,v)){for(T=M;T--;)r=R(r.times(r),v,1);if(E==null)if(m<3&&S(r.d,v-b,H,m))I.precision=v+=10,A=n=l=new I(1),q=0,m++;else return R(r,I.precision=ne,H,B=!0);else return I.precision=ne,r}r=l}}function Pe(f,E){var A,b,T,n,r,l,v,m,q,M,I,H=1,ne=10,ae=f,qe=ae.d,Ue=ae.constructor,be=Ue.rounding,ke=Ue.precision;if(ae.s<0||!qe||!qe[0]||!ae.e&&qe[0]==1&&qe.length==1)return new Ue(qe&&!qe[0]?-1/0:ae.s!=1?NaN:qe?0:ae);if(E==null?(B=!1,q=ke):q=E,Ue.precision=q+=ne,A=a(qe),b=A.charAt(0),Math.abs(n=ae.e)<15e14){for(;b<7&&b!=1||b==1&&A.charAt(1)>3;)ae=ae.times(f),A=a(ae.d),b=A.charAt(0),H++;n=ae.e,b>1?(ae=new Ue("0."+A),n++):ae=new Ue(b+"."+A.slice(1))}else return m=ie(Ue,q+2,ke).times(n+""),ae=Pe(new Ue(b+"."+A.slice(1)),q-ne).plus(m),Ue.precision=ke,E==null?R(ae,ke,be,B=!0):ae;for(M=ae,v=r=ae=_(ae.minus(1),ae.plus(1),q,1),I=R(ae.times(ae),q,1),T=3;;){if(r=R(r.times(I),q,1),m=v.plus(_(r,new Ue(T),q,1)),a(m.d).slice(0,q)===a(v.d).slice(0,q))if(v=v.times(2),n!==0&&(v=v.plus(ie(Ue,q+2,ke).times(n+""))),v=_(v,new Ue(H),q,1),E==null)if(S(v.d,q-ne,be,l))Ue.precision=q+=ne,m=r=ae=_(M.minus(1),M.plus(1),q,1),I=R(ae.times(ae),q,1),T=l=1;else return R(v,Ue.precision=ke,be,B=!0);else return Ue.precision=ke,v;v=m,T+=2}}function Ge(f){return String(f.s*f.s/0)}function We(f,E){var A,b,T;for((A=E.indexOf("."))>-1&&(E=E.replace(".","")),(b=E.search(/e/i))>0?(A<0&&(A=b),A+=+E.slice(b+1),E=E.substring(0,b)):A<0&&(A=E.length),b=0;E.charCodeAt(b)===48;b++);for(T=E.length;E.charCodeAt(T-1)===48;--T);if(E=E.slice(b,T),E){if(T-=b,f.e=A=A-b-1,f.d=[],b=(A+1)%ge,A<0&&(b+=ge),b<T){for(b&&f.d.push(+E.slice(0,b)),T-=ge;b<T;)f.d.push(+E.slice(b,b+=ge));E=E.slice(b),b=ge-E.length}else b-=T;for(;b--;)E+="0";f.d.push(+E),B&&(f.e>f.constructor.maxE?(f.d=null,f.e=NaN):f.e<f.constructor.minE&&(f.e=0,f.d=[0]))}else f.e=0,f.d=[0];return f}function He(f,E){var A,b,T,n,r,l,v,m,q;if(E.indexOf("_")>-1){if(E=E.replace(/(\d)_(?=\d)/g,"$1"),ye.test(E))return We(f,E)}else if(E==="Infinity"||E==="NaN")return+E||(f.s=NaN),f.e=NaN,f.d=null,f;if(_e.test(E))A=16,E=E.toLowerCase();else if(Ne.test(E))A=2;else if(xe.test(E))A=8;else throw Error(Ee+E);for(n=E.search(/p/i),n>0?(v=+E.slice(n+1),E=E.substring(2,n)):E=E.slice(2),n=E.indexOf("."),r=n>=0,b=f.constructor,r&&(E=E.replace(".",""),l=E.length,n=l-n,T=Ce(b,new b(A),n,n*2)),m=w(E,A,$e),q=m.length-1,n=q;m[n]===0;--n)m.pop();return n<0?new b(f.s*0):(f.e=F(m,q),f.d=m,B=!1,r&&(f=_(f,T,l*4)),v&&(f=f.times(Math.abs(v)<54?u(2,v):C.pow(2,v))),B=!0,f)}function Qe(f,E){var A,b=E.d.length;if(b<3)return E.isZero()?E:rt(f,2,E,E);A=1.4*Math.sqrt(b),A=A>16?16:A|0,E=E.times(1/Je(5,A)),E=rt(f,2,E,E);for(var T,n=new f(5),r=new f(16),l=new f(20);A--;)T=E.times(E),E=E.times(n.plus(T.times(r.times(T).minus(l))));return E}function rt(f,E,A,b,T){var n,r,l,v,m=1,q=f.precision,M=Math.ceil(q/ge);for(B=!1,v=A.times(A),l=new f(b);;){if(r=_(l.times(v),new f(E++*E++),q,1),l=T?b.plus(r):b.minus(r),b=_(r.times(v),new f(E++*E++),q,1),r=l.plus(b),r.d[M]!==void 0){for(n=M;r.d[n]===l.d[n]&&n--;);if(n==-1)break}n=l,l=b,b=r,r=n,m++}return B=!0,r.d.length=M+1,r}function Je(f,E){for(var A=f;--E;)A*=f;return A}function J(f,E){var A,b=E.s<0,T=oe(f,f.precision,1),n=T.times(.5);if(E=E.abs(),E.lte(n))return V=b?4:1,E;if(A=E.divToInt(T),A.isZero())V=b?3:2;else{if(E=E.minus(A.times(T)),E.lte(n))return V=Ae(A)?b?2:3:b?4:1,E;V=Ae(A)?b?1:4:b?3:2}return E.minus(T).abs()}function Z(f,E,A,b){var T,n,r,l,v,m,q,M,I,H=f.constructor,ne=A!==void 0;if(ne?(c(A,1,e),b===void 0?b=H.rounding:c(b,0,8)):(A=H.precision,b=H.rounding),!f.isFinite())q=Ge(f);else{for(q=U(f),r=q.indexOf("."),ne?(T=2,E==16?A=A*4-3:E==8&&(A=A*3-2)):T=E,r>=0&&(q=q.replace(".",""),I=new H(1),I.e=q.length-r,I.d=w(U(I),10,T),I.e=I.d.length),M=w(q,10,T),n=v=M.length;M[--v]==0;)M.pop();if(!M[0])q=ne?"0p+0":"0";else{if(r<0?n--:(f=new H(f),f.d=M,f.e=n,f=_(f,I,A,b,0,T),M=f.d,n=f.e,m=D),r=M[A],l=T/2,m=m||M[A+1]!==void 0,m=b<4?(r!==void 0||m)&&(b===0||b===(f.s<0?3:2)):r>l||r===l&&(b===4||m||b===6&&M[A-1]&1||b===(f.s<0?8:7)),M.length=A,m)for(;++M[--A]>T-1;)M[A]=0,A||(++n,M.unshift(1));for(v=M.length;!M[v-1];--v);for(r=0,q="";r<v;r++)q+=o.charAt(M[r]);if(ne){if(v>1)if(E==16||E==8){for(r=E==16?4:3,--v;v%r;v++)q+="0";for(M=w(q,T,E),v=M.length;!M[v-1];--v);for(r=1,q="1.";r<v;r++)q+=o.charAt(M[r])}else q=q.charAt(0)+"."+q.slice(1);q=q+(n<0?"p":"p+")+n}else if(n<0){for(;++n;)q="0"+q;q="0."+q}else if(++n>v)for(n-=v;n--;)q+="0";else n<v&&(q=q.slice(0,n)+"."+q.slice(n))}q=(E==16?"0x":E==2?"0b":E==8?"0o":"")+q}return f.s<0?"-"+q:q}function j(f,E){if(f.length>E)return f.length=E,!0}function k(f){return new this(f).abs()}function K(f){return new this(f).acos()}function O(f){return new this(f).acosh()}function $(f,E){return new this(f).plus(E)}function g(f){return new this(f).asin()}function p(f){return new this(f).asinh()}function P(f){return new this(f).atan()}function d(f){return new this(f).atanh()}function x(f,E){f=new this(f),E=new this(E);var A,b=this.precision,T=this.rounding,n=b+4;return!f.s||!E.s?A=new this(NaN):!f.d&&!E.d?(A=oe(this,n,1).times(E.s>0?.25:.75),A.s=f.s):!E.d||f.isZero()?(A=E.s<0?oe(this,b,T):new this(0),A.s=f.s):!f.d||E.isZero()?(A=oe(this,n,1).times(.5),A.s=f.s):E.s<0?(this.precision=n,this.rounding=1,A=this.atan(_(f,E,n,1)),E=oe(this,n,1),this.precision=b,this.rounding=T,A=f.s<0?A.minus(E):A.plus(E)):A=this.atan(_(f,E,n,1)),A}function X(f){return new this(f).cbrt()}function W(f){return R(f=new this(f),f.e+1,2)}function Q(f,E,A){return new this(f).clamp(E,A)}function ee(f){if(!f||typeof f!="object")throw Error(we+"Object expected");var E,A,b,T=f.defaults===!0,n=["precision",1,e,"rounding",0,8,"toExpNeg",-t,0,"toExpPos",0,t,"maxE",0,t,"minE",-t,0,"modulo",0,9];for(E=0;E<n.length;E+=3)if(A=n[E],T&&(this[A]=L[A]),(b=f[A])!==void 0)if(fe(b)===b&&b>=n[E+1]&&b<=n[E+2])this[A]=b;else throw Error(Ee+A+": "+b);if(A="crypto",T&&(this[A]=L[A]),(b=f[A])!==void 0)if(b===!0||b===!1||b===0||b===1)if(b)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[A]=!0;else throw Error(ce);else this[A]=!1;else throw Error(Ee+A+": "+b);return this}function re(f){return new this(f).cos()}function Y(f){return new this(f).cosh()}function se(f){var E,A,b;function T(n){var r,l,v,m=this;if(!(m instanceof T))return new T(n);if(m.constructor=T,Ze(n)){m.s=n.s,B?!n.d||n.e>T.maxE?(m.e=NaN,m.d=null):n.e<T.minE?(m.e=0,m.d=[0]):(m.e=n.e,m.d=n.d.slice()):(m.e=n.e,m.d=n.d?n.d.slice():n.d);return}if(v=typeof n,v==="number"){if(n===0){m.s=1/n<0?-1:1,m.e=0,m.d=[0];return}if(n<0?(n=-n,m.s=-1):m.s=1,n===~~n&&n<1e7){for(r=0,l=n;l>=10;l/=10)r++;B?r>T.maxE?(m.e=NaN,m.d=null):r<T.minE?(m.e=0,m.d=[0]):(m.e=r,m.d=[n]):(m.e=r,m.d=[n]);return}if(n*0!==0){n||(m.s=NaN),m.e=NaN,m.d=null;return}return We(m,n.toString())}if(v==="string")return(l=n.charCodeAt(0))===45?(n=n.slice(1),m.s=-1):(l===43&&(n=n.slice(1)),m.s=1),ye.test(n)?We(m,n):He(m,n);if(v==="bigint")return n<0?(n=-n,m.s=-1):m.s=1,We(m,n.toString());throw Error(Ee+n)}if(T.prototype=i,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=ee,T.clone=se,T.isDecimal=Ze,T.abs=k,T.acos=K,T.acosh=O,T.add=$,T.asin=g,T.asinh=p,T.atan=P,T.atanh=d,T.atan2=x,T.cbrt=X,T.ceil=W,T.clamp=Q,T.cos=re,T.cosh=Y,T.div=me,T.exp=De,T.floor=Te,T.hypot=je,T.ln=Ve,T.log=et,T.log10=lt,T.log2=Be,T.max=ct,T.min=ft,T.mod=At,T.mul=$t,T.pow=Tt,T.random=pt,T.round=Ft,T.sign=_t,T.sin=Ot,T.sinh=Vt,T.sqrt=Jt,T.sub=c0,T.sum=Yt,T.tan=r0,T.tanh=Kt,T.trunc=v0,f===void 0&&(f={}),f&&f.defaults!==!0)for(b=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],E=0;E<b.length;)f.hasOwnProperty(A=b[E++])||(f[A]=this[A]);return T.config(f),T}function me(f,E){return new this(f).div(E)}function De(f){return new this(f).exp()}function Te(f){return R(f=new this(f),f.e+1,3)}function je(){var f,E,A=new this(0);for(B=!1,f=0;f<arguments.length;)if(E=new this(arguments[f++]),E.d)A.d&&(A=A.plus(E.times(E)));else{if(E.s)return B=!0,new this(1/0);A=E}return B=!0,A.sqrt()}function Ze(f){return f instanceof C||f&&f.toStringTag===pe||!1}function Ve(f){return new this(f).ln()}function et(f,E){return new this(f).log(E)}function Be(f){return new this(f).log(2)}function lt(f){return new this(f).log(10)}function ct(){return de(this,arguments,-1)}function ft(){return de(this,arguments,1)}function At(f,E){return new this(f).mod(E)}function $t(f,E){return new this(f).mul(E)}function Tt(f,E){return new this(f).pow(E)}function pt(f){var E,A,b,T,n=0,r=new this(1),l=[];if(f===void 0?f=this.precision:c(f,1,e),b=Math.ceil(f/ge),this.crypto)if(crypto.getRandomValues)for(E=crypto.getRandomValues(new Uint32Array(b));n<b;)T=E[n],T>=429e7?E[n]=crypto.getRandomValues(new Uint32Array(1))[0]:l[n++]=T%1e7;else if(crypto.randomBytes){for(E=crypto.randomBytes(b*=4);n<b;)T=E[n]+(E[n+1]<<8)+(E[n+2]<<16)+((E[n+3]&127)<<24),T>=214e7?crypto.randomBytes(4).copy(E,n):(l.push(T%1e7),n+=4);n=b/4}else throw Error(ce);else for(;n<b;)l[n++]=Math.random()*1e7|0;for(b=l[--n],f%=ge,b&&f&&(T=u(10,ge-f),l[n]=(b/T|0)*T);l[n]===0;n--)l.pop();if(n<0)A=0,l=[0];else{for(A=-1;l[0]===0;A-=ge)l.shift();for(b=1,T=l[0];T>=10;T/=10)b++;b<ge&&(A-=ge-b)}return r.e=A,r.d=l,r}function Ft(f){return R(f=new this(f),f.e+1,this.rounding)}function _t(f){return f=new this(f),f.d?f.d[0]?f.s:0*f.s:f.s||NaN}function Ot(f){return new this(f).sin()}function Vt(f){return new this(f).sinh()}function Jt(f){return new this(f).sqrt()}function c0(f,E){return new this(f).sub(E)}function Yt(){var f=0,E=arguments,A=new this(E[f]);for(B=!1;A.s&&++f<E.length;)A=A.plus(E[f]);return B=!0,R(A,this.precision,this.rounding)}function r0(f){return new this(f).tan()}function Kt(f){return new this(f).tanh()}function v0(f){return R(f=new this(f),f.e+1,1)}C=se(L),C.prototype.constructor=C,C.default=C.Decimal=C,h=new C(h),y=new C(y),typeof define=="function"&&define.amd?define(function(){return C}):typeof j0<"u"&&j0.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(i[Symbol.for("nodejs.util.inspect.custom")]=i.toString,i[Symbol.toStringTag]="Decimal"),j0.exports=C):(s||(s=typeof self<"u"&&self&&self.self==self?self:window),G=s.Decimal,C.noConflict=function(){return s.Decimal=G,C},s.Decimal=C)})(Tn)});var xn=f0((Wi,ln)=>{"use strict";var Ln=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],Un={};for(let s of Ln)Un[s]=!0;var g1="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",m1="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",d1=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof ln<"u"&&(ln.exports={PRIMES:Ln,PRIMES_SET:Un,LONG_PI:g1,LONG_E:m1,BIG_LOG_CACHE:d1})});var T0=f0((Qi,vn)=>{"use strict";var Nn=typeof globalThis.nerdamerBigInt>"u"?qn():globalThis.nerdamerBigInt,rn=typeof globalThis.nerdamerBigDecimal>"u"?Rn():globalThis.nerdamerBigDecimal;rn.set({precision:250});var x0=typeof globalThis.nerdamerConstants>"u"?xn():globalThis.nerdamerConstants,w1={},S1=[],v1={},N1=[],y1=[],E1=[],sn={Settings:null,Math2:null},te={ext:{bigInt:Nn,bigDec:rn,PRIMES:x0.PRIMES,PRIMES_SET:x0.PRIMES_SET,LONG_PI:x0.LONG_PI,LONG_E:x0.LONG_E,BIG_LOG_CACHE:x0.BIG_LOG_CACHE},groups:{N:1,P:2,S:3,EX:4,FN:5,PL:6,CB:7,CP:8},fnNames:{SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",PARENTHESIS:"parens",LOG:"log",CONST_HASH:"#"},get settings(){return sn.Settings},state:{get EXPRESSIONS(){return S1},get VARS(){return v1},CONSTANTS:{},get RESERVED(){return N1},get WARNINGS(){return y1},get USER_FUNCTIONS(){return E1},get CUSTOM_OPERATORS(){return w1}},classes:{Frac:null,Fraction:null,NerdamerSymbol:null,Vector:null,Matrix:null,Expression:null,Collection:null,NerdamerSet:null,Scientific:null,Parser:null,LaTeX:null,Math2:null,Build:null},utils:{get isSymbol(){return gt},get isVector(){return vt},get isMatrix(){return St},get isExpression(){return r1},get isNumericSymbol(){return q0},get isFraction(){return _n},get isArray(){return Dt},get isInt(){return mt},get text(){return Xt},get variables(){return n0},get scientificToDecimal(){return F0},get err(){return Pt},get block(){return Bt},get evaluate(){return Nt},get reserveNames(){return k0},get nround(){return m0},get remove(){return d0},get _setFunction(){return On},get _clearFunctions(){return $i},symfunction:null,callfunction:null},exceptions:null,parser:null,core:null,libExports:null,version:"1.1.16"},M1={N:te.groups.N,P:te.groups.P,S:te.groups.S,EX:te.groups.EX,FN:te.groups.FN,PL:te.groups.PL,CB:te.groups.CB,CP:te.groups.CP};Math.sign||=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1};Math.cosh||=function(t){let e=Math.exp(t);return(e+1/e)/2};Math.sech||=function(t){return 1/Math.cosh(t)};Math.csch||=function(t){return 1/Math.sinh(t)};Math.coth||=function(t){return 1/Math.tanh(t)};Math.sinh||=function(t){let e=Math.exp(t);return(e-1/e)/2};Math.tanh||=function(t){if(t===1/0)return 1;if(t===-1/0)return-1;let e=Math.exp(2*t);return(e-1)/(e+1)};Math.asinh||=function(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))};Math.acosh||=function(t){return Math.log(t+Math.sqrt(t*t-1))};Math.atanh||=function(t){return Math.log((1+t)/(1-t))/2};Math.trunc||=function(t){return isNaN(t)?NaN:t>0?Math.floor(t):Math.ceil(t)};function Vn(s){return/\d+\.?\d*e[+-]*\d+/iu.test(s)}var Xn={convert(s,t){let e=Number(s),o;if(e===0)o=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let h=this.quickConversion(e);if(h[1]<=1e16){let y=Math.abs(e),L=e/y;o=this.fullConversion(y.toFixed(`${h[1]}`.length-1)),o[0]*=L}else o=h}else o=this.fullConversion(e);return o},quickConversion(s){let t=function(o){typeof o!="string"&&(o=o.toString());let h="",y=o.charAt(0);return y==="-"?(o=o.substr(1,o.length),h="-"):y==="+"&&(o=o.substr(1,o.length)),{sign:h,value:o}};function e(o){Vn(o)&&(o=F0(o));let h=t(o),y=h.value.split("."),L;y.length===1?L=y[0]:L=y[0]+y[1];let C=y[1]?y[1].length:0,D=`1${"0".repeat(C)}`;return L!=="0"&&(L=L.replace(/^0+/u,"")),[h.sign+L,D]}return e(s)},fullConversion(s){let t=Number(s),e=Math.abs(t)>1e10?1e-16:1e-30,o=!1,h=0,y=1,L=1,C=0,D=0,G=t,V,B,we=1e-14;for(;!o;){D++;let Ee;if(Math.abs(G)>1e10){let ce=Math.round(G);Ee=Math.abs(G-ce)/Math.abs(ce)<we?ce:Math.floor(G)}else Ee=Math.floor(G);V=h+Ee*L,B=y+Ee*C;let Me=G-Ee;Me<e&&(o=!0),G=1/Me,h=L,y=C,L=V,C=B,(Math.abs(V/B-t)<e||D>30)&&(o=!0)}return[V,B]}};te.classes.Fraction=Xn;function jt(s){let t=function(e){this.name=s,this.message=e===void 0?"":e;let o=new Error(this.message);o.name=this.name,this.stack=o.stack};return t.prototype=Object.create(Error.prototype),t}var yn=jt("DivisionByZero"),Gn=jt("ParseError"),Ht=jt("UndefinedError"),hn=jt("OutOfFunctionDomainError"),A1=jt("MaximumIterationsReached"),En=jt("NerdamerTypeError"),W0=jt("ParityError"),_0=jt("OperatorError"),C1=jt("OutOfRangeError"),gn=jt("DimensionError"),Hn=jt("InvalidVariableNameError"),b1=jt("ValueLimitExceededError"),jn=jt("NerdamerValueError"),I1=jt("SolveError"),_1=jt("InfiniteLoopError"),Zn=jt("UnexpectedTokenError");te.exceptions={DivisionByZero:yn,ParseError:Gn,OutOfFunctionDomainError:hn,UndefinedError:Ht,MaximumIterationsReached:A1,NerdamerTypeError:En,ParityError:W0,OperatorError:_0,OutOfRangeError:C1,DimensionError:gn,InvalidVariableNameError:Hn,ValueLimitExceededError:b1,NerdamerValueError:jn,SolveError:I1,InfiniteLoopError:_1,UnexpectedTokenError:Zn};var Rt={get bigInt(){return te.ext.bigInt},get bigDec(){return te.ext.bigDec},get isInt(){return te.utils.isInt},get scientificToDecimal(){return te.utils.scientificToDecimal},get DivisionByZero(){return yn},get Settings(){return te.settings},get Fraction(){return Xn}},Fe=class s{num;den;constructor(t){if(t instanceof s)return t;if(t===void 0)return this;try{if(Rt.isInt(t))try{this.num=Rt.bigInt(t),this.den=Rt.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return s.simple(t)}else{let e=t instanceof Rt.bigDec?Rt.Fraction.quickConversion(t):Rt.Fraction.convert(t);this.num=new Rt.bigInt(e[0]),this.den=new Rt.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return s.simple(t)}}static create(t){if(t instanceof s)return t;t=t.toString();let e=t.charAt(0)==="-";e&&(t=t.substr(1,t.length-1));let o=new s(t);return e&&o.negate(),o}static isFrac(t){return t instanceof s}static quick(t,e){let o=new s;return o.num=new Rt.bigInt(t),o.den=new Rt.bigInt(e),o}static simple(t){let o=String(Rt.scientificToDecimal(t)).split("."),h=o.join(""),y="1",L=(o[1]||"").length;for(let D=0;D<L;D++)y+="0";return s.quick(h,y).simplify()}multiply(t){if(this.isOne())return t.clone();if(t.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(t.num),e.den=e.den.multiply(t.den),e.simplify()}divide(t){if(t.equals(0))throw new Rt.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(t.clone().invert()).simplify()}subtract(t){return this.clone().add(t.clone().neg())}sub(t){return this.subtract(t)}neg(){return this.num=this.num.multiply(-1),this}add(t){let e=this.den,o=t.den,h=this.clone(),y=h.num,L=t.num;return e.equals(o)?h.num=y.add(L):(h.num=y.multiply(o).add(L.multiply(e)),h.den=e.multiply(o)),h.simplify()}mod(t){let e=this.clone(),o=t.clone();return e.num=e.num.multiply(o.den),e.den=e.den.multiply(o.den),o.num=o.num.multiply(this.den),o.den=o.den.multiply(this.den),e.num=e.num.mod(o.num),e.simplify()}simplify(){let t=Rt.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(t),this.den=this.den.divide(t),this}clone(){let t=new s;return t.num=new Rt.bigInt(this.num),t.den=new Rt.bigInt(this.den),t}decimal(t){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";t||=Rt.Settings.PRECISION,t+=2;let o=[],h=this.num.abs(),y=this.den,L;for(L=0;L<t;L++){let G=h.divide(y),V=h.subtract(G.multiply(y));if(o.push(G),V.equals(0))break;h=V.times(10)}let C=o.shift();if(o.length===0)return e+C.toString();if(L===t){let G=[];for(let V=0;V<2;V++)G.unshift(o.pop());o.push(Math.round(Number(G.join("."))))}let D=`${C.toString()}.${o.join("")}`;return e+D}toDecimal(t){return t||=Rt.Settings.PRECISION,t?this.decimal(t):this.num.valueOf()/this.den.valueOf()}qcompare(t){return[this.num.multiply(t.den),t.num.multiply(this.den)]}equals(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].equals(e[1])}absEquals(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].abs().equals(e[1])}greaterThan(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].gt(e[1])}gt(t){return this.greaterThan(t)}gte(t){return this.greaterThan(t)||this.equals(t)}lte(t){return this.lessThan(t)||this.equals(t)}lessThan(t){isNaN(t)||(t=new s(t));let e=this.qcompare(t);return e[0].lt(e[1])}lt(t){return this.lessThan(t)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let t=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=t,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(t){return s.quick(Rt.bigInt.gcd(t.num,this.num),Rt.bigInt.lcm(t.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Rt.Settings.USE_BIG?new Rt.bigDec(this.num.toString()).div(new Rt.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(t){let e=typeof t=="number"?new s(t):t;return this.mod(e).equals(0)}};te.classes.Frac=Fe;var an={get isVector(){return te.utils.isVector},get Vector(){return te.classes.Vector},get remove(){return d0}},g0=class s{elements=[];constructor(t,...e){if(typeof t>"u")return;let o=t;if(an.isVector(t)||(o=an.Vector.fromArray([t,...e])),o){let{elements:h}=o;for(let y=0,L=h.length;y<L;y++)this.add(h[y])}}static fromArray(t){let e=new s;for(let o of t)e.add(o);return e}add(t){this.contains(t)||this.elements.push(t.clone())}contains(t){for(let e=0;e<this.elements.length;e++){let o=this.elements[e];if(t.equals(o))return!0}return!1}each(t){let{elements:e}=this,o=new s;for(let h=0,y=e.length;h<y;h++){let L=e[h];t.call(this,L,o,h)}return o}clone(){let t=new s;return this.each(e=>{t.add(e.clone())}),t}union(t){let e=this.clone();return t.each(o=>{e.add(o)}),e}difference(t){let e=this.clone();return t.each(o=>{e.remove(o)}),e}remove(t){for(let e=0,o=this.elements.length;e<o;e++)if(this.elements[e].equals(t))return an.remove(this.elements,e),!0;return!1}intersection(t){let e=new s,o=this;return t.each(h=>{o.contains(h)&&e.add(h)}),e}intersects(t){return this.intersection(t).elements.length>0}isSubset(t){let{elements:e}=t;for(let o=0,h=e.length;o<h;o++)if(!this.contains(e[o]))return!1;return!0}toString(){return`{${this.elements.join(",")}}`}};te.classes.NerdamerSet=g0;var N0={get _(){return te.parser},get block(){return te.utils.block}},t0=class s{elements=[];constructor(t){t&&this.elements.push(t)}static create(t){return new s(t)}append(t){this.elements.push(t)}getItems(){return this.elements}toString(){return N0._.prettyPrint(this.elements)}dimensions(){return this.elements.length}text(t){return`(${this.elements.map(e=>e.text(t)).join(",")})`}clone(){let t=s.create();return t.elements=this.elements.map(e=>e.clone()),t}expand(t){return this.elements=this.elements.map(e=>N0._.expand(e,t)),this}evaluate(t){return this.elements=this.elements.map(e=>N0._.evaluate(e,t)),this}map(t){let e=this.clone();return e.elements=e.elements.map((o,h)=>t(o,h+1)),e}add(t){return N0.block("SAFE",()=>{let e=t.elements;return this.elements.length!==e.length?null:this.map((o,h)=>N0._.add(o,e[h-1]))},void 0,this)}subtract(t){return N0.block("SAFE",()=>{let e=t.elements;return this.elements.length!==e.length?null:this.map((o,h)=>N0._.subtract(o,e[h-1]))},void 0,this)}};te.classes.Collection=t0;var Pn={get Settings(){return te.settings},get nround(){return te.utils.nround}},D0=class s{sign;coeff;exponent;wholes;dec;decp;constructor(t){t=String(typeof t>"u"?0:t),t.startsWith("-")?(this.sign=-1,t=t.substr(1,t.length)):this.sign=1,s.isScientific(t)?this.fromScientific(t):this.convert(t)}static isScientific(t){return Vn(t)}static leadingZeroes(t){let e=t.match(/^(?<zeros>0*).*$/u);return e?e[1]:""}static removeLeadingZeroes(t){let e=t.match(/^0*(?<rest>.*)$/u);return e?e[1]:""}static removeTrailingZeroes(t){let e=t.match(/0*$/u);return e?t.substring(0,t.length-e[0].length):""}static round(t,e){let o=String(Pn.nround(t,e)),h=o.includes(".")?o.split(".").pop():"",y=e-h.length;return y>0&&(o.includes(".")||(o+="."),o+=new Array(y+1).join("0")),o}fromScientific(t){let e=String(t).toLowerCase().split("e");this.coeff=e[0],this.exponent=Number(e[1]);let o=this.coeff.split(".");this.wholes=o[0]||"",this.dec=o[1]||"";let{dec:h}=this;return this.decp=h==="0"?0:h.length,this}convert(t){let e=t.split("."),o=e[0]||"",h=e[1]||"";o=s.removeLeadingZeroes(o),h=s.removeTrailingZeroes(h);let y=o.length,L=o+h,C=s.leadingZeroes(L).length;this.exponent=y-(C+1);let D=s.removeLeadingZeroes(L);this.coeff=`${D.charAt(0)}.${s.removeTrailingZeroes(D.substr(1,D.length))||"0"}`;let G=this.coeff.split(".")[1]||"";return this.decp=G==="0"?0:G.length,this.dec=h,this.wholes=o,this}round(t){let e=this.copy();if(t=Number(t),t===0)e.coeff=e.coeff.charAt(0);else{let o=this.coeff.substring(0,t+1),h=this.coeff.substring(t+1,t+3),y=Number(h.charAt(0));Number(h.charAt(1))>4&&y++,e.coeff=o+y}return e}copy(){let t=new s(0);return t.coeff=this.coeff,t.exponent=this.exponent,t.sign=this.sign,t}toString(t){let e;if(Pn.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<t)this.decp===0&&this.wholes!==void 0?e=this.wholes:e=this.coeff;else{let o=typeof t>"u"?this.coeff:s.round(this.coeff,Math.min(t,this.decp||1)),h=this.exponent;o.startsWith("10.")&&(o=typeof t>"u"?o.replace(/^10\./u,"1.0"):s.round(o.replace(/^10\./u,"1.0"),Math.min(t,this.decp||1)),h=Number(h)+1),e=this.exponent===0?o:`${o}e${h}`}return(this.sign===-1?"-":"")+e}};te.classes.Scientific=D0;function Dt(s){return Array.isArray(s)}function Mt(s){return`(${s})`}function O1(s,t){return s<0==t<0}function qt(...s){return s.shift().replace(/\{(?<idx>\d+)\}/gu,(o,h)=>{let y=s[h];return typeof y=="function"?y():y})}function q1(s,t,e){let o=[];e||=1;for(let h=s;h<=t;h++)o.push(h*e);return o}function T1(s){return s?String(s):""}function R1(s,t,e,o){return s.substr(0,t)+o+s.substr(e,s.length)}function L1(s){return s!==void 0&&s.custom}function U1(s){return Math.max.apply(void 0,s)}function Mn(s){return Math.min.apply(void 0,s)}function Ut(s){return Number(s)%2===0}function mn(s){return 1/(s%1)%2===0}function An(s){let t=s.length,e=[];for(let o=0;o<t;o++){let h=s[o];e.indexOf(h)===-1&&e.push(h)}return e}function x1(s){return[].slice.call(s)}function mt(s){return typeof s=="number"?Number.isInteger(s):typeof s<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(s.toString())}function P1(s,t){if(s.sort(),t.sort(),s.length===t.length){for(let e=0;e<s.length;e++)if(s[e]!==t[e])return!1;return!0}return!1}function $1(s){let t=[],e=s.length;for(let o=0;o<e;o++)t[o]=s[o].clone();return t}function zn(s){return/^\d+\.?\d*$/u.test(String(s))}function m0(s,t=14){return mt(s)?Number(s)>=Number.MAX_VALUE?s.toString():Number(s):Math.round(s*10**t)/10**t}function D1(s,t){t||=20;let e=[],o,h,y;e.push(s[0]);for(let L=0;L<s.length-1;L++){o=s[L],h=s[L+1]-o,y=h/t;for(let C=0;C<t;C++)o+=y,e.push(o)}return e}function Wn(s,t){if(Dt(s)){let e=s.length;for(let o=0;o<e;o++)t.call(s,o)}else for(let e in s)Object.hasOwn(s,e)&&t.call(s,e)}function d0(s,t){let e;return Dt(s)?e=s.splice(t,1)[0]:(e=s[t],delete s[t]),e}function F1(s,t){let e={};return e[s]=t,e}function k1(s){for(let t=0;t<s.length;t++)if(!zn(s[t]))return!1;return!0}function F0(s){let t=Math.sign(s),e=Math.abs(s);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let h=String(e).toLowerCase().split("e"),y=h.pop(),L=Math.abs(Number(y)),C=Math.sign(Number(y)),D=h[0].split(".");if(C===-1)L-=D[0].length,L<0?e=`${D[0].slice(0,L)}.${D[0].slice(L)}${D.length===2?D[1]:""}`:e=`0.${new Array(L+1).join("0")}${D.join("")}`;else{let G=D[1];G&&(L-=G.length),L<0?e=`${D[0]+G.slice(0,L)}.${G.slice(L)}`:e=D.join("")+new Array(L+1).join("0")}}return t<0?`-${e}`:String(e)}function Q0(s){let t=s[0];for(let e=1,o=s.length;e<o;e++)if(!s[e].equals(t))return!1;return!0}function B1(s,t){typeof t!=="function"&&(t=function(h,y){return h===y});let o=[];for(;s.length;){let h=s[0];if(s.length===1){o.push(h);break}let y=[];o.push(h);for(let L=1;L<s.length;L++){let C=s[L];t(h,C)||y.push(C)}s=y}return o}function V1(s,t){let e=s.length,o=[];for(let L=0;L<s.length;L++)o.push([s[L],t[L]]);o.sort((L,C)=>Number(L[0])-Number(C[0]));let h=[],y=[];for(let L=0;L<e;L++)h.push(o[L][0]),y.push(o[L][1]);return[h,y]}function dn(s){return s instanceof t0}function Cn(s){return s instanceof g0}function J0(s,t,e){let h=Object.keys(s)[0];return t?h:e?{key:h,obj:s[h]}:s[h]}var{keys:bn}=Object,Y0={get N(){return te.groups.N},get P(){return te.groups.P},get S(){return te.groups.S},get EX(){return te.groups.EX},get FN(){return te.groups.FN},get PL(){return te.groups.PL},get CB(){return te.groups.CB},get CP(){return te.groups.CP}},Ct={get _(){return te.parser},get N(){return te.groups.N},get P(){return te.groups.P},get S(){return te.groups.S},get EX(){return te.groups.EX},get FN(){return te.groups.FN},get PL(){return te.groups.PL},get CB(){return te.groups.CB},get CP(){return te.groups.CP},get SQRT(){return te.fnNames.SQRT},get ABS(){return te.fnNames.ABS},get FACTORIAL(){return te.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return te.fnNames.DOUBLEFACTORIAL},get PARENTHESIS(){return te.fnNames.PARENTHESIS},get bigDec(){return te.ext.bigDec},get PRIMES(){return te.ext.PRIMES},get VARS(){return te.state.VARS}};function q0(s){return s.group===Y0.N||s.group===Y0.P}function Qn(s){return s.group===Y0.S&&s.multiplier.equals(1)&&s.power.equals(1)}function un(s){for(let t=0;t<s.length;t++)if(s[t].group!==Y0.N)return!1;return!0}var i0={get RESERVED(){return te.state.RESERVED}};function k0(s){let t=function(e){i0.RESERVED.indexOf(e)===-1&&i0.RESERVED.push(e)};typeof s=="string"?t(s):Wn(s,e=>{t(e)})}function X1(s){let t=i0.RESERVED.indexOf(s);t!==-1&&(i0.RESERVED[t]=void 0)}var $n={get ALLOW_CHARS(){return te.settings?.ALLOW_CHARS??[]},VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function w0(s,t="variable"){if($n.ALLOW_CHARS.indexOf(s)!==-1)return;if(!$n.VALIDATION_REGEX.test(s))throw new Hn(`${s} is not a valid ${t} name`)}function K0(s){return i0.RESERVED.indexOf(s)!==-1}var wn={get WARNINGS(){return te.state.WARNINGS},get SHOW_WARNINGS(){return!(te.settings?.SILENCE_WARNINGS??!0)}};function In(s){wn.WARNINGS.push(s),wn.SHOW_WARNINGS&&console&&console.warn&&console.warn(s)}function G1(){return wn.WARNINGS}var H1={get EXPRESSIONS(){return te.state.EXPRESSIONS}};function j1(){return H1.EXPRESSIONS.length}var Z1={get Settings(){return te.settings}};function z1(s){return Z1.Settings[s]}function W1(s){try{return w0(s),i0.RESERVED.indexOf(s)===-1}catch(t){if(t.message==="timeout")throw t;return!1}}function Q1(s){return s?i0.RESERVED:i0.RESERVED.join(", ")}var Jn={get _version(){return te.version},get C(){return te.core}};function J1(s){if(s)try{return Jn.C[s].version}catch(t){if(t.message==="timeout")throw t;return`No module named ${s} found!`}return te.version}function Y1(){return Jn.C}var K1={get functions(){return te.parser?.functions}};function ei(){return bn(K1.functions)}var ti={get CONSTANTS(){return te.parser?.CONSTANTS}};function ni(s){return String(ti.CONSTANTS[s])}var O0={get VARS(){return te.state.VARS}};function ii(s){return O0.VARS[s]}function ri(s,t){s||="text";let e={};if(s==="object")e=O0.VARS;else for(let o in O0.VARS)Object.hasOwn(O0.VARS,o)&&(s==="latex"?e[o]=O0.VARS[o].latex(t):s==="text"&&(e[o]=O0.VARS[o].text(t)));return e}var Zt={get _(){return te.parser},get C(){return te.core}};function si(s,t){return Zt._.toTeX(s,t)}function oi(s){return Zt._.getOperator(s)}function li(s,t){Zt._.aliasOperator(s,t)}function ai(s,t,e){Zt._.setOperator(s,t,e)}function ui(s,t){Zt._.peekers[s]&&Zt._.peekers[s].push(t)}function ci(s,t){let e=Zt._.peekers[s];if(e){let o=e.indexOf(t);o!==-1&&d0(e,o)}}function Yn(s){let t=Zt._.toRPN(Zt._.tokenize(s));return Zt._.tree(t)}function fi(s){return String(s).split(";").map(t=>Zt._.parse(t))}function pi(s){return Zt._.toRPN(Zt._.tokenize(s))}function hi(s,t){return`<div class="tree">
    <ul>
        <li>
${Yn(s).toHTML(3,t)}
        </li>
    </ul>
</div>`}function gi(s,t,e){let o=Zt._.functions[s],h=typeof e>"u"?o[1]:e;Zt._.functions[s]=[t(o[0],Zt.C),h]}var Qt={get EXPRESSIONS(){return te.state.EXPRESSIONS},get USER_FUNCTIONS(){return te.state.USER_FUNCTIONS},get LaTeX(){return te.classes.LaTeX},get text(){return te.utils.text},get functions(){return te.parser?.functions??{}},get Math2(){return te.classes.Math2},get _(){return te.parser},get Expression(){return te.classes.Expression}};function mi(s,t,e){let o=s?{}:[];for(let h=0;h<Qt.EXPRESSIONS.length;h++){let y=t?Qt.LaTeX.latex(Qt.EXPRESSIONS[h],e):Qt.text(Qt.EXPRESSIONS[h],e);s?o[h+1]=y:o.push(y)}return o}function di(s,t){let e=s?{}:[];for(let o=0;o<Qt.USER_FUNCTIONS.length;o++){let h,y,L=Qt.USER_FUNCTIONS[o],C=Qt.functions[L][2];if(C)({params:h,body:y}=C);else{let V=Qt.Math2[L].toString();[,h]=/\((?<params>.*?)\)/u.exec(V),h=h.split(",").map(B=>B.trim()),y="{JavaScript}"}let D=`${L}(${h.join(", ")})=${y}`,G=Qt.text(D,t);s?e[o+1]=G:e.push(G)}return e}function wi(s){s=s.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),s=s.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),s=s.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),s=s.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let t=Qt.LaTeX.parse(Qt._.tokenize(s));return new Qt.Expression(Qt._.parse(t))}var l0={get libExports(){return te.libExports},get VARS(){return te.state.VARS},get _clearFunctions(){return te.utils._clearFunctions},get _initConstants(){return te.parser?.initConstants??(()=>{})},get clear(){return Kn}};function Si(){for(let s in l0.VARS)Object.hasOwn(l0.VARS,s)&&delete l0.VARS[s];return l0.libExports}function vi(){return l0._clearFunctions(),l0.libExports}function Ni(){return l0.libExports}function yi(){return l0.clear("all"),l0.libExports}function Ei(s){return s.call(l0.libExports),l0.libExports}var cn={get libExports(){return te.libExports},get CONSTANTS(){return te.state.CONSTANTS}};function Mi(s,t){if(w0(s),!K0(s))if(t==="delete"||t==="")delete cn.CONSTANTS[s];else{if(isNaN(t))throw new En("Constant must be a number!");cn.CONSTANTS[s]=t}return cn.libExports}var b0={get libExports(){return te.libExports},get VARS(){return te.state.VARS},get CONSTANTS(){return te.state.CONSTANTS},get parse(){let{parser:s}=te;return s?.parse?.bind(s)??(()=>null)},get isSymbol(){return te.utils.isSymbol}};function Ai(s,t){return w0(s),s in b0.CONSTANTS&&Pt(`Cannot set value for constant ${s}`),t==="delete"||t===""?delete b0.VARS[s]:b0.VARS[s]=b0.isSymbol(t)?t:b0.parse(t),b0.libExports}var Dn={get libExports(){return te.libExports},get _setFunction(){return te.utils._setFunction}};function Ci(s,t,e){if(!Dn._setFunction(s,t,e))throw new Error("Failed to set function!");return Dn.libExports}var y0={get libExports(){return te.libExports},get EXPRESSIONS(){return te.state.EXPRESSIONS}};function Kn(s,t=!1){if(s==="all")y0.EXPRESSIONS.length=0;else if(s==="last")y0.EXPRESSIONS.pop();else if(s==="first")y0.EXPRESSIONS.shift();else{let e=s?s-1:y0.EXPRESSIONS.length;t===!0?y0.EXPRESSIONS[e]=void 0:d0(y0.EXPRESSIONS,e)}return y0.libExports}var Z0={get libExports(){return te.libExports},get Settings(){return te.settings},get functions(){return te.parser?.functions??{}}};function e1(s){let t=Z0.libExports.getCore();if(Dt(s))for(let e=0;e<s.length;e++)s&&e1(s[e]);else if(s&&Z0.Settings.exclude.indexOf(s.name)===-1){if(s.dependencies){for(let h=0;h<s.dependencies.length;h++)if(!t[s.dependencies[h]])throw new Error(qt("{0} requires {1} to be loaded!",s.name,s.dependencies[h]))}let e=s.parent,o=s.build.call(t);if(e){t[e]||(t[s.parent]={});let h=e==="nerdamer"?Z0.libExports:t[e];h[s.name]=o}s.visible&&(Z0.functions[s.name]=[o,s.numargs])}}var Wt={get bigDec(){return te.ext.bigDec},get Settings(){return te.settings},get functions(){return te.parser?.functions??{}},get symfunction(){return te.utils.symfunction},get NerdamerSymbol(){return te.classes.NerdamerSymbol}};function Sn(s,t){if(typeof s=="object"&&s!==null){let o=s;for(let h in o)Object.hasOwn(o,h)&&Sn(h,o[h])}["SAFE"].indexOf(s)!==-1&&Pt(`Cannot modify setting: ${s}`),s==="PRECISION"?(Wt.bigDec.set({precision:t}),Wt.Settings.PRECISION=t,t>21&&Sn("USE_BIG",!0)):s==="USE_LN"&&t===!0?(Wt.Settings.LOG="LN",Wt.Settings.LOG10="log",Wt.functions.log=Wt.Settings.LOG_FNS.log10,Wt.functions.log[0]=function(h){return h.isConstant()?new Wt.NerdamerSymbol(Math.log10(h)):Wt.symfunction(Wt.Settings.LOG10,[h])},Wt.functions.LN=Wt.Settings.LOG_FNS.log,delete Wt.functions.log10):Wt.Settings[s]=t}var I0={get libExports(){return te.libExports},get functions(){return te.parser?.functions??{}},get parse(){let{parser:s}=te;return s?.parse?.bind(s)??(()=>null)},get callfunction(){return te.utils.callfunction},get Expression(){return te.classes.Expression}};function bi(s=!1){let t=function(o){return function(...y){for(let L=0;L<y.length;L++)y[L]=I0.parse(y[L]);return new I0.Expression(Bt("PARSE2NUMBER",()=>I0.callfunction(o,y)))}};for(let e in I0.functions)(!(e in I0.libExports)||s)&&(I0.libExports[e]=t(e))}var Ii={get suppress_errors(){return te.settings?.suppress_errors??!1}};function Pt(s,t=void 0){if(!Ii.suppress_errors)throw t?new t(s):new Error(s)}var _i={get PRIMES_SET(){return te.ext.PRIMES_SET}};function $0(s){if(s in _i.PRIMES_SET)return!0;let t=Math.floor(Math.sqrt(s));for(let e=2;e<=t;e++)if(s%e===0)return!1;return!0}var A0={starttime:0,timeout:0,get TIMEOUT(){return te.settings?.TIMEOUT??800}};function t1(){A0.starttime=Date.now(),A0.timeout=A0.TIMEOUT}function n1(){A0.starttime=0}function en(){if(A0.starttime!==0&&Date.now()>A0.starttime+A0.timeout)throw new Error("timeout")}var M0={get PRIMES(){return te.ext.PRIMES},get PRIMES_SET(){return te.ext.PRIMES_SET}};function Oi(s){if(en(),$0(s))return[s];let t=s,e=1,o=[],h=2220446049250313e-31;for(;e<t;){en();let y=s/e,L=Math.floor(y);if(y-L<=h&&e>1){if($0(e)&&(M0.PRIMES_SET[e]||(M0.PRIMES.push(e),M0.PRIMES_SET[e]=!0),o.push(e)),$0(L)){o.push(L);break}t=L}e++}return o.sort((y,L)=>y-L)}function i1(s){let t=M0.PRIMES[M0.PRIMES.length-1]||2;for(let e=t;e<s;e++)$0(e)&&M0.PRIMES.push(e),M0.PRIMES_SET[e]=!0}var fn={get Settings(){return te.settings}};function Bt(s,t,e=void 0,o=void 0){let h=fn.Settings[s];fn.Settings[s]=e===void 0?!0:!!e;let y=t.call(o);return fn.Settings[s]=h,y}function Nt(s,t=void 0){return Bt("PARSE2NUMBER",()=>Ct._.parse(s,t),!0)}var wt={get EXPRESSIONS(){return te.state.EXPRESSIONS},get Settings(){return te.settings},get LaTeX(){return te.classes.LaTeX},get text(){return te.utils.text},get variables(){return te.utils.variables},get isVector(){return te.utils.isVector},get isSymbol(){return te.utils.isSymbol},get isExpression(){return te.utils.isExpression},get isNumericSymbol(){return te.utils.isNumericSymbol},get isFraction(){return te.utils.isFraction},get isArray(){return te.utils.isArray},get _(){return te.parser},get Build(){return te.classes.Build}},S0=class s{symbol;constructor(t){this.symbol=t}static getExpression(t,e=void 0){(t==="last"||!t)&&(t=wt.EXPRESSIONS.length),t==="first"&&(t=1);let o=Number(t)-1,h=wt.EXPRESSIONS[o];return h&&new s(h.symbol)}text(t="decimals",e=void 0){e||=wt.Settings.EXPRESSION_DECP;let o=this.symbol;return o.text_?o.text_(t):wt.text(this.symbol,t,void 0,e)}latex(t){return this.symbol.latex?this.symbol.latex(t):wt.LaTeX.latex(this.symbol,t)}valueOf(){return this.symbol.valueOf()}evaluate(...t){if(wt.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let e=t[0],o,h=1;typeof e=="string"?o=e.charAt(0)==="%"?s.getExpression(e.substr(1)).text():e:e instanceof s||wt.isSymbol(e)?o=e.text():(o=this.symbol.text(),h--);let y=t[h]||{};return new s(Bt("PARSE2NUMBER",()=>wt._.parse(o,y),!0))}buildFunction(t){return wt.Build.build(this.symbol,t)}isNumber(){return wt.isNumericSymbol(this.symbol)}isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0}isImaginary(){return Nt(wt._.parse(this.symbol)).isImaginary()}variables(){return wt.variables(this.symbol)}toString(){try{return wt.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(t){if(t.message==="timeout")throw t;return""}}toDecimal(t){wt.Settings.precision=t;let e=wt.text(this.symbol,"decimals");return wt.Settings.precision=void 0,e}isFraction(){return wt.isFraction(this.symbol)}isPolynomial(){return this.symbol.isPoly()}sub(t,e){return new s(this.symbol.sub(wt._.parse(t),wt._.parse(e)))}operation(t,e){let o;return wt.isExpression(e)?o=e.symbol:wt.isSymbol(e)?o=e:o=wt._.parse(e),new s(wt._[t](this.symbol.clone(),o.clone()))}add(t){return this.operation("add",t)}subtract(t){return this.operation("subtract",t)}multiply(t){return this.operation("multiply",t)}divide(t){return this.operation("divide",t)}pow(t){return this.operation("pow",t)}expand(){return new s(wt._.expand(this.symbol))}each(t,e){if(this.symbol.each)this.symbol.each(t,e);else if(wt.isArray(this.symbol))for(let o=0;o<this.symbol.length;o++)t.call(this.symbol,this.symbol[o],o);else t.call(this.symbol)}eq(t){wt.isSymbol(t)||(t=wt._.parse(t));try{return wt._.subtract(this.symbol.clone(),t).equals(0)}catch(e){if(e.message==="timeout")throw e;return!1}}lt(t){wt.isSymbol(t)||(t=wt._.parse(t));try{return Nt(wt._.subtract(this.symbol.clone(),t)).lessThan(0)}catch(e){if(e.message==="timeout")throw e;return!1}}gt(t){wt.isSymbol(t)||(t=wt._.parse(t));try{return Nt(wt._.subtract(this.symbol.clone(),t)).greaterThan(0)}catch(e){if(e.message==="timeout")throw e;return!1}}gte(t){return this.gt(t)||this.eq(t)}lte(t){return this.lt(t)||this.eq(t)}numerator(){return new s(this.symbol.getNum())}denominator(){return new s(this.symbol.getDenom())}hasFunction(t){return this.symbol.containsFunction(t)}contains(t){return this.symbol.contains(t)}toTeX(t){return this.latex(t)}};te.classes.Expression=S0;var ot={get _(){return te.parser},get Settings(){return te.settings},get LaTeX(){return te.classes.LaTeX},get NerdamerSymbol(){return te.classes.NerdamerSymbol}},It=class s{multiplier;elements;rowVector;custom=!0;constructor(t,...e){this.multiplier=new Fe(1),vt(t)?this.elements=t.elements?.slice(0)??[]:Dt(t)?this.elements=t.slice(0):St(t)?t.elements.length===1?(this.elements=[...t.elements[0]],this.rowVector=!0):t.elements.length>1&&Array.isArray(t.elements[0])&&t.elements[0].length===1&&(this.elements=t.elements.map(o=>o[0]),this.rowVector=!1):typeof t>"u"?this.elements=[]:this.elements=[t,...e]}static arrayPrefill(t,e){let o=[];e||=0;for(let h=0;h<t;h++)o[h]=e;return o}static fromArray(t){let e=new s;return e.elements=t,e}static fromSet(t){return s.fromArray(t.elements)}e(t){return t<1||t>this.elements.length?null:this.elements[t-1]}set(t,e){gt(e)?this.elements[t]=e:this.elements[t]=new ot.NerdamerSymbol(e)}dimensions(){return this.elements.length}modulus(){return Bt("SAFE",()=>ot._.pow(this.dot(this.clone()),new ot.NerdamerSymbol(.5)),void 0,this)}eql(t){let e=this.elements.length,o=t.elements||t;if(e!==o.length)return!1;do if(Math.abs(ot._.subtract(this.elements[e-1],o[e-1]).valueOf())>ot.Settings.PRECISION)return!1;while(--e);return!0}clone(){let t=new s,e=this.elements.length;for(let o=0;o<e;o++)t.elements.push(this.elements[o].clone());return t.rowVector=this.rowVector,t}expand(t){return this.elements=this.elements.map(e=>ot._.expand(e,t)),this}map(t){let e=[];return this.each((o,h)=>{e.push(t(o,h))}),new s(e)}each(t){let e=this.elements.length,o=e,h;do h=o-e,t(this.elements[h],h+1);while(--e)}toUnitVector(){return Bt("SAFE",()=>{let t=this.modulus();return t.valueOf()===0?this.clone():this.map(e=>ot._.divide(e,t))},void 0,this)}angleFrom(t){return Bt("SAFE",()=>{let e=t.elements||t;if(this.elements.length!==e.length)return null;let h=new ot.NerdamerSymbol(0),y=new ot.NerdamerSymbol(0),L=new ot.NerdamerSymbol(0);this.each((V,B)=>{h=ot._.add(h,ot._.multiply(V,e[B-1])),y=ot._.add(y,ot._.multiply(V,V)),L=ot._.add(L,ot._.multiply(e[B-1],e[B-1]))}),y=ot._.pow(y,new ot.NerdamerSymbol(.5)),L=ot._.pow(L,new ot.NerdamerSymbol(.5));let C=ot._.multiply(y,L);if(C.valueOf()===0)return null;let D=ot._.divide(h,C),G=D.valueOf();return G<-1&&(D=-1),G>1&&(D=1),new ot.NerdamerSymbol(Math.acos(D))},void 0,this)}isParallelTo(t){let e=this.angleFrom(t).valueOf();return e===null?null:e<=ot.Settings.PRECISION}isAntiparallelTo(t){let e=this.angleFrom(t).valueOf();return e===null?null:Math.abs(e-Math.PI)<=ot.Settings.PRECISION}isPerpendicularTo(t){let e=this.dot(t);return e===null?null:Math.abs(e)<=ot.Settings.PRECISION}add(t){return Bt("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((o,h)=>ot._.add(o,e[h-1]))},void 0,this)}subtract(t){return Bt("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((o,h)=>ot._.subtract(o,e[h-1]))},void 0,this)}multiply(t){return this.map(e=>ot._.multiply(e.clone(),t.clone()))}x(t){return this.multiply(t)}dot(t){return Bt("SAFE",()=>{let e=t.elements||t,o=new ot.NerdamerSymbol(0),h=this.elements.length;if(h!==e.length)return null;do o=ot._.add(o,ot._.multiply(this.elements[h-1],e[h-1]));while(--h);return o},void 0,this)}cross(t){let e=t.elements||t;if(this.elements.length!==3||e.length!==3)return null;let o=this.rowVector&&t.rowVector,h=this.elements;return Bt("SAFE",()=>{let y=new s([ot._.subtract(ot._.multiply(h[1],e[2]),ot._.multiply(h[2],e[1])),ot._.subtract(ot._.multiply(h[2],e[0]),ot._.multiply(h[0],e[2])),ot._.subtract(ot._.multiply(h[0],e[1]),ot._.multiply(h[1],e[0]))]);return y.rowVector=o,y},void 0,this)}toUnitMultiplier(){return this}max(){let t=0,e=this.elements.length,o=e,h;do{h=o-e;let y=this.elements[h],L=y.valueOf(),C=typeof t=="number"?t:t.valueOf();Math.abs(L)>Math.abs(C)&&(t=y)}while(--e);return t}magnitude(){let t=new ot.NerdamerSymbol(0);return this.each(e=>{t=ot._.add(t,ot._.pow(e,new ot.NerdamerSymbol(2)))}),ot._.sqrt(t)}indexOf(t){let e=null,o=this.elements.length,h=o,y;do y=h-o,e===null&&this.elements[y].valueOf()===t.valueOf()&&(e=y+1);while(--o);return e}text_(t,e){let o=Xt(this,e);return(this.rowVector?"[":"")+o+(this.rowVector?"]":"")}text(t,e){let o=Xt(this,e);return(this.rowVector?"[":"")+o+(this.rowVector?"]":"")}toString(){return this.text()}latex(t){let e=[];for(let o=0;o<this.elements.length;o++)e.push(ot.LaTeX.latex(this.elements[o],t));return`[${e.join(", ")}]`}};te.classes.Vector=It;var Lt={get _(){return te.parser},get LaTeX(){return te.classes.LaTeX},get NerdamerSymbol(){return te.classes.NerdamerSymbol}},xt=class s{multiplier;elements;custom=!0;constructor(...t){this.multiplier=new Fe(1);let e=t,o=e.length,h,y=[];if(St(e))for(h=0;h<o;h++)y.push(e[h].slice(0));else{let L,C,D;for(h=0;h<o;h++)L=e[h],vt(L)&&(L=L.elements),Dt(L)||(L=[L]),D=L.length,C&&C!==D&&Pt("Unable to create Matrix. Row dimensions do not match!"),y.push(L),C=D}this.elements=y}static identity(t){let e=new s;for(let o=0;o<t;o++){e.elements.push([]);for(let h=0;h<t;h++)e.set(o,h,o===h?new Lt.NerdamerSymbol(1):new Lt.NerdamerSymbol(0))}return e}static fromArray(t){return new s(...t)}static zeroMatrix(t,e){let o=new s;for(let h=0;h<t;h++)o.elements.push(It.arrayPrefill(e,new Lt.NerdamerSymbol(0)));return o}get(t,e){if(this.elements[t])return this.elements[t][e]}map(t,e){let o=new s;return this.each((h,y,L)=>{o.set(y,L,t.call(o,h),e)}),o}set(t,e,o,h){this.elements[t]||=[],h||gt(o)?this.elements[t][e]=o:this.elements[t][e]=new Lt.NerdamerSymbol(o)}cols(){return this.elements[0].length}rows(){return this.elements.length}row(t){return!t||t>this.cols()?[]:this.elements[t-1]}col(t){let e=this.rows(),o=[];if(t>this.cols()||!t)return o;for(let h=0;h<e;h++)o.push(this.elements[h][t-1]);return o}eachElement(t){let e=this.rows(),o=this.cols(),h,y;for(h=0;h<e;h++)for(y=0;y<o;y++)t.call(this,this.elements[h][y],h,y)}each(t){this.eachElement(t)}determinant(){if(!this.isSquare())return null;let t=this.toRightTriangular(),e=t.elements[0][0],o=t.elements.length-1,h=o,y;do y=h-o+1,e=Lt._.multiply(e,t.elements[y][y]);while(--o);return e}isSquare(){return this.elements.length===this.elements[0].length}isSingular(){let t=this.determinant();return this.isSquare()&&t!==null&&t.multiplier.equals(0)}augment(t){let e=this.rows(),o=t.rows();e!==o&&Pt("Cannot augment matrix. Rows don't match.");for(let h=0;h<e;h++)this.elements[h]=this.elements[h].concat(t.elements[h]);return this}clone(){let t=this.rows(),e=this.cols(),o=new s;for(let h=0;h<t;h++){o.elements[h]=[];for(let y=0;y<e;y++){let L=this.elements[h][y];o.elements[h][y]=gt(L)?L.clone():L}}return o}toUnitMultiplier(){return this}expand(t){return this.eachElement(e=>Lt._.expand(e,t)),this}evaluate(t){return this.eachElement(e=>Lt._.evaluate(e,t)),this}invert(){return this.isSquare()||Pt("Matrix is not square!"),Bt("SAFE",()=>{let t=this.elements.length,e=t,o,h,y=s.identity(t),L=this.augment(y).toRightTriangular(),C,D=L.elements[0].length,G,V,B,we=[],Ee;do{o=t-1,V=[],C=D,we[o]=[],B=L.elements[o][o];do G=D-C,Ee=Lt._.divide(L.elements[o][G],B.clone()),V.push(Ee),G>=e&&we[o].push(Ee);while(--C);for(L.elements[o]=V,h=0;h<o;h++){V=[],C=D;do G=D-C,V.push(Lt._.subtract(L.elements[h][G].clone(),Lt._.multiply(L.elements[o][G].clone(),L.elements[h][o].clone())));while(--C);L.elements[h]=V}}while(--t);return s.fromArray(we)},void 0,this)}toRightTriangular(){return Bt("SAFE",()=>{let t=this.clone(),e,o,h,y=this.elements.length,L=y,C,D,G=this.elements[0].length,V;do{if(C=L-y,o=t.elements[C][C],o.valueOf()===0){for(let B=C+1;B<L;B++)if(h=t.elements[B][C],h&&h.valueOf()!==0){e=[],D=G;do V=G-D,e.push(Lt._.add(t.elements[C][V].clone(),t.elements[B][V].clone()));while(--D);t.elements[C]=e;break}}if(o=t.elements[C][C],o.valueOf()!==0)for(let B=C+1;B<L;B++){let we=Lt._.divide(t.elements[B][C].clone(),t.elements[C][C].clone());e=[],D=G;do V=G-D,e.push(V<=C?new Lt.NerdamerSymbol(0):Lt._.subtract(t.elements[B][V].clone(),Lt._.multiply(t.elements[C][V].clone(),we.clone())));while(--D);t.elements[B]=e}}while(--y);return t},void 0,this)}transpose(){let t=this.elements.length,e=this.elements[0].length,o=new s,h=e,y,L,C;do{y=e-h,o.elements[y]=[],L=t;do C=t-L,o.elements[y][C]=this.elements[C][y].clone();while(--L)}while(--h);return o}canMultiplyFromLeft(t){let e=St(t)?t.elements.length:t.length;return this.elements[0].length===e}sameSize(t){return this.rows()===t.rows()&&this.cols()===t.cols()}multiply(t){return Bt("SAFE",()=>{let e=t.elements||t;if(!this.canMultiplyFromLeft(e)){let Me=t;if(this.sameSize(Me)){let ce=new s,pe=this.rows();for(let fe=0;fe<pe;fe++){let u=Lt._.multiply(new It(this.elements[fe]),new It(Me.elements[fe]));ce.elements[fe]=u.elements}return ce}return null}let o=this.elements.length,h=o,y,L,C=e[0].length,D,G=this.elements[0].length,V=[],B,we,Ee;do{y=h-o,V[y]=[],L=C;do{D=C-L,B=new Lt.NerdamerSymbol(0),we=G;do Ee=G-we,B=Lt._.add(B,Lt._.multiply(this.elements[y][Ee],e[Ee][D]));while(--we);V[y][D]=B}while(--L)}while(--o);return s.fromArray(V)},void 0,this)}add(t,e){let o=new s;return this.sameSize(t)&&this.eachElement((h,y,L)=>{let C=Lt._.add(h.clone(),t.elements[y][L].clone());e&&(C=e.call(o,C,h,t.elements[y][L])),o.set(y,L,C)}),o}subtract(t,e){let o=new s;return this.sameSize(t)&&this.eachElement((h,y,L)=>{let C=Lt._.subtract(h.clone(),t.elements[y][L].clone());e&&(C=e.call(o,C,h,t.elements[y][L])),o.set(y,L,C)}),o}negate(){return this.each(t=>t.negate()),this}toVector(){if(this.rows()===1||this.cols()===1){let t=new It;return t.elements=this.elements.flat(),t}return this}toString(t,e){let o=this.rows(),h=[];t=t===void 0?`
`:t;for(let y=0;y<o;y++)h.push(`[${this.elements[y].map(L=>{let C=e?L.multiplier.toDecimal():L.toString();return L===void 0?"":C}).join(",")}]`);return`matrix${Mt(h.join(","))}`}text(){return`matrix(${this.elements.map(t=>`[${t.join(",")}]`)})`}latex(t){let e=this.cols(),{elements:o}=this;return qt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let h=[];for(let y in o){if(!Object.hasOwn(o,y))continue;let L=[];for(let C=0;C<e;C++)L.push(Lt.LaTeX.latex(o[y][C],t));h.push(L.join(" & "))}return h.join(" \\cr ")})}};te.classes.Matrix=xt;var P0={get _(){return te.parser},get N(){return te.groups.N},get P(){return te.groups.P},get S(){return te.groups.S},get EX(){return te.groups.EX},get FN(){return te.groups.FN},get CB(){return te.groups.CB},get Math2(){return sn.Math2},get NerdamerSymbol(){return te.classes.NerdamerSymbol}},e0={dependencies:{},reformat:{},initDependencies(){let{Math2:s}=P0;this.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":s.gamma},gamma_incomplete:{"Math2.factorial":s.factorial},Li:{"Math2.Ei":s.Ei,"Math2.bigLog":s.bigLog,Frac:Fe},Ci:{"Math2.factorial":s.factorial},Ei:{"Math2.factorial":s.factorial},Si:{"Math2.factorial":s.factorial},Shi:{"Math2.factorial":s.factorial},Chi:{isInt:mt,nround:m0,"Math2.num_integrate":s.num_integrate},factor:{"Math2.ifactor":s.ifactor,NerdamerSymbol:P0.NerdamerSymbol},num_integrate:{"Math2.simpson":s.simpson,nround:m0},fib:{even:Ut}},this.reformat={diff(t,e){let o=t.args[1].toString(),h=`let f = ${e0.build(t.args[0].toString(),[o])};`,y=s.diff.toString();return!y.startsWith("function")&&!y.startsWith("(")&&!y.startsWith("async")&&(y=`function ${y}`),e[1]+=`let diff = ${y};`,e[1]+=h,[`diff(f)(${o})`,e]}}},getProperName(s){return{continuedFraction:"continuedFraction"}[s]||s},compileDependencies(s,t){let e=e0.dependencies[s],o=t&&t[1]?t[1]:"",h=t&&t[0]?t[0]:{};for(let y in e){if(typeof e[y]=="object")continue;let L=y.split("."),C=e[y];if(typeof C=="function"){let D=C.toString();!D.startsWith("function")&&!D.startsWith("(")&&!D.startsWith("async")&&(D=`function ${D}`),C=D}o+=`let ${L.length>1?L[1]:L[0]}=${C};`,h[y]=L.pop()}return[h,o]},getArgsDeps(s,t){let{args:e}=s,o=t,h=function(y){y.group===P0.FN&&(o=e0.compileDependencies(y.fname,o))};for(let y=0;y<e.length;y++)s.args[y].each(h);return o},build(s,t){let{_:e,FN:o,N:h,S:y,P:L,EX:C,CB:D,NerdamerSymbol:G}=P0;s=Bt("PARSE2NUMBER",()=>e.parse(s),!0);let V=n0(s),B=[],we=[{},""],Ee=function(pe,fe){pe.fname===""&&(pe=G.unwrapPARENS(pe)),fe||=[];let u=[],{group:Ne}=pe,_e="",xe=function(ge){let ve=ge===D?"*":"+",Ie=[];for(let i in pe.symbols){if(!Object.hasOwn(pe.symbols,i))continue;let a=pe.symbols[i],c=Ee(a,fe)[0];a.isComposite()&&(c=Mt(c)),Ie.push(c)}let le=Ie.join(ve);return le=le&&!pe.multiplier.equals(1)?Mt(le):le,le},ye=function(ge){let ve;if(ge in Math)ve=`Math.${ge}`;else{if(ge=e0.getProperName(ge),B.indexOf(ge)===-1){let Ie=P0.Math2[ge].toString();!Ie.startsWith("function")&&!Ie.startsWith("(")&&!Ie.startsWith("async")&&(Ie=`function ${Ie}`),fe.push(`let ${ge} = ${Ie}; `),B.push(ge)}ve=ge}return ve+=Mt(pe.args.map(Ie=>Ee(Ie,fe)[0]).join(",")),ve};Ne===h?u.push(pe.multiplier.toDecimal()):pe.multiplier.equals(-1)?_e="-":pe.multiplier.equals(1)||u.push(pe.multiplier.toDecimal());let $e;if(Ne===y||Ne===L)$e=pe.value;else if(Ne===o)if(we=e0.compileDependencies(pe.fname,we),we=e0.getArgsDeps(pe,we),e0.reformat[pe.fname]){let ge=e0.reformat[pe.fname](pe,we);we=ge[1],$e=ge[0]}else $e=ye(pe.fname);else if(Ne===C){let ge=pe.previousGroup;ge===h||ge===y?$e=pe.value:ge===o?($e=ye(pe.fname),we=e0.compileDependencies(pe.fname,we),we=e0.getArgsDeps(pe,we)):$e=xe(pe.previousGroup)}else $e=xe(pe.group);if(pe.group!==h&&!pe.power.equals(1)){let ge=Ee(e.parse(pe.power));fe.push(ge[1]),$e=`Math.pow${Mt(`${$e},${ge[0]}`)}`}return $e&&u.push(_e+$e),[u.join("*"),fe.join("").replace(/\n+\s+/gu," ")]};t&&(V=t);let Me=Ee(s);for(let pe in we[0]){if(!Object.hasOwn(we[0],pe))continue;let fe=we[0][pe];Me[1]=Me[1].replace(pe,fe),we[1]=we[1].replace(pe,fe)}return new Function(...V,`${(we[1]||"")+Me[1]} return ${Me[0]};`)}};te.classes.Build=e0;var s0={get _(){return te.parser},get Settings(){return te.settings},get SQRT(){return te.fnNames.SQRT},get ABS(){return te.fnNames.ABS},get PARENTHESIS(){return te.fnNames.PARENTHESIS},get FACTORIAL(){return te.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return te.fnNames.DOUBLEFACTORIAL},get N(){return te.groups.N},get P(){return te.groups.P},get S(){return te.groups.S},get EX(){return te.groups.EX},get FN(){return te.groups.FN},get CB(){return te.groups.CB},get CP(){return te.groups.CP},get Parser(){return te.classes.Parser}},yt={parser:null,space:"~",dot:" \\cdot ",latex(s,t){let{_:e,P:o,CB:h}=s0;if(s&&typeof s=="object"&&"clone"in s&&typeof s.clone=="function"&&(s=s.clone()),s instanceof e.classes.Collection&&(s=s.elements),Dt(s)){let ce=[];for(let pe=0;pe<s.length;pe++){let fe=s[pe];gt(fe)||(fe=e.parse(fe)),ce.push(this.latex(fe,t))}return this.brackets(ce.join(", "),"square")}if(St(s)){let ce=`\\begin{pmatrix}
`;for(let pe=0;pe<s.elements.length;pe++){let fe=[],u=s.elements[pe];for(let Ne=0;Ne<u.length;Ne++)fe.push(this.latex(u[Ne],t));ce+=fe.join(" & "),pe<s.elements.length-1&&(ce+=`\\\\
`)}return ce+="\\end{pmatrix}",ce}if(vt(s)){let ce="\\left[";for(let pe=0;pe<s.elements.length;pe++)ce+=`${this.latex(s.elements[pe],t)} ${pe===s.elements.length-1?"":",\\,"}`;return ce+="\\right]",ce}if(Cn(s)){let ce="\\{";for(let pe=0;pe<s.elements.length;pe++)ce+=`${this.latex(s.elements[pe],t)} ${pe===s.elements.length-1?"":",\\,"}`;return ce+="\\}",ce}s=s.clone();let y=t==="decimal"||t==="decimals",{power:L}=s,C=tn(L),D=s.multiplier.lessThan(0);if(s.group===o&&y){let ce=Number(s.value),pe=Number(s.power.toDecimal()),fe=Number(s.multiplier.toDecimal());return String(fe*ce**pe)}s.multiplier=s.multiplier.abs();let G;y?G=[String(s.multiplier.toDecimal()),""]:G=[s.multiplier.num,s.multiplier.den];let V=this.value(s,C,t,D),B;C&&L.negate(),y?(B=gt(L)?yt.latex(L,t):String(L.toDecimal()),String(B)==="1"&&(B="")):gt(L)?B=this.latex(L,t):B=this.formatFrac(L,!0);let we=["",""],Ee=C?1:0;return we[Ee]=B,((D?"-":"")+this.set(G,V,we,s.group===h)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(s,t,e,o){let{SQRT:h,ABS:y,PARENTHESIS:L,FACTORIAL:C,DOUBLEFACTORIAL:D,FN:G,S:V,P:B,N:we,CB:Ee,CP:Me,EX:ce}=s0,{group:pe}=s,{previousGroup:fe}=s,u=["",""],Ne=t?1:0;if(s.isInfinity)u[Ne]="\\infty";else if(pe===V||pe===B||fe===V||fe===B||fe===we){let _e=this.formatSubscripts(s.value);_e.replace&&(_e=_e.replace(/(?<prefix>.+)_$/u,"$1\\_"));let xe=String(_e).split("_"),ye=this.greek[xe[0]];ye&&(xe[0]=ye,_e=xe.join("_"));let $e=this.symbols[xe[0]];$e&&(xe[0]=$e,_e=xe.join("_")),u[Ne]=_e}else if(pe===G||fe===G){let _e=[],{fname:xe}=s;for(let ye=0;ye<s.args.length;ye++){let $e=s.args[ye],ge;typeof $e=="string"?ge=$e:ge=this.latex($e,e),_e.push(ge)}if(xe===h)u[Ne]=`\\sqrt${this.braces(_e.join(","))}`;else if(xe===y)u[Ne]=this.brackets(_e.join(","),"abs");else if(xe===L)u[Ne]=this.brackets(_e.join(","),"parens");else if(xe==="limit")u[Ne]=` \\lim\\limits_{${_e[1]} \\to ${_e[2]}} ${_e[0]}`;else if(xe==="integrate")u[Ne]=`\\int${this.braces(_e[0])}${this.braces(`d${_e[1]}`)}`;else if(xe==="defint")u[Ne]=`\\int\\limits_${this.braces(_e[1])}^${this.braces(_e[2])} ${_e[0]} d${_e[3]}`;else if(xe===C||xe===D){let ye=s.args[0];ye.power.equals(1)&&(ye.isComposite()||ye.isCombination())&&(_e[0]=this.brackets(_e[0])),u[Ne]=_e[0]+(xe===C?"!":"!!")}else if(xe==="floor")u[Ne]=`\\left \\lfloor${this.braces(_e[0])}\\right \\rfloor`;else if(xe==="ceil")u[Ne]=`\\left \\lceil${this.braces(_e[0])}\\right \\rceil`;else if(xe===s0.Settings.LOG&&_e.length>1)u[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces(_e[1])}${this.brackets(_e[0])}`;else if(xe===s0.Settings.LOG10)u[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("10")}${this.brackets(_e[0])}`;else if(xe===s0.Settings.LOG2)u[Ne]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("2")}${this.brackets(_e[0])}`;else if(xe===s0.Settings.LOG1P)u[Ne]=`\\ln${this.brackets(`1 + ${_e[0]}`)}`;else if(xe==="sum"){let ye=_e[0],$e=_e[1],ge=_e[2],ve=_e[3];u[Ne]=`\\sum\\limits_{${this.braces($e)}=${this.braces(ge)}}^${this.braces(ve)} ${this.braces(ye)}`}else if(xe==="product"){let ye=_e[0],$e=_e[1],ge=_e[2],ve=_e[3];u[Ne]=`\\prod\\limits_{${this.braces($e)}=${this.braces(ge)}}^${this.braces(ve)} ${this.braces(ye)}`}else if(xe==="nthroot")u[Ne]=`\\sqrt[${_e[1]}]${this.braces(_e[0])}`;else if(xe==="mod")u[Ne]=`${_e[0]} \\bmod ${_e[1]}`;else if(xe==="realpart")u[Ne]=`\\operatorname{Re}${this.brackets(_e[0])}`;else if(xe==="imagpart")u[Ne]=`\\operatorname{Im}${this.brackets(_e[0])}`;else{let ye=xe===""?"":`\\mathrm${this.braces(xe.replace(/_/gu,"\\_"))}`;s.isConversion?u[Ne]=ye+this.brackets(_e.join(""),"parens"):u[Ne]=ye+this.brackets(_e.join(","),"parens")}}else if(s.isComposite()){let _e=s.collectSymbols().sort(pe===Me||fe===Me?(ve,Ie)=>Ie.group-ve.group:(ve,Ie)=>{let le=gt(ve.power)?-1:Number(ve.power);return(gt(Ie.power)?-1:Number(Ie.power))-le}),xe=[],ye=_e.length;for(let ve=0;ve<ye;ve++)xe.push(yt.latex(_e[ve],e));let $e=xe.join("+"),ge=s;u[Ne]=!(ge.isLinear()&&ge.multiplier.equals(1))||o?this.brackets($e,"parens"):$e}else if(pe===Ee||fe===ce||fe===Ee){pe===Ee&&s.distributeExponent();let _e=[],xe=[],ye=[],$e=[],ge=0,ve=0,Ie=function(le,i,a){if(a>1&&i.length>0){let c=i.length;for(let S=0;S<c;S++){let w=i[S],N=le[w];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(N)||/^\\left\(.+\\right\)$/gu.test(N)||(le[w]=yt.brackets(N,"parens"))}}return le};s.each(le=>{let i=tn(le.power),a;i?(a=yt.latex(le.invert(),e),ve++,le.isComposite()&&(!s.multiplier.den.equals(1)&&Math.abs(Number(le.power))===1&&(a=yt.brackets(a,"parens")),ye.push(_e.length)),_e.push(a)):(a=yt.latex(le,e),ge++,le.isComposite()&&(!s.multiplier.num.equals(1)&&Math.abs(Number(le.power))===1&&(a=yt.brackets(a,"parens")),$e.push(xe.length)),xe.push(a))}),Ie(xe,$e,ge),u[0]=xe.join(this.dot),Ie(_e,ye,ve),u[1]=_e.join(this.dot)}return u},set(s,t,e,o){let h=function(we){return/^\\left\(.+\\right\)$/u.test(we)};e&&=this.formatP(e);let y;o&&(y=e[0],e[0]=""),t=this.merge(t,e);let L=s[0],C=s[1],D=t[0],G=t[1];D&&Number(L)===1&&(L=""),Number(C)===1&&(C="");let V=this.join(L,D,h(D)?"":this.dot),B=this.join(C,G,h(G)?"":this.dot);if(V&&B){let we=this.frac(V,B);return o&&y&&(we=this.brackets(we)+y),we}return V},merge(s,t){let e=[];for(let o=0;o<2;o++)e[o]=s[o]+t[o];return e},join(s,t,e){return!s&&!t?"":s&&!t?s:t&&!s?t:s+e+t},formatSubscripts(s){let t=s.toString().split("_"),e="";for(;t.length>1;)t.length>0&&(e=`_${this.braces(t.pop()+e)}`);return t[0]+e},formatP(s){for(let t=0;t<2;t++){let e=s[t];e&&(s[t]=`^${this.braces(e)}`)}return s},formatFrac(s,t){let e=s.num.toString(),o=s.den.toString();return t&&e==="1"&&o==="1"?"":o==="1"?e:this.frac(e,o)},frac(s,t){return`\\frac${this.braces(s)}${this.braces(t)}`},braces(s){return`{${s}}`},brackets(s,t){t||="parens";let o={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[t];return`\\left${o[0]}${s}\\right${o[1]}`},filterTokens(s){let t=[];Dt(s)&&(t.type=s.type);let e=["\\","left","right","big","Big","large","Large"];for(let o=0,h=s.length;o<h;o++){let y=s[o],L=s[o+1];y.value==="\\"&&L.value==="\\"?t.push(y):Dt(y)?t.push(yt.filterTokens(y)):e.indexOf(y.value)===-1&&t.push(y)}return t},parse(s){let{SQRT:t}=s0,e,o,h="",y=this.filterTokens(s),L={cdot:"",times:"",infty:"Infinity"},C=function(V){return y[typeof V>"u"?++e:e+=V]},D=function(){return yt.parse(C())},G=function(V){return V in L?L[V]:V==="*"&&y[e+1].value==="&"?(C(2),","):V==="&"?(C(),","):V==="\\"?"],[":V};for(e=0,o=y.length;e<o;e++){let V=y[e];if(V.value==="frac"){let B=D(),we=D();h+=`${B}/${we}`}else if(V.value in yt.symbols)if(V.value===t&&y[e+1].type==="vector"&&y[e+2].type==="NerdamerSet"){let B=D(),we=D();h+=`${we}^${Mt(`1/${B}`)}`}else h+=V.value+D();else if(V.value==="int"){let B=D();e++;let we=C().value;we=G(we.substring(1,we.length)),h+=`integrate${Mt(`${B},${we}`)}`}else if(V.value==="int_"){let B=D();e++;let we=C().value;we===void 0&&(e--,we=D());let Ee=D(),Me=C().value;Me===","&&(Me=C().value),Me==="differentialD"&&(e++,Me=C().value),Me==="mathrm"&&(e++,Me=C().value),h+=`defint${Mt(`${Ee},${B},${we},${Me}`)}`}else if(V.value&&V.value.startsWith("int_")){let B=V.value.replace("int_","");e++;let we=C().value;we===void 0&&(e--,we=D());let Ee=D(),Me=C().value;Me===","&&(Me=C().value),Me==="differentialD"&&(e++,Me=C().value),Me==="mathrm"&&(e++,Me=C().value),h+=`defint${Mt(`${Ee},${B},${we},${Me}`)}`}else if(V.value==="mathrm"){let B=y[++e][0].value;h+=B+D()}else if(V.value==="sum_"||V.value==="prod_"){let B=V.value==="sum_"?"sum":"product",we=C();e++;let Ee=D(),Me=D();h+=B+Mt([Me,G(we[0]),G(we[2]),G(Ee)].join(","))}else if(V.value==="lim_"){let B=C();h+=`limit${Mt([D(),G(B[0]),G(B[2])].join(","))}`}else if(V.value==="begin"){let B=C();Array.isArray(B)&&B[0].value==="matrix"&&(h+="matrix([")}else if(V.value==="end"){let B=C();Array.isArray(B)&&B[0].value==="matrix"&&(h+="])")}else Array.isArray(V)?h+=G(yt.parse(V)):h+=G(V.value.toString())}return Mt(h)},initParser(){let s=s0.Parser,t=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],e=new s;for(let h in e)t.indexOf(h)===-1&&delete e[h];e.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(h){return h}}),e.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(h){return h}});let o=e.getBrackets();o["{"].maps_to=void 0,this.parser=e}};te.classes.LaTeX=yt;var Fn={get LONG_PI(){return te.ext.LONG_PI},get LONG_E(){return te.ext.LONG_E}},Oe={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",get LONG_PI(){return Fn.LONG_PI},get LONG_E(){return Fn.LONG_E},PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800,initCache(){this.CACHE.roots={};let s=40,t=40;for(let e=2;e<=s;e++)for(let o=2;o<=t;o++){let h=Nn(e).pow(o);this.CACHE.roots[`${h}-${o}`]=e}}};Oe.CONST_HASH=te.fnNames.CONST_HASH;Oe.initCache();sn.Settings=Oe;var u0={get bigInt(){return te.ext.bigInt},get BIG_LOG_CACHE(){return te.ext.BIG_LOG_CACHE},get PRIMES(){return te.ext.PRIMES},get NerdamerSymbol(){return te.classes.NerdamerSymbol},get CB(){return te.groups.CB},get P(){return te.groups.P}},ut={csc(s){return 1/Math.sin(s)},sec(s){return 1/Math.cos(s)},cot(s){return 1/Math.tan(s)},acsc(s){return Math.asin(1/s)},asec(s){return Math.acos(1/s)},acot(s){return Math.PI/2-Math.atan(s)},erf(s){let t=1/(1+.5*Math.abs(s)),e=1-t*Math.exp(-s*s-1.26551223+t*(1.00002368+t*(.37409196+t*(.09678418+t*(-.18628806+t*(.27886807+t*(-1.13520398+t*(1.48851587+t*(-.82215223+t*.17087277)))))))));return s>=0?e:-e},diff(s){return function(o){return(s(o+.001)-s(o-.001))/.002}},median(...s){s.sort((e,o)=>e-o);let t=Math.floor(s.length/2);return s.length%2?s[t]:(s[t-1]+s[t])/2},fromContinued(s){let t=s.fractions.slice(),e=1/t.pop();for(let o=0,h=t.length;o<h;o++)e=1/(t.pop()+e);return s.sign*(s.whole+e)},continuedFraction(s,t){t||=20;let e=Math.sign(s),o=Math.abs(s),h=Math.floor(o),y=o-h,L=0,C=!1,D=1e-14,G=1e7,V,B,we={whole:h,sign:e,fractions:[]};for(;!C&&y!==0&&(V=1/y,B=Math.floor(V),!(B>G&&ut.fromContinued(we)-s<=Number.EPSILON));)we.fractions.push(B),y=V-B,(y<=D||L>=t-1)&&(C=!0),L++;let Ee=we.fractions.length-1;return we.fractions[Ee]===1&&(we.fractions.pop(),we.fractions[--Ee]++),we},bigpow(s,t){s instanceof Fe||(s=Fe.create(s)),t instanceof Fe||(t=Fe.create(t));let e=new Fe(0);if(t.isInteger())e.num=s.num.pow(t.toString()),e.den=s.den.pow(t.toString());else{let o=Fe.create(s.num**t.num),h=Fe.create(s.den**t.num);e.num=ut.nthroot(o,t.den.toString()),e.den=ut.nthroot(h,t.den)}return e},gamma(s){let e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(s<.5)return Math.PI/(Math.sin(Math.PI*s)*ut.gamma(1-s));s-=1;let o=e[0];for(let y=1;y<9;y++)o+=e[y]/(s+y);let h=s+7+.5;return Math.sqrt(2*Math.PI)*h**(s+.5)*Math.exp(-h)*o},bigfactorial(s){let t=new u0.bigInt(1);for(let e=2;e<=s;e++)t=t.times(e);return new Fe(t)},bigLog(s){let t=u0.BIG_LOG_CACHE;if(t[s])return Fe.quick.apply(null,t[s].split("/"));s=new Fe(s);let e=80,o=new Fe(0),h=s.subtract(new Fe(1)),y=s.add(new Fe(1));for(let L=0;L<e;L++){let C=new Fe(2*L+1),D=ut.bigpow(h.divide(y),C),G=C.clone().invert().multiply(D);o=o.add(G)}return o.multiply(new Fe(2))},factorial(s){let t=s%1===0;if(t&&s<0)return NaN;if(!t)return ut.gamma(s+1);let e=1;for(let o=2;o<=s;o++)e*=o;return e},dfactorial(s){let t=new Fe(1);if(mt(s)){let e=s%2===0,o=e?s/2:(s+1)/2;if(e)for(let h=1;h<=o;h++)t=t.multiply(new Fe(2).multiply(new Fe(h)));else for(let h=1;h<=o;h++)t=t.multiply(new Fe(2).multiply(new Fe(h)).subtract(new Fe(1)))}else t=2**((1+2*s-Math.cos(Math.PI*s))/4)*Math.PI**((Math.cos(Math.PI*s)-1)/4)*ut.gamma(1+s/2);return t},GCD(...s){let t=An(s.map(h=>Math.abs(h))).sort(),e=Math.abs(t.shift()),o=t.length;for(;o-- >0;){let h=Math.abs(t.shift());for(;;){if(e%=h,e===0){e=h;break}if(h%=e,h===0)break}}return e},QGCD(...s){let t=s[0];for(let e=1;e<s.length;e++){let o=s[e],h=t.isNegative()&&o.isNegative()?-1:1;t=o.gcd(t),h<0&&t.negate()}return t},LCM(s,t){return s*t/ut.GCD(s,t)},pow(s,t){return s<0&&Math.abs(t)<1?1/t%2===0?NaN:-(Math.abs(s)**t):s**t},factor(s){s=Number(s);let t=Math.sign(s);s=Math.abs(s);let e=ut.ifactor(s),o=new u0.NerdamerSymbol;o.symbols={},o.group=u0.CB;for(let h in e){if(!Object.hasOwn(e,h))continue;let y=new u0.NerdamerSymbol(1);y.group=u0.P,y.value=h;let L=new u0.NerdamerSymbol(e[h]);y.power=L,o.symbols[h]=y}return o.updateHash(),s===1&&(o=new u0.NerdamerSymbol(s)),t<0&&o.negate(),o},sfactor(s,t){t||={};let e=Math.floor(Math.sqrt(s)),{PRIMES:o}=u0,h=o[o.length-1];e>h&&s<1e6&&i1(e);let y=o.length;for(let L=0;L<y;L++){let C=o[L];for(;s%C===0;)s/=C,t[C]=(t[C]||0)+1}return s>1&&(t[s]=1),t},ifactor(s){let{bigInt:t}=u0,e=new t(s),o=new t(String(s));if(o.equals(0))return{0:1};let h=o.isNegative()?-1:1;o=o.abs();let y={};if(o.lt("65536"))y=ut.sfactor(o,y);else{let L=function(C){C.isPrime()?y[C]=(y[C]||0)+1:y=ut.sfactor(C,y)};try{let D={value:0},G=function(V,B,we){let Ee=new t(V),Me=2,ce=new t(V),pe=new t(1);for(;pe.equals(1);){for(let fe=0;fe<=Me&&pe.equals(1);fe++){if(we.value++>1e3)throw new Error("stopping");ce=ce.pow(2).add(1).mod(B),pe=t.gcd(ce.minus(Ee).abs(),B)}Me*=2,Ee=ce}return pe.equals(B)?G(V+1,B,we):pe};for(;!o.abs().equals(1);)if(o.isPrime()){L(o);break}else{let V=G(2,o,D);L(V),o=o.divide(V)}}catch(C){if(C.message==="timeout")throw C;y={},L(e)}}if(h===-1){let L=Mn(bn(y).map(Number));y[`-${L}`]=y[L],delete y[L]}return y},boxfactor(s,t){t||=200;let e,o,h=Math.floor(5/12*s),y=0,L=!1;for(;e=Math.floor(s/h),o=s%h,o!==0;){if(L)return[s,1];h=Math.max(o,h-o),y++,L=y>t}return[e,h,y]},fib(s){let t=Math.sign(s);s=Math.abs(s),t=Ut(s)?t:Math.abs(t);let e=0,o=1,h=1;for(let y=2;y<=s;y++)h=e+o,e=o,o=h;return h*t},mod(s,t){return s%t},integer_part(s){return Math.sign(s)*Math.floor(Math.abs(s))},simpson(s,t,e,o){let h=function(we,Ee,Me){let ce=we(Ee),pe=1e-12;return isNaN(ce)&&(ce=we(Me===1?Ee+pe:Ee-pe)),ce};o||=1e-4;let y=Math.abs(Math.floor((e-t)/o));y%2!==0&&y++;let L=(e-t)/y,C=h(s,t,1),D=!1,G=t+L,V,B;for(let we=1;we<y;we++)V=D?2:4,B=V*h(s,G,1),C+=B,D=!D,G+=L;return(C+h(s,G,2))*(L/3)},num_integrate(s,t,e,o,h){if(h<0)throw new Error("max depth cannot be negative");function y(D,G,V,B,we,Ee,Me,ce,pe,fe,u){if(u.nanEncountered)return NaN;let Ne=V-G,_e=D(G+Ne*.25),xe=D(V-Ne*.25);if(isNaN(_e)){u.nanEncountered=!0;return}if(isNaN(xe)){u.nanEncountered=!0;return}let ye=Ne*(B+4*_e+we)/12,$e=Ne*(we+4*xe+Ee)/12,ge=ye+$e,ve=(ge-Me)/15;if(u.maxDepthCount>1e3*pe)return;if(fe>pe)return u.maxDepthCount++,ge+ve;if(Math.abs(ve)<ce)return ge+ve;let Ie=G+Ne*.5,le=y(D,G,Ie,B,_e,we,ye,ce*.5,pe,fe+1,u);if(isNaN(le))return u.nanEncountered=!0,NaN;let i=y(D,Ie,V,we,xe,Ee,$e,ce*.5,pe,fe+1,u);return isNaN(i)?(u.nanEncountered=!0,NaN):le+i}function L(D,G,V,B,we){let Ee={maxDepthCount:0,nanEncountered:!1};B===void 0&&(B=1e-9),we===void 0&&(we=45);let Me=D(G),ce=D(.5*(G+V)),pe=D(V),fe=(Me+4*ce+pe)*(V-G)/6,u=y(D,G,V,Me,ce,pe,fe,B,we,1,Ee);if(Ee.maxDepthCount>0&&In(`integrate-adaptive-simpson: Warning: maximum recursion depth (${we}) reached ${Ee.maxDepthCount} times`),Ee.nanEncountered)throw new Error("Function does not converge over interval!");return u}let C;try{C=L(s,t,e,o,h)}catch(D){if(D.message==="timeout")throw D;return ut.simpson(s,t,e)}return m0(C,12)},Ci(s){let e=.5772156649015329,o=0;for(let h=1;h<20;h++){let y=2*h;o+=(-1)**h*s**y/(y*ut.factorial(y))}return Math.log(s)+e+o},Si(s){let e=0;for(let o=0;o<20;o++){let h=2*o;e+=(-1)**o*s**(h+1)/((h+1)*ut.factorial(h+1))}return e},Ei(s){if(Number(s)===0)return-1/0;let t=30,e=.5772156649015329,o=0;for(let h=1;h<t;h++)o+=s**h/(h*ut.factorial(h));return e+Math.abs(Math.log(s))+o},Shi(s){let e=0,o,h;for(let y=0;y<30;y++)o=2*y,h=o+1,e+=s**h/(h*h*ut.factorial(o));return e},Chi(s){let e=.5772156649015329,o=function(h){return(Math.cosh(h)-1)/h};return Math.log(s)+e+ut.num_integrate(o,.002,s,.001)},Li(s){return ut.Ei(ut.bigLog(s))},gamma_incomplete(s,t){let e=s-1,o=0,h=t||0;for(let y=0;y<e;y++)o+=h**y/ut.factorial(y);return ut.factorial(e)*Math.exp(-h)*o},step(s){return s>0?1:s<0?0:.5},rect(s){let t=Math.abs(s);return t===.5?t:t>.5?0:1},sinc(s){return s.equals(0)?1:Math.sin(s)/s},tri(s){return s=Math.abs(s),s>=1?0:1-s},nthroot(s,t){if(s instanceof Fe||(s=new Fe(s.toString())),t instanceof Fe||(t=new Fe(t.toString())),t.equals(1))return s;let e=s.divide(new Fe(2)),o=new Fe(1e-15),h,y,L,C=t.clone().invert(),D=t.subtract(new Fe(1));do{let G=ut.bigpow(e,D),V=C.multiply(s.divide(G).subtract(e)).toDecimal(25);if(h=Fe.create(V),L)break;e=e.add(h),V=h.toDecimal(),L=y?y===V:!1,y=V}while(h.abs().gte(o));return e},sqrt(s){s instanceof Fe||(s=new Fe(s));let t,e,o,h,y=0,L=!1,C=new Fe(1e-20);t=s.divide(new Fe(2));let D=1e3;do{if(y>D)throw new Error(`Unable to calculate square root for ${s}`);t=t.add(s.divide(t)).divide(new Fe(2)),t=new Fe(t.decimal(30)),e=s.subtract(t.multiply(t)),h=o?o.equals(e):!1,(e.clone().abs().lessThan(C)||h)&&(L=!0),o=e,y++}while(!L);return t}};Oe.FUNCTION_MODULES.push(ut);k0(ut);sn.Math2=ut;function gt(s){return s instanceof te.classes.NerdamerSymbol}function vt(s){return s instanceof It}function St(s){return s instanceof xt}function r1(s){return s instanceof S0}var o0={get EX(){return te.groups.EX},get CP(){return te.groups.CP},get CB(){return te.groups.CB},get S(){return te.groups.S},get PL(){return te.groups.PL},get FN(){return te.groups.FN}};function n0(s,t=null,e=null){if(e||={c:[],add(o){this.c.indexOf(o)===-1&&isNaN(o)&&this.c.push(o)}},gt(s)){let{group:o}=s,h=s.previousGroup;if(o===o0.EX&&n0(s.power,t,e),o===o0.CP||o===o0.CB||h===o0.CP||h===o0.CB)for(let y in s.symbols)Object.hasOwn(s.symbols,y)&&n0(s.symbols[y],t,e);else if(o===o0.S||h===o0.S)s.value==="e"||s.value==="pi"||s.value===Oe.IMAGINARY||e.add(s.value);else if(o===o0.PL||h===o0.PL)n0(J0(s.symbols),t,e);else if(o===o0.EX)isNaN(Number(s.value))||e.add(s.value),n0(s.power,t,e);else if(o===o0.FN&&!t&&s.args)for(let y=0;y<s.args.length;y++)n0(s.args[y],t,e)}return e.c.sort()}function qi(s,t,e){let o=[];s.each(h=>{let y,L;h.contains(t)?(y=h.stripVar(t),L=Ct._.divide(h.clone(),y.clone()).power.toDecimal()):(y=h,L=0);let C=o[L];o[L]=C?Ct._.add(C,y):y},!0);for(let h=0;h<o.length;h++)o[h]||=new te.classes.NerdamerSymbol(0);return o}var Gt={get _(){return te.parser},get FN(){return te.groups.FN},get P(){return te.groups.P},get N(){return te.groups.N},get NerdamerSymbol(){return te.classes.NerdamerSymbol}};function Ti(s){let t,e,o;if(s.group===Gt.FN&&s.fname===""?(t=Gt.NerdamerSymbol.unwrapPARENS(Gt._.parse(s).toLinear()),e=Gt._.parse(s.power)):s.group===Gt.P&&(t=Gt._.parse(s.value),e=Gt._.parse(s.power)),t&&e&&t.group===Gt.N&&e.group===Gt.N&&t.multiplier.isNegative()){o=[];let y=Gt.NerdamerSymbol.toPolarFormArray(Nt(s))[0],L=Gt._.arg(t),C=e.multiplier.den.toString(),D=e.multiplier.num.toString(),G="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let V=0;V<Number(C);V++){let B=Nt(Gt._.parse(qt("(({0})+2*pi*({1}))/({2})",L,V,C))).multiplier.toDecimal();o.push(Nt(Gt._.parse(qt(G,y,C,Oe.IMAGINARY,B,D))))}return It.fromArray(o)}if(s.isConstant(!0,!0)){let h=s.sign(),y=Nt(s.abs()),L=Gt._.sqrt(y);o=[L.clone(),L.negate()],h<0&&(o=o.map(C=>Gt._.multiply(C,Gt.NerdamerSymbol.imaginary())))}else o=[Gt._.parse(s)];return It.fromArray(o)}function Ri(s,t,e){let h={},y;for(let L=0;L<e.length;L++)h[e[L]]=new te.classes.NerdamerSymbol(Math.floor(Math.random()*5)+1);return Bt("PARSE2NUMBER",()=>{y=Ct._.parse(s,h).equals(Ct._.parse(t,h))}),y}function _n(s){return gt(s)?_n(s.multiplier.toDecimal()):Number(s)%1!==0}function Li(s,t){let e=new te.classes.NerdamerSymbol(0);for(let o=0;o<s.length;o++){let h=s[o];e=Ct._.add(e,gt(h)?h:Ct._.parse(h))}return t?Number(e):e}function kn(s){for(let t=0;t<s.length;t++)if(!(s[t].isPi()||s[t].isE())&&!s[t].isConstant(!0))return!1;return!0}function Ui(s,t){t||=s.length;for(let e=0;e<t;e++)s[e]||(s[e]=new te.classes.NerdamerSymbol(0));return s}function tn(s){return gt(s)?s.multiplier.lessThan(0):typeof s=="object"&&"lessThan"in s?s.lessThan(0):s<0}var E0={get _(){return te.parser},get S(){return te.groups.S},get FN(){return te.groups.FN},get EX(){return te.groups.EX},get ABS(){return te.fnNames.ABS}};function s1(s,t){s=E0._.expand(s),t||={};let e=function(o,h){t[o]||=new te.classes.NerdamerSymbol(0),t[o]=E0._.add(t[o],h.clone())};return s.each(o=>{o.isConstant("all")?e("constants",o):o.group===E0.S?e(o.value,o):o.group===E0.FN&&(o.fname===E0.ABS||o.fname==="")?s1(o.args[0]):o.group===E0.EX||o.group===E0.FN||e(n0(o).join(" "),o)}),t}var z0={get _(){return te.parser},get CP(){return te.groups.CP}};function o1(s,t,e){t=String(t);let o,h;if(s.group===z0.CP){let C=z0._.expand(s.clone()).stripVar(t);o=z0._.subtract(s.clone(),C.clone()),h=C}else o=s.clone();let y=o.stripVar(t),L=z0._.divide(o.clone(),y.clone());return h||=new te.classes.NerdamerSymbol(0),e?{a:y,x:L,ax:o,b:h}:[y,L,o,h]}function Bn(s,t,e){(t.isComposite()&&!s.isComposite()||t.isLinear()&&!s.isLinear())&&([s,t]=[t,s]);let o=new te.classes.NerdamerSymbol(0);return s.isLinear()?s.each(h=>{if(t.isComposite())t.isLinear()?t.each(y=>{let L=Ct._.multiply(Ct._.parse(h),Ct._.parse(y)),C=Ct._.expand(Ct._.parse(L),e);o=Ct._.add(o,C)},!0):o=Ct._.add(o,Ct._.multiply(h,Ct._.parse(t)));else{let y=Ct._.multiply(Ct._.parse(h),Ct._.parse(t));o=Ct._.add(o,Ct._.expand(y,e))}},!0):o=Ct._.multiply(s,t),o}function l1(s){if(Dt(s)){let t=new It([]);for(let e=0;e<s.length;e++)t.elements.push(l1(s[e]));return t}return gt(s)?s:Ct._.parse(s)}function xi(s){let t=n0(s[0],null,null);for(let e=1,o=s.length;e<o;e++)t=t.concat(n0(s[e]));return t=An(t).sort(),t}function Pi(s){let e="u",o=0,h=n0(s);for(;!(i0.RESERVED.indexOf(e)===-1&&h.indexOf(e)===-1);)e="u"+o++;for(let y=0,L=i0.RESERVED.length;y<=L;y++)if(!i0.RESERVED[y]){i0.RESERVED[y]=e;break}return e}var p0={get _(){return te.parser},get C(){return te.core},get USER_FUNCTIONS(){return te.state.USER_FUNCTIONS}};function On(s,t,e){if(!t){let o=typeof s;if(o==="string"){let h=s;if(!/:?=/u.test(h))return!1;let y=Oe.FUNCTION_REGEX.exec(h);if(!y)return!1;let[,L,C,D]=y;s=L,t=C.split(",").map(G=>G.trim()),e=D}else if(o==="function"){let h=s,y=h.name;return w0(y),K0(y)?!1:(p0.C.Math2[y]=h,p0._.functions[y]=[void 0,h.length],p0.USER_FUNCTIONS.includes(y)||p0.USER_FUNCTIONS.push(y),!0)}else return!1}return s=s.trim(),w0(s),K0(s)?!1:(t||=n0(p0._.parse(e)),t=t.map(o=>o.trim()),p0._.functions[s]=[p0._.mappedFunction,t.length,{name:s,params:t,body:e}],p0.USER_FUNCTIONS.includes(s)||p0.USER_FUNCTIONS.push(s),!0)}var pn={get _(){return te.parser},get C(){return te.core},get USER_FUNCTIONS(){return te.state.USER_FUNCTIONS}};function $i(){for(let s of pn.USER_FUNCTIONS)delete pn.C.Math2[s],delete pn._.functions[s]}function Di(){let s={};for(let t in Ct._.functions)Object.hasOwn(Ct._.functions,t)&&(s[t]=Ct._.functions[t][0]);return s}var Et={get bigInt(){return te.ext.bigInt},get isSymbol(){return te.utils.isSymbol},get isVector(){return te.utils.isVector},get N(){return te.groups.N},get P(){return te.groups.P},get S(){return te.groups.S},get FN(){return te.groups.FN},get PL(){return te.groups.PL},get CB(){return te.groups.CB},get CP(){return te.groups.CP},get EX(){return te.groups.EX},get CUSTOM_OPERATORS(){return te.state.CUSTOM_OPERATORS}};function Xt(s,t=void 0,e=void 0,o=void 0){let h=t==="hash",y,L=h?void 0:t,C=L==="decimal"||L==="decimals"||L==="decimals_or_scientific";L==="decimals_or_scientific"&&typeof o>"u"&&(o=Oe.DEFAULT_DECP);function D(G,V){switch(t){case"decimals":case"decimal":return y||=function(B){return!1},V?G.toDecimal(V):G.valueOf();case"recurring":{y||=function(ye){return ye.indexOf("'")!==-1};let B=G.toString(),we=/^-?\d+(?:\/\d+)?$/u.exec(B);if(we.length===0)return B;let Ee=we[0].split("/"),Me=!1,ce=Number(Ee[0]);ce<0&&(ce=-ce,Me=!0);let pe=Number(Ee[1]);pe||=1;let fe=Math.floor(ce/pe),u=10*(ce-fe*pe);for(fe=`${fe.toString()}.`;u&&u<pe;)u*=10,fe+="0";let Ne="",_e=[],xe=0;for(;;){if(typeof _e[u]<"u"){let ge=Ne.slice(0,_e[u]),ve=Ne.slice(_e[u]),Ie=`${fe+ge}'${ve}'`;return(Me?"-":"")+Ie.replace("'0'","").replace(/\.$/u,"")}let ye=Math.floor(u/pe),$e=u-ye*pe;_e[u]=xe,Ne+=ye.toString(),xe+=1,u=10*$e}}case"mixed":{y||=function(_e){return _e.indexOf("/")!==-1};let B=G.toString(),we=/^-?\d+(?:\/\d+)?$/u.exec(B);if(we.length===0)return B;let Ee=we[0].split("/"),Me=new Et.bigInt(Ee[0]),ce=new Et.bigInt(Ee[1]);ce.equals(0)&&(ce=new Et.bigInt(1));let pe=Me.divmod(ce),{quotient:fe}=pe,{remainder:u}=pe,Ne=Ee[0][0]==="-"||fe.equals(0)||u.equals(0)?"":"+";return(fe.equals(0)?"":fe.toString())+Ne+(u.equals(0)?"":`${u.toString()}/${Ee[1]}`)}case"scientific":return y||=function(B){return!1},new D0(G.valueOf()).toString(Oe.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{y||=function(Ee){return!1};let B=G.valueOf(),we=new D0(B);return Math.abs(we.exponent)>=Oe.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?we.toString(Oe.SCIENTIFIC_MAX_DECIMAL_PLACES):V?G.toDecimal(V):B}default:return y||=function(B){return B.indexOf("/")!==-1},G.toString()}}if(Et.isSymbol(s)){let G="",V="",B="",we=s.group||e,{value:Ee}=s;if(!h){let u=D(s.multiplier);String(u)==="-1"&&String(s.multiplier)==="-1"&&(B="-",u="1"),String(u)!=="1"&&(G=u);let Ne=s.power?D(s.power):"";String(Ne)!=="1"&&(gt(Ne)?V=Xt(Ne,L):V=Ne)}switch(we){case Et.N:{G="";let u;L==="decimals_or_scientific"?u=D(s.multiplier,o):o&&C?u=s.multiplier.toDecimal(o):u=D(s.multiplier),Ee=String(s.multiplier)==="-1"?"1":u,V="";break}case Et.PL:Ee=s.collectSymbols().map(u=>{let Ne=Xt(u,L,e,o);return Ne==="0"&&(Ne=""),Ne}).sort().join("+").replace(/\+-/gu,"-");break;case Et.CP:Ee=s.collectSymbols().map(u=>{let Ne=Xt(u,L,e,o);return Ne==="0"&&(Ne=""),Ne}).sort().join("+").replace(/\+-/gu,"-");break;case Et.CB:Ee=s.collectSymbols(u=>{let Ne=u.group;return(Ne===Et.PL||Ne===Et.CP)&&u.power.equals(1)&&u.multiplier.equals(1)?Mt(Xt(u,L)):Xt(u,L)}).join("*");break;case Et.EX:{let u=s.previousGroup,Ne=s.power.group;u===Et.PL&&(Ee=s.collectSymbols(Xt,L).join("+").replace("+-","-")),!(u===Et.N||u===Et.S||u===Et.FN)&&!h&&(Ee=Mt(Ee)),(Ne===Et.CP||Ne===Et.CB||Ne===Et.PL||s.power.multiplier.toString()!=="1")&&V&&(V=Mt(V));break}}if(we===Et.FN&&(Ee=s.fname+Mt(s.args.map(u=>Xt(u,L)).join(","))),we===Et.FN&&s.fname in Et.CUSTOM_OPERATORS){let u=Xt(s.args[0]),Ne=Xt(s.args[1]);s.args[0].isComposite()&&(u=Mt(u)),s.args[1].isComposite()&&(Ne=Mt(Ne)),Ee=u+Et.CUSTOM_OPERATORS[s.fname]+Ne}let Me=typeof y=="function"?y(V):!1;if(V&&we!==Et.EX&&Me&&(V=Mt(V)),((we===Et.CP||we===Et.PL)&&(G&&String(G)!=="1"||B==="-")||(we===Et.CB||we===Et.CP||we===Et.PL)&&V&&String(V)!=="1"||!h&&we===Et.P&&String(Ee)==="-1"||s.fname===Oe.PARENTHESIS)&&(Ee=Mt(Ee)),o&&(t==="decimal"||(t==="decimals"||t==="decimals_or_scientific")&&G))if(G.toString().includes("e")){if(t!=="decimals_or_scientific"){let u=Number(G),Ne=u.toExponential(),_e=u.toPrecision(o);G=Ne.length<_e.length?Ne:_e}}else G=m0(Number(G),o);let ce=B+G,pe=typeof y=="function"?y(G):!1;if(G&&pe&&(ce=Mt(ce)),Number(V)<0&&(V=Mt(V)),G&&(ce=`${ce}*`),V){if(Ee==="e"&&Oe.E_TO_EXP)return`${ce}exp${Mt(V)}`;V=Oe.POWER_OPERATOR+V}we===Et.EX&&Ee.charAt(0)==="-"&&(Ee=Mt(Ee));let fe=ce+Ee;return s.parens&&(fe=Mt(fe)),fe+V}if(Et.isVector(s)){let G=s.elements.length,V=[];for(let B=0;B<G;B++)V.push(s.elements[B].text(t));return`[${V.join(",")}]`}try{return s.toString()}catch(G){if(G.message==="timeout")throw G;return""}}var ue={get bigDec(){return te.ext.bigDec},get bigInt(){return te.ext.bigInt},get _(){return te.parser},get N(){return te.groups.N},get P(){return te.groups.P},get S(){return te.groups.S},get FN(){return te.groups.FN},get PL(){return te.groups.PL},get CB(){return te.groups.CB},get CP(){return te.groups.CP},get EX(){return te.groups.EX},get CONST_HASH(){return te.fnNames.CONST_HASH},get isSymbol(){return te.utils.isSymbol},get text(){return te.utils.text},get variables(){return te.utils.variables},get SQRT(){return te.fnNames.SQRT},get PARENTHESIS(){return te.fnNames.PARENTHESIS}},z=class s{group;value;multiplier;power;args=void 0;fname=void 0;isImgSymbol=void 0;imaginary=void 0;isInfinity=void 0;constructor(t){en();let e=t==="Infinity";typeof t=="object"&&t!==null&&t instanceof ue.bigDec&&(t=t.toString());let o=String(t);/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(o)||typeof t=="object"&&t!==null&&t instanceof ue.bigDec?(this.group=ue.N,this.value=ue.CONST_HASH,this.multiplier=new Fe(t)):(this.group=ue.S,w0(t),this.value=t,this.multiplier=new Fe(1),this.imaginary=t===Oe.IMAGINARY,this.isInfinity=e),this.power=new Fe(1)}static imaginary(){let t=new s(Oe.IMAGINARY);return t.imaginary=!0,t}static infinity(t=void 0){let e=new s("Infinity");return t===-1&&e.negate(),e}static shell(t,e){let o=new s(e);return o.group=t,o.symbols={},o.length=0,o}static unwrapSQRT(t,e){let o=t.power;if(t.fname===Oe.SQRT&&(t.isLinear()||e)){let h=t.args[0].clone();h.power=h.power.multiply(new Fe(1/2)),h.multiplier=h.multiplier.multiply(t.multiplier),t=h,e&&(t.power=o.multiply(new Fe(1/2)))}return t}static hyp(t,e){t||=new s(0),e||=new s(0);let{_:o}=ue;return o.sqrt(o.add(o.pow(t.clone(),new s(2)),o.pow(e.clone(),new s(2))))}static toPolarFormArray(t){let e=t.realpart(),o=t.imagpart(),h=s.hyp(e,o),y=e.equals(0)?ue._.parse("pi/2"):ue._.trig.atan(ue._.divide(o,e));return[h,y]}static unwrapPARENS(t){if(t.fname===""){let e=t.args[0];return e.power=e.power.multiply(t.power),e.multiplier=e.multiplier.multiply(t.multiplier),t.fname===""?s.unwrapPARENS(e):e}return t}static create(t,e){e=e===void 0?1:e;let{_:o}=ue;return o.parse(`(${t})^(${e})`)}pushMinus(){let{_:t}=ue,e=this;if((this.group===ue.CB||this.group===ue.CP||this.group===ue.PL)&&this.multiplier.lessThan(0)&&!Ut(this.power)){e=this.clone();let o=e.multiplier.clone();o.negate(),e.toUnitMultiplier();for(let h in e.symbols)if(Object.hasOwn(e.symbols,h)&&(e.symbols[h]=e.symbols[h].clone().negate(),e.group===ue.CB))break;e.length>0&&e.each(h=>h.pushMinus()),e=t.parse(e),e=t.multiply(t.parse(o),e)}return e}getNth(t){let{_:e}=ue,o=e.parse(String(t)),h=Nt(e.pow(e.parse(this.multiplier),o.clone().invert())),y=e.parse(m0(h));return Nt(e.pow(y,o.clone())).equals(e.parse(this.multiplier))?y:h}isToNth(t){let{_:e}=ue,o=this.getNth(t),h=mt(o.multiplier.toDecimal()),y;return this.group===ue.CB?(y=!0,this.each(L=>{L.isToNth(t)||(y=!1)})):y=this.group===ue.N?!0:mt(e.divide(e.parse(this.power),e.parse(t))),h&&y}isSquare(){return this.isToNth(2)}isCube(){return this.isToNth(3)}isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)}powSimp(){let{_:t}=ue;if(this.group===ue.CB){let e=[],o=this.multiplier.sign();if(this.each(B=>{let we=B.power;ue.isSymbol(we)||we.equals(1)||e.push(we)}),e.length===0)return this.clone();let h=new Fe(Mn(e)),y=this.multiplier.clone().abs(),L=ut.ifactor(y.valueOf()),C=new Fe(1),D=new Fe(1);for(let B in L){if(!Object.hasOwn(L,B))continue;let we=new Fe(L[B]);we.lessThan(h)||(we=we.divide(h).subtract(new Fe(1)),D=D.multiply(new Fe(B))),C=C.multiply(t.parse(`${Mt(B)}^${Mt(we)}`).multiplier)}let G=new s(D);this.each(B=>{B=B.clone(),B.power=B.power.divide(h),G=t.multiply(G,B)});let V=t.symfunction(ue.PARENTHESIS,[G]);return V.power=h,V.multiplier=o<0?C.negate():C,V}return this.clone()}equals(t){let e;return ue.isSymbol(t)?e=t:e=new s(t),this.value===e.value&&this.power.equals(e.power)&&this.multiplier.equals(e.multiplier)&&this.group===e.group}abs(){let t=this.clone();return t.multiplier.abs(),t}gt(t){ue.isSymbol(t)||(t=new s(t));let e=t;return this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)}gte(t){ue.isSymbol(t)||(t=new s(t));let e=t;return this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)}lt(t){ue.isSymbol(t)||(t=new s(t));let e=t;return this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)}lte(t){ue.isSymbol(t)||(t=new s(t));let e=t;return this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)}isPoly(t=!1){let e=this.group,o=this.power;if(!mt(o)||Number(o)<0)return!1;if(e===ue.N||e===ue.S||this.isConstant(!0))return!0;let h=ue.variables(this);if(e===ue.CB&&h.length===1){let y=h[0];if(!y)return!0;for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let C=this.symbols[L];if(C.group===ue.FN&&!C.args[0].isConstant()||!C.contains(y)&&!C.isConstant(!0))return!1}return!0}if(this.isComposite()||e===ue.CB&&t){if(!t&&h.length>1)return!1;for(let y in this.symbols)if(!this.symbols[y].isPoly(t))return!1;return!0}return!1}stripVar(t,e=!1){let{_:o}=ue,h;return(this.group===ue.PL||this.group===ue.S)&&this.value===t?h=new s(e?0:this.multiplier):this.group===ue.CB&&this.isLinear()?(h=new s(1),this.each(y=>{y.contains(t,!0)||(h=o.multiply(h,y.clone()))}),h.multiplier=h.multiplier.multiply(this.multiplier)):this.group===ue.CP&&!this.isLinear()?h=new s(this.multiplier):this.group===ue.CP&&this.isLinear()?(h=new s(0),this.each(y=>{if(!y.contains(t)){let L=y.clone();L.multiplier=L.multiplier.multiply(this.multiplier),h=o.add(h,L)}}),h.equals(0)&&(h=new s(this.multiplier))):this.group===ue.EX&&this.power.contains(t,!0)?h=new s(this.multiplier):this.group===ue.FN&&this.contains(t)?h=new s(this.multiplier):h=this.clone(),h}toArray(t,e){let{_:o}=ue;e||={arr:[],add(y,L){let C=this.arr[L];this.arr[L]=C?o.add(C,y):y}};let h=this.group;if(h===ue.S&&this.contains(t))e.add(new s(this.multiplier),this.power);else if(h===ue.CB){let y=this.stripVar(t),L=o.divide(this.clone(),y.clone()),C=L.isConstant()?0:L.power;e.add(y,C)}else if(h===ue.PL&&this.value===t)this.each((y,L)=>{e.add(y.stripVar(t),L)});else if(h===ue.CP)this.each(y=>{y.toArray(t,e)});else{if(this.contains(t))throw new En("Cannot convert to array! Exiting");e.add(this.clone(),0)}e=e.arr;for(let y=0;y<e.length;y++)e[y]||=new s(0);return e}hasFunc(t){let e=this.group===ue.FN||this.group===ue.EX;if(e&&!t||e&&this.contains(t))return!0;if(this.symbols){for(let o in this.symbols)if(this.symbols[o].hasFunc(t))return!0}return!1}sub(t,e){let{_:o}=ue;t=ue.isSymbol(t)?t.clone():o.parse(t),e=ue.isSymbol(e)?e.clone():o.parse(e),(t.group===ue.N||t.group===ue.P)&&Pt("Cannot substitute a number. Must be a variable");let h=!1,y=t.multiplier.equals(1),L=this.multiplier.clone(),C;if(this.value===t.value&&(this.group!==ue.PL&&t.group!==ue.PL||this.group===ue.PL&&t.group===ue.PL))(y||t.multiplier.equals(this.multiplier))&&(t.isLinear()?C=e:t.power.equals(this.power)&&(C=e,h=!0),t.multiplier.equals(this.multiplier)&&(L=new Fe(1)));else if(this.group===ue.CB||this.previousGroup===ue.CB)C=new s(1),this.each(D=>{let G=o.parse(D.sub(t,e));C=o.multiply(C,G)});else if(this.isComposite()){let D=this.clone();if(t.isComposite()&&D.isComposite()&&D.isLinear()&&t.isLinear()){let G=function(V,B){for(let we in V.symbols){if(!Object.hasOwn(V.symbols,we))continue;let Ee=V.symbols[we];if(Ee.isComposite()&&G(Ee,B)||Ee.equals(B))return!0}return!1};for(let V in t.symbols)if(Object.hasOwn(t.symbols,V)&&!G(D,t.symbols[V]))return D.clone();C=o.add(o.subtract(D.clone(),t),e)}else C=new s(0),D.each(G=>{C=o.add(C,G.sub(t,e))})}else if(this.group===ue.EX)C=o.parse(this.value).sub(t,e);else if(this.group===ue.FN){let D=[];for(let G=0;G<this.args.length;G++){let V=this.args[G];ue.isSymbol(V)||(V=o.parse(V)),D.push(V.sub(t,e))}C=o.symfunction(this.fname,D)}if(C){if(!h){let D=this.group===ue.EX?this.power.sub(t,e):o.parse(this.power);C=o.pow(C,D)}return C.multiplier=C.multiplier.multiply(L),C}return this.clone()}isMonomial(){if(this.group===ue.S)return!0;if(this.group===ue.CB){for(let t in this.symbols)if(this.symbols[t].group!==ue.S)return!1}else return!1;return!0}isPi(){return this.group===ue.S&&this.value==="pi"}sign(){return this.multiplier.sign()}isE(){return this.value==="e"}isSQRT(){return this.fname===ue.SQRT}isConstant(t,e){if(e&&this.group===ue.CB){for(let o in this.symbols)if(this.symbols[o].isConstant(!0))return!0}if(t==="functions"&&this.isComposite()){let o=!0;return this.each(h=>{h.isConstant(t,e)||(o=!1)},!0),o}if(t==="all"&&(this.isPi()||this.isE()))return!0;if(t&&this.group===ue.FN){for(let o=0;o<this.args.length;o++)if(!this.args[o].isConstant(t))return!1;return!0}return t?q0(this):this.value===ue.CONST_HASH}isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let t in this.symbols)if(this.symbols[t].isImaginary())return!0}return!1}realpart(){let{_:t}=ue;if(this.isConstant())return this.clone();if(this.imaginary)return new s(0);if(this.isComposite()){let e=new s(0);return this.each(o=>{e=t.add(e,o.realpart())}),e}return this.isImaginary()?new s(0):this.clone()}imagpart(){let{_:t}=ue;if(this.group===ue.S&&this.isImaginary()){let e=this;return this.power.isNegative()&&(e=this.clone(),e.power.negate(),e.multiplier.negate()),new s(e.multiplier)}if(this.isComposite()){let e=new s(0);return this.each(o=>{e=t.add(e,o.imagpart())}),e}return this.group===ue.CB?this.stripVar(Oe.IMAGINARY):new s(0)}isInteger(){return this.isConstant()&&this.multiplier.isInteger()}isLinear(t){if(t){if(this.isConstant()||!this.contains(t,!0))return!0;if(this.group===ue.S)return this.value===t?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let e in this.symbols)if(!this.symbols[e].isLinear(t))return!1;return!0}return this.group===ue.CB?this.symbols[t]?this.symbols[t].isLinear(t):!0:!1}return this.power.equals(1)}containsFunction(t){if(typeof t=="string"&&(t=[t]),this.group===ue.FN&&t.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let e in this.symbols)if(this.symbols[e].containsFunction(t))return!0}return!1}multiplyPower(t){let{_:e}=ue;if(this.group===ue.N&&this.multiplier.equals(1))return this;let o=this.power;if(this.group!==ue.EX&&ue.isSymbol(t)&&t.group===ue.N){let h=t.multiplier;this.group===ue.N&&!h.isInteger()&&this.convert(ue.P),this.power=o.equals(1)?h.clone():o.multiply(h),this.group===ue.P&&mt(this.power)&&(this.value=String(Number(this.value)**Number(this.power)),this.toLinear(),this.convert(ue.N))}else{this.group!==ue.EX&&(o=new s(o),this.convert(ue.EX));let h=e.multiply(o,t);this.power=h}return this}setPower(t,e=!1){if(this.group===ue.N&&this.multiplier.equals(1))return this;if(this.group===ue.EX&&!ue.isSymbol(t))this.group=this.previousGroup,delete this.previousGroup,this.group===ue.N?(this.multiplier=new Fe(this.value),this.value=ue.CONST_HASH):this.power=t;else{let o=!1;ue.isSymbol(t)&&(t.group===ue.N?t=t.multiplier:o=!0);let h=o?ue.EX:ue.P;this.power=t,this.group===ue.N&&h&&this.convert(h,e)}return this}isInverse(){return this.group===ue.EX?this.power.multiplier.lessThan(0):Number(this.power)<0}clone(t=void 0){let e=this,o=t||new s(0),h=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],y=h.length,L;if(e.symbols){o.symbols={};for(let G in e.symbols)Object.hasOwn(e.symbols,G)&&(o.symbols[G]=e.symbols[G].clone())}for(L=0;L<y;L++)e[h[L]]!==void 0&&(o[h[L]]=e[h[L]]);o.power=e.power.clone(),o.multiplier=e.multiplier.clone();let C=e,D=o;return C.isConversion&&(D.isConversion=C.isConversion),C.isUnit&&(D.isUnit=C.isUnit),o}toUnitMultiplier(t=!1){return this.multiplier.num=new ue.bigInt(this.multiplier.num.isNegative()&&t?-1:1),this.multiplier.den=new ue.bigInt(1),this}toLinear(){return this.power.equals(1)?this:(this.setPower(new Fe(1)),this)}each(t,e=!1){if(this.symbols)for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let h=this.symbols[o];if(h.group===ue.PL&&e)for(let y in h.symbols)Object.hasOwn(h.symbols,y)&&t.call(o,h.symbols[y],y);else t.call(this,h,o)}else t.call(this,this,this.value)}valueOf(){return this.group===ue.N?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:ue.text(this,"decimals")}contains(t,e=!1){t=String(t);let o=this.group;if(this.value===t)return!0;if(this.symbols){for(let h in this.symbols)if(this.symbols[h].contains(t,e))return!0}if(o===ue.FN||this.previousGroup===ue.FN){for(let h=0;h<this.args.length;h++)if(this.args[h].contains(t,e))return!0}return o===ue.EX&&(e&&this.power.contains(t,e)||this.value===t)?!0:this.value===t}negate(){return this.multiplier.negate(),(this.group===ue.CP||this.group===ue.PL)&&this.distributeMultiplier(),this}invert(t=!1,e=!1){return t||(this.multiplier=this.multiplier.invert()),ue.isSymbol(this.power)?this.power.negate():this.group===ue.CB&&e?this.each(o=>o.invert()):this.power&&this.group!==ue.N&&this.power.negate(),this}distributeMultiplier(t=!1){let e=t?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&e&&this.group!==ue.CB&&!this.multiplier.equals(1)){for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let h=this.symbols[o];h.multiplier=h.multiplier.multiply(this.multiplier),h.distributeMultiplier()}this.toUnitMultiplier()}return this}distributeExponent(){let{_:t}=ue;if(!this.power.equals(1)){let e=this.power;for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let h=this.symbols[o];h.group===ue.EX?h.power=t.multiply(h.power,new s(e)):ue.isSymbol(this.symbols[o].power)?this.symbols[o].power=t.multiply(this.symbols[o].power,new s(e)):this.symbols[o].power=this.symbols[o].power.multiply(e)}this.toLinear()}return this}convert(t,e=void 0){if(t>ue.FN){let o=this.clone();this.symbols={},t===ue.CB?o.toUnitMultiplier():this.toUnitMultiplier(),this.group===ue.FN&&(o.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[o.keyForGroup(t)]=o,this.group=t,this.length=1}else if(t===ue.EX)this.group===ue.N&&this.multiplier.equals(1)||(this.group!==ue.EX&&(this.previousGroup=this.group),this.group===ue.N?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=ue.text(this,"hash"),this.group=ue.EX);else if(t===ue.N){let o=this.multiplier.toDecimal();this.symbols&&=void 0,new s(this.group===ue.P?Number(o)*Number(this.value)**Number(this.power):o).clone(this)}else t===ue.P&&this.group===ue.N&&(this.value=e?this.multiplier.num.toString():String(Math.abs(Number(this.multiplier.num.toString()))),this.toUnitMultiplier(!e),this.group=ue.P);return this}insert(t,e){let{_:o}=ue;if(ue.isSymbol(t)||Pt(`Object ${t} is not of type NerdamerSymbol!`),this.symbols){let{group:h}=this;if(h>ue.FN){let y=t.keyForGroup(h),L=y in this.symbols?this.symbols[y]:!1;if(e==="add"){let C=y;L?(this.symbols[C]=o.add(L,t),this.symbols[C].multiplier.equals(0)&&(delete this.symbols[C],this.length--,this.length===0&&(this.convert(ue.N),this.multiplier=new Fe(0)))):(this.symbols[y]=t,this.length++)}else t.group===ue.P&&mt(t.power)&&t.convert(ue.N),t.group===ue.EX?(t.parens=t.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(t.multiplier.clone().abs()),t.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(t.multiplier),t.toUnitMultiplier()),L&&(t=o.multiply(d0(this.symbols,y),t),t.isConstant()&&(this.multiplier=this.multiplier.multiply(t.multiplier),t=new s(1)),this.length--),t.isOne(!0)?t.multiplier.lessThan(0)&&this.negate():(this.symbols[y]=t,this.length++);this.length===0&&this.convert(ue.N),(this.group===ue.CP||this.group===ue.CB)&&this.updateHash()}}return this}attach(t){if(Dt(t)){for(let e=0;e<t.length;e++)this.insert(t[e],"add");return this}return this.insert(t,"add")}combine(t){if(Dt(t)){for(let e=0;e<t.length;e++)this.insert(t[e],"multiply");return this}return this.insert(t,"multiply")}updateHash(){if(this.group!==ue.N)if(this.group===ue.FN){let t="",{args:e}=this,o=this.fname===ue.PARENTHESIS;for(let y=0;y<e.length;y++)t+=(y===0?"":",")+ue.text(e[y]);let h=o?"":this.fname;this.value=h+(o?t:Mt(t))}else this.group===ue.S||this.group===ue.PL||(this.value=ue.text(this,"hash"))}keyForGroup(t){let e=this.group,o;if(e===ue.N)o=this.value;else if(e===ue.S||e===ue.P)t===ue.PL?o=this.power.toDecimal():o=this.value;else if(e===ue.FN)t===ue.PL?o=this.power.toDecimal():o=ue.text(this,"hash");else{if(e===ue.PL)return t===ue.CB?o=ue.text(this,"hash"):t===ue.CP?this.power.equals(1)?o=this.value:o=Mt(ue.text(this,"hash"))+Oe.POWER_OPERATOR+this.power.toDecimal():t===ue.PL?o=this.power.toString():o=this.value,o;e===ue.CP?(t===ue.CP&&(o=ue.text(this,"hash")),t===ue.PL?o=this.power.toDecimal():o=this.value):e===ue.CB?t===ue.PL?o=this.power.toDecimal():o=ue.text(this,"hash"):e===ue.EX&&(t===ue.PL?o=ue.text(this.power):o=ue.text(this,"hash"))}return o}collectSymbols(t,e,o,h){let y=[];if(this.symbols)for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let C=this.symbols[L];h&&(C.group===ue.PL||C.group===ue.CP)?y=y.concat(C.collectSymbols()):y.push(t?t(C,e):C)}else y.push(this);return o===null&&(o=void 0),y.sort(o)}collectSummandSymbols(t,e,o,h){let y=[];if(!this.symbols||this.group===ue.CB)y.push(this);else for(let L in this.symbols){if(!Object.hasOwn(this.symbols,L))continue;let C=this.symbols[L];h&&(C.group===ue.PL||C.group===ue.CP)?y=y.concat(C.collectSymbols()):y.push(t?t(C,e):C)}return o===null&&(o=void 0),y.sort(o)}latex(t){return yt.latex(this,t)}text(t=void 0){return ue.text(this,t)}isOne(t=!1){let e=t?"absEquals":"equals";return this.group===ue.N?this.multiplier[e](1):this.power.equals(0)}isComposite(){let t=this.group,e=this.previousGroup;return t===ue.CP||t===ue.PL||e===ue.PL||e===ue.CP}isCombination(){let t=this.group,e=this.previousGroup;return t===ue.CB||e===ue.CB}lessThan(t){return this.multiplier.lessThan(t)}greaterThan(t){return ue.isSymbol(t)||(t=new s(t)),!this.isConstant(!0)||!t.isConstant(!0)?!1:this.multiplier.greaterThan(t.multiplier)}getDenom(){let{_:t}=ue,e,o;if(o=this.clone(),this.group===ue.CB&&this.power.lessThan(0)&&(o=t.expand(o)),o.power.lessThan(0)||o.group===ue.EX&&o.power.multiplier.lessThan(0)){let h=t.parse(o.multiplier.den);e=o.toUnitMultiplier(),e.power.negate(),e=t.multiply(h,e)}else if(o.group===ue.CB){e=t.parse(o.multiplier.den);for(let h in o.symbols){if(!Object.hasOwn(o.symbols,h))continue;let y=o.symbols[h];(Number(y.power)<0||y.group===ue.EX&&y.power.multiplier.lessThan(0))&&(e=t.multiply(e,o.symbols[h].clone().invert()))}}else e=t.parse(o.multiplier.den);return e}getNum(){let{_:t}=ue,e,o;return o=this.clone(),o.group===ue.CB&&o.power.lessThan(0)&&(o=t.expand(o)),o.power.greaterThan(0)&&o.group!==ue.CB||o.group===ue.EX&&o.power.multiplier.greaterThan(0)?e=t.multiply(t.parse(o.multiplier.num),o.toUnitMultiplier()):o.group===ue.CB?(e=t.parse(o.multiplier.num),o.each(h=>{(Number(h.power)>0||h.group===ue.EX&&h.power.multiplier.greaterThan(0))&&(e=t.multiply(e,h.clone()))})):e=t.parse(o.multiplier.num),e}toString(){return this.text()}};te.classes.NerdamerSymbol=z;var nn=class{constructor(){let{N:t,P:e,S:o,EX:h,FN:y,PL:L,CB:C,CP:D}=Ct,{SQRT:G,ABS:V,FACTORIAL:B,DOUBLEFACTORIAL:we,PARENTHESIS:Ee}=Ct,{bigDec:Me,PRIMES:ce,VARS:pe}=Ct,fe=this,u=fe,Ne={},_e={names:[],actions:[]};class xe{upper;lower;constructor(r,l){this.upper=r,this.lower=l}isConstant(){let r=this.upper,l=this.lower;return r.isConstant()&&l.isConstant()}text(){return`${Xt(this.upper)}:${Xt(this.lower)}`}}class ye{static OPERATOR="OPERATOR";static VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL";static FUNCTION="FUNCTION";static UNIT="UNIT";static KEYWORD="KEYWORD";static MAX_PRECEDENCE=999;constructor(r,l,v){if(this.type=l,this.value=r,v!==void 0&&(this.column=v+1),l===ye.OPERATOR){let m=Ie[r];for(let q in m)Object.hasOwn(m,q)&&(this[q]=m[q])}else l===ye.FUNCTION&&(this.precedence=ye.MAX_PRECEDENCE,this.leftAssoc=!1)}toString(){return this.is_prefix?`\`${this.value}`:this.value}}this.classes={Collection:t0,Slice:xe,Token:ye};let $e={prec:void 0,cos(n,r){let l=u.parse(String(Math.cos(n)*Math.cosh(r))),v=u.parse(String(Math.sin(n)*Math.sinh(r)));return u.subtract(l,u.multiply(v,z.imaginary()))},sin(n,r){let l=u.parse(String(Math.sin(n)*Math.cosh(r))),v=u.parse(String(Math.cos(n)*Math.sinh(r)));return u.subtract(l,u.multiply(v,z.imaginary()))},tan(n,r){let l=u.parse(String(Math.sin(2*n)/(Math.cos(2*n)+Math.cosh(2*r)))),v=u.parse(String(Math.sinh(2*r)/(Math.cos(2*n)+Math.cosh(2*r))));return u.add(l,u.multiply(v,z.imaginary()))},sec(n,r){let l=this.removeDen(this.cos(n,r));return u.subtract(l[0],u.multiply(l[1],z.imaginary()))},csc(n,r){let l=this.removeDen(this.sin(n,r));return u.add(l[0],u.multiply(l[1],z.imaginary()))},cot(n,r){let l=this.removeDen(this.tan(n,r));return u.subtract(l[0],u.multiply(l[1],z.imaginary()))},acos(n,r){let l=this.fromArray([n,r]),v=u.pow(l.clone(),new z(2)),m=u.expand(v),q=u.multiply(He(u.subtract(new z(1),m)),z.imaginary()),M=u.expand(u.add(l.clone(),q)),I=X(M);return u.expand(u.multiply(z.imaginary().negate(),I))},asin(n,r){return u.subtract(u.parse("pi/2"),this.acos(n,r))},atan(n,r){if(n.equals(0)&&(r.equals(1)||r.equals(-1)))return u.parse(`${z.infinity()}*${Oe.IMAGINARY}*${r}`);let l=$e.fromArray([n,r]),v=u.expand(u.multiply(z.imaginary(),l.clone())),m=X(u.expand(u.subtract(new z(1),v.clone()))),q=X(u.expand(u.add(new z(1),v.clone())));return u.expand(u.multiply(u.divide(z.imaginary(),new z(2)),u.subtract(m,q)))},asec(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.acos(...l)},acsc(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.asin(...l)},acot(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.atan(...l)},cosh(n,r){let l=u.parse(String(Math.cosh(n)*Math.cos(r))),v=u.parse(String(Math.sinh(n)*Math.sin(r)));return u.add(l,u.multiply(v,z.imaginary()))},sinh(n,r){let l=u.parse(String(Math.sinh(n)*Math.cos(r))),v=u.parse(String(Math.cosh(n)*Math.sin(r)));return u.add(l,u.multiply(v,z.imaginary()))},tanh(n,r){let l=u.parse(String(Math.sinh(2*n)/(Math.cos(2*r)+Math.cosh(2*n)))),v=u.parse(String(Math.sin(2*r)/(Math.cos(2*r)+Math.cosh(2*n))));return u.subtract(l,u.multiply(v,z.imaginary()))},sech(n,r){let l=this.removeDen(this.cosh(n,r));return u.subtract(l[0],u.multiply(l[1],z.imaginary()))},csch(n,r){let l=this.removeDen(this.sinh(n,r));return u.subtract(l[0],u.multiply(l[1],z.imaginary()))},coth(n,r){let l=this.removeDen(this.tanh(n,r));return u.add(l[0],u.multiply(l[1],z.imaginary()))},acosh(n,r){let l=this.fromArray([n,r]),v=He(u.add(l.clone(),new z(1))),m=He(u.subtract(l.clone(),new z(1)));return u.expand(X(u.add(l,u.expand(u.multiply(v,m)))))},asinh(n,r){let l=this.fromArray([n,r]),v=He(u.add(new z(1),u.expand(u.pow(l.clone(),new z(2)))));return u.expand(X(u.add(l,v)))},atanh(n,r){let l=this.fromArray([n,r]),v=X(u.add(l.clone(),new z(1))),m=X(u.subtract(new z(1),l));return u.expand(u.divide(u.subtract(v,m),new z(2)))},asech(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.acosh(...l)},acsch(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.asinh(...l)},acoth(n,r){let l=this.removeDen([n,r]);return l[1].negate(),this.atanh(...l)},sqrt(n){let r=n.realpart(),l=n.imagpart(),v=z.hyp(r,l),m=u.add(r.clone(),v),q=He(u.multiply(new z(2),m.clone()));return u.add(u.divide(m.clone(),q.clone()),u.multiply(u.divide(l,q),z.imaginary()))},log(n,r){let l=X(z.hyp(n,r)),v=Oe.USE_BIG?new z(Me.atan2(r.multiplier.toDecimal(),n.multiplier.toDecimal())):Math.atan2(r,n),m=u.parse(v);return u.add(l,u.multiply(z.imaginary(),m))},erf(n,r){return u.symfunction("erf",[n])},removeDen(n){let r,l;Dt(n)?(r=n[0],l=n[1]):(r=n.realpart(),l=n.imagpart());let v=r**2+l**2,m=u.parse(String(r/v)),q=u.parse(String(l/v));return[m,q]},fromArray(n){return u.add(n[0],u.multiply(z.imaginary(),n[1]))},evaluate(n,r){let l,v,m=n.power.sign();if(n.power=n.power.abs(),n.power.greaterThan(1)&&(n=u.expand(n)),m<0){let q=this.removeDen(n);l=q[0],v=q[1]}else l=n.realpart(),v=n.imagpart();return l.isConstant("all")&&v.isConstant("all")?this[r](l,v):u.symfunction(r,[n])}},ge=this.trig={cos(n){if(n.equals("pi")&&n.multiplier.den.equals(2))return new z(0);if(Oe.PARSE2NUMBER){if(n.equals(new z(Oe.PI/2)))return new z(0);if(n.isConstant())return Oe.USE_BIG?new z(Me.cos(n.multiplier.toDecimal())):new z(Math.cos(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"cos")}if(n.equals(0))return new z(1);let r,l=!1,v=Q(n.multiplier.toDecimal()),m=n.multiplier.abs();if(n.multiplier=m,n.isPi()&&n.isLinear())if(mt(m))r=new z(Ut(m)?1:-1);else{let q=Number(m.num),M=Number(m.den);M===2?r=new z(0):M===3?(r=u.parse("1/2"),l=!0):M===4?(r=u.parse("1/sqrt(2)"),l=!0):M===6?(r=u.parse("sqrt(3)/2"),l=!0):r=u.symfunction("cos",[n])}return l&&(v===2||v===3)&&r.negate(),r||=u.symfunction("cos",[n]),r},sin(n){if(Oe.PARSE2NUMBER){if(n.isConstant())return Number(n.multiplier.toDecimal())%Math.PI===0?new z(0):Oe.USE_BIG?new z(Me.sin(n.multiplier.toDecimal())):new z(Math.sin(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"sin")}if(n.equals(0))return new z(0);let r,l=!1,v=Q(n.multiplier.toDecimal()),m=n.multiplier.sign(),q=n.multiplier.abs();if(n.multiplier=q,n.equals("pi"))r=new z(0);else if(n.isPi()&&n.isLinear())if(mt(q))r=new z(0);else{let M=q.num,I=q.den;I.equals(2)?(r=new z(1),l=!0):I.equals(3)?(r=u.parse("sqrt(3)/2"),l=!0):I.equals(4)?(r=u.parse("1/sqrt(2)"),l=!0):I.equals(6)?(r=u.parse("1/2"),l=!0):r=u.multiply(new z(m),u.symfunction("sin",[n]))}return r||=u.multiply(new z(m),u.symfunction("sin",[n])),l&&(v===3||v===4)&&r.negate(),r},tan(n){if(Oe.PARSE2NUMBER){if(Number(n.multiplier.toDecimal())%Math.PI===0&&n.isLinear())return new z(0);if(n.isConstant())return Oe.USE_BIG?new z(Me.tan(n.multiplier.toDecimal())):new z(Math.tan(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"tan")}let r,l=!1,v=Q(n.multiplier.toDecimal()),m=n.multiplier;if(n.multiplier=m,n.isPi()&&n.isLinear())if(mt(m))r=new z(0);else{let q=m.num,M=m.den;if(M.equals(2))throw new Ht(`tan is undefined for ${n.toString()}`);M.equals(3)?(r=u.parse("sqrt(3)"),l=!0):M.equals(4)?(r=new z(1),l=!0):M.equals(6)?(r=u.parse("1/sqrt(3)"),l=!0):r=u.symfunction("tan",[n])}return r||=u.symfunction("tan",[n]),l&&(v===2||v===4)&&r.negate(),r},sec(n){if(Oe.PARSE2NUMBER)return n.isConstant()?Oe.USE_BIG?new z(new Me(1).dividedBy(Me.cos(n.multiplier.toDecimal()))):new z(ut.sec(n.valueOf())):n.isImaginary()?$e.evaluate(n,"sec"):u.parse(qt("1/cos({0})",n));let r,l=!1,v=Q(n.multiplier.toDecimal()),m=n.multiplier.abs();if(n.multiplier=m,n.isPi()&&n.isLinear())if(mt(m))r=new z(Ut(m)?1:-1);else{let q=m.num,M=m.den;if(M.equals(2))throw new Ht(`sec is undefined for ${n.toString()}`);M.equals(3)?(r=new z(2),l=!0):M.equals(4)?(r=u.parse("sqrt(2)"),l=!0):M.equals(6)?(r=u.parse("2/sqrt(3)"),l=!0):r=u.symfunction("sec",[n])}return l&&(v===2||v===3)&&r.negate(),r||=u.symfunction("sec",[n]),r},csc(n){if(Oe.PARSE2NUMBER)return n.isConstant()?Oe.USE_BIG?new z(new Me(1).dividedBy(Me.sin(n.multiplier.toDecimal()))):new z(ut.csc(n.valueOf())):n.isImaginary()?$e.evaluate(n,"csc"):u.parse(qt("1/sin({0})",n));let r,l=!1,v=Q(n.multiplier.toDecimal()),m=n.multiplier.sign(),q=n.multiplier.abs();if(n.multiplier=q,n.isPi()&&n.isLinear()){if(mt(q))throw new Ht(`csc is undefined for ${n.toString()}`);{let M=q.num,I=q.den;I.equals(2)?(r=new z(1),l=!0):I.equals(3)?(r=u.parse("2/sqrt(3)"),l=!0):I.equals(4)?(r=u.parse("sqrt(2)"),l=!0):I.equals(6)?(r=new z(2),l=!0):r=u.multiply(new z(m),u.symfunction("csc",[n]))}}return r||=u.multiply(new z(m),u.symfunction("csc",[n])),l&&(v===3||v===4)&&r.negate(),r},cot(n){if(Oe.PARSE2NUMBER)return Number(n.multiplier.toDecimal())%(Math.PI/2)===0?new z(0):n.isConstant()?Oe.USE_BIG?new z(new Me(1).dividedBy(Me.tan(n.multiplier.toDecimal()))):new z(ut.cot(n.valueOf())):n.isImaginary()?$e.evaluate(n,"cot"):u.parse(qt("1/tan({0})",n));let r,l=!1,v=Q(n.multiplier.toDecimal()),m=n.multiplier;if(n.multiplier=m,n.isPi()&&n.isLinear()){if(mt(m))throw new Ht(`cot is undefined for ${n.toString()}`);{let q=m.num,M=m.den;M.equals(2)?r=new z(0):M.equals(3)?(r=u.parse("1/sqrt(3)"),l=!0):M.equals(4)?(r=new z(1),l=!0):M.equals(6)?(r=u.parse("sqrt(3)"),l=!0):r=u.symfunction("cot",[n])}}return r||=u.symfunction("cot",[n]),l&&(v===2||v===4)&&r.negate(),r},acos(n){if(Oe.PARSE2NUMBER){if(n.isConstant()){if(n.gt(1)||n.lt(-1)){let r=n.toString();return se(Nt(`pi/2-asin(${r})`))}return Oe.USE_BIG?new z(Me.acos(n.multiplier.toDecimal())):new z(Math.acos(n.valueOf()))}if(n.isImaginary())return $e.evaluate(n,"acos")}return u.symfunction("acos",[n])},asin(n){if(Oe.PARSE2NUMBER){if(n.isConstant()){if(n.gt(1)||n.lt(-1)){let r=Oe.IMAGINARY,l=n.multiplier.toDecimal();return se(Nt(`${r}*log(sqrt(1-${l}^2)-${r}*${l})`))}return Oe.USE_BIG?new z(Me.asin(n.multiplier.toDecimal())):new z(Math.asin(n.valueOf()))}if(n.isImaginary())return $e.evaluate(n,"asin")}return u.symfunction("asin",[n])},atan(n){let r;if(n.equals(0))r=new z(0);else{if(Oe.PARSE2NUMBER)return n.isConstant()?Oe.USE_BIG?new z(Me.atan(n.multiplier.toDecimal())):new z(Math.atan(n.valueOf())):n.isImaginary()?$e.evaluate(n,"atan"):u.symfunction("atan",[n]);n.equals(-1)?r=u.parse("-pi/4"):r=u.symfunction("atan",[n])}return r},asec(n){if(Oe.PARSE2NUMBER){if(n.equals(0))throw new hn("Input is out of the domain of sec!");if(n.isConstant())return ge.acos(n.invert());if(n.isImaginary())return $e.evaluate(n,"asec")}return u.symfunction("asec",[n])},acsc(n){if(Oe.PARSE2NUMBER){if(n.isConstant())return ge.asin(n.invert());if(n.isImaginary())return $e.evaluate(n,"acsc")}return u.symfunction("acsc",[n])},acot(n){if(Oe.PARSE2NUMBER){if(n.isConstant())return u.add(u.parse("pi/2"),ge.atan(n).negate());if(n.isImaginary())return $e.evaluate(n,"acot")}return u.symfunction("acot",[n])},atan2(n,r){if(n.equals(0)&&r.equals(0))throw new Ht("atan2 is undefined for 0, 0");return Oe.PARSE2NUMBER&&n.isConstant()&&r.isConstant()?new z(Math.atan2(n,r)):u.symfunction("atan2",[n,r])}},ve=this.trigh={cosh(n){if(Oe.PARSE2NUMBER){if(n.isConstant())return new z(Math.cosh(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"cosh")}return u.symfunction("cosh",[n])},sinh(n){if(Oe.PARSE2NUMBER){if(n.isConstant())return new z(Math.sinh(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"sinh")}return u.symfunction("sinh",[n])},tanh(n){if(Oe.PARSE2NUMBER){if(n.isConstant())return new z(Math.tanh(n.valueOf()));if(n.isImaginary())return $e.evaluate(n,"tanh")}return u.symfunction("tanh",[n])},sech(n){return Oe.PARSE2NUMBER?n.isConstant()?new z(Math.sech(n.valueOf())):n.isImaginary()?$e.evaluate(n,"sech"):u.parse(qt("1/cosh({0})",n)):u.symfunction("sech",[n])},csch(n){return Oe.PARSE2NUMBER?n.isConstant()?new z(Math.csch(n.valueOf())):n.isImaginary()?$e.evaluate(n,"csch"):u.parse(qt("1/sinh({0})",n)):u.symfunction("csch",[n])},coth(n){return Oe.PARSE2NUMBER?n.isConstant()?new z(Math.coth(n.valueOf())):n.isImaginary()?$e.evaluate(n,"coth"):u.parse(qt("1/tanh({0})",n)):u.symfunction("coth",[n])},acosh(n){let r;return Oe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"acosh"):Oe.PARSE2NUMBER?r=Nt(u.parse(qt(`${Oe.LOG}(({0})+sqrt(({0})^2-1))`,n.toString()))):r=u.symfunction("acosh",[n]),r},asinh(n){let r;return Oe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"asinh"):Oe.PARSE2NUMBER?r=Nt(u.parse(qt(`${Oe.LOG}(({0})+sqrt(({0})^2+1))`,n.toString()))):r=u.symfunction("asinh",[n]),r},atanh(n){let r;return Oe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"atanh"):Oe.PARSE2NUMBER?r=Nt(u.parse(qt(`(1/2)*${Oe.LOG}((1+({0}))/(1-({0})))`,n.toString()))):r=u.symfunction("atanh",[n]),r},asech(n){let r;return Oe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"asech"):Oe.PARSE2NUMBER?r=Nt(X(u.add(n.clone().invert(),He(u.subtract(u.pow(n,new z(-2)),new z(1)))))):r=u.symfunction("asech",[n]),r},acsch(n){let r;return Oe.PARSE2NUMBER&&n.isImaginary()?r=$e.evaluate(n,"acsch"):Oe.PARSE2NUMBER?r=Nt(u.parse(qt(`${Oe.LOG}((1+sqrt(1+({0})^2))/({0}))`,n.toString()))):r=u.symfunction("acsch",[n]),r},acoth(n){let r;if(Oe.PARSE2NUMBER&&n.isImaginary())r=$e.evaluate(n,"acoth");else if(Oe.PARSE2NUMBER)if(n.equals(1))r=z.infinity();else{let l=X(u.divide(u.add(n.clone(),new z(1)),u.subtract(n.clone(),new z(1))));r=Nt(u.divide(l,new z(2)))}else r=u.symfunction("acoth",[n]);return r}};this.units={};let Ie={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(n){return n}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(n){return u.symfunction(Oe.DOUBLEFACTORIAL,[n])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(n){return F(n)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(n){return u.divide(n,new z(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(n){return n.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},le={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},i=this.functions={cos:[ge.cos,1],sin:[ge.sin,1],tan:[ge.tan,1],sec:[ge.sec,1],csc:[ge.csc,1],cot:[ge.cot,1],acos:[ge.acos,1],asin:[ge.asin,1],atan:[ge.atan,1],arccos:[ge.acos,1],arcsin:[ge.asin,1],arctan:[ge.atan,1],asec:[ge.asec,1],acsc:[ge.acsc,1],acot:[ge.acot,1],atan2:[ge.atan2,2],acoth:[ve.acoth,1],asech:[ve.asech,1],acsch:[ve.acsch,1],sinh:[ve.sinh,1],cosh:[ve.cosh,1],tanh:[ve.tanh,1],asinh:[ve.asinh,1],sech:[ve.sech,1],csch:[ve.csch,1],coth:[ve.coth,1],acosh:[ve.acosh,1],atanh:[ve.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[de,1],radians:[Le,1],degrees:[Pe,1],min:[P,-1],max:[p,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[Ae,1],tri:[void 0,1],sign:[d,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[F,1],factorial:[F,1],continuedFraction:[ie,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[W,[1,2]],scientific:[rt,[1,2]],mod:[Se,2],pfactor:[J,1],vector:[ft,-1],matrix:[At,-1],NerdamerSet:[$t,-1],imatrix:[me,-1],parens:[R,-1],sqrt:[He,1],cbrt:[Qe,1],nthroot:[Je,2],log:[X,[1,2]],expand:[Y,1],abs:[U,1],invert:[Vt,1],determinant:[Tt,1],size:[pt,1],transpose:[Ot,1],dot:[Ft,2],cross:[_t,2],vecget:[De,2],vecset:[je,3],vectrim:[Te,[1,2]],matget:[Ze,3],matset:[ct,4],matgetrow:[Ve,2],matsetrow:[et,3],matgetcol:[Be,2],matsetcol:[lt,3],rationalize:[We,1],IF:[he,3],isIn:[Ce,2],realpart:[Z,1],imagpart:[j,1],conjugate:[k,1],arg:[K,1],polarform:[O,1],rectform:[$,1],sort:[x,[1,2]],integer_part:[void 0,1],union:[Jt,2],contains:[Yt,2],intersection:[c0,2],difference:[r0,2],intersects:[Kt,2],isSubset:[v0,2],primes:[f,2],print:[E,-1]};this.error=Pt;let a=function(n){let r=Oe.FUNCTION_MODULES,l=r.length;for(let v=0;v<l;v++){let m=r[v];if(n in m)return m[n]}return Pt(`The function ${n} is undefined!`)};this.override=function(r,l){Ne[r]||=[],Ne[r].push(this[r]),this[r]=l},this.restore=function(r){this[r]&&=Ne[r].pop()},this.extend=function(r,l,v){let m=this;if(typeof this[r]=="function"&&typeof l=="function"){let M=this[r];this[r]=function(H,ne){return gt(H)&&gt(ne)&&!v?M.call(m,H,ne):l.call(m,H,ne,M)}}},this.symfunction=function(r,l){let v=new z(r);return v.group=y,typeof l=="object"&&(l=[].slice.call(l)),v.args=l,v.fname=r===Ee?"":r,v.updateHash(),v},this.callfunction=function(r,l,v=void 0){let m=i[r];m||Pt(`Nerdamer currently does not support the function ${r}`);let q=m[1]||v,M=m[0],I;if(l instanceof Array||(l=l===void 0?[]:[l]),q!==-1){let ne=Dt(q),ae=ne?q[0]:q,qe=ne?q[1]:q,Ue=l.length,be=`${r} requires a {0} of {1} arguments. {2} provided!`;Ue<ae&&Pt(qt(be,"minimum",ae,Ue)),Ue>qe&&Pt(qt(be,"maximum",qe,Ue))}let H=un(l);return M?I=M.apply(m[2],l):(M=a(r),Oe.PARSE2NUMBER&&H?I=ee(M.apply(M,l)):I=u.symfunction(r,l)),I},this.operator_filter_regex=(function(){let r=`^\\${Object.keys(Ie).filter(l=>l.length===1).join("\\")}`;return new RegExp(`([${r}])\\s+([${r}])`)})(),this.setOperator=function(r,l=void 0,v=void 0){let m=r.operator;if(Ie[m]=r,l&&(this[r.action]=l),fe[m]=r.operation,!r.action&&!(r.prefix||r.postif)&&(r.action=m),v==="over"||v==="under"){let{precedence:q}=r;for(let M in Ie){if(!Object.hasOwn(Ie,M))continue;let I=Ie[M];(v==="over"?I.precedence>=q:I.precedence>q)&&I.precedence++}}},this.getOperator=function(r){return Ie[r]},this.aliasOperator=function(r,l){let v={},m=Ie[r];for(let q in m)Object.hasOwn(m,q)&&(v[q]=m[q]);v.operator=l,this.setOperator(v)},this.getOperators=function(){return Ie},this.getBrackets=function(){return le};let c=function(r,l){r=String(r);for(let v=0;v<_e.actions.length;v++)r=_e.actions[v].call(l,r);for(r=r.replace(/\s+/gu," "),/e/giu.test(r)&&(r=r.replace(/-+\d+\.?\d*e\+?-?\d+/giu,v=>F0(v)),r=r.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,v=>F0(v))),r=r.replace(Oe.IMPLIED_MULTIPLICATION_REGEX,(v,m,q,M,I)=>{let H=I.charAt(M),ne="",ae="*";return H.match(/[+\-/*]/u)||(ne=I.charAt(M-1)),ne.match(/[a-z]/iu)&&(ae=""),m+ae+q}).replace(/(?<varname>[a-z0-9_]+)/giu,(v,m)=>Oe.USE_MULTICHARACTER_VARS===!1&&!(m in i)&&isNaN(m)?m.split("").join("*"):m).replace(/\)\(/gu,")*(")||"0";;){let v=r;if(r=r.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,(m,q,M,I,H)=>{let ne=q||I,ae=M||H;return ne in i?ne+ae:`${ne}*${ae}`}),v===r)break}return r};this.initConstants=function(){this.CONSTANTS={E:new z(Oe.E),PI:new z(Oe.PI)}},this.prettyPrint=function(r){if(Array.isArray(r)){let l=r,v=l.map(m=>u.prettyPrint(m)).join(", ");return l.type==="vector"?`vector<${v}>`:`(${v})`}return r.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(r,...l){if(Oe.callPeekers){let v=this.peekers[r],m=l.map(T1);for(let q=0;q<v.length;q++)v[q].apply(null,m)}},this.tokenize=function(r){r=String(r),r=r.trim().replace(/\s+/gu," ");for(let tt in le){if(!Object.hasOwn(le,tt))continue;let nt=new RegExp(le[tt].is_close?`\\s+\\${tt}`:`\\${tt}\\s+`,"gu");r=r.replace(nt,tt)}let l=0,v=r.length,m=0,q=[],M=[q],I=M[0],H=0,ne=[],ae=!1,qe,Ue=" ",be="",ke=",",st="-",bt="*",ze=function(tt=void 0,nt=void 0){let it=[];tt!==void 0&&(it.type=tt),it.column=nt,M.push(it),I.push(it),I=it,H++},Re=function(){M.pop(),I=M[--H]},Ke=function(tt){tt=tt===void 0?l:tt;let nt=tt+1;for(;r.charAt(nt++)in Ie;);return r.substring(tt,nt-1)},Xe=function(tt){let nt=l-tt.length,it=[],zt=tt.charAt(0),U0=tt.length,a0;for(a0=1;a0<U0;a0++){let C0=tt.charAt(a0),G0=zt+C0;G0 in Ie?zt=G0:(it.push(new ye(zt,ye.OPERATOR,nt+a0)),zt=C0)}return it.push(new ye(zt,ye.OPERATOR,nt+a0)),it},Ye=function(tt,nt=void 0){nt===void 0&&(nt=r.substring(m,tt)),nt in u.units?I.push(new ye(nt,ye.UNIT,m)):nt!==""&&I.push(new ye(nt,ye.VARIABLE_OR_LITERAL,m))},at=function(tt){I.push(new ye(tt,ye.FUNCTION,m))},dt=function(tt){m=tt+1},ht=function(){m=m+qe.length-2,l=m-1};for(;l<v;l++){let tt=r.charAt(l);if(tt in Ie){Ye(l);let it=I[0]&&zn(I[0])&&tt===bt;ae&&m<l&&!(tt===ke||it)&&(ae=!1,Re()),dt(l+1),qe=Ke(l),ht(),I.push(...Xe(qe))}else if(tt in le){let nt=le[tt];if(nt.is_open){ne.push([nt,m]);let it=r.substring(m,l);it in i?at(it):it!==""&&I.push(new ye(it,ye.VARIABLE_OR_LITERAL,m)),ze(nt.maps_to,l)}else if(nt.is_close){let it=ne.pop();if(it){if(it[0].id!==nt.id-1)throw new W0("Parity error")}else throw new W0(`Missing open bracket for bracket at: ${l+1}`);Ye(l),Re()}dt(l)}else if(tt===Ue){let nt=r.substring(m,l),it=r.charAt(l+1);if(ae){if(nt in Ie)I.push(new ye(nt,ye.OPERATOR,l));else{Ye(void 0,nt),Re();let zt=it in Ie;(zt&&Ie[it].value===st||!zt)&&I.push(new ye(bt,ye.OPERATOR,l))}ae=!1}else{let zt=r.substring(m,l);zt in i?(ae=!0,at(zt),ze()):zt in Ie?I.push(new ye(zt,ye.OPERATOR,l)):(Ye(void 0,zt),it=r.charAt(l+1),nt!==be&&it!==be&&!(nt in Ie)&&!(it in Ie)&&I.push(new ye(bt,ye.OPERATOR,l)))}dt(l)}}if(ne.length){let tt=ne.pop();throw new W0(`Missing closed bracket for bracket at ${tt[1]+1}`)}return Ye(l),q},this.toRPN=function(r){let l=r.type,v=r.length,m,q,M=[],I=[],H=[],ne=function(qe,Ue){for(;qe.length;)Ue.push(qe.pop())};for(m=0;m<v;m++){let ae=r[m];if(ae.type!==ye.OPERATOR)break;if(!ae.prefix)throw new _0("Not a prefix operator");ae.is_prefix=!0,I.push(ae)}for(;m<v;m++){if(q=r[m],q.type===ye.OPERATOR){let ae=q;if(ae.overloaded){let qe=r[m+1];qe&&qe.type===ye.VARIABLE_OR_LITERAL&&(ae.postfix=!1,ae.action=ae.overloadAction,ae.leftAssoc=ae.overloadLeftAssoc)}for(;I.length;){let qe=I[I.length-1];if(!(qe.precedence>ae.precedence||!ae.leftAssoc&&qe.precedence===ae.precedence))break;M.push(I.pop())}if((l==="vector"||l==="set")&&"vectorFn"in ae&&(ae.action=ae.vectorFn),ae.postfix){let qe=r[m-1];if(qe){if(qe.type===ye.OPERATOR&&!qe.postfix)throw new _0(`Unexpected prefix operator '${qe.value}'! at ${qe.column}`)}else throw new _0(`Unexpected prefix operator '${q.value}'! at ${q.column}`)}else{let qe;do{let Ue=r[m+1];if(qe=Ue?Ue.type===ye.OPERATOR:!1,qe){if(!Ue.prefix)throw new _0(`A prefix operator was expected at ${Ue.column}`);Ue.is_prefix=!0,H.push(Ue),m++}}while(qe)}for(ae.is_prefix?H.push(ae):I.push(ae);H.length&&(ae.leftAssoc||!ae.leftAssoc&&H[H.length-1].precedence>=ae.precedence);)I.push(H.pop())}else if(q.type===ye.VARIABLE_OR_LITERAL){M.length===0&&ne(H,I),M.push(q);let ae=I[I.length-1];(!ae||!ae.leftAssoc)&&ne(H,M)}else q.type===ye.FUNCTION?I.push(q):q.type===ye.UNIT&&M.push(q);if(Array.isArray(q)){let ae=q;M.push(this.toRPN(q)),ae.type&&M.push(new ye(ae.type,ye.FUNCTION,ae.column))}}return ne(I,M),ne(H,M),M},this.parseRPN=function(r,l){try{l||={};for(let M in l)Object.hasOwn(l,M)&&(l[M]=u.parse(l[M],{}));Oe.PARSE2NUMBER&&("e"in l||(l.e=new z(Oe.E)),"pi"in l||(l.pi=new z(Oe.PI)));let v=[],m;for(let M=0,I=r.length;M<I;M++)if(m=r[M],Array.isArray(m)&&(m=this.parseRPN(m,l)),m)if(m.type===ye.OPERATOR)if(m.is_prefix||m.postfix)v.push(m.operation(v.pop()));else{let H=v.pop(),ne=v.pop();if(typeof ne>"u")throw new _0(`${m} is not a valid postfix operator at ${m.column}`);let ae=m.action==="comma";ne instanceof g0&&!ae&&(ne=It.fromSet(ne)),H instanceof g0&&!ae&&(H=It.fromSet(H)),this.callPeekers("pre_operator",ne,H,m);let qe=u[m.action](ne,H);this.callPeekers("post_operator",qe,ne,H,m),v.push(qe)}else if(m.type===ye.FUNCTION){let H=v.pop(),{parent:ne}=H;H instanceof t0||(H=t0.create(H));let ae=m.value,qe=H.getItems();this.callPeekers("pre_function",ae,qe);let Ue=u.callfunction(ae,qe);this.callPeekers("post_function",Ue,ae,qe);let be=v[v.length-1],ke=r[M+1],st=ke&&ke.type===ye.OPERATOR&&ke.value===",";ne&&(Ue.parent=ne),v.push(Ue)}else{let H,ne=m.value;if(ne in Oe.ALIASES)m=u.parse(Oe.ALIASES[m]);else if(m.type===ye.VARIABLE_OR_LITERAL)m=new z(ne);else if(m.type===ye.UNIT){let ae=new z(ne);ae.isUnit=!0,m=ae}ne in u.CONSTANTS?(H=m,m=new z(u.CONSTANTS[ne])):ne in l&&ne!==l[ne].toString()?(H=m,m=l[ne].clone()):ne in pe&&(H=m,m=pe[ne].clone()),H&&(m.subbed=H),v.push(m)}let q=v[0];if(["undefined","string","number"].indexOf(typeof q)!==-1)throw new Zn("Unexpected token!");return q}catch(v){if(v.message==="timeout"||v instanceof TypeError||v instanceof ReferenceError||v instanceof RangeError)throw v;[hn].forEach(M=>{if(v instanceof M){let I=v.column;throw new M(`${v.message}${I?`: ${I}`:""}`)}});let q=v.column;throw new Gn(`${v.message}${q?`: ${q}`:""}`)}};class S{constructor(r){this.type=r.type,this.value=r.value,this.left=r.left,this.right=r.right}toString(){let r=this.left?`${this.left.toString()}---`:"",l=this.right?`---${this.right.toString()}`:"";return`${r}(${this.value})${l}`}toHTML(r,l){r||=0,l=typeof l>"u"?4:l;let v=function(H){return" ".repeat(l*H)},m="",q=this.left?`${v(r+1)}<li>
${this.left.toHTML(r+2,l)}${v(r+1)}</li> 
`:"",M=this.right?`${v(r+1)}<li>
${this.right.toHTML(r+2,l)}${v(r+1)}</li>
`:"";return m=`${v(r)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${v(r)}
`,(q||M)&&(m+=`${v(r)}<ul>
${q}${M}${v(r)}</ul>
`),m}}this.tree=function(r){let l=[];for(let v=0;v<r.length;v++){let m=r[v];if(Array.isArray(m)){m=this.tree(m),l.push(m);continue}if(m.type===ye.OPERATOR)if(m.is_prefix||m.postfix){let q=m.is_prefix?"left":"right",M=l.pop();m=new S(m),m[q]=M,l.push(m)}else m=new S(m),m.right=l.pop(),m.left=l.pop(),l.push(m);else if(m.type===ye.FUNCTION){m=new S(m);let q=l.pop();if(m.right=q,m.value==="object"){let M=l[l.length-1];if(M){for(;M.right;)M=M.right;M.right=m;continue}}l.push(m)}else l.push(new S(m))}return l[0]},this.parse=function(r,l){r=c(r,this),l||={};let v=this.tokenize(r),m=this.toRPN(v);return this.parseRPN(m,l)},this.toObject=function(r){return function v(m){let q=[];for(let M=0,I=m.length;M<I;M++){let H=m[M],ne=H.value;if(H.type===ye.VARIABLE_OR_LITERAL)q.push(new z(ne));else if(H.type===ye.FUNCTION){M++;let ae=u.symfunction(ne,v(m[M]));ae.isConversion=!0,q.push(ae)}else H.type===ye.OPERATOR?q.push(ne):q.push(v(H))}return q}(u.tokenize(r))};let w=function(r){let l=0,v=[[]];for(let m=0,q=r.length;m<q;m++)r[m]===","?(l++,v[l]=[]):v[l].push(r[m]);return v},N=function(n){return n.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(r,l)=>l||r)},_=function(n){let r=[];for(;n.length;){let l=n.shift(),v=n[0],m=Dt(v),q=v==="-";if(l==="^"&&(v==="+"?n.shift():m&&v[0]==="+"&&v.shift(),m&&v.length===1&&n.unshift(n.shift()[0])),l==="^"&&(m&&v[0]==="-"||q)){let M=r.pop(),I=r[r.length-1],H="1";I==="*"?(r.pop(),H=r.pop()):Dt(I)&&(H=r.pop()),r.push(H,"/",M,l),m?v.shift():n.shift(),m&&v.length===1&&r.push(n.shift()[0])}else r.push(l)}return r};this.toTeX=function(r,l){l||={};let v=l.decimals===!0?"decimals":void 0,m=typeof r=="string"?this.toObject(r):r,q=[],M=typeof l.cdot>"u"?"\\cdot":l.cdot;if(m=_(m),Dt(m)){let I=[],H,ne;for(let ae=0;ae<m.length;ae++)H=m[ae],m[ae+1]==="^"?(ne=m[ae+2],I.push(`${yt.braces(this.toTeX([H]))}^${yt.braces(this.toTeX([ne]))}`),ae+=2):I.push(H);m=I}for(let I=0,H=m.length;I<H;I++){let ne=m[I];if(ne==="*"&&(ne=M),gt(ne))if(ne.group===y){let{fname:ae}=ne,qe;if(ae===G)qe=`\\sqrt${yt.braces(this.toTeX(ne.args))}`;else if(ae===V)qe=yt.brackets(this.toTeX(ne.args),"abs");else if(ae===Ee)qe=yt.brackets(this.toTeX(ne.args),"parens");else if(ae===Oe.LOG10)qe=`\\${Oe.LOG10_LATEX}\\left( ${this.toTeX(ne.args)}\\right)`;else if(ae===Oe.LOG2)qe=`\\${Oe.LOG2_LATEX}\\left( ${this.toTeX(ne.args)}\\right)`;else if(ae===Oe.LOG1P)qe=`\\${qt(Oe.LOG1P_LATEX,this.toTeX(ne.args))}`;else if(ae==="integrate"){let Ue=w(ne.args),be=yt.braces(this.toTeX(Ue[0])),ke=this.toTeX(Ue[1]);qe=`\\int ${be}\\, d${ke}`}else if(ae==="defint"){let Ue=w(ne.args),be=yt.braces(this.toTeX(Ue[0])),ke=this.toTeX(Ue[3]),st=this.toTeX(Ue[1]),bt=this.toTeX(Ue[2]);qe=`\\int\\limits_{${st}}^{${bt}} ${be}\\, d${ke}`}else if(ae==="diff"){let Ue=w(ne.args),be="",ke=yt.braces(this.toTeX(Ue[0]));if(Ue.length===1){let st=[];for(let bt=0;bt<Ue[0].length;bt++)Ue[0][bt].group===3&&st.push(Ue[0][bt].value);st.sort(),be=st.length>0?`\\frac{d}{d ${st[0]}}`:"\\frac{d}{d x}"}else Ue.length===2?be=`\\frac{d}{d ${Ue[1]}}`:be=`\\frac{d^{${Ue[2]}}}{d ${this.toTeX(Ue[1])}^{${Ue[2]}}}`;qe=`${be}\\left(${ke}\\right)`}else if(ae==="sum"||ae==="product"){let Ue=[[],[],[],[]],be=0;for(let ke=0;ke<ne.args.length;ke++){if(ne.args[ke]===","){be++;continue}Ue[be].push(ne.args[ke])}qe=(ae==="sum"?"\\sum_":"\\prod_")+yt.braces(`${this.toTeX(Ue[1])} = ${this.toTeX(Ue[2])}`),qe+=`^${yt.braces(this.toTeX(Ue[3]))}${yt.braces(this.toTeX(Ue[0]))}`}else if(ae==="limit"){let Ue=this.toTeX.bind(this),be=u,ke=w(ne.args).map(st=>Array.isArray(st)?be.toTeX(st.join("")):Ue(String(st)));qe=`\\lim_${yt.braces(`${ke[1]}\\to ${ke[2]}`)} ${yt.braces(ke[0])}`}else ae===B||ae===we?qe=this.toTeX(ne.args)+(ae===B?"!":"!!"):qe=yt.latex(ne,v);q.push(qe)}else q.push(yt.latex(ne,v));else Dt(ne)?q.push(yt.brackets(this.toTeX(ne))):ne==="/"?q.push(yt.frac(N(q.pop()),N(this.toTeX([m[++I]])))):q.push(ne)}return q.join(" ")};function R(n){return Oe.PARSE2NUMBER?n:u.symfunction("parens",[n])}function U(n){if(n.isInfinity)return z.infinity();if(n.multiplier.lessThan(0)&&n.multiplier.negate(),n.isImaginary()){let l=n.realpart(),v=n.imagpart();if(l.isConstant()&&v.isConstant())return He(u.add(u.pow(l,new z(2)),u.pow(v,new z(2))))}else{if(q0(n)||Ut(n.power))return n;if(Qn(n)&&typeof n.value=="string"&&n.value.startsWith("baseunit_"))return n}if(n.isComposite()){let l=[];n.each(m=>{l.push(m.multiplier)}),ut.QGCD.apply(null,l).lessThan(0)&&(n.multiplier=n.multiplier.multiply(new Fe(-1)),n.distributeMultiplier())}let r=u.parse(n.multiplier);return n.toUnitMultiplier(),u.multiply(r,u.symfunction(V,[n]))}function F(n){let r;if(vt(n)){let l=new It;return n.each((v,m)=>{l.set(m-1,F(v))}),l}if(St(n)){let l=new xt;return n.each((v,m,q)=>{l.set(m,q,F(v))}),l}if(Oe.PARSE2NUMBER&&n.isConstant())return mt(n)?r=ut.bigfactorial(n):r=ut.gamma(n.multiplier.add(new Fe(1)).toDecimal()),r=ee(r),r;if(n.isConstant()&&n.getDenom().equals(2)){let v=n.getNum(),m,q,M;n.multiplier.isNegative()?(M=u.subtract(v.negate(),new z(1)).multiplier.divide(new Fe(2)),m=u.pow(new z(-4),new z(M)).multiplier.multiply(ut.bigfactorial(M)),q=ut.bigfactorial(new Fe(2).multiply(M))):(M=u.add(v,new z(1)).multiplier.divide(new Fe(2)),m=ut.bigfactorial(new Fe(2).multiply(M)),q=u.pow(new z(4),new z(M)).multiplier.multiply(ut.bigfactorial(M)));let I=m.divide(q);return u.multiply(u.parse("sqrt(pi)"),new z(I))}return u.symfunction(B,[n])}function ie(n,r){let l=Nt(n);if(l.isConstant()){let v=ut.continuedFraction(l,r),m=It.fromArray(v.fractions.map(q=>new z(q)));return It.fromArray([new z(v.sign),new z(v.whole),m])}return u.symfunction("continuedFraction",[n,r])}function oe(n){let r=Nt(n);return r.isConstant()?new z(ut.erf(r)):r.isImaginary()?$e.erf(n):u.symfunction("erf",[n])}function Se(n,r){if(n.isConstant()&&r.isConstant()){let v=new z(1);return v.multiplier=v.multiplier.multiply(n.multiplier.mod(r.multiplier)),v}let l=u.divide(n.clone(),r.clone());return mt(l)?new z(0):u.symfunction("mod",[n,r])}function he(n,r,l){return typeof n!="boolean"&&q0(n)&&(n=!!Number(n)),n?r:l}function Ce(n,r){if(St(n)){for(let l=0,v=n.rows();l<v;l++)for(let m=0,q=n.cols();m<q;m++)if(n.elements[l][m].equals(r))return new z(1)}else if(n.elements){for(let l=0,v=n.elements.length;l<v;l++)if(n.elements[l].equals(r))return new z(1)}return new z(0)}function Ae(n){return Oe.PARSE2NUMBER?n.isConstant()?new z(ut.sinc(n)):u.parse(qt("sin({0})/({0})",n)):u.symfunction("sinc",[n])}function de(n){return n.fname===Oe.LOG&&n.isLinear()?u.pow(n.args[0],z.create(n.multiplier.toString())):u.parse(qt("e^({0})",n))}function Le(n){return u.parse(qt("({0})*pi/180",n))}function Pe(n){return u.parse(qt("({0})*180/pi",n))}function Ge(n){let r,l,v;if(n.group===y&&n.fname===""?(r=z.unwrapPARENS(u.parse(n).toLinear()),l=u.parse(n.power)):n.group===e&&(r=u.parse(n.value),l=u.parse(n.power)),r&&l&&r.group===t&&l.group===t){v=[];let m=z.toPolarFormArray(n),q=u.parse(r).abs().toString(),M=K(r).toString(),I=l.multiplier.den.toString(),H=l.multiplier.num.toString(),ne="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let ae=0;ae<Number(I);ae++){let qe=Nt(u.parse(qt("(({0})+2*pi*({1}))/({2})",M,ae,I))).multiplier.toDecimal();v.push(Nt(u.parse(qt(ne,q,I,Oe.IMAGINARY,qe,H))))}return It.fromArray(v)}if(n.isConstant(!0)){let m=n.sign(),q=Nt(n.abs()),M=u.sqrt(q);v=[M.clone(),M.negate()],m<0&&(v=v.map(I=>u.multiply(I,z.imaginary())))}else v=[u.parse(n)];return It.fromArray(v)}function We(n){if(n.isComposite()){let r=new z(0),l,v,m,q,M,I,H,ne;return n.each(ae=>{l=ae.getNum(),v=ae.getDenom(),m=r.getNum(),q=r.getDenom(),M=u.multiply(v,m),I=u.multiply(l,q),H=u.expand(u.add(M,I)),ne=u.multiply(q,v),r=u.divide(H,ne)},!0),r}return n}function He(n){gt(n)||(n=u.parse(n));let r=u.symfunction("sqrt",[n]);if(n.group===h)return u.symfunction(G,[n]);n.fname===""&&n.power.equals(1)&&(n=n.args[0]);let l=n.multiplier.sign()<0;if(Oe.PARSE2NUMBER){if(n.isConstant()&&!l)return new z(Me.sqrt(n.multiplier.toDecimal()));if(n.isImaginary())return $e.sqrt(n);if(n.group===o)return u.symfunction("sqrt",[n])}let v,m,q=n.isConstant();if(n.group===C&&n.isLinear()){let M=He(new z(n.multiplier));for(let I in n.symbols){if(!Object.hasOwn(n.symbols,I))continue;let H=n.symbols[I];M=u.multiply(M,He(H))}m=M}else if(n.fname===G){let M=n.args[0],I=n.multiplier;M.setPower(n.power.multiply(new Fe(.25))),m=M,I.equals(1)||(m=u.multiply(He(u.parse(I)),m))}else if(!n.power.isInteger())n.setPower(n.power.multiply(new Fe(.5))),m=n;else if(Number(n.multiplier)<0&&n.group===o){let M=u.parse(n.multiplier).negate(),I=u.parse(n).toUnitMultiplier().negate();m=u.multiply(u.symfunction(Oe.SQRT,[I]),He(M))}else{let M=n.power.sign();n.power=n.power.abs(),q&&n.multiplier.lessThan(0)&&(v=z.imaginary(),n.multiplier=n.multiplier.abs());let I=Number(n.multiplier.toDecimal()),H=Math.abs(I),ne=Math.sqrt(H),ae;if(mt(ne))ae=new z(ne);else if(mt(I)){let qe=ut.ifactor(I),Ue=1;for(let be in qe){if(!Object.hasOwn(qe,be))continue;let ke=qe[be],st=ke-ke%2;if(st){let bt=Number(be)**st;Ue*=Number(be)**(st/2),I/=bt}}ae=u.multiply(u.symfunction(G,[new z(I)]),new z(Ue))}else{let qe=[new z(n.multiplier.num),new z(n.multiplier.den)],Ue=[new z(1),new z(1)],be=[new z(1),new z(1)],ke=u;for(let st=0;st<2;st++){let bt=qe[st];J(bt).each(ze=>{ze=z.unwrapPARENS(ze);let Re=ze.clone().toLinear(),Ke=Number(ze.power),Xe=Ke%2,Ye=(Ke-Xe)/2;Ue[st]=ke.multiply(Ue[st],ke.pow(Re,new z(Ye))),be[st]=ke.multiply(be[st],He(ke.pow(Re,new z(Xe))))})}ae=u.divide(u.multiply(Ue[0],be[0]),u.multiply(Ue[1],be[1]))}n=n.toUnitMultiplier(!0),n.isOne()?m=n:Ut(n.power.toString())?m=u.pow(n.clone(),new z(.5)):m=u.symfunction(G,[n]),M<0&&m.power.negate(),ae&&(m=u.multiply(ae,m)),v&&(m=u.multiply(v,m))}return tn&&Oe.PARSE2NUMBER&&m.text()!==r.text()?u.parse(m):m}function Qe(n){if(!n.isConstant(!0)){let r,l=Number(n.power)/3,v=u.pow(u.parse(n.multiplier),new z(1/3)),m=n.toUnitMultiplier();return mt(l)?r=u.pow(m.toLinear(),u.parse(String(l))):m.group===C?(r=new z(1),m.each(q=>{r=u.multiply(r,Qe(q))})):r=u.symfunction("cbrt",[m]),u.multiply(v,r)}return Je(n,new z(3))}function rt(n,r){return n.scientific=r||10,n}function Je(n,r,l=void 0,v=void 0){if(r=Nt(u.parse(r)),r.equals(0))throw new Ht("Unable to calculate nthroots of zero");if(Number(n)<0&&Ut(r))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!n.isConstant(!0)){let I=[n,r];return typeof l<"u"&&I.push(new z(l)),typeof v<"u"&&I.push(new z(v?1:0)),u.symfunction("nthroot",I)}n.group!==t&&(n=Nt(n)),typeof v>"u"&&(v=!0),l||=25;let m=n.sign(),q,M;if(m<0&&(n=U(n)),mt(n)&&r.isConstant())return Number(n)<18446744073709552e3?M=Fe.create(Number(n)**(1/Number(r))):M=ut.nthroot(n,r),v?q=new z(M):q=new z(M.toDecimal(l)),u.multiply(new z(m),q)}function J(n){if(n.greaterThan(9999999999998891e26)||n.equals(-1))return n;if(n.equals(Math.PI))return new z(Math.PI);n=Nt(n.clone());let r;if(n.isConstant()){r=new z(1);let l=n.toString();if(mt(l)){let v=ut.ifactor(l);for(let m in v){if(!Object.hasOwn(v,m))continue;let q=v[m];r=u.multiply(r,u.symfunction("parens",[new z(m).setPower(new Fe(q))]))}}else{let v=J(new z(n.multiplier.num)),m=J(new z(n.multiplier.den));r=u.multiply(u.symfunction("parens",[v]),u.symfunction("parens",[m]).invert())}}else r=u.symfunction("pfactor",[n]);return r}function Z(n){return n.realpart()}function j(n){return n.imagpart()}function k(n){let r=n.realpart(),l=n.imagpart();return u.add(r,u.multiply(l.negate(),z.imaginary()))}function K(n){let r=n.realpart(),l=n.imagpart();return r.isConstant()&&l.isConstant()?l.equals(0)&&r.equals(1)?u.parse("0"):l.equals(1)&&r.equals(0)?u.parse("pi/2"):l.equals(0)&&r.equals(-1)?u.parse("pi"):l.equals(-1)&&r.equals(0)?u.parse("-pi/2"):l.equals(1)&&r.equals(1)?u.parse("pi/4"):l.equals(1)&&r.equals(-1)?u.parse("pi*3/4"):l.equals(-1)&&r.equals(1)?u.parse("-pi/4"):l.equals(-1)&&r.equals(-1)?u.parse("-pi*3/4"):new z(Math.atan2(Number(l),Number(r))):u.symfunction("atan2",[l,r])}function O(n){let r=z.toPolarFormArray(n),l=r[1],v=r[0],m=u.parse(qt("e^({0}*({1}))",Oe.IMAGINARY,l));return u.multiply(v,m)}function $(n){let r=n.clone();try{let l=o1(n,"e",!0),v=ue.isSymbol(l.x.power)?l.x.power:u.parse(l.x.power),m=u.divide(v,z.imaginary()),q=Nt(ge.tan(m)),M=u.pow(l.a,new z(2)),I=q.getDenom(),H=q.getNum();return z.hyp(H,I).equals(l.a)?u.add(I,u.multiply(z.imaginary(),H)):r}catch(l){if(l.message==="timeout")throw l;return r}}function g(n,r){r.forEach(I=>{I.numVal=Nt(I).multiplier});let l,v,m,q,M;for(;;){if(l=r.length,l<2)return r[0];v=r.pop(),m=r[l-2],(n==="min"?v.numVal<m.numVal:v.numVal>m.numVal)&&(r.pop(),r.push(v))}}function p(...n){return Q0(n)?n[0]:un(n)?new z(Math.max.apply(null,n)):Oe.SYMBOLIC_MIN_MAX&&kn(n)?g("max",n):u.symfunction("max",n)}function P(...n){return Q0(n)?n[0]:un(n)?new z(Math.min.apply(null,n)):Oe.SYMBOLIC_MIN_MAX&&kn(n)?g("min",n):u.symfunction("min",n)}function d(n){return n.isConstant(!0)?new z(Math.sign(Nt(n))):u.symfunction("sign",[n])}function x(n,r){r=r?r.toString():"asc";let l=function(m){return m.group===t?m.multiplier:m.group===y?m.fname===""?l(m.args[0]):m.fname:m.group===o?m.power:m.value},v=vt(n)?n.elements:n.collectSymbols();return new It(v.sort((m,q)=>{let M=l(m),I=l(q);return r==="desc"?I-M:M-I}))}function X(n,r=void 0){let l=n,v=r===void 0?void 0:r;if(l.equals(1))return new z(0);let m;if(l.fname===G&&l.multiplier.equals(1))return m=u.divide(X(l.args[0]),new z(2)),l.power.sign()<0&&m.negate(),m;if(l.equals(0))throw new Ht(`${Oe.LOG}(0) is undefined!`);if(l.isImaginary())return $e.evaluate(l,Oe.LOG);if(l.isConstant()&&typeof v<"u"&&v.isConstant()){let q=Math.log(l),M=Math.log(v);m=new z(q/M)}else if(l.group===h&&l.power.multiplier.lessThan(0)||l.power.toString()==="-1")l.power.negate(),m=X(l).negate();else if(l.value==="e"&&l.multiplier.equals(1)){let q=l.power;m=gt(q)?q:new z(q)}else if(l.group===y&&l.fname==="exp"){let q=l.args[0];l.multiplier.equals(1)?m=u.multiply(q,new z(l.power)):m=u.symfunction(Oe.LOG,[l])}else if(Oe.PARSE2NUMBER&&q0(l)){let q=u.parse(l),M;q.multiplier.lessThan(0)&&(q.negate(),M=u.multiply(new z(Math.PI),new z("i"))),m=new z(Math.log(q.multiplier.toDecimal())),M&&(m=u.add(m,M))}else{let q;!l.power.equals(1)&&!l.contains("e")&&l.multiplier.isOne()&&(q=l.group===h?l.power:new z(l.power),l.toLinear());let M=typeof v>"u"?[l]:[l,v];M.length>1&&Q0(M)?m=new z(1):m=u.symfunction(Oe.LOG,M),q&&(m=u.multiply(q,m))}return m}function W(n,r){typeof r=="number"&&(r=new z(r));let l=r&&r.isConstant()||typeof r>"u";if(n.isConstant()&&l){let m,q,M;m=n,r&&r.lessThan(0)&&(r=U(r),q=Number(n).toExponential().toString().split("e"),m=q[0],M=q[1]);let I=new z(m0(Number(m),Number(r)||0));return u.multiply(I,u.pow(new z(10),new z(M||0)))}let v=[n];return typeof r<"u"&&v.push(r),u.symfunction("round",v)}function Q(n){let r=Number(n)%2,l;return r<0&&(r=2+r),r>=0&&r<=.5?l=1:r>.5&&r<=1?l=2:r>1&&r<=1.5?l=3:l=4,l}function ee(n){if(!isFinite(n)){let l=Math.sign(n),v=new z(String(Math.abs(n)));return v.multiplier=v.multiplier.multiply(new Fe(l)),v}if(gt(n))return n;if(typeof n=="number")try{n=Fe.simple(n)}catch(l){if(l.message==="timeout")throw l;n=new Fe(n)}let r=new z(0);return r.multiplier=n,r}function re(n){let r=n.group,l;if(r===D){let v=n.getNum(),m=n.getDenom()||new z(1),q=Number(n.power),M=new z(1);if(Math.abs(q)===1){m.each(ne=>{ne.group===C?M=u.multiply(M,re(ne.getDenom())):ne.power.lessThan(0)&&(M=u.multiply(M,re(ne.clone().toUnitMultiplier())))});let I=new z(0);m.each(ne=>{I=u.add(u.divide(ne,M.clone()),I)}),M.invert();let H;v.isComposite()?(H=new z(0),v.each(ne=>{H=u.add(u.multiply(re(ne),M.clone()),H)})):H=u.multiply(M,v),l=u.divide(H,I)}}else r===C?(l=new z(1),n.each(v=>{l=u.multiply(l,u.clean(v))})):r===y&&n.args.length===1&&n.args[0].isConstant()&&(l=Bt("PARSE2NUMBER",()=>u.parse(n),!0));return l||=n,l}function Y(n,r){return r||={expand_denominator:!0,expand_functions:!0},se(n,r)}function se(n,r){if(Array.isArray(n))return n.map(m=>se(m,r));if("expand"in n&&typeof n.expand=="function")return n.expand(r);let l=n;if(r||={},l.group===y&&l.fname===""){let m=se(l.args[0],r),q=se(u.pow(m,u.parse(l.power)),r);return u.multiply(u.parse(l.multiplier),q).distributeMultiplier()}if([t,e,o].indexOf(l.group)!==-1)return l;let v=l.clone();try{let m=l.multiplier.toString(),q=Number(l.power),M=l;if(l.isComposite()&&mt(l.power)&&q>0){let I=q-1,H=new z(0);l.each(ae=>{H=u.add(H,se(u.parse(ae),r))});let ne=u.parse(H);for(let ae=0;ae<I;ae++)ne=Bn(ne,H,r);M=u.multiply(u.parse(m),ne).distributeMultiplier()}else if(l.group===y&&r.expand_functions===!0){let I=[];l.args.forEach(H=>{I.push(se(H,r))}),M=u.pow(u.symfunction(l.fname,I),u.parse(l.power)),M=u.multiply(M,u.parse(l.multiplier))}else if(l.isComposite()&&mt(l.power)&&q<0&&r.expand_denominator===!0){let I=l.invert();M=se(I,r),M.invert()}else if(l.group===C){let I=function(ae){switch(ae.group){case D:return 0;case L:return 1;case C:return 2;case y:return 3;default:return 4}},H=l.collectSymbols().sort((ae,qe)=>I(qe)-I(ae)).map(ae=>{let qe=u.pow(ae,u.parse(String(q)));return se(qe,r)}),ne=H.pop();ne.isComposite()&&ne.isLinear()?(H.forEach(ae=>{ne=Bn(ne,ae,r)}),ne.isComposite()?(Number(ne.power)>1&&(ne=se(u.pow(ne,u.parse(ne.power)),r)),M=u.multiply(u.parse(m),ne).distributeMultiplier()):M=ne):(M=ne,H.forEach(ae=>{M=u.multiply(M,ae)}),M=u.multiply(M,u.parse(m)).distributeMultiplier()),M.group===C&&(M=u.parse(M))}else M=l;return M}catch(m){if(m.message==="timeout")throw m;return v}}function me(n){return xt.identity(n)}function De(n,r){return r.isConstant()&&mt(r)?n.elements[Number(r)]:u.symfunction("vecget",[n,r])}function Te(n,r){return r=typeof r>"u"?1e-14:r,n=n.clone(),r=Number(r),n.elements.sort((l,v)=>v.group-l.group),n.elements=B1(n.elements,(l,v)=>Number(u.subtract(Nt(l),Nt(v)).abs())<=r),n}function je(n,r,l){return r.isConstant?(n.elements[Number(r)]=l,n):u.symfunction("vecset",[n,r,l])}function Ze(n,r,l){return r.isConstant()&&l.isConstant()?n.elements[Number(r)][Number(l)]:u.symfunction("matget",[n,r,l])}function Ve(n,r){return r.isConstant()?It.fromArray(n.elements[Number(r)]):u.symfunction("matgetrow",[n,r])}function et(n,r,l){if(!r.isConstant())return u.symfunction("matsetrow",[n,r,l]);if(n.elements[Number(r)].length!==l.elements.length)throw new gn("Matrix row must match row dimensions!");let v=n.clone();return v.elements[Number(r)]=l.clone().elements,v}function Be(n,r){if(!r.isConstant())return u.symfunction("matgetcol",[n,r]);let l=Number(r),v=xt.fromArray([]);return n.each((m,q,M)=>{M===l&&v.elements.push([m.clone()])}),v}function lt(n,r,l){if(!r.isConstant())return u.symfunction("matsetcol",[n,r,l]);let v=Number(r);if(n.rows()!==l.elements.length)throw new gn("Matrix column length must match number of rows!");return l.each(((m,q)=>{n.set(q-1,v,m.elements[0].clone())})),n}function ct(n,r,l,v){return n.elements[r][l]=v,n}function ft(...n){return new It(n)}function At(...n){return xt.fromArray(n)}function $t(...n){return g0.fromArray(n)}function Tt(n){return St(n)?n.determinant():n}function pt(n){let r;return St(n)?r=[new z(n.cols()),new z(n.rows())]:vt(n)||Cn(n)?r=new z(n.elements.length):Pt("size expects a matrix or a vector"),r}function Ft(n,r){return St(n)&&(n=new It(n)),St(r)&&(r=new It(r)),vt(n)&&vt(r)?n.dot(r):u.multiply(n.clone(),r.clone())}function _t(n,r){return St(n)&&(n=new It(n)),St(r)&&(r=new It(r)),vt(n)&&vt(r)?n.cross(r):u.multiply(n.clone(),r.clone())}function Ot(n){return St(n)?n.transpose():Pt("function transpose expects a matrix")}function Vt(n){return St(n)?n.invert():Pt("invert expects a matrix")}function Jt(n,r){return n.union(r)}function c0(n,r){return n.intersection(r)}function Yt(n,r){return n.contains(r)}function r0(n,r){return n.difference(r)}function Kt(n,r){return new z(Number(n.intersects(r)))}function v0(n,r){return new z(Number(n.isSubset(r)))}function f(n,r){r??=n;let l=ce.slice(n,r).map(v=>new z(v));return l.length===1?l[0]:l.length===0?new z(0):new It(l)}function E(...n){n.forEach(r=>{console.log(r.toString())})}function A(n){if(!gt(n.power)&&n.power.absEquals(.5)){let r=n.power.sign(),l=He(n.group===e?new z(n.value):n.toLinear());return r<0&&l.invert(),l}return n}function b(n){if(n.group===e){let r=n.value,l=Oi(r)[0];if(!l)return In("Unable to compute prime factors. This should not happen. Please review and report."),n;let m=new Fe(Math.log(r)/Math.log(l)).multiply(n.power);if(m.den>n.power.den)return n;mt(m)?n=new z(l**Number(m)):n=new z(l).setPower(m)}return n}this.expand=se,this.round=W,this.clean=re,this.sqrt=He,this.cbrt=Qe,this.abs=U,this.log=X,this.rationalize=We,this.nthroot=Je,this.arg=K,this.conjugate=k,this.imagpart=j,this.realpart=Z,this.getFunction=function(r){return i[r][0]},this.addPreprocessor=function(r,l,v,m){let{names:q}=_e,{actions:M}=_e;if(typeof l!="function")throw new Error("Incorrect parameters. Function expected!");v?m?(q.splice(v,0,r),M.splice(v,0,l)):(q[v]=r,M[v]=l):(q.push(r),M.push(l))},this.getPreprocessors=function(){let r={};for(let l=0,v=_e.names.length;l<v;l++){let m=_e.names[l];r[m]={order:l,action:_e.actions[l]}}return r},this.removePreprocessor=function(r,l){let v=_e.names.indexOf(r);l?(d0(_e.names,v),d0(_e.actions,v)):(_e.names[v]=void 0,_e.actions[v]=void 0)},this.mappedFunction=function(...r){let l={},{params:v}=this;for(let m=0;m<v.length;m++)l[v[m]]=String(r[m]);return u.parse(this.body,l)},this.add=function(r,l){let v=gt(r),m=gt(l);if(v&&m){let M=r,I=l;if(M.unit||I.unit)return u.Unit.add(M,I);if(M.isInfinity||I.isInfinity){let ht=M.multiplier.lessThan(0),tt=I.multiplier.lessThan(0);if(M.isInfinity&&I.isInfinity&&ht!==tt)throw new Ht(`(${M})+(${I}) is not defined!`);let nt=z.infinity();return tt&&nt.negate(),nt}if(M.isComposite()&&M.isLinear()&&I.isComposite()&&I.isLinear()&&(M.distributeMultiplier(),I.distributeMultiplier(),I.length>M.length&&M.group===I.group&&([M,I]=[I,M])),M.multiplier.equals(0))return I;if(I.multiplier.equals(0))return M;if(M.isConstant()&&I.isConstant()&&Oe.PARSE2NUMBER)return new z(M.multiplier.add(I.multiplier).toDecimal(Oe.PRECISION));let H=M.group,ne=I.group,ae=M.power.toString(),qe=I.power.toString();if(H<ne||H===ne&&Number(ae)>Number(qe)&&Number(qe)>0)return this.add(I,M);if(H===C&&ne===L&&M.value===I.value){let ht=M;M=I,I=ht,H=M.group,ne=I.group,ae=M.power.toString(),qe=I.power.toString()}let Ue=ae===qe,be=M.value,ke=I.value,st=M.isComposite(),bt=I.isComposite(),ze,Re,Ke;if(st&&(ze=Xt(M,"hash")),bt&&(Re=Xt(I,"hash")),H===D&&ne===D&&I.isLinear()&&!M.isLinear()&&ze!==Re)return this.add(I,M);H===L&&ne===L&&(be=ze,ke=Re);let Xe=H===e&&ne===t,Ye=M.value===I.multiplier.toString(),at=be===ke||ze===Re&&ze!==void 0||Xe&&Ye;if(at&&Ue&&H===ne)if(Xe&&(I=I.convert(e)),H===L&&(ne===o||ne===e))M.distributeMultiplier(),Ke=M.attach(I);else if(Ke=M,M.multiplier.isOne()&&I.multiplier.isOne()&&H===D&&M.isLinear()&&I.isLinear())for(let ht in I.symbols){if(!Object.hasOwn(I.symbols,ht))continue;let tt=I.symbols[ht];Ke.attach(tt)}else Ke.multiplier=Ke.multiplier.add(I.multiplier);else if(at&&H!==L)H===D&&ne===L?(I.insert(M,"add"),Ke=I):(Ke=z.shell(L).attach([M,I]),Ke.value=H===L?ze:be);else if(st&&M.isLinear()){let ht=H===ne,tt=H===L&&ne===L;if(tt&&(ht=M.value===I.value),M.distributeMultiplier(),I.isComposite()&&I.isLinear()&&ht){I.distributeMultiplier();for(let nt in I.symbols){if(!Object.hasOwn(I.symbols,nt))continue;let it=I.symbols[nt];M.attach(it)}Ke=M}else tt&&M.value!==Re||H===L&&!at?(Ke=z.shell(D).attach([M,I]),Ke.updateHash()):Ke=M.attach(I)}else{if(H===y&&M.fname===G&&ne!==h&&I.power.equals(.5)){let ht=I.multiplier.clone();I=He(I.toUnitMultiplier().toLinear()),I.multiplier=ht}M.length===2&&I.length===2&&Ut(M.power)&&Ut(I.power)?Ke=u.add(se(M),se(I)):(Ke=z.shell(D).attach([M,I]),Ke.updateHash())}Ke.multiplier.equals(0)&&(Ke=new z(0));let dt=Ke;if(dt.length===1){let ht=dt.multiplier,tt=J0(dt.symbols);return tt.multiplier=tt.multiplier.multiply(ht),tt}return Ke}if(m&&!v){let M=r;r=l,l=M;let I=m;m=v,v=I}let q=St(l);if(v&&q){let M=new xt;l.eachElement((H,ne,ae)=>{M.set(ne,ae,u.add(r.clone(),H))}),l=M}else if(St(r)&&q)l=r.add(l);else if(v&&vt(l)){let M=l;M.each((I,H)=>{H--,M.elements[H]=u.add(r.clone(),M.elements[H])})}else if(vt(r)&&vt(l)){let M=r,I=l;I.each((H,ne)=>{ne--,I.elements[ne]=u.add(M.elements[ne],I.elements[ne])})}else{if(vt(r)&&St(l))return u.add(l,r);if(St(r)&&vt(l)){if(l.elements.length===r.rows()){let M=new xt,I=r.cols();return l.each((H,ne)=>{let ae=[];if(vt(H))for(let qe=0;qe<I;qe++)ae.push(u.add(r.elements[ne-1][qe].clone(),H.elements[qe].clone()));else for(let qe=0;qe<I;qe++)ae.push(u.add(r.elements[ne-1][qe].clone(),H.clone()));M.elements.push(ae)}),M}Pt("Dimensions must match!")}}return l},this.subtract=function(r,l){let v=gt(r),m=gt(l),q;if(v&&m){let M=r,I=l;return M.unit||I.unit?u.Unit.subtract(M,I):this.add(M,I.negate())}if(m&&vt(r))l=r.map(M=>u.subtract(M,l.clone()));else if(v&&vt(l))l=l.map(M=>u.subtract(r.clone(),M));else if(vt(r)&&vt(l)||dn(r)&&dn(l))r.dimensions()===l.dimensions()?l=r.subtract(l):u.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(St(r)&&vt(l)){if(l.elements.length===r.rows()){let M=new xt,I=r.cols();return l.each((H,ne)=>{let ae=[];for(let qe=0;qe<I;qe++)ae.push(u.subtract(r.elements[ne-1][qe].clone(),H.clone()));M.elements.push(ae)}),M}Pt("Dimensions must match!")}else if(vt(r)&&St(l)){let M=l.clone().negate();return u.add(M,r)}else if(St(r)&&St(l))l=r.subtract(l);else if(St(r)&&m){let M=new xt;r.each((I,H,ne)=>{M.set(H,ne,u.subtract(I,l.clone()))}),l=M}else if(v&&St(l)){let M=new xt;l.each((I,H,ne)=>{M.set(H,ne,u.subtract(r.clone(),I))}),l=M}return l},this.multiply=function(r,l){let v=gt(r),m=gt(l);if(v&&l instanceof t0)return l.elements.push(r),l;if(v&&m){let I=r,H=l;if(H.isUnit){let Xe=I.clone();return I.unit=H,Xe}if(I.unit||H.unit)return u.Unit.multiply(I,H);if(I.isInfinity||H.isInfinity){if(I.equals(0)||H.equals(0))throw new Ht(`${I}*${H} is undefined!`);if(H.power.lessThan(0)){if(!I.isInfinity)return new z(0);throw new Ht("Infinity/Infinity is not defined!")}let Xe=I.multiplier.multiply(H.multiplier).sign(),Ye=z.infinity();if(I.isConstant()||H.isConstant()||I.isInfinity&&H.isInfinity)return Xe<0&&Ye.negate(),Ye}if(I.multiplier.equals(0)||H.multiplier.equals(0))return new z(0);if(I.isOne())return H.clone();if(H.isOne())return I.clone();if(I.isConstant()&&H.isConstant()&&Oe.PARSE2NUMBER){let Xe,Ye=I.multiplier.num.abs().toString().length,at=I.multiplier.den.toString().length,dt=Ye-at,ht=H.multiplier.num.abs().toString().length,tt=H.multiplier.den.toString().length,nt=ht-tt,it=Oe.PRECISION-5;if(dt<-it||dt>it||nt<-it||nt>it){let U0=new Me(String(I.multiplier.num)),a0=new Me(String(I.multiplier.den)),C0=new Me(String(H.multiplier.num)),G0=new Me(String(H.multiplier.den));Xe=new z(U0.times(C0).dividedBy(a0).dividedBy(G0).toFixed())}else{let U0=new Me(I.multiplier.toDecimal()),a0=new Me(H.multiplier.toDecimal()),C0=U0.times(a0).toFixed();Xe=new z(C0)}return Xe}if(H.group>I.group&&H.group!==D)return this.multiply(H,I);if(I.group===C&&H.group===L&&I.value===H.value){let Xe=I;I=H,H=Xe}let ne=I.group,ae=H.group,qe=H.multiplier.num,Ue=H.multiplier.den;if(ne===y&&I.fname===G&&!H.isConstant()&&I.args[0].value===H.value&&!I.args[0].multiplier.lessThan(0)){let Xe=I.power,Ye=u.parse(I.multiplier);I=u.multiply(Ye,I.args[0].clone()),I.setPower(new Fe(.5).multiply(Xe)),ne=I.group}else ne===y&&I.fname===G&&I.multiplier.equals(1)&&I.power.equals(-1)&&H.isConstant()&&I.args[0].equals(H)&&(I=u.symfunction(G,[H.clone()]),H=new z(1));let be=I.value,ke=H.value,st=new Fe(I.sign()),bt=ne===e&&ae===t&&H.multiplier.equals(I.value),ze=bt?new Fe(1).multiply(I.multiplier).abs():I.multiplier.multiply(H.multiplier).abs(),Re=I.clone().toUnitMultiplier();if(H=H.clone().toUnitMultiplier(!0),ne===y&&ae===y){let Xe=I.args[0].clone(),Ye=H.args[0].clone();if(I.fname===G&&H.fname===G&&I.isLinear()&&H.isLinear()){let at=u.divide(Xe,Ye).invert();at.gt(1)&&mt(at)&&(Re=u.multiply(I.args[0].clone(),He(at.clone())),H=new z(1))}else if(I.fname===B&&H.fname===B&&!Xe.isConstant()&&!Ye.isConstant()&&Number(H.power)<0){let at=u.subtract(Xe.clone(),Ye.clone());if(at.isConstant()){let dt=new z(1);if(Number(at)<0){for(let ht=0,tt=Math.abs(Number(at));ht<=tt;ht++){let nt=u.add(Xe.clone(),new z(ht));dt=u.multiply(dt,nt)}Re=u.multiply(u.pow(Xe,new z(I.power)),u.pow(dt,new z(H.power))),H=new z(1)}else{for(let ht=0,tt=Math.abs(Number(at));ht<=tt;ht++){let nt=u.add(Ye.clone(),new z(ht));dt=u.multiply(dt,nt)}Re=u.multiply(u.pow(dt,new z(I.power)),u.pow(Ye,new z(H.power))),H=new z(1)}}}}if(be===ke&&ne===L&&ne===ae&&(be=I.text("hash"),ke=H.text("hash")),ae===h&&H.previousGroup===L&&ne===L&&(be=Xt(I,"hash",h)),(be===ke||bt)&&!(ne===L&&(ae===o||ae===e||ae===y))&&!(ne===L&&ae===C)){let Xe=I.power,Ye=H.power,at=gt(Xe),dt=gt(Ye),ht=at||dt;ne===L&&ae!==L&&H.previousGroup!==L&&Xe.equals(1)?(Re=new z(0),I.each(tt=>{Re=u.add(Re,u.multiply(tt,H.clone()))},!0)):(ht?Re.power=u.add(gt(Xe)?Xe:new z(Xe),gt(Ye)?Ye:new z(Ye)):ne===t?Re.power=Xe:Re.power=Xe.add(Ye),Re.power.equals(0)&&(Re=Re.convert(t)),ht&&Re.convert(h),I.imaginary&&H.imaginary&&Ut(Number(Re.power)%2)&&(Re=new z(1),ze.negate()),Re.group!==h&&Re.previousGroup&&(Re.previousGroup=void 0),Re.multiplier=Re.multiplier.multiply(H.multiplier))}else if(ne===C&&I.isLinear())if(ae===C&&H.distributeExponent(),ae===C&&H.isLinear()){for(let Xe in H.symbols){if(!Object.hasOwn(H.symbols,Xe))continue;let Ye=H.symbols[Xe];Re=Re.combine(Ye)}Re.multiplier=Re.multiplier.multiply(H.multiplier)}else Re.combine(H);else if(ne===t)Re=H.clone().toUnitMultiplier(!0);else if(ne===C)Re.distributeExponent(),Re.combine(H);else if(!H.isOne()){let Xe=H.multiplier.clone();H.toUnitMultiplier(),Re=z.shell(C).combine([Re,H]),Re.multiplier=Re.multiplier.multiply(Xe)}if(Re.group===e){let Xe=Math.log(Number(Re.value)),Ye=Math.log(Number(qe))/Xe,at=Math.log(Number(Ue))/Xe,dt=Number(ze.num)/Number(qe),ht=Number(ze.den)/Number(Ue);Ye!==0&&mt(Ye)&&mt(dt)&&(Re.power=Re.power.add(new Fe(Ye)),ze.num=ze.num.divide(qe)),at!==0&&mt(at)&&mt(ht)&&(Re.power=Re.power.subtract(new Fe(at)),ze.den=ze.den.divide(Ue))}if(Re.length===1){let Xe=Re.multiplier;Re=J0(Re.symbols),Re.multiplier=Re.multiplier.multiply(Xe)}let Ke=Re.power.toString();if(Ut(Ke)&&Re.fname===G){st=st.multiply(new Fe(Re.sign()));let Xe=Re.power;Re=Re.args[0],Re=u.multiply(new z(ze),u.pow(Re,new z(Xe.divide(new Fe(2))))),st.lessThan(0)&&Re.negate()}else Re.multiplier=Re.multiplier.multiply(ze).multiply(st),Re.group===D&&Re.isImaginary()&&Re.distributeMultiplier();return Re.group===e&&mt(Re.power.toDecimal())&&(Re=Re.convert(t)),Re}if(m&&!v){let I=r;r=l,l=I;let H=m;m=v,v=H}let q=St(l),M=St(r);if(v&&q){let I=new xt;l.eachElement((ne,ae,qe)=>{I.set(ae,qe,u.multiply(r.clone(),ne))}),l=I}else if(M&&q)l=r.multiply(l);else if(v&&vt(l)){let I=l;I.each((H,ne)=>{ne--,I.elements[ne]=u.multiply(r.clone(),I.elements[ne])})}else if(vt(r)&&vt(l)){let I=r,H=l;H.each((ne,ae)=>{ae--,H.elements[ae]=u.multiply(I.elements[ae],H.elements[ae])})}else{if(vt(r)&&St(l))return this.multiply(l,r);if(St(r)&&vt(l)){let I=r,H=l;if(H.elements.length===I.rows()){let ne=new xt,ae=I.cols();return H.each((qe,Ue)=>{let be=[];for(let ke=0;ke<ae;ke++)be.push(u.multiply(I.elements[Ue-1][ke].clone(),qe.clone()));ne.elements.push(be)}),ne}Pt("Dimensions must match!")}}return l},this.divide=function(r,l){let v=gt(r),m=gt(l);if(v&&m){let I=r,H=l;if(I.unit||H.unit)return u.Unit.divide(I,H);let ne;if(H.equals(0))throw new yn("Division by zero not allowed!");return I.isConstant()&&H.isConstant()?(ne=I.clone(),ne.multiplier=ne.multiplier.divide(H.multiplier)):(H.invert(),ne=u.multiply(I,H)),ne}let q=vt(r),M=vt(l);if(v&&M)l=l.map(I=>u.divide(r.clone(),I));else if(q&&m)l=r.map(I=>u.divide(I,l.clone()));else if(q&&M){let I=r;I.dimensions()===l.dimensions()?l=l.map((H,ne)=>u.divide(I.elements[--ne],H)):u.error("Cannot divide vectors. Dimensions do not match!")}else{let I=St(r),H=St(l);if(I&&m){let ne=new xt;r.eachElement((ae,qe,Ue)=>{ne.set(qe,Ue,u.divide(ae,l.clone()))}),l=ne}else if(v&&H){let ne=new xt;l.eachElement((ae,qe,Ue)=>{ne.set(qe,Ue,u.divide(r.clone(),ae))}),l=ne}else if(I&&H){let ne=new xt,ae=r,qe=l;ae.rows()===qe.rows()&&ae.cols()===qe.cols()?(ae.eachElement((Ue,be,ke)=>{ne.set(be,ke,u.divide(Ue,qe.elements[be][ke]))}),l=ne):u.error("Dimensions do not match!")}else if(I&&M){let ne=r,ae=l;if(ne.cols()===ae.dimensions()){let qe=new xt;ne.eachElement((Ue,be,ke)=>{qe.set(be,ke,u.divide(Ue,ae.elements[be].clone()))}),l=qe}else u.error("Unable to divide matrix by vector.")}}return l},this.pow=function(r,l){let v=gt(r),m=gt(l);if(v&&m){let q=r,M=l;if(q.unit||M.unit)return u.Unit.pow(q,M);if(q.group===y&&q.fname===V&&Ut(M)){let ze=q.multiplier.clone(),Re=u.pow(q.args[0],M);return Re.multiplier=ze,Re}if(q.isInfinity||M.isInfinity){if(q.isInfinity&&M.isInfinity)throw new Ht(`(${q})^(${M}) is undefined!`);if(q.isConstant()&&M.isInfinity){if(q.equals(0)){if(M.lessThan(0))throw new Ht("0^Infinity is undefined!");return new z(0)}if(q.equals(1))throw new Ht(`1^${M.toString()} is undefined!`);if(M.lessThan(0))return new z(0);if(!q.lessThan(0))return z.infinity()}if(q.isInfinity&&M.isConstant()){if(M.equals(0))throw new Ht(`${q}^0 is undefined!`);return M.lessThan(0)?new z(0):u.multiply(z.infinity(),u.pow(new z(q.sign()),M.clone()))}}let I=q.equals(0),H=M.equals(0);if(I&&H)throw new Ht("0^0 is undefined!");if(I&&M.isConstant()&&M.multiplier.greaterThan(0))return new z(0);if(H)return new z(1);let ne=M.isConstant(),ae=q.isConstant(),qe=M.isInteger(),Ue=q.multiplier,be=q.clone();if(ae&&ne&&q.equals(0)&&M.lessThan(0))throw new Ht("Division by zero is not allowed!");if(Oe.PARSE2NUMBER&&ae&&ne&&q.sign()<0&&mn(M)){let ze=Math.PI*Number(M.multiplier.toDecimal()),Re=new z(Math.cos(ze)),Ke=u.multiply(z.imaginary(),new z(Math.sin(ze)));return u.add(Re,Ke)}if(Oe.PARSE2NUMBER&&q.isImaginary()&&ne&&mt(M)&&!M.lessThan(0)){let ze,Re,Ke,Xe,Ye,at=q.realpart(),dt=q.imagpart();if(at.isConstant("all")&&dt.isConstant("all"))return Ye=Oe.USE_BIG?new z(rn.atan2(dt.multiplier.toDecimal(),at.multiplier.toDecimal()).times(M.toString())):Math.atan2(Number(dt.multiplier.toDecimal()),Number(at.multiplier.toDecimal()))*Number(M.multiplier.toDecimal()),Re=new z(Ye),ze=u.pow(z.hyp(at,dt),M),Ke=u.multiply(ze.clone(),u.trig.cos(Re.clone())),Xe=u.multiply(ze,u.trig.sin(Re)),u.add(Ke,u.multiply(z.imaginary(),Xe))}be.toUnitMultiplier();let ke;if(be.group===y&&be.fname===G&&!ne){let ze=be.args[0];ze.multiplyPower(new z(.5)),ze.multiplier.multiply(be.multiplier),ze.multiplyPower(M),be=ze}else ke=Ue.sign(),mn(M)&&ke<0&&(be.negate(),be=u.symfunction(Ee,[be]),be.negate()),be.multiplyPower(M);let st,bt;if(ae&&ne&&Oe.PARSE2NUMBER){let ze;ke<0&&(q.negate(),M.multiplier.den.equals(2)?ze=new z(Oe.IMAGINARY):mt(M.multiplier)?Ut(M.multiplier)?ze=new z(1):ze=new z(-1):Ut(M.multiplier.den)?ze=u.pow(u.symfunction(Ee,[new z(ke)]),M.clone()):ze=new z(ke**M.multiplier.num));let Re=Number(q.multiplier.toDecimal())**Number(M.multiplier.toDecimal());if(Re!==0||q.multiplier.equals(0))be=new z(Re);else{let Ke=new Me(q.multiplier.toDecimal()),Xe=new Me(M.multiplier.toDecimal());be=new z(Ke.pow(Xe).toFixed())}ze&&(be=u.multiply(be,ze))}else if(qe&&!Ue.equals(1)){if(M.abs().gt(Oe.MAX_EXP))return M.sign()<0?new z(0):z.infinity();let Re=M.multiplier.toDecimal(),Ke=Math.sign(Number(Re)),Xe=Math.abs(Number(Re)),Ye=new Fe(1);Ye.num=Ue.num.pow(Number(Xe)),Ye.den=Ue.den.pow(Number(Xe)),Ke<0&&Ye.invert(),be.multiplier=be.multiplier.multiply(Ye)}else{let ze=q.sign();if(M.isConstant()&&q.isConstant()&&!M.multiplier.den.equals(1)&&ze<0)if(M.multiplier.den.equals(2)){let Re=new z(Oe.IMAGINARY);q.negate(),M.lessThan(0)&&(Re.negate(),M.negate()),be=u.multiply(u.pow(q,M),Re)}else{let Re=q.clone();Re.multiplier.negate(),be=u.pow(u.symfunction(Ee,[new z(ke)]),M.clone());let Ke=u.pow(new z(Re.multiplier.num),M.clone()),Xe=u.pow(new z(Re.multiplier.den),M.clone()),Ye=u.divide(Ke,Xe);be=u.multiply(be,Ye)}else if(Oe.PARSE2NUMBER&&M.isImaginary()){let Re=M.realpart(),Ke=M.imagpart(),Xe=q.clone().toLinear(),Ye=u.pow(Xe.clone(),Re),at=X(Xe.clone()),dt=ge.cos(u.multiply(Ke.clone(),at)),ht=u.multiply(ge.sin(u.multiply(Ke,X(Xe))),z.imaginary());be=u.multiply(Ye,u.add(dt,ht)),be=u.expand(u.parse(be))}else{let Re=q.group===t&&ze<0;if(st=A(new z(Re?Number(Ue.num):Math.abs(Number(Ue.num))).setPower(M.clone())),bt=A(new z(Number(Ue.den)).setPower(M.clone()).invert()),q.imaginary)if(qe){let Ke=Math.sign(M),Ye=U(M)%4;be=new z(Ut(Ye)?-1:Oe.IMAGINARY),(Ye===0||Ke<0&&Ye===1||Ke>0&&Ye===3)&&be.negate()}else{let Ke=l.multiplier.multiply(Fe.quick(1,2)),Xe=(-1)**Ke.num;be=Ut(Ke.den)?new z(-1).setPower(Ke,!0):new z(Xe)}if(ze<0&&!Re&&be.negate(),ne&&q.group!==h){let Ke=Ut(M.multiplier.den),Xe=Ut(q.power),Ye=be.power.toDecimal(),at=Ut(Ye);if(Ke&&Xe&&!at){if(Ye==="1"||Ye==="1")typeof be.value=="string"&&be.value.startsWith("baseunit_")||(be=u.symfunction(V,[be]));else if(mt(Ye))be=u.multiply(u.symfunction(V,[be.clone().toLinear()]),be.clone().setPower(new Fe(Number(Ye)-1)));else{let dt=be.power;be=u.symfunction(V,[be.toLinear()]).setPower(dt)}Oe.POSITIVE_MULTIPLIERS&&be.fname===V&&(be=be.args[0])}}if(M.equals(2)&&be.group===C){let Ke=new z(1);be.each(Xe=>{Ke=u.multiply(Ke,u.pow(Xe,M))}),be=Ke}}}if(be=A(be),st&&bt&&(be=u.multiply(be,b(u.multiply(st,bt)))),be.fname===G){let ze=be.group===h,Re=ze?be.power.multiplier.toString():be.power.toString();if(Ut(Re)){let Ke=ze?u.divide(be.power,new z(2)):new z(be.power.divide(new Fe(2))),Xe=be.multiplier;be=u.pow(be.args[0],Ke),be.multiplier=be.multiplier.multiply(Xe)}}else if(!Oe.IGNORE_E&&be.isE()&&be.group===h&&be.power.contains("pi")&&be.power.contains(Oe.IMAGINARY)&&M.group===C){let ze=M.stripVar(Oe.IMAGINARY);be=u.add(ge.cos(ze),u.multiply(z.imaginary(),ge.sin(ze)))}return be}if(vt(r)&&m)r=r.map(q=>u.pow(q,l.clone()));else if(St(r)&&m){let q=new xt;r.eachElement((M,I,H)=>{q.set(I,H,u.pow(M,l.clone()))}),r=q}else if(v&&St(l)){let q=new xt;l.eachElement((M,I,H)=>{q.set(I,H,u.pow(r.clone(),M))}),r=q}return r},this.comma=function(r,l){return r instanceof t0||(r=t0.create(r)),r.append(l),r},this.mod=function(r,l){return Se(r,l)},this.slice=function(r,l){return new xe(r,l)},this.equals=function(r,l){return r.group!==o&&!r.isLinear()&&Pt(`Cannot set equality for ${r.toString()}`),pe[r.value]=l.clone(),l},this.percent=function(r){return u.divide(r,new z(100))},this.assign=function(r,l){if(r instanceof t0&&l instanceof t0)return r.elements.map((v,m)=>u.assign(v,l.elements[m])),It.fromArray(l.elements);if(r.parent){let v=r.parent;return v.elements[v.getter]=l,delete v.getter,v}if(r.group!==o)throw new jn(`Cannot complete operation. Incorrect LH value for ${r}`);return pe[r.value]=l,l},this.functionAssign=function(r,l){let v=r.elements.pop();return On(v,r.elements,l)};let T=function(r){return new z(r===!0?1:0)};this.eq=function(r,l){return T(r.equals(l))},this.gt=function(r,l){return T(r.gt(l))},this.gte=function(r,l){return T(r.gte(l))},this.lt=function(r,l){return T(r.lt(l))},this.lte=function(r,l){return T(r.lte(l))},this.factorial=function(r){return this.symfunction(B,[r])},this.dfactorial=function(r){return this.symfunction(we,[r])}}},Fi={allSame:Q0,allNumeric:k1,arguments2Array:x1,armTimeout:t1,arrayAddSlices:D1,arrayClone:$1,arrayMax:U1,arrayMin:Mn,arrayEqual:P1,arrayUnique:An,err:Pt,arrayGetVariables:xi,arraySum:Li,block:Bt,checkTimeout:en,clearU:X1,comboSort:V1,compare:Ri,convertToVector:l1,customError:jt,customType:L1,decompose_fn:o1,disarmTimeout:n1,each:Wn,evaluate:Nt,even:Ut,evenFraction:mn,fillHoles:Ui,firstObject:J0,format:qt,generatePrimes:i1,getCoeffs:qi,getU:Pi,importFunctions:Di,inBrackets:Mt,isArray:Dt,isCollection:dn,isExpression:r1,isFraction:_n,isInt:mt,isMatrix:St,isNegative:tn,isNumericSymbol:q0,isPrime:$0,isReserved:K0,isSet:Cn,isSymbol:gt,isVariableSymbol:Qn,isVector:vt,keys:bn,knownVariable:F1,nroots:Ti,remove:d0,reserveNames:k0,range:q1,round:m0,sameSign:O1,scientificToDecimal:F0,separate:s1,stringReplace:R1,text:Xt,validateName:w0,variables:n0,warn:In};function ki(){return(function(t,e,o,h){t1();try{let y=te.parser,L=te.state.EXPRESSIONS,C=!1;if((typeof t=="string"||typeof t=="function")&&On(t))return te.libExports;t!==null&&typeof t=="object"&&t instanceof S0&&(t=t.toString()),t!==null&&typeof t=="object"&&"text"in t&&typeof t.text=="function"&&(t=t.text()),Dt(o)||(o=typeof o>"u"?[]:[o]),o.forEach(V=>{if(V==="numer"){C=!0;return}let B=y.functions[V];B&&B[1]===1&&(t=`${V}(${t})`)});let D=Bt("PARSE2NUMBER",()=>y.parse(t,e),C||Oe.PARSE2NUMBER),G=new S0(D);return h?L[h-1]=G:L.push(G),G}finally{n1()}})}function Bi(){let s=te.parser;return{groups:M1,NerdamerSymbol:z,Expression:S0,Collection:t0,Frac:Fe,Vector:It,Matrix:xt,NerdamerSet:g0,Math2:ut,LaTeX:yt,Build:e0,Utils:Fi,PARSER:s,Settings:Oe,bigInt:Nn,bigDec:rn,exceptions:te.exceptions,Solve:{},Calculus:{},Algebra:{},Extra:{}}}function Vi(){let s=te.parser;k0(s.CONSTANTS),k0(s.functions),s.initConstants(),s.error||=Pt,Oe.LOG_FNS={log:s.functions.log,log10:s.functions.log10}}function Xi(s){s.rpn=pi,s.convertToLaTeX=si,s.convertFromLaTeX=wi,s.version=J1,s.getWarnings=G1,s.setConstant=Mi,s.getConstant=ni,s.clearConstants=Ni,s.setFunction=Ci,s.clearFunctions=vi,s.getCore=Y1,s.getExpression=s.getEquation=S0.getExpression,s.reserved=Q1,s.clear=Kn,s.flush=yi,s.expressions=mi,s.functions=di,s.register=e1,s.validateName=w0,s.validVarName=W1,s.supported=ei,s.numEquations=s.numExpressions=j1,s.setVar=Ai,s.getVar=ii,s.clearVars=Si,s.load=Ei,s.getVars=ri,s.set=Sn,s.get=z1,s.updateAPI=bi,s.replaceFunction=gi,s.setOperator=ai,s.getOperator=oi,s.aliasOperator=li,s.tree=Yn,s.htmlTree=hi,s.addPeeker=ui,s.removePeeker=ci,s.parse=fi}var Gi=(function(){let t=new nn;te.parser=t,te.classes.Parser=nn,yt.initParser(),e0.initDependencies(),Vi();let e=Bi();te.core=e,te.classes.Math2=e.Math2,te.utils.symfunction=t.symfunction.bind(t),te.utils.callfunction=t.callfunction.bind(t),te.state.CONSTANTS=t.CONSTANTS;let o=ki();return te.libExports=o,Xi(o),o.updateAPI(),o})();typeof vn<"u"&&(vn.exports=Gi)});var V0=f0((Ji,a1)=>{"use strict";var B0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof a1<"u"&&B0===void 0&&(B0=T0(),X0());(function(){let t=B0.getCore(),e=t.PARSER,{Frac:o}=t,{Settings:h}=t,{isSymbol:y}=t.Utils,{FN:L}=t.groups,{NerdamerSymbol:C}=t,{text:D}=t.Utils,{inBrackets:G}=t.Utils,{isInt:V}=t.Utils,{format:B}=t.Utils,{even:we}=t.Utils,{evaluate:Ee}=t.Utils,{N:Me}=t.groups,{S:ce}=t.groups,{PL:pe}=t.groups,{CP:fe}=t.groups,{CB:u}=t.groups,{EX:Ne}=t.groups,{P:_e}=t.groups,{LOG:xe}=h,ye="exp",$e="abs",ge="sqrt",ve="sin",Ie="cos",le="tan",i="sec",a="csc",c="cot",S="asin",w="acos",N="atan",_="asec",R="acsc",U="acot",F="sinh",ie="cosh",oe="tanh",Se="csch",he="sech",Ce="coth",Ae="asech",de="acsch",Le="acoth";function Pe(Z){return y(Z.power)&&(Z.power.group===ce||Z.power.group===u)}function Ge(Z){this.message=Z||""}Ge.prototype=new Error,C.prototype.hasIntegral=function(){return this.containsFunction("integrate")},C.prototype.fnTransform=function(){if(this.group!==L)return this;let j,k=this.args[0],K=new C(this.multiplier),O=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case F:j=e.parse(B("(e^({0})-e^(-({0})))/2",k));break;case ie:j=e.parse(B("(e^({0})+e^(-({0})))/2",k));break;case oe:j=e.parse(B("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",k));break;case le:j=e.parse(B("sin({0})/cos({0})",k));break;case a:j=e.parse(B("1/sin({0})",k));break;case i:j=e.parse(B("1/cos({0})",k));break;default:j=O}else if(this.power.equals(2))switch(this.fname){case ve:j=e.parse(B("1/2-cos(2*({0}))/2",k));break;case Ie:j=e.parse(B("1/2+cos(2*({0}))/2",k));break;case le:j=e.parse(B("sin({0})^2/cos({0})^2",k));break;case ie:j=e.parse(B("1/2+cosh(2*({0}))/2",k));break;case F:j=e.parse(B("-1/2+cosh(2*({0}))/2",k));break;case oe:j=e.parse(B("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",k));break;case i:j=e.parse(B("(1-cos(2*({0})))/(1+cos(2*({0})))+1",k));break;default:j=O}else if(this.fname===i)j=e.parse(B("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===a)j=e.parse(B("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===le)this.power.lessThan(0)?j=e.parse(B("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):j=e.parse(B("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===ve&&this.power.lessThan(0))j=e.parse(B("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===Ie&&this.power.lessThan(0))j=e.parse(B("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===ve&&this.power.equals(3))j=e.parse(B("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===Ie&&this.power.equals(3))j=e.parse(B("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===Ie||this.fname===ve)&&we(this.power)){let $=this.power/2,g=this.clone().toLinear(),p=e.pow(g,e.parse(2)),P=e.expand(e.pow(p.fnTransform(),e.parse($)));j=new C(0),P.each(d=>{let x=d.fnTransform();j=e.add(j,x)},!0)}else j=O;return e.multiply(j,K)},C.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===ce)return!1;if(this.fname&&(t.Utils.inTrig(this.fname)||t.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let j in this.symbols)if(this.symbols[j].hasTrig())return!0}return!1},t.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},t.Utils.toCommonDenominator=function(j){if(j.isComposite()&&j.isLinear()){let k=new C(j.multiplier),K=new C(1),O=new C(0);return j.each(g=>{K=e.multiply(K,g.getDenom())},!0),j.each(g=>{let p=g.getNum(),P=g.getDenom(),d=e.multiply(p,e.divide(K.clone(),P));O=e.add(O,d)}),e.multiply(k,t.Algebra.divide(e.expand(O),e.expand(K)))}return j},t.Utils.inInverseTrig=function(j){return[S,w,N,R,_,U].indexOf(j)!==-1},t.Utils.inTrig=function(j){return[Ie,ve,le,i,a,c].indexOf(j)!==-1},t.Utils.inHtrig=function(j){return[F,ie,oe,de,Ae,Le].indexOf(j)!==-1},t.Matrix.jacobian=function(j,k){let K=new t.Matrix;return k||=t.Utils.arrayGetVariables(j),k.forEach((O,$)=>{j.forEach((g,p)=>{let P=t.Calculus.diff(g.clone(),O);K.set(p,$,P)})}),K},t.Matrix.prototype.max=function(){let j=new C(0);return this.each(k=>{let K=k.abs();K.gt(j)&&(j=K)}),j},t.Matrix.cMatrix=function(j,k){let K=new t.Matrix;return k.forEach((O,$)=>{K.set($,0,e.parse(j))}),K};let We=t.Utils.allFunctions=function(j){for(let k=0,K=j.length;k<K;k++)if(j[k].group!==L)return!1;return!0},He=t.Utils.cosAsinBtranform=function(j,k){let K=j.args[0],O=k.args[0];return e.parse(B("(sin(({0})+({1}))-sin(({0})-({1})))/2",K,O))},Qe=t.Utils.cosAsinAtranform=function(j,k){if(Number(k.power)!==1)return e.multiply(j,k);let K=j.args[0];return e.parse(B("(sin(2*({0})))/2",K))},rt=t.Utils.cosAsinBtranform=function(j,k){let K=j.args[0],O=k.args[0];return e.parse(B("(cos(({0})+({1}))-cos(({0})-({1})))/2",K,O))},Je=t.Utils.trigTransform=function(j){let k={},K,O,$=new C(1);for(let g=0,p=j.length;g<p;g++)if(K=j[g],K.group===L){let{fname:P}=K;P===Ie&&k[ve]?(k[ve].args[0].toString()===K.args[0].toString()?O=Qe(K,k[ve]):O=He(K,k[ve]),delete k[ve],$=e.multiply($,O)):P===ve&&k[Ie]?(k[Ie].args[0].toString()===K.args[0].toString()?O=Qe(K,k[Ie]):O=He(K,k[Ie]),delete k[Ie],$=e.multiply($,O)):P===ve&&k[ve]?(k[ve].args[0].toString()===K.args[0].toString()?(O=e.multiply(K,k[ve]),delete k[ve]):(O=rt(K,k[ve]),delete k[ve]),$=O):k[P]=K}else $=e.multiply($,K);for(let g in k)Object.hasOwn(k,g)&&($=e.multiply($,k[g]));return $};t.Settings.integration_depth=10,t.Settings.max_lim_depth=10;let J=t.Calculus={version:"1.4.6",sum(Z,j,k,K){if(j.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${D(j)} provided`);let O=j.value,$;if(t.Utils.isNumericSymbol(k)&&t.Utils.isNumericSymbol(K)){let g=Number(K)-Number(k)<200?"":"PARSE2NUMBER",p=Number(k),P=Number(K);$=t.Utils.block(g,()=>{let d=Z.text(),x={"~":!0},X=new t.NerdamerSymbol(0);for(let W=p;W<=P;W++){x[O]=new C(W);let Q=e.parse(d,x);X=e.add(X,Q)}return X})}else $=e.symfunction("sum",[Z,new C(O),k,K]);return $},product(Z,j,k,K){if(j.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${D(j)} provided`);let O=j.value,$;if(t.Utils.isNumericSymbol(k)&&t.Utils.isNumericSymbol(K)){let g=Number(K)-Number(k)<200?"":"PARSE2NUMBER";$=t.Utils.block(g,()=>{let p=Number(k),P=Number(K.multiplier),d=Z.text(),x={},X=new t.NerdamerSymbol(1);for(let W=p;W<=P;W++)x[O]=new C(W),X=e.multiply(X,e.parse(d,x));return X})}else $=e.symfunction("product",[Z,new C(O),k,K]);return $},diff(Z,j,k){if(t.Utils.isVector(Z)){let d=new t.Vector([]);return Z.each(x=>{d.elements.push(J.diff(x,j,k))}),d}if(t.Utils.isMatrix(Z)){let d=new t.Matrix;return Z.each((x,X,W)=>{d.set(X,W,J.diff(x,j,k))}),d}let K=Z;if(K.LHS&&K.RHS)return new t.Equation(J.diff(K.LHS.clone(),j,k),J.diff(K.RHS.clone(),j,k));let O=y(j)?j.text():j;if(k=y(k)?k.multiplier.toDecimal():k||1,O===void 0&&(O=t.Utils.variables(Z)[0]),K.group===L&&K.fname===ge){let d=K.args[0],x=K.power.clone();(d.group!==Me||d.group!==_e)&&(d.power=y(d.power)?e.multiply(e.multiply(d.power,new C(1/2)),new C(x)):d.power.multiply(new o(.5)).multiply(x),d.multiplier=d.multiplier.multiply(K.multiplier)),Z=d}if(Z.group===L&&!y(Z.power)){let d=g(e.parse(Z)),x=J.diff(Z.args[0].clone(),O);Z=e.multiply(d,x)}else Z=g(Z);return k>1&&(k--,Z=J.diff(Z,j,k)),Z;function $(d){return(d.value===O||d.contains(O,!0))&&(d.multiplier=d.multiplier.multiply(d.power),d.power=d.power.subtract(new o(1)),d.power.equals(0)&&(d=new C(d.multiplier))),d}function g(d){let x=d.group,X,W,Q;if(x===Me||x===ce&&d.value!==O||x===_e)d=new C(0);else if(x===ce)d=$(d);else if(x===u){let ee=d.multiplier.clone();d.toUnitMultiplier();let re=e.multiply(P(d),$(d));return re.multiplier=re.multiplier.multiply(ee),re}else if(x===L&&d.power.equals(1)){let ee=d.multiplier.clone();switch(d.toUnitMultiplier(),d.fname){case xe:Q=d.clone(),d=d.args[0].clone(),d.power=d.power.negate(),d.multiplier=Q.multiplier.divide(d.multiplier);break;case Ie:d.fname=ve,d.multiplier.negate();break;case ve:d.fname=Ie;break;case le:d.fname=i,d.power=new o(2);break;case i:d=p(d,le);break;case a:d=p(d,"-cot");break;case c:d.fname=a,d.multiplier.negate(),d.power=new o(2);break;case S:d=e.parse(`(sqrt(1-(${D(d.args[0])})^2))^(-1)`);break;case w:d=e.parse(`-(sqrt(1-(${D(d.args[0])})^2))^(-1)`);break;case N:d=e.parse(`(1+(${D(d.args[0])})^2)^(-1)`);break;case $e:W=d.args[0].clone(),W.toUnitMultiplier(),d=e.parse(`${G(D(d.args[0]))}/abs${G(D(W))}`);break;case"parens":d=new C(1);break;case"cosh":d.fname="sinh";break;case"sinh":d.fname="cosh";break;case oe:d.fname=he,d.power=new o(2);break;case he:d=p(d,"-tanh");break;case Se:{let re=String(d.args[0]);d=e.parse(`-coth(${re})*csch(${re})`);break}case Ce:{let re=String(d.args[0]);d=e.parse(`-csch(${re})^2`);break}case"asinh":d=e.parse(`(sqrt(1+(${D(d.args[0])})^2))^(-1)`);break;case"acosh":d=e.parse(`(sqrt(-1+(${D(d.args[0])})^2))^(-1)`);break;case"atanh":d=e.parse(`(1-(${D(d.args[0])})^2)^(-1)`);break;case Ae:{let re=String(d.args[0]);d=e.parse(`-1/(sqrt(1/(${re})^2-1)*(${re})^2)`);break}case Le:d=e.parse(`-1/((${d.args[0]})^2-1)`);break;case de:{let re=String(d.args[0]);d=e.parse(`-1/(sqrt(1/(${re})^2+1)*(${re})^2)`);break}case _:{let re=String(d.args[0]);d=e.parse(`1/(sqrt(1-1/(${re})^2)*(${re})^2)`);break}case R:{let re=String(d.args[0]);d=e.parse(`-1/(sqrt(1-1/(${re})^2)*(${re})^2)`);break}case U:d=e.parse(`-1/((${d.args[0]})^2+1)`);break;case"S":{let re=String(d.args[0]);d=e.parse(`sin((pi*(${re})^2)/2)`);break}case"C":{let re=String(d.args[0]);d=e.parse(`cos((pi*(${re})^2)/2)`);break}case"Si":{let re=d.args[0];d=e.parse(`sin(${re})/(${re})`);break}case"Shi":{let re=d.args[0];d=e.parse(`sinh(${re})/(${re})`);break}case"Ci":{let re=d.args[0];d=e.parse(`cos(${re})/(${re})`);break}case"Chi":{let re=d.args[0];d=e.parse(`cosh(${re})/(${re})`);break}case"Ei":{let re=d.args[0];d=e.parse(`e^(${re})/(${re})`);break}case"Li":{let re=d.args[0];d=e.parse(`1/${h.LOG}(${re})`);break}case"erf":d=e.parse(`(2*e^(-(${d.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let re=String(d.args[0]),Y=String(d.args[1]);d=e.parse(`(${Y})/((${Y})^2+(${re})^2)`);break}case"sign":d=new C(0);break;case"sinc":d=e.parse(B("(({0})*cos({0})-sin({0}))*({0})^(-2)",d.args[0]));break;case h.LOG10:d=e.parse(`1/((${d.args[0]})*${h.LOG}(10))`);break;default:d=e.symfunction("diff",[d,j])}d.multiplier=d.multiplier.multiply(ee)}else if(x===Ne||x===L&&y(d.power)){let ee;x===Ne?ee=d.value:x===L&&d.contains(O)?ee=d.fname+G(D(d.args[0])):ee=d.value+G(D(d.args[0])),W=J.diff(e.multiply(e.parse(xe+G(ee)),d.power.clone()),O),d=e.multiply(d,W)}else if(x===L&&!d.power.equals(1))W=d.clone(),W.toLinear(),W.toUnitMultiplier(),d=e.multiply($(d.clone()),g(W));else if(x===fe||x===pe){let ee=d.clone(),re=new C(0);for(let Y in d.symbols)Object.hasOwn(d.symbols,Y)&&(re=e.add(re,J.diff(d.symbols[Y].clone(),O)));d=e.multiply($(ee),re)}return d.updateHash(),d}function p(d,x,X){return e.multiply(d,e.parse(x+G(X||D(d.args[0]))))}function P(d){let x=d.collectSymbols(),X=new C(0),W=x.length;for(let Q=0;Q<W;Q++){let ee=J.diff(x[Q].clone(),O);for(let re=0;re<W;re++)Q!==re&&(ee=e.multiply(ee,x[re].clone()));X=e.add(X,ee)}return X}},integration:{u_substitution(Z,j){let k="__u__";function K(x,X,W){let Q=J.diff(X,j),ee=W?W(x,X):e.divide(x.clone(),Q);return ee.contains(j,!0)?null:ee}function O(x,X){let W=J.integrate(e.symfunction(x,[new C(k)]),k,0);return W=W.sub(new C(k),X),W.updateHash(),W}let $=Z[0].clone(),g=Z[1].clone(),p=$.group,P=g.group,d;if(p===L&&P!==L){let x=$.args[0];if(d=K(g,x.clone()),d)return e.multiply(d,O($.fname,x));if(d=K(g,$),d)return J.integration.poly_integrate($)}else if(P===L&&p!==L){let x=g.args[0];if(d=K($,x.clone()),d)return e.multiply(d,O(g.fname,x))}else if(p===L&&P===L){if(d=K($.clone(),g.clone()),d||(d=K(g.clone(),$.clone()),d))return e.multiply(J.integration.poly_integrate(g),d)}else if(p===Ne&&P!==Ne){let x=$.power;if(d=K(g,y(x)?x.clone():new C(x)),!d){let Q=J.integration.decompose_arg(y(x)?x.clone():new C(x),j),ee=J.diff(Q[2].clone(),j),re=J.integration.decompose_arg(ee.clone(),j);if(e.multiply(Q[1],re[1]).power.equals(g.power)){let Y=e.divide(Q[0].clone(),re[0].clone()),se=e.multiply(Y.clone(),e.pow(new C($.value),e.multiply(Q[0],new C(k))));return se=e.multiply(se,new C(k)),J.integration.by_parts(se,k,0,{}).sub(k,Q[1].clone())}}let X=J.integrate($.sub(x.clone(),new C(k)),k,0);return e.multiply(X.sub(new C(k),x),d)}else if(P===Ne&&p!==Ne){let x=g.power;d=K($,x.clone());let X=J.integrate(g.sub(x,new C(k)),k,0);return e.multiply(X.sub(new C(k),x),d)}else if($.isComposite()||g.isComposite()){let x=function(Q,ee){let re=J.diff(ee,j),Y=t.Algebra.Factor.factorInner(Q),se=t.Algebra.Factor.factorInner(re);return e.divide(Y,se)},X=$.isComposite()?$.clone().toLinear():$.clone(),W=g.isComposite()?g.clone().toLinear():g.clone();if(d=K(X.clone(),W.clone(),x),d)return e.multiply(J.integration.poly_integrate(g),d);if(d=K(W.clone(),X.clone(),x),d)return e.multiply(J.integration.poly_integrate($),d)}},poly_integrate(Z){let j=Z.power.toString(),k=Z.multiplier.toDecimal(),K=Z.toUnitMultiplier().toLinear();return Number(j)===-1?e.multiply(new C(k),e.symfunction(xe,[K])):e.parse(B("({0})*({1})^(({2})+1)/(({2})+1)",k,K,j))},stop(Z){throw Z||="Unable to compute integral!",t.Utils.warn(Z),new Ge(Z)},partial_fraction(Z,j,k,K){y(j)||(j=e.parse(j));let O;O=new C(0);let $=t.Algebra.PartFrac.partfrac(Z,j);return $.group===u&&$.isLinear()?($.each(g=>{g.isLinear()||J.integration.stop()}),$.each(g=>{O=e.add(O,J.integrate(g,j,k,K))})):O=e.add(O,J.integrate($,j,k,K)),O},get_udv(Z){let j=[[],[],[],[],[]],k=function($){let g=$.group;if(g===L){let{fname:p}=$;t.Utils.inTrig(p)||t.Utils.inHtrig(p)?j[3].push($):t.Utils.inInverseTrig(p)?j[1].push($):p===xe?j[0].push($):J.integration.stop()}else g===ce||$.isComposite()&&$.isLinear()||g===u&&$.isLinear()?j[2].push($):g===Ne||$.isComposite()&&!$.isLinear()?j[4].push($):J.integration.stop()};Z.group===u?Z.each($=>{k(C.unwrapSQRT($,!0))}):k(Z);let K,O=new C(1);for(let $=0;$<5;$++){let g=j[$],p,P=g.length;if(P>0){if(P>1){p=new C(1);for(let d=0;d<P;d++)p=e.multiply(p,g[d].clone())}else p=g[0].clone();K?O=e.multiply(O,p):(K=p,K.multiplier=K.multiplier.multiply(Z.multiplier))}}return[K,O]},trig_sub(Z,j,k,K,O,$){O||=J.integration.decompose_arg(Z.clone().toLinear(),j);let g=O[3],p=O[2],P=O[0],d=O[1];if(d.power.equals(2)&&P.greaterThan(0)){let x=t.Utils.getU(Z),X=e.parse(le+G(x)),W=e.parse(`${i+G(x)}^2`),Q=e.multiply(Z.sub(d,X),W),ee=J.integrate(Q,x,k,K).sub(X,d);return t.Utils.clearU(X),ee}},by_parts(Z,j,k,K){K.previous||=[];let O,$=J.integration.get_udv(Z),g=$[0],p=$[1],P=C.unwrapSQRT(e.expand(J.diff(g.clone(),j)),!0),d=P.clone().stripVar(j);P=e.divide(P,d.clone());let x=J.integrate(p.clone(),j,k||0),X=e.multiply(x.clone(),P),W=X.toString();if(K.previous.indexOf(W)!==-1&&t.Utils.inTrig(g.fname)&&p.isE())return K.is_cyclic=!0,new C(1);K.previous.push(W);let Q=e.multiply(g,x),ee=X.multiplier.clone();X.toUnitMultiplier();let re=e.multiply(J.integrate(X.clone(),j,k,K),d);if(re.multiplier=re.multiplier.multiply(ee),O=e.subtract(Q,re),K.is_cyclic&&(K.previous.pop(),K.previous.length===0)){O=e.expand(O);let Y=new C(0);O.each(se=>{se.contains(j)||(Y=e.add(Y,se.clone()))}),O=e.divide(e.subtract(O,Y.clone()),e.subtract(new C(1),Y))}return O},decompose_arg:t.Utils.decompose_fn},integrate(Z,j,k,K){if(!j){let O=t.Utils.variables(Z);O.length===1&&(j=O[0]),j||="x"}if(t.Utils.isVector(Z)){let O=new t.Vector([]);return Z.each($=>{O.elements.push(J.integrate($,j))}),O}return isNaN(parseFloat(j))||e.error(`variable expected but received ${j}`),Z.isConstant(!0)?e.multiply(Z.clone(),e.parse(j)):(K||={},t.Utils.block("PARSE2NUMBER",()=>{k||=0;let O=y(j)?j.toString():j,$=C.unwrapSQRT(Z.clone(),!0),g=$.group,p;try{if(++k>t.Settings.integration_depth&&J.integration.stop("Maximum depth reached. Exiting!"),!$.contains(O,!0))p=e.multiply($.clone(),e.parse(O));else if(g===ce)p=J.integration.poly_integrate($,O,k);else if(g===Ne)if($.previousGroup===L&&!($.fname==="sqrt"||$.fname===h.PARENTHESIS)&&J.integration.stop(),$.contains(O)&&$.previousGroup!==L)$.power.contains(O)?J.integration.stop():(J.diff($.clone().toLinear(),O).contains(O)&&J.integration.stop(),p=J.integration.poly_integrate($));else{let d=J.diff($.power.clone(),O);if(d.contains(O)){let x=d.stripVar(O),X=e.divide(d.clone(),x.clone());if(X.group===ce&&X.isLinear())return x.multiplier=x.multiplier.divide(new o(2)),e.parse(B("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",x,O,$.multiplier));J.integration.stop()}if($.isE())if(d.isLinear())p=$;else if(d.isE()&&y(d.power)&&d.power.group===ce&&d.power.power.equals(1)){let x=y($.power)?$.power:new C($.power);p=e.multiply(e.symfunction("Ei",[x.clone()]),x)}else J.integration.stop();else{let x=e.symfunction(xe,[e.parse($.value)]);p=e.divide($,x)}p=e.divide(p,d)}else if($.isComposite()&&$.isLinear()){let d=e.parse($.multiplier);$.toUnitMultiplier(),p=new C(0),$.each(x=>{p=e.add(p,J.integrate(x,O,k))}),p=e.multiply(d,p)}else if(g===fe)if($.power.greaterThan(1)&&($=e.expand($)),$.power.equals(1))p=new C(0),$.each(d=>{p=e.add(p,J.integrate(d,O,k))},!0);else{let d=Number($.power),x=$.multiplier.clone();$.toUnitMultiplier();let X=$.clone().toLinear(),W=J.integration.decompose_arg(X,O),Q=W[3],ee=W[2],re=W[0],Y=W[1];if(d===-1&&Y.group!==pe&&Y.power.equals(2)){let se=V(Q)?Q>0:!0;if(Y.group===ce&&Y.power.equals(2)&&se){let me=function(Ve){let et=new C(1);return Ve.each(Be=>{et=e.multiply(et,Be.fname==="abs"?Be.args[0]:Be)}),et},De=re.clone(),Te=Q.clone();De=e.pow(De,new C(1/2)),Te=e.pow(Te,new C(1/2));let je=e.multiply(me(Te),me(De)),Ze=e.symfunction(N,[e.divide(e.multiply(re,Y.toLinear()),je.clone())]);p=e.divide(Ze,je)}else if(Y.group===ce&&Y.isLinear())p=e.divide(J.integration.poly_integrate($),re);else if(Y.power.equals(4)){let me=G,De=e.parse(`${ge+me(String(re))}*${O}^2`),Te=e.parse(`${ge+me(String(2))}*${me(String(re))}^${me("1/4")}*${me(String(Q))}^${me("1/4")}*${O}`),je=e.parse(ge+me(String(Q))),Ze=e.add(e.add(De.clone(),Te.clone()),je.clone()),Ve=e.add(e.subtract(De,Te),je),et=e.parse(`${ge+me(String(2))}*${me(String(Q))}^${me("3/4")}`),Be=e.parse(`${ge+me(String(Q))}*${me(String(Q))}^${me("1/4")}*${O}`),lt=e.parse(`2*${me(String(Q))}*${ge}${me(String(2))}*${me(String(Q))}^${me("1/4")}`),ct=e.divide(e.subtract(et.clone(),Be.clone()),e.multiply(lt.clone(),Ve)),ft=e.divide(e.add(et,Be),e.multiply(lt,Ze.clone()));p=e.add(J.integrate(ct,O,k,K),J.integrate(ft,O,k,K))}else p=J.integration.partial_fraction($,O,k)}else if(d===-1/2)if(Y.group===ce&&Y.power.equals(2))if(ee.multiplier.lessThan(0)&&!Q.multiplier.lessThan(0))if(re.negate(),Q.isConstant()&&re.isConstant()){let se=e.symfunction(ge,[re.clone()]),me=e.symfunction(ge,[e.multiply(re.clone(),Q)]);p=e.divide(e.symfunction(S,[e.divide(ee.toLinear(),me)]),se)}else{let se=e.symfunction(ge,[re]),me=e.multiply(se.clone(),Y.clone().toLinear());p=e.divide(e.symfunction(N,[e.divide(me,e.symfunction(ge,[X.clone()]))]),se)}else J.integration.stop();else J.integration.stop();else if(d===1/2&&Y.power.equals(2)&&re.greaterThan(0))J.integration.stop();else if(Y.isLinear()&&Y.group!==pe)p=e.divide(J.integration.poly_integrate($),re);else if(Y.power.equals(2)&&re.greaterThan(0)){let se=e.parse(ge+G(re)),me=e.parse(ge+G(Q)),De=e.multiply(se.clone(),me.clone()).invert(),Te=e.pow(Q,new C($.power.toDecimal())),je=t.Utils.getU($),Ze=e.multiply(De,Y.clone().toLinear()),Ve=e.symfunction(N,[Ze]),et=(Math.abs(Number($.power))-1)*2,Be=J.integrate(e.parse(`${Ie+G(je)}^${et}`));return t.Utils.clearU(je),e.multiply(Be.sub(je,Ve),Te)}else if($.group!==u&&!$.power.lessThan(0))p=J.integration.by_parts($,O,k,K);else{let se=$.clone().toLinear(),De=t.Algebra.Factor.factorInner(se).toString()!==se.toString();if(t.Algebra.degree(se,e.parse(O)).equals(2)&&!De)try{let Te=t.Algebra.sqComplete(se,O),je=t.Utils.getU(se),Ze=Te.f.sub(Te.a,je),Ve=e.pow(Ze,e.parse($.power));p=J.integrate(Ve,je).sub(je,Te.a)}catch(Te){if(Te.message==="timeout")throw Te;J.integration.stop()}else p=J.integration.partial_fraction($,O,k,K)}p.multiplier=p.multiplier.multiply(x)}else if(g===L){let d=$.args[0],x=$.multiplier.clone();$.toUnitMultiplier();let X=J.integration.decompose_arg(d,O),W=X[0],Q=X[1],{fname:ee}=$;if(ee===xe||ee===S||ee===w||ee===N&&Q.isLinear()){let re=$.power.toString();if(V(re)&&(k-=Number(re)),d.isComposite()){let Y=t.Utils.getU($),se=e.pow(e.parse(xe+G(Y)),new C(re)),me=J.diff(d,O),De=e.multiply(se,me),Te=J.integrate(De,Y,k,K);p=e.multiply(e.parse(x),Te.sub(Y,d))}else p=e.multiply(e.parse(x),J.integration.by_parts($,O,k,K))}else if(ee===le&&$.power.lessThan(0)){let re=$.clone();return re.power.negate(),re.fname=c,e.multiply(e.parse(x),J.integrate(re,O,k))}else{if(!W.contains(O,!0)&&$.isLinear())if(ee===$e){let re=e.divide(d.clone(),W.clone());if(re.group===ce&&!re.power.lessThan(0))if(t.Utils.even(re.power))p=J.integrate(d,O,k);else{let Y=J.integrate(re,O,k);Y.power=Y.power.subtract(new o(1)),p=e.multiply(e.multiply(e.symfunction($e,[re.toLinear()]),Y),W)}else J.integration.stop()}else{let re=$.args[0].group,Y=J.integration.decompose_arg(d,O);switch((!(re===fe||re===ce||re===u)||!Y[1].power.equals(1)||d.hasFunc(""))&&J.integration.stop(),ee){case Ie:p=e.symfunction(ve,[d]);break;case ve:p=e.symfunction(Ie,[d]),p.negate();break;case le:p=e.parse(B(`${h.LOG}(sec({0}))`,d));break;case i:p=e.parse(B(`${h.LOG}(tan({0})+sec({0}))`,d));break;case a:p=e.parse(B(`-${h.LOG}(csc({0})+cot({0}))`,d));break;case c:p=e.parse(B(`${h.LOG}(sin({0}))`,d));break;case F:p=e.symfunction(ie,[d]);break;case ie:p=e.symfunction(F,[d]);break;case oe:p=e.parse(B(`${h.LOG}(cosh({0}))`,d));break;case _:p=J.integration.by_parts($,O,k,K);break;case R:p=J.integration.by_parts($,O,k,K);break;case U:p=J.integration.by_parts($,O,k,K);break;case Ae:p=J.integration.by_parts($,O,k,K);break;case de:p=J.integration.by_parts($,O,k,K);break;case Le:p=J.integration.by_parts($,O,k,K);break;case he:p=e.parse(B("atan(sinh({0}))",d));break;case Se:p=e.parse(B(`${h.LOG}(tanh(({0})/2))`,d));break;case Ce:p=e.parse(B(`${h.LOG}(sinh({0}))`,d));break;case ye:p=J.integrate(e.parse(B("e^({0})",d)),O,k);break;case"S":{let se=$.args[0].clone(),me=J.integration.decompose_arg(se,O),De=me[1],Te=me[0],je=me[3];p=e.parse(B("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Te,je,Q));break}case"C":{let se=$.args[0].clone(),me=J.integration.decompose_arg(se,O),De=me[1],Te=me[0],je=me[3];p=e.parse(B("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Te,je,De));break}case"erf":{let se=$.args[0].clone(),me=J.integration.decompose_arg(se,O),De=me[1],Te=me[0];p=e.parse(B("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Te,De,se));break}case"sign":p=e.multiply($.clone(),d.clone());break;default:J.integration.stop()}p=e.divide(p,W)}else if(Q.isLinear())if(ee===Ie||ee===ve){let re=Number($.power);if(re<0)$.fname=ee===ve?a:i,$.invert().updateHash(),p=J.integrate($,O,k);else{let Y=$.args[0],se=$.clone(),me=$.clone(),De=new C((re-1)/re),Te=e.multiply(W.clone(),new C(re)).invert();se.power=se.power.subtract(new o(1)),me.power=me.power.subtract(new o(2));let je=e.symfunction(ee===Ie?ve:Ie,[d.clone()]);ee===ve&&je.negate(),p=e.add(e.multiply(e.multiply(Te,se),je),e.multiply(De,J.integrate(e.parse(me),O,k)))}}else if(ee===le||ee===c){if($.args[0].isLinear(O)){let re=$.power.subtract(new o(1)).toString(),Y=$.clone().toUnitMultiplier(),se=e.parse(B(`${ee===c?"-":""}1/({2}*{0})*{3}({1})^({0})`,re,d,W,ee));Y.power=Y.power.subtract(new o(2)),Y.power.equals(0)&&(Y=e.parse(Y)),p=e.subtract(se,J.integrate(Y,O,k))}}else if(ee===i||ee===a){let re=$.power.subtract(new o(1)).toString(),Y=$.power.subtract(new o(2)).toString(),se=ee===i?le:c,me=$.clone().toUnitMultiplier(),De=B(`${ee===a?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,W,re,Y,d,ee,se),Te=e.parse(De);me.power=me.power.subtract(new o(2)),me.power.equals(0)&&(me=e.parse(me)),p=e.add(Te,e.multiply(new C(Number(Y)/Number(re)),J.integrate(me,O,k)))}else(ee===ie||ee===F)&&$.power.equals(2)?p=J.integrate($.fnTransform(),O,k):J.integration.stop();else J.integration.stop();p.multiplier=p.multiplier.multiply(x)}}else if(g===pe)p=J.integration.partial_fraction($,O,k);else if(g===u){$.getDenom().group===ce&&($=e.expand($));let x=$.stripVar(O),X=e.divide($.clone(),x.clone());if(x.contains(O)&&(X=e.multiply(X,x),x=new C(1)),X.group===u){let W=X.collectSymbols().sort((ee,re)=>ee.group===re.group?Number(ee.power)===Number(re.power)?ee<re?1:-1:Number(re.power)-Number(ee.power):re.group-ee.group).map(ee=>{let re=C.unwrapSQRT(ee,!0);return re.fname===ye?e.parse(B("({1})*e^({0})",re.args[0],re.multiplier)):re}),Q=W.length;if(Number($.power)<0){if(Q===2)return J.integrate(e.expand($),O,k,K)}else if(Q===2){try{p=J.integration.u_substitution(W,O)}catch(ee){if(ee.message==="timeout")throw ee}if(!p){let ee=W[0].group,re=W[1].group,Y=W[0],se=W[1],me=Y.fname,De=se.fname;if($=e.multiply(Y.clone(),se.clone()),ee===L&&re===L)if(me===xe||De===xe)p=J.integration.by_parts($.clone(),O,k,K);else{W.sort((Be,lt)=>lt.fname>Be.fname?1:-1);let Te=Y.args[0];(!Te.isLinear()||!(Te.group===fe||Te.group===u||Te.group===ce))&&J.integration.stop();let je=J.integration.decompose_arg(Te,O),Ze=je[1],Ve=je[0];Ze.isLinear()||J.integration.stop();let et=se.args[0];if(Te.equals(et))if(me===ve&&De===Ie||me===Ie&&De===ve)if(Y.power.lessThan(0)&&J.integration.stop(),me===ve&&Y.power.add(se.power).equals(0))Y.fname=le,Y.updateHash(),p=J.integrate(Y,O,k);else if(we(Y.power)&&De===Ie&&se.power.lessThan(0)){let Be=Number(Y.power)/2,lt=e.parse(B("(1-cos({0})^2)^({1})",Y.args[0],Be));p=J.integrate(e.expand(e.multiply(lt,se.clone())),O,k,K)}else if(we(Y.power)&&De===ve&&se.power.lessThan(0)){let Be=Number(Y.power)/2,lt=e.parse(B("(1-sin({0})^2)^({1})",Y.args[0],Be));p=J.integrate(e.expand(e.multiply(lt,se.clone())),O,k,K)}else{let Be=t.Utils.even(Y.power),lt=t.Utils.even(se.power);if(p=new C(0),!Be||!lt){let ct,ft;Be?(ct=Y,ft=se):(ct=se,ft=Y);let At=ct.fname===Ie?-1:1,Tt=(Number(ft.power)-1)/2,pt=e.parse(`(1-${ct.fname}${t.Utils.inBrackets(Te.toString())}^2)^${Tt}`);e.expand(e.multiply(new C(At),e.multiply(ct.clone(),pt))).each(_t=>{p=e.add(p,J.integration.poly_integrate(_t.clone()))})}else{let ct=function(pt){let _t=pt.power/2,Ot;return pt.fname===Ie?Ot=`((1/2)+(cos(2*(${pt.args[0]}))/2))^${_t}`:Ot=`((1/2)-(cos(2*(${pt.args[0]}))/2))^${_t}`,e.parse(Ot)},ft=ct(Y),At=ct(se),$t=e.multiply(ft,At);return e.expand($t).each(pt=>{p=e.add(p,J.integrate(pt,O,k))}),e.multiply(p,x)}}else if(me===i&&De===le&&Ze.isLinear()&&se.isLinear())p=e.parse(B("sec({0})^({1})/({1})",Y.args[0],Y.power));else if(me===le&&De===i&&Ze.isLinear())if(Y.isLinear()&&se.isLinear())p=e.divide(e.symfunction(i,[Te.clone()]),Ve);else if(we(Y.power)){let Be=Number(Y.power)/2,lt=e.parse(B("(sec({0})^2-1)^({1})",Y.args[0],Be));p=J.integrate(e.expand(e.multiply(lt,se)),O,k)}else J.integration.stop();else if(me===i&&De===Ie)Y.fname=Ie,Y.invert().updateHash(),p=J.integrate(e.multiply(Y,se),O,k);else if(me===ve&&De===a)se.fname=ve,se.invert().updateHash(),p=J.integrate(e.multiply(Y,se),O,k);else if(me===le&&(De===Ie||De===ve)&&se.power.lessThan(0)){let Be=e.multiply(Y.fnTransform(),se);p=J.integrate(e.expand(Be),O,k)}else{let Be=e.multiply(Y.fnTransform(),se.fnTransform());p=J.integrate(e.expand(Be),O,k)}else if((me===ve||me===Ie)&&(De===ve||De===Ie))if(Y.isLinear()&&se.isLinear())if(Y.args[0].isLinear()&&se.args[0].isLinear()){let Be,lt;De===ve?(Be=Y.args[0],lt=se.args[0]):(lt=Y.args[0],Be=se.args[0]);let ct=e.parse(B("(sin(({1})+({0}))+sin(({1})-({0})))/2",Be.toString(),lt.toString()));p=J.integrate(ct,O,k)}else{let Be=Je(W);p=J.integrate(e.expand(Be),O,k)}else{let Be=new C(1);W.forEach(ct=>{let ft=ct.fnTransform();Be=e.multiply(Be,ft)});let lt=e.expand(Be);p=J.integrate(lt,O,k),p.hasIntegral()&&(p=J.integrate(Je(Be.collectSymbols()),O,k))}else J.integration.stop()}else if(ee===L&&re===ce){let Te=Y.isLinear();if(Y.fname===Ie&&Te&&se.power.equals(-1))p=e.symfunction("Ci",[Y.args[0]]);else if(Y.fname===Ie&&se.power.equals(-1))p=J.integrate(e.multiply(Y.fnTransform(),se.clone()),O,k);else if(Y.fname===ie&&Te&&se.power.equals(-1))p=e.symfunction("Chi",[Y.args[0]]);else if(Y.fname===ie&&se.power.equals(-1))p=J.integrate(e.multiply(Y.fnTransform(),se.clone()),O,k);else if(Y.fname===ve&&Te&&se.power.equals(-1))p=e.symfunction("Si",[Y.args[0]]);else if(Y.fname===ve&&se.power.equals(-1))p=J.integrate(e.multiply(Y.fnTransform(),se.clone()),O,k);else if(Y.fname===F&&Te&&se.power.equals(-1))p=e.symfunction("Shi",[Y.args[0]]);else if(Y.fname===F&&se.power.equals(-1))p=J.integrate(e.multiply(Y.fnTransform(),se.clone()),O,k);else if(Y.fname===xe&&se.power.equals(-1))p=J.integration.poly_integrate(Y,O,k);else if(Y.fname==="erf"){if(se.power.equals(1)){let je=J.integration.decompose_arg(Y.args[0],O),Ze=je[0],Ve=je[1],et=Y.args[0].toString();p=e.parse(B("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",Ze,Ve,et))}}else p=J.integration.by_parts($,O,k,K)}else if(ee===Ne&&re===ce){let Te=me===xe?J.integration.decompose_arg(Y.args[0],O)[1]:null;Y.isE()&&Pe(Y)&&se.power.equals(-1)?p=e.symfunction("Ei",[Y.power.clone()]):me===xe&&Te.value===se.value?p=J.integration.poly_integrate(Y):p=J.integration.by_parts($,O,k,K)}else if(ee===pe&&re===ce){if(se.value===Y.value&&Y.power.equals(-1)){let Te=Math.min.apply(null,t.Utils.keys(Y.symbols)),je=Math.min(Te,Number(se.power)),Ze=se.clone();Ze.power=new o(je),se=e.divide(se,Ze.clone());let Ve=new C(0);Y.each(et=>{Ve=e.add(Ve,e.divide(et.clone(),Ze.clone()))}),Ve.multiplier=Y.multiplier,$=e.divide(se,Ve)}else $=e.expand($);p=J.integration.partial_fraction($,O,k)}else if(ee===fe&&re===ce){let Te=Y.clone().toLinear(),je=t.Algebra.degree(Te,e.parse(O)).equals(1);if(Y.power.equals(-1/2)){let Ze=J.integration.decompose_arg(Y.clone().toLinear(),O),Ve=Ze[0].negate(),et=Ze[1],Be=Ze[3],lt=Number(Y.power),ct=Number(se.power);if(V(ct)&&t.Utils.even(ct)&&et.power.equals(2)){let ft=e.divide(e.multiply(e.pow(Be.clone(),new C(2)),e.symfunction(ge,[e.divide(Be.clone(),Ve.clone())])),e.pow(Ve.clone(),new C(2)));ft=e.multiply(ft,e.symfunction(ge,[Be]).invert());let At=e.parse("sin(u)");At.power=At.power.multiply(se.power);let $t=J.integrate(At,"u",k),Tt=e.parse(`${S}(${ge}(${Ve}/${Be})*${O})`);p=e.multiply(ft,$t.sub(new C("u"),Tt))}else if(lt===-1/2){let ft=function(At,$t){let Tt=e.parse(J.integrate(At,O,k,K).sub(O,B($t,O)));if(!Tt.hasIntegral())return Tt};ct===-1?p=ft(e.expand(e.expand(e.pow(e.multiply(Y.invert(),se.invert()),new C(2)))).invert(),"sqrt(1-1/({0})^2)"):ct===-2&&(p=ft(e.sqrt(e.expand(e.divide(e.pow($,new C(2)).invert(),e.pow(new C(O),new C(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(Y.power.equals(-1)&&se.isLinear()&&je)p=J.integration.partial_fraction($,O,k);else if(!Y.power.lessThan(0)&&V(Y.power)){let Ze=e.expand(Y);p=new C(0),Ze.each(Ve=>{Ve.group===pe?Ve.each(et=>{p=e.add(p,J.integrate(e.multiply(se.clone(),et),O,k))}):p=e.add(p,J.integrate(e.multiply(se.clone(),Ve),O,k))})}else if(Y.power.lessThan(-2))p=J.integration.by_parts($,O,k,K);else if(Y.power.lessThan(0)&&se.power.greaterThan(1)){let Ze=J.integration.decompose_arg(Y.clone().toLinear(),O),Ve=Ze[0].negate(),et=Ze[1],Be=Ze[3],lt=Y.clone().toLinear();if(et.group!==pe&&et.isLinear()){let ct=Number(se.power),ft="_u_",At=new C(ft),$t=e.expand(e.divide(e.pow(e.subtract(At.clone(),Be.clone()),new C(ct)),At.clone())),Tt={};Tt[ft]=lt;let pt=e.parse($t,Tt);p=J.integrate(pt,O,0)}else if(se.power.greaterThan(et.power)||se.power.equals(et.power)){let ct=new t.Algebra.Classes.Factors;Y=t.Algebra.Factor.coeffFactor(Y.invert(),ct);let ft=t.Algebra.divide(se,Y);ft.group===u?p=J.integration.by_parts($,O,k,K):(p=new C(0),ft.each(At=>{p=e.add(p,J.integrate(At,O,k))}),ct.each(At=>{p=e.divide(p,At)}),p=e.expand(p))}else p=J.integration.partial_fraction($,O,k)}else if(Y.power.den.equals(2)){let Ze=J.integration.decompose_arg(Y.clone().toLinear(),O),Ve=Ze[3],et=Ze[1],Be=Ze[0],lt=Ze[2];if(et.power.equals(2)&&Be.lessThan(0)){Ve.equals(1)||(x=e.multiply(x,e.pow(Ve,new C(2))));let ct=O,ft=e.divide(e.pow(Be.clone().negate(),new C(1/2)),e.pow(Ve,new C(1/2))),At=e.symfunction(Ie,[new C(ct)]),$t=e.pow(e.symfunction(Ie,[new C(ct)]),new C(Number(Y.power.num))),Tt=e.pow(e.symfunction(ve,[new C(ct)]),new C(Number(se.power))),pt=e.multiply(e.multiply($t,At),Tt);p=J.integrate(pt,ct,k).sub(ct,e.symfunction(S,[e.multiply(new C(O),ft)]))}else p=J.integration.partial_fraction($,O,k,K)}else je&&(p=J.integration.partial_fraction($,O,k))}else if(Y.isComposite()&&se.isComposite())if(p=new C(0),Y.power.greaterThan(0)&&se.power.greaterThan(0))e.expand($).each(je=>{p=e.add(p,J.integrate(je,O,k))},!0);else{let Te=Number(Y.power),je=Number(se.power);if(Te<0&&je>0){let Ze=Y;Y=se,se=Ze}Te===-1&&je===-1?p=J.integration.partial_fraction($,O):Y.each(Ze=>{let Ve=e.multiply(Ze,se.clone()),et=J.integrate(Ve,O,k);p=e.add(p,et)})}else if(ee===fe&&W[0].power.greaterThan(0))Y=e.expand(Y),p=new C(0),Y.each(Te=>{p=e.add(p,J.integrate(e.multiply(Te,se.clone()),O,k))},!0);else if(ee===L&&re===Ne&&t.Utils.inHtrig(Y.fname))Y=Y.fnTransform(),p=J.integrate(e.expand(e.multiply(Y,se)),O,k);else if(ee===L&&re===fe||re===L&&ee===fe){if(re===L&&ee===fe){let lt=Y;Y=se,se=lt}let Te,je,Ze,Ve,et=C.unwrapSQRT(J.diff(Y.clone(),O),!0),Be=C.unwrapSQRT(se,!0);if(et.power.equals(Be.power)){if(Te=new C(Number(se.power)),Ze=et.clone().toLinear(),Ve=se.clone().toLinear(),je=t.Algebra.divide(Ze.toLinear(),Ve),je.isConstant()){let lt=e.pow(je,Te.negate());p=e.multiply(lt,J.integration.poly_integrate(Y.clone()))}}else p=J.integration.by_parts($,O,k,K)}else{let Te=Y.clone().toLinear(),je=se.clone().toLinear();ee===Ne&&re===Ne&&Y.power.contains(O)&&se.power.contains(O)&&!Te.contains(O)&&!je.contains(O)?p=e.parse(B("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Te.toString(),je.toString(),Y.power.multiplier.toString(),se.power.multiplier.toString(),O)):p=J.integration.by_parts($,O,k,K)}}}else if(Q===3&&(W[2].group===ce&&W[2].power.lessThan(2)||W[0].group===fe)){let ee=W[0];if(ee.group===fe){ee.power.greaterThan(1)&&(ee=e.expand(ee));let re=e.multiply(W[1],W[2]);p=new C(0),ee.each(Y=>{let se=e.multiply(Y,re.clone()),me=J.integrate(se,O,k);p=e.add(p,me)},!0)}else p=J.integration.by_parts($,O,k,K)}else if(We(W)){let ee=new C(1);for(let re=0,Y=W.length;re<Y;re++)ee=e.multiply(ee,W[re].fnTransform());ee=e.expand(ee),p=J.integrate(ee,O,k)}else{let ee=Je(W);p=J.integrate(e.expand(ee),O,k)}}else{if(X.equals(1))return J.integrate(e.expand($),O,k);X.clone().toLinear().isPoly(!0)&&t.Utils.variables(X).length>1&&(X=t.Algebra.Factor.factorInner(X)),p=J.integrate(X,O,k)}p=e.multiply(p,x)}if(p)return p}catch(d){if(d.message==="timeout"||!(d instanceof Ge||d instanceof t.exceptions.DivisionByZero))throw d}let P=y(j)?j.toString():j;return e.symfunction("integrate",[Z,new C(P)])},!1))},defint(Z,j,k,K){K||="x";let O=function(d,x,X){try{return e.parse(d,x)}catch(W){if(W.message==="timeout")throw W;return J.Limit.limit(d,K,X)}},$=t.Utils.variables(Z),g=Z.hasTrig(),p,P;if($.length===1&&!K&&(K=$[0]),g||(P=J.integrate(Z,K)),!g&&!P.hasIntegral()){let d={},x={};d[K]=k,x[K]=j;let X=O(P,d,k),W=O(P,x,j);p=e.subtract(X,W)}else if($.length===1&&j.isConstant()&&k.isConstant()){let d=t.Build.build(Z);p=new C(t.Math2.num_integrate(d,Number(j),Number(k)))}else p=e.symfunction("defint",[Z,j,k,new C(K)]);return p},Limit:{interval(Z,j){return e.parse(B("[{0}, {1}]",Z,j))},diverges(){return J.Limit.interval("-Infinity","Infinity")},divide(Z,j,k,K,O){if(O++>h.max_lim_depth)return;let $=Z.clone(),g=j.clone();if(j.fname===$e){let Y=Z.sign(),se=K.sign();if(K.isInfinity)return e.multiply(new C(Y),new C(se));if(K.equals(0)){let me=e.parse(Z.multiplier),De=e.parse(j.multiplier);return e.divide(e.multiply(me,J.Limit.interval("-1","1")),De)}return J.Limit.diverges()}let p=function(Y){if(t.Utils.isVector(Y)){let se=Y;for(let me=0;me<se.elements.length;me++)if(!se.elements[me].isInfinity)return!1;return!0}return Y.isInfinity},P=function(Y,se){return t.Utils.isVector(Y)?!1:Y.equals(se)},d,x=0,X,W,Q;do if(X=Ee(J.Limit.limit(Z.clone(),k,K,O)),W=Ee(J.Limit.limit(j.clone(),k,K,O)),Q=p(X)&&p(W)||P(X,0)&&P(W,0),Q){let Y=J.diff(Z.clone(),k),se=J.diff(j.clone(),k),me=e.divide(Y,se);Z=me.getNum(),j=me.getDenom()}while(Q&&++x<h.max_lim_depth);if(x>=h.max_lim_depth)return;let ee=W.equals(0),re=Number(g.power);return K.isConstant(!0)&&ee?d=C.infinity(X.lessThan(0)?-1:void 0):ee?d=J.Limit.diverges():d=e.divide(X,W),d},rewriteToLog(Z){let j=Z.power.clone();return Z.toLinear(),e.pow(new C("e"),e.multiply(j,e.symfunction(`${h.LOG}`,[Z])))},getSubbed(Z,j,k){let K;Z.group===Ne&&(Z=J.Limit.rewriteToLog(Z));try{K=Z.sub(j,k)}catch(O){if(O.message==="timeout")throw O;K=Z}return K},isInterval(Z){return t.Utils.isVector(Z)},isConvergent(Z){return!(J.Limit.isInterval(Z)&&Z.elements[0].isInfinity&&Z.elements[1].isInfinity||Z.containsFunction("limit"))},limit(Z,j,k,K){if(Z.isLinear()&&Z.isComposite()){let g=new C(0);return Z.each(p=>{g=e.add(g,J.Limit.limit(p,j,k,K))},!0),g}if(Z=t.Algebra.Simplify.simplify(Z),K||=1,K++>h.max_lim_depth)return;let O=e.parse(Z.multiplier);Z.toUnitMultiplier();let $;try{if(Z.isConstant(!0))$=Z;else{let g={};g[j]=k;try{let p=e.parse(Z.sub(j,k),g);(p.isConstant(!0)||p.isInfinity)&&($=p)}catch(p){if(p.message==="timeout")throw p}if(!$){let p=Z.getNum(),P=Z.getDenom();if(P.isConstant(!0)){if(Z.group===Ne){let d=Z.clone().toLinear(),x=Z.power.clone(),X=d.getNum(),W=d.getDenom(),Q=t.Utils.decompose_fn(W,j,!0);if(X.group===ce&&X.multiplier.isOne()&&Q.ax.group===ce&&Q.b.isConstant(!0)&&Q.a.isOne()&&Q.b.isConstant(!0))$=e.parse(B("(1/e^({0}))",Q.b));else{let ee=J.Limit.rewriteToLog(Z.clone()),re=ee.power.clone(),Y=ee.clone().toLinear(),se=J.Limit.limit(Y,j,k,K),me=J.Limit.limit(re,j,k,K);$=e.pow(se,me)}}else if(Z.group===L&&Z.args.length===1){let d,x=J.Limit.limit(Z.args[0],j,k,K);if(t.Utils.isVector(x))return $=x.map(W=>{let Q=Z.clone();return Q.args[0]=W,J.Limit.limit(e.symfunction(Z.fname,[W]),j,k,K)}),e.multiply(O,$);let X;if(x.isConstant(!0)){X=e.symfunction(Z.fname,[x]);try{Ee(X),d=!0}catch(W){if(W.message==="timeout")throw W;d=!1}}if(d)$=X;else if(J.Limit.isConvergent(x)){if(Z.fname===xe)switch(x.toString()){case"0":$=C.infinity().negate();break;case"Infinity":$=C.infinity();break;case"-Infinity":$=C.infinity();break}else if((Z.fname===Ie||Z.fname===ve)&&k.isInfinity)$=J.Limit.interval(-1,1);else if(Z.fname===le){let W=Z.args[0],Q=W.getNum(),ee=W.getDenom(),re=Q.toUnitMultiplier();(k.isInfinity||re.equals("pi")&&ee.equals(2))&&($=J.Limit.diverges())}else if(Z.fname===h.FACTORIAL&&x.isInfinity)return C.infinity()}}else if(Z.group===ce){if(Number(Z.power)>0)return e.parse(Z,g);t.Utils.even(Z.power)?$=C.infinity():$=J.Limit.diverges()}else if(Z.group===u){let d,x,X=Z.collectSymbols().sort((Q,ee)=>Q.group-ee.group),W=X.pop();for(d=Ee(J.Limit.limit(W,j,k,K));X.length;){let Q=X.pop();x=Ee(J.Limit.limit(Q,j,k,K)),d.isInfinity||!J.Limit.isConvergent(d)&&x.equals(0)||d.equals(0)&&J.Limit.isConvergent(x)?(Q.containsFunction(xe)&&(Q=[W,W=Q][0]),Q.invert(),d.isInfinity&&x.isInfinity?d=C.infinity():d=J.Limit.divide(W,Q,j,k,K)):(d=e.multiply(d,x),W=e.multiply(W,Q))}$=d}else if(Z.isComposite()){let d;Z.isLinear()||(Z=e.expand(Z)),$=new C(0);let x=Z.collectSymbols().sort((Q,ee)=>ee.group-Q.group),X=[],W=new C(0);for(let Q=0,ee=x.length;Q<ee;Q++){let re=x[Q].clone();re.group===L||re.group===u&&re.hasFunc("")?W=e.add(W,re):X.push(re)}X.unshift(W),X.length!==1&&(x=X);for(let Q=0,ee=x.length;Q<ee;Q++){let re=x[Q];try{d=J.Limit.limit(re,j,k,K)}catch(Y){if(Y.message==="timeout")throw Y;d=J.Limit.diverges()}try{$=e.add($,d)}catch(Y){if(Y.message==="timeout")throw Y;if(K++>h.max_lim_depth)return;$=J.Limit.limit(J.diff(Z,j),j,k,K)}}}}else $=J.Limit.divide(p,P,j,k,K)}}$||=e.symfunction("limit",[Z,new C(j),k])}catch(g){if(g.message==="timeout")throw g;$=e.symfunction("limit",[Z,new C(j),k])}return e.multiply(O,$)}},Fresnel:{S(Z){return Z.isConstant(!0)?J.defint(e.parse("sin(pi*x^2/2)"),new C(0),Z,"x"):e.symfunction("S",[Z])},C(Z){return Z.isConstant(!0)?J.defint(e.parse("cos(pi*x^2/2)"),new C(0),Z,"x"):e.symfunction("C",[Z])}}};B0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return J.diff}},{name:"sum",visible:!0,numargs:4,build(){return J.sum}},{name:"product",visible:!0,numargs:4,build(){return J.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return J.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return J.defint}},{name:"S",visible:!0,numargs:1,build(){return J.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return J.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return J.Limit.limit}}]),B0.updateAPI()})()});var X0=f0((Yi,u1)=>{"use strict";var h0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof u1<"u"&&h0===void 0&&(h0=T0(),V0());(function(){let t=h0.getCore(),e=t.PARSER,{N:o,P:h,S:y,EX:L,FN:C,PL:D,CP:G,CB:V}=t.groups,{keys:B,even:we,variables:Ee,format:Me,round:ce,isInt:pe}=t.Utils,{Frac:fe,NerdamerSymbol:u,Vector:Ne,Expression:_e}=t,{CONST_HASH:xe}=t.Settings,ye=t.Utils.importFunctions(),$e=t.Utils.evaluate;function ge(i,a,c){if(this.coeffs=[],this.variable="",t.Utils.isSymbol(i))this.parse(i),this.variable||=a||"";else if(typeof i=="number"&&!isNaN(i)){if(c||=0,a===void 0)throw new t.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[c]=new fe(i),this.fill(i)}else typeof i=="string"&&this.parse(e.parse(i))}ge.fromArray=function(a,c){if(typeof c>"u")throw new t.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let S=new ge;return S.coeffs=a,S.variable=c,S},ge.fit=function(a,c,S,w,N,_){let R=new Array(N+1),U=S-c;R[0]=c,R[N]=a,U-=a*w**N;for(let F=N-1;F>0;F--){let ie=w**F,oe=U/ie,he=Math.sign(oe)*Math.floor(Math.abs(oe));U-=he*ie,R[F]=he}if(U!==0)return null;for(let F=0;F<R.length;F++)R[F]=new fe(R[F]);return ge.fromArray(R,_)},ge.prototype={parse(i,a){if(this.variable=Ee(i)[0],!i.isPoly())throw new t.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${t.Utils.text(i)}`);if(a||=[],i.power.absEquals(1)||(i=e.expand(i)),i.group===t.groups.N)a[0]=i.multiplier;else if(i.group===t.groups.S)a[Number(i.power.toDecimal())]=i.multiplier;else for(let c in i.symbols){if(!Object.hasOwn(i.symbols,c))continue;let S=i.symbols[c],w=S.power;if(t.Utils.isSymbol(w))throw new t.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");let N=S.group===o?0:Number(w.toDecimal());S.symbols?this.parse(S,a):a[N]=S.multiplier}this.coeffs=a,this.fill()},fill(i){i=Number(i)||0;let a=this.coeffs.length;for(let c=0;c<a;c++)this.coeffs[c]===void 0&&(this.coeffs[c]=new fe(i));return this},trim(){let i=this.coeffs.length;for(;i--;){let a=this.coeffs[i],c=a.equals(0);if(a&&c){if(i===0)break;this.coeffs.pop()}else break}return this},modP(i){let a=this.coeffs.length;for(let c=0;c<a;c++){let S=this.coeffs[c],w;if(S.lessThan(0)){let R;for(w=c;w<a;w++)if(this.coeffs[w].greaterThan(0)){R=this.coeffs[w];break}if(R){for(;w>c;w--)this.coeffs[w]=this.coeffs[w].subtract(new fe(1)),this.coeffs[w-1]=this.coeffs[w-1].add(new fe(i));S=this.coeffs[c]}}let N=S.mod(new fe(i)),_=S.subtract(N).divide(new fe(i));if(!_.equals(0)){let R=c+1,U=this.coeffs[R]||new fe(0);U=U.add(_),this.coeffs[R]=U,this.coeffs[c]=N}}return this},add(i){let a=Math.max(this.coeffs.length,i.coeffs.length);for(let c=0;c<a;c++){let S=this.coeffs[c]||new fe(0),w=i.coeffs[c]||new fe(0);this.coeffs[c]=S.add(w)}return this},subtract(i){let a=Math.max(this.coeffs.length,i.coeffs.length);for(let c=0;c<a;c++){let S=this.coeffs[c]||new fe(0),w=i.coeffs[c]||new fe(0);this.coeffs[c]=S.subtract(w)}return this},divide(i){let{variable:a}=this,c=t.Utils.arrayClone(this.coeffs),S=t.Utils.arrayClone(i.coeffs),w=c.length,N=S.length-1,_=[];for(let F=0;F<w;F++){let ie=w-(F+1),oe=ie-N,Se=c[ie].divide(S[N]);if(oe<0)break;_[oe]=Se;for(let he=0;he<=N;he++)c[he+oe]=c[he+oe].subtract(S[he].multiply(Se))}let R=ge.fromArray(c,a||"x").trim();return[ge.fromArray(_,a||"x"),R]},multiply(i){let a=this.coeffs.length,c=i.coeffs.length,S=[];for(let w=0;w<a;w++){let N=this.coeffs[w];for(let _=0;_<c;_++){let R=w+_,U=i.coeffs[_],F=S[R]||new fe(0);S[R]=F.add(N.multiply(U))}}return this.coeffs=S,this},isZero(){let i=this.coeffs.length;for(let a=0;a<i;a++)if(!this.coeffs[a].equals(0))return!1;return!0},sub(i){let a=new fe(0),c=this.coeffs.length;for(let S=0;S<c;S++){let w=this.coeffs[S];w.equals(0)||(a=a.add(w.multiply(new fe(i**S))))}return a},clone(){let i=new ge;return i.coeffs=this.coeffs.slice(),i.variable=this.variable,i},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let i=this.lc(),a=this.coeffs.length;for(let c=0;c<a;c++)this.coeffs[c]=this.coeffs[c].divide(i);return this},gcd(i){let a=this.coeffs.length-1,c=i.coeffs.length-1,S;if(a<c)return i.gcd(this);let w=this;for(;!i.isZero();){let _=i.clone();w=w.clone(),S=w.divide(_),i=S[1],w=_}let N=t.Math2.QGCD.apply(null,w.coeffs);if(!N.equals(1)){let _=w.coeffs.length;for(let R=0;R<_;R++)w.coeffs[R]=w.coeffs[R].divide(N)}return w},diff(){let i=[],a=this.coeffs.length;for(let c=1;c<a;c++)i.push(this.coeffs[c].multiply(new fe(c)));return this.coeffs=i,this},integrate(){let i=[new fe(0)],a=this.coeffs.length;for(let c=0;c<a;c++){let S=new fe(c+1);i[c+1]=this.coeffs[c].divide(S)}return this.coeffs=i,this},gcf(i){let a=function(w){for(let N=0;N<w.length;N++)if(!w[N].equals(0))return N},c=[];for(let w=0;w<this.coeffs.length;w++){let N=this.coeffs[w];!N.equals(0)&&c.indexOf(N)===-1&&c.push(N)}let S=[t.Math2.QGCD.apply(void 0,c),a(this.coeffs)||0];if(i){let w=[];w[S[1]-1]=S[0],S=ge.fromArray(w,this.variable).fill()}return S},quad(i){let a=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let c=this.coeffs[2]?Number(this.coeffs[2].toDecimal()):0,S=this.coeffs[1]?Number(this.coeffs[1].toDecimal()):0,w=Number(this.coeffs[0].toDecimal()),N=S*S-4*c*w;return N<0&&!i||(a[0]=(-S+Math.sqrt(N))/(2*c),a[1]=(-S-Math.sqrt(N))/(2*c)),a},squareFree(){let i=this.clone(),a=1,c=i.clone().diff(),S=i.clone().gcd(c),w=i.divide(S)[0],N=ge.fromArray([new fe(1)],i.variable);for(;!S.equalsNumber(1);){let _=w.gcd(S),R=w.divide(_)[0];if(!R.equalsNumber(1)&&a>1){let U=R.clone();for(let F=1;F<a;F++)U.multiply(R.clone());R=U}N=N.multiply(R),a++,w=_,S=S.divide(_)[0]}return[N,w,a]},toSymbol(){let i=this.coeffs.length,{variable:a}=this;if(i===0)return new u(0);if(!a)throw new t.exceptions.NerdamerTypeError("Polynomial.toSymbol requires a variable. Constants should not be converted to Polynomial.");let c=[];for(let S=0;S<i;S++){let w=this.coeffs[S];w.equals(0)||c.push(`${w}*${a}^${S}`)}return c.length===0?new u(0):e.parse(c.join("+"))},equalsNumber(i){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(i)},toString(){return this.toSymbol().toString()}},u.prototype.coeffs=function(a,c){c&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),a||=[];let S=this.clone().distributeMultiplier();if(S.isComposite())for(let w in S.symbols){if(!Object.hasOwn(S.symbols,w))continue;let N=S.symbols[w];N.isComposite()?N.clone().distributeMultiplier().coeffs(a,c):c?a[N.isConstant()?0:Number(N.power.toDecimal())]=N.multiplier:a.push(N.multiplier)}else if(c)a[S.isConstant(!0)?0:Number(S.power.toDecimal())]=S.multiplier;else if(S.group===V&&S.isImaginary()){let w=new u(S.multiplier);S.each(N=>{(N.isConstant(!0)||N.imaginary)&&(w=e.multiply(w,N))}),a.push(w)}else a.push(S.multiplier);if(c)for(let w=0;w<a.length;w++)a[w]===void 0&&(a[w]=new u(0));return a},u.prototype.tBase=function(a){if(typeof a>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let c=[],S=this.collectSymbols(null,null,null,!0),w=S.length;for(let N=0;N<w;N++){let _=S[N],R=_.group,U=new Ie(_.multiplier,[],a);if(R===V)for(let F in _.symbols){if(!Object.hasOwn(_.symbols,F))continue;let ie=_.symbols[F];U.terms[a[F]]=ie.power}else U.terms[a[_.value]]=_.power;c.push(U.fill()),U.updateCount()}return c},u.prototype.altVar=function(a){let c=this.multiplier.toString(),S=this.power.toString();return(c==="1"?"":`${c}*`)+a+(S==="1"?"":`^${S}`)},u.prototype.sameVars=function(a){if(!(this.symbols||this.group===a.group))return!1;for(let c in this.symbols){if(!Object.hasOwn(this.symbols,c))continue;let S=this.symbols[c],w=a.symbols[c];if(!w||S.value!==w.value)return!1}return!0},u.prototype.groupTerms=function(a){a=String(a);let c,S,w,N=[];return this.each(_=>{if(_.group===D){w=_.groupTerms(a);for(let R=0;R<w.length;R++){let U=w[R];U&&(N[R]=U)}}else c=t.Utils.decompose_fn(_,a,!0),S=c.x.value===a?Number(c.x.power):0,N[S]=e.add(N[S]||new u(0),c.a)}),N},u.prototype.collectFactors=function(){let a=[];return this.group===V?this.each(c=>{a.push(c.clone())}):a.push(this.clone()),a};function ve(){this.factors={},this.length=0,this.preAdd=void 0,this.pFactor=void 0}ve.prototype.getNumberSymbolics=function(){let a=0;return this.each(c=>{c.isConstant(!0)||a++}),a},ve.prototype.add=function(a){if(a.equals(0))return this;if(a.equals(-1)&&this.length>0){let c=t.Utils.firstObject(this.factors,null,!0),S=e.symfunction(t.Settings.PARENTHESIS,[c.obj]).negate();return delete this.factors[c.key],this.add(S),this.length--,this}if(a.group===V){let c=this;a.multiplier.equals(1)||c.add(new u(a.multiplier)),a.each(S=>{c.add(S)})}else{this.preAdd&&(a=this.preAdd(a)),this.pFactor&&(a=e.pow(a,new u(this.pFactor)));let c=a.isConstant();if(c&&a.equals(1))return this;let S=c?a.value:a.text();S in this.factors?(this.factors[S]=e.multiply(this.factors[S],a),this.factors[S].equals(1)&&(delete this.factors[S],this.length--)):(this.factors[S]=a,this.length++)}return this},ve.prototype.toSymbol=function(){let a=new u(1),c=Object.values(this.factors).sort((S,w)=>S.group>w.group?1:-1);for(let S=0,w=c.length;S<w;S++){let N=c[S],_=N.power.equals(1)&&N.fname!==""?e.symfunction(t.Settings.PARENTHESIS,[N]):N;a=e.multiply(a,_)}return a.fname===""&&(a=u.unwrapPARENS(a)),a},ve.prototype.merge=function(a){for(let c in a)c in this.factors?this.factors[c]=e.multiply(this.factors[c],a[c]):this.factors[c]=a[c];return this},ve.prototype.each=function(a){for(let c in this.factors){if(!Object.hasOwn(this.factors,c))continue;let S=this.factors[c];S.fname===t.Settings.PARENTHESIS&&S.isLinear()&&(S=S.args[0]),a.call(this,S,c)}return this},ve.prototype.count=function(){return B(this.factors).length},ve.prototype.clean=function(){try{let a=t.Settings.CONST_HASH;this.factors[a].lessThan(0)&&(this.factors[a].equals(-1)?delete this.factors[a]:this.factors[a].negate(),this.each(c=>{c.negate()}))}catch(a){if(a.message==="timeout")throw a}},ve.prototype.toString=function(){return this.toSymbol().toString()};function Ie(i,a,c){this.terms=a||[],this.coeff=i,this.map=c,this.sum=new fe(0),this.image=void 0,this.revMap=void 0,this.count=void 0}Ie.prototype.updateCount=function(){this.count||=0;for(let a=0;a<this.terms.length;a++)this.terms[a].equals(0)||this.count++;return this},Ie.prototype.getVars=function(){let a=[];for(let c=0;c<this.terms.length;c++){let S=this.terms[c];this.getRevMap(),!S.equals(0)&&this.revMap&&a.push(this.revMap[c])}return a.join(" ")},Ie.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count||0},Ie.prototype.toSymbol=function(a){a||=this.getRevMap();let c=new u(this.coeff);for(let S=0;S<this.terms.length;S++){let w=a[S],N=this.terms[S];if(N.equals(0)||w===xe)continue;let _=new u(w);_.power=N,c=e.multiply(c,_)}return c},Ie.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let a={};if(this.map)for(let c in this.map)Object.hasOwn(this.map,c)&&(a[this.map[c]]=c);return this.revMap=a,a},Ie.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},Ie.prototype.getImg=function(){return this.image||this.generateImage(),this.image||""},Ie.prototype.fill=function(){let a=this.map?this.map.length:0;for(let c=0;c<a;c++)typeof this.terms[c]>"u"?this.terms[c]=new fe(0):this.sum=this.sum.add(this.terms[c]);return this},Ie.prototype.divide=function(a){let c=this.coeff.divide(a.coeff),S=this.terms.length,w=new Ie(c,[],this.map);for(let N=0;N<S;N++)w.terms[N]=this.terms[N].subtract(a.terms[N]),w.sum=w.sum.add(w.terms[N]);return w},Ie.prototype.multiply=function(a){let c=this.coeff.multiply(a.coeff),S=this.terms.length,w=new Ie(c,[],this.map);for(let N=0;N<S;N++)w.terms[N]=this.terms[N].add(a.terms[N]),w.sum=w.sum.add(w.terms[N]);return w},Ie.prototype.isZero=function(){return this.coeff.equals(0)},Ie.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},t.Utils.toMapObj=function(a){let c=0,S={length:0};for(let w=0;w<a.length;w++){let N=a[w];typeof S[N]>"u"&&(S[N]=c,c++)}return S.length=c,S},t.Utils.filledArray=function(a,c,S){let w=[];for(;c--;)w[c]=S?new S(a):a;return w},t.Utils.arrSum=function(a){let c=0,S=a.length;for(let w=0;w<S;w++)c+=a[w];return c},t.Utils.haveIntersection=function(a,c){return c.length>a.length&&([a,c]=[c,a]),a.some(S=>c.indexOf(S)>-1)},t.Utils.subFunctions=function(a,c){c||={};let S=[],w=new Set(Ee(a));return a.each(N=>{if(N.group===C||N.previousGroup===C){let _=t.Utils.text(N,"hash"),R=c[_];if(R)S.push(N.altVar(R));else{let U=0,F;do F=N.fname+B(c).length+(U>0?String(U):""),U++;while(w.has(F));c[_]=F,S.push(N.altVar(F))}}else N.group===V||N.group===D||N.group===G?S.push(t.Utils.subFunctions(N,c)):S.push(N.text())}),a.group===G||a.group===D?a.altVar(t.Utils.inBrackets(S.join("+"))):a.group===V?a.altVar(t.Utils.inBrackets(S.join("*"))):a.text()},t.Utils.getFunctionsSubs=function(a){let c={};for(let S in a)Object.hasOwn(a,S)&&(c[a[S]]=e.parse(S));return c};let le=t.Algebra={version:"1.4.6",proots(i,a){a||=7;let c=0,S=[],w=function(_,R,U){let F=N(_,R,U).concat(S);for(let ie=0;ie<c;ie++)F.unshift(0);return F};if(t.Utils.isSymbol(i)&&i.isPoly()){let _=i;if(_.distributeMultiplier(),_.group===D){let he=t.Utils.arrayMin(B(_.symbols)),Ce=_.symbols[he].clone().toUnitMultiplier();_=e.expand(e.divide(_,Ce)),S.push(0)}if(_.group===t.groups.S)return["0"];if(_.group===t.groups.PL){let he=B(_.symbols),Ce=t.Utils.arrayMin(he);_=t.PARSER.divide(_,t.PARSER.parse(`${_.value}^${Ce}`))}let R=B(_.symbols).sort().pop(),U=_.group===t.groups.PL?_.symbols:_.symbols[R||""],F=U.group,ie=F===y?[U.power.toDecimal()]:B(U.symbols),oe=[],Se=t.Utils.arrayMax(ie);for(let he=1;he<=Se;he++){let Ce=0;ie.indexOf(`${he}`)!==-1&&(F===y?Ce=U.multiplier:Ce=U.symbols[he].multiplier),oe.unshift(Ce)}return oe.push(i.symbols[xe].multiplier),_.group===y&&(oe[0]=_.multiplier),w(oe,ie,Se)}if(t.Utils.isArray(i)){let _=i,R=[],U=[],F=0;for(let oe=0;oe<_.length;oe++){let Se=_[oe][0],he=_[oe][1],Ce=he-F-1;for(let Ae=0;Ae<Ce;Ae++)R.unshift(0);R.unshift(Se),he!==0&&U.push(he),F=he}let ie=Math.max.apply(void 0,U);return w(R,U,ie)}throw new t.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function N(_,R,U){let ie,oe=_.slice(0);if(_.unshift(U),U>100)throw new t.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let Se=[],he={};for(he.Degree=U,ie=0;ie<U;ie++)Se.push(0);let Ce=Se.slice(0);function Ae(Z,j,k,K,O,$){O[0]=$.b=K[0],O[1]=$.a=-(j*$.b)+K[1];for(let g=2;g<Z;g++)O[g]=-(j*$.a+k*$.b)+K[g],$.b=$.a,$.a=O[g]}function de(Z,j,k,K,O,$,g,p,P){let d={},x=3;return d.b=d.a=0,Ae(j,g,p,$,P,d),O.c=d.a,O.d=d.b,Math.abs(O.c)<=100*Z*Math.abs($[j-1])&&Math.abs(O.d)<=100*Z*Math.abs($[j-2])||(O.h=p*K,Math.abs(O.d)>=Math.abs(O.c)?(x=2,O.e=k/O.d,O.f=O.c/O.d,O.g=g*K,O.a3=O.e*(O.g+k)+O.h*(K/O.d),O.a1=-k+O.f*K,O.a7=O.h+(O.f+g)*k):(x=1,O.e=k/O.c,O.f=O.d/O.c,O.g=O.e*g,O.a3=O.e*k+(O.g+O.h/O.c)*K,O.a1=-(k*(O.d/O.c))+K,O.a7=O.g*O.d+O.h*O.f+k)),x}function Le(Z,j,k,K,O,$,g,p,P){if(k===3){g[1]=g[0]=0;for(let x=2;x<j;x++)g[x]=p[x-2];return}let d=k===1?O:K;if(Math.abs($.a1)>10*Z*Math.abs(d)){$.a7/=$.a1,$.a3/=$.a1,g[0]=P[0],g[1]=-(P[0]*$.a7)+P[1];for(let x=2;x<j;x++)g[x]=-(P[x-1]*$.a7)+p[x-2]*$.a3+P[x]}else{g[0]=0,g[1]=-(P[0]*$.a7);for(let x=2;x<j;x++)g[x]=-(P[x-1]*$.a7)+p[x-2]*$.a3}}function Pe(Z,j,k,K,O,$,g,p,P,d,x,X,W,Q,ee,re,Y){let se,me,De,Te,je,Ze,Ve,et,Be;j.b=j.a=0,Z===3||(Z===2?(se=(k+x)*d+X,me=(d+W)*p+Q*P):(se=k+W*g+X*d,me=p+(W+Q*d)*P),De=-(ee[re-1]/Y[re]),Te=-(ee[re-2]+De*Y[re-1])/Y[re],je=Q*Te*K,Ze=De*$,Ve=De*De*O,et=-(Ze+Ve)+je,Be=-et+me+De*se,Be!==0&&(j.a=-((W*(Ve+Ze)+Q*(De*K+Te*$))/Be)+W,j.b=Q*(1+et/Be)))}function Ge(Z,j,k,K){let O,$;if(K.sr=K.si=K.lr=K.li=0,Z===0){K.sr=j===0?K.sr:-(k/j);return}if(k===0){K.lr=-(j/Z);return}let g=j/2;Math.abs(g)<Math.abs(k)?($=k>=0?Z:-Z,$=-$+g*(g/Math.abs(k)),O=Math.sqrt(Math.abs($))*Math.sqrt(Math.abs(k))):($=-(Z/g*(k/g))+1,O=Math.sqrt(Math.abs($))*Math.abs(g)),$>=0?(O=g>=0?-O:O,K.lr=(-g+O)/Z,K.sr=K.lr===0?K.sr:k/K.lr/Z):(K.lr=K.sr=-(g/Z),K.si=Math.abs(O/Z),K.li=-K.si)}function We(Z,j,k,K,O,$,g,p,P,d,x,X){let W={},Q,ee,re,Y=0,se,me,De,Te,je,Ze,Ve,et=0,Be,lt=0;k.NZ=0,me=K,Te=O;do{if(W.li=W.lr=W.si=W.sr=0,Ge(1,me,Te,W),k.szr=W.sr,k.szi=W.si,k.lzr=W.lr,k.lzi=W.li,Math.abs(Math.abs(k.szr)-Math.abs(k.lzr))>.01*Math.abs(k.lzr))break;for(Ae(g,me,Te,P,$,p),ee=Math.abs(-(k.szr*p.b)+p.a)+Math.abs(k.szi*p.b),Ze=Math.sqrt(Math.abs(Te)),Q=2*Math.abs($[0]),se=-(k.szr*p.b),Ve=1;Ve<j;Ve++)Q=Q*Ze+Math.abs($[Ve]);if(Q=Q*Ze+Math.abs(se+p.a),Q=(9*Q+2*Math.abs(se)-7*(Math.abs(p.a+se)+Ze*Math.abs(p.b)))*Z,ee<=20*Q){k.NZ=2;break}if(et++,et>20)break;if(et>=2&&Y<=.01&&ee>=re&&!lt){for(Y=Y<Z?Math.sqrt(Z):Math.sqrt(Y),me-=me*Y,Te+=Te*Y,Ae(g,me,Te,P,$,p),Ve=0;Ve<5;Ve++)Be=de(Z,j,p.a,p.b,x,X,me,Te,d),Le(Z,j,Be,p.a,p.b,x,X,d,$);lt=1,et=0}re=ee,Be=de(Z,j,p.a,p.b,x,X,me,Te,d),Le(Z,j,Be,p.a,p.b,x,X,d,$),Be=de(Z,j,p.a,p.b,x,X,me,Te,d),Pe(Be,p,p.a,x.a1,x.a3,x.a7,p.b,x.c,x.d,x.f,x.g,x.h,me,Te,X,j,P),De=p.a,je=p.b,je!==0&&(Y=Math.abs((-Te+je)/je),me=De,Te=je)}while(je!==0)}function He(Z,j,k,K,O,$,g,p,P){let d,x,X,W,Q,ee,re,Y,se,me,De,Te=K-1;for(j.NZ=De=se=0,re=k.a;;){for(ee=O[0],g[0]=ee,me=1;me<$;me++)g[me]=ee=ee*re+O[me];for(X=Math.abs(ee),W=Math.abs(re),d=.5*Math.abs(g[0]),me=1;me<$;me++)d=d*W+Math.abs(g[me]);if(X<=20*Z*(2*d-X)){j.NZ=1,j.szr=re,j.szi=0;break}if(De++,De>10)break;if(De>=2&&Math.abs(Y)<=.001*Math.abs(-Y+re)&&X>Q){se=1,j.a=re;break}for(Q=X,P[0]=x=p[0],me=1;me<K;me++)P[me]=x=x*re+p[me];if(Math.abs(x)>Math.abs(p[Te])*10*Z)for(Y=-(ee/x),p[0]=g[0],me=1;me<K;me++)p[me]=Y*P[me-1]+g[me];else for(p[0]=0,me=1;me<K;me++)p[me]=P[me-1];for(x=p[0],me=1;me<K;me++)x=x*re+p[me];Y=Math.abs(x)>Math.abs(p[Te])*10*Z?-(ee/x):0,re+=Y}return se}function Qe(Z,j,k,K,O,$,g,p,P,d,x,X){let W={},Q={},ee=new Array(j),re=new Array(j),Y,se,me,De,Te,je,Ze,Ve,et,Be,lt,ct,ft,At,$t,Tt,pt,Ft,_t,Ot=1,Vt,Jt,c0,Yt,r0,Kt;for(X.NZ=0,De=me=.25,Te=K,Ve=O,W.b=W.a=0,Ae(P,x,O,p,d,W),Y=W.a,se=W.b,Q.h=Q.g=Q.f=Q.e=Q.d=Q.c=Q.a7=Q.a3=Q.a1=0,Yt=de(Z,g,Y,se,Q,$,x,O,ee),Vt=0;Vt<k;Vt++){if(Ft=1,Le(Z,g,Yt,Y,se,Q,$,ee,d),Yt=de(Z,g,Y,se,Q,$,x,O,ee),Pe(Yt,W,Y,Q.a1,Q.a3,Q.a7,se,Q.c,Q.d,Q.f,Q.g,Q.h,x,O,$,g,p),$t=W.a,pt=Tt=W.b,Be=$[g-1]===0?0:-(p[g]/$[g-1]),lt=ft=1,Vt!==0&&Yt!==3&&(ft=pt===0?ft:Math.abs((pt-Ve)/pt),lt=Be===0?lt:Math.abs((Be-Te)/Be),At=ft<Ze?ft*Ze:1,ct=lt<je?lt*je:1,r0=At<De?1:0,Jt=ct<me?1:0,Jt||r0)){for(_t=0;_t<g;_t++)re[_t]=$[_t];for(et=Be,c0=Kt=0;;){if(!(Ft&&(Ft=0)==0&&Jt&&(!r0||ct<At))){if(We(Z,g,X,$t,Tt,d,P,W,p,ee,Q,$),Y=W.a,se=W.b,X.NZ>0)return;if(Ot=Kt=1,De*=.25,c0||!Jt)Ot=0;else for(_t=0;_t<g;_t++)$[_t]=re[_t]}if(Ot!==0){if(W.a=et,Ot=He(Z,X,W,g,p,P,d,$,ee),et=W.a,X.NZ>0)return;if(c0=1,me*=.25,Ot!==0){$t=-(et+et),Tt=et*et;continue}}for(_t=0;_t<g;_t++)$[_t]=re[_t];if(!r0||Kt)break}Ae(P,x,O,p,d,W),Y=W.a,se=W.b,Yt=de(Z,g,Y,se,Q,$,x,O,ee)}Ve=pt,Te=Be,Ze=ft,je=lt}}function rt(Z,j,k,K){let O=Z.Degree,$=Math.PI/180,g=Math.LN2,p=Z.Degree+1,P=new Array(p),d=new Array(p),x=new Array(p),X=new Array(p),W={},Q={},ee,re,Y,se,me,De,Te,je,Ze,Ve,et,Be,lt,ct,ft,At,$t,Tt,pt,Ft,_t,Ot,Vt,Jt;Be=1;do re=Be,Be/=2,lt=1+Be;while(lt>1);let c0=Number.MIN_VALUE/re,Yt=Math.cos(94*$),r0=Math.sin(94*$),Kt=Math.sqrt(.5),v0=-Kt;for(Q.NZ=pt=0,Q.szr=Q.szi=Q.lzr=Q.lzi=0;j[O]===0;)k[pt]=K[pt]=0,O--,pt++;for(Vt=O+1;O>=1;){if(O<=2){O<2?(k[Z.Degree-1]=-(j[1]/j[0]),K[Z.Degree-1]=0):(W.li=W.lr=W.si=W.sr=0,Ge(j[0],j[1],j[2],W),k[Z.Degree-2]=W.sr,K[Z.Degree-2]=W.si,k[Z.Degree-1]=W.lr,K[Z.Degree-1]=W.li);break}for(Te=0,je=Number.MAX_VALUE,ie=0;ie<Vt;ie++)Ve=Math.abs(j[ie]),Ve>Te&&(Te=Ve),Ve!==0&&Ve<je&&(je=Ve);if(Ze=c0/je,(Ze<=1&&Te>=10||Ze>1&&Number.MAX_VALUE/Ze>=Te)&&(Ze=Ze===0?Number.MIN_VALUE:Ze,_t=Math.floor(Math.log(Ze)/g+.5),me=2**_t,me!==1))for(ie=0;ie<Vt;ie++)j[ie]*=me;for(let f=0;f<Vt;f++)d[f]=Math.abs(j[f]);d[O]=-d[O],Ot=O-1,Ve=Math.exp((Math.log(-d[O])-Math.log(d[0]))/O),d[Ot]!==0&&(et=-d[O]/d[Ot],Ve=et<Ve?et:Ve),et=Ve;do{Ve=et,et=.1*Ve,De=d[0];for(let f=1;f<Vt;f++)De=De*et+d[f]}while(De>0);se=Ve;do{Y=De=d[0];for(let f=1;f<O;f++)De=Ve*De+d[f],Y=Ve*Y+De;De=Ve*De+d[O],se=De/Y,Ve-=se}while(Math.abs(se/Ve)>.005);ee=Ve;for(let f=1;f<O;f++)P[f]=(O-f)*j[f]/O;for(P[0]=j[0],Be=j[O],lt=j[Ot],Jt=P[Ot]===0?1:0,Ft=0;Ft<5;Ft++)if(ct=P[Ot],Jt){for(let f=0;f<Ot;f++)pt=Ot-f,P[pt]=P[pt-1];P[0]=0,Jt=P[Ot]===0?1:0}else{At=-Be/ct;for(let f=0;f<Ot;f++)pt=Ot-f,P[pt]=At*P[pt-1]+j[pt];P[0]=j[0],Jt=Math.abs(P[Ot])<=Math.abs(lt)*re*10?1:0}for(let f=0;f<O;f++)X[f]=P[f];for(Ft=1;Ft<=20;Ft++)if(Tt=-(r0*v0)+Yt*Kt,v0=r0*Kt+Yt*v0,Kt=Tt,ft=ee*Kt,$t=-(2*ft),Qe(re,p,20*Ft,ft,ee,P,O,j,Vt,x,$t,Q),Q.NZ===0)for(let f=0;f<O;f++)P[f]=X[f];else{pt=Z.Degree-O,k[pt]=Q.szr,K[pt]=Q.szi,Vt-=Q.NZ,O=Vt-1;for(let f=0;f<Vt;f++)j[f]=x[f];Q.NZ===1||(k[pt+1]=Q.lzr,K[pt+1]=Q.lzi);break}if(Ft>20){Z.Degree-=O;break}}}rt(he,oe,Ce,Se);let Je=Se.length,J=[];for(ie=0;ie<Je;ie++){let Z=ce(Se[ie],a+8),j=ce(Number(Ce[ie]),a+8);j=a-String(j).length>2?j:Number(Ce[ie]);let k=Number(Z)<0?"-":"",K=j,O=Z;j===0&&(K=""),Z===0&&(O=""),Math.abs(Number(Z))===1?O=`${k}i`:Z?O=`${Z}*i`:O="";let $=K&&O?`${K}+${O}`:String(K)+String(O);J[ie]=$.replace(/\+-/gu,"-")}return J}},roots(i){if(i.isConstant(!0,!0))return t.Utils.nroots(i);let a=le.proots(i).map(c=>e.parse(c));return t.Vector.fromArray(a)},froot(i,a,c){return function(w){let _=c||t.Build.build(t.Calculus.diff(i.clone())),R=i instanceof Function?i:t.Build.build(i),U=1e4,F=!1,ie=0;for(;!F;){let oe=w-R(w)/_(w),Se=Math.abs(oe)-Math.abs(w),he=Math.abs(Se);w=oe,he<1e-12?F=!0:ie>U&&(w=null,F=!0),ie++}return w}(Number(a))},quad(i,a,c){let S=function(w,N,_,R){return e.parse(`-(${N}+${R}*sqrt((${N})^2-4*(${w})*(${_})))/(2*${w})`)};return[S(i,a,c,1),S(i,a,c,-1)]},sumProd(i,a){return le.quad(-a,i,-1).map(c=>c.invert())},coeffs(i,a,c){i=e.expand(i),c||=[new u(0)];let S=Ee(i);a===void 0&&S.length===1&&(a=S[0]),a=String(a),i.group===L&&i.contains(a,!0)&&e.error(`Unable to get coefficients using expression ${i.toString()}`),S=Ee(i);let w=i.contains("pi")||i.contains("e")||i.containsFunction("sqrt");if(S.length===1&&S[0]===a&&!i.isImaginary()&&!w){let N=new ge(i).coeffs.map(_=>new u(_));for(let _=0,R=N.length;_<R;_++){let U=N[_],F=c[_];F&&(U=e.add(F,U)),c[_]=U}}else if(S.length===1&&S[0]===a&&!i.isImaginary()&&w&&i.group===G){let N=t.Utils.getCoeffs(i,a);for(let _=0,R=N.length;_<R;_++){let U=N[_],F=c[_];F&&(U=e.add(F,U)),c[_]=U}}else if(a||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),S.indexOf(a)===-1)c[0]=e.add(i,c[0]);else{c||=[new u(0)];let N;if(i.group===V){let _=i.symbols[a];_||e.error("Expression is not a polynomial!");let R=Number(_.power);N=e.divide(i.clone(),_.clone()),(N.contains(a,!0)||R<0||!pe(R))&&e.error("Expression is not a polynomial!");let U=c[R];U&&(N=e.add(U,N)),c[R]=N}else i.group===G&&i.each(_=>{le.coeffs(_.clone(),a,c)},!0)}for(let N=0,_=c.length;N<_;N++)typeof c[N]>"u"&&(c[N]=new u(0));return c},polyPowers(i,a,c){c||=[];let S=i.group;if(S===D&&a===i.value)c=c.concat(B(i.symbols));else if(S===G)for(let w in i.symbols){if(!Object.hasOwn(i.symbols,w))continue;let N=i.symbols[w],_=N.group,R=N.value;if(_===y&&a===R)c.push(N.power);else if(_===D||_===G)c=le.polyPowers(N,a,c);else if(_===V&&N.contains(a)){let U=N.symbols[a];U&&c.push(U.power)}else(_===o||a!==R)&&c.push(0)}else if(S===V&&i.contains(a)){let w=t.Utils.decompose_fn(i,a,!0);c.push(w.x.power)}return t.Utils.arrayUnique(c).sort()},Factor:{split(i){let a=new u(1),c=new u(1);return le.Factor.factorInner(i,new ve).each(S=>{let w=e.parse(S);S.isConstant(!0)?a=e.multiply(a,w):c=e.multiply(c,w)}),[a,c]},mix(i,a){let c=B(i),S=c.length,w=[];for(let N=0;N<S;N++){let _=Number(c[N]),R=i[c[N]],U=w.length;for(let F=0;F<U;F++){let ie=w[F]*_;w.push(ie),a&&w.push(-ie)}for(let F=1;F<=R;F++)w.push(_**F)}return w},common(i,a){try{if(i.group===G){let c=e.expand(i.clone(),{expand_denominator:!0}),S=F=>F.length||1,w=c.collectSymbols(null,null,(F,ie)=>S(ie)-S(F)),N={},_=[];for(let F=0;F<w.length;F++){let ie=w[F];_.push(ie.multiplier.clone()),ie.each(oe=>{let Se=Number(oe.power);if(isNaN(Se))throw new Error("exiting");oe.value in N?(Se<N[oe.value][0]&&(N[oe.value][0]=Se),N[oe.value][1].push(oe)):N[oe.value]=[Se,[oe]]})}let R=new u(1);for(let F in N)N[F][1].length===w.length&&(R=e.multiply(R,e.pow(new u(F),new u(N[F][0]))));let U=t.Math2.QGCD.apply(null,_);if(!U.equals(1)){a.add(new u(U));for(let F=0;F<w.length;F++)w[F].multiplier=w[F].multiplier.divide(U)}if(!R.equals(1)){a.add(R),i=new u(0);for(let F=0;F<w.length;F++)i=e.add(i,e.divide(w[F],R.clone()))}}}catch(c){if(c.message==="timeout")throw c}return i},zeroes(i,a){let c=function(){throw new t.exceptions.ValueLimitExceededError("Exiting")};try{let S,w,N;i=e.expand(i.clone());let _=i.toString(),R=Ee(i);w=new u(0);let U=[],F=[];for(let ie=0,oe=R.length;ie<R.length;ie++){let Se={};for(let Ce=0;Ce<oe;Ce++)ie!==Ce&&(Se[R[Ce]]=0);S=e.parse(_,Se);let he=S.power;pe(he)||c(),U.push(S),F.push(S.power)}if(t.Utils.allSame(F)){let ie=i.length,oe=U.length,Se=Math.round((Math.sqrt(8*ie-1)-3)/2);oe===2?N=new fe(Number(F[0])/(ie-1)):oe===3&&Se!==0?N=new fe(Number(F[0])/Se):N=t.Math2.QGCD.apply(null,F)}else N=t.Math2.QGCD.apply(null,F);if(!pe(N))return i;for(let ie=0;ie<U.length;ie++){let oe=U[ie],Se=oe.power.clone().divide(N),he=Number(Se);if((Number(oe.multiplier.num)<0||Number(oe.multiplier.den)<0)&&he%2===0)return i;oe.multiplier=new fe(Number(oe.multiplier)**(1/he)),oe.power=N.clone(),w=e.add(w,oe)}if(w.group!==G)return i;for(;;){let ie=le.div(i.clone(),w.clone());if(ie[1].equals(0)){if(i=ie[0],a.add(w.clone()),i.equals(1))break}else break}}catch(S){if(S.message==="timeout")throw S}return i},factor(i,a){t.Utils.checkTimeout();let c=a?[...a]:null;try{let S=le.Factor.factorInner(i,a);return S=S.pushMinus(),S}catch(S){if(S.message==="timeout")throw S;return a&&a.splice(0,a.length,...c),i}},factorInner(i,a){if(t.Utils.checkTimeout(),i.isConstant()&&i.isInteger())return t.Math2.factor(Number(i.multiplier));let c=e.parse(i);if(c.isConstant())return c.isInteger()?t.Math2.factor(Number(c.multiplier)):i;if(c.equals(0)||c.equals(1))return c;let S=le.Factor._factor(c,a);if(S.equals(i)||S.equals(0)||S.equals(1))return S;if(S.group===V){let w=new u(1),N=e.parse(S.power),_=e.parse(S.multiplier);S.toUnitMultiplier(),S.multiplier.lessThan(0)&&(w.negate(),S.negate()),S.each(U=>{let F=e.parse(le.Factor._factor(U));if(_=e.multiply(_,u.create(F.multiplier.toString())),F.toUnitMultiplier(),F.group===V){let ie=new u(1);F.each(oe=>{let Se=e.parse(le.Factor._factor(oe));Se.group===V&&(_=e.multiply(_,u.create(Se.multiplier.toString())),Se.toUnitMultiplier()),ie=e.multiply(ie,Se)}),ie=e.pow(ie,new u(F.power.toString())),w=e.multiply(w,ie)}else w=e.multiply(w,F)});let R=e.pow(w,N);S=e.multiply(_,R)}return S},quadFactor(i,a){if(i.isPoly()&&le.degree(i.equals(2))){let c=t.Utils.variables(i)[0],S=le.coeffs(i,c);if(S.length<3)return i;let w=le.Factor._factor(S[2].clone());if(w.group===V){let N=w.collectSymbols();if(N.length>2)return i;let _=e.multiply(e.parse(S[0]),e.parse(N[0])),R=e.parse(S[1]).negate(),U=e.parse(N[1]),F=le.quad(U,R,_).filter(ie=>t.Utils.isInt(ie));if(F.length===1){let ie=F[0],oe=e.divide(S[0],e.parse(ie));t.Utils.isInt(oe)&&(a.add(e.parse(Me("({0})*({1})+({2})",String(N[1]),c,String(oe)))),a.add(e.parse(Me("({0})*({1})+({2})",String(N[0]),c,ie))),i=new u(1))}}}return i},cubeFactor(i,a){if(i.isComposite()){let c=i.collectSymbols();if(c.length===2){let S=c[0].sign(),w=c[0].clone().abs(),N=c[1].sign(),_=c[1].clone().abs();if(w.isCube()&&_.isCube()){S<N&&([S,N]=[N,S],[w,_]=[_,w]);let R=e.parse(w.getNth(3)),U=e.parse(_.getNth(3)),F=e.multiply(e.expand(e.pow(w.clone().toUnitMultiplier(),e.parse("1/3"))),R),ie=e.multiply(e.expand(e.pow(_.clone().toUnitMultiplier(),e.parse("1/3"))),U);S===1&&N===-1?(a.add(e.parse(Me("(({0})-({1}))",String(F),String(ie)))),a.add(e.parse(Me("(({0})^2+({0})*({1})+({1})^2)",String(F),String(ie)))),i=new u(1)):S===1&&N===1&&(a.add(e.parse(Me("(({0})+({1}))",String(F),String(ie)))),a.add(e.parse(Me("(({0})^2-({0})*({1})+({1})^2)",String(F),String(ie)))),i=new u(1))}}}return i},_factor(i,a){t.Utils.checkTimeout();let c=i.group;if(i.group===C){let w=i.args[0];if(w.group===y&&w.isSimple())return i}else if(i.group===y&&i.isSimple())return i;if(i.group===G){i.distributeMultiplier(!0);let w=new u(0);i.each(N=>{(N.group===G&&N.power.greaterThan(1)||N.group===V)&&(N=e.expand(N)),w=e.add(w,N)}),w.power=i.power,i=w}i.group===C&&i.fname!=="sqrt"&&(i=t.Utils.evaluate(i));let S=i.clone();try{if(i.group===V){let N=e.parse(i.power),_=le.Simplify.strip(i.getDenom()),R=le.Simplify.strip(i.getNum()),U=_.pop(),F=R.pop();if(F.equals(i))return i;let ie=le.Factor.factorInner(F),oe=le.Factor.factorInner(U),Se=le.Simplify.unstrip(R,ie),he=le.Simplify.unstrip(_,oe);return e.divide(Se,he)}if(i.group===y)return i;if(i.isConstant())return i.equals(1)||i.equals(0)||!i.isInteger()?i.clone():t.Math2.factor(i);let w=i.power.clone();if(pe(w)&&!(w.lessThan(0)&&i.group===C)){let N=w.sign();i.toLinear(),a||=new ve;let _={};i=e.parse(t.Utils.subFunctions(i,_)),B(_).length>0&&(a.preAdd=function(Ce){return e.parse(Ce,t.Utils.getFunctionsSubs(_))}),i.isLinear()||(a.pFactor=i.power.toString(),i.toLinear());let R=Ee(i);i.isImaginary()&&R.push(t.Settings.IMAGINARY);let U=R.length>1;if(U){let he=!0,Ce=!0;if(i.each(Ae=>{Ae.group!==y&&(he=!1),Ae.multiplier.equals(1)||(Ce=!1)}),he&&Ce)return e.pow(e.parse(i,t.Utils.getFunctionsSubs(_)),e.parse(w))}let F=new ve;i=le.Factor.coeffFactor(i,F),F.each(he=>{we(w)&&he.lessThan(0)&&he.negate(),N<0&&he.invert(),a.add(he)});let ie=new ve;if(i=le.Factor.powerFactor(i,ie),ie.each(he=>{N<0&&he.invert(),a.add(he)}),U)i=le.Factor.cubeFactor(i,a),i=le.Factor.mfactor(i,a),a.each(he=>{N<0&&he.power.negate()});else{let he=R[0];i=le.Factor.squareFree(i,a,he);let Ce=new ve;i=le.Factor.trialAndError(i,Ce,he);let Ae=Ce.toSymbol();if(Ae.equals(S))return Ae;for(let de in Ce.factors){if(!Object.hasOwn(Ce.factors,de))continue;let Le=Ce.factors[de];a.add(e.pow(Le,e.parse(w)))}i.equals(S)&&(i=le.Factor.quadFactor(i,a))}i=e.parse(i,t.Utils.getFunctionsSubs(_));let oe=a.length===1;a.add(e.pow(i,e.parse(w)));let Se=a.toSymbol();return oe&&i.equals(1)&&Se.isLinear()&&(Se=e.pow(Se,e.parse(w))),Se}return i}catch(w){if(w?.message==="timeout")throw w;return S}},reduce(i,a){if(i.group===G&&i.length===2){let c=i.collectSymbols().sort((S,w)=>Number(w.multiplier)-Number(S.multiplier));if(c[0].power.equals(c[1].power)){let S=e.parse(c[0].power),w=c[0].clone().toLinear(),N=c[1].clone().toLinear();a.add(e.add(w.clone(),N.clone())),N.negate();let _=Number(S),R=new u(0);for(let U=1;U<=_;U++){let F=e.pow(w.clone(),e.subtract(S.clone(),new u(U))),ie=e.pow(N.clone(),e.subtract(new u(U),new u(1)));R=e.add(R,e.multiply(F,ie))}return R}}return i},squareFree(i,a,c){if(i.isConstant()||i.group===y||!i.isPoly())return i;let w=new ge(i,c).squareFree(),N=w[2];if(N!==1){let _=w[1].toSymbol();return _.power=_.power.multiply(new fe(N)),a.add(le.Factor.factorInner(_)),le.Factor.squareFree(w[0].toSymbol(),a)}return i},powerFactor(i,a){if(i.group!==D||i.previousGroup===L)return i;let c=B(i.symbols);if(!t.Utils.allNumeric(c))return i;let S=t.Utils.arrayMin(c),w=new u(0),N=e.parse(`${i.value}^${S}`);return i.each(_=>{_=e.divide(_,N.clone()),w=e.add(w,_)}),a.add(N),w},coeffFactor(i,a){if(i.isComposite()){let c=t.Math2.QGCD.apply(null,i.coeffs());if(c.equals(1)){let S=function(_){let R;return _.group===V?(R=0,_.each(U=>{R+=U.power})):R=Number(_.power),R},w=i.collectSymbols(null,null,null,!0).sort((_,R)=>_.isConstant(!0)?1:Number(R.power)-Number(_.power)),N=w[0];(S(N)>S(w[1])||w[1].isConstant(!0))&&N.multiplier.lessThan(0)&&(a.add(new u(-1)),i.each(_=>{_.negate()},!0))}else i.each(S=>{S.isComposite()?S.each(w=>{w.multiplier=w.multiplier.divide(c)}):S.multiplier=S.multiplier.divide(c)}),i.updateHash();a&&a.add(new u(c))}return i},trialAndError(i,a,c){let S=i.clone();try{let w=[];if(i.isConstant()||i.group===y||!i.isPoly())return i;let N=new ge(i,c),_=N.coeffs[0],R=t.Math2.ifactor(Number(_)),U=le.proots(i);for(let F=0;F<U.length;F++){let ie=U[F],oe=1;if(!isNaN(Number(ie))){for(let de in R){if(!Object.hasOwn(R,de))continue;let Le=t.Utils.round(Math.log(Number(de))/Math.log(Math.abs(Number(ie))),8);if(pe(Le)){ie=de,oe=Number(Le);break}}let Se=new fe(Number(ie)),he=[new fe(Number(Se.num)).negate()];he[oe]=new fe(Number(Se.den));let Ce=ge.fromArray(he,N.variable).fill(),Ae=N.divide(Ce);Ae[1].equalsNumber(0)&&(N=Ae[0],w.push(Ce.toSymbol()))}}return N.equalsNumber(1)||(N=le.Factor.search(N,a)),w.forEach(F=>{a.add(F)}),N.toSymbol()}catch(w){if(w.message==="timeout")throw w;return S}},search(i,a,c){c||=10;let S=i.variable,w=function(Ae,de,Le,Pe){let Ge=ge.fit(Ae,de,Le,c,Pe,S);if(Ge&&Ge.coeffs.length>1){let We=i.divide(Ge);if(We[1].equalsNumber(0))return a.add(Ge.toSymbol()),[We[0],Ge]}return null},N=i.coeffs[0],_=t.Math2.ifactor(Number(N)),R=i.lc(),U=t.Math2.ifactor(Number(R)),F=i.sub(c),ie=t.Math2.ifactor(F),oe=le.Factor.mix(ie,F<0),Se=Math.ceil(i.coeffs.length/2),he=R.lessThan(0),Ce=N.lessThan(0);for(U[1]=1,_[1]=1;Se--;)for(let Ae in U)if(Object.hasOwn(U,Ae)){for(let de in _)if(Object.hasOwn(_,de))for(let Le=0;Le<oe.length;Le++){let Pe=w(Number(Ae),Number(de),oe[Le],Se);if(Pe)return i=Pe[0],t.Utils.isPrime(i.sub(c))||(i=le.Factor.search(i,a)),i;Pe||(he&&Ce?Pe=w(-Number(Ae),-Number(de),oe[Le],Se):he?Pe=w(-Number(Ae),Number(de),oe[Le],Se):Ce&&(Pe=w(Number(Ae),-Number(de),oe[Le],Se)))}}return i},mSqfrFactor(i,a){if(i.group!==C){let c=Ee(i).reverse();for(let S=0;S<c.length;S++){let w=!1;do{if(c[S]===i.value){a.add(i),i=new u(1);continue}let N=t.Calculus.diff(i,c[S]),_=le.Factor.coeffFactor(N);if(_.equals(0)||_.equals(1)||_.equals(-1))break;let R=!0;_.isConstant()&&i.isComposite()&&i.each(F=>{Number(F.multiplier)%Number(_.multiplier)!==0&&(R=!1)},!0);let U;if(R){let F=i.clone();if(U=le.divWithCheck(i,_.clone()),w=U[1].equals(0),i.equals(U[0])&&U[1].equals(0)){i=F;break}if(U[0].isConstant()){a.add(U[0]);break}}else w=!1;w&&(a.add(U[0]),i=_)}while(w)}}return i},sqdiff(i,a){if(i.isConstant("all"))return i;try{let c=function(N){return t.Utils.block("POSITIVE_MULTIPLIERS",()=>u.unwrapPARENS(ye.sqrt(ye.abs(N))),!0)},S=t.Utils.separate(i.clone());if(!S)return i;let w=[];for(let N in S)N!=="constants"&&w.push(S[N]);if(w.sort((N,_)=>Number(_.power)-Number(N.power)),w.length===2){let N,_;if(N=w.pop(),_=w.pop(),we(Number(N.power))&&we(Number(_.power))&&N.sign()===_.sign()&&N.group===y&&_.group===y)throw new Error("Unable to factor");if(N.isComposite()&&_.power.equals(2)&&N.sign()!==_.sign()){_=c(_);let R=le.Factor.factorInner(e.add(N,S.constants));R.power.equals(2)&&(R.toLinear(),a.add(e.subtract(R.clone(),_.clone())),a.add(e.add(R,_)),i=new u(1))}else if(N=N.powSimp(),_=_.powSimp(),(N.group===y||N.fname==="")&&N.power.equals(2)&&(_.group===y||_.fname==="")&&_.power.equals(2)&&!S.constants){if(N.multiplier.lessThan(0)){let R=_;_=N,N=R}N.multiplier.greaterThan(0)&&(N=c(N),_=c(_)),a.add(e.subtract(N.clone(),_.clone())),a.add(e.add(N,_)),i=new u(1)}}}catch(c){if(c.message==="timeout")throw c}return i},mfactor(i,a){if(i.group===C)if(i.fname==="sqrt"){let c=new ve,S=le.Factor.common(i.args[0].clone(),c);S=le.Factor.coeffFactor(S,null),i=e.multiply(e.symfunction("sqrt",[S]),e.parse(i.multiplier)),c.each(w=>{i=e.multiply(i,e.parse(t.Utils.format("sqrt({0})",String(w))))})}else a.add(i),i=new u(1);else{i=le.Factor.mSqfrFactor(i,a);let c=Ee(i),S=i.collectSymbols().map(U=>u.unwrapSQRT(U)),w={},N={},_=c.length,R=S.length;for(let U=0;U<_;U++){let F=c[U];w[F]=new u(0);for(let ie=0;ie<R;ie++){let oe=S[ie];if(oe.contains(F)){let Se=oe.value===F?oe.power.toDecimal():oe.symbols[F].power.toDecimal();(!N[F]||Se<N[F])&&(N[F]=Se),w[F]=e.add(w[F],oe.clone())}}}for(let U in w){if(!Object.hasOwn(w,U))continue;let F=e.parse(`${U}^${N[U]}`),ie=e.divide(w[U],F),oe=e.expand(ie);if(oe.equals(1)||oe.equals(-1))break;let Se=le.div(i.clone(),oe);if(Se[0].equals(0))break;if(Se[1].equals(0)){let Ce=!1;if(Se[0].each(Ae=>{pe(Ae.multiplier)||(Ce=!0)}),Ce){Se[1]=e.expand(e.multiply(Se[1],oe));break}}let he=pe(oe)&&oe.lessThan(0);if(Se[1].equals(0)&&!he){let Ce=le.divWithCheck(i.clone(),Se[0].clone()),Ae=Ce[0];if(Ae.equals(0)||(i=Ce[1],Ae.equals(-1)&&!i.equals(0)))return i;let de=Se[0];if(i.equals(de)){let Le=le.Factor.reduce(de,a);return i.equals(Le)?Le:le.Factor.mfactor(Le,a)}return a.add(de),i.equals(0)?Ae:Ae.isConstant("all")?(a.add(Ae),Ae):(i=le.Factor.mfactor(Ae,a),i)}}}return i=le.Factor.sqdiff(i,a),i=le.Factor.zeroes(i,a),i}},allLinear(i){let a=i.length;for(let c=0;c<a;c++)if(!le.isLinear(i[c]))return!1;return!0},isLinear(i){let a=!1,c=i.group;if(c===D||c===G){a=!0;for(let S in i.symbols){if(!Object.hasOwn(i.symbols,S))continue;let w=i.symbols[S],N=w.group;if((N===C||N===L)&&(a=!1),N===V)a=Ee(w).length===1;else if(N===D||N===G)a=le.isLinear(w);else if(w.group!==o&&w.power.toString()!=="1"){a=!1;break}}}else c===y&&i.power===1&&(a=!0);return a},gcd(...i){let a;if(i.length===1&&i[0]instanceof t.Vector?a=i[0].elements:a=i,a.length===0)return new u(1);if(a.length===1)return a[0];let c=[],S=!1;for(let w=0;w<a.length;w++)if(a[w].group===C&&a[w].fname==="gcd")a=a.concat(a[w].args),a.splice(w,1);else{let N=Ee(a[w]);if(t.Utils.haveIntersection(N,c)){S=!0;break}else c=c.concat(N)}if(S||c.length===0){if(a.every(w=>w.getDenom().equals(1))){let w=a[0];for(let N=1;N<a.length;N++)w=le.gcd_(a[N],w);return w}return e.divide(le.gcd.apply(null,a.map(w=>w.getNum())),le.lcm.apply(null,a.map(w=>w.getDenom())))}return e.symfunction("gcd",a)},gcd_(i,a){if((i.group===C||i.group===h)&&(i=t.Utils.block("PARSE2NUMBER",()=>e.parse(i))),a.group===C&&(a=t.Utils.block("PARSE2NUMBER",()=>e.parse(a))),i.isConstant()&&a.isConstant())return new u(t.Math2.QGCD(new fe(Number(i)),new fe(Number(a))));let c=e.multiply(i.getDenom()||new u(1),a.getDenom()||new u(1)).invert();if(i=e.multiply(i.clone(),c.clone()),a=e.multiply(a.clone(),c.clone()),i=e.expand(i),a=e.expand(a),i.group===V||a.group===V){let U=e.divide(i.clone(),a.clone()),F=e.multiply(a.clone(),U.getDenom().invert());if(!F.equals(1))return F}if(i.group===L||a.group===L){let U=new u(t.Math2.GCD(i.multiplier,a.multiplier)),F=le.gcd_(i.value===xe?new u(1):e.parse(i.value),a.value===xe?new u(1):e.parse(a.value)),ie=le.gcd_(e.parse(i.power),e.parse(a.power));return e.multiply(U,e.pow(F,ie))}if(i.length<a.length){let U=i;i=a,a=U}let S=Ee(i),w=Ee(a);if(S.length===1&&w.length===0||S.length===0&&w.length===1){let U=S.length===1?i:a,F=S.length===0?i:a;return F.equals(0)?U:new u(t.Math2.QGCD(U.multiplier,F.multiplier))}if(S.length===w.length&&S.length===1&&S[0]===w[0])return i=new ge(i),a=new ge(a),e.divide(i.gcd(a).toSymbol(),c);let N=[];i.each(U=>{N.push(U.multiplier)}),a.each(U=>{N.push(U.multiplier)});let _;for(;!a.equals(0);){let U=a.clone();if(i=i.clone(),_=le.div(i,U),a=_[1],_[0].equals(0))return e.divide(new u(t.Math2.QGCD(i.multiplier,a.multiplier)),c);i=U}let R=t.Math2.QGCD.apply(void 0,N);return R.equals(1)||i.each(U=>{U.multiplier=U.multiplier.divide(R)}),i.equals(1)&&!i.isConstant()&&!a.isConstant()?e.divide(e.symfunction("gcd",[i,a]),c):e.divide(i,c)},lcm(...i){let a;i.length===1?i[0]instanceof t.Vector?a=i[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):a=i;let c=a.reduce((_,R)=>e.multiply(_,R.clone()),new u(1)),S=(function(R,U){U=Number(U);let F=[],ie,oe,Se,he=2**R.length;for(oe=U;oe<he;oe++){ie=[],Se=R.length-1;do(oe&1<<Se)!==0&&ie.push(R[Se]);while(Se--);ie.length===U&&F.push(ie)}return F})(a,a.length-1).map(_=>_.reduce((R,U)=>e.multiply(R,U.clone()),new u(1))),w;return a.every(_=>t.Utils.isVariableSymbol(_))?w=e.symfunction("gcd",t.Utils.arrayUnique(S)):w=le.gcd.apply(null,S),e.divide(c,w)},divide(i,a){let c,S=le.Factor.factorInner(i.clone());c=S.getDenom(),c.isConstant("all")?c=new u(1):i=e.expand(u.unwrapPARENS(e.multiply(S,c.clone())));let w=le.div(i,a),N=e.divide(w[1],a);return e.divide(e.add(w[0],N),c)},divWithCheck(i,a){let c=[new u(0),i.clone()],S=le.div(i,a),w=i.clone(),N=e.multiply(S[0].clone(),a.clone());N=e.add(N,S[1].clone());let _=e.subtract(w,N);return _=e.expand(_),_.equals(0)?S:c},div(i,a){let c=[new u(0),i.clone()];try{if(a.isConstant("all"))return i.each(oe=>{oe.multiplier=oe.multiplier.divide(a.multiplier)}),[i,new u(0)];if(i=e.expand(i),a=e.expand(a),i.group===y&&a.group===G){let oe=i.value,Se=t.Utils.decompose_fn(a.clone(),oe,!0);if(i.isLinear()&&Se.x&&Se.x.isLinear()&&a.isLinear()){let he=u.create(i.multiplier);return[e.divide(he.clone(),Se.a.clone()),e.divide(e.multiply(he,Se.b),Se.a).negate()]}}if(i.group===y&&a.group===y){let oe=e.divide(i.clone(),a.clone());return oe.isConstant()?[oe,new u(0)]:[new u(0),i.clone()]}let S=i.hasFunc(),w=a.hasFunc(),N=!1,_;if(S||w){N=!0;let oe={};i=e.parse(t.Utils.subFunctions(i,oe)),a=e.parse(t.Utils.subFunctions(a,oe)),_=t.Utils.getFunctionsSubs(oe)}let R=t.Utils.arrayUnique(Ee(i).concat(Ee(a))),U,F,ie;if((i.isImaginary()||a.isImaginary())&&R.push(t.Settings.IMAGINARY),R.length===1){let oe=new ge(i).divide(new ge(a));U=oe[0].toSymbol(),F=oe[1].toSymbol()}else{R.push(xe);let oe=function(Qe){let rt=new u(0);for(let Je=0;Je<Qe.length;Je++){let J=Qe[Je].toSymbol();rt=e.add(rt,J)}return rt},Se=function(Qe,rt){let Je=Math.max.apply(null,Qe.terms),J=0,Z;if(!rt){for(let j=0;j<Qe.terms.length;j++)if(Qe.terms[j].equals(Je)&&(Z=j,J++),J>1)return}if(rt){for(let j=0;j<Qe.terms.length;j++)if(Qe.terms[j].equals(Je)){Z=j;break}}return[Je,Z,Qe]},he=t.Utils.toMapObj(R),Ce=function(Qe,rt){return rt.sum.subtract(Qe.sum)},Ae=i.tBase(he).sort(Ce),de=a.tBase(he).sort(Ce),Le=function(Qe,rt){rt||=0;let Je=Qe[rt],J=Qe.length;if(!Je)return;let Z=Se(Je);for(let K=rt+1;K<J;K++){let O=Qe[K],$=Je.sum.equals(O.sum);if(!$&&Z)break;if($){let g,p,P,d,x=Je.terms.length;for(let Q=0;Q<x;Q++){let ee=Je.terms[Q],re=O.terms[Q];(typeof g>"u"||ee.greaterThan(g))&&(g=ee,P=Q),(typeof p>"u"||re.greaterThan(p))&&(p=re,d=Q)}let X=g.subtract(O.terms[P]),W=p.subtract(Je.terms[d]);if(W>X){Z=[p,d,O];break}if(X>W){Z=[g,P,Je];break}}else if(Z=Se(O),Z)break;Z=Se(O)}if(!Z)return Se(Qe[0],!0);let j,k;for(let K=0;K<de.length;K++){let O=de[K].terms;if(k=Z[1],k===O.length-1)return;if(j=O[k],!j.equals(0))break}return j.equals(0)?Le(Qe,++rt):Z},Pe=function(Qe,rt){if(!Qe||!rt)return!1;for(let Je=0;Je<Qe.terms.length;Je++)if(Qe.terms[Je].lessThan(rt.terms[Je]))return!1;return!0},Ge=Pe(Ae[0],de[0])&&Ae[0].count>de[0].count?de:Ae,We=Le(Ge),He=[];if(We){let Qe=We[1],rt=function($,g){return $[0].sum.equals(g[0].sum)?$.length>=g.length:!0},Je=function($,g,p){let P=[];for(let d=0;d<$.length;d++){let x=$[d];for(let X=0;X<x.terms.length;X++){let W=P[X],Q=x.terms[X];d===0?P[X]=Q:W&&!W.equals(Q)&&(P[X]=void 0)}}for(let d=0;d<P.length;d++){let x=P[d];if(x&&!x.equals(0))return d}return p},J=function($,g){let p=$.len(),P=g.len(),d=g.terms[Qe],x=$.terms[Qe];return P>p&&d.greaterThan(x)?P-p:d.subtract(x)};Qe=Je(Ae,de,Qe),Ae.sort(J),de.sort(J);let Z=de[0],j=Ae[0];if(ie=new Ie(new fe(1),[],j.map),Z.sum.greaterThan(j.sum)&&j.len()>1)for(let $=0;$<j.terms.length;$++){let g=Z.terms[$].subtract(j.terms[$]);if(g.equals(0))ie.terms[$]=new fe(0);else{let p=g.add(new fe(1));ie.terms[$]=g;for(let P=0;P<Ae.length;P++)Ae[P].terms[$]=Ae[P].terms[$].add(p)}}let k=Pe(Ae[0],de[0]),K=0,O=200;for(;k&&rt(Ae,de);){if(K++>O)throw new t.exceptions.InfiniteLoopError("Unable to compute!");let $=Ae[0].divide(de[0]);He.push($),Ae.shift();for(let g=1;g<de.length;g++){let p=de[g].multiply($).generateImage(),P=Ae.length;P===0&&(p.coeff=p.coeff.neg(),Ae.push(p),Ae.sort(J));for(let d=0;d<P;d++){let x=Ae[d];if(x.getImg()===p.getImg()){x.coeff=x.coeff.subtract(p.coeff),x.coeff.equals(0)&&(t.Utils.remove(Ae,d),d--);break}d===P-1&&(p.coeff=p.coeff.neg(),Ae.push(p),Ae.sort(J))}}if(k=Pe(Ae[0],de[0]),!k&&Ae.length>=de.length){for(let g=1;g<Ae.length;g++)if(k=Pe(Ae[g],de[0]),k){Ae.unshift(t.Utils.remove(Ae,g));break}}}}U=oe(He),F=oe(Ae),typeof ie<"u"&&(ie=ie.toSymbol(),U=e.divide(U,ie.clone()),F=e.divide(F,ie))}return N&&(U=e.parse(U.text(),_),F=e.parse(F.text(),_)),[U,F]}catch(S){if(S.message==="timeout")throw S;return c}},line(i,a,c){t.Utils.isArray(i)&&(i=t.Utils.convertToVector(i)),t.Utils.isArray(a)&&(a=t.Utils.convertToVector(a)),c=e.parse(c||"x"),(!t.Utils.isVector(i)||!t.Utils.isVector(a))&&e.error(`Line expects a vector! Received "${i}" & "${a}"`);let S=e.subtract(a.e(1).clone(),i.e(1).clone()),w=e.subtract(a.e(2).clone(),i.e(2).clone()),N=e.divide(w,S),_=e.multiply(c,N.clone()),R=e.multiply(i.e(1).clone(),N);return e.add(e.subtract(_,R),i.e(2).clone())},PartFrac:{createTemplate(i,a,c,S){i=le.Factor.factorInner(i),i.each((oe,Se)=>{if(oe.group===C&&oe.fname===""&&oe.args[0].group===y){let he=oe.args[0];i.symbols?(delete i.symbols[Se],i.symbols[he.value]=he):i=oe.args[0]}});let w,N,_,R=a.collectFactors(),U=[],F=[],ie=new u(1);for(let oe=0;oe<R.length;oe++){let Se=u.unwrapPARENS(R[oe]);if(Se.power.greaterThan(1)){N=Number(Se.power),w=Se.clone().toLinear(),_=Number(le.degree(w,S));for(let he=0;he<N;he++){let Ce=e.pow(w.clone(),new u(he+1));c.push(Ce.clone());let Ae=e.divide(i.clone(),Ce.clone());F.push(_),U.push(Ae)}}else{_=Number(le.degree(Se,S)),c.push(Se);let he=e.divide(i.clone(),Se.clone());he=e.expand(u.unwrapPARENS(he)),F.push(_),U.push(he)}}return c=c.map(oe=>e.multiply(oe,ie.clone())),[c,U,F]},partfrac(i,a,c){let S=Ee(i);a||=e.parse(S[0]);try{let w,N,_,R=e.expand(i.getNum()),U=e.expand(i.getDenom().toUnitMultiplier());if(R.multiplier=i.multiplier,w=R.groupTerms(a),Number(le.degree(R,a))>=Number(le.degree(U,a))?(N=le.div(R.clone(),e.expand(U.clone())),_=N[0],R=N[1],w=R.groupTerms(a)):_=new u(0),Number(le.degree(U,a))===1){let J=e.divide(R,U);return c?[_,J]:e.add(_,J)}let F=le.Factor.factorInner(U),ie=le.PartFrac.createTemplate(U.clone(),F,[],a),oe=ie[0],Se=ie[1],he=ie[2],Ce=[w.length],Ae=[],de=[],Le=[],Pe,Ge;Se.forEach((J,Z)=>{Pe=oe[Z],Ge=he[Z];for(let j=0;j<Ge;j++){de.push(Pe.clone());let k=u.create(a,j),K=e.expand(e.multiply(J,k.clone())).groupTerms(a),O=K.length;Ce.push(O),Ae.push(K),Le.push(k.clone())}});let We=t.Utils.arrayMax(Ce),He=new t.Matrix(t.Utils.fillHoles(w,We)).transpose(),Qe=new t.Matrix;for(let J=0;J<Ae.length;J++)Qe.elements.push(t.Utils.fillHoles(Ae[J],We));let rt=e.multiply(Qe.transpose().invert(),He),Je=c?[_]:_;return rt.each((J,Z)=>{let j=e.multiply(Le[Z],e.divide(J,de[Z]));c?Je.push(j):Je=e.add(Je,j)}),Je}catch(w){if(w.message==="timeout")throw w;try{if(i.isComposite()){let N={};i.each(R=>{let U=R.getDenom(),F=R.getNum(),ie=N[U];N[U]=ie?e.add(ie,F):F});let _=new u(0);for(let R in N)Object.hasOwn(N,R)&&(_=e.add(_,e.divide(N[R],e.parse(R))));i=_}}catch(N){if(N.message==="timeout")throw N}}return i}},degree(i,a,c){if(c||={nd:[],sd:[],depth:0},!a){let N=Ee(i);if(N.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(N.length===0)return new u(0);a=e.parse(N[0])}let S=i.group;i.isComposite()?(i=i.clone(),i.distributeExponent(),i.each(N=>{c.depth++,le.degree(N,a,c),c.depth--})):i.group===V?i.each(N=>{c.depth++,le.degree(N,a,c),c.depth++}):S===L&&i.value===a.value?c.sd.push(i.power.clone()):S===y&&i.value===a.value?c.nd.push(e.parse(i.power)):c.nd.push(new u(0));let w=c.nd.length>0?t.Utils.arrayMax(c.nd):void 0;return c.depth===0&&c.sd.length>0?(w!==void 0&&c.sd.unshift(w),e.symfunction("max",c.sd)):(t.Utils.isSymbol(w)||(w=e.parse(w)),w)},sqComplete(i,a,c){t.Utils.isSymbol(a)||(a=e.parse(a));let S=function(Ae){throw Ae||="Stopping",new t.exceptions.ValueLimitExceededError(Ae)};i.isPoly(!0)||S("Must be a polynomial!");let w=t.Utils.inBrackets;i=i.clone();let N=t.Algebra.degree(i,a);N.equals(2)||S(`Cannot complete square for degree ${N}`);let _=t.Algebra.coeffs(i,a),R=_[2],U=_[1].sign(),F=e.divide(_[1],new u(2)),ie=e.pow(F.clone(),new u(2)),oe=ye.sqrt(R),Se=e.divide(ye.sqrt(ie),oe.clone()),he=e.subtract(_[0],e.pow(Se.clone(),new u(2)));if(c)return[R,F,he];let Ce=e.parse(w(`${oe.clone()}*${a}${U<0?"-":"+"}${Se}`));return{a:Ce,c:he,f:e.add(e.pow(Ce.clone(),new u(2)),he.clone())}},Simplify:{strip(i){let a=e.parse(i.multiplier);i.toUnitMultiplier();let c=e.parse(i.power);return i.toLinear(),[a,c,i]},unstrip(i,a){let c=i[0],S=i[1];return e.multiply(c,e.pow(a,S))},complexSimp(i,a){let c=i.realpart(),S=i.imagpart(),w=a.realpart(),N=a.imagpart(),_=e.multiply(c.clone(),w.clone()),R=e.multiply(S.clone(),N.clone()),U=e.multiply(w.clone(),S),F=e.multiply(c,N.clone()),ie=e.add(e.pow(w,new u(2)),e.pow(N,new u(2)));return e.divide(e.add(e.add(_,R),e.multiply(e.subtract(U,F),u.imaginary())),ie)},trigSimp(i){let a=!0,c=0;for(;a&&i.containsFunction(["cos","sin","tan"]);){c++,a=!1,i=i.clone();let S=le.Simplify.strip(i);i=S.pop();let w=i.clone();if(i.group===G){let N=new u(0);i.each(_=>{let R=le.Simplify.trigSimp(_.fnTransform());N=e.add(N,R)},!0),w=e.pow(e.multiply(new u(i.multiplier),N),new u(i.power)),a=w.text()!==i.text()}else if(i.group===V){let N=i.getNum(),_=i.getDenom();if(N.fname==="sin"&&_.fname==="cos"&&N.args[0].equals(_.args[0])&&N.power.equals(_.power))w=e.parse(t.Utils.format("(({1})/({0}))*tan({2})^({3})",_.multiplier,N.multiplier,N.args[0],N.power)),a=!0;else if(N.fname==="tan"&&_.fname==="sin"&&N.args[0].equals(_.args[0])&&N.power.equals(_.power))w=e.parse(t.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",_.multiplier,N.multiplier,N.args[0],N.power)),a=!0;else{let R=new u(1),U={workDone:a};w.each(F=>{if(F.fname==="tan")F=e.parse(t.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",F.multiplier,le.Simplify._simplify(F.args[0]),F.power)),U.workDone=!0;else if(F.containsFunction(["cos","sin","tan"])){let ie=le.Simplify.trigSimp(F);F.equals(ie)||(F=ie,U.workDone=!0)}R=e.multiply(R,F)}),a=U.workDone,w=R}}else if((i.fname==="cos"||i.fname==="sin")&&i.args[0].group===G){let N=0,_=new u(0),R=e.parse("pi/2");if(i.args[0].each(U=>{let F=e.divide(U.clone(),R.clone());F=le.Simplify._simplify(F),F=t.Utils.evaluate(F),pe(F)?N+=F.multiplier.num.toJSNumber():_=e.add(_,U)}),N){N+=i.fname==="cos"?1:0,N%=4,N+=N<0?4:0;let U=["sin({0})","cos({0})","-sin({0})","-cos({0})"],F=t.Utils.format(U[N],String(_));w=e.parse(F),a=!0}else if(Object.keys(i.args[0].symbols).length>1){let U=i.args[0].clone(),F=Object.values(U.symbols),ie=F[0],Se=F.slice(1).map(Ce=>`(${Ce.text()})`).join("+"),he;i.fname==="sin"?he=t.Utils.format("sin({0})cos({1})+sin({1})cos({0})",ie,Se):he=t.Utils.format("cos({0})cos({1})-sin({1})sin({0})",ie,Se),w=e.parse(he),a=!0}}else if((i.fname==="cos"||i.fname==="sin")&&i.args[0].multiplier.sign()===-1){let N=i.args[0].clone().negate(),_=t.Utils.format(`${i.fname}({0})`,N);i.fname==="sin"&&(_=`-${_}`),w=e.parse(_),a=!0}if(i.fname==="sin"&&i.args[0].multiplier.equals(2)&&!i.args[0].equals(2)){let N=i.args[0].clone().toUnitMultiplier(),_=t.Utils.format("2sin({0})cos({0})",N);w=e.parse(_),a=!0}if(w=le.Simplify.unstrip(S,w).distributeMultiplier(),i=w,c>10)break}return i},logArgSimp(i,a){if(a.value==="1"||a.value===1)return new u(0);let c=new u(0),S=a.multiplier.clone();if(a.toUnitMultiplier(),!S.equals(1)){let w=t.Utils.format("({0}({1}))",i,S);c=e.add(c,e.parse(w))}if(a.group===V)a.each(w=>{w=w.clone();let N=w.power.clone();le.Simplify.strip(w);let _=t.Utils.format("(({1})*{0}({2}))",i,N,w);c=e.add(c,e.parse(_))});else{let w=a.clone(),N=w.power.clone();le.Simplify.strip(w);let _=t.Utils.format("(({1})*{0}({2}))",i,N,w);c=e.add(c,e.parse(_))}return c},logSimp(i){if(i.group===C&&(i.fname==="log"||i.fname==="log10")){let a=i.clone(),c=le.Simplify.strip(i);i=c.pop();let S=i.args[0].clone(),w=S.getNum().clone(),N=S.getDenom().clone(),_=i.fname,R=le.Simplify.logArgSimp(_,w);if(!N.equals(1)){let U=le.Simplify.logArgSimp(_,N);R=e.subtract(R,U)}R=le.Simplify.unstrip(c,R).distributeMultiplier(),i=R}else if(i.containsFunction(["log","log10"]))for(let a in i.symbols){if(!Object.hasOwn(i.symbols,a))continue;let c=i.symbols[a];i.symbols[a]=le.Simplify.logSimp(c)}return i},_sqrtCompression(i,a,c){let S=le.Simplify.strip(i),w=Ce=>Ce.fname==="abs",N=Ce=>Ce.args[0],_=Ce=>w(Ce)?N(Ce):null,R=Ce=>Ce.type===y&&Ce.value.startsWith("baseunit_"),U=(Ce,Ae)=>{let de=N(Ae);return de.equals(_(Ce))?[Ae,null]:de.equals(Ce)&&R(Ce)?[Ae,null]:[null,Ae]},F,ie=!1,oe=(Ce,Ae)=>{for(let de=0;de<Ce.length;de++){let Le=Ce[de];if(Le.isSQRT()){for(let Pe=0;Pe<Ae.length;Pe++){let Ge=Ae[Pe];if([Ge,Le]=U(Ge,Le),Ge!==null){Ae[Pe]=Ge,F=!0,ie=!0;break}}Ce[de]=Le,Ce=Ce.filter(Pe=>Pe),Ae=Ae.filter(Pe=>Pe)}}return[Ce,Ae]},Se=a.collectFactors(),he=c.collectFactors();do F=!1,[Se,he]=oe(Se,he),[he,Se]=oe(he,Se);while(F);return ie&&(i=Se.reduce((Ce,Ae)=>Ce=e.multiply(Ce,Ae),new u(1)),i=he.reduce((Ce,Ae)=>Ce=e.divide(Ce,Ae),i)),i=le.Simplify.unstrip(S,i),i},fracSimp(i){let a=i.getDenom(),c=i.getNum();if(c.isImaginary()&&a.isImaginary()&&(i=le.Simplify.complexSimp(c,a)),i.isComposite()){i.power>1&&(i=e.expand(i));let S=i.collectSymbols(),w,N,_,R,U,F,ie,oe,Se,he,Ce;for(N=S.pop();S.length;)_=S.pop(),R=e.parse(N.getDenom()),U=e.parse(_.getDenom()),F=N.getNum(),ie=_.getNum(),Ce=e.multiply(R.clone(),U.clone()),Se=e.multiply(F,U),he=e.multiply(ie,R),oe=e.add(Se,he),N=e.divide(oe,Ce);return a=e.expand(N.getDenom()),c=e.expand(N.getNum()),c.isImaginary()&&a.isImaginary()?w=le.Simplify.complexSimp(c,a):w=e.divide(c,a),w.equals(i)?i:le.Simplify._simplify(w)}return i=le.Simplify._sqrtCompression(i,c,a),i=le.Simplify.simpleFracSimp(i),i},simpleFracSimp(i){let a=i.getDenom(),c=i.getNum(),S;return a=e.expand(a),c=e.expand(c),c.isImaginary()&&a.isImaginary()?S=le.Simplify.complexSimp(c,a):S=e.divide(c,a),S.equals(i)?i:S},ratSimp(i){if(i.group===V){let a=i.getDenom(),c=i.getNum().distributeMultiplier(),S=le.Simplify.fracSimp(a),w=le.Simplify.fracSimp(c);i=e.divide(w,S)}return i},sqrtSimp(i,a){let c,S=!1,w=i.clone();try{if(i.isSQRT()){let N=i.multiplier.clone(),_=i.args[0].clone(),R=le.Factor.factorInner(_),U=e.parse(R.multiplier),F=U.sign();c=new u(1);let ie;if(R.group===V){let oe=new u(1);R.each(he=>{if(he=e.parse(he),he.group===o){let Ce=e.sqrt(he.clone());pe(Ce)?c=e.multiply(c,Ce):oe=e.multiply(oe,he)}else oe=e.multiply(oe,he)});let Se=e.multiply(oe,e.parse(F));ie=e.sqrt(Se.clone()),ie.isImaginary()&&(ie=e.sqrt(e.expand(Se.clone())))}else ie=R.clone().toUnitMultiplier(),ie=e.multiply(ie,new u(F)),ie=e.sqrt(ie);c=e.multiply(c,ie),c=e.pow(c,e.parse(i.power)),c=e.multiply(c,e.sqrt(U.abs())),c=e.multiply(c,e.parse(N)),S=!0}else i.isComposite()&&i.isLinear()?(c=new u(0),i.each(N=>{c=e.add(c,le.Simplify.sqrtSimp(N))},!0),c=e.pow(c,e.parse(i.power)),c=e.multiply(c,e.parse(i.multiplier)),S=!0):i.group===V&&(c=new u(1),i.each(N=>{let _=le.Simplify.sqrtSimp(N);c=e.multiply(c,_)}),c=e.pow(c,e.parse(i.power)),c=e.multiply(c,e.parse(i.multiplier)),S=!0);return S||c&&!pe(c)&&(c=null),c||=e.parse(i),c}catch(N){if(N.message==="timeout")throw N;return w}},patternSub(i){let a={},c=function(w){let N=!1;return w.each(_=>{_.group===G?N=!0:_.symbols&&(N=c(_))}),N},S=function(w){w.each(N=>{if(!(!N.symbols&&N.group!==C)){if(c(N))S(N);else if(!a[N.value]){let _=t.Utils.getU(i);a[N.value]=_,i=i.sub(N.value,_)}}},!0)};return S(i),[i,a]},simplify(i){if(i.simplify)return i.simplify();let a=le.Simplify._simplify(i);return a=a.pushMinus(),a=e.parse(a),a},_simplify(i){let a=le.Simplify.strip(i.clone());if(i=a.pop(),i=le.Simplify.fracSimp(i),i.isConstant()||i.group===t.groups.S)return a.push(i),le.Simplify.unstrip(a,i);let c=i.clone();if(c=le.Simplify.sqrtSimp(c,a),c=le.Simplify.trigSimp(c),c=le.Simplify.logSimp(c),c=le.Simplify.ratSimp(c),c=le.Factor.factorInner(c),c.group===t.groups.CP&&c.isLinear()){let S=c.multiplier.clone();c.toUnitMultiplier();let w=new u(0);return c.each(N=>{let _=le.Simplify._simplify(N);w=e.add(w,_)}),c=w,c=e.multiply(c,new u(S)),c.multiplier.equals(-1)&&c.distributeMultiplier(),c=le.Simplify.unstrip(a,c),c}return c=le.Simplify.unstrip(a,c),c}},Classes:{Polynomial:ge,Factors:ve,MVTerm:Ie}};t.Expression.prototype.simplify=function(){t.Utils.armTimeout();try{let a;if(typeof this.symbol.LHS>"u")a=new t.Expression(le.Simplify.simplify(this.symbol));else{let c=this.symbol.clone();c.LHS=le.Simplify.simplify(c.LHS),c.RHS=le.Simplify.simplify(c.RHS),a=c}return a}catch(a){if(a.message==="timeout")throw a;return this}finally{t.Utils.disarmTimeout()}},t.Collection.prototype.simplify=function(){return this.elements=this.elements.map(a=>le.Simplify.simplify(a)),this},t.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(a=>a.map(c=>le.Simplify.simplify(c))),this},h0.useAlgebraDiv=function(){let a=le.divideFn=e.divide,c=0;e.divide=function S(w,N){c++;let _;return c===1?_=t.Algebra.divide(w,N):_=S(w,N),c=0,_}},h0.useParserDiv=function(){le.divideFn&&(e.divide=le.divideFn),delete le.divideFn},h0.register([{name:"factor",visible:!0,numargs:1,build(){return le.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return le.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return le.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return le.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return le.roots}},{name:"divide",visible:!0,numargs:2,build(){return le.divide}},{name:"div",visible:!0,numargs:2,build(){return le.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return le.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return le.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...a){let c=le.coeffs(...a);return new t.Vector(c)}}}]),h0.coeffs=function(...a){let c=t.PARSER;for(let w=0;w<a.length;w++)typeof a[w]=="string"?a[w]=c.parse(a[w]):a[w]&&a[w].symbol?a[w]=a[w].symbol.clone():t.Utils.isSymbol(a[w])&&(a[w]=a[w].clone());let S=le.coeffs(...a);return new t.Expression(new t.Vector(S))},h0.register([{name:"line",visible:!0,numargs:[2,3],build(){return le.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(a,c){try{return c||=Ee(a)[0],le.sqComplete(a.clone(),c).f}catch(S){if(S.message==="timeout")throw S;return a}}}}]),h0.updateAPI()})()});var f1=f0((Ki,c1)=>{"use strict";var R0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof c1<"u"&&R0===void 0&&(R0=T0(),V0(),X0());(function(){let t=R0.getCore(),e=t.PARSER,o=t.Algebra,h=t.Calculus,y=h.integration.decompose_arg,{evaluate:L}=t.Utils,{remove:C}=t.Utils,{format:D}=t.Utils,{build:G}=t.Build,{knownVariable:V}=t.Utils,{NerdamerSymbol:B}=t,{isSymbol:we}=t.Utils,{variables:Ee}=t.Utils,{S:Me}=t.groups,{PL:ce}=t.groups,{CB:pe}=t.groups,{CP:fe}=t.groups,{FN:u}=t.groups,{Settings:Ne}=t,{range:_e}=t.Utils,{isArray:xe}=t.Utils;t.Settings.SOLVE_RADIUS=1e3,t.Settings.ROOTS_PER_SIDE=10,t.Settings.make_pi_conversions=!1,t.Settings.STEP_SIZE=.1,t.Settings.EPSILON=2e-13,t.Settings.MAX_NEWTON_ITERATIONS=200,t.Settings.NEWTON_EPSILON=2e-15,t.Settings.MAX_NON_LINEAR_TRIES=12,t.Settings.NON_LINEAR_JUMP_AT=50,t.Settings.NON_LINEAR_JUMP_SIZE=100,t.Settings.NON_LINEAR_START=.01,t.Settings.NEWTON_SLICES=200,t.Settings.SOLUTION_PROXIMITY=1e-14,t.Settings.FILTER_SOLUTIONS=!0,t.Settings.MAX_SOLVE_DEPTH=10,t.Settings.ZERO_EPSILON=1e-9,t.Settings.MAX_BISECTION_ITER=2e3,t.Settings.BI_SECTION_EPSILON=1e-12,t.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},t.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let a in this.symbols){if(!Object.hasOwn(this.symbols,a))continue;let c=this.symbols[a];if(c.group===ce&&c.hasNegativeTerms()||this.symbols[a].power.lessThan(0))return!0}return!1};function ye(i,a){if(a.isConstant()&&i.isConstant()&&!i.equals(a)||i.equals(t.Settings.IMAGINARY)&&a.isConstant(!0)||a.equals(t.Settings.IMAGINARY)&&i.isConstant(!0))throw new t.exceptions.NerdamerValueError(`${i.toString()} does not equal ${a.toString()}`);this.LHS=i,this.RHS=a}ye.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(i){return`${this.LHS.text(i)}=${this.RHS.text(i)}`},toLHS(i){i=!!i;let a=this.removeDenom(),c=a.LHS,S=a.RHS;c.isConstant(!0)&&!S.isConstant(!0)&&([c,S]=[S,c]);let w=e.subtract(c,S),N=i?e.expand(w):w;return N=new ye(N,new B(0)).removeDenom().LHS,N},removeDenom(){let i=this.LHS.clone(),a=this.RHS.clone(),c=e.multiply(i.getDenom(),a.getDenom());if(i=e.expand(e.multiply(i,c.clone())),a=e.expand(e.multiply(a,c)),a.group===fe&&a.group!==fe){let S=i;i=a,a=S}if(i.group===pe){let S=new B(i.multiplier),w=a.clone();i.each(N=>{N.power.lessThan(0)?w=e.divide(w,N):S=e.multiply(S,N)}),i=S,a=w}else if(i.group===fe)for(let S in i.symbols){if(!Object.hasOwn(i.symbols,S))continue;let w=i.symbols[S];if(w.group===pe)for(let N in w.symbols){if(!Object.hasOwn(w.symbols,N))continue;let _=w.symbols[N];if(_.power.lessThan(0))return new ye(e.expand(e.multiply(_.clone().toLinear(),i)),e.expand(e.multiply(_.clone().toLinear(),a)))}}return new ye(i,a)},clone(){return new ye(this.LHS.clone(),this.RHS.clone())},sub(i,a){let c=this.clone();return c.LHS=c.LHS.sub(i.clone(),a.clone()),c.RHS=c.RHS.sub(i.clone(),a.clone()),c},isZero(){return t.Utils.evaluate(this.toLHS()).equals(0)},latex(i){return[this.LHS.latex(i),this.RHS.latex(i)].join("=")}},e.equals=function(a,c){return new ye(a,c)},(function(){let a=e.functions.simplify[0];e.functions.simplify[0]=function(S){return S instanceof ye?(S.LHS=a(S.LHS),S.RHS=a(S.RHS),S):a(S)}})(),t.Expression.prototype.equals=function(a){return a instanceof t.Expression&&(a=a.symbol),new ye(this.symbol,a)},t.Expression.prototype.solveFor=function(a){t.Utils.armTimeout();try{let{symbol:c}=this;if(this.symbol instanceof ye){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(a))return[new t.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(a))return[new t.Expression(this.symbol.RHS)]}return le(c,a).map(N=>(N=t.Algebra.Simplify.simplify(e.parse(N)),new t.Expression(N)))}finally{t.Utils.disarmTimeout()}},t.Expression.prototype.expand=function(){if(this.symbol instanceof ye){let a=this.symbol.clone();return a.RHS=e.expand(a.RHS),a.LHS=e.expand(a.LHS),new t.Expression(a)}return new t.Expression(e.expand(this.symbol))},t.Expression.prototype.variables=function(){return this.symbol instanceof ye?t.Utils.arrayUnique(t.Utils.variables(this.symbol.LHS).concat(t.Utils.variables(this.symbol.RHS))):t.Utils.variables(this.symbol)};let $e=function(a,c){return e.equals(a,c)};t.Equation=ye;let ge=t.Utils.checkAll=function(a,c){for(let S=0;S<a.length;S++)if(c(a[S]))return!1;return!0},ve=t.Solve={version:"2.0.3",solutions:[],solve(i,a){let c=Ne.PARSE2NUMBER;Ne.PARSE2NUMBER=!1;let S=le(i,String(a));return Ne.PARSE2NUMBER=c,new t.Vector(S)},toLHS(i,a){if(we(i))return i;if(!(i instanceof ye)){let c=i.split("=");c[1]||="0",i=new ye(e.parse(c[0]),e.parse(c[1]))}return i.toLHS(a)},solveCircle(i,a){let c=a.map(R=>e.parse(R)),S=[],w=[];for(let R=0;R<i.length;R++){let U=[];for(let F=0;F<c.length;F++)U.push(Number(t.Algebra.degree(i[R],c[F])));U.push(t.Utils.arraySum(U,!0)),S.push(U)}let N=i[0],_=i[1];if(S[0][2]>S[1][2]&&([_,N]=[N,_],[S[1],S[0]]=[S[0],S[1]]),S[0][0]===1&&S[0][2]===2&&S[1][0]===2&&S[1][2]===4){let R=a[0],U=a[1],F=le(e.parse(_,V(R,le(e.parse(N),R)[0])),U).map(oe=>oe.toString()),ie=[le(e.parse(N,V(U,F[0])))[0].toString()];F[1]&&ie.push(le(e.parse(N,V(U,F[1])))[0].toString()),Ne.SOLUTIONS_AS_OBJECT?(w={},w[R]=ie,w[U]=F):(F.unshift(U),ie.unshift(R),w=[ie,F])}return w},solveNonLinearSystem(i,a,c){if(a<0)return[];c=typeof c>"u"?t.Settings.NON_LINEAR_START:c;let S=t.Settings.MAX_NON_LINEAR_TRIES,w=Math.floor(S/2);a=typeof a>"u"?S:a;let N=t.Settings.NON_LINEAR_JUMP_AT,_=t.Settings.NON_LINEAR_JUMP_SIZE,R=!0,U=function(rt,Je){return rt.map((J,Z)=>Number(Je.get(Z,0)))},F=t.Utils.arrayGetVariables(i),ie=t.Matrix.jacobian(i,F,rt=>G(rt,F),!0),oe=t.Settings.MAX_NEWTON_ITERATIONS,Se,he,Ce,Ae,de,Le,Pe,Ge,We=i.map(rt=>G(rt,F)),He=ie.map(rt=>G(rt,F),!0);Ae=t.Matrix.cMatrix(0,F);let Qe=t.Matrix.cMatrix(c,F);Ce=0;do{if(Ce>oe){R=!1;break}Se=U(F,Qe),Pe=Qe.clone();let rt=Se,Je=Qe;We.forEach((Z,j)=>{Je.set(j,0,Z(...rt))});let J=new t.Matrix;if(He.each((Z,j,k)=>{let K=Z(...rt);J.set(j,k,K)}),J=J.invert(),he=e.multiply(J,Qe).negate(),Ge=he.subtract(Ae,Z=>e.parse(Number(Z))),Ae=Pe.add(he,Z=>e.parse(Number(Z))),Qe=Ae,Ce>=N&&de>1){a===w&&(c=0);let Z=a>w?1:-1,j=a%Math.floor(w)+1;return c+=Z*j*_,ve.solveNonLinearSystem(i,--a,c)}if(Le=de,Ce++,de=Ge.max(),Number(de)===Number(Le))break}while(Number(de)>=Number.EPSILON);return R?ve.systemSolutions(Qe,F,!0,rt=>t.Utils.round(Number(rt),14)):[]},systemSolutions(i,a,c,S){let w=t.Settings.SOLUTIONS_AS_OBJECT?{}:[];return i.each((N,_)=>{let R=(c?e.expand(N):N).valueOf();S&&(R=S.call(N,R));let U=a[_];t.Settings.SOLUTIONS_AS_OBJECT?w[U]=R:w.push([U,R])}),w},solveSystemBySubstitution(i){let a=Ee(i[0]),c=Ee(i[1]);return i.length===2&&a.length===2&&t.Utils.arrayEqual(a,c)?ve.solveCircle(i,a):[]},solveSystem(i,a){for(let U=0;U<i.length;U++)i[U]=ve.toLHS(i[U]);let c=i.length,S=new t.Matrix,w=new t.Matrix,N=!1,_;if(typeof a>"u"){if(!o.allLinear(i))try{return ve.solveNonLinearSystem(i)}catch(U){if(U.message==="timeout")throw U;if(U instanceof t.exceptions.DivisionByZero)return ve.solveSystemBySubstitution(i)}if(_=t.Utils.arrayGetVariables(i),_.length===1){let U=0,F,ie;do ie=i[U].clone(),U>0&&(ie=ie.sub(_[0],F[0])),F=le(ie,_[0]);while(++U<i.length);let oe;return Ne.SOLUTIONS_AS_OBJECT?(oe={},oe[_[0]]=F):F.length===0?oe=F:oe=[_[0],F],oe}if(_.length<i.length){let U=[],F=i.length;for(let he=0;he<F-1;he++)U.push(e.parse(i[he]));let ie={},oe=ve.solveSystem(U,_);Array.isArray(oe)?oe.forEach(he=>{ie[he[0]]=he[1]}):ie=oe;let Se=!0;for(let he=F-1;he<F;he++)e.parse(i[he],ie).equals(0)||(Se=!1);if(Se)return oe}for(let U=0;U<_.length;U++)R0.setVar(_[U],"delete");for(let U=0;U<c;U++){let F=i[U];for(let oe=0;oe<_.length;oe++){let Se=_[oe],he=[];F.each(Ae=>{Ae.contains(Se)&&(he=he.concat(Ae.coeffs()))});let Ce=t.Utils.arraySum(he);S.set(U,oe,Ce)}let ie=F.clone();_.forEach(oe=>{ie=ie.stripVar(oe,!0)}),w.set(U,0,ie.negate())}}else{_=a,N=!0;for(let U=0;U<c;U++){w.set(U,0,new B(0));let F=e.expand(i[U]).collectSummandSymbols();for(let ie=0;ie<a.length;ie++){S.set(U,ie,new B(0));let oe=a[ie];for(let Se=0;Se<F.length;Se++){let he=F[Se],Ce=!1;for(let Ae=0;Ae<a.length;Ae++)he.contains(a[Ae])&&(Ce&&t.Utils.err(`Multiple variables found for term ${he}`),Ce=!0);if(he.contains(oe)){let Ae=y(C(F,Se),oe);Se--,S.set(U,ie,e.add(S.get(U,ie),Ae[0]))}}}for(let ie=0;ie<F.length;ie++)w.set(U,0,e.add(w.get(U,0),F[ie]))}}if(_.length!==i.length||S.determinant().equals(0))throw new t.exceptions.SolveError("System does not have a distinct solution");S=S.invert();let R=S.multiply(w);return t.Utils.isArray(a)&&R.each(U=>U.negate()),ve.systemSolutions(R,_,N)},quad(i,a,c){let S=e.subtract(e.pow(a.clone(),new B(2)),e.multiply(e.multiply(c.clone(),i.clone()),new B(4)));S=e.expand(S);let w=e.pow(S,new B(.5)),N=e.parse(e.multiply(new B(2),c.clone()));return[e.parse(D("(-({0})+({1}))/({2})",a,w,N)),e.parse(D("(-({0})-({1}))/({2})",a,w,N))]},cubic(i,a,c,S){let w=S.text(),N=c.text(),_=a.text(),R=i.text(),U=`(-(${N})^3/(27*(${w})^3)+(${N})*(${_})/(6*(${w})^2)-(${R})/(2*(${w})))`,F=`((${_})/(3*(${w}))-(${N})^2/(9*(${w})^2))`,ie=`(${N})/(3*(${w}))`,oe=`((${U})+sqrt((${U})^2+(${F})^3))^(1/3)+((${U})-sqrt((${U})^2+(${F})^3))^(1/3)-(${ie})`,Se="1/2+sqrt(3)/2*i";return[e.parse(oe),e.parse(`(${oe})(${Se})`),e.parse(`(${oe})(${Se})^2`)]},quartic(i,a,c,S,w){let N={};t.Utils.arrayUnique(Ee(w).concat(Ee(S)).concat(Ee(c)).concat(Ee(a)).concat(Ee(i))).forEach(Le=>{N[Le]=1}),w=w.toString(),S=S.toString(),c=c.toString(),a=a.toString(),i=i.toString();let _,R=e.parse(D("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",w,S,c)).toString(),U=e.parse(D("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",w,S,c,a)).toString(),F=e.parse(D("12*({0})*({4})-3*({1})*({3})+({2})^2",w,S,c,a,i)).toString(),ie=e.parse(D("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",w,S,c,a,i)).toString(),oe=e.parse(D("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",F,ie)).toString(),Se=e.parse(D("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",w,R,oe,F)).toString(),he=e.parse(D("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",w,S,R,U,Se)),Ce=e.parse(D("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",w,S,R,U,Se)),Ae=e.parse(D("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",w,S,R,U,Se)),de=e.parse(D("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",w,S,R,U,Se));return[he,Ce,Ae,de]},divideAndConquer(i,a){let c=[],S=t.Algebra.Factor.factorInner(i);return S.group===pe&&S.each(w=>{w=B.unwrapPARENS(w),c=c.concat(le(w,a))}),c},csolve(i,a){return t.Utils.block("IGNORE_E",()=>{let c,S,w,N,_,R,U,F,ie=[],oe=t.Utils.decompose_fn(i,a,!0);if(oe.x.group===Me){c=e.parse(oe.x.power),S=Number(c),w=e.pow(e.divide(oe.b.negate(),oe.a),c.invert()),N=B.toPolarFormArray(w),_=N[0],R=N[1],U=_.toString(),F=c.toString();let Se,he,Ce;for(let Ae=0;Ae<S;Ae++)Se=Ae,Ce=D("({0})*e^(2*{1}*pi*{2}*{3})",U,Se,c,t.Settings.IMAGINARY),he=e.parse(Ce),ie.push(he)}return ie},!0)},getPoints(i,a,c){a||=.01;let S=[],w=G(i),_=Math.round(0),R=w(_),U=t.Settings.ROOTS_PER_SIDE,F=U;S.push(Math.floor(_/2)),S.push(Math.abs(_)),S.push(_),i.each(he=>{he.containsFunction(t.Settings.LOG)&&S.push(.1)});let ie=_e(-t.Settings.SOLVE_RADIUS,_,a),oe=_e(_,t.Settings.SOLVE_RADIUS,a),Se=function(he,Ce){let Ae,de,Le,Pe=[],Ge=he[0],We=Math.sign(w(Ge));for(let He=0,Qe=he.length;He<Qe&&Pe.length<Ce;He++)Ae=he[He],de=w(Ae),Le=Math.sign(de),!isNaN(Le)&&(Le!==We&&(Pe.push(Ae),Pe.push(he[He-1])),We=Le);S=S.concat(Pe)};if(Se(ie,F),Se(oe,U),c){let he=t.Settings.SOLVE_RADIUS;Se([he,he*he],1),Se([-he*he,-he],1)}return S},bisection(i,a){let c=i-1,S=i+1;if(Math.sign(a(c))!==Math.sign(a(S))){let w=0,N,_;do{if(N=Math.abs(S-c),w++>t.Settings.MAX_BISECTION_ITER||isNaN(N))return;_=(c+S)/2,a(c)*a(_)>0?c=_:S=_}while(N>=Ne.EPSILON);let R=(c+S)/2,U=a(R);return!isNaN(U)&&Math.abs(U)<=t.Settings.BI_SECTION_EPSILON?t.Utils.round(R,13):void 0}},bSearch(i,a,c){let S=c(i),w=c(a);if(Math.sign(S)===Math.sign(w)||isNaN(S)||isNaN(w))return;let N=80,_=0;do{let R=(i+a)/2,U=Math.sign(S),F=Math.sign(c(R));if(U===F){if(R===i)break;i=R,S=c(i)}else{if(R===a)break;a=R,w=c(a)}_++}while(i!==a&&_<N);if(!(!isFinite(c(i))||!isFinite(c(a))))return i},Newton(i,a,c,S){let w=t.Settings.MAX_NEWTON_ITERATIONS,N=0,_=i,R,U,F;do{let ie=a(_);if(_===0&&ie===0){R=0;break}if(N++,N>w)return;let oe=c(_);if(isNaN(oe)||isNaN(ie))return;if(oe===0)R+=F;else{if(!isFinite(ie)||!isFinite(oe)||Math.abs(ie)>1e25)return ve.bSearch(S,_,a);R=_-ie/oe}if(F=R-_,F===0&&!isFinite(oe))return;U=Math.abs(F),_=R}while(U>Ne.NEWTON_EPSILON);return R},rewrite(i,a,c){if(a||=new B(0),i.isComposite()&&i.isLinear()){let N=[],_=[];i.each(R=>{R=R.clone(),R.fname==="sqrt"&&R.contains(c)?N.push(R):_.push(R)},!0),N.length===1&&(a=e.expand(e.pow(e.subtract(a,t.Utils.arraySum(_)),new B(2))),i=e.expand(e.pow(B.unwrapSQRT(N[0]),new B(2))))}else i=B.unwrapSQRT(e.expand(i));let S=0,w=i.length;if(i.group===fe&&i.contains(c)&&i.isLinear()){i.distributeMultiplier();let N=new B(0);return i.each(_=>{_.contains(c)?(S++,N=e.add(N,_.clone())):a=e.subtract(a,_.clone())}),i=N,S!==w?ve.rewrite(i,a,c):[i,a]}if(i.group===pe&&i.contains(c)&&i.isLinear()){if(i.multiplier.lessThan(0)&&(i.multiplier=i.multiplier.multiply(new t.Frac(-1)),a.multiplier=a.multiplier.multiply(new t.Frac(-1))),a.equals(0))return new B(0);let N=new B(1);return i.each(_=>{_.contains(c)?N=e.multiply(N,_.clone()):a=e.divide(a,_.clone())}),i=N,ve.rewrite(i,a,c)}if(!i.isLinear()&&i.contains(c)){let N=e.parse(i.power.clone().invert());return i=e.pow(i,N.clone()),a=e.pow(e.expand(a),N.clone()),ve.rewrite(i,a,c)}return i.group===u||i.group===Me||i.group===ce?[i,a]:[i,a]},sqrtSolve(i,a){let c=new B(0),S=new B(0);if(i.isComposite()&&(i.each(w=>{w.fname==="sqrt"&&w.contains(a)?c=e.add(c,w.clone()):S=e.add(S,w.clone())}),!c.equals(0))){let w=e.expand(e.multiply(e.parse(i.multiplier),e.subtract(e.pow(S,new B(2)),e.pow(c,new B(2))))),N=le(w,a);return N=N.filter(_=>{if(_.isImaginary())return!0;let R={};return R[a]=_,!!L(i,R).equals(0)}),N}}},Ie=function(i,a,c,S){let w=i.toString(),N=w.match(/(?<![a-z])abs/gu);if(!N||N.length>2||i.LHS.group!==u&&i.RHS.group!==u)return null;let _=i.constructor(w.replace(/(?<![a-z])abs/u,"")),R=i.constructor(w.replace(/(?<![a-z])abs/u,"(-1)")),U=le(_,a,null,c,S);return[le(R,a,null,c,S),U]};function le(i,a,c,S,w){if(S||=0,S++>Ne.MAX_SOLVE_DEPTH)return c;c||=[];let N={},_={};_[a]=0;let R=function(de,Le){let Pe=we(de);if(!(de===void 0||typeof de=="number"&&isNaN(de))){if(xe(de))de.forEach(Ge=>{R(Ge)});else if(de.valueOf()!=="null"){if(typeof t.Settings.PRE_ADD_SOLUTION=="function"&&(de=t.Settings.PRE_ADD_SOLUTION(de)),Pe||(de=e.parse(de)),t.Settings.make_pi_conversions&&Le){let We=e.divide(de.clone(),new B(Math.PI)),He=We.multiplier,Qe=Math.abs(He.num),rt=Math.abs(He.den);Qe<10&&rt<10&&(de=e.multiply(We,new B("pi")))}let Ge=de.toString();N[Ge]||c.push(de),N[Ge]=!0}}};if(i instanceof ye){let de=Ie(i,a,c,S,w);if(de)return R(de),c;if(i.isZero())return[new B(0)];if(i.LHS.equals(a)&&!i.RHS.contains(a,!0))return[i.RHS];if(i.RHS.equals(a)&&!i.LHS.contains(a,!0))return[i.LHS]}if(i instanceof t.Vector&&(i=i.elements),xe(i))return ve.solveSystem(i,a);if(a||="x",we(i)&&L(i.getDenom(),_).equals(0)===!0)return c;if(i.group===Me&&i.contains(a)){try{let de={};de[a]=0,L(w,de,"numer"),R(new B(0))}catch(de){if(de.message==="timeout")throw de}return c}if(i.group===pe){let de=i.getNum();if(de.group===pe){let Le=String(a);return de.each(Pe=>{Pe.contains(Le)&&le(Pe,a,c,S,i)}),c}return le(de,a,c,S,w)}i.group===u&&i.fname==="sqrt"&&(i=e.pow(B.unwrapSQRT(i),new B(2)));let U=(t.Utils.isSymbol(i)?i:ve.toLHS(i,!1)).getNum(),F=t.Utils.variables(U),ie=F.length;if(t.Utils.isInt(U.power)&&U.power>1&&(U=e.parse(U).toLinear()),(U.group===Me||U.group===pe)&&U.contains(a))return[new B(0)];let oe={},Se,he=function(de){de=e.expand(de,{expand_denominator:!0,expand_functions:!0});let Le=de.clone();if(de.symbols)for(let Pe in de.symbols){if(!Object.hasOwn(de.symbols,Pe))continue;let Ge=de.symbols[Pe],We=Ge.getDenom();if(!We.isConstant(!0)&&de.isComposite()){let J=new B(0);return de.each(Z=>{J=e.add(J,e.multiply(Z,We.clone()))}),he(e.multiply(e.parse(de.multiplier),J))}let He=y(Ge,a),Qe=He[1].fname===t.Settings.SQRT,rt=B.unwrapSQRT(He[1]),Je=rt.power.clone();if(!we(Je)&&!Je.equals(1/2)){if(Je.den.gt(1)){if(Qe)return de=e.subtract(de,Ge.clone()),de=e.add(de,e.multiply(He[0].clone(),rt)),he(de);let J=oe[Je.den];oe[Je.den]=J?J++:1}else if(Je.sign()===-1){let J=e.parse(`${a}^${Math.abs(Je)}`),Z=de;return Z.each((j,k)=>{j.contains(a)&&(Z.symbols[k]=e.multiply(j,J.clone()))}),oe={},he(e.parse(Z))}else if(Ge.group===ce){let J=t.Utils.arrayMin(t.Utils.keys(Ge.symbols));if(J<0){let Z=e.parse(`${a}^${Math.abs(J)}`),j=new B(0);return Le.each(k=>{j=e.add(j,e.multiply(k.clone(),Z.clone()))},!0),j}}}}return de},Ce=function(de){let Le=new B(0),Pe=new B(0);return de.each(Ge=>{Ge.contains(a,!0)?Le=e.add(Le,Ge.clone()):Pe=e.subtract(Pe,Ge.clone())}),[Le,Pe]};if(ve.inverseFunctionSolve=function(Le,Pe,Ge){let We=y(Pe.args[0],a);if(We[1].group===Me)return e.divide(e.symfunction(Le,[e.divide(Ge,e.parse(Pe.multiplier))]),We[0])},U=he(U),U.equals(0))return[U];let Ae=t.Utils.keys(oe);if(Ae.length===1&&(Se=Ae[0],U.each((de,Le)=>{if(de.contains(a)){let Pe=y(de,a),Ge=Pe[1],We=Ge.power;We.den.gt(1)&&(Ge.power=We.multiply(new t.Frac(Se)),U.symbols[Le]=e.multiply(Ge,Pe[0]))}}),U=e.parse(U)),R(ve.sqrtSolve(U,a)),ie===1)if(U.isPoly(!0)){let de=new t.Algebra.Classes.Factors;if(t.Algebra.Factor.factorInner(U,de),de.getNumberSymbolics()>1)for(let Le in de.factors)Object.hasOwn(de.factors,Le)&&R(le(de.factors[Le],a));else{let Le=t.Utils.getCoeffs(U,a),Pe=Le.length-1,Ge=!1;if(F[0]===a){if(ge(Le,We=>We.group!==t.groups.N)){let We=t.Algebra.proots(U);ge(We,He=>!t.Utils.isInt(He))&&(Ge=!0,We.forEach(He=>{R(new B(He))}))}if(!Ge)if(i=e.parse(i),i instanceof t.Equation&&(i=i.toLHS()),Pe===1)R(e.divide(Le[0],Le[1].negate()));else if(Pe===2)R(e.expand(ve.quad.apply(void 0,Le)));else if(Pe===3){let We=[],He=t.Algebra.Factor.factorInner(i);We=[],We.length>0?R(We):R(ve.cubic.apply(void 0,Le))}else o.proots(U).map(R)}}}else{let de=U.hasTrig(),Le=ve.getPoints(U,.1),Pe=ve.getPoints(U,.05),Ge=ve.getPoints(U,.01,!0),We=t.Utils.arrayUnique(Le.concat(Pe).concat(Ge)).sort((K,O)=>K-O),He,Qe,rt,Je=G(U.clone()),J=[];for(He=0;He<We.length;He++){if(Qe=We[He],rt=ve.bisection(Qe,Je),typeof rt>"u"){J.push(Qe);continue}R(rt,de)}We=J;let Z=h.diff(U.clone()),j=G(Z),k=We[0];for(He=0;He<We.length;He++)Qe=We[He],R(ve.Newton(Qe,Je,j,k),de),k=Qe;c.sort((K,O)=>{let $=K.text("decimals"),g=O.text("decimals"),p=Number($),P=Number(g);return isNaN(p)&&isNaN(P)?$.localeCompare(g):isNaN(p)&&!isNaN(P)?-1:!isNaN(p)&&isNaN(P)?1:p-P}),c=c.map(K=>K.isConstant()?new B(Number(Number(K).toPrecision(15))):K),c=c.filter((K,O,$)=>{let g=Number(Number(K).toPrecision(15)),p=Number($[O-1]);return O===0||isNaN(g)||isNaN(p)?!0:Math.abs(g-p)>=Ne.EPSILON})}else if(!U.hasFunc(a)&&U.isComposite())try{let de=t.Algebra.Factor.factorInner(U.clone()),Le=e.expand(e.parse(de)),Pe=e.expand(U.clone()),Ge=e.subtract(Le,Pe),We=!0;if(Ge.equals(0)||(We=!1),We&&de.group===pe)de.each(He=>{R(le(He,a))});else{let He=t.Utils.getCoeffs(U,a);switch(He.length-1){case 0:{let Je=Ce(U),J=Je[0],Z=Je[1];if(J.group===t.groups.EX){let j=t.Settings.LOG,k=`${j}((${Z})/(${J.multiplier}))/(${j}(${J.value})*${J.power.multiplier})`,K=e.parse(k);R(K)}break}case 1:R(e.divide(He[0],He[1].negate()));break;case 2:R(ve.quad.apply(void 0,He));break;case 3:R(ve.cubic.apply(void 0,He));break;case 4:R(ve.quartic.apply(void 0,He));break;default:R(ve.csolve(U,a)),c.length===0&&R(ve.divideAndConquer(U,a))}c.length===0&&R(le(de,a,c,S))}}catch(de){if(de.message==="timeout")throw de}else try{let de=ve.rewrite(U,null,a),Le=de[0],Pe=de[1];if(Le.group===u)if(Le.fname==="abs")Le.args[0].toString()===a&&R([Pe.clone(),Pe.negate()]);else if(Le.fname==="sin")R(ve.inverseFunctionSolve("asin",Le,Pe));else if(Le.fname==="cos")R(ve.inverseFunctionSolve("acos",Le,Pe));else if(Le.fname==="tan")R(ve.inverseFunctionSolve("atan",Le,Pe));else if(Le.fname===t.Settings.LOG){let Ge=y(Le.args[0],a),We=Ge[1];if(We.group===Me){Pe=e.divide(e.subtract(e.pow(Le.args.length>1?Le.args[1]:new B("e"),e.divide(Pe,e.parse(Le.multiplier))),Ge[3]),Ge[0]);let He=new ye(We,Pe).toLHS();R(le(He,a))}}else R(e.subtract(Le,Pe));else{let Ge=new ye(Le,Pe).toLHS();if(Ge.equals(U))throw new Error("Stopping. No stop condition exists");R(le(Ge,a))}}catch(de){if(de.message==="timeout")throw de;if(U.group===pe)R(0);else if(U.group===fe){let Le=Ce(U),Pe=Le[0],Ge=Le[1];if(Pe.group===t.groups.EX&&Pe.value===a){let We=Pe.power.clone().invert();R(e.pow(Ge,We))}}}if(Se&&(c=c.map(de=>e.pow(de,new B(Se)))),we(i)){let de={};c=c.filter(Le=>{try{de[a]=Le;let Pe=Number(L(i,de));return isNaN(Pe),!0}catch(Pe){if(Pe.message==="timeout")throw Pe;return!1}})}return c}R0.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return le}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return t.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return $e}}]),R0.updateAPI()})()});var p1=f0((e2,on)=>{"use strict";var L0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof on<"u"&&L0===void 0&&(L0=T0(),V0(),X0());(function(){let t=L0.getCore(),e=t.PARSER,{NerdamerSymbol:o}=t,{format:h}=t.Utils,{isVector:y}=t.Utils,{isArray:L}=t.Utils,C=t.Vector,{S:D}=t.groups,G=t.groups.EX,{CP:V}=t.groups,{PL:B}=t.groups,{CB:we}=t.groups,{FN:Ee}=t.groups;t.Settings.Laplace_integration_depth=40,o.prototype.findFunction=function(pe){if(this.group===Ee&&this.fname===pe)return this.clone();let fe;if(this.symbols){for(let u in this.symbols)if(Object.hasOwn(this.symbols,u)&&(fe=this.symbols[u].findFunction(pe),fe))break}return fe};let Me=t.Extra={version:"1.4.2",LaPlace:{transform(ce,pe,fe){ce=ce.clone(),pe=pe.toString(),ce=o.unwrapSQRT(ce,!0);let u,Ne=ce.stripVar(pe),_e=ce.group;if(ce=e.divide(ce,Ne.clone()),ce.isConstant()||!ce.contains(pe,!0))u=e.parse(h("({0})/({1})",ce,fe));else if(_e===D&&t.Utils.isInt(ce.power)){let xe=String(ce.power);u=e.parse(h("factorial({0})/({1})^({0}+1)",xe,fe))}else if(ce.group===D&&ce.power.equals(1/2))u=e.parse(h("sqrt(pi)/(2*({0})^(3/2))",fe));else if(ce.isComposite())u=new o(0),ce.each(xe=>{u=e.add(u,Me.LaPlace.transform(xe,pe,fe))},!0);else if(ce.isE()&&(ce.power.group===D||ce.power.group===we)){let xe=ce.power.stripVar(pe);u=e.parse(h("1/(({1})-({0}))",xe,fe))}else{let xe=["sin","cos","sinh","cosh"];if(ce.group===Ee&&xe.indexOf(ce.fname)!==-1&&(ce.args[0].group===D||ce.args[0].group===we)){let ye=ce.args[0].stripVar(pe);switch(ce.fname){case"sin":u=e.parse(h("({0})/(({1})^2+({0})^2)",ye,fe));break;case"cos":u=e.parse(h("({1})/(({1})^2+({0})^2)",ye,fe));break;case"sinh":u=e.parse(h("({0})/(({1})^2-({0})^2)",ye,fe));break;case"cosh":u=e.parse(h("({1})/(({1})^2-({0})^2)",ye,fe));break}}else{let ye=t.Settings.integration_depth<t.Settings.Laplace_integration_depth,$e;ye&&($e=t.Settings.integration_depth,t.Settings.integration_depth=t.Settings.Laplace_integration_depth),t.Utils.block("PARSE2NUMBER",()=>{let ge=pe,ve=ce.sub(pe,ge),Ie=e.parse(`e^(-${fe}*${ge})*${ve}`);if(u=t.Calculus.integrate(Ie,ge),u.hasIntegral()){u=e.symfunction("laplace",[ce,pe,fe]);return}u=u.sub(pe,0),u=e.expand(e.multiply(u,new o(-1))),u=u.sub(ge,pe)},!1),u=t.Utils.block("PARSE2NUMBER",()=>e.parse(u),!0),ye&&(t.Settings.integration_depth=$e)}}return e.multiply(u,Ne)},inverse(ce,pe,fe){let u=ce.clone();return t.Utils.block("POSITIVE_MULTIPLIERS",()=>{let Ne;if(ce.group===we&&(ce=t.Algebra.PartFrac.partfrac(e.expand(ce),pe)),ce.group===D||ce.group===we||ce.isComposite()){let _e,xe,ye,$e,ge,ve,Ie,le,i=ce.multiplier.clone();ce.toUnitMultiplier();let a=ce.getNum(),c=ce.getDenom().toUnitMultiplier();c.group===V||c.group===B?(xe=c.power.clone(),c.toLinear()):xe=new t.Frac(1);let S=pe.toString(),w=t.Utils.decompose_fn(c,S,!0),N=t.Utils.decompose_fn(e.expand(a.clone()),S,!0);a.multiplier=a.multiplier.multiply(i);let _=function(){Ne=e.multiply(Ne,a),Ne.multiplier=Ne.multiplier.multiply(ce.multiplier),Ne=e.divide(Ne,w.a)};if((c.group===D||c.group===we)&&w.x.value===S&&w.b.equals(0)&&t.Utils.isInt(w.x.power))_e=w.x.power-1,le=t.Math2.factorial(_e),Ne=e.divide(e.pow(fe,new o(_e)),new o(le)),_();else if(c.group===V&&xe.equals(1)){if(w.x.group===t.groups.PL&&t.Algebra.degree(c).equals(2)){let R=t.Algebra.sqComplete(c,S),U=t.Utils.getU(c);ye=t.Utils.decompose_fn(R.a,S,!0).b;let F=Me.LaPlace.inverse(e.parse(`1/((${U})^2+(${R.c}))`),U,fe);Ne=e.multiply(F,e.parse(`(${i})*e^(-(${ye})*(${fe}))`))}else if(w.x.isLinear()&&!a.contains(S))fe=e.divide(fe,w.a.clone()),_e=xe-1,le=_e===0||_e===1?"1":`(${xe}-1)!`,Ne=e.parse(h("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",fe,w.a,w.b,xe,le)),_();else if(w.x.group===D&&w.x.power.equals(2))if(a.contains(S)){if(ye=new o(1),a.group===we){let he=new o(1);a.each(Ce=>{Ce.contains(S)?he=e.multiply(he,Ce):ye=e.multiply(ye,Ce)}),a=he}Ie=t.Utils.decompose_fn(a,S,!0);let R=Ie.a,U=Ie.b,F=R.containsFunction("sin"),ie=R.containsFunction("cos"),oe=U.containsFunction("cos"),Se=U.containsFunction("sin");if(Ie.x.value===S&&Ie.x.isLinear()&&!(F&&oe||ie||Se))Ne=e.parse(h("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",fe,Ie.a,w.a,w.b));else if(F&&oe){let he=R.findFunction("sin"),Ce=U.findFunction("cos");if(he.args[0].equals(Ce.args[0])&&!he.args[0].contains(S)){$e=e.divide(U,Ce.toUnitMultiplier()).toString();let Ae=he.args[0].toString();ge=w.b;let de=e.divide(R,he.toUnitMultiplier());ve="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",Ne=e.parse(h(ve,fe,ye,$e,Ae,ge,de))}}}else Ne=e.parse(h("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",fe,a,w.a,w.b))}else if(w.x.power.num&&w.x.power.num.equals(3)&&w.x.power.den.equals(2)&&a.contains("sqrt(pi)")&&!a.contains(S)&&a.isLinear())$e=e.divide(a.clone(),e.parse("sqrt(pi)")),Ne=e.parse(h("(2*({2})*sqrt({0}))/({1})",fe,w.a,$e,a));else if(xe.equals(2)&&w.x.power.equals(2))if(a.contains(S))if(Ie=t.Utils.decompose_fn(e.expand(a.clone()),S,!0),Ie.x.isComposite()){let R=[],U=a.collectSymbols(F=>{F=o.unwrapPARENS(F);let ie=t.Utils.decompose_fn(F,S,!0);return ie.symbol=F,ie}).sort((F,ie)=>{let oe=F.x.value===S?F.x.power:0;return(ie.x.value===S?ie.x.power:0)-oe});ye=new o(-1);for(let F=0;F<U.length;F++){let ie=U[F];ie.x.value===S?R.push(ie):ye=e.multiply(ye,ie.symbol)}R[0].x.power.equals(2)&&R[1].x.power.equals(1)&&R[1].b.equals(0)&&!R[0].b.equals(0)&&($e=R[0].a.negate(),ve="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",Ne=e.parse(h(ve,fe,ye,$e,R[0].b,w.a,w.b)))}else Ie.x.isLinear()?(ye=e.divide(Ie.a,new o(2)),ve="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",Ne=e.parse(h(ve,fe,ye,w.a,w.b))):Ie.x.power.equals(2)&&(Ie.b.equals(0)?(ye=e.divide(Ie.a,new o(2)),ve="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ne=e.parse(h(ve,fe,ye,w.a,w.b))):(ye=e.divide(Ie.a,new o(2)),ge=Ie.b.negate(),ve="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ne=e.parse(h(ve,fe,ye,w.a,w.b,ge))));else ye=e.divide(a,new o(2)),ve="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",Ne=e.parse(h(ve,fe,ye,w.a,w.b));else ce.isComposite()&&(xe.equals(2)&&w.x.group===D?Ne=e.parse(`(${i})*(${fe})*e^(-(${w.b})*(${fe}))`):(Ne=new o(0),ce=t.Algebra.PartFrac.partfrac(e.expand(ce),pe),ce.each(R=>{Ne=e.add(Ne,Me.LaPlace.inverse(R,pe,fe))},!0)))}return Ne||=e.symfunction("ilt",[u,pe,fe]),Ne},!0)}},Statistics:{frequencyMap(ce){let pe={};for(let fe=0,u=ce.length;fe<u;fe++){let _e=ce[fe].toString();pe[_e]||=0,pe[_e]++}return pe},sort(ce){return ce.sort((pe,fe)=>((!pe.isConstant()||!fe.isConstant())&&e.error("Unable to sort! All values must be numeric"),pe.multiplier.subtract(fe.multiplier)))},count(ce){return new o(ce.length)},sum(ce,pe){let fe=new o(0);for(let u=0,Ne=ce.length;u<Ne;u++){let _e=ce[u].clone();pe?fe=e.add(e.pow(e.subtract(_e,pe.clone()),new o(2)),fe):fe=e.add(_e,fe)}return fe},mean(...ce){return y(ce[0])?Me.Statistics.mean(...ce[0].elements):e.divide(Me.Statistics.sum(ce),Me.Statistics.count(ce))},median(...ce){let pe;if(y(ce[0]))return Me.Statistics.median(...ce[0].elements);try{let fe=Me.Statistics.sort(ce),u=ce.length;if(t.Utils.even(u)){let Ne=u/2;pe=Me.Statistics.mean(fe[Ne-1],fe[Ne])}else pe=fe[Math.floor(u/2)]}catch(fe){if(fe.message==="timeout")throw fe;pe=e.symfunction("median",ce)}return pe},mode(...ce){let pe;if(y(ce[0]))return Me.Statistics.mode(...ce[0].elements);let fe=Me.Statistics.frequencyMap(ce);if(t.Utils.keys(fe).length===1)pe=ce[0];else{let u={};for(let _e in fe){if(!Object.hasOwn(fe,_e))continue;let xe=fe[_e];if(xe in u){let ye=u[xe];L(ye)?ye.push(_e):u[xe]=[_e,u[xe]]}else u[xe]=_e}let Ne=u[Math.max.apply(null,t.Utils.keys(u))];L(Ne)?pe=e.symfunction("mode",Ne.sort()):pe=e.parse(Ne)}return pe},gVariance(ce,pe){let fe=Me.Statistics.mean(...pe),u=Me.Statistics.sum(pe,fe);return e.multiply(ce,u)},variance(...ce){if(y(ce[0]))return Me.Statistics.variance(...ce[0].elements);let pe=e.divide(new o(1),Me.Statistics.count(ce));return Me.Statistics.gVariance(pe,ce)},sampleVariance(...ce){if(y(ce[0]))return Me.Statistics.sampleVariance(...ce[0].elements);let pe=e.divide(new o(1),e.subtract(Me.Statistics.count(ce),new o(1)));return Me.Statistics.gVariance(pe,ce)},standardDeviation(...ce){return y(ce[0])?Me.Statistics.standardDeviation(...ce[0].elements):e.pow(Me.Statistics.variance(...ce),new o(1/2))},sampleStandardDeviation(...ce){return y(ce[0])?Me.Statistics.sampleStandardDeviation(...ce[0].elements):e.pow(Me.Statistics.sampleVariance(...ce),new o(1/2))},zScore(ce,pe,fe){return e.divide(e.subtract(ce,pe),fe)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};L0.register([{name:"laplace",visible:!0,numargs:3,build(){return Me.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Me.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Me.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Me.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Me.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Me.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Me.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Me.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Me.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Me.Statistics.zScore}}]),L0.updateAPI()})();typeof on<"u"&&(on.exports=L0)});var ji=f0((t2,h1)=>{var Hi=T0();X0();V0();f1();p1();h1.exports=Hi});return ji();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
