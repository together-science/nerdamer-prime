"use strict";var nerdamer=(()=>{var c0=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var On=c0((Hi,k0)=>{var kt=(function(n){"use strict";var t=1e7,e=7,u=9007199254740992,w=Ee(u),_="0123456789abcdefghijklmnopqrstuvwxyz",R=typeof BigInt=="function";function L(a,c,A,x){return typeof a>"u"?L[0]:typeof c<"u"?+c==10&&!A?T(a):Ae(a,c,A,x):T(a)}function X(a,c){this.value=a,this.sign=c,this.isSmall=!1}X.prototype=Object.create(L.prototype);function z(a){this.value=a,this.sign=a<0,this.isSmall=!0}z.prototype=Object.create(L.prototype);function Z(a){this.value=a}Z.prototype=Object.create(L.prototype);function j(a){return-u<a&&a<u}function Ee(a){return a<1e7?[a]:a<1e14?[a%1e7,Math.floor(a/1e7)]:[a%1e7,Math.floor(a/1e7)%1e7,Math.floor(a/1e14)]}function Ne(a){Re(a);var c=a.length;if(c<4&&F(a,w)<0)switch(c){case 0:return 0;case 1:return a[0];case 2:return a[0]+a[1]*t;default:return a[0]+(a[1]+a[2]*t)*t}return a}function Re(a){for(var c=a.length;a[--c]===0;);a.length=c+1}function ie(a){for(var c=new Array(a),A=-1;++A<a;)c[A]=0;return c}function fe(a){return a>0?Math.floor(a):Math.ceil(a)}function g(a,c){var A=a.length,x=c.length,b=new Array(A),Q=0,J=t,G,D;for(D=0;D<x;D++)G=a[D]+c[D]+Q,Q=G>=J?1:0,b[D]=G-Q*J;for(;D<A;)G=a[D]+Q,Q=G===J?1:0,b[D++]=G-Q*J;return Q>0&&b.push(Q),b}function H(a,c){return a.length>=c.length?g(a,c):g(c,a)}function de(a,c){var A=a.length,x=new Array(A),b=t,Q,J;for(J=0;J<A;J++)Q=a[J]-b+c,c=Math.floor(Q/b),x[J]=Q-c*b,c+=1;for(;c>0;)x[J++]=c%b,c=Math.floor(c/b);return x}X.prototype.add=function(a){var c=T(a);if(this.sign!==c.sign)return this.subtract(c.negate());var A=this.value,x=c.value;return c.isSmall?new X(de(A,Math.abs(x)),this.sign):new X(H(A,x),this.sign)},X.prototype.plus=X.prototype.add,z.prototype.add=function(a){var c=T(a),A=this.value;if(A<0!==c.sign)return this.subtract(c.negate());var x=c.value;if(c.isSmall){if(j(A+x))return new z(A+x);x=Ee(Math.abs(x))}return new X(de(x,Math.abs(A)),A<0)},z.prototype.plus=z.prototype.add,Z.prototype.add=function(a){return new Z(this.value+T(a).value)},Z.prototype.plus=Z.prototype.add;function Oe(a,c){var A=a.length,x=c.length,b=new Array(A),Q=0,J=t,G,D;for(G=0;G<x;G++)D=a[G]-Q-c[G],D<0?(D+=J,Q=1):Q=0,b[G]=D;for(G=x;G<A;G++){if(D=a[G]-Q,D<0)D+=J;else{b[G++]=D;break}b[G]=D}for(;G<A;G++)b[G]=a[G];return Re(b),b}function ve(a,c,A){var x;return F(a,c)>=0?x=Oe(a,c):(x=Oe(c,a),A=!A),x=Ne(x),typeof x=="number"?(A&&(x=-x),new z(x)):new X(x,A)}function we(a,c,A){var x=a.length,b=new Array(x),Q=-c,J=t,G,D;for(G=0;G<x;G++)D=a[G]+Q,Q=Math.floor(D/J),D%=J,b[G]=D<0?D+J:D;return b=Ne(b),typeof b=="number"?(A&&(b=-b),new z(b)):new X(b,A)}X.prototype.subtract=function(a){var c=T(a);if(this.sign!==c.sign)return this.add(c.negate());var A=this.value,x=c.value;return c.isSmall?we(A,Math.abs(x),this.sign):ve(A,x,this.sign)},X.prototype.minus=X.prototype.subtract,z.prototype.subtract=function(a){var c=T(a),A=this.value;if(A<0!==c.sign)return this.add(c.negate());var x=c.value;return c.isSmall?new z(A-x):we(x,Math.abs(A),A>=0)},z.prototype.minus=z.prototype.subtract,Z.prototype.subtract=function(a){return new Z(this.value-T(a).value)},Z.prototype.minus=Z.prototype.subtract,X.prototype.negate=function(){return new X(this.value,!this.sign)},z.prototype.negate=function(){var a=this.sign,c=new z(-this.value);return c.sign=!a,c},Z.prototype.negate=function(){return new Z(-this.value)},X.prototype.abs=function(){return new X(this.value,!1)},z.prototype.abs=function(){return new z(Math.abs(this.value))},Z.prototype.abs=function(){return new Z(this.value>=0?this.value:-this.value)};function qe(a,c){var A=a.length,x=c.length,b=A+x,Q=ie(b),J=t,G,D,ne,pe,Ce;for(ne=0;ne<A;++ne){pe=a[ne];for(var Te=0;Te<x;++Te)Ce=c[Te],G=pe*Ce+Q[ne+Te],D=Math.floor(G/J),Q[ne+Te]=G-D*J,Q[ne+Te+1]+=D}return Re(Q),Q}function Se(a,c){var A=a.length,x=new Array(A),b=t,Q=0,J,G;for(G=0;G<A;G++)J=a[G]*c+Q,Q=Math.floor(J/b),x[G]=J-Q*b;for(;Q>0;)x[G++]=Q%b,Q=Math.floor(Q/b);return x}function K(a,c){for(var A=[];c-- >0;)A.push(0);return A.concat(a)}function l(a,c){var A=Math.max(a.length,c.length);if(A<=30)return qe(a,c);A=Math.ceil(A/2);var x=a.slice(A),b=a.slice(0,A),Q=c.slice(A),J=c.slice(0,A),G=l(b,J),D=l(x,Q),ne=l(H(b,x),H(J,Q)),pe=H(H(G,K(Oe(Oe(ne,G),D),A)),K(D,2*A));return Re(pe),pe}function p(a,c){return-.012*a-.012*c+15e-6*a*c>0}X.prototype.multiply=function(a){var c=T(a),A=this.value,x=c.value,b=this.sign!==c.sign,Q;if(c.isSmall){if(x===0)return L[0];if(x===1)return this;if(x===-1)return this.negate();if(Q=Math.abs(x),Q<t)return new X(Se(A,Q),b);x=Ee(Q)}return p(A.length,x.length)?new X(l(A,x),b):new X(qe(A,x),b)},X.prototype.times=X.prototype.multiply;function o(a,c,A){return a<t?new X(Se(c,a),A):new X(qe(c,Ee(a)),A)}z.prototype._multiplyBySmall=function(a){return j(a.value*this.value)?new z(a.value*this.value):o(Math.abs(a.value),Ee(Math.abs(this.value)),this.sign!==a.sign)},X.prototype._multiplyBySmall=function(a){return a.value===0?L[0]:a.value===1?this:a.value===-1?this.negate():o(Math.abs(a.value),this.value,this.sign!==a.sign)},z.prototype.multiply=function(a){return T(a)._multiplyBySmall(this)},z.prototype.times=z.prototype.multiply,Z.prototype.multiply=function(a){return new Z(this.value*T(a).value)},Z.prototype.times=Z.prototype.multiply;function f(a){var c=a.length,A=ie(c+c),x=t,b,Q,J,G,D;for(J=0;J<c;J++){G=a[J],Q=0-G*G;for(var ne=J;ne<c;ne++)D=a[ne],b=2*(G*D)+A[J+ne]+Q,Q=Math.floor(b/x),A[J+ne]=b-Q*x;A[J+c]=Q}return Re(A),A}X.prototype.square=function(){return new X(f(this.value),!1)},z.prototype.square=function(){var a=this.value*this.value;return j(a)?new z(a):new X(f(Ee(Math.abs(this.value))),!1)},Z.prototype.square=function(a){return new Z(this.value*this.value)};function m(a,c){var A=a.length,x=c.length,b=t,Q=ie(c.length),J=c[x-1],G=Math.ceil(b/(2*J)),D=Se(a,G),ne=Se(c,G),pe,Ce,Te,Fe,xe,He,je;for(D.length<=A&&D.push(0),ne.push(0),J=ne[x-1],Ce=A-x;Ce>=0;Ce--){for(pe=b-1,D[Ce+x]!==J&&(pe=Math.floor((D[Ce+x]*b+D[Ce+x-1])/J)),Te=0,Fe=0,He=ne.length,xe=0;xe<He;xe++)Te+=pe*ne[xe],je=Math.floor(Te/b),Fe+=D[Ce+xe]-(Te-je*b),Te=je,Fe<0?(D[Ce+xe]=Fe+b,Fe=-1):(D[Ce+xe]=Fe,Fe=0);for(;Fe!==0;){for(pe-=1,Te=0,xe=0;xe<He;xe++)Te+=D[Ce+xe]-b+ne[xe],Te<0?(D[Ce+xe]=Te+b,Te=0):(D[Ce+xe]=Te,Te=1);Fe+=Te}Q[Ce]=pe}return D=M(D,G)[0],[Ne(Q),Ne(D)]}function S(a,c){for(var A=a.length,x=c.length,b=[],Q=[],J=t,G,D,ne,pe,Ce;A;){if(Q.unshift(a[--A]),Re(Q),F(Q,c)<0){b.push(0);continue}D=Q.length,ne=Q[D-1]*J+Q[D-2],pe=c[x-1]*J+c[x-2],D>x&&(ne=(ne+1)*J),G=Math.ceil(ne/pe);do{if(Ce=Se(c,G),F(Ce,Q)<=0)break;G--}while(G);b.push(G),Q=Oe(Q,Ce)}return b.reverse(),[Ne(b),Ne(Q)]}function M(a,c){var A=a.length,x=ie(A),b=t,Q,J,G,D;for(G=0,Q=A-1;Q>=0;--Q)D=G*b+a[Q],J=fe(D/c),G=D-J*c,x[Q]=J|0;return[x,G|0]}function V(a,c){var A,x=T(c);if(R)return[new Z(a.value/x.value),new Z(a.value%x.value)];var b=a.value,Q=x.value,J;if(Q===0)throw new Error("Cannot divide by zero");if(a.isSmall)return x.isSmall?[new z(fe(b/Q)),new z(b%Q)]:[L[0],a];if(x.isSmall){if(Q===1)return[a,L[0]];if(Q==-1)return[a.negate(),L[0]];var G=Math.abs(Q);if(G<t){A=M(b,G),J=Ne(A[0]);var D=A[1];return a.sign&&(D=-D),typeof J=="number"?(a.sign!==x.sign&&(J=-J),[new z(J),new z(D)]):[new X(J,a.sign!==x.sign),new z(D)]}Q=Ee(G)}var ne=F(b,Q);if(ne===-1)return[L[0],a];if(ne===0)return[L[a.sign===x.sign?1:-1],L[0]];b.length+Q.length<=200?A=m(b,Q):A=S(b,Q),J=A[0];var pe=a.sign!==x.sign,Ce=A[1],Te=a.sign;return typeof J=="number"?(pe&&(J=-J),J=new z(J)):J=new X(J,pe),typeof Ce=="number"?(Te&&(Ce=-Ce),Ce=new z(Ce)):Ce=new X(Ce,Te),[J,Ce]}X.prototype.divmod=function(a){var c=V(this,a);return{quotient:c[0],remainder:c[1]}},Z.prototype.divmod=z.prototype.divmod=X.prototype.divmod,X.prototype.divide=function(a){return V(this,a)[0]},Z.prototype.over=Z.prototype.divide=function(a){return new Z(this.value/T(a).value)},z.prototype.over=z.prototype.divide=X.prototype.over=X.prototype.divide,X.prototype.mod=function(a){return V(this,a)[1]},Z.prototype.mod=Z.prototype.remainder=function(a){return new Z(this.value%T(a).value)},z.prototype.remainder=z.prototype.mod=X.prototype.remainder=X.prototype.mod,X.prototype.pow=function(a){var c=T(a),A=this.value,x=c.value,b,Q,J;if(x===0)return L[1];if(A===0)return L[0];if(A===1)return L[1];if(A===-1)return c.isEven()?L[1]:L[-1];if(c.sign)return L[0];if(!c.isSmall)throw new Error("The exponent "+c.toString()+" is too large.");if(this.isSmall&&j(b=Math.pow(A,x)))return new z(fe(b));for(Q=this,J=L[1];x&!0&&(J=J.times(Q),--x),x!==0;)x/=2,Q=Q.square();return J},z.prototype.pow=X.prototype.pow,Z.prototype.pow=function(a){var c=T(a),A=this.value,x=c.value,b=BigInt(0),Q=BigInt(1),J=BigInt(2);if(x===b)return L[1];if(A===b)return L[0];if(A===Q)return L[1];if(A===BigInt(-1))return c.isEven()?L[1]:L[-1];if(c.isNegative())return new Z(b);for(var G=this,D=L[1];(x&Q)===Q&&(D=D.times(G),--x),x!==b;)x/=J,G=G.square();return D},X.prototype.modPow=function(a,c){if(a=T(a),c=T(c),c.isZero())throw new Error("Cannot take modPow with modulus 0");var A=L[1],x=this.mod(c);for(a.isNegative()&&(a=a.multiply(L[-1]),x=x.modInv(c));a.isPositive();){if(x.isZero())return L[0];a.isOdd()&&(A=A.multiply(x).mod(c)),a=a.divide(2),x=x.square().mod(c)}return A},Z.prototype.modPow=z.prototype.modPow=X.prototype.modPow;function F(a,c){if(a.length!==c.length)return a.length>c.length?1:-1;for(var A=a.length-1;A>=0;A--)if(a[A]!==c[A])return a[A]>c[A]?1:-1;return 0}X.prototype.compareAbs=function(a){var c=T(a),A=this.value,x=c.value;return c.isSmall?1:F(A,x)},z.prototype.compareAbs=function(a){var c=T(a),A=Math.abs(this.value),x=c.value;return c.isSmall?(x=Math.abs(x),A===x?0:A>x?1:-1):-1},Z.prototype.compareAbs=function(a){var c=this.value,A=T(a).value;return c=c>=0?c:-c,A=A>=0?A:-A,c===A?0:c>A?1:-1},X.prototype.compare=function(a){if(a===1/0)return-1;if(a===-1/0)return 1;var c=T(a),A=this.value,x=c.value;return this.sign!==c.sign?c.sign?1:-1:c.isSmall?this.sign?-1:1:F(A,x)*(this.sign?-1:1)},X.prototype.compareTo=X.prototype.compare,z.prototype.compare=function(a){if(a===1/0)return-1;if(a===-1/0)return 1;var c=T(a),A=this.value,x=c.value;return c.isSmall?A==x?0:A>x?1:-1:A<0!==c.sign?A<0?-1:1:A<0?1:-1},z.prototype.compareTo=z.prototype.compare,Z.prototype.compare=function(a){if(a===1/0)return-1;if(a===-1/0)return 1;var c=this.value,A=T(a).value;return c===A?0:c>A?1:-1},Z.prototype.compareTo=Z.prototype.compare,X.prototype.equals=function(a){return this.compare(a)===0},Z.prototype.eq=Z.prototype.equals=z.prototype.eq=z.prototype.equals=X.prototype.eq=X.prototype.equals,X.prototype.notEquals=function(a){return this.compare(a)!==0},Z.prototype.neq=Z.prototype.notEquals=z.prototype.neq=z.prototype.notEquals=X.prototype.neq=X.prototype.notEquals,X.prototype.greater=function(a){return this.compare(a)>0},Z.prototype.gt=Z.prototype.greater=z.prototype.gt=z.prototype.greater=X.prototype.gt=X.prototype.greater,X.prototype.lesser=function(a){return this.compare(a)<0},Z.prototype.lt=Z.prototype.lesser=z.prototype.lt=z.prototype.lesser=X.prototype.lt=X.prototype.lesser,X.prototype.greaterOrEquals=function(a){return this.compare(a)>=0},Z.prototype.geq=Z.prototype.greaterOrEquals=z.prototype.geq=z.prototype.greaterOrEquals=X.prototype.geq=X.prototype.greaterOrEquals,X.prototype.lesserOrEquals=function(a){return this.compare(a)<=0},Z.prototype.leq=Z.prototype.lesserOrEquals=z.prototype.leq=z.prototype.lesserOrEquals=X.prototype.leq=X.prototype.lesserOrEquals,X.prototype.isEven=function(){return(this.value[0]&1)===0},z.prototype.isEven=function(){return(this.value&1)===0},Z.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},X.prototype.isOdd=function(){return(this.value[0]&1)===1},z.prototype.isOdd=function(){return(this.value&1)===1},Z.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},X.prototype.isPositive=function(){return!this.sign},z.prototype.isPositive=function(){return this.value>0},Z.prototype.isPositive=z.prototype.isPositive,X.prototype.isNegative=function(){return this.sign},z.prototype.isNegative=function(){return this.value<0},Z.prototype.isNegative=z.prototype.isNegative,X.prototype.isUnit=function(){return!1},z.prototype.isUnit=function(){return Math.abs(this.value)===1},Z.prototype.isUnit=function(){return this.abs().value===BigInt(1)},X.prototype.isZero=function(){return!1},z.prototype.isZero=function(){return this.value===0},Z.prototype.isZero=function(){return this.value===BigInt(0)},X.prototype.isDivisibleBy=function(a){var c=T(a);return c.isZero()?!1:c.isUnit()?!0:c.compareAbs(2)===0?this.isEven():this.mod(c).isZero()},Z.prototype.isDivisibleBy=z.prototype.isDivisibleBy=X.prototype.isDivisibleBy;function I(a){var c=a.abs();if(c.isUnit())return!1;if(c.equals(2)||c.equals(3)||c.equals(5))return!0;if(c.isEven()||c.isDivisibleBy(3)||c.isDivisibleBy(5))return!1;if(c.lesser(49))return!0}function k(a,c){for(var A=a.prev(),x=A,b=0,Q,J,G,D;x.isEven();)x=x.divide(2),b++;e:for(G=0;G<c.length;G++)if(!a.lesser(c[G])&&(D=kt(c[G]).modPow(x,a),!(D.isUnit()||D.equals(A)))){for(Q=b-1;Q!=0;Q--){if(D=D.square().mod(a),D.isUnit())return!1;if(D.equals(A))continue e}return!1}return!0}X.prototype.isPrime=function(a){var c=I(this);if(c!==n)return c;var A=this.abs(),x=A.bitLength();if(x<=64)return k(A,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var b=Math.log(2)*x.toJSNumber(),Q=Math.ceil(a===!0?2*Math.pow(b,2):b),J=[],G=0;G<Q;G++)J.push(kt(G+2));return k(A,J)},Z.prototype.isPrime=z.prototype.isPrime=X.prototype.isPrime,X.prototype.isProbablePrime=function(a,c){var A=I(this);if(A!==n)return A;for(var x=this.abs(),b=a===n?5:a,Q=[],J=0;J<b;J++)Q.push(kt.randBetween(2,x.minus(2),c));return k(x,Q)},Z.prototype.isProbablePrime=z.prototype.isProbablePrime=X.prototype.isProbablePrime,X.prototype.modInv=function(a){for(var c=kt.zero,A=kt.one,x=T(a),b=this.abs(),Q,J,G;!b.isZero();)Q=x.divide(b),J=c,G=x,c=A,x=b,A=J.subtract(Q.multiply(A)),b=G.subtract(Q.multiply(b));if(!x.isUnit())throw new Error(this.toString()+" and "+a.toString()+" are not co-prime");return c.compare(0)===-1&&(c=c.add(a)),this.isNegative()?c.negate():c},Z.prototype.modInv=z.prototype.modInv=X.prototype.modInv,X.prototype.next=function(){var a=this.value;return this.sign?we(a,1,this.sign):new X(de(a,1),this.sign)},z.prototype.next=function(){var a=this.value;return a+1<u?new z(a+1):new X(w,!1)},Z.prototype.next=function(){return new Z(this.value+BigInt(1))},X.prototype.prev=function(){var a=this.value;return this.sign?new X(de(a,1),!0):we(a,1,this.sign)},z.prototype.prev=function(){var a=this.value;return a-1>-u?new z(a-1):new X(w,!0)},Z.prototype.prev=function(){return new Z(this.value-BigInt(1))};for(var se=[1];2*se[se.length-1]<=t;)se.push(2*se[se.length-1]);var ae=se.length,ce=se[ae-1];function Me(a){return Math.abs(a)<=t}X.prototype.shiftLeft=function(a){var c=T(a).toJSNumber();if(!Me(c))throw new Error(String(c)+" is too large for shifting.");if(c<0)return this.shiftRight(-c);var A=this;if(A.isZero())return A;for(;c>=ae;)A=A.multiply(ce),c-=ae-1;return A.multiply(se[c])},Z.prototype.shiftLeft=z.prototype.shiftLeft=X.prototype.shiftLeft,X.prototype.shiftRight=function(a){var c,A=T(a).toJSNumber();if(!Me(A))throw new Error(String(A)+" is too large for shifting.");if(A<0)return this.shiftLeft(-A);for(var x=this;A>=ae;){if(x.isZero()||x.isNegative()&&x.isUnit())return x;c=V(x,ce),x=c[1].isNegative()?c[0].prev():c[0],A-=ae-1}return c=V(x,se[A]),c[1].isNegative()?c[0].prev():c[0]},Z.prototype.shiftRight=z.prototype.shiftRight=X.prototype.shiftRight;function me(a,c,A){c=T(c);for(var x=a.isNegative(),b=c.isNegative(),Q=x?a.not():a,J=b?c.not():c,G=0,D=0,ne=null,pe=null,Ce=[];!Q.isZero()||!J.isZero();)ne=V(Q,ce),G=ne[1].toJSNumber(),x&&(G=ce-1-G),pe=V(J,ce),D=pe[1].toJSNumber(),b&&(D=ce-1-D),Q=ne[0],J=pe[0],Ce.push(A(G,D));for(var Te=A(x?1:0,b?1:0)!==0?kt(-1):kt(0),Fe=Ce.length-1;Fe>=0;Fe-=1)Te=Te.multiply(ce).add(kt(Ce[Fe]));return Te}X.prototype.not=function(){return this.negate().prev()},Z.prototype.not=z.prototype.not=X.prototype.not,X.prototype.and=function(a){return me(this,a,function(c,A){return c&A})},Z.prototype.and=z.prototype.and=X.prototype.and,X.prototype.or=function(a){return me(this,a,function(c,A){return c|A})},Z.prototype.or=z.prototype.or=X.prototype.or,X.prototype.xor=function(a){return me(this,a,function(c,A){return c^A})},Z.prototype.xor=z.prototype.xor=X.prototype.xor;var $e=1<<30,Xe=(t&-t)*(t&-t)|$e;function ye(a){var c=a.value,A=typeof c=="number"?c|$e:typeof c=="bigint"?c|BigInt($e):c[0]+c[1]*t|Xe;return A&-A}function De(a,c){if(c.compareTo(a)<=0){var A=De(a,c.square(c)),x=A.p,b=A.e,Q=x.multiply(c);return Q.compareTo(a)<=0?{p:Q,e:b*2+1}:{p:x,e:b*2}}return{p:kt(1),e:0}}X.prototype.bitLength=function(){var a=this;return a.compareTo(kt(0))<0&&(a=a.negate().subtract(kt(1))),a.compareTo(kt(0))===0?kt(0):kt(De(a,kt(2)).e).add(kt(1))},Z.prototype.bitLength=z.prototype.bitLength=X.prototype.bitLength;function Be(a,c){return a=T(a),c=T(c),a.greater(c)?a:c}function We(a,c){return a=T(a),c=T(c),a.lesser(c)?a:c}function Le(a,c){if(a=T(a).abs(),c=T(c).abs(),a.equals(c))return a;if(a.isZero())return c;if(c.isZero())return a;for(var A=L[1],x,b;a.isEven()&&c.isEven();)x=We(ye(a),ye(c)),a=a.divide(x),c=c.divide(x),A=A.multiply(x);for(;a.isEven();)a=a.divide(ye(a));do{for(;c.isEven();)c=c.divide(ye(c));a.greater(c)&&(b=c,c=a,a=b),c=c.subtract(a)}while(!c.isZero());return A.isUnit()?a:a.multiply(A)}function Ve(a,c){return a=T(a).abs(),c=T(c).abs(),a.divide(Le(a,c)).multiply(c)}function Qe(a,c,A){a=T(a),c=T(c);var x=A||Math.random,b=We(a,c),Q=Be(a,c),J=Q.subtract(b).add(1);if(J.isSmall)return b.add(Math.floor(x()*J));for(var G=Y(J,t).value,D=[],ne=!0,pe=0;pe<G.length;pe++){var Ce=ne?G[pe]+(pe+1<G.length?G[pe+1]/t:0):t,Te=fe(x()*Ce);D.push(Te),Te<G[pe]&&(ne=!1)}return b.add(L.fromArray(D,t,!1))}var Ae=function(a,c,A,x){A=A||_,a=String(a),x||(a=a.toLowerCase(),A=A.toLowerCase());var b=a.length,Q,J=Math.abs(c),G={};for(Q=0;Q<A.length;Q++)G[A[Q]]=Q;for(Q=0;Q<b;Q++){var D=a[Q];if(D!=="-"&&D in G&&G[D]>=J){if(D==="1"&&J===1)continue;throw new Error(D+" is not a valid digit in base "+c+".")}}c=T(c);var ne=[],pe=a[0]==="-";for(Q=pe?1:0;Q<a.length;Q++){var D=a[Q];if(D in G)ne.push(T(G[D]));else if(D==="<"){var Ce=Q;do Q++;while(a[Q]!==">"&&Q<a.length);ne.push(T(a.slice(Ce+1,Q)))}else throw new Error(D+" is not a valid character")}return $(ne,c,pe)};function $(a,c,A){var x=L[0],b=L[1],Q;for(Q=a.length-1;Q>=0;Q--)x=x.add(a[Q].times(b)),b=b.times(c);return A?x.negate():x}function W(a,c){return c=c||_,a<c.length?c[a]:"<"+a+">"}function Y(a,c){if(c=kt(c),c.isZero()){if(a.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(c.equals(-1)){if(a.isZero())return{value:[0],isNegative:!1};if(a.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-a.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var A=Array.apply(null,Array(a.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return A.unshift([1]),{value:[].concat.apply([],A),isNegative:!1}}var x=!1;if(a.isNegative()&&c.isPositive()&&(x=!0,a=a.abs()),c.isUnit())return a.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(a.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:x};for(var b=[],Q=a,J;Q.isNegative()||Q.compareAbs(c)>=0;){J=Q.divmod(c),Q=J.quotient;var G=J.remainder;G.isNegative()&&(G=c.minus(G).abs(),Q=Q.next()),b.push(G.toJSNumber())}return b.push(Q.toJSNumber()),{value:b.reverse(),isNegative:x}}function q(a,c,A){var x=Y(a,c);return(x.isNegative?"-":"")+x.value.map(function(b){return W(b,A)}).join("")}X.prototype.toArray=function(a){return Y(this,a)},z.prototype.toArray=function(a){return Y(this,a)},Z.prototype.toArray=function(a){return Y(this,a)},X.prototype.toString=function(a,c){if(a===n&&(a=10),a!==10||c)return q(this,a,c);for(var A=this.value,x=A.length,b=String(A[--x]),Q="0000000",J;--x>=0;)J=String(A[x]),b+=Q.slice(J.length)+J;var G=this.sign?"-":"";return G+b},z.prototype.toString=function(a,c){return a===n&&(a=10),a!=10||c?q(this,a,c):String(this.value)},Z.prototype.toString=z.prototype.toString,Z.prototype.toJSON=X.prototype.toJSON=z.prototype.toJSON=function(){return this.toString()},X.prototype.valueOf=function(){return parseInt(this.toString(),10)},X.prototype.toJSNumber=X.prototype.valueOf,z.prototype.valueOf=function(){return this.value},z.prototype.toJSNumber=z.prototype.valueOf,Z.prototype.valueOf=Z.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function ee(a){if(j(+a)){var c=+a;if(c===fe(c))return R?new Z(BigInt(c)):new z(c);throw new Error("Invalid integer: "+a)}var A=a[0]==="-";A&&(a=a.slice(1));var x=a.split(/e/i);if(x.length>2)throw new Error("Invalid integer: "+x.join("e"));if(x.length===2){var b=x[1];if(b[0]==="+"&&(b=b.slice(1)),b=+b,b!==fe(b)||!j(b))throw new Error("Invalid integer: "+b+" is not a valid exponent.");var Q=x[0],J=Q.indexOf(".");if(J>=0&&(b-=Q.length-J-1,Q=Q.slice(0,J)+Q.slice(J+1)),b<0)throw new Error("Cannot include negative exponent part for integers");Q+=new Array(b+1).join("0"),a=Q}var G=/^([0-9][0-9]*)$/.test(a);if(!G)throw new Error("Invalid integer: "+a);if(R)return new Z(BigInt(A?"-"+a:a));for(var D=[],ne=a.length,pe=e,Ce=ne-pe;ne>0;)D.push(+a.slice(Ce,ne)),Ce-=pe,Ce<0&&(Ce=0),ne-=pe;return Re(D),new X(D,A)}function B(a){if(R)return new Z(BigInt(a));if(j(a)){if(a!==fe(a))throw new Error(a+" is not an integer.");return new z(a)}return ee(a.toString())}function T(a){return typeof a=="number"?B(a):typeof a=="string"?ee(a):typeof a=="bigint"?new Z(a):a}for(var ge=0;ge<1e3;ge++)L[ge]=T(ge),ge>0&&(L[-ge]=T(-ge));return L.one=L[1],L.zero=L[0],L.minusOne=L[-1],L.max=Be,L.min=We,L.gcd=Le,L.lcm=Ve,L.isInstance=function(a){return a instanceof X||a instanceof z||a instanceof Z},L.randBetween=Qe,L.fromArray=function(a,c,A){return $(a.map(T),T(c||10),A)},L})();typeof k0<"u"&&k0.hasOwnProperty("exports")&&(k0.exports=kt);typeof define=="function"&&define.amd&&define(function(){return kt})});var Tn=c0((qn,B0)=>{(function(n){"use strict";var t=9e15,e=1e9,u="0123456789abcdef",w="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",_="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",R={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-t,maxE:t,crypto:!1},L,X,z,Z,j=!0,Ee="[DecimalError] ",Ne=Ee+"Invalid argument: ",Re=Ee+"Precision limit exceeded",ie=Ee+"crypto unavailable",fe="[object Decimal]",g=Math.floor,H=Math.pow,de=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Oe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,ve=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,we=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qe=1e7,Se=7,K=9007199254740991,l=w.length-1,p=_.length-1,o={toStringTag:fe};o.absoluteValue=o.abs=function(){var h=new this.constructor(this);return h.s<0&&(h.s=1),I(h)},o.ceil=function(){return I(new this.constructor(this),this.e+1,2)},o.clampedTo=o.clamp=function(h,N){var E,y=this,r=y.constructor;if(h=new r(h),N=new r(N),!h.s||!N.s)return new r(NaN);if(h.gt(N))throw Error(Ne+N);return E=y.cmp(h),E<0?h:y.cmp(N)>0?N:new r(y)},o.comparedTo=o.cmp=function(h){var N,E,y,r,i=this,s=i.d,d=(h=new i.constructor(h)).d,v=i.s,C=h.s;if(!s||!d)return!v||!C?NaN:v!==C?v:s===d?0:!s^v<0?1:-1;if(!s[0]||!d[0])return s[0]?v:d[0]?-C:0;if(v!==C)return v;if(i.e!==h.e)return i.e>h.e^v<0?1:-1;for(y=s.length,r=d.length,N=0,E=y<r?y:r;N<E;++N)if(s[N]!==d[N])return s[N]>d[N]^v<0?1:-1;return y===r?0:y>r^v<0?1:-1},o.cosine=o.cos=function(){var h,N,E=this,y=E.constructor;return E.d?E.d[0]?(h=y.precision,N=y.rounding,y.precision=h+Math.max(E.e,E.sd())+Se,y.rounding=1,E=V(y,W(y,E)),y.precision=h,y.rounding=N,I(Z==2||Z==3?E.neg():E,h,N,!0)):new y(1):new y(NaN)},o.cubeRoot=o.cbrt=function(){var h,N,E,y,r,i,s,d,v,C,O=this,U=O.constructor;if(!O.isFinite()||O.isZero())return new U(O);for(j=!1,i=O.s*H(O.s*O,1/3),!i||Math.abs(i)==1/0?(E=f(O.d),h=O.e,(i=(h-E.length+1)%3)&&(E+=i==1||i==-2?"0":"00"),i=H(E,1/3),h=g((h+1)/3)-(h%3==(h<0?-1:2)),i==1/0?E="5e"+h:(E=i.toExponential(),E=E.slice(0,E.indexOf("e")+1)+h),y=new U(E),y.s=O.s):y=new U(i.toString()),s=(h=U.precision)+3;;)if(d=y,v=d.times(d).times(d),C=v.plus(O),y=F(C.plus(O).times(d),C.plus(v),s+2,1),f(d.d).slice(0,s)===(E=f(y.d)).slice(0,s))if(E=E.slice(s-3,s+1),E=="9999"||!r&&E=="4999"){if(!r&&(I(d,h+1,0),d.times(d).times(d).eq(O))){y=d;break}s+=4,r=1}else{(!+E||!+E.slice(1)&&E.charAt(0)=="5")&&(I(y,h+1,1),N=!y.times(y).times(y).eq(O));break}return j=!0,I(y,h,U.rounding,N)},o.decimalPlaces=o.dp=function(){var h,N=this.d,E=NaN;if(N){if(h=N.length-1,E=(h-g(this.e/Se))*Se,h=N[h],h)for(;h%10==0;h/=10)E--;E<0&&(E=0)}return E},o.dividedBy=o.div=function(h){return F(this,new this.constructor(h))},o.dividedToIntegerBy=o.divToInt=function(h){var N=this,E=N.constructor;return I(F(N,new E(h),0,1,1),E.precision,E.rounding)},o.equals=o.eq=function(h){return this.cmp(h)===0},o.floor=function(){return I(new this.constructor(this),this.e+1,3)},o.greaterThan=o.gt=function(h){return this.cmp(h)>0},o.greaterThanOrEqualTo=o.gte=function(h){var N=this.cmp(h);return N==1||N===0},o.hyperbolicCosine=o.cosh=function(){var h,N,E,y,r,i=this,s=i.constructor,d=new s(1);if(!i.isFinite())return new s(i.s?1/0:NaN);if(i.isZero())return d;E=s.precision,y=s.rounding,s.precision=E+Math.max(i.e,i.sd())+4,s.rounding=1,r=i.d.length,r<32?(h=Math.ceil(r/3),N=(1/$(4,h)).toString()):(h=16,N="2.3283064365386962890625e-10"),i=Ae(s,1,i.times(N),new s(1),!0);for(var v,C=h,O=new s(8);C--;)v=i.times(i),i=d.minus(v.times(O.minus(v.times(O))));return I(i,s.precision=E,s.rounding=y,!0)},o.hyperbolicSine=o.sinh=function(){var h,N,E,y,r=this,i=r.constructor;if(!r.isFinite()||r.isZero())return new i(r);if(N=i.precision,E=i.rounding,i.precision=N+Math.max(r.e,r.sd())+4,i.rounding=1,y=r.d.length,y<3)r=Ae(i,2,r,r,!0);else{h=1.4*Math.sqrt(y),h=h>16?16:h|0,r=r.times(1/$(5,h)),r=Ae(i,2,r,r,!0);for(var s,d=new i(5),v=new i(16),C=new i(20);h--;)s=r.times(r),r=r.times(d.plus(s.times(v.times(s).plus(C))))}return i.precision=N,i.rounding=E,I(r,N,E,!0)},o.hyperbolicTangent=o.tanh=function(){var h,N,E=this,y=E.constructor;return E.isFinite()?E.isZero()?new y(E):(h=y.precision,N=y.rounding,y.precision=h+7,y.rounding=1,F(E.sinh(),E.cosh(),y.precision=h,y.rounding=N)):new y(E.s)},o.inverseCosine=o.acos=function(){var h=this,N=h.constructor,E=h.abs().cmp(1),y=N.precision,r=N.rounding;return E!==-1?E===0?h.isNeg()?ce(N,y,r):new N(0):new N(NaN):h.isZero()?ce(N,y+4,r).times(.5):(N.precision=y+6,N.rounding=1,h=new N(1).minus(h).div(h.plus(1)).sqrt().atan(),N.precision=y,N.rounding=r,h.times(2))},o.inverseHyperbolicCosine=o.acosh=function(){var h,N,E=this,y=E.constructor;return E.lte(1)?new y(E.eq(1)?0:NaN):E.isFinite()?(h=y.precision,N=y.rounding,y.precision=h+Math.max(Math.abs(E.e),E.sd())+4,y.rounding=1,j=!1,E=E.times(E).minus(1).sqrt().plus(E),j=!0,y.precision=h,y.rounding=N,E.ln()):new y(E)},o.inverseHyperbolicSine=o.asinh=function(){var h,N,E=this,y=E.constructor;return!E.isFinite()||E.isZero()?new y(E):(h=y.precision,N=y.rounding,y.precision=h+2*Math.max(Math.abs(E.e),E.sd())+6,y.rounding=1,j=!1,E=E.times(E).plus(1).sqrt().plus(E),j=!0,y.precision=h,y.rounding=N,E.ln())},o.inverseHyperbolicTangent=o.atanh=function(){var h,N,E,y,r=this,i=r.constructor;return r.isFinite()?r.e>=0?new i(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(h=i.precision,N=i.rounding,y=r.sd(),Math.max(y,h)<2*-r.e-1?I(new i(r),h,N,!0):(i.precision=E=y-r.e,r=F(r.plus(1),new i(1).minus(r),E+h,1),i.precision=h+4,i.rounding=1,r=r.ln(),i.precision=h,i.rounding=N,r.times(.5))):new i(NaN)},o.inverseSine=o.asin=function(){var h,N,E,y,r=this,i=r.constructor;return r.isZero()?new i(r):(N=r.abs().cmp(1),E=i.precision,y=i.rounding,N!==-1?N===0?(h=ce(i,E+4,y).times(.5),h.s=r.s,h):new i(NaN):(i.precision=E+6,i.rounding=1,r=r.div(new i(1).minus(r.times(r)).sqrt().plus(1)).atan(),i.precision=E,i.rounding=y,r.times(2)))},o.inverseTangent=o.atan=function(){var h,N,E,y,r,i,s,d,v,C=this,O=C.constructor,U=O.precision,te=O.rounding;if(C.isFinite()){if(C.isZero())return new O(C);if(C.abs().eq(1)&&U+4<=p)return s=ce(O,U+4,te).times(.25),s.s=C.s,s}else{if(!C.s)return new O(NaN);if(U+4<=p)return s=ce(O,U+4,te).times(.5),s.s=C.s,s}for(O.precision=d=U+10,O.rounding=1,E=Math.min(28,d/Se+2|0),h=E;h;--h)C=C.div(C.times(C).plus(1).sqrt().plus(1));for(j=!1,N=Math.ceil(d/Se),y=1,v=C.times(C),s=new O(C),r=C;h!==-1;)if(r=r.times(v),i=s.minus(r.div(y+=2)),r=r.times(v),s=i.plus(r.div(y+=2)),s.d[N]!==void 0)for(h=N;s.d[h]===i.d[h]&&h--;);return E&&(s=s.times(2<<E-1)),j=!0,I(s,O.precision=U,O.rounding=te,!0)},o.isFinite=function(){return!!this.d},o.isInteger=o.isInt=function(){return!!this.d&&g(this.e/Se)>this.d.length-2},o.isNaN=function(){return!this.s},o.isNegative=o.isNeg=function(){return this.s<0},o.isPositive=o.isPos=function(){return this.s>0},o.isZero=function(){return!!this.d&&this.d[0]===0},o.lessThan=o.lt=function(h){return this.cmp(h)<0},o.lessThanOrEqualTo=o.lte=function(h){return this.cmp(h)<1},o.logarithm=o.log=function(h){var N,E,y,r,i,s,d,v,C=this,O=C.constructor,U=O.precision,te=O.rounding,oe=5;if(h==null)h=new O(10),N=!0;else{if(h=new O(h),E=h.d,h.s<0||!E||!E[0]||h.eq(1))return new O(NaN);N=h.eq(10)}if(E=C.d,C.s<0||!E||!E[0]||C.eq(1))return new O(E&&!E[0]?-1/0:C.s!=1?NaN:E?0:1/0);if(N)if(E.length>1)i=!0;else{for(r=E[0];r%10===0;)r/=10;i=r!==1}if(j=!1,d=U+oe,s=Be(C,d),y=N?ae(O,d+10):Be(h,d),v=F(s,y,d,1),S(v.d,r=U,te))do if(d+=10,s=Be(C,d),y=N?ae(O,d+10):Be(h,d),v=F(s,y,d,1),!i){+f(v.d).slice(r+1,r+15)+1==1e14&&(v=I(v,U+1,0));break}while(S(v.d,r+=10,te));return j=!0,I(v,U,te)},o.minus=o.sub=function(h){var N,E,y,r,i,s,d,v,C,O,U,te,oe=this,he=oe.constructor;if(h=new he(h),!oe.d||!h.d)return!oe.s||!h.s?h=new he(NaN):oe.d?h.s=-h.s:h=new he(h.d||oe.s!==h.s?oe:NaN),h;if(oe.s!=h.s)return h.s=-h.s,oe.plus(h);if(C=oe.d,te=h.d,d=he.precision,v=he.rounding,!C[0]||!te[0]){if(te[0])h.s=-h.s;else if(C[0])h=new he(oe);else return new he(v===3?-0:0);return j?I(h,d,v):h}if(E=g(h.e/Se),O=g(oe.e/Se),C=C.slice(),i=O-E,i){for(U=i<0,U?(N=C,i=-i,s=te.length):(N=te,E=O,s=C.length),y=Math.max(Math.ceil(d/Se),s)+2,i>y&&(i=y,N.length=1),N.reverse(),y=i;y--;)N.push(0);N.reverse()}else{for(y=C.length,s=te.length,U=y<s,U&&(s=y),y=0;y<s;y++)if(C[y]!=te[y]){U=C[y]<te[y];break}i=0}for(U&&(N=C,C=te,te=N,h.s=-h.s),s=C.length,y=te.length-s;y>0;--y)C[s++]=0;for(y=te.length;y>i;){if(C[--y]<te[y]){for(r=y;r&&C[--r]===0;)C[r]=qe-1;--C[r],C[y]+=qe}C[y]-=te[y]}for(;C[--s]===0;)C.pop();for(;C[0]===0;C.shift())--E;return C[0]?(h.d=C,h.e=se(C,E),j?I(h,d,v):h):new he(v===3?-0:0)},o.modulo=o.mod=function(h){var N,E=this,y=E.constructor;return h=new y(h),!E.d||!h.s||h.d&&!h.d[0]?new y(NaN):!h.d||E.d&&!E.d[0]?I(new y(E),y.precision,y.rounding):(j=!1,y.modulo==9?(N=F(E,h.abs(),0,3,1),N.s*=h.s):N=F(E,h,0,y.modulo,1),N=N.times(h),j=!0,E.minus(N))},o.naturalExponential=o.exp=function(){return De(this)},o.naturalLogarithm=o.ln=function(){return Be(this)},o.negated=o.neg=function(){var h=new this.constructor(this);return h.s=-h.s,I(h)},o.plus=o.add=function(h){var N,E,y,r,i,s,d,v,C,O,U=this,te=U.constructor;if(h=new te(h),!U.d||!h.d)return!U.s||!h.s?h=new te(NaN):U.d||(h=new te(h.d||U.s===h.s?U:NaN)),h;if(U.s!=h.s)return h.s=-h.s,U.minus(h);if(C=U.d,O=h.d,d=te.precision,v=te.rounding,!C[0]||!O[0])return O[0]||(h=new te(U)),j?I(h,d,v):h;if(i=g(U.e/Se),y=g(h.e/Se),C=C.slice(),r=i-y,r){for(r<0?(E=C,r=-r,s=O.length):(E=O,y=i,s=C.length),i=Math.ceil(d/Se),s=i>s?i+1:s+1,r>s&&(r=s,E.length=1),E.reverse();r--;)E.push(0);E.reverse()}for(s=C.length,r=O.length,s-r<0&&(r=s,E=O,O=C,C=E),N=0;r;)N=(C[--r]=C[r]+O[r]+N)/qe|0,C[r]%=qe;for(N&&(C.unshift(N),++y),s=C.length;C[--s]==0;)C.pop();return h.d=C,h.e=se(C,y),j?I(h,d,v):h},o.precision=o.sd=function(h){var N,E=this;if(h!==void 0&&h!==!!h&&h!==1&&h!==0)throw Error(Ne+h);return E.d?(N=Me(E.d),h&&E.e+1>N&&(N=E.e+1)):N=NaN,N},o.round=function(){var h=this,N=h.constructor;return I(new N(h),h.e+1,N.rounding)},o.sine=o.sin=function(){var h,N,E=this,y=E.constructor;return E.isFinite()?E.isZero()?new y(E):(h=y.precision,N=y.rounding,y.precision=h+Math.max(E.e,E.sd())+Se,y.rounding=1,E=Qe(y,W(y,E)),y.precision=h,y.rounding=N,I(Z>2?E.neg():E,h,N,!0)):new y(NaN)},o.squareRoot=o.sqrt=function(){var h,N,E,y,r,i,s=this,d=s.d,v=s.e,C=s.s,O=s.constructor;if(C!==1||!d||!d[0])return new O(!C||C<0&&(!d||d[0])?NaN:d?s:1/0);for(j=!1,C=Math.sqrt(+s),C==0||C==1/0?(N=f(d),(N.length+v)%2==0&&(N+="0"),C=Math.sqrt(N),v=g((v+1)/2)-(v<0||v%2),C==1/0?N="5e"+v:(N=C.toExponential(),N=N.slice(0,N.indexOf("e")+1)+v),y=new O(N)):y=new O(C.toString()),E=(v=O.precision)+3;;)if(i=y,y=i.plus(F(s,i,E+2,1)).times(.5),f(i.d).slice(0,E)===(N=f(y.d)).slice(0,E))if(N=N.slice(E-3,E+1),N=="9999"||!r&&N=="4999"){if(!r&&(I(i,v+1,0),i.times(i).eq(s))){y=i;break}E+=4,r=1}else{(!+N||!+N.slice(1)&&N.charAt(0)=="5")&&(I(y,v+1,1),h=!y.times(y).eq(s));break}return j=!0,I(y,v,O.rounding,h)},o.tangent=o.tan=function(){var h,N,E=this,y=E.constructor;return E.isFinite()?E.isZero()?new y(E):(h=y.precision,N=y.rounding,y.precision=h+10,y.rounding=1,E=E.sin(),E.s=1,E=F(E,new y(1).minus(E.times(E)).sqrt(),h+10,0),y.precision=h,y.rounding=N,I(Z==2||Z==4?E.neg():E,h,N,!0)):new y(NaN)},o.times=o.mul=function(h){var N,E,y,r,i,s,d,v,C,O=this,U=O.constructor,te=O.d,oe=(h=new U(h)).d;if(h.s*=O.s,!te||!te[0]||!oe||!oe[0])return new U(!h.s||te&&!te[0]&&!oe||oe&&!oe[0]&&!te?NaN:!te||!oe?h.s/0:h.s*0);for(E=g(O.e/Se)+g(h.e/Se),v=te.length,C=oe.length,v<C&&(i=te,te=oe,oe=i,s=v,v=C,C=s),i=[],s=v+C,y=s;y--;)i.push(0);for(y=C;--y>=0;){for(N=0,r=v+y;r>y;)d=i[r]+oe[y]*te[r-y-1]+N,i[r--]=d%qe|0,N=d/qe|0;i[r]=(i[r]+N)%qe|0}for(;!i[--s];)i.pop();return N?++E:i.shift(),h.d=i,h.e=se(i,E),j?I(h,U.precision,U.rounding):h},o.toBinary=function(h,N){return Y(this,2,h,N)},o.toDecimalPlaces=o.toDP=function(h,N){var E=this,y=E.constructor;return E=new y(E),h===void 0?E:(m(h,0,e),N===void 0?N=y.rounding:m(N,0,8),I(E,h+E.e+1,N))},o.toExponential=function(h,N){var E,y=this,r=y.constructor;return h===void 0?E=k(y,!0):(m(h,0,e),N===void 0?N=r.rounding:m(N,0,8),y=I(new r(y),h+1,N),E=k(y,!0,h+1)),y.isNeg()&&!y.isZero()?"-"+E:E},o.toFixed=function(h,N){var E,y,r=this,i=r.constructor;return h===void 0?E=k(r):(m(h,0,e),N===void 0?N=i.rounding:m(N,0,8),y=I(new i(r),h+r.e+1,N),E=k(y,!1,h+y.e+1)),r.isNeg()&&!r.isZero()?"-"+E:E},o.toFraction=function(h){var N,E,y,r,i,s,d,v,C,O,U,te,oe=this,he=oe.d,le=oe.constructor;if(!he)return new le(oe);if(C=E=new le(1),y=v=new le(0),N=new le(y),i=N.e=Me(he)-oe.e-1,s=i%Se,N.d[0]=H(10,s<0?Se+s:s),h==null)h=i>0?N:C;else{if(d=new le(h),!d.isInt()||d.lt(C))throw Error(Ne+d);h=d.gt(N)?i>0?N:C:d}for(j=!1,d=new le(f(he)),O=le.precision,le.precision=i=he.length*Se*2;U=F(d,N,0,1,1),r=E.plus(U.times(y)),r.cmp(h)!=1;)E=y,y=r,r=C,C=v.plus(U.times(r)),v=r,r=N,N=d.minus(U.times(r)),d=r;return r=F(h.minus(E),y,0,1,1),v=v.plus(r.times(C)),E=E.plus(r.times(y)),v.s=C.s=oe.s,te=F(C,y,i,1).minus(oe).abs().cmp(F(v,E,i,1).minus(oe).abs())<1?[C,y]:[v,E],le.precision=O,j=!0,te},o.toHexadecimal=o.toHex=function(h,N){return Y(this,16,h,N)},o.toNearest=function(h,N){var E=this,y=E.constructor;if(E=new y(E),h==null){if(!E.d)return E;h=new y(1),N=y.rounding}else{if(h=new y(h),N===void 0?N=y.rounding:m(N,0,8),!E.d)return h.s?E:h;if(!h.d)return h.s&&(h.s=E.s),h}return h.d[0]?(j=!1,E=F(E,h,0,N,1).times(h),j=!0,I(E)):(h.s=E.s,E=h),E},o.toNumber=function(){return+this},o.toOctal=function(h,N){return Y(this,8,h,N)},o.toPower=o.pow=function(h){var N,E,y,r,i,s,d=this,v=d.constructor,C=+(h=new v(h));if(!d.d||!h.d||!d.d[0]||!h.d[0])return new v(H(+d,C));if(d=new v(d),d.eq(1))return d;if(y=v.precision,i=v.rounding,h.eq(1))return I(d,y,i);if(N=g(h.e/Se),N>=h.d.length-1&&(E=C<0?-C:C)<=K)return r=$e(v,d,E,y),h.s<0?new v(1).div(r):I(r,y,i);if(s=d.s,s<0){if(N<h.d.length-1)return new v(NaN);if((h.d[N]&1)==0&&(s=1),d.e==0&&d.d[0]==1&&d.d.length==1)return d.s=s,d}return E=H(+d,C),N=E==0||!isFinite(E)?g(C*(Math.log("0."+f(d.d))/Math.LN10+d.e+1)):new v(E+"").e,N>v.maxE+1||N<v.minE-1?new v(N>0?s/0:0):(j=!1,v.rounding=d.s=1,E=Math.min(12,(N+"").length),r=De(h.times(Be(d,y+E)),y),r.d&&(r=I(r,y+5,1),S(r.d,y,i)&&(N=y+10,r=I(De(h.times(Be(d,N+E)),N),N+5,1),+f(r.d).slice(y+1,y+15)+1==1e14&&(r=I(r,y+1,0)))),r.s=s,j=!0,v.rounding=i,I(r,y,i))},o.toPrecision=function(h,N){var E,y=this,r=y.constructor;return h===void 0?E=k(y,y.e<=r.toExpNeg||y.e>=r.toExpPos):(m(h,1,e),N===void 0?N=r.rounding:m(N,0,8),y=I(new r(y),h,N),E=k(y,h<=y.e||y.e<=r.toExpNeg,h)),y.isNeg()&&!y.isZero()?"-"+E:E},o.toSignificantDigits=o.toSD=function(h,N){var E=this,y=E.constructor;return h===void 0?(h=y.precision,N=y.rounding):(m(h,1,e),N===void 0?N=y.rounding:m(N,0,8)),I(new y(E),h,N)},o.toString=function(){var h=this,N=h.constructor,E=k(h,h.e<=N.toExpNeg||h.e>=N.toExpPos);return h.isNeg()&&!h.isZero()?"-"+E:E},o.truncated=o.trunc=function(){return I(new this.constructor(this),this.e+1,1)},o.valueOf=o.toJSON=function(){var h=this,N=h.constructor,E=k(h,h.e<=N.toExpNeg||h.e>=N.toExpPos);return h.isNeg()?"-"+E:E};function f(h){var N,E,y,r=h.length-1,i="",s=h[0];if(r>0){for(i+=s,N=1;N<r;N++)y=h[N]+"",E=Se-y.length,E&&(i+=me(E)),i+=y;s=h[N],y=s+"",E=Se-y.length,E&&(i+=me(E))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}function m(h,N,E){if(h!==~~h||h<N||h>E)throw Error(Ne+h)}function S(h,N,E,y){var r,i,s,d;for(i=h[0];i>=10;i/=10)--N;return--N<0?(N+=Se,r=0):(r=Math.ceil((N+1)/Se),N%=Se),i=H(10,Se-N),d=h[r]%i|0,y==null?N<3?(N==0?d=d/100|0:N==1&&(d=d/10|0),s=E<4&&d==99999||E>3&&d==49999||d==5e4||d==0):s=(E<4&&d+1==i||E>3&&d+1==i/2)&&(h[r+1]/i/100|0)==H(10,N-2)-1||(d==i/2||d==0)&&(h[r+1]/i/100|0)==0:N<4?(N==0?d=d/1e3|0:N==1?d=d/100|0:N==2&&(d=d/10|0),s=(y||E<4)&&d==9999||!y&&E>3&&d==4999):s=((y||E<4)&&d+1==i||!y&&E>3&&d+1==i/2)&&(h[r+1]/i/1e3|0)==H(10,N-3)-1,s}function M(h,N,E){for(var y,r=[0],i,s=0,d=h.length;s<d;){for(i=r.length;i--;)r[i]*=N;for(r[0]+=u.indexOf(h.charAt(s++)),y=0;y<r.length;y++)r[y]>E-1&&(r[y+1]===void 0&&(r[y+1]=0),r[y+1]+=r[y]/E|0,r[y]%=E)}return r.reverse()}function V(h,N){var E,y,r;if(N.isZero())return N;y=N.d.length,y<32?(E=Math.ceil(y/3),r=(1/$(4,E)).toString()):(E=16,r="2.3283064365386962890625e-10"),h.precision+=E,N=Ae(h,1,N.times(r),new h(1));for(var i=E;i--;){var s=N.times(N);N=s.times(s).minus(s).times(8).plus(1)}return h.precision-=E,N}var F=(function(){function h(y,r,i){var s,d=0,v=y.length;for(y=y.slice();v--;)s=y[v]*r+d,y[v]=s%i|0,d=s/i|0;return d&&y.unshift(d),y}function N(y,r,i,s){var d,v;if(i!=s)v=i>s?1:-1;else for(d=v=0;d<i;d++)if(y[d]!=r[d]){v=y[d]>r[d]?1:-1;break}return v}function E(y,r,i,s){for(var d=0;i--;)y[i]-=d,d=y[i]<r[i]?1:0,y[i]=d*s+y[i]-r[i];for(;!y[0]&&y.length>1;)y.shift()}return function(y,r,i,s,d,v){var C,O,U,te,oe,he,le,Pe,Ze,et,Ue,_e,Ge,be,Je,ut,Ke,Et,Mt,jt,st=y.constructor,gt=y.s==r.s?1:-1,tt=y.d,rt=r.d;if(!tt||!tt[0]||!rt||!rt[0])return new st(!y.s||!r.s||(tt?rt&&tt[0]==rt[0]:!rt)?NaN:tt&&tt[0]==0||!rt?gt*0:gt/0);for(v?(oe=1,O=y.e-r.e):(v=qe,oe=Se,O=g(y.e/oe)-g(r.e/oe)),Mt=rt.length,Ke=tt.length,Ze=new st(gt),et=Ze.d=[],U=0;rt[U]==(tt[U]||0);U++);if(rt[U]>(tt[U]||0)&&O--,i==null?(be=i=st.precision,s=st.rounding):d?be=i+(y.e-r.e)+1:be=i,be<0)et.push(1),he=!0;else{if(be=be/oe+2|0,U=0,Mt==1){for(te=0,rt=rt[0],be++;(U<Ke||te)&&be--;U++)Je=te*v+(tt[U]||0),et[U]=Je/rt|0,te=Je%rt|0;he=te||U<Ke}else{for(te=v/(rt[0]+1)|0,te>1&&(rt=h(rt,te,v),tt=h(tt,te,v),Mt=rt.length,Ke=tt.length),ut=Mt,Ue=tt.slice(0,Mt),_e=Ue.length;_e<Mt;)Ue[_e++]=0;jt=rt.slice(),jt.unshift(0),Et=rt[0],rt[1]>=v/2&&++Et;do te=0,C=N(rt,Ue,Mt,_e),C<0?(Ge=Ue[0],Mt!=_e&&(Ge=Ge*v+(Ue[1]||0)),te=Ge/Et|0,te>1?(te>=v&&(te=v-1),le=h(rt,te,v),Pe=le.length,_e=Ue.length,C=N(le,Ue,Pe,_e),C==1&&(te--,E(le,Mt<Pe?jt:rt,Pe,v))):(te==0&&(C=te=1),le=rt.slice()),Pe=le.length,Pe<_e&&le.unshift(0),E(Ue,le,_e,v),C==-1&&(_e=Ue.length,C=N(rt,Ue,Mt,_e),C<1&&(te++,E(Ue,Mt<_e?jt:rt,_e,v))),_e=Ue.length):C===0&&(te++,Ue=[0]),et[U++]=te,C&&Ue[0]?Ue[_e++]=tt[ut]||0:(Ue=[tt[ut]],_e=1);while((ut++<Ke||Ue[0]!==void 0)&&be--);he=Ue[0]!==void 0}et[0]||et.shift()}if(oe==1)Ze.e=O,X=he;else{for(U=1,te=et[0];te>=10;te/=10)U++;Ze.e=U+O*oe-1,I(Ze,d?i+Ze.e+1:i,s,he)}return Ze}})();function I(h,N,E,y){var r,i,s,d,v,C,O,U,te,oe=h.constructor;e:if(N!=null){if(U=h.d,!U)return h;for(r=1,d=U[0];d>=10;d/=10)r++;if(i=N-r,i<0)i+=Se,s=N,O=U[te=0],v=O/H(10,r-s-1)%10|0;else if(te=Math.ceil((i+1)/Se),d=U.length,te>=d)if(y){for(;d++<=te;)U.push(0);O=v=0,r=1,i%=Se,s=i-Se+1}else break e;else{for(O=d=U[te],r=1;d>=10;d/=10)r++;i%=Se,s=i-Se+r,v=s<0?0:O/H(10,r-s-1)%10|0}if(y=y||N<0||U[te+1]!==void 0||(s<0?O:O%H(10,r-s-1)),C=E<4?(v||y)&&(E==0||E==(h.s<0?3:2)):v>5||v==5&&(E==4||y||E==6&&(i>0?s>0?O/H(10,r-s):0:U[te-1])%10&1||E==(h.s<0?8:7)),N<1||!U[0])return U.length=0,C?(N-=h.e+1,U[0]=H(10,(Se-N%Se)%Se),h.e=-N||0):U[0]=h.e=0,h;if(i==0?(U.length=te,d=1,te--):(U.length=te+1,d=H(10,Se-i),U[te]=s>0?(O/H(10,r-s)%H(10,s)|0)*d:0),C)for(;;)if(te==0){for(i=1,s=U[0];s>=10;s/=10)i++;for(s=U[0]+=d,d=1;s>=10;s/=10)d++;i!=d&&(h.e++,U[0]==qe&&(U[0]=1));break}else{if(U[te]+=d,U[te]!=qe)break;U[te--]=0,d=1}for(i=U.length;U[--i]===0;)U.pop()}return j&&(h.e>oe.maxE?(h.d=null,h.e=NaN):h.e<oe.minE&&(h.e=0,h.d=[0])),h}function k(h,N,E){if(!h.isFinite())return We(h);var y,r=h.e,i=f(h.d),s=i.length;return N?(E&&(y=E-s)>0?i=i.charAt(0)+"."+i.slice(1)+me(y):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(h.e<0?"e":"e+")+h.e):r<0?(i="0."+me(-r-1)+i,E&&(y=E-s)>0&&(i+=me(y))):r>=s?(i+=me(r+1-s),E&&(y=E-r-1)>0&&(i=i+"."+me(y))):((y=r+1)<s&&(i=i.slice(0,y)+"."+i.slice(y)),E&&(y=E-s)>0&&(r+1===s&&(i+="."),i+=me(y))),i}function se(h,N){var E=h[0];for(N*=Se;E>=10;E/=10)N++;return N}function ae(h,N,E){if(N>l)throw j=!0,E&&(h.precision=E),Error(Re);return I(new h(w),N,1,!0)}function ce(h,N,E){if(N>p)throw Error(Re);return I(new h(_),N,E,!0)}function Me(h){var N=h.length-1,E=N*Se+1;if(N=h[N],N){for(;N%10==0;N/=10)E--;for(N=h[0];N>=10;N/=10)E++}return E}function me(h){for(var N="";h--;)N+="0";return N}function $e(h,N,E,y){var r,i=new h(1),s=Math.ceil(y/Se+4);for(j=!1;;){if(E%2&&(i=i.times(N),q(i.d,s)&&(r=!0)),E=g(E/2),E===0){E=i.d.length-1,r&&i.d[E]===0&&++i.d[E];break}N=N.times(N),q(N.d,s)}return j=!0,i}function Xe(h){return h.d[h.d.length-1]&1}function ye(h,N,E){for(var y,r,i=new h(N[0]),s=0;++s<N.length;){if(r=new h(N[s]),!r.s){i=r;break}y=i.cmp(r),(y===E||y===0&&i.s===E)&&(i=r)}return i}function De(h,N){var E,y,r,i,s,d,v,C=0,O=0,U=0,te=h.constructor,oe=te.rounding,he=te.precision;if(!h.d||!h.d[0]||h.e>17)return new te(h.d?h.d[0]?h.s<0?0:1/0:1:h.s?h.s<0?0:h:NaN);for(N==null?(j=!1,v=he):v=N,d=new te(.03125);h.e>-2;)h=h.times(d),U+=5;for(y=Math.log(H(2,U))/Math.LN10*2+5|0,v+=y,E=i=s=new te(1),te.precision=v;;){if(i=I(i.times(h),v,1),E=E.times(++O),d=s.plus(F(i,E,v,1)),f(d.d).slice(0,v)===f(s.d).slice(0,v)){for(r=U;r--;)s=I(s.times(s),v,1);if(N==null)if(C<3&&S(s.d,v-y,oe,C))te.precision=v+=10,E=i=d=new te(1),O=0,C++;else return I(s,te.precision=he,oe,j=!0);else return te.precision=he,s}s=d}}function Be(h,N){var E,y,r,i,s,d,v,C,O,U,te,oe=1,he=10,le=h,Pe=le.d,Ze=le.constructor,et=Ze.rounding,Ue=Ze.precision;if(le.s<0||!Pe||!Pe[0]||!le.e&&Pe[0]==1&&Pe.length==1)return new Ze(Pe&&!Pe[0]?-1/0:le.s!=1?NaN:Pe?0:le);if(N==null?(j=!1,O=Ue):O=N,Ze.precision=O+=he,E=f(Pe),y=E.charAt(0),Math.abs(i=le.e)<15e14){for(;y<7&&y!=1||y==1&&E.charAt(1)>3;)le=le.times(h),E=f(le.d),y=E.charAt(0),oe++;i=le.e,y>1?(le=new Ze("0."+E),i++):le=new Ze(y+"."+E.slice(1))}else return C=ae(Ze,O+2,Ue).times(i+""),le=Be(new Ze(y+"."+E.slice(1)),O-he).plus(C),Ze.precision=Ue,N==null?I(le,Ue,et,j=!0):le;for(U=le,v=s=le=F(le.minus(1),le.plus(1),O,1),te=I(le.times(le),O,1),r=3;;){if(s=I(s.times(te),O,1),C=v.plus(F(s,new Ze(r),O,1)),f(C.d).slice(0,O)===f(v.d).slice(0,O))if(v=v.times(2),i!==0&&(v=v.plus(ae(Ze,O+2,Ue).times(i+""))),v=F(v,new Ze(oe),O,1),N==null)if(S(v.d,O-he,et,d))Ze.precision=O+=he,C=s=le=F(U.minus(1),U.plus(1),O,1),te=I(le.times(le),O,1),r=d=1;else return I(v,Ze.precision=Ue,et,j=!0);else return Ze.precision=Ue,v;v=C,r+=2}}function We(h){return String(h.s*h.s/0)}function Le(h,N){var E,y,r;for((E=N.indexOf("."))>-1&&(N=N.replace(".","")),(y=N.search(/e/i))>0?(E<0&&(E=y),E+=+N.slice(y+1),N=N.substring(0,y)):E<0&&(E=N.length),y=0;N.charCodeAt(y)===48;y++);for(r=N.length;N.charCodeAt(r-1)===48;--r);if(N=N.slice(y,r),N){if(r-=y,h.e=E=E-y-1,h.d=[],y=(E+1)%Se,E<0&&(y+=Se),y<r){for(y&&h.d.push(+N.slice(0,y)),r-=Se;y<r;)h.d.push(+N.slice(y,y+=Se));N=N.slice(y),y=Se-N.length}else y-=r;for(;y--;)N+="0";h.d.push(+N),j&&(h.e>h.constructor.maxE?(h.d=null,h.e=NaN):h.e<h.constructor.minE&&(h.e=0,h.d=[0]))}else h.e=0,h.d=[0];return h}function Ve(h,N){var E,y,r,i,s,d,v,C,O;if(N.indexOf("_")>-1){if(N=N.replace(/(\d)_(?=\d)/g,"$1"),we.test(N))return Le(h,N)}else if(N==="Infinity"||N==="NaN")return+N||(h.s=NaN),h.e=NaN,h.d=null,h;if(Oe.test(N))E=16,N=N.toLowerCase();else if(de.test(N))E=2;else if(ve.test(N))E=8;else throw Error(Ne+N);for(i=N.search(/p/i),i>0?(v=+N.slice(i+1),N=N.substring(2,i)):N=N.slice(2),i=N.indexOf("."),s=i>=0,y=h.constructor,s&&(N=N.replace(".",""),d=N.length,i=d-i,r=$e(y,new y(E),i,i*2)),C=M(N,E,qe),O=C.length-1,i=O;C[i]===0;--i)C.pop();return i<0?new y(h.s*0):(h.e=se(C,O),h.d=C,j=!1,s&&(h=F(h,r,d*4)),v&&(h=h.times(Math.abs(v)<54?H(2,v):L.pow(2,v))),j=!0,h)}function Qe(h,N){var E,y=N.d.length;if(y<3)return N.isZero()?N:Ae(h,2,N,N);E=1.4*Math.sqrt(y),E=E>16?16:E|0,N=N.times(1/$(5,E)),N=Ae(h,2,N,N);for(var r,i=new h(5),s=new h(16),d=new h(20);E--;)r=N.times(N),N=N.times(i.plus(r.times(s.times(r).minus(d))));return N}function Ae(h,N,E,y,r){var i,s,d,v,C=1,O=h.precision,U=Math.ceil(O/Se);for(j=!1,v=E.times(E),d=new h(y);;){if(s=F(d.times(v),new h(N++*N++),O,1),d=r?y.plus(s):y.minus(s),y=F(s.times(v),new h(N++*N++),O,1),s=d.plus(y),s.d[U]!==void 0){for(i=U;s.d[i]===d.d[i]&&i--;);if(i==-1)break}i=d,d=y,y=s,s=i,C++}return j=!0,s.d.length=U+1,s}function $(h,N){for(var E=h;--N;)E*=h;return E}function W(h,N){var E,y=N.s<0,r=ce(h,h.precision,1),i=r.times(.5);if(N=N.abs(),N.lte(i))return Z=y?4:1,N;if(E=N.divToInt(r),E.isZero())Z=y?3:2;else{if(N=N.minus(E.times(r)),N.lte(i))return Z=Xe(E)?y?2:3:y?4:1,N;Z=Xe(E)?y?1:4:y?3:2}return N.minus(r).abs()}function Y(h,N,E,y){var r,i,s,d,v,C,O,U,te,oe=h.constructor,he=E!==void 0;if(he?(m(E,1,e),y===void 0?y=oe.rounding:m(y,0,8)):(E=oe.precision,y=oe.rounding),!h.isFinite())O=We(h);else{for(O=k(h),s=O.indexOf("."),he?(r=2,N==16?E=E*4-3:N==8&&(E=E*3-2)):r=N,s>=0&&(O=O.replace(".",""),te=new oe(1),te.e=O.length-s,te.d=M(k(te),10,r),te.e=te.d.length),U=M(O,10,r),i=v=U.length;U[--v]==0;)U.pop();if(!U[0])O=he?"0p+0":"0";else{if(s<0?i--:(h=new oe(h),h.d=U,h.e=i,h=F(h,te,E,y,0,r),U=h.d,i=h.e,C=X),s=U[E],d=r/2,C=C||U[E+1]!==void 0,C=y<4?(s!==void 0||C)&&(y===0||y===(h.s<0?3:2)):s>d||s===d&&(y===4||C||y===6&&U[E-1]&1||y===(h.s<0?8:7)),U.length=E,C)for(;++U[--E]>r-1;)U[E]=0,E||(++i,U.unshift(1));for(v=U.length;!U[v-1];--v);for(s=0,O="";s<v;s++)O+=u.charAt(U[s]);if(he){if(v>1)if(N==16||N==8){for(s=N==16?4:3,--v;v%s;v++)O+="0";for(U=M(O,r,N),v=U.length;!U[v-1];--v);for(s=1,O="1.";s<v;s++)O+=u.charAt(U[s])}else O=O.charAt(0)+"."+O.slice(1);O=O+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)O="0"+O;O="0."+O}else if(++i>v)for(i-=v;i--;)O+="0";else i<v&&(O=O.slice(0,i)+"."+O.slice(i))}O=(N==16?"0x":N==2?"0b":N==8?"0o":"")+O}return h.s<0?"-"+O:O}function q(h,N){if(h.length>N)return h.length=N,!0}function ee(h){return new this(h).abs()}function B(h){return new this(h).acos()}function T(h){return new this(h).acosh()}function ge(h,N){return new this(h).plus(N)}function a(h){return new this(h).asin()}function c(h){return new this(h).asinh()}function A(h){return new this(h).atan()}function x(h){return new this(h).atanh()}function b(h,N){h=new this(h),N=new this(N);var E,y=this.precision,r=this.rounding,i=y+4;return!h.s||!N.s?E=new this(NaN):!h.d&&!N.d?(E=ce(this,i,1).times(N.s>0?.25:.75),E.s=h.s):!N.d||h.isZero()?(E=N.s<0?ce(this,y,r):new this(0),E.s=h.s):!h.d||N.isZero()?(E=ce(this,i,1).times(.5),E.s=h.s):N.s<0?(this.precision=i,this.rounding=1,E=this.atan(F(h,N,i,1)),N=ce(this,i,1),this.precision=y,this.rounding=r,E=h.s<0?E.minus(N):E.plus(N)):E=this.atan(F(h,N,i,1)),E}function Q(h){return new this(h).cbrt()}function J(h){return I(h=new this(h),h.e+1,2)}function G(h,N,E){return new this(h).clamp(N,E)}function D(h){if(!h||typeof h!="object")throw Error(Ee+"Object expected");var N,E,y,r=h.defaults===!0,i=["precision",1,e,"rounding",0,8,"toExpNeg",-t,0,"toExpPos",0,t,"maxE",0,t,"minE",-t,0,"modulo",0,9];for(N=0;N<i.length;N+=3)if(E=i[N],r&&(this[E]=R[E]),(y=h[E])!==void 0)if(g(y)===y&&y>=i[N+1]&&y<=i[N+2])this[E]=y;else throw Error(Ne+E+": "+y);if(E="crypto",r&&(this[E]=R[E]),(y=h[E])!==void 0)if(y===!0||y===!1||y===0||y===1)if(y)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[E]=!0;else throw Error(ie);else this[E]=!1;else throw Error(Ne+E+": "+y);return this}function ne(h){return new this(h).cos()}function pe(h){return new this(h).cosh()}function Ce(h){var N,E,y;function r(i){var s,d,v,C=this;if(!(C instanceof r))return new r(i);if(C.constructor=r,je(i)){C.s=i.s,j?!i.d||i.e>r.maxE?(C.e=NaN,C.d=null):i.e<r.minE?(C.e=0,C.d=[0]):(C.e=i.e,C.d=i.d.slice()):(C.e=i.e,C.d=i.d?i.d.slice():i.d);return}if(v=typeof i,v==="number"){if(i===0){C.s=1/i<0?-1:1,C.e=0,C.d=[0];return}if(i<0?(i=-i,C.s=-1):C.s=1,i===~~i&&i<1e7){for(s=0,d=i;d>=10;d/=10)s++;j?s>r.maxE?(C.e=NaN,C.d=null):s<r.minE?(C.e=0,C.d=[0]):(C.e=s,C.d=[i]):(C.e=s,C.d=[i]);return}if(i*0!==0){i||(C.s=NaN),C.e=NaN,C.d=null;return}return Le(C,i.toString())}if(v==="string")return(d=i.charCodeAt(0))===45?(i=i.slice(1),C.s=-1):(d===43&&(i=i.slice(1)),C.s=1),we.test(i)?Le(C,i):Ve(C,i);if(v==="bigint")return i<0?(i=-i,C.s=-1):C.s=1,Le(C,i.toString());throw Error(Ne+i)}if(r.prototype=o,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=D,r.clone=Ce,r.isDecimal=je,r.abs=ee,r.acos=B,r.acosh=T,r.add=ge,r.asin=a,r.asinh=c,r.atan=A,r.atanh=x,r.atan2=b,r.cbrt=Q,r.ceil=J,r.clamp=G,r.cos=ne,r.cosh=pe,r.div=Te,r.exp=Fe,r.floor=xe,r.hypot=He,r.ln=ze,r.log=at,r.log10=pt,r.log2=nt,r.max=At,r.min=Dt,r.mod=lt,r.mul=Ct,r.pow=qt,r.random=Ot,r.round=Lt,r.sign=Jt,r.sin=a0,r.sinh=Yt,r.sqrt=r0,r.sub=Kt,r.sum=w0,r.tan=it,r.tanh=Y0,r.trunc=K0,h===void 0&&(h={}),h&&h.defaults!==!0)for(y=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],N=0;N<y.length;)h.hasOwnProperty(E=y[N++])||(h[E]=this[E]);return r.config(h),r}function Te(h,N){return new this(h).div(N)}function Fe(h){return new this(h).exp()}function xe(h){return I(h=new this(h),h.e+1,3)}function He(){var h,N,E=new this(0);for(j=!1,h=0;h<arguments.length;)if(N=new this(arguments[h++]),N.d)E.d&&(E=E.plus(N.times(N)));else{if(N.s)return j=!0,new this(1/0);E=N}return j=!0,E.sqrt()}function je(h){return h instanceof L||h&&h.toStringTag===fe||!1}function ze(h){return new this(h).ln()}function at(h,N){return new this(h).log(N)}function nt(h){return new this(h).log(2)}function pt(h){return new this(h).log(10)}function At(){return ye(this,arguments,-1)}function Dt(){return ye(this,arguments,1)}function lt(h,N){return new this(h).mod(N)}function Ct(h,N){return new this(h).mul(N)}function qt(h,N){return new this(h).pow(N)}function Ot(h){var N,E,y,r,i=0,s=new this(1),d=[];if(h===void 0?h=this.precision:m(h,1,e),y=Math.ceil(h/Se),this.crypto)if(crypto.getRandomValues)for(N=crypto.getRandomValues(new Uint32Array(y));i<y;)r=N[i],r>=429e7?N[i]=crypto.getRandomValues(new Uint32Array(1))[0]:d[i++]=r%1e7;else if(crypto.randomBytes){for(N=crypto.randomBytes(y*=4);i<y;)r=N[i]+(N[i+1]<<8)+(N[i+2]<<16)+((N[i+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(N,i):(d.push(r%1e7),i+=4);i=y/4}else throw Error(ie);else for(;i<y;)d[i++]=Math.random()*1e7|0;for(y=d[--i],h%=Se,y&&h&&(r=H(10,Se-h),d[i]=(y/r|0)*r);d[i]===0;i--)d.pop();if(i<0)E=0,d=[0];else{for(E=-1;d[0]===0;E-=Se)d.shift();for(y=1,r=d[0];r>=10;r/=10)y++;y<Se&&(E-=Se-y)}return s.e=E,s.d=d,s}function Lt(h){return I(h=new this(h),h.e+1,this.rounding)}function Jt(h){return h=new this(h),h.d?h.d[0]?h.s:0*h.s:h.s||NaN}function a0(h){return new this(h).sin()}function Yt(h){return new this(h).sinh()}function r0(h){return new this(h).sqrt()}function Kt(h,N){return new this(h).sub(N)}function w0(){var h=0,N=arguments,E=new this(N[h]);for(j=!1;E.s&&++h<N.length;)E=E.plus(N[h]);return j=!0,I(E,this.precision,this.rounding)}function it(h){return new this(h).tan()}function Y0(h){return new this(h).tanh()}function K0(h){return I(h=new this(h),h.e+1,1)}L=Ce(R),L.prototype.constructor=L,L.default=L.Decimal=L,w=new L(w),_=new L(_),typeof define=="function"&&define.amd?define(function(){return L}):typeof B0<"u"&&B0.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(o[Symbol.for("nodejs.util.inspect.custom")]=o.toString,o[Symbol.toStringTag]="Decimal"),B0.exports=L):(n||(n=typeof self<"u"&&self&&self.self==self?self:window),z=n.Decimal,L.noConflict=function(){return n.Decimal=z,L},n.Decimal=L)})(qn)});var Un=c0((Zi,en)=>{"use strict";var Rn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],Ln={};for(let n of Rn)Ln[n]=!0;var f1="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",p1="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",h1=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof en<"u"&&(en.exports={PRIMES:Rn,PRIMES_SET:Ln,LONG_PI:f1,LONG_E:p1,BIG_LOG_CACHE:h1})});var O0=c0((ji,mn)=>{"use strict";var dn=typeof globalThis.nerdamerBigInt>"u"?On():globalThis.nerdamerBigInt,Q0=typeof globalThis.nerdamerBigDecimal>"u"?Tn():globalThis.nerdamerBigDecimal;Q0.set({precision:250});var T0=typeof globalThis.nerdamerConstants>"u"?Un():globalThis.nerdamerConstants,re={ext:{bigInt:dn,bigDec:Q0,PRIMES:T0.PRIMES,PRIMES_SET:T0.PRIMES_SET,LONG_PI:T0.LONG_PI,LONG_E:T0.LONG_E,BIG_LOG_CACHE:T0.BIG_LOG_CACHE},groups:{N:1,P:2,S:3,EX:4,FN:5,PL:6,CB:7,CP:8},fnNames:{SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",PARENTHESIS:"parens",LOG:"log",CONST_HASH:"#"},get settings(){return Ie},state:{get EXPRESSIONS(){return d1},get VARS(){return w1},CONSTANTS:{},get RESERVED(){return S1},get WARNINGS(){return v1},get USER_FUNCTIONS(){return N1},get CUSTOM_OPERATORS(){return m1}},classes:{Frac:null,Fraction:null,NerdamerSymbol:null,Vector:null,Matrix:null,Expression:null,Collection:null,NerdamerSet:null,Scientific:null,Parser:null,LaTeX:null,Math2:null,Build:null},utils:{get isSymbol(){return ct},get isVector(){return St},get isMatrix(){return dt},get isExpression(){return t1},get isNumericSymbol(){return I0},get isFraction(){return _n},get isArray(){return Ft},get isInt(){return ft},get text(){return Vt},get variables(){return t0},get scientificToDecimal(){return L0},get err(){return xt},get block(){return bt},get evaluate(){return vt},get reserveNames(){return U0},get nround(){return h0},get remove(){return g0},get _setFunction(){return An},get _clearFunctions(){return Pi},symfunction:null,callfunction:null},exceptions:{get DivisionByZero(){return Nn},get ParseError(){return Vn},get OutOfFunctionDomainError(){return an},get UndefinedError(){return Xt},get MaximumIterationsReached(){return x1},get NerdamerTypeError(){return En},get ParityError(){return G0},get OperatorError(){return A0},get OutOfRangeError(){return $1},get DimensionError(){return cn},get InvalidVariableNameError(){return Xn},get ValueLimitExceededError(){return D1},get NerdamerValueError(){return Gn},get SolveError(){return F1},get InfiniteLoopError(){return k1},get UnexpectedTokenError(){return Hn}},parser:null,core:null,libExports:null,version:"1.1.16"},g1={N:re.groups.N,P:re.groups.P,S:re.groups.S,EX:re.groups.EX,FN:re.groups.FN,PL:re.groups.PL,CB:re.groups.CB,CP:re.groups.CP},m1={},d1=[],w1={},S1=[],v1=[],N1=[];Math.sign||=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1};Math.cosh||=function(t){let e=Math.exp(t);return(e+1/e)/2};Math.sech||=function(t){return 1/Math.cosh(t)};Math.csch||=function(t){return 1/Math.sinh(t)};Math.coth||=function(t){return 1/Math.tanh(t)};Math.sinh||=function(t){let e=Math.exp(t);return(e-1/e)/2};Math.tanh||=function(t){if(t===1/0)return 1;if(t===-1/0)return-1;let e=Math.exp(2*t);return(e-1)/(e+1)};Math.asinh||=function(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))};Math.acosh||=function(t){return Math.log(t+Math.sqrt(t*t-1))};Math.atanh||=function(t){return Math.log((1+t)/(1-t))/2};Math.trunc||=function(t){return isNaN(t)?NaN:t>0?Math.floor(t):Math.ceil(t)};var wn={convert(n,t){let e=Number(n),u;if(e===0)u=[0,1];else if(Math.abs(e)<1e-6||Math.abs(e)>1e20){let w=this.quickConversion(e);if(w[1]<=1e16){let _=Math.abs(e),R=e/_;u=this.fullConversion(_.toFixed(`${w[1]}`.length-1)),u[0]*=R}else u=w}else u=this.fullConversion(e);return u},quickConversion(n){let t=function(u){typeof u!="string"&&(u=u.toString());let w="",_=u.charAt(0);return _==="-"?(u=u.substr(1,u.length),w="-"):_==="+"&&(u=u.substr(1,u.length)),{sign:w,value:u}};function e(u){$t.isScientific(u)&&(u=L0(u));let w=t(u),_=w.value.split("."),R;_.length===1?R=_[0]:R=_[0]+_[1];let L=_[1]?_[1].length:0,X=`1${"0".repeat(L)}`;return R!=="0"&&(R=R.replace(/^0+/u,"")),[w.sign+R,X]}return e(n)},fullConversion(n){let t=Number(n),e=Math.abs(t)>1e10?1e-16:1e-30,u=!1,w=0,_=1,R=1,L=0,X=0,z=t,Z,j,Ee=1e-14;for(;!u;){X++;let Ne;if(Math.abs(z)>1e10){let ie=Math.round(z);Ne=Math.abs(z-ie)/Math.abs(ie)<Ee?ie:Math.floor(z)}else Ne=Math.floor(z);Z=w+Ne*R,j=_+Ne*L;let Re=z-Ne;Re<e&&(u=!0),z=1/Re,w=R,_=L,R=Z,L=j,(Math.abs(Z/j-t)<e||X>30)&&(u=!0)}return[Z,j]}};re.classes.Fraction=wn;var Ut={get bigInt(){return re.ext.bigInt},get bigDec(){return re.ext.bigDec},get isInt(){return re.utils.isInt},get scientificToDecimal(){return re.utils.scientificToDecimal},get DivisionByZero(){return Nn},get Settings(){return re.settings},get Fraction(){return wn}},ke=class n{constructor(t){if(this.num,this.den,t instanceof n)return t;if(t===void 0)return this;try{if(Ut.isInt(t))try{this.num=Ut.bigInt(t),this.den=Ut.bigInt(1)}catch(e){if(e.message==="timeout")throw e;return n.simple(t)}else{let e=t instanceof Ut.bigDec?Ut.Fraction.quickConversion(t):Ut.Fraction.convert(t);this.num=new Ut.bigInt(e[0]),this.den=new Ut.bigInt(e[1])}}catch(e){if(e.message==="timeout")throw e;return n.simple(t)}}static create(t){if(t instanceof n)return t;t=t.toString();let e=t.charAt(0)==="-";e&&(t=t.substr(1,t.length-1));let u=new n(t);return e&&u.negate(),u}static isFrac(t){return t instanceof n}static quick(t,e){let u=new n;return u.num=new Ut.bigInt(t),u.den=new Ut.bigInt(e),u}static simple(t){let u=String(Ut.scientificToDecimal(t)).split("."),w=u.join(""),_="1",R=(u[1]||"").length;for(let X=0;X<R;X++)_+="0";return n.quick(w,_).simplify()}multiply(t){if(this.isOne())return t.clone();if(t.isOne())return this.clone();let e=this.clone();return e.num=e.num.multiply(t.num),e.den=e.den.multiply(t.den),e.simplify()}divide(t){if(t.equals(0))throw new Ut.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(t.clone().invert()).simplify()}subtract(t){return this.clone().add(t.clone().neg())}sub(t){return this.subtract(t)}neg(){return this.num=this.num.multiply(-1),this}add(t){let e=this.den,u=t.den,w=this.clone(),_=w.num,R=t.num;return e.equals(u)?w.num=_.add(R):(w.num=_.multiply(u).add(R.multiply(e)),w.den=e.multiply(u)),w.simplify()}mod(t){let e=this.clone(),u=t.clone();return e.num=e.num.multiply(u.den),e.den=e.den.multiply(u.den),u.num=u.num.multiply(this.den),u.den=u.den.multiply(this.den),e.num=e.num.mod(u.num),e.simplify()}simplify(){let t=Ut.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(t),this.den=this.den.divide(t),this}clone(){let t=new n;return t.num=new Ut.bigInt(this.num),t.den=new Ut.bigInt(this.den),t}decimal(t){let e=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";t||=Ut.Settings.PRECISION,t+=2;let u=[],w=this.num.abs(),_=this.den,R;for(R=0;R<t;R++){let z=w.divide(_),Z=w.subtract(z.multiply(_));if(u.push(z),Z.equals(0))break;w=Z.times(10)}let L=u.shift();if(u.length===0)return e+L.toString();if(R===t){let z=[];for(let Z=0;Z<2;Z++)z.unshift(u.pop());u.push(Math.round(Number(z.join("."))))}let X=`${L.toString()}.${u.join("")}`;return e+X}toDecimal(t){return t||=Ut.Settings.PRECISION,t?this.decimal(t):this.num.valueOf()/this.den.valueOf()}qcompare(t){return[this.num.multiply(t.den),t.num.multiply(this.den)]}equals(t){isNaN(t)||(t=new n(t));let e=this.qcompare(t);return e[0].equals(e[1])}absEquals(t){isNaN(t)||(t=new n(t));let e=this.qcompare(t);return e[0].abs().equals(e[1])}greaterThan(t){isNaN(t)||(t=new n(t));let e=this.qcompare(t);return e[0].gt(e[1])}gt(t){return this.greaterThan(t)}gte(t){return this.greaterThan(t)||this.equals(t)}lte(t){return this.lessThan(t)||this.equals(t)}lessThan(t){isNaN(t)||(t=new n(t));let e=this.qcompare(t);return e[0].lt(e[1])}lt(t){return this.lessThan(t)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let t=this.den;if(!this.num.equals(0)){let e=this.num.isNegative();this.den=this.num.abs(),this.num=t,e&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(t){return n.quick(Ut.bigInt.gcd(t.num,this.num),Ut.bigInt.lcm(t.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Ut.Settings.USE_BIG?new Ut.bigDec(this.num.toString()).div(new Ut.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(t){let e=typeof t=="number"?new n(t):t;return this.mod(e).equals(0)}};re.classes.Frac=ke;var ln={get isVector(){return re.utils.isVector},get Vector(){return re.classes.Vector},get remove(){return g0}};function n0(n,...t){if(this.elements=[],typeof n>"u")return;let e=n;if(ln.isVector(e)||(e=ln.Vector.fromArray([e,...t])),e){let{elements:u}=e;for(let w=0,_=u.length;w<_;w++)this.add(u[w])}}n0.fromArray=function(t){function e(u){return n0.apply(this,u)}return e.prototype=n0.prototype,new e(t)};n0.prototype={elements:[],add(n){this.contains(n)||this.elements.push(n.clone())},contains(n){for(let t=0;t<this.elements.length;t++){let e=this.elements[t];if(n.equals(e))return!0}return!1},each(n){let{elements:t}=this,e=new n0;for(let u=0,w=t.length;u<w;u++){let _=t[u];n.call(this,_,e,u)}return e},clone(){let n=new n0;return this.each(t=>{n.add(t.clone())}),n},union(n){let t=this.clone();return n.each(e=>{t.add(e)}),t},difference(n){let t=this.clone();return n.each(e=>{t.remove(e)}),t},remove(n){for(let t=0,e=this.elements.length;t<e;t++)if(this.elements[t].equals(n))return ln.remove(this.elements,t),!0;return!1},intersection(n){let t=new n0,e=this;return n.each(u=>{e.contains(u)&&t.add(u)}),t},intersects(n){return this.intersection(n).elements.length>0},isSubset(n){let{elements:t}=n;for(let e=0,u=t.length;e<u;e++)if(!this.contains(t[e]))return!1;return!0},toString(){return`{${this.elements.join(",")}}`}};re.classes.NerdamerSet=n0;var y0={get _(){return re.parser},get block(){return re.utils.block}};function Rt(){this.elements=[]}Rt.prototype.append=function(t){this.elements.push(t)};Rt.prototype.getItems=function(){return this.elements};Rt.prototype.toString=function(){return y0._.prettyPrint(this.elements)};Rt.prototype.dimensions=function(){return this.elements.length};Rt.prototype.text=function(n){return`(${this.elements.map(t=>t.text(n)).join(",")})`};Rt.create=function(t){let e=new Rt;return t&&e.append(t),e};Rt.prototype.clone=function(t){let e=Rt.create();return e.elements=this.elements.map(u=>u.clone()),e};Rt.prototype.expand=function(t){return this.elements=this.elements.map(e=>y0._.expand(e,t)),this};Rt.prototype.evaluate=function(n){return this.elements=this.elements.map(t=>y0._.evaluate(t,n)),this};Rt.prototype.map=function(t){let e=this.clone();return e.elements=e.elements.map((u,w)=>t(u,w+1)),e};Rt.prototype.add=function(t){return y0.block("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((u,w)=>y0._.add(u,e[w-1]))},void 0,this)};Rt.prototype.subtract=function(t){return y0.block("SAFE",()=>{let e=t.elements||t;return this.elements.length!==e.length?null:this.map((u,w)=>y0._.subtract(u,e[w-1]))},void 0,this)};re.classes.Collection=Rt;var kn={get Settings(){return re.settings},get nround(){return re.utils.nround}};function $t(n){return this instanceof $t?(n=String(typeof n>"u"?0:n),n.startsWith("-")?(this.sign=-1,n=n.substr(1,n.length)):this.sign=1,$t.isScientific(n)?this.fromScientific(n):this.convert(n),this):new $t(n)}$t.prototype={fromScientific(n){let t=String(n).toLowerCase().split("e");this.coeff=t[0],this.exponent=Number(t[1]);let e=this.coeff.split(".");this.wholes=e[0]||"",this.dec=e[1]||"";let{dec:u}=this;return this.decp=u==="0"?0:u.length,this},convert(n){let t=n.split("."),e=t[0]||"",u=t[1]||"";e=$t.removeLeadingZeroes(e),u=$t.removeTrailingZeroes(u);let w=e.length,_=e+u,R=$t.leadingZeroes(_).length;this.exponent=w-(R+1);let L=$t.removeLeadingZeroes(_);this.coeff=`${L.charAt(0)}.${$t.removeTrailingZeroes(L.substr(1,L.length))||"0"}`;let X=this.coeff.split(".")[1]||"";return this.decp=X==="0"?0:X.length,this.dec=u,this.wholes=e,this},round(n){let t=this.copy();if(n=Number(n),n===0)t.coeff=t.coeff.charAt(0);else{let e=this.coeff.substring(0,n+1),u=this.coeff.substring(n+1,n+3),w=Number(u.charAt(0));Number(u.charAt(1))>4&&w++,t.coeff=e+w}return t},copy(){let n=new $t(0);return n.coeff=this.coeff,n.exponent=this.exponent,n.sign=this.sign,n},toString(n){let t;if(kn.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<n)this.decp===0&&this.wholes!==void 0?t=this.wholes:t=this.coeff;else{let e=typeof n>"u"?this.coeff:$t.round(this.coeff,Math.min(n,this.decp||1)),u=this.exponent;e.startsWith("10.")&&(e=typeof n>"u"?e.replace(/^10\./u,"1.0"):$t.round(e.replace(/^10\./u,"1.0"),Math.min(n,this.decp||1)),u=Number(u)+1),t=this.exponent===0?e:`${e}e${u}`}return(this.sign===-1?"-":"")+t}};$t.isScientific=function(t){return/\d+\.?\d*e[+-]*\d+/iu.test(t)};$t.leadingZeroes=function(t){let e=t.match(/^(?<zeros>0*).*$/u);return e?e[1]:""};$t.removeLeadingZeroes=function(t){let e=t.match(/^0*(?<rest>.*)$/u);return e?e[1]:""};$t.removeTrailingZeroes=function(t){let e=t.match(/0*$/u);return e?t.substring(0,t.length-e[0].length):""};$t.round=function(t,e){let u=String(kn.nround(t,e)),w=u.includes(".")?u.split(".").pop():"",_=e-w.length;return _>0&&(u.includes(".")||(u+="."),u+=new Array(_+1).join("0")),u};re.classes.Scientific=$t;function Gt(n){let t=function(e){this.name=n,this.message=e===void 0?"":e;let u=new Error(this.message);u.name=this.name,this.stack=u.stack};return t.prototype=Object.create(Error.prototype),t}function Ft(n){return Array.isArray(n)}function _t(n){return`(${n})`}function E1(n,t){return n<0==t<0}function Tt(...n){return n.shift().replace(/\{(?<idx>\d+)\}/gu,(u,w)=>{let _=n[w];return typeof _=="function"?_():_})}function y1(n,t,e){let u=[];e||=1;for(let w=n;w<=t;w++)u.push(w*e);return u}function M1(n){return n&&String(n)}function _1(n,t,e,u){return n.substr(0,t)+u+n.substr(e,n.length)}function A1(n){return n!==void 0&&n.custom}function C1(n){return Math.max.apply(void 0,n)}function Sn(n){return Math.min.apply(void 0,n)}function Pt(n){return Number(n)%2===0}function un(n){return 1/(n%1)%2===0}function vn(n){let t=n.length,e=[];for(let u=0;u<t;u++){let w=n[u];e.indexOf(w)===-1&&e.push(w)}return e}function I1(n){return[].slice.call(n)}function ft(n){return typeof n=="number"?Number.isInteger(n):typeof n<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(n.toString())}function O1(n,t){if(n.sort(),t.sort(),n.length===t.length){for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}return!1}function q1(n){let t=[],e=n.length;for(let u=0;u<e;u++)t[u]=n[u].clone();return t}function Bn(n){return/^\d+\.?\d*$/u.test(n)}function h0(n,t=14){return ft(n)?Number(n)>=Number.MAX_VALUE?n.toString():Number(n):Math.round(n*10**t)/10**t}function T1(n,t){t||=20;let e=[],u,w,_;e.push(n[0]);for(let R=0;R<n.length-1;R++){u=n[R],w=n[R+1]-u,_=w/t;for(let L=0;L<t;L++)u+=_,e.push(u)}return e}function bn(n,t){if(Ft(n)){let e=n.length;for(let u=0;u<e;u++)t.call(n,u)}else for(let e in n)Object.hasOwn(n,e)&&t.call(n,e)}function g0(n,t){let e;return Ft(n)?e=n.splice(t,1)[0]:(e=n[t],delete n[t]),e}function R1(n,t){let e={};return e[n]=t,e}function L1(n){for(let t=0;t<n.length;t++)if(!Bn(n[t]))return!1;return!0}function L0(n){let t=Math.sign(n),e=Math.abs(n);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(e))){let w=String(e).toLowerCase().split("e"),_=w.pop(),R=Math.abs(Number(_)),L=Math.sign(Number(_)),X=w[0].split(".");if(L===-1)R-=X[0].length,R<0?e=`${X[0].slice(0,R)}.${X[0].slice(R)}${X.length===2?X[1]:""}`:e=`0.${new Array(R+1).join("0")}${X.join("")}`;else{let z=X[1];z&&(R-=z.length),R<0?e=`${X[0]+z.slice(0,R)}.${z.slice(R)}`:e=X.join("")+new Array(R+1).join("0")}}return t<0?`-${e}`:String(e)}function X0(n){let t=n[0];for(let e=1,u=n.length;e<u;e++)if(!n[e].equals(t))return!1;return!0}function U1(n,t){typeof t!=="function"&&(t=function(w,_){return w===_});let u=[];for(;n.length;){let w=n[0];if(n.length===1){u.push(w);break}let _=[];u.push(w);for(let R=1;R<n.length;R++){let L=n[R];t(w,L)||_.push(L)}n=_}return u}function P1(n,t){let e=n.length,u=[];for(let R=0;R<n.length;R++)u.push([n[R],t[R]]);u.sort((R,L)=>Number(R[0])-Number(L[0]));let w=[],_=[];for(let R=0;R<e;R++)w.push(u[R][0]),_.push(u[R][1]);return[w,_]}var Nn=Gt("DivisionByZero"),Vn=Gt("ParseError"),Xt=Gt("UndefinedError"),an=Gt("OutOfFunctionDomainError"),x1=Gt("MaximumIterationsReached"),En=Gt("NerdamerTypeError"),G0=Gt("ParityError"),A0=Gt("OperatorError"),$1=Gt("OutOfRangeError"),cn=Gt("DimensionError"),Xn=Gt("InvalidVariableNameError"),D1=Gt("ValueLimitExceededError"),Gn=Gt("NerdamerValueError"),F1=Gt("SolveError"),k1=Gt("InfiniteLoopError"),Hn=Gt("UnexpectedTokenError");function fn(n){return n instanceof Rt}function Zn(n){return n instanceof n0}function H0(n,t,e){let w=Object.keys(n)[0];return t?w:e?{key:w,obj:n[w]}:n[w]}var{keys:yn}=Object,Z0={get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP}},It={get _(){return re.parser},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get SQRT(){return re.fnNames.SQRT},get ABS(){return re.fnNames.ABS},get FACTORIAL(){return re.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return re.fnNames.DOUBLEFACTORIAL},get PARENTHESIS(){return re.fnNames.PARENTHESIS},get bigDec(){return re.ext.bigDec},get PRIMES(){return re.ext.PRIMES},get VARS(){return re.state.VARS}};function I0(n){return n.group===Z0.N||n.group===Z0.P}function jn(n){return n.group===Z0.S&&n.multiplier.equals(1)&&n.power.equals(1)}function tn(n){for(let t=0;t<n.length;t++)if(n[t].group!==Z0.N)return!1;return!0}var i0={get RESERVED(){return re.state.RESERVED}};function U0(n){let t=function(e){i0.RESERVED.indexOf(e)===-1&&i0.RESERVED.push(e)};typeof n=="string"?t(n):bn(n,e=>{t(e)})}function B1(n){let t=i0.RESERVED.indexOf(n);t!==-1&&(i0.RESERVED[t]=void 0)}var Pn={get ALLOW_CHARS(){return re.settings?.ALLOW_CHARS??[]},VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function m0(n,t="variable"){if(Pn.ALLOW_CHARS.indexOf(n)!==-1)return;if(!Pn.VALIDATION_REGEX.test(n))throw new Xn(`${n} is not a valid ${t} name`)}function j0(n){return i0.RESERVED.indexOf(n)!==-1}var pn={get WARNINGS(){return re.state.WARNINGS},get SHOW_WARNINGS(){return!(re.settings?.SILENCE_WARNINGS??!0)}};function Mn(n){pn.WARNINGS.push(n),pn.SHOW_WARNINGS&&console&&console.warn&&console.warn(n)}function b1(){return pn.WARNINGS}var V1={get EXPRESSIONS(){return re.state.EXPRESSIONS}};function X1(){return V1.EXPRESSIONS.length}var G1={get Settings(){return re.settings}};function H1(n){return G1.Settings[n]}function Z1(n){try{return m0(n),i0.RESERVED.indexOf(n)===-1}catch(t){if(t.message==="timeout")throw t;return!1}}function j1(n){return n?i0.RESERVED:i0.RESERVED.join(", ")}var zn={get _version(){return re.version},get C(){return re.core}};function z1(n){if(n)try{return zn.C[n].version}catch(t){if(t.message==="timeout")throw t;return`No module named ${n} found!`}return re.version}function W1(){return zn.C}var Q1={get functions(){return re.parser?.functions}};function J1(){return yn(Q1.functions)}var Y1={get CONSTANTS(){return re.parser?.CONSTANTS}};function K1(n){return String(Y1.CONSTANTS[n])}var C0={get VARS(){return re.state.VARS}};function ei(n){return C0.VARS[n]}function ti(n,t){n||="text";let e={};if(n==="object")e=C0.VARS;else for(let u in C0.VARS)Object.hasOwn(C0.VARS,u)&&(n==="latex"?e[u]=C0.VARS[u].latex(t):n==="text"&&(e[u]=C0.VARS[u].text(t)));return e}var Zt={get _(){return re.parser},get C(){return re.core}};function ni(n,t){return Zt._.toTeX(n,t)}function ii(n){return Zt._.getOperator(n)}function ri(n,t){Zt._.aliasOperator(n,t)}function si(n,t){Zt._.setOperator(n,t)}function oi(n,t){Zt._.peekers[n]&&Zt._.peekers[n].push(t)}function li(n,t){let e=Zt._.peekers[n];if(e){let u=e.indexOf(t);u!==-1&&g0(e,u)}}function Wn(n){return Zt._.tree(Zt._.toRPN(Zt._.tokenize(n)))}function ui(n){return String(n).split(";").map(t=>Zt._.parse(t))}function ai(n){return Zt._.tokenize(Zt._.toRPN(n))}function ci(n,t){return`<div class="tree">
    <ul>
        <li>
${Wn(n).toHTML(3,t)}
        </li>
    </ul>
</div>`}function fi(n,t,e){let u=Zt._.functions[n],w=typeof e>"u"?u[1]:e;Zt._.functions[n]=[t(u[0],Zt.C),w]}var Qt={get EXPRESSIONS(){return re.state.EXPRESSIONS},get USER_FUNCTIONS(){return re.state.USER_FUNCTIONS},get LaTeX(){return re.classes.LaTeX},get text(){return re.utils.text},get functions(){return re.parser?.functions??{}},get Math2(){return re.classes.Math2},get _(){return re.parser},get Expression(){return re.classes.Expression}};function pi(n,t,e){let u=n?{}:[];for(let w=0;w<Qt.EXPRESSIONS.length;w++){let _=t?Qt.LaTeX.latex(Qt.EXPRESSIONS[w],e):Qt.text(Qt.EXPRESSIONS[w],e);n?u[w+1]=_:u.push(_)}return u}function hi(n,t){let e=n?{}:[];for(let u=0;u<Qt.USER_FUNCTIONS.length;u++){let w,_,R=Qt.USER_FUNCTIONS[u],L=Qt.functions[R][2];if(L)({params:w,body:_}=L);else{let Z=Qt.Math2[R].toString();[,w]=/\((?<params>.*?)\)/u.exec(Z),w=w.split(",").map(j=>j.trim()),_="{JavaScript}"}let X=`${R}(${w.join(", ")})=${_}`,z=Qt.text(X,t);n?e[u+1]=z:e.push(z)}return e}function gi(n){n=n.replace(/_(?<char>[A-Za-z0-9])/gu,(...e)=>`${e[0]} `),n=n.replace(/\^(?<char>[A-Za-z0-9])/gu,(...e)=>`^{${e[1]}}`),n=n.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`),n=n.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...e)=>`${e[1]}{${e[2]}}`);let t=Qt.LaTeX.parse(Qt._.tokenize(n));return new Qt.Expression(Qt._.parse(t))}var l0={get libExports(){return re.libExports},get VARS(){return re.state.VARS},get _clearFunctions(){return re.utils._clearFunctions},get _initConstants(){return re.parser?.initConstants??(()=>{})},get clear(){return Qn}};function mi(){for(let n in l0.VARS)Object.hasOwn(l0.VARS,n)&&delete l0.VARS[n];return l0.libExports}function di(){return l0._clearFunctions(),l0.libExports}function wi(){return l0.libExports}function Si(){return l0.clear("all"),l0.libExports}function vi(n){return n.call(l0.libExports),l0.libExports}var nn={get libExports(){return re.libExports},get CONSTANTS(){return re.state.CONSTANTS}};function Ni(n,t){if(m0(n),!j0(n))if(t==="delete"||t==="")delete nn.CONSTANTS[n];else{if(isNaN(t))throw new En("Constant must be a number!");nn.CONSTANTS[n]=t}return nn.libExports}var M0={get libExports(){return re.libExports},get VARS(){return re.state.VARS},get CONSTANTS(){return re.state.CONSTANTS},get parse(){let{parser:n}=re;return n?.parse?.bind(n)??(()=>null)},get isSymbol(){return re.utils.isSymbol}};function Ei(n,t){return m0(n),n in M0.CONSTANTS&&xt(`Cannot set value for constant ${n}`),t==="delete"||t===""?delete M0.VARS[n]:M0.VARS[n]=M0.isSymbol(t)?t:M0.parse(t),M0.libExports}var xn={get libExports(){return re.libExports},get _setFunction(){return re.utils._setFunction}};function yi(n,t,e){if(!xn._setFunction(n,t,e))throw new Error("Failed to set function!");return xn.libExports}var S0={get libExports(){return re.libExports},get EXPRESSIONS(){return re.state.EXPRESSIONS}};function Qn(n,t=!1){if(n==="all")S0.EXPRESSIONS.length=0;else if(n==="last")S0.EXPRESSIONS.pop();else if(n==="first")S0.EXPRESSIONS.shift();else{let e=n?n-1:S0.EXPRESSIONS.length;t===!0?S0.EXPRESSIONS[e]=void 0:g0(S0.EXPRESSIONS,e)}return S0.libExports}var b0={get libExports(){return re.libExports},get Settings(){return re.settings},get functions(){return re.parser?.functions??{}}};function Jn(n){let t=b0.libExports.getCore();if(Ft(n))for(let e=0;e<n.length;e++)n&&Jn(n[e]);else if(n&&b0.Settings.exclude.indexOf(n.name)===-1){if(n.dependencies){for(let w=0;w<n.dependencies.length;w++)if(!t[n.dependencies[w]])throw new Error(Tt("{0} requires {1} to be loaded!",n.name,n.dependencies[w]))}let e=n.parent,u=n.build.call(t);if(e){t[e]||(t[n.parent]={});let w=e==="nerdamer"?b0.libExports:t[e];w[n.name]=u}n.visible&&(b0.functions[n.name]=[u,n.numargs])}}var zt={get bigDec(){return re.ext.bigDec},get Settings(){return re.settings},get functions(){return re.parser?.functions??{}},get symfunction(){return re.utils.symfunction},get NerdamerSymbol(){return re.classes.NerdamerSymbol}};function hn(n,t){if(typeof n=="object"&&n!==null){let u=n;for(let w in u)Object.hasOwn(u,w)&&hn(w,u[w])}["SAFE"].indexOf(n)!==-1&&xt(`Cannot modify setting: ${n}`),n==="PRECISION"?(zt.bigDec.set({precision:t}),zt.Settings.PRECISION=t,t>21&&hn("USE_BIG",!0)):n==="USE_LN"&&t===!0?(zt.Settings.LOG="LN",zt.Settings.LOG10="log",zt.functions.log=zt.Settings.LOG_FNS.log10,zt.functions.log[0]=function(w){return w.isConstant()?new zt.NerdamerSymbol(Math.log10(w)):zt.symfunction(zt.Settings.LOG10,[w])},zt.functions.LN=zt.Settings.LOG_FNS.log,delete zt.functions.log10):zt.Settings[n]=t}var _0={get libExports(){return re.libExports},get functions(){return re.parser?.functions??{}},get parse(){let{parser:n}=re;return n?.parse?.bind(n)??(()=>null)},get callfunction(){return re.utils.callfunction},get Expression(){return re.classes.Expression}};function Mi(n=!1){let t=function(u){return function(..._){for(let R=0;R<_.length;R++)_[R]=_0.parse(_[R]);return new _0.Expression(bt("PARSE2NUMBER",()=>_0.callfunction(u,_)))}};for(let e in _0.functions)(!(e in _0.libExports)||n)&&(_0.libExports[e]=t(e))}var _i={get suppress_errors(){return re.settings?.suppress_errors??!1}};function xt(n,t=void 0){if(!_i.suppress_errors)throw t?new t(n):new Error(n)}var Ai={get PRIMES_SET(){return re.ext.PRIMES_SET}};function R0(n){if(n in Ai.PRIMES_SET)return!0;let t=Math.floor(Math.sqrt(n));for(let e=2;e<=t;e++)if(n%e===0)return!1;return!0}var E0={starttime:0,timeout:0,get TIMEOUT(){return re.settings?.TIMEOUT??800}};function Yn(){E0.starttime=Date.now(),E0.timeout=E0.TIMEOUT}function Kn(){E0.starttime=0}function z0(){if(E0.starttime!==0&&Date.now()>E0.starttime+E0.timeout)throw new Error("timeout")}var N0={get PRIMES(){return re.ext.PRIMES},get PRIMES_SET(){return re.ext.PRIMES_SET}};function Ci(n){if(z0(),R0(n))return[n];let t=n,e=1,u=[],w=2220446049250313e-31;for(;e<t;){z0();let _=n/e,R=Math.floor(_);if(_-R<=w&&e>1){if(R0(e)&&(N0.PRIMES_SET[e]||(N0.PRIMES.push(e),N0.PRIMES_SET[e]=!0),u.push(e)),R0(R)){u.push(R);break}t=R}e++}return u.sort((_,R)=>_-R)}function e1(n){let t=N0.PRIMES[N0.PRIMES.length-1]||2;for(let e=t;e<n;e++)R0(e)&&N0.PRIMES.push(e),N0.PRIMES_SET[e]=!0}var rn={get Settings(){return re.settings}};function bt(n,t,e=void 0,u=void 0){let w=rn.Settings[n];rn.Settings[n]=e===void 0?!0:!!e;let _=t.call(u);return rn.Settings[n]=w,_}function vt(n,t=void 0){return bt("PARSE2NUMBER",()=>It._.parse(n,t),!0)}var mt={get EXPRESSIONS(){return re.state.EXPRESSIONS},get Settings(){return re.settings},get LaTeX(){return re.classes.LaTeX},get text(){return re.utils.text},get variables(){return re.utils.variables},get isVector(){return re.utils.isVector},get isSymbol(){return re.utils.isSymbol},get isExpression(){return re.utils.isExpression},get isNumericSymbol(){return re.utils.isNumericSymbol},get isFraction(){return re.utils.isFraction},get isArray(){return re.utils.isArray},get _(){return re.parser},get Build(){return re.classes.Build}};function Bt(n){this.symbol=n}Bt.getExpression=function(t,e=void 0){(t==="last"||!t)&&(t=mt.EXPRESSIONS.length),t==="first"&&(t=1);let u=Number(t)-1,w=mt.EXPRESSIONS[u];return w&&new Bt(w)};Bt.prototype={text(n="decimals",t=void 0){t||=mt.Settings.EXPRESSION_DECP;let e=this.symbol;return e.text_?e.text_(n):mt.text(this.symbol,n,void 0,t)},latex(n){return this.symbol.latex?this.symbol.latex(n):mt.LaTeX.latex(this.symbol,n)},valueOf(){return this.symbol.valueOf()},evaluate(...n){if(mt.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let t=n[0],e,u=1;typeof t=="string"?e=t.charAt(0)==="%"?Bt.getExpression(t.substr(1)).text():t:t instanceof Bt||mt.isSymbol(t)?e=t.text():(e=this.symbol.text(),u--);let w=n[u]||{};return new Bt(bt("PARSE2NUMBER",()=>mt._.parse(e,w),!0))},buildFunction(n){return mt.Build.build(this.symbol,n)},isNumber(){return mt.isNumericSymbol(this.symbol)},isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0},isImaginary(){return vt(mt._.parse(this.symbol)).isImaginary()},variables(){return mt.variables(this.symbol)},toString(){try{return mt.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(n){if(n.message==="timeout")throw n;return""}},toDecimal(n){mt.Settings.precision=n;let t=mt.text(this.symbol,"decimals");return mt.Settings.precision=void 0,t},isFraction(){return mt.isFraction(this.symbol)},isPolynomial(){return this.symbol.isPoly()},sub(n,t){return new Bt(this.symbol.sub(mt._.parse(n),mt._.parse(t)))},operation(n,t){return mt.isExpression(t)?t=t.symbol:mt.isSymbol(t)||(t=mt._.parse(t)),new Bt(mt._[n](this.symbol.clone(),t.clone()))},add(n){return this.operation("add",n)},subtract(n){return this.operation("subtract",n)},multiply(n){return this.operation("multiply",n)},divide(n){return this.operation("divide",n)},pow(n){return this.operation("pow",n)},expand(){return new Bt(mt._.expand(this.symbol))},each(n,t){if(this.symbol.each)this.symbol.each(n,t);else if(mt.isArray(this.symbol))for(let e=0;e<this.symbol.length;e++)n.call(this.symbol,this.symbol[e],e);else n.call(this.symbol)},eq(n){mt.isSymbol(n)||(n=mt._.parse(n));try{return mt._.subtract(this.symbol.clone(),n).equals(0)}catch(t){if(t.message==="timeout")throw t;return!1}},lt(n){mt.isSymbol(n)||(n=mt._.parse(n));try{return vt(mt._.subtract(this.symbol.clone(),n)).lessThan(0)}catch(t){if(t.message==="timeout")throw t;return!1}},gt(n){mt.isSymbol(n)||(n=mt._.parse(n));try{return vt(mt._.subtract(this.symbol.clone(),n)).greaterThan(0)}catch(t){if(t.message==="timeout")throw t;return!1}},gte(n){return this.gt(n)||this.eq(n)},lte(n){return this.lt(n)||this.eq(n)},numerator(){return new Bt(this.symbol.getNum())},denominator(){return new Bt(this.symbol.getDenom())},hasFunction(n){return this.symbol.containsFunction(n)},contains(n){return this.symbol.contains(n)}};Bt.prototype.toTeX=Bt.prototype.latex;re.classes.Expression=Bt;var ht={get _(){return re.parser},get Settings(){return re.settings},get LaTeX(){return re.classes.LaTeX}};function wt(n,...t){this.multiplier=new ke(1),St(n)?this.elements=n.elements?.slice(0)??[]:Ft(n)?this.elements=n.slice(0):dt(n)?n.elements.length===1?(this.elements=[...n.elements[0]],this.rowVector=!0):n.elements.length>1&&Array.isArray(n.elements[0])&&n.elements[0].length===1&&(this.elements=n.elements.map(e=>e[0]),this.rowVector=!1):typeof n>"u"?this.elements=[]:this.elements=[n,...t]}wt.arrayPrefill=function(t,e){let u=[];e||=0;for(let w=0;w<t;w++)u[w]=e;return u};wt.fromArray=function(t){let e=new wt;return e.elements=t,e};wt.fromSet=function(t){return wt.fromArray(t.elements)};wt.prototype={custom:!0,e(n){return n<1||n>this.elements.length?null:this.elements[n-1]},set(n,t){ct(t)||(t=new P(t)),this.elements[n]=t},dimensions(){return this.elements.length},modulus(){return bt("SAFE",()=>ht._.pow(this.dot(this.clone()),new P(.5)),void 0,this)},eql(n){let t=this.elements.length,e=n.elements||n;if(t!==e.length)return!1;do if(Math.abs(ht._.subtract(this.elements[t-1],e[t-1]).valueOf())>ht.Settings.PRECISION)return!1;while(--t);return!0},clone(){let n=new wt,t=this.elements.length;for(let e=0;e<t;e++)n.elements.push(this.elements[e].clone());return n.rowVector=this.rowVector,n},expand(n){return this.elements=this.elements.map(t=>ht._.expand(t,n)),this},map(n){let t=[];return this.each((e,u)=>{t.push(n(e,u))}),new wt(t)},each(n){let t=this.elements.length,e=t,u;do u=e-t,n(this.elements[u],u+1);while(--t)},toUnitVector(){return bt("SAFE",()=>{let n=this.modulus();return n.valueOf()===0?this.clone():this.map(t=>ht._.divide(t,n))},void 0,this)},angleFrom(n){return bt("SAFE",()=>{let t=n.elements||n;if(this.elements.length!==t.length)return null;let u=new P(0),w=new P(0),_=new P(0);this.each((z,Z)=>{u=ht._.add(u,ht._.multiply(z,t[Z-1])),w=ht._.add(w,ht._.multiply(z,z)),_=ht._.add(_,ht._.multiply(t[Z-1],t[Z-1]))}),w=ht._.pow(w,new P(.5)),_=ht._.pow(_,new P(.5));let R=ht._.multiply(w,_);if(R.valueOf()===0)return null;let L=ht._.divide(u,R),X=L.valueOf();return X<-1&&(L=-1),X>1&&(L=1),new P(Math.acos(L))},void 0,this)},isParallelTo(n){let t=this.angleFrom(n).valueOf();return t===null?null:t<=ht.Settings.PRECISION},isAntiparallelTo(n){let t=this.angleFrom(n).valueOf();return t===null?null:Math.abs(t-Math.PI)<=ht.Settings.PRECISION},isPerpendicularTo(n){let t=this.dot(n);return t===null?null:Math.abs(t)<=ht.Settings.PRECISION},add(n){return bt("SAFE",()=>{let t=n.elements||n;return this.elements.length!==t.length?null:this.map((e,u)=>ht._.add(e,t[u-1]))},void 0,this)},subtract(n){return bt("SAFE",()=>{let t=n.elements||n;return this.elements.length!==t.length?null:this.map((e,u)=>ht._.subtract(e,t[u-1]))},void 0,this)},multiply(n){return this.map(t=>t.clone()*n.clone())},x(n){return this.multiply(n)},dot(n){return bt("SAFE",()=>{let t=n.elements||n,e=new P(0),u=this.elements.length;if(u!==t.length)return null;do e=ht._.add(e,ht._.multiply(this.elements[u-1],t[u-1]));while(--u);return e},void 0,this)},cross(n){let t=n.elements||n;if(this.elements.length!==3||t.length!==3)return null;let e=this.rowVector&&n.rowVector,u=this.elements;return bt("SAFE",()=>{let w=new wt([ht._.subtract(ht._.multiply(u[1],t[2]),ht._.multiply(u[2],t[1])),ht._.subtract(ht._.multiply(u[2],t[0]),ht._.multiply(u[0],t[2])),ht._.subtract(ht._.multiply(u[0],t[1]),ht._.multiply(u[1],t[0]))]);return w.rowVector=e,w},void 0,this)},toUnitMultiplier(){return this},max(){let n=0,t=this.elements.length,e=t,u;do u=e-t,Math.abs(this.elements[u].valueOf())>Math.abs(n.valueOf())&&(n=this.elements[u]);while(--t);return n},magnitude(){let n=new P(0);return this.each(t=>{n=ht._.add(n,ht._.pow(t,new P(2)))}),ht._.sqrt(n)},indexOf(n){let t=null,e=this.elements.length,u=e,w;do w=u-e,t===null&&this.elements[w].valueOf()===n.valueOf()&&(t=w+1);while(--e);return t},text_(n,t){let e=Vt(this,t);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},text(n,t){let e=Vt(this,t);return(this.rowVector?"[":"")+e+(this.rowVector?"]":"")},toString(){return this.text()},latex(n){let t=[];for(let e=0;e<this.elements.length;e++)t.push(ht.LaTeX.latex(this.elements[e],n));return`[${t.join(", ")}]`}};re.classes.Vector=wt;var Ht={get _(){return re.parser},get LaTeX(){return re.classes.LaTeX}};function ot(...n){this.multiplier=new ke(1);let t=n,e=t.length,u,w=[];if(dt(t))for(u=0;u<e;u++)w.push(t[u].slice(0));else{let _,R,L;for(u=0;u<e;u++)_=t[u],St(_)&&(_=_.elements),Ft(_)||(_=[_]),L=_.length,R&&R!==L&&xt("Unable to create Matrix. Row dimensions do not match!"),w.push(_),R=L}this.elements=w}ot.identity=function(t){let e=new ot;for(let u=0;u<t;u++){e.elements.push([]);for(let w=0;w<t;w++)e.set(u,w,u===w?new P(1):new P(0))}return e};ot.fromArray=function(t){function e(u){return ot.apply(this,u)}return e.prototype=ot.prototype,new e(t)};ot.zeroMatrix=function(t,e){let u=new ot;for(let w=0;w<t;w++)u.elements.push(wt.arrayPrefill(e,new P(0)));return u};ot.prototype={custom:!0,get(n,t){if(this.elements[n])return this.elements[n][t]},map(n,t){let e=new ot;return this.each((u,w,_)=>{e.set(w,_,n.call(e,u),t)}),e},set(n,t,e,u){this.elements[n]||=[],u||ct(e)?this.elements[n][t]=e:this.elements[n][t]=new P(e)},cols(){return this.elements[0].length},rows(){return this.elements.length},row(n){return!n||n>this.cols()?[]:this.elements[n-1]},col(n){let t=this.rows(),e=[];if(n>this.cols()||!n)return e;for(let u=0;u<t;u++)e.push(this.elements[u][n-1]);return e},eachElement(n){let t=this.rows(),e=this.cols(),u,w;for(u=0;u<t;u++)for(w=0;w<e;w++)n.call(this,this.elements[u][w],u,w)},determinant(){if(!this.isSquare())return null;let n=this.toRightTriangular(),t=n.elements[0][0],e=n.elements.length-1,u=e,w;do w=u-e+1,t=Ht._.multiply(t,n.elements[w][w]);while(--e);return t},isSquare(){return this.elements.length===this.elements[0].length},isSingular(){return this.isSquare()&&this.determinant()===0},augment(n){let t=this.rows(),e=n.rows();t!==e&&xt("Cannot augment matrix. Rows don't match.");for(let u=0;u<t;u++)this.elements[u]=this.elements[u].concat(n.elements[u]);return this},clone(){let n=this.rows(),t=this.cols(),e=new ot;for(let u=0;u<n;u++){e.elements[u]=[];for(let w=0;w<t;w++){let _=this.elements[u][w];e.elements[u][w]=ct(_)?_.clone():_}}return e},toUnitMultiplier(){return this},expand(n){return this.eachElement(t=>Ht._.expand(t,n)),this},evaluate(n){return this.eachElement(t=>Ht._.evaluate(t,n)),this},invert(){return this.isSquare()||xt("Matrix is not square!"),bt("SAFE",()=>{let n=this.elements.length,t=n,e,u,w=ot.identity(n),_=this.augment(w).toRightTriangular(),R,L=_.elements[0].length,X,z,Z,j=[],Ee;do{e=n-1,z=[],R=L,j[e]=[],Z=_.elements[e][e];do X=L-R,Ee=Ht._.divide(_.elements[e][X],Z.clone()),z.push(Ee),X>=t&&j[e].push(Ee);while(--R);for(_.elements[e]=z,u=0;u<e;u++){z=[],R=L;do X=L-R,z.push(Ht._.subtract(_.elements[u][X].clone(),Ht._.multiply(_.elements[e][X].clone(),_.elements[u][e].clone())));while(--R);_.elements[u]=z}}while(--n);return ot.fromArray(j)},void 0,this)},toRightTriangular(){return bt("SAFE",()=>{let n=this.clone(),t,e,u,w=this.elements.length,_=w,R,L,X=this.elements[0].length,z;do{if(R=_-w,e=n.elements[R][R],e.valueOf()===0){for(let Z=R+1;Z<_;Z++)if(u=n.elements[Z][R],u&&u.valueOf()!==0){t=[],L=X;do z=X-L,t.push(Ht._.add(n.elements[R][z].clone(),n.elements[Z][z].clone()));while(--L);n.elements[R]=t;break}}if(e=n.elements[R][R],e.valueOf()!==0)for(let Z=R+1;Z<_;Z++){let j=Ht._.divide(n.elements[Z][R].clone(),n.elements[R][R].clone());t=[],L=X;do z=X-L,t.push(z<=R?new P(0):Ht._.subtract(n.elements[Z][z].clone(),Ht._.multiply(n.elements[R][z].clone(),j.clone())));while(--L);n.elements[Z]=t}}while(--w);return n},void 0,this)},transpose(){let n=this.elements.length,t=this.elements[0].length,e=new ot,u=t,w,_,R;do{w=t-u,e.elements[w]=[],_=n;do R=n-_,e.elements[w][R]=this.elements[R][w].clone();while(--_)}while(--u);return e},canMultiplyFromLeft(n){let t=dt(n)?n.elements.length:n.length;return this.elements[0].length===t},sameSize(n){return this.rows()===n.rows()&&this.cols()===n.cols()},multiply(n){return bt("SAFE",()=>{let t=n.elements||n;if(!this.canMultiplyFromLeft(t)){if(this.sameSize(n)){let Ne=new ot,Re=this.rows();for(let ie=0;ie<Re;ie++){let fe=Ht._.multiply(new wt(this.elements[ie]),new wt(n.elements[ie]));Ne.elements[ie]=fe.elements}return Ne}return null}let e=this.elements.length,u=e,w,_,R=t[0].length,L,X=this.elements[0].length,z=[],Z,j,Ee;do{w=u-e,z[w]=[],_=R;do{L=R-_,Z=new P(0),j=X;do Ee=X-j,Z=Ht._.add(Z,Ht._.multiply(this.elements[w][Ee],t[Ee][L]));while(--j);z[w][L]=Z}while(--_)}while(--e);return ot.fromArray(z)},void 0,this)},add(n,t){let e=new ot;return this.sameSize(n)&&this.eachElement((u,w,_)=>{let R=Ht._.add(u.clone(),n.elements[w][_].clone());t&&(R=t.call(e,R,u,n.elements[w][_])),e.set(w,_,R)}),e},subtract(n,t){let e=new ot;return this.sameSize(n)&&this.eachElement((u,w,_)=>{let R=Ht._.subtract(u.clone(),n.elements[w][_].clone());t&&(R=t.call(e,R,u,n.elements[w][_])),e.set(w,_,R)}),e},negate(){return this.each(n=>n.negate()),this},toVector(){if(this.rows()===1||this.cols()===1){let n=new wt;return n.elements=this.elements,n}return this},toString(n,t){let e=this.rows(),u=[];n=n===void 0?`
`:n;for(let w=0;w<e;w++)u.push(`[${this.elements[w].map(_=>{let R=t?_.multiplier.toDecimal():_.toString();return _===void 0?"":R}).join(",")}]`);return`matrix${_t(u.join(","))}`},text(){return`matrix(${this.elements.map(n=>`[${n.toString("")}]`)})`},latex(n){let t=this.cols(),{elements:e}=this;return Tt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let u=[];for(let w in e){if(!Object.hasOwn(e,w))continue;let _=[];for(let R=0;R<t;R++)_.push(Ht.LaTeX.latex(e[w][R],n));u.push(_.join(" & "))}return u.join(" \\cr ")})}};ot.prototype.each=ot.prototype.eachElement;re.classes.Matrix=ot;var sn={get _(){return re.parser},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get CB(){return re.groups.CB},get Math2(){return re.classes.Math2}},e0={dependencies:{},reformat:{},initDependencies(){this.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":Ye.gamma},gamma_incomplete:{"Math2.factorial":Ye.factorial},Li:{"Math2.Ei":Ye.Ei,"Math2.bigLog":Ye.bigLog,Frac:ke},Ci:{"Math2.factorial":Ye.factorial},Ei:{"Math2.factorial":Ye.factorial},Si:{"Math2.factorial":Ye.factorial},Shi:{"Math2.factorial":Ye.factorial},Chi:{isInt:ft,nround:h0,"Math2.num_integrate":Ye.num_integrate},factor:{"Math2.ifactor":Ye.ifactor,NerdamerSymbol:P},num_integrate:{"Math2.simpson":Ye.simpson,nround:h0},fib:{even:Pt}},this.reformat={diff(n,t){let e=n.args[1].toString(),u=`let f = ${e0.build(n.args[0].toString(),[e])};`,w=Ye.diff.toString();return!w.startsWith("function")&&!w.startsWith("(")&&!w.startsWith("async")&&(w=`function ${w}`),t[1]+=`let diff = ${w};`,t[1]+=u,[`diff(f)(${e})`,t]}}},getProperName(n){return{continuedFraction:"continuedFraction"}[n]||n},compileDependencies(n,t){let e=e0.dependencies[n],u=t&&t[1]?t[1]:"",w=t&&t[0]?t[0]:{};for(let _ in e){if(typeof e[_]=="object")continue;let R=_.split("."),L=e[_];if(typeof L=="function"){let X=L.toString();!X.startsWith("function")&&!X.startsWith("(")&&!X.startsWith("async")&&(X=`function ${X}`),L=X}u+=`let ${R.length>1?R[1]:R[0]}=${L};`,w[_]=R.pop()}return[w,u]},getArgsDeps(n,t){let{args:e}=n,u=t,w=function(_){_.group===sn.FN&&(u=e0.compileDependencies(_.fname,u))};for(let _=0;_<e.length;_++)n.args[_].each(w);return u},build(n,t){let{_:e,FN:u,N:w,S:_,P:R,EX:L,CB:X}=sn;n=bt("PARSE2NUMBER",()=>e.parse(n),!0);let z=t0(n),Z=[],j=[],Ee=function(ie,fe){ie.fname===""&&(ie=P.unwrapPARENS(ie)),fe||=[];let g=[],{group:H}=ie,de="",Oe=function(qe){let Se=qe===X?"*":"+",K=[];for(let p in ie.symbols){if(!Object.hasOwn(ie.symbols,p))continue;let o=ie.symbols[p],f=Ee(o,fe)[0];o.isComposite()&&(f=_t(f)),K.push(f)}let l=K.join(Se);return l=l&&!ie.multiplier.equals(1)?_t(l):l,l},ve=function(qe){let Se;if(qe in Math)Se=`Math.${qe}`;else{if(qe=e0.getProperName(qe),Z.indexOf(qe)===-1){let K=sn.Math2[qe].toString();!K.startsWith("function")&&!K.startsWith("(")&&!K.startsWith("async")&&(K=`function ${K}`),fe.push(`let ${qe} = ${K}; `),Z.push(qe)}Se=qe}return Se+=_t(ie.args.map(K=>Ee(K,fe)[0]).join(",")),Se};H===w?g.push(ie.multiplier.toDecimal()):ie.multiplier.equals(-1)?de="-":ie.multiplier.equals(1)||g.push(ie.multiplier.toDecimal());let we;if(H===_||H===R)we=ie.value;else if(H===u)if(j=e0.compileDependencies(ie.fname,j),j=e0.getArgsDeps(ie,j),e0.reformat[ie.fname]){let qe=e0.reformat[ie.fname](ie,j);j=qe[1],we=qe[0]}else we=ve(ie.fname);else if(H===L){let qe=ie.previousGroup;qe===w||qe===_?we=ie.value:qe===u?(we=ve(ie.fname),j=e0.compileDependencies(ie.fname,j),j=e0.getArgsDeps(ie,j)):we=Oe(ie.previousGroup)}else we=Oe(ie.group);if(ie.group!==w&&!ie.power.equals(1)){let qe=Ee(e.parse(ie.power));fe.push(qe[1]),we=`Math.pow${_t(`${we},${qe[0]}`)}`}return we&&g.push(de+we),[g.join("*"),fe.join("").replace(/\n+\s+/gu," ")]};t&&(z=t);let Ne=Ee(n);for(let ie in j[0]){if(!Object.hasOwn(j[0],ie))continue;let fe=j[0][ie];Ne[1]=Ne[1].replace(ie,fe),j[1]=j[1].replace(ie,fe)}return new Function(...z,`${(j[1]||"")+Ne[1]} return ${Ne[0]};`)}};re.classes.Build=e0;var s0={get _(){return re.parser},get Settings(){return re.settings},get SQRT(){return re.fnNames.SQRT},get ABS(){return re.fnNames.ABS},get PARENTHESIS(){return re.fnNames.PARENTHESIS},get FACTORIAL(){return re.fnNames.FACTORIAL},get DOUBLEFACTORIAL(){return re.fnNames.DOUBLEFACTORIAL},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get EX(){return re.groups.EX},get FN(){return re.groups.FN},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get Parser(){return re.classes.Parser}},Nt={parser:null,space:"~",dot:" \\cdot ",latex(n,t){let{_:e,P:u,CB:w}=s0;if(n.clone&&(n=n.clone()),n instanceof e.classes.Collection&&(n=n.elements),Ft(n)){let ie=[];for(let fe=0;fe<n.length;fe++){let g=n[fe];ct(g)||(g=e.parse(g)),ie.push(this.latex(g,t))}return this.brackets(ie.join(", "),"square")}if(dt(n)){let ie=`\\begin{pmatrix}
`;for(let fe=0;fe<n.elements.length;fe++){let g=[],H=n.elements[fe];for(let de=0;de<H.length;de++)g.push(this.latex(H[de],t));ie+=g.join(" & "),fe<n.elements.length-1&&(ie+=`\\\\
`)}return ie+="\\end{pmatrix}",ie}if(St(n)){let ie="\\left[";for(let fe=0;fe<n.elements.length;fe++)ie+=`${this.latex(n.elements[fe],t)} ${fe===n.elements.length-1?"":",\\,"}`;return ie+="\\right]",ie}if(Zn(n)){let ie="\\{";for(let fe=0;fe<n.elements.length;fe++)ie+=`${this.latex(n.elements[fe],t)} ${fe===n.elements.length-1?"":",\\,"}`;return ie+="\\}",ie}n=n.clone();let _=t==="decimal"||t==="decimals",{power:R}=n,L=W0(R),X=n.multiplier.lessThan(0);if(n.group===u&&_)return String(n.multiplier.toDecimal()*n.value**n.power.toDecimal());n.multiplier=n.multiplier.abs();let z;_?z=[String(n.multiplier.toDecimal()),""]:z=[n.multiplier.num,n.multiplier.den];let Z=this.value(n,L,t,X),j;L&&R.negate(),_?(j=ct(R)?Nt.latex(R,t):String(R.toDecimal()),String(j)==="1"&&(j="")):ct(R)?j=this.latex(R,t):j=this.formatFrac(R,!0);let Ee=["",""],Ne=L?1:0;return Ee[Ne]=j,((X?"-":"")+this.set(z,Z,Ee,n.group===w)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(n,t,e,u){let{SQRT:w,ABS:_,PARENTHESIS:R,FACTORIAL:L,DOUBLEFACTORIAL:X,FN:z,S:Z,P:j,N:Ee,CB:Ne,CP:Re,EX:ie}=s0,{group:fe}=n,{previousGroup:g}=n,H=["",""],de=t?1:0;if(n.isInfinity)H[de]="\\infty";else if(fe===Z||fe===j||g===Z||g===j||g===Ee){let Oe=this.formatSubscripts(n.value);Oe.replace&&(Oe=Oe.replace(/(?<prefix>.+)_$/u,"$1\\_"));let ve=String(Oe).split("_"),we=this.greek[ve[0]];we&&(ve[0]=we,Oe=ve.join("_"));let qe=this.symbols[ve[0]];qe&&(ve[0]=qe,Oe=ve.join("_")),H[de]=Oe}else if(fe===z||g===z){let Oe=[],{fname:ve}=n;for(let we=0;we<n.args.length;we++){let qe=n.args[we],Se;typeof qe=="string"?Se=qe:Se=this.latex(qe,e),Oe.push(Se)}if(ve===w)H[de]=`\\sqrt${this.braces(Oe.join(","))}`;else if(ve===_)H[de]=this.brackets(Oe.join(","),"abs");else if(ve===R)H[de]=this.brackets(Oe.join(","),"parens");else if(ve==="limit")H[de]=` \\lim\\limits_{${Oe[1]} \\to ${Oe[2]}} ${Oe[0]}`;else if(ve==="integrate")H[de]=`\\int${this.braces(Oe[0])}${this.braces(`d${Oe[1]}`)}`;else if(ve==="defint")H[de]=`\\int\\limits_${this.braces(Oe[1])}^${this.braces(Oe[2])} ${Oe[0]} d${Oe[3]}`;else if(ve===L||ve===X){let we=n.args[0];we.power.equals(1)&&(we.isComposite()||we.isCombination())&&(Oe[0]=this.brackets(Oe[0])),H[de]=Oe[0]+(ve===L?"!":"!!")}else if(ve==="floor")H[de]=`\\left \\lfloor${this.braces(Oe[0])}\\right \\rfloor`;else if(ve==="ceil")H[de]=`\\left \\lceil${this.braces(Oe[0])}\\right \\rceil`;else if(ve===s0.Settings.LOG&&Oe.length>1)H[de]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces(Oe[1])}${this.brackets(Oe[0])}`;else if(ve===s0.Settings.LOG10)H[de]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("10")}${this.brackets(Oe[0])}`;else if(ve===s0.Settings.LOG2)H[de]=`\\mathrm${this.braces(s0.Settings.LOG)}_${this.braces("2")}${this.brackets(Oe[0])}`;else if(ve===s0.Settings.LOG1P)H[de]=`\\ln${this.brackets(`1 + ${Oe[0]}`)}`;else if(ve==="sum"){let we=Oe[0],qe=Oe[1],Se=Oe[2],K=Oe[3];H[de]=`\\sum\\limits_{${this.braces(qe)}=${this.braces(Se)}}^${this.braces(K)} ${this.braces(we)}`}else if(ve==="product"){let we=Oe[0],qe=Oe[1],Se=Oe[2],K=Oe[3];H[de]=`\\prod\\limits_{${this.braces(qe)}=${this.braces(Se)}}^${this.braces(K)} ${this.braces(we)}`}else if(ve==="nthroot")H[de]=`\\sqrt[${Oe[1]}]${this.braces(Oe[0])}`;else if(ve==="mod")H[de]=`${Oe[0]} \\bmod ${Oe[1]}`;else if(ve==="realpart")H[de]=`\\operatorname{Re}${this.brackets(Oe[0])}`;else if(ve==="imagpart")H[de]=`\\operatorname{Im}${this.brackets(Oe[0])}`;else{let we=ve===""?"":`\\mathrm${this.braces(ve.replace(/_/gu,"\\_"))}`;n.isConversion?H[de]=we+this.brackets(Oe.join(""),"parens"):H[de]=we+this.brackets(Oe.join(","),"parens")}}else if(n.isComposite()){let Oe=n.collectSymbols().sort(fe===Re||g===Re?(Se,K)=>K.group-Se.group:(Se,K)=>{let l=ct(Se.power)?-1:Se.power;return(ct(K.power)?-1:K.power)-l}),ve=[],we=Oe.length;for(let Se=0;Se<we;Se++)ve.push(Nt.latex(Oe[Se],e));let qe=ve.join("+");H[de]=!(n.isLinear()&&n.multiplier.equals(1))||u?this.brackets(qe,"parens"):qe}else if(fe===Ne||g===ie||g===Ne){fe===Ne&&n.distributeExponent();let Oe=[],ve=[],we=[],qe=[],Se=0,K=0,l=function(p,o,f){if(f>1&&o.length>0){let m=o.length;for(let S=0;S<m;S++){let M=o[S],V=p[M];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(V)||/^\\left\(.+\\right\)$/gu.test(V)||(p[M]=Nt.brackets(V,"parens"))}}return p};n.each(p=>{let o=W0(p.power),f;o?(f=Nt.latex(p.invert(),e),K++,p.isComposite()&&(!n.multiplier.den.equals(1)&&Math.abs(p.power)===1&&(f=Nt.brackets(f,"parens")),we.push(Oe.length)),Oe.push(f)):(f=Nt.latex(p,e),Se++,p.isComposite()&&(!n.multiplier.num.equals(1)&&Math.abs(p.power)===1&&(f=Nt.brackets(f,"parens")),qe.push(ve.length)),ve.push(f))}),l(ve,qe,Se),H[0]=ve.join(this.dot),l(Oe,we,K),H[1]=Oe.join(this.dot)}return H},set(n,t,e,u){let w=function(Ee){return/^\\left\(.+\\right\)$/u.test(Ee)};e&&=this.formatP(e);let _;u&&(_=e[0],e[0]=""),t=this.merge(t,e);let R=n[0],L=n[1],X=t[0],z=t[1];X&&Number(R)===1&&(R=""),Number(L)===1&&(L="");let Z=this.join(R,X,w(X)?"":this.dot),j=this.join(L,z,w(z)?"":this.dot);if(Z&&j){let Ee=this.frac(Z,j);return u&&_&&(Ee=this.brackets(Ee)+_),Ee}return Z},merge(n,t){let e=[];for(let u=0;u<2;u++)e[u]=n[u]+t[u];return e},join(n,t,e){return!n&&!t?"":n&&!t?n:t&&!n?t:n+e+t},formatSubscripts(n){let t=n.toString().split("_"),e="";for(;t.length>1;)t.length>0&&(e=`_${this.braces(t.pop()+e)}`);return t[0]+e},formatP(n){for(let t=0;t<2;t++){let e=n[t];e&&(n[t]=`^${this.braces(e)}`)}return n},formatFrac(n,t){let e=n.num.toString(),u=n.den.toString();return t&&e==="1"&&u==="1"?"":u==="1"?e:this.frac(e,u)},frac(n,t){return`\\frac${this.braces(n)}${this.braces(t)}`},braces(n){return`{${n}}`},brackets(n,t){t||="parens";let u={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[t];return`\\left${u[0]}${n}\\right${u[1]}`},filterTokens(n){let t=[];Ft(n)&&(t.type=n.type);let e=["\\","left","right","big","Big","large","Large"];for(let u=0,w=n.length;u<w;u++){let _=n[u],R=n[u+1];_.value==="\\"&&R.value==="\\"?t.push(_):Ft(_)?t.push(Nt.filterTokens(_)):e.indexOf(_.value)===-1&&t.push(_)}return t},parse(n){let{SQRT:t}=s0,e,u,w="",_=this.filterTokens(n),R={cdot:"",times:"",infty:"Infinity"},L=function(Z){return _[typeof Z>"u"?++e:e+=Z]},X=function(){return Nt.parse(L())},z=function(Z){return Z in R?R[Z]:Z==="*"&&_[e+1].value==="&"?(L(2),","):Z==="&"?(L(),","):Z==="\\"?"],[":Z};for(e=0,u=_.length;e<u;e++){let Z=_[e];if(Z.value==="frac"){let j=X(),Ee=X();w+=`${j}/${Ee}`}else if(Z.value in Nt.symbols)if(Z.value===t&&_[e+1].type==="vector"&&_[e+2].type==="NerdamerSet"){let j=X(),Ee=X();w+=`${Ee}^${_t(`1/${j}`)}`}else w+=Z.value+X();else if(Z.value==="int"){let j=X();e++;let Ee=L().value;Ee=z(Ee.substring(1,Ee.length)),w+=`integrate${_t(`${j},${Ee}`)}`}else if(Z.value==="int_"){let j=X();e++;let Ee=L().value;Ee===void 0&&(e--,Ee=X());let Ne=X(),Re=L().value;Re===","&&(Re=L().value),Re==="differentialD"&&(e++,Re=L().value),Re==="mathrm"&&(e++,Re=L().value),w+=`defint${_t(`${Ne},${j},${Ee},${Re}`)}`}else if(Z.value&&Z.value.startsWith("int_")){let j=Z.value.replace("int_","");e++;let Ee=L().value;Ee===void 0&&(e--,Ee=X());let Ne=X(),Re=L().value;Re===","&&(Re=L().value),Re==="differentialD"&&(e++,Re=L().value),Re==="mathrm"&&(e++,Re=L().value),w+=`defint${_t(`${Ne},${j},${Ee},${Re}`)}`}else if(Z.value==="mathrm"){let j=_[++e][0].value;w+=j+X()}else if(Z.value==="sum_"||Z.value==="prod_"){let j=Z.value==="sum_"?"sum":"product",Ee=L();e++;let Ne=X(),Re=X();w+=j+_t([Re,z(Ee[0]),z(Ee[2]),z(Ne)].join(","))}else if(Z.value==="lim_"){let j=L();w+=`limit${_t([X(),z(j[0]),z(j[2])].join(","))}`}else if(Z.value==="begin"){let j=L();Array.isArray(j)&&j[0].value==="matrix"&&(w+="matrix([")}else if(Z.value==="end"){let j=L();Array.isArray(j)&&j[0].value==="matrix"&&(w+="])")}else Array.isArray(Z)?w+=z(Nt.parse(Z)):w+=z(Z.value.toString())}return _t(w)},initParser(){let n=s0.Parser,t=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],e=new n;for(let w in e)t.indexOf(w)===-1&&delete e[w];e.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(w){return w}}),e.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(w){return w}});let u=e.getBrackets();u["{"].maps_to=void 0,this.parser=e}};re.classes.LaTeX=Nt;var $n={get LONG_PI(){return re.ext.LONG_PI},get LONG_E(){return re.ext.LONG_E}},Ie={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",get LONG_PI(){return $n.LONG_PI},get LONG_E(){return $n.LONG_E},PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800,initCache(){this.CACHE.roots={};let n=40,t=40;for(let e=2;e<=n;e++)for(let u=2;u<=t;u++){let w=dn(e).pow(u);this.CACHE.roots[`${w}-${u}`]=e}}};Ie.CONST_HASH=re.fnNames.CONST_HASH;Ie.initCache();var u0={get bigInt(){return re.ext.bigInt},get BIG_LOG_CACHE(){return re.ext.BIG_LOG_CACHE},get PRIMES(){return re.ext.PRIMES},get NerdamerSymbol(){return re.classes.NerdamerSymbol},get CB(){return re.groups.CB},get P(){return re.groups.P}},Ye={csc(n){return 1/Math.sin(n)},sec(n){return 1/Math.cos(n)},cot(n){return 1/Math.tan(n)},acsc(n){return Math.asin(1/n)},asec(n){return Math.acos(1/n)},acot(n){return Math.PI/2-Math.atan(n)},erf(n){let t=1/(1+.5*Math.abs(n)),e=1-t*Math.exp(-n*n-1.26551223+t*(1.00002368+t*(.37409196+t*(.09678418+t*(-.18628806+t*(.27886807+t*(-1.13520398+t*(1.48851587+t*(-.82215223+t*.17087277)))))))));return n>=0?e:-e},diff(n){return function(u){return(n(u+.001)-n(u-.001))/.002}},median(...n){n.sort((e,u)=>e-u);let t=Math.floor(n.length/2);return n.length%2?n[t]:(n[t-1]+n[t])/2},fromContinued(n){let t=n.fractions.slice(),e=1/t.pop();for(let u=0,w=t.length;u<w;u++)e=1/(t.pop()+e);return n.sign*(n.whole+e)},continuedFraction(n,t){t||=20;let e=Math.sign(n),u=Math.abs(n),w=Math.floor(u),_=u-w,R=0,L=!1,X=1e-14,z=1e7,Z,j,Ee={whole:w,sign:e,fractions:[]};for(;!L&&_!==0&&(Z=1/_,j=Math.floor(Z),!(j>z&&Ye.fromContinued(Ee)-n<=Number.EPSILON));)Ee.fractions.push(j),_=Z-j,(_<=X||R>=t-1)&&(L=!0),R++;let Ne=Ee.fractions.length-1;return Ee.fractions[Ne]===1&&(Ee.fractions.pop(),Ee.fractions[--Ne]++),Ee},bigpow(n,t){n instanceof ke||(n=ke.create(n)),t instanceof ke||(t=ke.create(t));let e=new ke(0);if(t.isInteger())e.num=n.num.pow(t.toString()),e.den=n.den.pow(t.toString());else{let u=ke.create(n.num**t.num),w=ke.create(n.den**t.num);e.num=Ye.nthroot(u,t.den.toString()),e.den=Ye.nthroot(w,t.den)}return e},gamma(n){let e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*Ye.gamma(1-n));n-=1;let u=e[0];for(let _=1;_<9;_++)u+=e[_]/(n+_);let w=n+7+.5;return Math.sqrt(2*Math.PI)*w**(n+.5)*Math.exp(-w)*u},bigfactorial(n){let t=new u0.bigInt(1);for(let e=2;e<=n;e++)t=t.times(e);return new ke(t)},bigLog(n){let t=u0.BIG_LOG_CACHE;if(t[n])return ke.quick.apply(null,t[n].split("/"));n=new ke(n);let e=80,u=new ke(0),w=n.subtract(new ke(1)),_=n.add(new ke(1));for(let R=0;R<e;R++){let L=new ke(2*R+1),X=Ye.bigpow(w.divide(_),L),z=L.clone().invert().multiply(X);u=u.add(z)}return u.multiply(new ke(2))},factorial(n){let t=n%1===0;if(t&&n<0)return NaN;if(!t)return Ye.gamma(n+1);let e=1;for(let u=2;u<=n;u++)e*=u;return e},dfactorial(n){let t=new ke(1);if(ft(n)){let e=n%2===0,u=e?n/2:(n+1)/2;if(e)for(let w=1;w<=u;w++)t=t.multiply(new ke(2).multiply(new ke(w)));else for(let w=1;w<=u;w++)t=t.multiply(new ke(2).multiply(new ke(w)).subtract(new ke(1)))}else t=2**((1+2*n-Math.cos(Math.PI*n))/4)*Math.PI**((Math.cos(Math.PI*n)-1)/4)*Ye.gamma(1+n/2);return t},GCD(...n){let t=vn(n.map(w=>Math.abs(w))).sort(),e=Math.abs(t.shift()),u=t.length;for(;u-- >0;){let w=Math.abs(t.shift());for(;;){if(e%=w,e===0){e=w;break}if(w%=e,w===0)break}}return e},QGCD(...n){let t=n[0];for(let e=1;e<n.length;e++){let u=n[e],w=t.isNegative()&&u.isNegative()?-1:1;t=u.gcd(t),w<0&&t.negate()}return t},LCM(n,t){return n*t/Ye.GCD(n,t)},pow(n,t){return n<0&&Math.abs(t)<1?1/t%2===0?NaN:-(Math.abs(n)**t):n**t},factor(n){n=Number(n);let t=Math.sign(n);n=Math.abs(n);let e=Ye.ifactor(n),u=new u0.NerdamerSymbol;u.symbols={},u.group=u0.CB;for(let w in e){if(!Object.hasOwn(e,w))continue;let _=new u0.NerdamerSymbol(1);_.group=u0.P,_.value=w;let R=new u0.NerdamerSymbol(e[w]);_.power=R,u.symbols[w]=_}return u.updateHash(),n===1&&(u=new u0.NerdamerSymbol(n)),t<0&&u.negate(),u},sfactor(n,t){t||={};let e=Math.floor(Math.sqrt(n)),{PRIMES:u}=u0,w=u[u.length-1];e>w&&n<1e6&&e1(e);let _=u.length;for(let R=0;R<_;R++){let L=u[R];for(;n%L===0;)n/=L,t[L]=(t[L]||0)+1}return n>1&&(t[n]=1),t},ifactor(n){let{bigInt:t}=u0,e=new t(n),u=new t(String(n));if(u.equals(0))return{0:1};let w=u.isNegative()?-1:1;u=u.abs();let _={};if(u.lt("65536"))_=Ye.sfactor(u,_);else{let R=function(L){L.isPrime()?_[L]=(_[L]||0)+1:_=Ye.sfactor(L,_)};try{let X={value:0},z=function(Z,j,Ee){let Ne=new t(Z),Re=2,ie=new t(Z),fe=new t(1);for(;fe.equals(1);){for(let g=0;g<=Re&&fe.equals(1);g++){if(Ee.value++>1e3)throw new Error("stopping");ie=ie.pow(2).add(1).mod(j),fe=t.gcd(ie.minus(Ne).abs(),j)}Re*=2,Ne=ie}return fe.equals(j)?z(Z+1,j,Ee):fe};for(;!u.abs().equals(1);)if(u.isPrime()){R(u);break}else{let Z=z(2,u,X);R(Z),u=u.divide(Z)}}catch(L){if(L.message==="timeout")throw L;_={},R(e)}}if(w===-1){let R=Sn(yn(_));_[`-${R}`]=_[R],delete _[R]}return _},boxfactor(n,t){t||=200;let e,u,w=Math.floor(5/12*n),_=0,R=!1;for(;e=Math.floor(n/w),u=n%w,u!==0;){if(R)return[n,1];w=Math.max(u,w-u),_++,R=_>t}return[e,w,_]},fib(n){let t=Math.sign(n);n=Math.abs(n),t=Pt(n)?t:Math.abs(t);let e=0,u=1,w=1;for(let _=2;_<=n;_++)w=e+u,e=u,u=w;return w*t},mod(n,t){return n%t},integer_part(n){return Math.sign(n)*Math.floor(Math.abs(n))},simpson(n,t,e,u){let w=function(Ee,Ne,Re){let ie=Ee(Ne),fe=1e-12;return isNaN(ie)&&(ie=Ee(Re===1?Ne+fe:Ne-fe)),ie};u||=1e-4;let _=Math.abs(Math.floor((e-t)/u));_%2!==0&&_++;let R=(e-t)/_,L=w(n,t,1),X=!1,z=t+R,Z,j;for(let Ee=1;Ee<_;Ee++)Z=X?2:4,j=Z*w(n,z,1),L+=j,X=!X,z+=R;return(L+w(n,z,2))*(R/3)},num_integrate(n,t,e,u,w){if(w<0)throw new Error("max depth cannot be negative");function _(X,z,Z,j,Ee,Ne,Re,ie,fe,g,H){if(H.nanEncountered)return NaN;let de=Z-z,Oe=X(z+de*.25),ve=X(Z-de*.25);if(isNaN(Oe)){H.nanEncountered=!0;return}if(isNaN(ve)){H.nanEncountered=!0;return}let we=de*(j+4*Oe+Ee)/12,qe=de*(Ee+4*ve+Ne)/12,Se=we+qe,K=(Se-Re)/15;if(H.maxDepthCount>1e3*fe)return;if(g>fe)return H.maxDepthCount++,Se+K;if(Math.abs(K)<ie)return Se+K;let l=z+de*.5,p=_(X,z,l,j,Oe,Ee,we,ie*.5,fe,g+1,H);if(isNaN(p))return H.nanEncountered=!0,NaN;let o=_(X,l,Z,Ee,ve,Ne,qe,ie*.5,fe,g+1,H);return isNaN(o)?(H.nanEncountered=!0,NaN):p+o}function R(X,z,Z,j,Ee){let Ne={maxDepthCount:0,nanEncountered:!1};j===void 0&&(j=1e-9),Ee===void 0&&(Ee=45);let Re=X(z),ie=X(.5*(z+Z)),fe=X(Z),g=(Re+4*ie+fe)*(Z-z)/6,H=_(X,z,Z,Re,ie,fe,g,j,Ee,1,Ne);if(Ne.maxDepthCount>0&&Mn(`integrate-adaptive-simpson: Warning: maximum recursion depth (${Ee}) reached ${Ne.maxDepthCount} times`),Ne.nanEncountered)throw new Error("Function does not converge over interval!");return H}let L;try{L=R(n,t,e,u,w)}catch(X){if(X.message==="timeout")throw X;return Ye.simpson(n,t,e)}return h0(L,12)},Ci(n){let e=.5772156649015329,u=0;for(let w=1;w<20;w++){let _=2*w;u+=(-1)**w*n**_/(_*Ye.factorial(_))}return Math.log(n)+e+u},Si(n){let e=0;for(let u=0;u<20;u++){let w=2*u;e+=(-1)**u*n**(w+1)/((w+1)*Ye.factorial(w+1))}return e},Ei(n){if(Number(n)===0)return-1/0;let t=30,e=.5772156649015329,u=0;for(let w=1;w<t;w++)u+=n**w/(w*Ye.factorial(w));return e+Math.abs(Math.log(n))+u},Shi(n){let e=0,u,w;for(let _=0;_<30;_++)u=2*_,w=u+1,e+=n**w/(w*w*Ye.factorial(u));return e},Chi(n){let e=.5772156649015329,u=function(w){return(Math.cosh(w)-1)/w};return Math.log(n)+e+Ye.num_integrate(u,.002,n,.001)},Li(n){return Ye.Ei(Ye.bigLog(n))},gamma_incomplete(n,t){let e=n-1,u=0,w=t||0;for(let _=0;_<e;_++)u+=w**_/Ye.factorial(_);return Ye.factorial(e)*Math.exp(-w)*u},step(n){return n>0?1:n<0?0:.5},rect(n){let t=Math.abs(n);return t===.5?t:t>.5?0:1},sinc(n){return n.equals(0)?1:Math.sin(n)/n},tri(n){return n=Math.abs(n),n>=1?0:1-n},nthroot(n,t){if(n instanceof ke||(n=new ke(n.toString())),t instanceof ke||(t=new ke(t.toString())),t.equals(1))return n;let e=n.divide(new ke(2)),u=new ke(1e-15),w,_,R,L=t.clone().invert(),X=t.subtract(new ke(1));do{let z=Ye.bigpow(e,X),Z=L.multiply(n.divide(z).subtract(e)).toDecimal(25);if(w=ke.create(Z),R)break;e=e.add(w),Z=w.toDecimal(),R=_?_===Z:!1,_=Z}while(w.abs().gte(u));return e},sqrt(n){n instanceof ke||(n=new ke(n));let t,e,u,w,_=0,R=!1,L=new ke(1e-20);t=n.divide(new ke(2));let X=1e3;do{if(_>X)throw new Error(`Unable to calculate square root for ${n}`);t=t.add(n.divide(t)).divide(new ke(2)),t=new ke(t.decimal(30)),e=n.subtract(t.multiply(t)),w=u?u.equals(e):!1,(e.clone().abs().lessThan(L)||w)&&(R=!0),u=e,_++}while(!R);return t}};Ie.FUNCTION_MODULES.push(Ye);U0(Ye);function ct(n){return n instanceof P}function St(n){return n instanceof wt}function dt(n){return n instanceof ot}function t1(n){return n instanceof Bt}var o0={get EX(){return re.groups.EX},get CP(){return re.groups.CP},get CB(){return re.groups.CB},get S(){return re.groups.S},get PL(){return re.groups.PL},get FN(){return re.groups.FN}};function t0(n,t=null,e=null){if(e||={c:[],add(u){this.c.indexOf(u)===-1&&isNaN(u)&&this.c.push(u)}},ct(n)){let{group:u}=n,w=n.previousGroup;if(u===o0.EX&&t0(n.power,t,e),u===o0.CP||u===o0.CB||w===o0.CP||w===o0.CB)for(let _ in n.symbols)Object.hasOwn(n.symbols,_)&&t0(n.symbols[_],t,e);else if(u===o0.S||w===o0.S)n.value==="e"||n.value==="pi"||n.value===Ie.IMAGINARY||e.add(n.value);else if(u===o0.PL||w===o0.PL)t0(H0(n.symbols),t,e);else if(u===o0.EX)isNaN(Number(n.value))||e.add(n.value),t0(n.power,t,e);else if(u===o0.FN&&!t&&n.args)for(let _=0;_<n.args.length;_++)t0(n.args[_],t,e)}return e.c.sort()}function Ii(n,t,e){let u=[];n.each(w=>{let _,R;w.contains(t)?(_=w.stripVar(t),R=It._.divide(w.clone(),_.clone()).power.toDecimal()):(_=w,R=0);let L=u[R];u[R]=L?It._.add(L,_):_},!0);for(let w=0;w<u.length;w++)u[w]||=new P(0);return u}var Wt={get _(){return re.parser},get FN(){return re.groups.FN},get P(){return re.groups.P},get N(){return re.groups.N}};function Oi(n){let t,e,u;if(n.group===Wt.FN&&n.fname===""?(t=P.unwrapPARENS(Wt._.parse(n).toLinear()),e=Wt._.parse(n.power)):n.group===Wt.P&&(t=Wt._.parse(n.value),e=Wt._.parse(n.power)),t&&e&&t.group===Wt.N&&e.group===Wt.N&&t.multiplier.isNegative()){u=[];let _=P.toPolarFormArray(vt(n))[0],R=Wt._.arg(t),L=e.multiplier.den.toString(),X=e.multiplier.num.toString(),z="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let Z=0;Z<Number(L);Z++){let j=vt(Wt._.parse(Tt("(({0})+2*pi*({1}))/({2})",R,Z,L))).multiplier.toDecimal();u.push(vt(Wt._.parse(Tt(z,_,L,Ie.IMAGINARY,j,X))))}return wt.fromArray(u)}if(n.isConstant(!0,!0)){let w=n.sign(),_=vt(n.abs()),R=Wt._.sqrt(_);u=[R.clone(),R.negate()],w<0&&(u=u.map(L=>Wt._.multiply(L,P.imaginary())))}else u=[Wt._.parse(n)];return wt.fromArray(u)}function qi(n,t,e){let w={},_;for(let R=0;R<e.length;R++)w[e[R]]=new P(Math.floor(Math.random()*5)+1);return bt("PARSE2NUMBER",()=>{_=It._.parse(n,w).equals(It._.parse(t,w))}),_}function _n(n){return ct(n)?_n(n.multiplier.toDecimal()):Number(n)%1!==0}function Ti(n,t){let e=new P(0);for(let u=0;u<n.length;u++){let w=n[u];e=It._.add(e,ct(w)?w:It._.parse(w))}return t?Number(e):e}function Dn(n){for(let t=0;t<n.length;t++)if(!(n[t].isPi()||n[t].isE())&&!n[t].isConstant(!0))return!1;return!0}function Ri(n,t){t||=n.length;for(let e=0;e<t;e++)n[e]||(n[e]=new P(0));return n}function W0(n){return ct(n)?n.multiplier.lessThan(0):n<0}var v0={get _(){return re.parser},get S(){return re.groups.S},get FN(){return re.groups.FN},get EX(){return re.groups.EX},get ABS(){return re.fnNames.ABS}};function n1(n,t){n=v0._.expand(n),t||={};let e=function(u,w){t[u]||=new P(0),t[u]=v0._.add(t[u],w.clone())};return n.each(u=>{u.isConstant("all")?e("constants",u):u.group===v0.S?e(u.value,u):u.group===v0.FN&&(u.fname===v0.ABS||u.fname==="")?n1(u.args[0]):u.group===v0.EX||u.group===v0.FN||e(t0(u).join(" "),u)}),t}var V0={get _(){return re.parser},get CP(){return re.groups.CP}};function i1(n,t,e){t=String(t);let u,w;if(n.group===V0.CP){let L=V0._.expand(n.clone()).stripVar(t);u=V0._.subtract(n.clone(),L.clone()),w=L}else u=n.clone();let _=u.stripVar(t),R=V0._.divide(u.clone(),_.clone());return w||=new P(0),e?{a:_,x:R,ax:u,b:w}:[_,R,u,w]}function Fn(n,t,e){(t.isComposite()&&!n.isComposite()||t.isLinear()&&!n.isLinear())&&([n,t]=[t,n]);let u=new P(0);return n.isLinear()?n.each(w=>{if(t.isComposite())t.isLinear()?t.each(_=>{let R=It._.multiply(It._.parse(w),It._.parse(_)),L=It._.expand(It._.parse(R),e);u=It._.add(u,L)},!0):u=It._.add(u,It._.multiply(w,It._.parse(t)));else{let _=It._.multiply(It._.parse(w),It._.parse(t));u=It._.add(u,It._.expand(_,e))}},!0):u=It._.multiply(n,t),u}function r1(n){if(Ft(n)){let t=new wt([]);for(let e=0;e<n.length;e++)t.elements.push(r1(n[e]));return t}return ct(n)?n:It._.parse(n)}function Li(n){let t=t0(n[0],null,null);for(let e=1,u=n.length;e<u;e++)t=t.concat(t0(n[e]));return t=vn(t).sort(),t}function Ui(n){let e="u",u=0,w=t0(n);for(;!(i0.RESERVED.indexOf(e)===-1&&w.indexOf(e)===-1);)e="u"+u++;for(let _=0,R=i0.RESERVED.length;_<=R;_++)if(!i0.RESERVED[_]){i0.RESERVED[_]=e;break}return e}var f0={get _(){return re.parser},get C(){return re.core},get USER_FUNCTIONS(){return re.state.USER_FUNCTIONS}};function An(n,t,e){if(!t){let u=typeof n;if(u==="string"){let w=n;if(!/:?=/u.test(w))return!1;let _=Ie.FUNCTION_REGEX.exec(w);if(!_)return!1;let[,R,L,X]=_;n=R,t=L.split(",").map(z=>z.trim()),e=X}else if(u==="function"){let w=n,_=w.name;return m0(_),j0(_)?!1:(f0.C.Math2[_]=w,f0._.functions[_]=[void 0,w.length],f0.USER_FUNCTIONS.includes(_)||f0.USER_FUNCTIONS.push(_),!0)}else return!1}return n=n.trim(),m0(n),j0(n)?!1:(t||=t0(f0._.parse(e)),t=t.map(u=>u.trim()),f0._.functions[n]=[f0._.mappedFunction,t.length,{name:n,params:t,body:e}],f0.USER_FUNCTIONS.includes(n)||f0.USER_FUNCTIONS.push(n),!0)}var on={get _(){return re.parser},get C(){return re.core},get USER_FUNCTIONS(){return re.state.USER_FUNCTIONS}};function Pi(){for(let n of on.USER_FUNCTIONS)delete on.C.Math2[n],delete on._.functions[n]}function xi(){let n={};for(let t in It._.functions)Object.hasOwn(It._.functions,t)&&(n[t]=It._.functions[t][0]);return n}var yt={get bigInt(){return re.ext.bigInt},get isSymbol(){return re.utils.isSymbol},get isVector(){return re.utils.isVector},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get EX(){return re.groups.EX},get CUSTOM_OPERATORS(){return re.state.CUSTOM_OPERATORS}};function Vt(n,t=void 0,e=void 0,u=void 0){let w=t==="hash",_,R=w?void 0:t,L=R==="decimal"||R==="decimals"||R==="decimals_or_scientific";R==="decimals_or_scientific"&&typeof u>"u"&&(u=Ie.DEFAULT_DECP);function X(z,Z){switch(t){case"decimals":case"decimal":return _||=function(j){return!1},Z?z.toDecimal(Z):z.valueOf();case"recurring":{_||=function(we){return we.indexOf("'")!==-1};let j=z.toString(),Ee=/^-?\d+(?:\/\d+)?$/u.exec(j);if(Ee.length===0)return j;let Ne=Ee[0].split("/"),Re=!1,ie=Number(Ne[0]);ie<0&&(ie=-ie,Re=!0);let fe=Number(Ne[1]);fe||=1;let g=Math.floor(ie/fe),H=10*(ie-g*fe);for(g=`${g.toString()}.`;H&&H<fe;)H*=10,g+="0";let de="",Oe=[],ve=0;for(;;){if(typeof Oe[H]<"u"){let Se=de.slice(0,Oe[H]),K=de.slice(Oe[H]),l=`${g+Se}'${K}'`;return(Re?"-":"")+l.replace("'0'","").replace(/\.$/u,"")}let we=Math.floor(H/fe),qe=H-we*fe;Oe[H]=ve,de+=we.toString(),ve+=1,H=10*qe}}case"mixed":{_||=function(Oe){return Oe.indexOf("/")!==-1};let j=z.toString(),Ee=/^-?\d+(?:\/\d+)?$/u.exec(j);if(Ee.length===0)return j;let Ne=Ee[0].split("/"),Re=new yt.bigInt(Ne[0]),ie=new yt.bigInt(Ne[1]);ie.equals(0)&&(ie=new yt.bigInt(1));let fe=Re.divmod(ie),{quotient:g}=fe,{remainder:H}=fe,de=Ne[0][0]==="-"||g.equals(0)||H.equals(0)?"":"+";return(g.equals(0)?"":g.toString())+de+(H.equals(0)?"":`${H.toString()}/${Ne[1]}`)}case"scientific":return _||=function(j){return!1},new $t(z.valueOf()).toString(Ie.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{_||=function(Ne){return!1};let j=z.valueOf(),Ee=new $t(j);return Math.abs(Ee.exponent)>=Ie.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?Ee.toString(Ie.SCIENTIFIC_MAX_DECIMAL_PLACES):Z?z.toDecimal(Z):j}default:return _||=function(j){return j.indexOf("/")!==-1},z.toString()}}if(yt.isSymbol(n)){let z="",Z="",j="",Ee=n.group||e,{value:Ne}=n;if(!w){let H=X(n.multiplier);String(H)==="-1"&&String(n.multiplier)==="-1"&&(j="-",H="1"),String(H)!=="1"&&(z=H);let de=n.power?X(n.power):"";String(de)!=="1"&&(ct(de)?Z=Vt(de,R):Z=de)}switch(Ee){case yt.N:{z="";let H;R==="decimals_or_scientific"?H=X(n.multiplier,u):u&&L?H=n.multiplier.toDecimal(u):H=X(n.multiplier),Ne=String(n.multiplier)==="-1"?"1":H,Z="";break}case yt.PL:Ne=n.collectSymbols().map(H=>{let de=Vt(H,R,e,u);return de==="0"&&(de=""),de}).sort().join("+").replace(/\+-/gu,"-");break;case yt.CP:Ne=n.collectSymbols().map(H=>{let de=Vt(H,R,e,u);return de==="0"&&(de=""),de}).sort().join("+").replace(/\+-/gu,"-");break;case yt.CB:Ne=n.collectSymbols(H=>{let de=H.group;return(de===yt.PL||de===yt.CP)&&H.power.equals(1)&&H.multiplier.equals(1)?_t(Vt(H,R)):Vt(H,R)}).join("*");break;case yt.EX:{let H=n.previousGroup,de=n.power.group;H===yt.PL&&(Ne=n.collectSymbols(Vt,R).join("+").replace("+-","-")),!(H===yt.N||H===yt.S||H===yt.FN)&&!w&&(Ne=_t(Ne)),(de===yt.CP||de===yt.CB||de===yt.PL||n.power.multiplier.toString()!=="1")&&Z&&(Z=_t(Z));break}}if(Ee===yt.FN&&(Ne=n.fname+_t(n.args.map(H=>Vt(H,R)).join(","))),Ee===yt.FN&&n.fname in yt.CUSTOM_OPERATORS){let H=Vt(n.args[0]),de=Vt(n.args[1]);n.args[0].isComposite()&&(H=_t(H)),n.args[1].isComposite()&&(de=_t(de)),Ne=H+yt.CUSTOM_OPERATORS[n.fname]+de}let Re=typeof _=="function"?_(Z):!1;if(Z&&Ee!==yt.EX&&Re&&(Z=_t(Z)),((Ee===yt.CP||Ee===yt.PL)&&(z&&String(z)!=="1"||j==="-")||(Ee===yt.CB||Ee===yt.CP||Ee===yt.PL)&&Z&&String(Z)!=="1"||!w&&Ee===yt.P&&String(Ne)==="-1"||n.fname===Ie.PARENTHESIS)&&(Ne=_t(Ne)),u&&(t==="decimal"||(t==="decimals"||t==="decimals_or_scientific")&&z))if(z.toString().includes("e")){if(t!=="decimals_or_scientific"){let H=Number(z),de=H.toExponential(),Oe=H.toPrecision(u);z=de.length<Oe.length?de:Oe}}else z=h0(Number(z),u);let ie=j+z,fe=typeof _=="function"?_(z):!1;if(z&&fe&&(ie=_t(ie)),Number(Z)<0&&(Z=_t(Z)),z&&(ie=`${ie}*`),Z){if(Ne==="e"&&Ie.E_TO_EXP)return`${ie}exp${_t(Z)}`;Z=Ie.POWER_OPERATOR+Z}Ee===yt.EX&&Ne.charAt(0)==="-"&&(Ne=_t(Ne));let g=ie+Ne;return n.parens&&(g=_t(g)),g+Z}if(yt.isVector(n)){let z=n.elements.length,Z=[];for(let j=0;j<z;j++)Z.push(n.elements[j].text(t));return`[${Z.join(",")}]`}try{return n.toString()}catch(z){if(z.message==="timeout")throw z;return""}}var ue={get bigDec(){return re.ext.bigDec},get bigInt(){return re.ext.bigInt},get _(){return re.parser},get N(){return re.groups.N},get P(){return re.groups.P},get S(){return re.groups.S},get FN(){return re.groups.FN},get PL(){return re.groups.PL},get CB(){return re.groups.CB},get CP(){return re.groups.CP},get EX(){return re.groups.EX},get CONST_HASH(){return re.fnNames.CONST_HASH},get isSymbol(){return re.utils.isSymbol},get text(){return re.utils.text},get variables(){return re.utils.variables},get SQRT(){return re.fnNames.SQRT},get PARENTHESIS(){return re.fnNames.PARENTHESIS}};function P(n){z0();let t=n==="Infinity";if(!(this instanceof P))return new P(n);typeof n=="object"&&n!==null&&n instanceof ue.bigDec&&(n=n.toString());let e=String(n);return/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(e)||typeof n=="object"&&n!==null&&n instanceof ue.bigDec?(this.group=ue.N,this.value=ue.CONST_HASH,this.multiplier=new ke(n)):(this.group=ue.S,m0(n),this.value=n,this.multiplier=new ke(1),this.imaginary=n===Ie.IMAGINARY,this.isInfinity=t),this.power=new ke(1),this.args=void 0,this.fname=void 0,this.isImgSymbol=void 0,this}P.imaginary=function(){let t=new P(Ie.IMAGINARY);return t.imaginary=!0,t};P.infinity=function(t=void 0){let e=new P("Infinity");return t===-1&&e.negate(),e};P.shell=function(t,e){let u=new P(e);return u.group=t,u.symbols={},u.length=0,u};P.unwrapSQRT=function(t,e){let u=t.power;if(t.fname===Ie.SQRT&&(t.isLinear()||e)){let w=t.args[0].clone();w.power=w.power.multiply(new ke(1/2)),w.multiplier=w.multiplier.multiply(t.multiplier),t=w,e&&(t.power=u.multiply(new ke(1/2)))}return t};P.hyp=function(t,e){t||=new P(0),e||=new P(0);let{_:u}=ue;return u.sqrt(u.add(u.pow(t.clone(),new P(2)),u.pow(e.clone(),new P(2))))};P.toPolarFormArray=function(t){let e=t.realpart(),u=t.imagpart(),w=P.hyp(e,u),_=e.equals(0)?ue._.parse("pi/2"):ue._.trig.atan(ue._.divide(u,e));return[w,_]};P.unwrapPARENS=function(t){if(t.fname===""){let e=t.args[0];return e.power=e.power.multiply(t.power),e.multiplier=e.multiplier.multiply(t.multiplier),t.fname===""?P.unwrapPARENS(e):e}return t};P.create=function(t,e){e=e===void 0?1:e;let{_:u}=ue;return u.parse(`(${t})^(${e})`)};P.prototype={pushMinus(){let{_:n}=ue,t=this;if((this.group===ue.CB||this.group===ue.CP||this.group===ue.PL)&&this.multiplier.lessThan(0)&&!Pt(this.power)){t=this.clone();let e=t.multiplier.clone();e.negate(),t.toUnitMultiplier();for(let u in t.symbols)if(Object.hasOwn(t.symbols,u)&&(t.symbols[u]=t.symbols[u].clone().negate(),t.group===ue.CB))break;t.length>0&&t.each(u=>u.pushMinus()),t=n.parse(t),t=n.multiply(n.parse(e),t)}return t},getNth(n){let{_:t}=ue,e=vt(t.pow(t.parse(this.multiplier),t.parse(String(n)).invert())),u=t.parse(h0(e));return vt(t.pow(u,t.parse(String(n)))).equals(t.parse(this.multiplier))?u:e},isToNth(n){let{_:t}=ue,e=this.getNth(n),u=ft(e),w;return this.group===ue.CB?(w=!0,this.each(_=>{_.isToNth(n)||(w=!1)})):w=this.group===ue.N?!0:ft(t.divide(t.parse(this.power),t.parse(n))),u&&w},isSquare(){return this.isToNth(2)},isCube(){return this.isToNth(3)},isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)},powSimp(){let{_:n}=ue;if(this.group===ue.CB){let t=[],e=this.multiplier.sign();if(this.each(Z=>{let j=Z.power;ue.isSymbol(j)||j.equals(1)||t.push(j)}),t.length===0)return this.clone();let u=new ke(Sn(t)),w=this.multiplier.clone().abs(),_=Ye.ifactor(w.valueOf()),R=new ke(1),L=new ke(1);for(let Z in _){if(!Object.hasOwn(_,Z))continue;let j=new ke(_[Z]);j.lessThan(u)||(j=j.divide(u).subtract(new ke(1)),L=L.multiply(new ke(Z))),R=R.multiply(n.parse(`${_t(Z)}^${_t(j)}`).multiplier)}let X=new P(L);this.each(Z=>{Z=Z.clone(),Z.power=Z.power.divide(u),X=n.multiply(X,Z)});let z=n.symfunction(ue.PARENTHESIS,[X]);return z.power=u,z.multiplier=e<0?R.negate():R,z}return this.clone()},equals(n){let t;return ue.isSymbol(n)?t=n:t=new P(n),this.value===t.value&&this.power.equals(t.power)&&this.multiplier.equals(t.multiplier)&&this.group===t.group},abs(){let n=this.clone();return n.multiplier.abs(),n},gt(n){ue.isSymbol(n)||(n=new P(n));let t=n;return this.isConstant()&&t.isConstant()&&this.multiplier.greaterThan(t.multiplier)},gte(n){ue.isSymbol(n)||(n=new P(n));let t=n;return this.equals(t)||this.isConstant()&&t.isConstant()&&this.multiplier.greaterThan(t.multiplier)},lt(n){ue.isSymbol(n)||(n=new P(n));let t=n;return this.isConstant()&&t.isConstant()&&this.multiplier.lessThan(t.multiplier)},lte(n){ue.isSymbol(n)||(n=new P(n));let t=n;return this.equals(t)||this.isConstant()&&t.isConstant()&&this.multiplier.lessThan(t.multiplier)},isPoly(n=!1){let t=this.group,e=this.power;if(!ft(e)||Number(e)<0)return!1;if(t===ue.N||t===ue.S||this.isConstant(!0))return!0;let u=ue.variables(this);if(t===ue.CB&&u.length===1){let w=u[0];if(!w)return!0;for(let _ in this.symbols){if(!Object.hasOwn(this.symbols,_))continue;let R=this.symbols[_];if(R.group===ue.FN&&!R.args[0].isConstant()||!R.contains(w)&&!R.isConstant(!0))return!1}return!0}if(this.isComposite()||t===ue.CB&&n){if(!n&&u.length>1)return!1;for(let w in this.symbols)if(!this.symbols[w].isPoly(n))return!1;return!0}return!1},stripVar(n,t=!1){let{_:e}=ue,u;return(this.group===ue.PL||this.group===ue.S)&&this.value===n?u=new P(t?0:this.multiplier):this.group===ue.CB&&this.isLinear()?(u=new P(1),this.each(w=>{w.contains(n,!0)||(u=e.multiply(u,w.clone()))}),u.multiplier=u.multiplier.multiply(this.multiplier)):this.group===ue.CP&&!this.isLinear()?u=new P(this.multiplier):this.group===ue.CP&&this.isLinear()?(u=new P(0),this.each(w=>{if(!w.contains(n)){let _=w.clone();_.multiplier=_.multiplier.multiply(this.multiplier),u=e.add(u,_)}}),u.equals(0)&&(u=new P(this.multiplier))):this.group===ue.EX&&this.power.contains(n,!0)?u=new P(this.multiplier):this.group===ue.FN&&this.contains(n)?u=new P(this.multiplier):u=this.clone(),u},toArray(n,t){let{_:e}=ue;t||={arr:[],add(w,_){let R=this.arr[_];this.arr[_]=R?e.add(R,w):w}};let u=this.group;if(u===ue.S&&this.contains(n))t.add(new P(this.multiplier),this.power);else if(u===ue.CB){let w=this.stripVar(n),_=e.divide(this.clone(),w.clone()),R=_.isConstant()?0:_.power;t.add(w,R)}else if(u===ue.PL&&this.value===n)this.each((w,_)=>{t.add(w.stripVar(n),_)});else if(u===ue.CP)this.each(w=>{w.toArray(n,t)});else{if(this.contains(n))throw new En("Cannot convert to array! Exiting");t.add(this.clone(),0)}t=t.arr;for(let w=0;w<t.length;w++)t[w]||=new P(0);return t},hasFunc(n){let t=this.group===ue.FN||this.group===ue.EX;if(t&&!n||t&&this.contains(n))return!0;if(this.symbols){for(let e in this.symbols)if(this.symbols[e].hasFunc(n))return!0}return!1},sub(n,t){let{_:e}=ue;n=ue.isSymbol(n)?n.clone():e.parse(n),t=ue.isSymbol(t)?t.clone():e.parse(t),(n.group===ue.N||n.group===ue.P)&&xt("Cannot substitute a number. Must be a variable");let u=!1,w=n.multiplier.equals(1),_=this.multiplier.clone(),R;if(this.value===n.value&&(this.group!==ue.PL&&n.group!==ue.PL||this.group===ue.PL&&n.group===ue.PL))(w||n.multiplier.equals(this.multiplier))&&(n.isLinear()?R=t:n.power.equals(this.power)&&(R=t,u=!0),n.multiplier.equals(this.multiplier)&&(_=new ke(1)));else if(this.group===ue.CB||this.previousGroup===ue.CB)R=new P(1),this.each(L=>{let X=e.parse(L.sub(n,t));R=e.multiply(R,X)});else if(this.isComposite()){let L=this.clone();if(n.isComposite()&&L.isComposite()&&L.isLinear()&&n.isLinear()){let X=function(z,Z){for(let j in z.symbols){if(!Object.hasOwn(z.symbols,j))continue;let Ee=z.symbols[j];if(Ee.isComposite()&&X(Ee,Z)||Ee.equals(Z))return!0}return!1};for(let z in n.symbols)if(Object.hasOwn(n.symbols,z)&&!X(L,n.symbols[z]))return L.clone();R=e.add(e.subtract(L.clone(),n),t)}else R=new P(0),L.each(X=>{R=e.add(R,X.sub(n,t))})}else if(this.group===ue.EX)R=e.parse(this.value).sub(n,t);else if(this.group===ue.FN){let L=[];for(let X=0;X<this.args.length;X++){let z=this.args[X];ue.isSymbol(z)||(z=e.parse(z)),L.push(z.sub(n,t))}R=e.symfunction(this.fname,L)}if(R){if(!u){let L=this.group===ue.EX?this.power.sub(n,t):e.parse(this.power);R=e.pow(R,L)}return R.multiplier=R.multiplier.multiply(_),R}return this.clone()},isMonomial(){if(this.group===ue.S)return!0;if(this.group===ue.CB){for(let n in this.symbols)if(this.symbols[n].group!==ue.S)return!1}else return!1;return!0},isPi(){return this.group===ue.S&&this.value==="pi"},sign(){return this.multiplier.sign()},isE(){return this.value==="e"},isSQRT(){return this.fname===ue.SQRT},isConstant(n,t){if(t&&this.group===ue.CB){for(let e in this.symbols)if(this.symbols[e].isConstant(!0))return!0}if(n==="functions"&&this.isComposite()){let e=!0;return this.each(u=>{u.isConstant(n,t)||(e=!1)},!0),e}if(n==="all"&&(this.isPi()||this.isE()))return!0;if(n&&this.group===ue.FN){for(let e=0;e<this.args.length;e++)if(!this.args[e].isConstant(n))return!1;return!0}return n?I0(this):this.value===ue.CONST_HASH},isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let n in this.symbols)if(this.symbols[n].isImaginary())return!0}return!1},realpart(){let{_:n}=ue;if(this.isConstant())return this.clone();if(this.imaginary)return new P(0);if(this.isComposite()){let t=new P(0);return this.each(e=>{t=n.add(t,e.realpart())}),t}return this.isImaginary()?new P(0):this.clone()},imagpart(){let{_:n}=ue;if(this.group===ue.S&&this.isImaginary()){let t=this;return this.power.isNegative()&&(t=this.clone(),t.power.negate(),t.multiplier.negate()),new P(t.multiplier)}if(this.isComposite()){let t=new P(0);return this.each(e=>{t=n.add(t,e.imagpart())}),t}return this.group===ue.CB?this.stripVar(Ie.IMAGINARY):new P(0)},isInteger(){return this.isConstant()&&this.multiplier.isInteger()},isLinear(n){if(n){if(this.isConstant()||!this.contains(n,!0))return!0;if(this.group===ue.S)return this.value===n?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let t in this.symbols)if(!this.symbols[t].isLinear(n))return!1;return!0}return this.group===ue.CB?this.symbols[n]?this.symbols[n].isLinear(n):!0:!1}return this.power.equals(1)},containsFunction(n){if(typeof n=="string"&&(n=[n]),this.group===ue.FN&&n.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let t in this.symbols)if(this.symbols[t].containsFunction(n))return!0}return!1},multiplyPower(n){let{_:t}=ue;if(this.group===ue.N&&this.multiplier.equals(1))return this;let e=this.power;if(this.group!==ue.EX&&ue.isSymbol(n)&&n.group===ue.N){let u=n.multiplier;this.group===ue.N&&!u.isInteger()&&this.convert(ue.P),this.power=e.equals(1)?u.clone():e.multiply(u),this.group===ue.P&&ft(this.power)&&(this.value=Number(this.value)**Number(this.power),this.toLinear(),this.convert(ue.N))}else{this.group!==ue.EX&&(e=new P(e),this.convert(ue.EX));let u=t.multiply(e,n);this.power=u}return this},setPower(n,t=!1){if(this.group===ue.N&&this.multiplier.equals(1))return this;if(this.group===ue.EX&&!ue.isSymbol(n))this.group=this.previousGroup,delete this.previousGroup,this.group===ue.N?(this.multiplier=new ke(this.value),this.value=ue.CONST_HASH):this.power=n;else{let e=!1;ue.isSymbol(n)&&(n.group===ue.N?n=n.multiplier:e=!0);let u=e?ue.EX:ue.P;this.power=n,this.group===ue.N&&u&&this.convert(u,t)}return this},isInverse(){return this.group===ue.EX?this.power.multiplier.lessThan(0):Number(this.power)<0},clone(n=void 0){let t=this,e=n||new P(0),u=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],w=u.length,_;if(t.symbols){e.symbols={};for(let R in t.symbols)Object.hasOwn(t.symbols,R)&&(e.symbols[R]=t.symbols[R].clone())}for(_=0;_<w;_++)t[u[_]]!==void 0&&(e[u[_]]=t[u[_]]);return e.power=t.power.clone(),e.multiplier=t.multiplier.clone(),t.isConversion&&(e.isConversion=t.isConversion),t.isUnit&&(e.isUnit=t.isUnit),e},toUnitMultiplier(n=!1){return this.multiplier.num=new ue.bigInt(this.multiplier.num.isNegative()&&n?-1:1),this.multiplier.den=new ue.bigInt(1),this},toLinear(){return this.power.equals(1)?this:(this.setPower(new ke(1)),this)},each(n,t=!1){if(this.symbols)for(let e in this.symbols){if(!Object.hasOwn(this.symbols,e))continue;let u=this.symbols[e];if(u.group===ue.PL&&t)for(let w in u.symbols)Object.hasOwn(u.symbols,w)&&n.call(e,u.symbols[w],w);else n.call(this,u,e)}else n.call(this,this,this.value)},valueOf(){return this.group===ue.N?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:ue.text(this,"decimals")},contains(n,t=!1){n=String(n);let e=this.group;if(this.value===n)return!0;if(this.symbols){for(let u in this.symbols)if(this.symbols[u].contains(n,t))return!0}if(e===ue.FN||this.previousGroup===ue.FN){for(let u=0;u<this.args.length;u++)if(this.args[u].contains(n,t))return!0}return e===ue.EX&&(t&&this.power.contains(n,t)||this.value===n)?!0:this.value===n},negate(){return this.multiplier.negate(),(this.group===ue.CP||this.group===ue.PL)&&this.distributeMultiplier(),this},invert(n=!1,t=!1){return n||(this.multiplier=this.multiplier.invert()),ue.isSymbol(this.power)?this.power.negate():this.group===ue.CB&&t?this.each(e=>e.invert()):this.power&&this.group!==ue.N&&this.power.negate(),this},distributeMultiplier(n=!1){let t=n?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&t&&this.group!==ue.CB&&!this.multiplier.equals(1)){for(let e in this.symbols){if(!Object.hasOwn(this.symbols,e))continue;let u=this.symbols[e];u.multiplier=u.multiplier.multiply(this.multiplier),u.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent(){let{_:n}=ue;if(!this.power.equals(1)){let t=this.power;for(let e in this.symbols){if(!Object.hasOwn(this.symbols,e))continue;let u=this.symbols[e];u.group===ue.EX?u.power=n.multiply(u.power,new P(t)):ue.isSymbol(this.symbols[e].power)?this.symbols[e].power=n.multiply(this.symbols[e].power,new P(t)):this.symbols[e].power=this.symbols[e].power.multiply(t)}this.toLinear()}return this},convert(n,t=void 0){if(n>ue.FN){let e=this.clone();this.symbols={},n===ue.CB?e.toUnitMultiplier():this.toUnitMultiplier(),this.group===ue.FN&&(e.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[e.keyForGroup(n)]=e,this.group=n,this.length=1}else if(n===ue.EX)this.group===ue.N&&this.multiplier.equals(1)||(this.group!==ue.EX&&(this.previousGroup=this.group),this.group===ue.N?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=ue.text(this,"hash"),this.group=ue.EX);else if(n===ue.N){let e=this.multiplier.toDecimal();this.symbols&&=void 0,new P(this.group===ue.P?Number(e)*Number(this.value)**Number(this.power):e).clone(this)}else n===ue.P&&this.group===ue.N&&(this.value=t?this.multiplier.num.toString():Math.abs(Number(this.multiplier.num.toString())),this.toUnitMultiplier(!t),this.group=ue.P);return this},insert(n,t){let{_:e}=ue;if(ue.isSymbol(n)||xt(`Object ${n} is not of type NerdamerSymbol!`),this.symbols){let{group:u}=this;if(u>ue.FN){let w=n.keyForGroup(u),_=w in this.symbols?this.symbols[w]:!1;if(t==="add"){let R=w;_?(this.symbols[R]=e.add(_,n),this.symbols[R].multiplier.equals(0)&&(delete this.symbols[R],this.length--,this.length===0&&(this.convert(ue.N),this.multiplier=new ke(0)))):(this.symbols[w]=n,this.length++)}else n.group===ue.P&&ft(n.power)&&n.convert(ue.N),n.group===ue.EX?(n.parens=n.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(n.multiplier.clone().abs()),n.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(n.multiplier),n.toUnitMultiplier()),_&&(n=e.multiply(g0(this.symbols,w),n),n.isConstant()&&(this.multiplier=this.multiplier.multiply(n.multiplier),n=new P(1)),this.length--),n.isOne(!0)?n.multiplier.lessThan(0)&&this.negate():(this.symbols[w]=n,this.length++);this.length===0&&this.convert(ue.N),(this.group===ue.CP||this.group===ue.CB)&&this.updateHash()}}return this},attach(n){if(Ft(n)){for(let t=0;t<n.length;t++)this.insert(n[t],"add");return this}return this.insert(n,"add")},combine(n){if(Ft(n)){for(let t=0;t<n.length;t++)this.insert(n[t],"multiply");return this}return this.insert(n,"multiply")},updateHash(){if(this.group!==ue.N)if(this.group===ue.FN){let n="",{args:t}=this,e=this.fname===ue.PARENTHESIS;for(let w=0;w<t.length;w++)n+=(w===0?"":",")+ue.text(t[w]);let u=e?"":this.fname;this.value=u+(e?n:_t(n))}else this.group===ue.S||this.group===ue.PL||(this.value=ue.text(this,"hash"))},keyForGroup(n){let t=this.group,e;if(t===ue.N)e=this.value;else if(t===ue.S||t===ue.P)n===ue.PL?e=this.power.toDecimal():e=this.value;else if(t===ue.FN)n===ue.PL?e=this.power.toDecimal():e=ue.text(this,"hash");else{if(t===ue.PL)return n===ue.CB?e=ue.text(this,"hash"):n===ue.CP?this.power.equals(1)?e=this.value:e=_t(ue.text(this,"hash"))+Ie.POWER_OPERATOR+this.power.toDecimal():n===ue.PL?e=this.power.toString():e=this.value,e;t===ue.CP?(n===ue.CP&&(e=ue.text(this,"hash")),n===ue.PL?e=this.power.toDecimal():e=this.value):t===ue.CB?n===ue.PL?e=this.power.toDecimal():e=ue.text(this,"hash"):t===ue.EX&&(n===ue.PL?e=ue.text(this.power):e=ue.text(this,"hash"))}return e},collectSymbols(n,t,e,u){let w=[];if(this.symbols)for(let _ in this.symbols){if(!Object.hasOwn(this.symbols,_))continue;let R=this.symbols[_];u&&(R.group===ue.PL||R.group===ue.CP)?w=w.concat(R.collectSymbols()):w.push(n?n(R,t):R)}else w.push(this);return e===null&&(e=void 0),w.sort(e)},collectSummandSymbols(n,t,e,u){let w=[];if(!this.symbols||this.group===ue.CB)w.push(this);else for(let _ in this.symbols){if(!Object.hasOwn(this.symbols,_))continue;let R=this.symbols[_];u&&(R.group===ue.PL||R.group===ue.CP)?w=w.concat(R.collectSymbols()):w.push(n?n(R,t):R)}return e===null&&(e=void 0),w.sort(e)},latex(n){return Nt.latex(this,n)},text(n=void 0){return ue.text(this,n)},isOne(n=!1){let t=n?"absEquals":"equals";return this.group===ue.N?this.multiplier[t](1):this.power.equals(0)},isComposite(){let n=this.group,t=this.previousGroup;return n===ue.CP||n===ue.PL||t===ue.PL||t===ue.CP},isCombination(){let n=this.group,t=this.previousGroup;return n===ue.CB||t===ue.CB},lessThan(n){return this.multiplier.lessThan(n)},greaterThan(n){return ue.isSymbol(n)||(n=new P(n)),!this.isConstant(!0)||!n.isConstant(!0)?!1:this.multiplier.greaterThan(n.multiplier)},getDenom(){let{_:n}=ue,t,e;if(e=this.clone(),this.group===ue.CB&&this.power.lessThan(0)&&(e=n.expand(e)),e.power.lessThan(0)||e.group===ue.EX&&e.power.multiplier.lessThan(0)){let u=n.parse(e.multiplier.den);t=e.toUnitMultiplier(),t.power.negate(),t=n.multiply(u,t)}else if(e.group===ue.CB){t=n.parse(e.multiplier.den);for(let u in e.symbols){if(!Object.hasOwn(e.symbols,u))continue;let w=e.symbols[u];(Number(w.power)<0||w.group===ue.EX&&w.power.multiplier.lessThan(0))&&(t=n.multiply(t,e.symbols[u].clone().invert()))}}else t=n.parse(e.multiplier.den);return t},getNum(){let{_:n}=ue,t,e;return e=this.clone(),e.group===ue.CB&&e.power.lessThan(0)&&(e=n.expand(e)),e.power.greaterThan(0)&&e.group!==ue.CB||e.group===ue.EX&&e.power.multiplier.greaterThan(0)?t=n.multiply(n.parse(e.multiplier.num),e.toUnitMultiplier()):e.group===ue.CB?(t=n.parse(e.multiplier.num),e.each(u=>{(Number(u.power)>0||u.group===ue.EX&&u.power.multiplier.greaterThan(0))&&(t=n.multiply(t,u.clone()))})):t=n.parse(e.multiplier.num),t},toString(){return this.text()}};re.classes.NerdamerSymbol=P;function gn(){let{N:n,P:t,S:e,EX:u,FN:w,PL:_,CB:R,CP:L}=It,{SQRT:X,ABS:z,FACTORIAL:Z,DOUBLEFACTORIAL:j,PARENTHESIS:Ee}=It,{bigDec:Ne,PRIMES:Re,VARS:ie}=It,fe=this,g=fe,H={},de={names:[],actions:[]};function Oe(r,i){this.start=r,this.end=i}Oe.prototype.isConstant=function(){return this.start.isConstant()&&this.end.isConstant()},Oe.prototype.text=function(){return`${Vt(this.start)}:${Vt(this.end)}`};function ve(r,i,s){if(this.type=i,this.value=r,s!==void 0&&(this.column=s+1),i===ve.OPERATOR){let d=K[r];for(let v in d)Object.hasOwn(d,v)&&(this[v]=d[v])}else i===ve.FUNCTION&&(this.precedence=ve.MAX_PRECEDENCE,this.leftAssoc=!1)}ve.prototype.toString=function(){return this.is_prefix?`\`${this.value}`:this.value},ve.OPERATOR="OPERATOR",ve.VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL",ve.FUNCTION="FUNCTION",ve.UNIT="UNIT",ve.KEYWORD="KEYWORD",ve.MAX_PRECEDENCE=999,this.classes={Collection:Rt,Slice:Oe,Token:ve};let we={prec:void 0,cos(r,i){let s=g.parse(String(Math.cos(r)*Math.cosh(i))),d=g.parse(String(Math.sin(r)*Math.sinh(i)));return g.subtract(s,g.multiply(d,P.imaginary()))},sin(r,i){let s=g.parse(String(Math.sin(r)*Math.cosh(i))),d=g.parse(String(Math.cos(r)*Math.sinh(i)));return g.subtract(s,g.multiply(d,P.imaginary()))},tan(r,i){let s=g.parse(String(Math.sin(2*r)/(Math.cos(2*r)+Math.cosh(2*i)))),d=g.parse(String(Math.sinh(2*i)/(Math.cos(2*r)+Math.cosh(2*i))));return g.add(s,g.multiply(d,P.imaginary()))},sec(r,i){let s=this.removeDen(this.cos(r,i));return g.subtract(s[0],g.multiply(s[1],P.imaginary()))},csc(r,i){let s=this.removeDen(this.sin(r,i));return g.add(s[0],g.multiply(s[1],P.imaginary()))},cot(r,i){let s=this.removeDen(this.tan(r,i));return g.subtract(s[0],g.multiply(s[1],P.imaginary()))},acos(r,i){let s=this.fromArray([r,i]),d=g.pow(s.clone(),new P(2)),v=g.expand(d),C=g.multiply(Le(g.subtract(new P(1),v)),P.imaginary()),O=g.expand(g.add(s.clone(),C)),U=b(O);return g.expand(g.multiply(P.imaginary().negate(),U))},asin(r,i){return g.subtract(g.parse("pi/2"),this.acos(r,i))},atan(r,i){if(r.equals(0)&&(i.equals(1)||i.equals(-1)))return g.parse(`${P.infinity()}*${Ie.IMAGINARY}*${i}`);let s=we.fromArray([r,i]),d=g.expand(g.multiply(P.imaginary(),s.clone())),v=b(g.expand(g.subtract(new P(1),d.clone()))),C=b(g.expand(g.add(new P(1),d.clone())));return g.expand(g.multiply(g.divide(P.imaginary(),new P(2)),g.subtract(v,C)))},asec(r,i){let s=this.removeDen([r,i]);return s[1].negate(),this.acos(...s)},acsc(r,i){let s=this.removeDen([r,i]);return s[1].negate(),this.asin(...s)},acot(r,i){let s=this.removeDen([r,i]);return s[1].negate(),this.atan(...s)},cosh(r,i){let s=g.parse(String(Math.cosh(r)*Math.cos(i))),d=g.parse(String(Math.sinh(r)*Math.sin(i)));return g.add(s,g.multiply(d,P.imaginary()))},sinh(r,i){let s=g.parse(String(Math.sinh(r)*Math.cos(i))),d=g.parse(String(Math.cosh(r)*Math.sin(i)));return g.add(s,g.multiply(d,P.imaginary()))},tanh(r,i){let s=g.parse(String(Math.sinh(2*r)/(Math.cos(2*i)+Math.cosh(2*r)))),d=g.parse(String(Math.sin(2*i)/(Math.cos(2*i)+Math.cosh(2*r))));return g.subtract(s,g.multiply(d,P.imaginary()))},sech(r,i){let s=this.removeDen(this.cosh(r,i));return g.subtract(s[0],g.multiply(s[1],P.imaginary()))},csch(r,i){let s=this.removeDen(this.sinh(r,i));return g.subtract(s[0],g.multiply(s[1],P.imaginary()))},coth(r,i){let s=this.removeDen(this.tanh(r,i));return g.add(s[0],g.multiply(s[1],P.imaginary()))},acosh(r,i){let s=this.fromArray([r,i]),d=Le(g.add(s.clone(),new P(1))),v=Le(g.subtract(s.clone(),new P(1)));return g.expand(b(g.add(s,g.expand(g.multiply(d,v)))))},asinh(r,i){let s=this.fromArray([r,i]),d=Le(g.add(new P(1),g.expand(g.pow(s.clone(),new P(2)))));return g.expand(b(g.add(s,d)))},atanh(r,i){let s=this.fromArray([r,i]),d=b(g.add(s.clone(),new P(1))),v=b(g.subtract(new P(1),s));return g.expand(g.divide(g.subtract(d,v),new P(2)))},asech(r,i){let s=this.removeDen([r,i]);return s[1].negate(),this.acosh(...s)},acsch(r,i){let s=this.removeDen([r,i]);return s[1].negate(),this.asinh(...s)},acoth(r,i){let s=this.removeDen([r,i]);return s[1].negate(),this.atanh(...s)},sqrt(r){let i=r.realpart(),s=r.imagpart(),d=P.hyp(i,s),v=g.add(i.clone(),d),C=Le(g.multiply(new P(2),v.clone()));return g.add(g.divide(v.clone(),C.clone()),g.multiply(g.divide(s,C),P.imaginary()))},log(r,i){let s=b(P.hyp(r,i)),d=Ie.USE_BIG?new P(Ne.atan2(i.multiplier.toDecimal(),r.multiplier.toDecimal())):Math.atan2(i,r),v=g.parse(d);return g.add(s,g.multiply(P.imaginary(),v))},erf(r,i){return g.symfunction("erf",[r])},removeDen(r){let i,s;Ft(r)?(i=r[0],s=r[1]):(i=r.realpart(),s=r.imagpart());let d=i**2+s**2,v=g.parse(String(i/d)),C=g.parse(String(s/d));return[v,C]},fromArray(r){return g.add(r[0],g.multiply(P.imaginary(),r[1]))},evaluate(r,i){let s,d,v=r.power.sign();if(r.power=r.power.abs(),r.power.greaterThan(1)&&(r=g.expand(r)),v<0){let C=this.removeDen(r);s=C[0],d=C[1]}else s=r.realpart(),d=r.imagpart();return s.isConstant("all")&&d.isConstant("all")?this[i](s,d):g.symfunction(i,[r])}},qe=this.trig={cos(r){if(r.equals("pi")&&r.multiplier.den.equals(2))return new P(0);if(Ie.PARSE2NUMBER){if(r.equals(new P(Ie.PI/2)))return new P(0);if(r.isConstant())return Ie.USE_BIG?new P(Ne.cos(r.multiplier.toDecimal())):new P(Math.cos(r.valueOf()));if(r.isImaginary())return we.evaluate(r,"cos")}if(r.equals(0))return new P(1);let i,s=!1,d=J(r.multiplier.toDecimal()),v=r.multiplier.abs();if(r.multiplier=v,r.isPi()&&r.isLinear())if(ft(v))i=new P(Pt(v)?1:-1);else{let C=Number(v.num),O=Number(v.den);O===2?i=new P(0):O===3?(i=g.parse("1/2"),s=!0):O===4?(i=g.parse("1/sqrt(2)"),s=!0):O===6?(i=g.parse("sqrt(3)/2"),s=!0):i=g.symfunction("cos",[r])}return s&&(d===2||d===3)&&i.negate(),i||=g.symfunction("cos",[r]),i},sin(r){if(Ie.PARSE2NUMBER){if(r.isConstant())return Number(r.multiplier.toDecimal())%Math.PI===0?new P(0):Ie.USE_BIG?new P(Ne.sin(r.multiplier.toDecimal())):new P(Math.sin(r.valueOf()));if(r.isImaginary())return we.evaluate(r,"sin")}if(r.equals(0))return new P(0);let i,s=!1,d=J(r.multiplier.toDecimal()),v=r.multiplier.sign(),C=r.multiplier.abs();if(r.multiplier=C,r.equals("pi"))i=new P(0);else if(r.isPi()&&r.isLinear())if(ft(C))i=new P(0);else{let O=C.num,U=C.den;U.equals(2)?(i=new P(1),s=!0):U.equals(3)?(i=g.parse("sqrt(3)/2"),s=!0):U.equals(4)?(i=g.parse("1/sqrt(2)"),s=!0):U.equals(6)?(i=g.parse("1/2"),s=!0):i=g.multiply(new P(v),g.symfunction("sin",[r]))}return i||=g.multiply(new P(v),g.symfunction("sin",[r])),s&&(d===3||d===4)&&i.negate(),i},tan(r){if(Ie.PARSE2NUMBER){if(Number(r.multiplier.toDecimal())%Math.PI===0&&r.isLinear())return new P(0);if(r.isConstant())return Ie.USE_BIG?new P(Ne.tan(r.multiplier.toDecimal())):new P(Math.tan(r.valueOf()));if(r.isImaginary())return we.evaluate(r,"tan")}let i,s=!1,d=J(r.multiplier.toDecimal()),v=r.multiplier;if(r.multiplier=v,r.isPi()&&r.isLinear())if(ft(v))i=new P(0);else{let C=v.num,O=v.den;if(O.equals(2))throw new Xt(`tan is undefined for ${r.toString()}`);O.equals(3)?(i=g.parse("sqrt(3)"),s=!0):O.equals(4)?(i=new P(1),s=!0):O.equals(6)?(i=g.parse("1/sqrt(3)"),s=!0):i=g.symfunction("tan",[r])}return i||=g.symfunction("tan",[r]),s&&(d===2||d===4)&&i.negate(),i},sec(r){if(Ie.PARSE2NUMBER)return r.isConstant()?Ie.USE_BIG?new P(new Ne(1).dividedBy(Ne.cos(r.multiplier.toDecimal()))):new P(Ye.sec(r.valueOf())):r.isImaginary()?we.evaluate(r,"sec"):g.parse(Tt("1/cos({0})",r));let i,s=!1,d=J(r.multiplier.toDecimal()),v=r.multiplier.abs();if(r.multiplier=v,r.isPi()&&r.isLinear())if(ft(v))i=new P(Pt(v)?1:-1);else{let C=v.num,O=v.den;if(O.equals(2))throw new Xt(`sec is undefined for ${r.toString()}`);O.equals(3)?(i=new P(2),s=!0):O.equals(4)?(i=g.parse("sqrt(2)"),s=!0):O.equals(6)?(i=g.parse("2/sqrt(3)"),s=!0):i=g.symfunction("sec",[r])}return s&&(d===2||d===3)&&i.negate(),i||=g.symfunction("sec",[r]),i},csc(r){if(Ie.PARSE2NUMBER)return r.isConstant()?Ie.USE_BIG?new P(new Ne(1).dividedBy(Ne.sin(r.multiplier.toDecimal()))):new P(Ye.csc(r.valueOf())):r.isImaginary()?we.evaluate(r,"csc"):g.parse(Tt("1/sin({0})",r));let i,s=!1,d=J(r.multiplier.toDecimal()),v=r.multiplier.sign(),C=r.multiplier.abs();if(r.multiplier=C,r.isPi()&&r.isLinear()){if(ft(C))throw new Xt(`csc is undefined for ${r.toString()}`);{let O=C.num,U=C.den;U.equals(2)?(i=new P(1),s=!0):U.equals(3)?(i=g.parse("2/sqrt(3)"),s=!0):U.equals(4)?(i=g.parse("sqrt(2)"),s=!0):U.equals(6)?(i=new P(2),s=!0):i=g.multiply(new P(v),g.symfunction("csc",[r]))}}return i||=g.multiply(new P(v),g.symfunction("csc",[r])),s&&(d===3||d===4)&&i.negate(),i},cot(r){if(Ie.PARSE2NUMBER)return Number(r.multiplier.toDecimal())%(Math.PI/2)===0?new P(0):r.isConstant()?Ie.USE_BIG?new P(new Ne(1).dividedBy(Ne.tan(r.multiplier.toDecimal()))):new P(Ye.cot(r.valueOf())):r.isImaginary()?we.evaluate(r,"cot"):g.parse(Tt("1/tan({0})",r));let i,s=!1,d=J(r.multiplier.toDecimal()),v=r.multiplier;if(r.multiplier=v,r.isPi()&&r.isLinear()){if(ft(v))throw new Xt(`cot is undefined for ${r.toString()}`);{let C=v.num,O=v.den;O.equals(2)?i=new P(0):O.equals(3)?(i=g.parse("1/sqrt(3)"),s=!0):O.equals(4)?(i=new P(1),s=!0):O.equals(6)?(i=g.parse("sqrt(3)"),s=!0):i=g.symfunction("cot",[r])}}return i||=g.symfunction("cot",[r]),s&&(d===2||d===4)&&i.negate(),i},acos(r){if(Ie.PARSE2NUMBER){if(r.isConstant()){if(r.gt(1)||r.lt(-1)){let i=r.toString();return pe(vt(`pi/2-asin(${i})`))}return Ie.USE_BIG?new P(Ne.acos(r.multiplier.toDecimal())):new P(Math.acos(r.valueOf()))}if(r.isImaginary())return we.evaluate(r,"acos")}return g.symfunction("acos",[r])},asin(r){if(Ie.PARSE2NUMBER){if(r.isConstant()){if(r.gt(1)||r.lt(-1)){let i=Ie.IMAGINARY,s=r.multiplier.toDecimal();return pe(vt(`${i}*log(sqrt(1-${s}^2)-${i}*${s})`))}return Ie.USE_BIG?new P(Ne.asin(r.multiplier.toDecimal())):new P(Math.asin(r.valueOf()))}if(r.isImaginary())return we.evaluate(r,"asin")}return g.symfunction("asin",[r])},atan(r){let i;if(r.equals(0))i=new P(0);else{if(Ie.PARSE2NUMBER)return r.isConstant()?Ie.USE_BIG?new P(Ne.atan(r.multiplier.toDecimal())):new P(Math.atan(r.valueOf())):r.isImaginary()?we.evaluate(r,"atan"):g.symfunction("atan",[r]);r.equals(-1)?i=g.parse("-pi/4"):i=g.symfunction("atan",[r])}return i},asec(r){if(Ie.PARSE2NUMBER){if(r.equals(0))throw new an("Input is out of the domain of sec!");if(r.isConstant())return qe.acos(r.invert());if(r.isImaginary())return we.evaluate(r,"asec")}return g.symfunction("asec",[r])},acsc(r){if(Ie.PARSE2NUMBER){if(r.isConstant())return qe.asin(r.invert());if(r.isImaginary())return we.evaluate(r,"acsc")}return g.symfunction("acsc",[r])},acot(r){if(Ie.PARSE2NUMBER){if(r.isConstant())return g.add(g.parse("pi/2"),qe.atan(r).negate());if(r.isImaginary())return we.evaluate(r,"acot")}return g.symfunction("acot",[r])},atan2(r,i){if(r.equals(0)&&i.equals(0))throw new Xt("atan2 is undefined for 0, 0");return Ie.PARSE2NUMBER&&r.isConstant()&&i.isConstant()?new P(Math.atan2(r,i)):g.symfunction("atan2",[r,i])}},Se=this.trigh={cosh(r){if(Ie.PARSE2NUMBER){if(r.isConstant())return new P(Math.cosh(r.valueOf()));if(r.isImaginary())return we.evaluate(r,"cosh")}return g.symfunction("cosh",[r])},sinh(r){if(Ie.PARSE2NUMBER){if(r.isConstant())return new P(Math.sinh(r.valueOf()));if(r.isImaginary())return we.evaluate(r,"sinh")}return g.symfunction("sinh",[r])},tanh(r){if(Ie.PARSE2NUMBER){if(r.isConstant())return new P(Math.tanh(r.valueOf()));if(r.isImaginary())return we.evaluate(r,"tanh")}return g.symfunction("tanh",[r])},sech(r){return Ie.PARSE2NUMBER?r.isConstant()?new P(Math.sech(r.valueOf())):r.isImaginary()?we.evaluate(r,"sech"):g.parse(Tt("1/cosh({0})",r)):g.symfunction("sech",[r])},csch(r){return Ie.PARSE2NUMBER?r.isConstant()?new P(Math.csch(r.valueOf())):r.isImaginary()?we.evaluate(r,"csch"):g.parse(Tt("1/sinh({0})",r)):g.symfunction("csch",[r])},coth(r){return Ie.PARSE2NUMBER?r.isConstant()?new P(Math.coth(r.valueOf())):r.isImaginary()?we.evaluate(r,"coth"):g.parse(Tt("1/tanh({0})",r)):g.symfunction("coth",[r])},acosh(r){let i;return Ie.PARSE2NUMBER&&r.isImaginary()?i=we.evaluate(r,"acosh"):Ie.PARSE2NUMBER?i=vt(g.parse(Tt(`${Ie.LOG}(({0})+sqrt(({0})^2-1))`,r.toString()))):i=g.symfunction("acosh",[r]),i},asinh(r){let i;return Ie.PARSE2NUMBER&&r.isImaginary()?i=we.evaluate(r,"asinh"):Ie.PARSE2NUMBER?i=vt(g.parse(Tt(`${Ie.LOG}(({0})+sqrt(({0})^2+1))`,r.toString()))):i=g.symfunction("asinh",[r]),i},atanh(r){let i;return Ie.PARSE2NUMBER&&r.isImaginary()?i=we.evaluate(r,"atanh"):Ie.PARSE2NUMBER?i=vt(g.parse(Tt(`(1/2)*${Ie.LOG}((1+({0}))/(1-({0})))`,r.toString()))):i=g.symfunction("atanh",[r]),i},asech(r){let i;return Ie.PARSE2NUMBER&&r.isImaginary()?i=we.evaluate(r,"asech"):Ie.PARSE2NUMBER?i=vt(b(g.add(r.clone().invert(),Le(g.subtract(g.pow(r,new P(-2)),new P(1)))))):i=g.symfunction("asech",[r]),i},acsch(r){let i;return Ie.PARSE2NUMBER&&r.isImaginary()?i=we.evaluate(r,"acsch"):Ie.PARSE2NUMBER?i=vt(g.parse(Tt(`${Ie.LOG}((1+sqrt(1+({0})^2))/({0}))`,r.toString()))):i=g.symfunction("acsch",[r]),i},acoth(r){let i;return Ie.PARSE2NUMBER&&r.isImaginary()?i=we.evaluate(r,"acoth"):Ie.PARSE2NUMBER?r.equals(1)?i=P.infinity():i=vt(g.divide(b(g.divide(g.add(r.clone(),new P(1)),g.subtract(r.clone(),new P(1)))),new P(2))):i=g.symfunction("acoth",[r]),i}};this.units={};let K={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(r){return r}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(r){return g.symfunction(Ie.DOUBLEFACTORIAL,[r])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(r){return k(r)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(r){return g.divide(r,new P(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(r){return r}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(r){return r}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(r){return r.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},l={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},p=this.functions={cos:[qe.cos,1],sin:[qe.sin,1],tan:[qe.tan,1],sec:[qe.sec,1],csc:[qe.csc,1],cot:[qe.cot,1],acos:[qe.acos,1],asin:[qe.asin,1],atan:[qe.atan,1],arccos:[qe.acos,1],arcsin:[qe.asin,1],arctan:[qe.atan,1],asec:[qe.asec,1],acsc:[qe.acsc,1],acot:[qe.acot,1],atan2:[qe.atan2,2],acoth:[Se.acoth,1],asech:[Se.asech,1],acsch:[Se.acsch,1],sinh:[Se.sinh,1],cosh:[Se.cosh,1],tanh:[Se.tanh,1],asinh:[Se.asinh,1],sech:[Se.sech,1],csch:[Se.csch,1],coth:[Se.coth,1],acosh:[Se.acosh,1],atanh:[Se.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[Xe,1],radians:[ye,1],degrees:[De,1],min:[c,-1],max:[a,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[$e,1],tri:[void 0,1],sign:[A,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[k,1],factorial:[k,1],continuedFraction:[se,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[Q,[1,2]],scientific:[Qe,[1,2]],mod:[ce,2],pfactor:[$,1],vector:[At,-1],matrix:[Dt,-1],NerdamerSet:[lt,-1],imatrix:[Ce,-1],parens:[F,-1],sqrt:[Le,1],cbrt:[Ve,1],nthroot:[Ae,2],log:[b,[1,2]],expand:[ne,1],abs:[I,1],invert:[a0,1],determinant:[Ct,1],size:[qt,1],transpose:[Jt,1],dot:[Ot,2],cross:[Lt,2],vecget:[Te,2],vecset:[xe,3],vectrim:[Fe,[1,2]],matget:[He,3],matset:[pt,4],matgetrow:[je,2],matsetrow:[ze,3],matgetcol:[at,2],matsetcol:[nt,3],rationalize:[We,1],IF:[Me,3],isIn:[me,2],realpart:[W,1],imagpart:[Y,1],conjugate:[q,1],arg:[ee,1],polarform:[B,1],rectform:[T,1],sort:[x,[1,2]],integer_part:[void 0,1],union:[Yt,2],contains:[Kt,2],intersection:[r0,2],difference:[w0,2],intersects:[it,2],isSubset:[Y0,2],primes:[K0,2],print:[h,-1]};this.error=xt;let o=function(r){let i=Ie.FUNCTION_MODULES,s=i.length;for(let d=0;d<s;d++){let v=i[d];if(r in v)return v[r]}return xt(`The function ${r} is undefined!`)};this.override=function(i,s){H[i]||=[],H[i].push(this[i]),this[i]=s},this.restore=function(i){this[i]&&=H[i].pop()},this.extend=function(i,s,d){let v=this;if(typeof this[i]=="function"&&typeof s=="function"){let O=this[i];this[i]=function(te,oe){return ct(te)&&ct(oe)&&!d?O.call(v,te,oe):s.call(v,te,oe,O)}}},this.symfunction=function(i,s){let d=new P(i);return d.group=w,typeof s=="object"&&(s=[].slice.call(s)),d.args=s,d.fname=i===Ee?"":i,d.updateHash(),d},this.callfunction=function(i,s,d=void 0){let v=p[i];v||xt(`Nerdamer currently does not support the function ${i}`);let C=v[1]||d,O=v[0],U;if(s instanceof Array||(s=s===void 0?[]:[s]),C!==-1){let oe=Ft(C),he=oe?C[0]:C,le=oe?C[1]:C,Pe=s.length,Ze=`${i} requires a {0} of {1} arguments. {2} provided!`;Pe<he&&xt(Tt(Ze,"minimum",he,Pe)),Pe>le&&xt(Tt(Ze,"maximum",le,Pe))}let te=tn(s);return O?U=O.apply(v[2],s):(O=o(i),Ie.PARSE2NUMBER&&te?U=G(O.apply(O,s)):U=g.symfunction(i,s)),U},this.operator_filter_regex=(function(){let i=`^\\${Object.keys(K).filter(s=>s.length===1).join("\\")}`;return new RegExp(`([${i}])\\s+([${i}])`)})(),this.setOperator=function(i,s=void 0,d=void 0){let v=i.operator;if(K[v]=i,s&&(this[i.action]=s),fe[v]=i.operation,!i.action&&!(i.prefix||i.postif)&&(i.action=v),d==="over"||d==="under"){let{precedence:C}=i;for(let O in K){if(!Object.hasOwn(K,O))continue;let U=K[O];(d==="over"?U.precedence>=C:U.precedence>C)&&U.precedence++}}},this.getOperator=function(i){return K[i]},this.aliasOperator=function(i,s){let d={},v=K[i];for(let C in v)Object.hasOwn(v,C)&&(d[C]=v[C]);d.operator=s,this.setOperator(d)},this.getOperators=function(){return K},this.getBrackets=function(){return l};let f=function(i,s){i=String(i);for(let d=0;d<de.actions.length;d++)i=de.actions[d].call(s,i);for(i=i.replace(/\s+/gu," "),/e/giu.test(i)&&(i=i.replace(/-+\d+\.?\d*e\+?-?\d+/giu,d=>L0(d)),i=i.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,d=>L0(d))),i=i.replace(Ie.IMPLIED_MULTIPLICATION_REGEX,(d,v,C,O,U)=>{let te=U.charAt(O),oe="",he="*";return te.match(/[+\-/*]/u)||(oe=U.charAt(O-1)),oe.match(/[a-z]/iu)&&(he=""),v+he+C}).replace(/(?<varname>[a-z0-9_]+)/giu,(d,v)=>Ie.USE_MULTICHARACTER_VARS===!1&&!(v in p)&&isNaN(v)?v.split("").join("*"):v).replace(/\)\(/gu,")*(")||"0";;){let d=i;if(i=i.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,(v,C,O,U,te)=>{let oe=C||U,he=O||te;return oe in p?oe+he:`${oe}*${he}`}),d===i)break}return i};this.initConstants=function(){this.CONSTANTS={E:new P(Ie.E),PI:new P(Ie.PI)}},this.prettyPrint=function(i){if(Array.isArray(i)){let s=i,d=s.map(v=>g.prettyPrint(v)).join(", ");return s.type==="vector"?`vector<${d}>`:`(${d})`}return i.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(i,...s){if(Ie.callPeekers){let d=this.peekers[i],v=s.map(M1);for(let C=0;C<d.length;C++)d[C].apply(null,v)}},this.tokenize=function(i){i=String(i),i=i.trim().replace(/\s+/gu," ");for(let st in l){if(!Object.hasOwn(l,st))continue;let gt=new RegExp(l[st].is_close?`\\s+\\${st}`:`\\${st}\\s+`,"g");i=i.replace(gt,st)}let s=0,d=i.length,v=0,C=[],O=[C],U=O[0],te=0,oe=[],he=!1,le,Pe=" ",Ze="",et=",",Ue="-",_e="*",Ge=function(st=void 0,gt=void 0){let tt=[];st!==void 0&&(tt.type=st),tt.column=gt,O.push(tt),U.push(tt),U=tt,te++},be=function(){O.pop(),U=O[--te]},Je=function(st){st=st===void 0?s:st;let gt=st+1;for(;i.charAt(gt++)in K;);return i.substring(st,gt-1)},ut=function(st){let gt=s-st.length,tt=[],rt=st.charAt(0),q0=st.length,p0;for(p0=1;p0<q0;p0++){let Cn=st.charAt(p0),In=rt+Cn;In in K?rt=In:(tt.push(new ve(rt,ve.OPERATOR,gt+p0)),rt=Cn)}return tt.push(new ve(rt,ve.OPERATOR,gt+p0)),tt},Ke=function(st,gt=void 0){gt===void 0&&(gt=i.substring(v,st)),gt in g.units?U.push(new ve(gt,ve.UNIT,v)):gt!==""&&U.push(new ve(gt,ve.VARIABLE_OR_LITERAL,v))},Et=function(st){U.push(new ve(st,ve.FUNCTION,v))},Mt=function(st){v=st+1},jt=function(){v=v+le.length-2,s=v-1};for(;s<d;s++){let st=i.charAt(s);if(st in K){Ke(s);let tt=U[0]&&Bn(U[0])&&st===_e;he&&v<s&&!(st===et||tt)&&(he=!1,be()),Mt(s+1),le=Je(s),jt(),U.push(...ut(le))}else if(st in l){let gt=l[st];if(gt.is_open){oe.push([gt,v]);let tt=i.substring(v,s);tt in p?Et(tt):tt!==""&&U.push(new ve(tt,ve.VARIABLE_OR_LITERAL,v)),Ge(gt.maps_to,s)}else if(gt.is_close){let tt=oe.pop();if(tt){if(tt[0].id!==gt.id-1)throw new G0("Parity error")}else throw new G0(`Missing open bracket for bracket at: ${s+1}`);Ke(s),be()}Mt(s)}else if(st===Pe){let gt=i.substring(v,s),tt=i.charAt(s+1);if(he){if(gt in K)U.push(new ve(gt,ve.OPERATOR,s));else{Ke(void 0,gt),be();let rt=tt in K;(rt&&K[tt].value===Ue||!rt)&&U.push(new ve(_e,ve.OPERATOR,s))}he=!1}else{let rt=i.substring(v,s);rt in p?(he=!0,Et(rt),Ge()):rt in K?U.push(new ve(rt,ve.OPERATOR,s)):(Ke(void 0,rt),tt=i.charAt(s+1),gt!==Ze&&tt!==Ze&&!(gt in K)&&!(tt in K)&&U.push(new ve(_e,ve.OPERATOR,s)))}Mt(s)}}if(oe.length){let st=oe.pop();throw new G0(`Missing closed bracket for bracket at ${st[1]+1}`)}return Ke(s),C},this.toRPN=function(i){let s=i.type,d=i.length,v,C,O=[],U=[],te=[],oe=function(le,Pe){for(;le.length;)Pe.push(le.pop())};for(v=0;v<d;v++){let he=i[v];if(he.type!==ve.OPERATOR)break;if(!he.prefix)throw new A0("Not a prefix operator");he.is_prefix=!0,U.push(he)}for(;v<d;v++){if(C=i[v],C.type===ve.OPERATOR){let he=C;if(he.overloaded){let le=i[v+1];le&&le.type===ve.VARIABLE_OR_LITERAL&&(he.postfix=!1,he.action=he.overloadAction,he.leftAssoc=he.overloadLeftAssoc)}for(;U.length;){let le=U[U.length-1];if(!(le.precedence>he.precedence||!he.leftAssoc&&le.precedence===he.precedence))break;O.push(U.pop())}if((s==="vector"||s==="set")&&"vectorFn"in he&&(he.action=he.vectorFn),he.postfix){let le=i[v-1];if(le){if(le.type===ve.OPERATOR&&!le.postfix)throw new A0(`Unexpected prefix operator '${le.value}'! at ${le.column}`)}else throw new A0(`Unexpected prefix operator '${C.value}'! at ${C.column}`)}else{let le;do{let Pe=i[v+1];if(le=Pe?Pe.type===ve.OPERATOR:!1,le){if(!Pe.prefix)throw new A0(`A prefix operator was expected at ${Pe.column}`);Pe.is_prefix=!0,te.push(Pe),v++}}while(le)}for(he.is_prefix?te.push(he):U.push(he);te.length&&(he.leftAssoc||!he.leftAssoc&&te[te.length-1].precedence>=he.precedence);)U.push(te.pop())}else if(C.type===ve.VARIABLE_OR_LITERAL){O.length===0&&oe(te,U),O.push(C);let he=U[U.length-1];(!he||!he.leftAssoc)&&oe(te,O)}else C.type===ve.FUNCTION?U.push(C):C.type===ve.UNIT&&O.push(C);if(Array.isArray(C)){let he=C;O.push(this.toRPN(C)),he.type&&O.push(new ve(he.type,ve.FUNCTION,he.column))}}return oe(U,O),oe(te,O),O},this.parseRPN=function(i,s){try{s||={};for(let O in s)Object.hasOwn(s,O)&&(s[O]=g.parse(s[O],{}));Ie.PARSE2NUMBER&&("e"in s||(s.e=new P(Ie.E)),"pi"in s||(s.pi=new P(Ie.PI)));let d=[],v;for(let O=0,U=i.length;O<U;O++)if(v=i[O],Array.isArray(v)&&(v=this.parseRPN(v,s)),v)if(v.type===ve.OPERATOR)if(v.is_prefix||v.postfix)d.push(v.operation(d.pop()));else{let te=d.pop(),oe=d.pop();if(typeof oe>"u")throw new A0(`${v} is not a valid postfix operator at ${v.column}`);let he=v.action==="comma";oe instanceof n0&&!he&&(oe=wt.fromSet(oe)),te instanceof n0&&!he&&(te=wt.fromSet(te)),this.callPeekers("pre_operator",oe,te,v);let le=g[v.action](oe,te);this.callPeekers("post_operator",le,oe,te,v),d.push(le)}else if(v.type===ve.FUNCTION){let te=d.pop(),{parent:oe}=te;te instanceof Rt||(te=Rt.create(te));let he=v.value,le=te.getItems();this.callPeekers("pre_function",he,le);let Pe=g.callfunction(he,le);this.callPeekers("post_function",Pe,he,le);let Ze=d[d.length-1],et=i[O+1],Ue=et&&et.type===ve.OPERATOR&&et.value===",";oe&&(Pe.parent=oe),d.push(Pe)}else{let te,oe=v.value;if(oe in Ie.ALIASES)v=g.parse(Ie.ALIASES[v]);else if(v.type===ve.VARIABLE_OR_LITERAL)v=new P(oe);else if(v.type===ve.UNIT){let he=new P(oe);he.isUnit=!0,v=he}oe in g.CONSTANTS?(te=v,v=new P(g.CONSTANTS[oe])):oe in s&&oe!==s[oe].toString()?(te=v,v=s[oe].clone()):oe in ie&&(te=v,v=ie[oe].clone()),te&&(v.subbed=te),d.push(v)}let C=d[0];if(["undefined","string","number"].indexOf(typeof C)!==-1)throw new Hn("Unexpected token!");return C}catch(d){if(d.message==="timeout")throw d;[an].forEach(O=>{if(d instanceof O){let U=d.column;throw new O(`${d.message}${U?`: ${U}`:""}`)}});let C=d.column;throw new Vn(`${d.message}${C?`: ${C}`:""}`)}};function m(r){this.type=r.type,this.value=r.value,this.left=r.left,this.right=r.right}m.prototype.toString=function(){let i=this.left?`${this.left.toString()}---`:"",s=this.right?`---${this.right.toString()}`:"";return`${i}(${this.value})${s}`},m.prototype.toHTML=function(i,s){i||=0,s=typeof s>"u"?4:s;let d=function(te){return" ".repeat(s*te)},v="",C=this.left?`${d(i+1)}<li>
${this.left.toHTML(i+2,s)}${d(i+1)}</li> 
`:"",O=this.right?`${d(i+1)}<li>
${this.right.toHTML(i+2,s)}${d(i+1)}</li>
`:"";return v=`${d(i)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${d(i)}
`,(C||O)&&(v+=`${d(i)}<ul>
${C}${O}${d(i)}</ul>
`),v},this.tree=function(i){let s=[];for(let d=0;d<i.length;d++){let v=i[d];if(Array.isArray(v)){v=this.tree(v),s.push(v);continue}if(v.type===ve.OPERATOR)if(v.is_prefix||v.postfix){let C=v.is_prefix?"left":"right",O=s.pop();v=new m(v),v[C]=O,s.push(v)}else v=new m(v),v.right=s.pop(),v.left=s.pop(),s.push(v);else if(v.type===ve.FUNCTION){v=new m(v);let C=s.pop();if(v.right=C,v.value==="object"){let O=s[s.length-1];if(O){for(;O.right;)O=O.right;O.right=v;continue}}s.push(v)}else s.push(new m(v))}return s[0]},this.parse=function(i,s){i=f(i,this),s||={};let d=this.tokenize(i),v=this.toRPN(d);return this.parseRPN(v,s)},this.toObject=function(i){return function d(v){let C=[];for(let O=0,U=v.length;O<U;O++){let te=v[O],oe=te.value;if(te.type===ve.VARIABLE_OR_LITERAL)C.push(new P(oe));else if(te.type===ve.FUNCTION){O++;let he=g.symfunction(oe,d(v[O]));he.isConversion=!0,C.push(he)}else te.type===ve.OPERATOR?C.push(oe):C.push(d(te))}return C}(g.tokenize(i))};let S=function(i){let s=0,d=[[]];for(let v=0,C=i.length;v<C;v++)i[v]===","?(s++,d[s]=[]):d[s].push(i[v]);return d},M=function(r){return r.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(i,s)=>s||i)},V=function(r){let i=[];for(;r.length;){let s=r.shift(),d=r[0],v=Ft(d),C=d==="-";if(s==="^"&&(d==="+"?r.shift():v&&d[0]==="+"&&d.shift(),v&&d.length===1&&r.unshift(r.shift()[0])),s==="^"&&(v&&d[0]==="-"||C)){let O=i.pop(),U=i[i.length-1],te="1";U==="*"?(i.pop(),te=i.pop()):Ft(U)&&(te=i.pop()),i.push(te,"/",O,s),v?d.shift():r.shift(),v&&d.length===1&&i.push(r.shift()[0])}else i.push(s)}return i};this.toTeX=function(i,s){s||={};let d=s.decimals===!0?"decimals":void 0,v=typeof i=="string"?this.toObject(i):i,C=[],O=typeof s.cdot>"u"?"\\cdot":s.cdot;if(v=V(v),Ft(v)){let U=[],te,oe;for(let he=0;he<v.length;he++)te=v[he],v[he+1]==="^"?(oe=v[he+2],U.push(`${Nt.braces(this.toTeX([te]))}^${Nt.braces(this.toTeX([oe]))}`),he+=2):U.push(te);v=U}for(let U=0,te=v.length;U<te;U++){let oe=v[U];if(oe==="*"&&(oe=O),ct(oe))if(oe.group===w){let{fname:he}=oe,le;if(he===X)le=`\\sqrt${Nt.braces(this.toTeX(oe.args))}`;else if(he===z)le=Nt.brackets(this.toTeX(oe.args),"abs");else if(he===Ee)le=Nt.brackets(this.toTeX(oe.args),"parens");else if(he===Ie.LOG10)le=`\\${Ie.LOG10_LATEX}\\left( ${this.toTeX(oe.args)}\\right)`;else if(he===Ie.LOG2)le=`\\${Ie.LOG2_LATEX}\\left( ${this.toTeX(oe.args)}\\right)`;else if(he===Ie.LOG1P)le=`\\${Tt(Ie.LOG1P_LATEX,this.toTeX(oe.args))}`;else if(he==="integrate"){let Pe=S(oe.args),Ze=Nt.braces(this.toTeX(Pe[0])),et=this.toTeX(Pe[1]);le=`\\int ${Ze}\\, d${et}`}else if(he==="defint"){let Pe=S(oe.args),Ze=Nt.braces(this.toTeX(Pe[0])),et=this.toTeX(Pe[3]),Ue=this.toTeX(Pe[1]),_e=this.toTeX(Pe[2]);le=`\\int\\limits_{${Ue}}^{${_e}} ${Ze}\\, d${et}`}else if(he==="diff"){let Pe=S(oe.args),Ze="",et=Nt.braces(this.toTeX(Pe[0]));if(Pe.length===1){let Ue=[];for(let _e=0;_e<Pe[0].length;_e++)Pe[0][_e].group===3&&Ue.push(Pe[0][_e].value);Ue.sort(),Ze=Ue.length>0?`\\frac{d}{d ${Ue[0]}}`:"\\frac{d}{d x}"}else Pe.length===2?Ze=`\\frac{d}{d ${Pe[1]}}`:Ze=`\\frac{d^{${Pe[2]}}}{d ${this.toTeX(Pe[1])}^{${Pe[2]}}}`;le=`${Ze}\\left(${et}\\right)`}else if(he==="sum"||he==="product"){let Pe=[[],[],[],[]],Ze=0;for(let et=0;et<oe.args.length;et++){if(oe.args[et]===","){Ze++;continue}Pe[Ze].push(oe.args[et])}le=(he==="sum"?"\\sum_":"\\prod_")+Nt.braces(`${this.toTeX(Pe[1])} = ${this.toTeX(Pe[2])}`),le+=`^${Nt.braces(this.toTeX(Pe[3]))}${Nt.braces(this.toTeX(Pe[0]))}`}else if(he==="limit"){let Pe=this.toTeX.bind(this),Ze=g,et=S(oe.args).map(Ue=>Array.isArray(Ue)?Ze.toTeX(Ue.join("")):Pe(String(Ue)));le=`\\lim_${Nt.braces(`${et[1]}\\to ${et[2]}`)} ${Nt.braces(et[0])}`}else he===Z||he===j?le=this.toTeX(oe.args)+(he===Z?"!":"!!"):le=Nt.latex(oe,d);C.push(le)}else C.push(Nt.latex(oe,d));else Ft(oe)?C.push(Nt.brackets(this.toTeX(oe))):oe==="/"?C.push(Nt.frac(M(C.pop()),M(this.toTeX([v[++U]])))):C.push(oe)}return C.join(" ")};function F(r){return Ie.PARSE2NUMBER?r:g.symfunction("parens",[r])}function I(r){if(r.isInfinity)return P.infinity();if(r.multiplier.lessThan(0)&&r.multiplier.negate(),r.isImaginary()){let s=r.realpart(),d=r.imagpart();if(s.isConstant()&&d.isConstant())return Le(g.add(g.pow(s,new P(2)),g.pow(d,new P(2))))}else{if(I0(r)||Pt(r.power))return r;if(jn(r)&&typeof r.value=="string"&&r.value.startsWith("baseunit_"))return r}if(r.isComposite()){let s=[];r.each(v=>{s.push(v.multiplier)}),Ye.QGCD.apply(null,s).lessThan(0)&&(r.multiplier=r.multiplier.multiply(new ke(-1)),r.distributeMultiplier())}let i=g.parse(r.multiplier);return r.toUnitMultiplier(),g.multiply(i,g.symfunction(z,[r]))}function k(r){let i;if(St(r)){let s=new wt;return r.each((d,v)=>{s.set(v-1,k(d))}),s}if(dt(r)){let s=new ot;return r.each((d,v,C)=>{s.set(v,C,k(d))}),s}if(Ie.PARSE2NUMBER&&r.isConstant())return ft(r)?i=Ye.bigfactorial(r):i=Ye.gamma(r.multiplier.add(new ke(1)).toDecimal()),i=G(i),i;if(r.isConstant()&&r.getDenom().equals(2)){let d=r.getNum(),v,C,O;r.multiplier.isNegative()?(O=g.subtract(d.negate(),new P(1)).multiplier.divide(new ke(2)),v=g.pow(new P(-4),new P(O)).multiplier.multiply(Ye.bigfactorial(O)),C=Ye.bigfactorial(new ke(2).multiply(O))):(O=g.add(d,new P(1)).multiplier.divide(new ke(2)),v=Ye.bigfactorial(new ke(2).multiply(O)),C=g.pow(new P(4),new P(O)).multiplier.multiply(Ye.bigfactorial(O)));let U=v.divide(C);return g.multiply(g.parse("sqrt(pi)"),new P(U))}return g.symfunction(Z,[r])}function se(r,i){let s=vt(r);if(s.isConstant()){let d=Ye.continuedFraction(s,i),v=wt.fromArray(d.fractions.map(C=>new P(C)));return wt.fromArray([new P(d.sign),new P(d.whole),v])}return g.symfunction("continuedFraction",[r,i])}function ae(r){let i=vt(r);return i.isConstant()?new P(Ye.erf(i)):i.isImaginary()?we.erf(r):g.symfunction("erf",[r])}function ce(r,i){if(r.isConstant()&&i.isConstant()){let d=new P(1);return d.multiplier=d.multiplier.multiply(r.multiplier.mod(i.multiplier)),d}let s=g.divide(r.clone(),i.clone());return ft(s)?new P(0):g.symfunction("mod",[r,i])}function Me(r,i,s){return typeof r!="boolean"&&I0(r)&&(r=!!Number(r)),r?i:s}function me(r,i){if(dt(r)){for(let s=0,d=r.rows();s<d;s++)for(let v=0,C=r.cols();v<C;v++)if(r.elements[s][v].equals(i))return new P(1)}else if(r.elements){for(let s=0,d=r.elements.length;s<d;s++)if(r.elements[s].equals(i))return new P(1)}return new P(0)}function $e(r){return Ie.PARSE2NUMBER?r.isConstant()?new P(Ye.sinc(r)):g.parse(Tt("sin({0})/({0})",r)):g.symfunction("sinc",[r])}function Xe(r){return r.fname===Ie.LOG&&r.isLinear()?g.pow(r.args[0],P.create(r.multiplier)):g.parse(Tt("e^({0})",r))}function ye(r){return g.parse(Tt("({0})*pi/180",r))}function De(r){return g.parse(Tt("({0})*180/pi",r))}function Be(r){let i,s,d;if(r.group===w&&r.fname===""?(i=P.unwrapPARENS(g.parse(r).toLinear()),s=g.parse(r.power)):r.group===t&&(i=g.parse(r.value),s=g.parse(r.power)),i&&s&&i.group===n&&s.group===n){d=[];let v=P.toPolarFormArray(r),C=g.parse(i).abs().toString(),O=ee(i).toString(),U=s.multiplier.den.toString(),te=s.multiplier.num.toString(),oe="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let he=0;he<Number(U);he++){let le=vt(g.parse(Tt("(({0})+2*pi*({1}))/({2})",O,he,U))).multiplier.toDecimal();d.push(vt(g.parse(Tt(oe,C,U,Ie.IMAGINARY,le,te))))}return wt.fromArray(d)}if(r.isConstant(!0)){let v=r.sign(),C=vt(r.abs()),O=g.sqrt(C);d=[O.clone(),O.negate()],v<0&&(d=d.map(U=>g.multiply(U,P.imaginary())))}else d=[g.parse(r)];return wt.fromArray(d)}function We(r){if(r.isComposite()){let i=new P(0),s,d,v,C,O,U,te,oe;return r.each(he=>{s=he.getNum(),d=he.getDenom(),v=i.getNum(),C=i.getDenom(),O=g.multiply(d,v),U=g.multiply(s,C),te=g.expand(g.add(O,U)),oe=g.multiply(C,d),i=g.divide(te,oe)},!0),i}return r}function Le(r){ct(r)||(r=g.parse(r));let i=g.symfunction("sqrt",[r]);if(r.group===u)return g.symfunction(X,[r]);r.fname===""&&r.power.equals(1)&&(r=r.args[0]);let s=r.multiplier.sign()<0;if(Ie.PARSE2NUMBER){if(r.isConstant()&&!s)return new P(Ne.sqrt(r.multiplier.toDecimal()));if(r.isImaginary())return we.sqrt(r);if(r.group===e)return g.symfunction("sqrt",[r])}let d,v,C=r.isConstant();if(r.group===R&&r.isLinear()){let O=Le(new P(r.multiplier));for(let U in r.symbols){if(!Object.hasOwn(r.symbols,U))continue;let te=r.symbols[U];O=g.multiply(O,Le(te))}v=O}else if(r.fname===X){let O=r.args[0],U=r.multiplier;O.setPower(r.power.multiply(new ke(.25))),v=O,U.equals(1)||(v=g.multiply(Le(g.parse(U)),v))}else if(!r.power.isInteger())r.setPower(r.power.multiply(new ke(.5))),v=r;else if(Number(r.multiplier)<0&&r.group===e){let O=g.parse(r.multiplier).negate(),U=g.parse(r).toUnitMultiplier().negate();v=g.multiply(g.symfunction(Ie.SQRT,[U]),Le(O))}else{let O=r.power.sign();r.power=r.power.abs(),C&&r.multiplier.lessThan(0)&&(d=P.imaginary(),r.multiplier=r.multiplier.abs());let U=Number(r.multiplier.toDecimal()),te=Math.abs(U),oe=Math.sqrt(te),he;if(ft(oe))he=new P(oe);else if(ft(U)){let le=Ye.ifactor(U),Pe=1;for(let Ze in le){if(!Object.hasOwn(le,Ze))continue;let et=le[Ze],Ue=et-et%2;if(Ue){let _e=Number(Ze)**Ue;Pe*=Number(Ze)**(Ue/2),U/=_e}}he=g.multiply(g.symfunction(X,[new P(U)]),new P(Pe))}else{let le=[new P(r.multiplier.num),new P(r.multiplier.den)],Pe=[new P(1),new P(1)],Ze=[new P(1),new P(1)],et=g;for(let Ue=0;Ue<2;Ue++){let _e=le[Ue];$(_e).each(Ge=>{Ge=P.unwrapPARENS(Ge);let be=Ge.clone().toLinear(),Je=Number(Ge.power),ut=Je%2,Ke=(Je-ut)/2;Pe[Ue]=et.multiply(Pe[Ue],et.pow(be,new P(Ke))),Ze[Ue]=et.multiply(Ze[Ue],Le(et.pow(be,new P(ut))))})}he=g.divide(g.multiply(Pe[0],Ze[0]),g.multiply(Pe[1],Ze[1]))}r=r.toUnitMultiplier(!0),r.isOne()?v=r:Pt(r.power.toString())?v=g.pow(r.clone(),new P(.5)):v=g.symfunction(X,[r]),O<0&&v.power.negate(),he&&(v=g.multiply(he,v)),d&&(v=g.multiply(d,v))}return W0&&Ie.PARSE2NUMBER&&v.text()!==i.text()?g.parse(v):v}function Ve(r){if(!r.isConstant(!0)){let i,s=Number(r.power)/3,d=g.pow(g.parse(r.multiplier),new P(1/3)),v=r.toUnitMultiplier();return ft(s)?i=g.pow(v.toLinear(),g.parse(String(s))):v.group===R?(i=new P(1),v.each(C=>{i=g.multiply(i,Ve(C))})):i=g.symfunction("cbrt",[v]),g.multiply(d,i)}return Ae(r,new P(3))}function Qe(r,i){return r.scientific=i||10,r}function Ae(r,i,s=void 0,d=void 0){if(i=vt(g.parse(i)),i.equals(0))throw new Xt("Unable to calculate nthroots of zero");if(Number(r)<0&&Pt(i))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!r.isConstant(!0)){let U=[r,i];return typeof s<"u"&&U.push(s),typeof d<"u"&&U.push(d),g.symfunction("nthroot",U)}r.group!==n&&(r=vt(r)),typeof d>"u"&&(d=!0),s||=25;let v=r.sign(),C,O;if(v<0&&(r=I(r)),ft(r)&&i.isConstant())return Number(r)<18446744073709552e3?O=ke.create(Number(r)**(1/Number(i))):O=Ye.nthroot(r,i),d?C=new P(O):C=new P(O.toDecimal(s)),g.multiply(new P(v),C)}function $(r){if(r.greaterThan(9999999999998891e26)||r.equals(-1))return r;if(r.equals(Math.PI))return new P(Math.PI);r=vt(r.clone());let i;if(r.isConstant()){i=new P(1);let s=r.toString();if(ft(s)){let d=Ye.ifactor(s);for(let v in d){if(!Object.hasOwn(d,v))continue;let C=d[v];i=g.multiply(i,g.symfunction("parens",[new P(v).setPower(new ke(C))]))}}else{let d=$(new P(r.multiplier.num)),v=$(new P(r.multiplier.den));i=g.multiply(g.symfunction("parens",[d]),g.symfunction("parens",[v]).invert())}}else i=g.symfunction("pfactor",[r]);return i}function W(r){return r.realpart()}function Y(r){return r.imagpart()}function q(r){let i=r.realpart(),s=r.imagpart();return g.add(i,g.multiply(s.negate(),P.imaginary()))}function ee(r){let i=r.realpart(),s=r.imagpart();return i.isConstant()&&s.isConstant()?s.equals(0)&&i.equals(1)?g.parse("0"):s.equals(1)&&i.equals(0)?g.parse("pi/2"):s.equals(0)&&i.equals(-1)?g.parse("pi"):s.equals(-1)&&i.equals(0)?g.parse("-pi/2"):s.equals(1)&&i.equals(1)?g.parse("pi/4"):s.equals(1)&&i.equals(-1)?g.parse("pi*3/4"):s.equals(-1)&&i.equals(1)?g.parse("-pi/4"):s.equals(-1)&&i.equals(-1)?g.parse("-pi*3/4"):new P(Math.atan2(Number(s),Number(i))):g.symfunction("atan2",[s,i])}function B(r){let i=P.toPolarFormArray(r),s=i[1],d=i[0],v=g.parse(Tt("e^({0}*({1}))",Ie.IMAGINARY,s));return g.multiply(d,v)}function T(r){let i=r.clone();try{let s=i1(r,"e",!0),d=g.divide(s.x.power,P.imaginary()),v=vt(qe.tan(d)),C=g.pow(s.a,new P(2)),O=v.getDenom(!0),U=v.getNum();return P.hyp(U,O).equals(s.a)?g.add(O,g.multiply(P.imaginary(),U)):i}catch(s){if(s.message==="timeout")throw s;return i}}function ge(r,i){i.forEach(U=>{U.numVal=vt(U).multiplier});let s,d,v,C,O;for(;;){if(s=i.length,s<2)return i[0];d=i.pop(),v=i[s-2],(r==="min"?d.numVal<v.numVal:d.numVal>v.numVal)&&(i.pop(),i.push(d))}}function a(...r){return X0(r)?r[0]:tn(r)?new P(Math.max.apply(null,r)):Ie.SYMBOLIC_MIN_MAX&&Dn(r)?ge("max",r):g.symfunction("max",r)}function c(...r){return X0(r)?r[0]:tn(r)?new P(Math.min.apply(null,r)):Ie.SYMBOLIC_MIN_MAX&&Dn(r)?ge("min",r):g.symfunction("min",r)}function A(r){return r.isConstant(!0)?new P(Math.sign(vt(r))):g.symfunction("sign",[r])}function x(r,i){i=i?i.toString():"asc";let s=function(v){return v.group===n?v.multiplier:v.group===w?v.fname===""?s(v.args[0]):v.fname:v.group===e?v.power:v.value},d=St(r)?r.elements:r.collectSymbols();return new wt(d.sort((v,C)=>{let O=s(v),U=s(C);return i==="desc"?U-O:O-U}))}function b(r,i=void 0){if(r.equals(1))return new P(0);let s;if(r.fname===X&&r.multiplier.equals(1))return s=g.divide(b(r.args[0]),new P(2)),r.power.sign()<0&&s.negate(),s;if(r.equals(0))throw new Xt(`${Ie.LOG}(0) is undefined!`);if(r.isImaginary())return we.evaluate(r,Ie.LOG);if(r.isConstant()&&typeof i<"u"&&i.isConstant()){let d=Math.log(r),v=Math.log(i);s=new P(d/v)}else if(r.group===u&&r.power.multiplier.lessThan(0)||r.power.toString()==="-1")r.power.negate(),s=b(r).negate();else if(r.value==="e"&&r.multiplier.equals(1)){let d=r.power;s=ct(d)?d:new P(d)}else if(r.group===w&&r.fname==="exp"){let d=r.args[0];r.multiplier.equals(1)?s=g.multiply(d,new P(r.power)):s=g.symfunction(Ie.LOG,[r])}else if(Ie.PARSE2NUMBER&&I0(r)){r=g.parse(r);let d;r.multiplier.lessThan(0)&&(r.negate(),d=g.multiply(new P(Math.PI),new P("i"))),s=new P(Math.log(r.multiplier.toDecimal())),d&&(s=g.add(s,d))}else{let d;!r.power.equals(1)&&!r.contains("e")&&r.multiplier.isOne()&&(d=r.group===u?r.power:new P(r.power),r.toLinear());let v=typeof i>"u"?[r]:[r,i];v.length>1&&X0(v)?s=new P(1):s=g.symfunction(Ie.LOG,v),d&&(s=g.multiply(d,s))}return s}function Q(r,i){let s=i&&i.isConstant()||typeof i>"u";if(r.isConstant()&&s){let v,C,O;v=r,i&&i.lessThan(0)&&(i=I(i),C=Number(r).toExponential().toString().split("e"),v=C[0],O=C[1]);let U=new P(h0(Number(v),Number(i)||0));return g.multiply(U,g.pow(new P(10),new P(O||0)))}let d=[r];return typeof i<"u"&&d.push(i),g.symfunction("round",d)}function J(r){let i=Number(r)%2,s;return i<0&&(i=2+i),i>=0&&i<=.5?s=1:i>.5&&i<=1?s=2:i>1&&i<=1.5?s=3:s=4,s}function G(r){if(!isFinite(r)){let s=Math.sign(r),d=new P(String(Math.abs(r)));return d.multiplier=d.multiplier.multiply(new ke(s)),d}if(ct(r))return r;if(typeof r=="number")try{r=ke.simple(r)}catch(s){if(s.message==="timeout")throw s;r=new ke(r)}let i=new P(0);return i.multiplier=r,i}function D(r){let i=r.group,s;if(i===L){let d=r.getNum(),v=r.getDenom()||new P(1),C=Number(r.power),O=new P(1);if(Math.abs(C)===1){v.each(oe=>{oe.group===R?O=g.multiply(O,D(oe.getDenom())):oe.power.lessThan(0)&&(O=g.multiply(O,D(oe.clone().toUnitMultiplier())))});let U=new P(0);v.each(oe=>{U=g.add(g.divide(oe,O.clone()),U)}),O.invert();let te;d.isComposite()?(te=new P(0),d.each(oe=>{te=g.add(g.multiply(D(oe),O.clone()),te)})):te=g.multiply(O,d),s=g.divide(te,U)}}else i===R?(s=new P(1),r.each(d=>{s=g.multiply(s,g.clean(d))})):i===w&&r.args.length===1&&r.args[0].isConstant()&&(s=bt("PARSE2NUMBER",()=>g.parse(r),!0));return s||=r,s}function ne(r,i){return i||={expand_denominator:!0,expand_functions:!0},pe(r,i)}function pe(r,i){if(Array.isArray(r))return r.map(d=>pe(d,i));if(r.expand)return r.expand(i);if(i||={},r.group===w&&r.fname===""){let d=pe(r.args[0],i),v=pe(g.pow(d,g.parse(r.power)),i);return g.multiply(g.parse(r.multiplier),v).distributeMultiplier()}if([n,t,e].indexOf(r.group)!==-1)return r;let s=r.clone();try{let d=r.multiplier.toString(),v=Number(r.power),C=r;if(r.isComposite()&&ft(r.power)&&r.power>0){let O=v-1,U=new P(0);r.each(oe=>{U=g.add(U,pe(g.parse(oe),i))});let te=g.parse(U);for(let oe=0;oe<O;oe++)te=Fn(te,U,i);C=g.multiply(g.parse(d),te).distributeMultiplier()}else if(r.group===w&&i.expand_functions===!0){let O=[];r.args.forEach(U=>{O.push(pe(U,i))}),C=g.pow(g.symfunction(r.fname,O),g.parse(r.power)),C=g.multiply(C,g.parse(r.multiplier))}else if(r.isComposite()&&ft(r.power)&&r.power<0&&i.expand_denominator===!0)r=r.invert(),C=pe(r,i),C.invert();else if(r.group===R){let O=function(oe){switch(oe.group){case L:return 0;case _:return 1;case R:return 2;case w:return 3;default:return 4}},U=r.collectSymbols().sort((oe,he)=>O(he)-O(oe)).map(oe=>{let he=g.pow(oe,g.parse(String(v)));return pe(he,i)}),te=U.pop();te.isComposite()&&te.isLinear()?(U.forEach(oe=>{te=Fn(te,oe,i)}),te.isComposite()?(te.power>1&&(te=pe(g.pow(te,g.parse(te.power)),i)),C=g.multiply(g.parse(d),te).distributeMultiplier()):C=te):(C=te,U.forEach(oe=>{C=g.multiply(C,oe)}),C=g.multiply(C,g.parse(d)).distributeMultiplier()),C.group===R&&(C=g.parse(C))}else C=r;return C}catch(d){if(d.message==="timeout")throw d;return s}}function Ce(r){return ot.identity(r)}function Te(r,i){return i.isConstant()&&ft(i)?r.elements[Number(i)]:g.symfunction("vecget",[r,i])}function Fe(r,i){return i=typeof i>"u"?1e-14:i,r=r.clone(),i=Number(i),r.elements.sort((s,d)=>d.group-s.group),r.elements=U1(r.elements,(s,d)=>Number(g.subtract(vt(s),vt(d)).abs())<=i),r}function xe(r,i,s){return i.isConstant?(r.elements[Number(i)]=s,r):g.symfunction("vecset",[r,i,s])}function He(r,i,s){return i.isConstant()&&s.isConstant()?r.elements[Number(i)][Number(s)]:g.symfunction("matget",[r,i,s])}function je(r,i){return i.isConstant()?new ot(r.elements[i]):g.symfunction("matgetrow",[r,i])}function ze(r,i,s){if(!i.isConstant())return g.symfunction("matsetrow",[r,i,s]);if(r.elements[Number(i)].length!==s.elements.length)throw new cn("Matrix row must match row dimensions!");let d=r.clone();return d.elements[Number(i)]=s.clone().elements,d}function at(r,i){if(!i.isConstant())return g.symfunction("matgetcol",[r,i]);let s=Number(i),d=ot.fromArray([]);return r.each((v,C,O)=>{O===s&&d.elements.push([v.clone()])}),d}function nt(r,i,s){if(!i.isConstant())return g.symfunction("matsetcol",[r,i,s]);let d=Number(i);if(r.rows()!==s.elements.length)throw new cn("Matrix column length must match number of rows!");return s.each(((v,C)=>{r.set(C-1,d,v.elements[0].clone())})),r}function pt(r,i,s,d){return r.elements[i][s]=d,r}function At(...r){return new wt(r)}function Dt(...r){return ot.fromArray(r)}function lt(...r){return n0.fromArray(r)}function Ct(r){return dt(r)?r.determinant():r}function qt(r){let i;return dt(r)?i=[new P(r.cols()),new P(r.rows())]:St(r)||Zn(r)?i=new P(r.elements.length):xt("size expects a matrix or a vector"),i}function Ot(r,i){return dt(r)&&(r=new wt(r)),dt(i)&&(i=new wt(i)),St(r)&&St(i)?r.dot(i):g.multiply(r.clone(),i.clone())}function Lt(r,i){return dt(r)&&(r=new wt(r)),dt(i)&&(i=new wt(i)),St(r)&&St(i)?r.cross(i):g.multiply(r.clone(),i.clone())}function Jt(r){return dt(r)?r.transpose():xt("function transpose expects a matrix")}function a0(r){return dt(r)?r.invert():xt("invert expects a matrix")}function Yt(r,i){return r.union(i)}function r0(r,i){return r.intersection(i)}function Kt(r,i){return r.contains(i)}function w0(r,i){return r.difference(i)}function it(r,i){return new P(Number(r.intersects(i)))}function Y0(r,i){return new P(Number(r.isSubset(i)))}function K0(r,i){i??=r;let s=Re.slice(r,i).map(d=>new P(d));return s.length===1?s[0]:s.length===0?new P(0):new wt(s)}function h(...r){r.forEach(i=>{console.log(i.toString())})}function N(r){if(!ct(r.power)&&r.power.absEquals(.5)){let i=r.power.sign(),s=Le(r.group===t?new P(r.value):r.toLinear());return i<0&&s.invert(),s}return r}function E(r){if(r.group===t){let i=r.value,s=Ci(i)[0];if(!s)return Mn("Unable to compute prime factors. This should not happen. Please review and report."),r;let v=new ke(Math.log(i)/Math.log(s)).multiply(r.power);if(v.den>r.power.den)return r;ft(v)?r=new P(s**Number(v)):r=new P(s).setPower(v)}return r}this.expand=pe,this.round=Q,this.clean=D,this.sqrt=Le,this.cbrt=Ve,this.abs=I,this.log=b,this.rationalize=We,this.nthroot=Ae,this.arg=ee,this.conjugate=q,this.imagpart=Y,this.realpart=W,this.getFunction=function(i){return p[i][0]},this.addPreprocessor=function(i,s,d,v){let{names:C}=de,{actions:O}=de;if(typeof s!="function")throw new Error("Incorrect parameters. Function expected!");d?v?(C.splice(d,0,i),O.splice(d,0,s)):(C[d]=i,O[d]=s):(C.push(i),O.push(s))},this.getPreprocessors=function(){let i={};for(let s=0,d=de.names.length;s<d;s++){let v=de.names[s];i[v]={order:s,action:de.actions[s]}}return i},this.removePreprocessor=function(i,s){let d=de.names.indexOf(i);s?(g0(de.names,d),g0(de.actions,d)):(de.names[d]=void 0,de.actions[d]=void 0)},this.mappedFunction=function(...i){let s={},{params:d}=this;for(let v=0;v<d.length;v++)s[d[v]]=String(i[v]);return g.parse(this.body,s)},this.add=function(i,s){let d=ct(i),v=ct(s);if(d&&v){if(i.unit||s.unit)return g.Unit.add(i,s);if(i.isInfinity||s.isInfinity){let Ke=i.multiplier.lessThan(0),Et=s.multiplier.lessThan(0);if(i.isInfinity&&s.isInfinity&&Ke!==Et)throw new Xt(`(${i})+(${s}) is not defined!`);let Mt=P.infinity();return Et&&Mt.negate(),Mt}if(i.isComposite()&&i.isLinear()&&s.isComposite()&&s.isLinear()&&(i.distributeMultiplier(),s.distributeMultiplier(),s.length>i.length&&i.group===s.group&&([i,s]=[s,i])),i.multiplier.equals(0))return s;if(s.multiplier.equals(0))return i;if(i.isConstant()&&s.isConstant()&&Ie.PARSE2NUMBER)return new P(i.multiplier.add(s.multiplier).toDecimal(Ie.PRECISION));let O=i.group,U=s.group,te=i.power.toString(),oe=s.power.toString();if(O<U||O===U&&Number(te)>Number(oe)&&Number(oe)>0)return this.add(s,i);if(O===R&&U===_&&i.value===s.value){let Ke=i;i=s,s=Ke,O=i.group,U=s.group,te=i.power.toString(),oe=s.power.toString()}let he=te===oe,le=i.value,Pe=s.value,Ze=i.isComposite(),et=s.isComposite(),Ue,_e,Ge;if(Ze&&(Ue=Vt(i,"hash")),et&&(_e=Vt(s,"hash")),O===L&&U===L&&s.isLinear()&&!i.isLinear()&&Ue!==_e)return this.add(s,i);O===_&&U===_&&(le=Ue,Pe=_e);let be=O===t&&U===n,Je=i.value===s.multiplier.toString(),ut=le===Pe||Ue===_e&&Ue!==void 0||be&&Je;if(ut&&he&&O===U)if(be&&(s=s.convert(t)),O===_&&(U===e||U===t))i.distributeMultiplier(),Ge=i.attach(s);else if(Ge=i,i.multiplier.isOne()&&s.multiplier.isOne()&&O===L&&i.isLinear()&&s.isLinear())for(let Ke in s.symbols){if(!Object.hasOwn(s.symbols,Ke))continue;let Et=s.symbols[Ke];Ge.attach(Et)}else Ge.multiplier=Ge.multiplier.add(s.multiplier);else if(ut&&O!==_)O===L&&U===_?(s.insert(i,"add"),Ge=s):(Ge=P.shell(_).attach([i,s]),Ge.value=O===_?Ue:le);else if(Ze&&i.isLinear()){let Ke=O===U,Et=O===_&&U===_;if(Et&&(Ke=i.value===s.value),i.distributeMultiplier(),s.isComposite()&&s.isLinear()&&Ke){s.distributeMultiplier();for(let Mt in s.symbols){if(!Object.hasOwn(s.symbols,Mt))continue;let jt=s.symbols[Mt];i.attach(jt)}Ge=i}else Et&&i.value!==_e||O===_&&!ut?(Ge=P.shell(L).attach([i,s]),Ge.updateHash()):Ge=i.attach(s)}else{if(O===w&&i.fname===X&&U!==u&&s.power.equals(.5)){let Ke=s.multiplier.clone();s=Le(s.toUnitMultiplier().toLinear()),s.multiplier=Ke}i.length===2&&s.length===2&&Pt(i.power)&&Pt(s.power)?Ge=g.add(pe(i),pe(s)):(Ge=P.shell(L).attach([i,s]),Ge.updateHash())}if(Ge.multiplier.equals(0)&&(Ge=new P(0)),Ge.length===1){let Ke=Ge.multiplier;Ge=H0(Ge.symbols),Ge.multiplier=Ge.multiplier.multiply(Ke)}return Ge}if(v&&!d){let O=i;i=s,s=O,O=v,v=d,d=O}let C=dt(s);if(d&&C){let O=new ot;s.eachElement((U,te,oe)=>{O.set(te,oe,g.add(i.clone(),U))}),s=O}else if(dt(i)&&C)s=i.add(s);else if(d&&St(s))s.each((O,U)=>{U--,s.elements[U]=g.add(i.clone(),s.elements[U])});else if(St(i)&&St(s))s.each((O,U)=>{U--,s.elements[U]=g.add(i.elements[U],s.elements[U])});else{if(St(i)&&dt(s))return g.add(s,i);if(dt(i)&&St(s)){if(s.elements.length===i.rows()){let O=new ot,U=i.cols();return s.each((te,oe)=>{let he=[];if(St(te))for(let le=0;le<U;le++)he.push(g.add(i.elements[oe-1][le].clone(),te.elements[le].clone()));else for(let le=0;le<U;le++)he.push(g.add(i.elements[oe-1][le].clone(),te.clone()));O.elements.push(he)}),O}xt("Dimensions must match!")}}return s},this.subtract=function(i,s){let d=ct(i),v=ct(s),C;if(d&&v){let O=i,U=s;return O.unit||U.unit?g.Unit.subtract(O,U):this.add(O,U.negate())}if(v&&St(i))s=i.map(O=>g.subtract(O,s.clone()));else if(d&&St(s))s=s.map(O=>g.subtract(i.clone(),O));else if(St(i)&&St(s)||fn(i)&&fn(s))i.dimensions()===s.dimensions()?s=i.subtract(s):g.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(dt(i)&&St(s)){if(s.elements.length===i.rows()){let O=new ot,U=i.cols();return s.each((te,oe)=>{let he=[];for(let le=0;le<U;le++)he.push(g.subtract(i.elements[oe-1][le].clone(),te.clone()));O.elements.push(he)}),O}xt("Dimensions must match!")}else if(St(i)&&dt(s)){let O=s.clone().negate();return g.add(O,i)}else if(dt(i)&&dt(s))s=i.subtract(s);else if(dt(i)&&v){let O=new ot;i.each((U,te,oe)=>{O.set(te,oe,g.subtract(U,s.clone()))}),s=O}else if(d&&dt(s)){let O=new ot;s.each((U,te,oe)=>{O.set(te,oe,g.subtract(i.clone(),U))}),s=O}return s},this.multiply=function(i,s){let d=ct(i),v=ct(s);if(d&&s instanceof Rt)return s.elements.push(i),s;if(d&&v){if(s.isUnit){let be=i.clone();return i.unit=s,be}if(i.unit||s.unit)return g.Unit.multiply(i,s);if(i.isInfinity||s.isInfinity){if(i.equals(0)||s.equals(0))throw new Xt(`${i}*${s} is undefined!`);if(s.power.lessThan(0)){if(!i.isInfinity)return new P(0);throw new Xt("Infinity/Infinity is not defined!")}let be=i.multiplier.multiply(s.multiplier).sign(),Je=P.infinity();if(i.isConstant()||s.isConstant()||i.isInfinity&&s.isInfinity)return be<0&&Je.negate(),Je}if(i.multiplier.equals(0)||s.multiplier.equals(0))return new P(0);if(i.isOne())return s.clone();if(s.isOne())return i.clone();if(i.isConstant()&&s.isConstant()&&Ie.PARSE2NUMBER){let be,Je=i.multiplier.num.abs().toString().length,ut=i.multiplier.den.toString().length,Ke=Je-ut,Et=s.multiplier.num.abs().toString().length,Mt=s.multiplier.den.toString().length,jt=Et-Mt,st=Ie.PRECISION-5;if(Ke<-st||Ke>st||jt<-st||jt>st){let tt=new Ne(String(i.multiplier.num)),rt=new Ne(String(i.multiplier.den)),q0=new Ne(String(s.multiplier.num)),p0=new Ne(String(s.multiplier.den));be=new P(tt.times(q0).dividedBy(rt).dividedBy(p0).toFixed())}else{let tt=new Ne(i.multiplier.toDecimal()),rt=new Ne(s.multiplier.toDecimal()),q0=tt.times(rt).toFixed();be=new P(q0)}return be}if(s.group>i.group&&s.group!==L)return this.multiply(s,i);if(i.group===R&&s.group===_&&i.value===s.value){let be=i;i=s,s=be}let U=i.group,te=s.group,oe=s.multiplier.num,he=s.multiplier.den;if(U===w&&i.fname===X&&!s.isConstant()&&i.args[0].value===s.value&&!i.args[0].multiplier.lessThan(0)){let be=i.power,Je=g.parse(i.multiplier);i=g.multiply(Je,i.args[0].clone()),i.setPower(new ke(.5).multiply(be)),U=i.group}else U===w&&i.fname===X&&i.multiplier.equals(1)&&i.power.equals(-1)&&s.isConstant()&&i.args[0].equals(s)&&(i=g.symfunction(X,[s.clone()]),s=new P(1));let le=i.value,Pe=s.value,Ze=new ke(i.sign()),et=U===t&&te===n&&s.multiplier.equals(i.value),Ue=et?new ke(1).multiply(i.multiplier).abs():i.multiplier.multiply(s.multiplier).abs(),_e=i.clone().toUnitMultiplier();if(s=s.clone().toUnitMultiplier(!0),U===w&&te===w){let be=i.args[0].clone(),Je=s.args[0].clone();if(i.fname===X&&s.fname===X&&i.isLinear()&&s.isLinear()){let ut=g.divide(be,Je).invert();ut.gt(1)&&ft(ut)&&(_e=g.multiply(i.args[0].clone(),Le(ut.clone())),s=new P(1))}else if(i.fname===Z&&s.fname===Z&&!be.isConstant()&&!Je.isConstant()&&s.power<0){let ut=g.subtract(be.clone(),Je.clone());if(ut.isConstant()){let Ke=new P(1);if(ut<0){for(let Et=0,Mt=Math.abs(ut);Et<=Mt;Et++){let jt=g.add(be.clone(),new P(Et));Ke=g.multiply(Ke,jt)}_e=g.multiply(g.pow(be,new P(i.power)),g.pow(Ke,new P(s.power))),s=new P(1)}else{for(let Et=0,Mt=Math.abs(ut);Et<=Mt;Et++){let jt=g.add(Je.clone(),new P(Et));Ke=g.multiply(Ke,jt)}_e=g.multiply(g.pow(Ke,new P(i.power)),g.pow(Je,new P(s.power))),s=new P(1)}}}}if(le===Pe&&U===_&&U===te&&(le=i.text("hash"),Pe=s.text("hash")),te===u&&s.previousGroup===_&&U===_&&(le=Vt(i,"hash",u)),(le===Pe||et)&&!(U===_&&(te===e||te===t||te===w))&&!(U===_&&te===R)){let be=i.power,Je=s.power,ut=ct(be),Ke=ct(Je),Et=ut||Ke;U===_&&te!==_&&s.previousGroup!==_&&be.equals(1)?(_e=new P(0),i.each(Mt=>{_e=g.add(_e,g.multiply(Mt,s.clone()))},!0)):(Et?_e.power=g.add(ct(be)?be:new P(be),ct(Je)?Je:new P(Je)):U===n?_e.power=be:_e.power=be.add(Je),_e.power.equals(0)&&(_e=_e.convert(n)),Et&&_e.convert(u),i.imaginary&&s.imaginary&&Pt(Number(_e.power)%2)&&(_e=new P(1),Ue.negate()),_e.group!==u&&_e.previousGroup&&(_e.previousGroup=void 0),_e.multiplier=_e.multiplier.multiply(s.multiplier))}else if(U===R&&i.isLinear())if(te===R&&s.distributeExponent(),te===R&&s.isLinear()){for(let be in s.symbols){if(!Object.hasOwn(s.symbols,be))continue;let Je=s.symbols[be];_e=_e.combine(Je)}_e.multiplier=_e.multiplier.multiply(s.multiplier)}else _e.combine(s);else if(U===n)_e=s.clone().toUnitMultiplier(!0);else if(U===R)_e.distributeExponent(),_e.combine(s);else if(!s.isOne()){let be=s.multiplier.clone();s.toUnitMultiplier(),_e=P.shell(R).combine([_e,s]),_e.multiplier=_e.multiplier.multiply(be)}if(_e.group===t){let be=Math.log(_e.value),Je=Math.log(oe)/be,ut=Math.log(he)/be,Ke=Ue.num/oe,Et=Ue.den/he;Je!==0&&ft(Je)&&ft(Ke)&&(_e.power=_e.power.add(new ke(Je)),Ue.num/=oe),ut!==0&&ft(ut)&&ft(Et)&&(_e.power=_e.power.subtract(new ke(ut)),Ue.den/=he)}if(_e.length===1){let be=_e.multiplier;_e=H0(_e.symbols),_e.multiplier=_e.multiplier.multiply(be)}let Ge=_e.power.toString();if(Pt(Ge)&&_e.fname===X){Ze=Ze.multiply(new ke(_e.sign()));let be=_e.power;_e=_e.args[0],_e=g.multiply(new P(Ue),g.pow(_e,new P(be.divide(new ke(2))))),Ze.lessThan(0)&&_e.negate()}else _e.multiplier=_e.multiplier.multiply(Ue).multiply(Ze),_e.group===L&&_e.isImaginary()&&_e.distributeMultiplier();return _e.group===t&&ft(_e.power.toDecimal())&&(_e=_e.convert(n)),_e}if(v&&!d){let U=i;i=s,s=U,U=v,v=d,d=U}let C=dt(s),O=dt(i);if(d&&C){let U=new ot;s.eachElement((te,oe,he)=>{U.set(oe,he,g.multiply(i.clone(),te))}),s=U}else if(O&&C)s=i.multiply(s);else if(d&&St(s))s.each((U,te)=>{te--,s.elements[te]=g.multiply(i.clone(),s.elements[te])});else if(St(i)&&St(s))s.each((U,te)=>{te--,s.elements[te]=g.multiply(i.elements[te],s.elements[te])});else{if(St(i)&&dt(s))return this.multiply(s,i);if(dt(i)&&St(s)){if(s.elements.length===i.rows()){let U=new ot,te=i.cols();return s.each((oe,he)=>{let le=[];for(let Pe=0;Pe<te;Pe++)le.push(g.multiply(i.elements[he-1][Pe].clone(),oe.clone()));U.elements.push(le)}),U}xt("Dimensions must match!")}}return s},this.divide=function(i,s){let d=ct(i),v=ct(s);if(d&&v){if(i.unit||s.unit)return g.Unit.divide(i,s);let U;if(s.equals(0))throw new Nn("Division by zero not allowed!");return i.isConstant()&&s.isConstant()?(U=i.clone(),U.multiplier=U.multiplier.divide(s.multiplier)):(s.invert(),U=g.multiply(i,s)),U}let C=St(i),O=St(s);if(d&&O)s=s.map(U=>g.divide(i.clone(),U));else if(C&&v)s=i.map(U=>g.divide(U,s.clone()));else if(C&&O)i.dimensions()===s.dimensions()?s=s.map((U,te)=>g.divide(i.elements[--te],U)):g.error("Cannot divide vectors. Dimensions do not match!");else{let U=dt(i),te=dt(s);if(U&&v){let oe=new ot;i.eachElement((he,le,Pe)=>{oe.set(le,Pe,g.divide(he,s.clone()))}),s=oe}else if(d&&te){let oe=new ot;s.eachElement((he,le,Pe)=>{oe.set(le,Pe,g.divide(i.clone(),he))}),s=oe}else if(U&&te){let oe=new ot;i.rows()===s.rows()&&i.cols()===s.cols()?(i.eachElement((he,le,Pe)=>{oe.set(le,Pe,g.divide(he,s.elements[le][Pe]))}),s=oe):g.error("Dimensions do not match!")}else if(U&&O)if(i.cols()===s.dimensions()){let oe=new ot;i.eachElement((he,le,Pe)=>{oe.set(le,Pe,g.divide(he,s.elements[le].clone()))}),s=oe}else g.error("Unable to divide matrix by vector.")}return s},this.pow=function(i,s){let d=ct(i),v=ct(s);if(d&&v){if(i.unit||s.unit)return g.Unit.pow(i,s);if(i.group===w&&i.fname===z&&Pt(s)){let Ue=i.multiplier.clone(),_e=g.pow(i.args[0],s);return _e.multiplier=Ue,_e}if(i.isInfinity||s.isInfinity){if(i.isInfinity&&s.isInfinity)throw new Xt(`(${i})^(${s}) is undefined!`);if(i.isConstant()&&s.isInfinity){if(i.equals(0)){if(s.lessThan(0))throw new Xt("0^Infinity is undefined!");return new P(0)}if(i.equals(1))throw new Xt(`1^${s.toString()} is undefined!`);if(s.lessThan(0))return new P(0);if(!i.lessThan(0))return P.infinity()}if(i.isInfinity&&s.isConstant()){if(s.equals(0))throw new Xt(`${i}^0 is undefined!`);return s.lessThan(0)?new P(0):g.multiply(P.infinity(),g.pow(new P(i.sign()),s.clone()))}}let C=i.equals(0),O=s.equals(0);if(C&&O)throw new Xt("0^0 is undefined!");if(C&&s.isConstant()&&s.multiplier.greaterThan(0))return new P(0);if(O)return new P(1);let U=s.isConstant(),te=i.isConstant(),oe=s.isInteger(),he=i.multiplier,le=i.clone();if(te&&U&&i.equals(0)&&s.lessThan(0))throw new Xt("Division by zero is not allowed!");if(Ie.PARSE2NUMBER&&te&&U&&i.sign()<0&&un(s)){let Ue=Math.PI*Number(s.multiplier.toDecimal()),_e=new P(Math.cos(Ue)),Ge=g.multiply(P.imaginary(),new P(Math.sin(Ue)));return g.add(_e,Ge)}if(Ie.PARSE2NUMBER&&i.isImaginary()&&U&&ft(s)&&!s.lessThan(0)){let Ue,_e,Ge,be,Je,ut=i.realpart(),Ke=i.imagpart();if(ut.isConstant("all")&&Ke.isConstant("all"))return Je=Ie.USE_BIG?new P(Q0.atan2(Ke.multiplier.toDecimal(),ut.multiplier.toDecimal()).times(s.toString())):Math.atan2(Number(Ke.multiplier.toDecimal()),Number(ut.multiplier.toDecimal()))*Number(s.multiplier.toDecimal()),_e=new P(Je),Ue=g.pow(P.hyp(ut,Ke),s),Ge=g.multiply(Ue.clone(),g.trig.cos(_e.clone())),be=g.multiply(Ue,g.trig.sin(_e)),g.add(Ge,g.multiply(P.imaginary(),be))}le.toUnitMultiplier();let Pe;if(le.group===w&&le.fname===X&&!U){let Ue=le.args[0];Ue.multiplyPower(new P(.5)),Ue.multiplier.multiply(le.multiplier),Ue.multiplyPower(s),le=Ue}else Pe=he.sign(),un(s)&&Pe<0&&(le.negate(),le=g.symfunction(Ee,[le]),le.negate()),le.multiplyPower(s);let Ze,et;if(te&&U&&Ie.PARSE2NUMBER){let Ue;Pe<0&&(i.negate(),s.multiplier.den.equals(2)?Ue=new P(Ie.IMAGINARY):ft(s.multiplier)?Pt(s.multiplier)?Ue=new P(1):Ue=new P(-1):Pt(s.multiplier.den)?Ue=g.pow(g.symfunction(Ee,[new P(Pe)]),s.clone()):Ue=new P(Pe**s.multiplier.num));let _e=Number(i.multiplier.toDecimal())**Number(s.multiplier.toDecimal());if(_e!==0||i.multiplier.equals(0))le=new P(_e);else{let Ge=new Ne(i.multiplier.toDecimal()),be=new Ne(s.multiplier.toDecimal());le=new P(Ge.pow(be).toFixed())}Ue&&(le=g.multiply(le,Ue))}else if(oe&&!he.equals(1)){if(s.abs().gt(Ie.MAX_EXP))return s.sign()<0?new P(0):P.infinity();let _e=s.multiplier.toDecimal(),Ge=Math.sign(Number(_e)),be=Math.abs(Number(_e)),Je=new ke(1);Je.num=he.num.pow(be),Je.den=he.den.pow(be),Ge<0&&Je.invert(),le.multiplier=le.multiplier.multiply(Je)}else{let Ue=i.sign();if(s.isConstant()&&i.isConstant()&&!s.multiplier.den.equals(1)&&Ue<0)if(s.multiplier.den.equals(2)){let _e=new P(Ie.IMAGINARY);i.negate(),s.lessThan(0)&&(_e.negate(),s.negate()),le=g.multiply(g.pow(i,s),_e)}else{let _e=i.clone();_e.multiplier.negate(),le=g.pow(g.symfunction(Ee,[new P(Pe)]),s.clone());let Ge=g.pow(new P(_e.multiplier.num),s.clone()),be=g.pow(new P(_e.multiplier.den),s.clone()),Je=g.divide(Ge,be);le=g.multiply(le,Je)}else if(Ie.PARSE2NUMBER&&s.isImaginary()){let _e=s.realpart(),Ge=s.imagpart(),be=i.clone().toLinear(),Je=g.pow(be.clone(),_e),ut=b(be.clone()),Ke=qe.cos(g.multiply(Ge.clone(),ut)),Et=g.multiply(qe.sin(g.multiply(Ge,b(be))),P.imaginary());le=g.multiply(Je,g.add(Ke,Et)),le=g.expand(g.parse(le))}else{let _e=i.group===n&&Ue<0;if(Ze=N(new P(_e?he.num:Math.abs(he.num)).setPower(s.clone())),et=N(new P(he.den).setPower(s.clone()).invert()),i.imaginary)if(oe){let Ge=Math.sign(s),Je=I(s)%4;le=new P(Pt(Je)?-1:Ie.IMAGINARY),(Je===0||Ge<0&&Je===1||Ge>0&&Je===3)&&le.negate()}else{let Ge=s.multiplier.multiply(ke.quick(1,2)),be=(-1)**Ge.num;le=Pt(Ge.den)?new P(-1).setPower(Ge,!0):new P(be)}if(Ue<0&&!_e&&le.negate(),U&&i.group!==u){let Ge=Pt(s.multiplier.den),be=Pt(i.power),Je=le.power.toDecimal(),ut=Pt(Je);if(Ge&&be&&!ut){if(Je==="1"||Je==="1")typeof le.value=="string"&&le.value.startsWith("baseunit_")||(le=g.symfunction(z,[le]));else if(ft(Je))le=g.multiply(g.symfunction(z,[le.clone().toLinear()]),le.clone().setPower(new ke(Number(Je)-1)));else{let Ke=le.power;le=g.symfunction(z,[le.toLinear()]).setPower(Ke)}Ie.POSITIVE_MULTIPLIERS&&le.fname===z&&(le=le.args[0])}}if(s.equals(2)&&le.group===R){let Ge=new P(1);le.each(be=>{Ge=g.multiply(Ge,g.pow(be,s))}),le=Ge}}}if(le=N(le),Ze&&et&&(le=g.multiply(le,E(g.multiply(Ze,et)))),le.fname===X){let Ue=le.group===u,_e=Ue?le.power.multiplier.toString():le.power.toString();if(Pt(_e)){let Ge=Ue?g.divide(le.power,new P(2)):new P(le.power.divide(new ke(2))),be=le.multiplier;le=g.pow(le.args[0],Ge),le.multiplier=le.multiplier.multiply(be)}}else if(!Ie.IGNORE_E&&le.isE()&&le.group===u&&le.power.contains("pi")&&le.power.contains(Ie.IMAGINARY)&&s.group===R){let Ue=s.stripVar(Ie.IMAGINARY);le=g.add(qe.cos(Ue),g.multiply(P.imaginary(),qe.sin(Ue)))}return le}if(St(i)&&v)i=i.map(C=>g.pow(C,s.clone()));else if(dt(i)&&v){let C=new ot;i.eachElement((O,U,te)=>{C.set(U,te,g.pow(O,s.clone()))}),i=C}else if(d&&dt(s)){let C=new ot;s.eachElement((O,U,te)=>{C.set(U,te,g.pow(i.clone(),O))}),i=C}return i},this.comma=function(i,s){return i instanceof Rt||(i=Rt.create(i)),i.append(s),i},this.mod=function(i,s){return ce(i,s)},this.slice=function(i,s){return new Oe(i,s)},this.equals=function(i,s){return i.group!==e&&!i.isLinear()&&xt(`Cannot set equality for ${i.toString()}`),ie[i.value]=s.clone(),s},this.percent=function(i){return g.divide(i,new P(100))},this.assign=function(i,s){if(i instanceof Rt&&s instanceof Rt)return i.elements.map((d,v)=>g.assign(d,s.elements[v])),wt.fromArray(s.elements);if(i.parent){let d=i.parent;return d.elements[d.getter]=s,delete d.getter,d}if(i.group!==e)throw new Gn(`Cannot complete operation. Incorrect LH value for ${i}`);return ie[i.value]=s,s},this.functionAssign=function(i,s){let d=i.elements.pop();return An(d,i.elements,s)};let y=function(i){return new P(i===!0?1:0)};this.eq=function(i,s){return y(i.equals(s))},this.gt=function(i,s){return y(i.gt(s))},this.gte=function(i,s){return y(i.gte(s))},this.lt=function(i,s){return y(i.lt(s))},this.lte=function(i,s){return y(i.lte(s))},this.factorial=function(i){return this.symfunction(Z,[i])},this.dfactorial=function(i){return this.symfunction(j,[i])}}var $i={allSame:X0,allNumeric:L1,arguments2Array:I1,armTimeout:Yn,arrayAddSlices:T1,arrayClone:q1,arrayMax:C1,arrayMin:Sn,arrayEqual:O1,arrayUnique:vn,arrayGetVariables:Li,arraySum:Ti,block:bt,get build(){return e0.build},checkTimeout:z0,clearU:B1,comboSort:P1,compare:qi,convertToVector:r1,customError:Gt,customType:A1,decompose_fn:i1,disarmTimeout:Kn,each:bn,evaluate:vt,even:Pt,evenFraction:un,fillHoles:Ri,firstObject:H0,format:Tt,generatePrimes:e1,getCoeffs:Ii,getU:Ui,importFunctions:xi,inBrackets:_t,isArray:Ft,isExpression:t1,isFraction:_n,isInt:ft,isMatrix:dt,isNegative:W0,isNumericSymbol:I0,isPrime:R0,isReserved:j0,isSymbol:ct,isVariableSymbol:jn,isVector:St,isCollection:fn,keys:yn,knownVariable:R1,nroots:Oi,remove:g0,reserveNames:U0,range:y1,round:h0,sameSign:E1,scientificToDecimal:L0,separate:n1,stringReplace:_1,text:Vt,validateName:m0,variables:t0,warn:Mn};function Di(){return function(t,e,u,w){Yn();try{let _=re.parser,R=re.state.EXPRESSIONS,L=!1;if(An(t))return re.libExports;t!==null&&typeof t=="object"&&t instanceof Bt&&(t=t.toString()),Ft(u)||(u=typeof u>"u"?[]:[u]),u.forEach(z=>{if(z==="numer"){L=!0;return}let Z=_.functions[z];Z&&Z[1]===1&&(t=`${z}(${t})`)});let X=bt("PARSE2NUMBER",()=>_.parse(t,e),L||Ie.PARSE2NUMBER);return w?R[w-1]=X:R.push(X),new Bt(X)}finally{Kn()}}}function Fi(){let n=re.parser;return{groups:g1,NerdamerSymbol:P,Expression:Bt,Collection:Rt,Frac:ke,Vector:wt,Matrix:ot,Parser:gn,Scientific:$t,Fraction:wn,Math2:Ye,LaTeX:Nt,Utils:$i,PARSER:n,PARENTHESIS:re.fnNames.PARENTHESIS,Settings:Ie,err:xt,bigInt:dn,bigDec:Q0,exceptions:re.exceptions}}function ki(){let n=re.parser;U0(n.CONSTANTS),U0(n.functions),n.initConstants(),n.error||=xt,Ie.LOG_FNS={log:n.functions.log,log10:n.functions.log10}}function Bi(n){n.rpn=ai,n.convertToLaTeX=ni,n.convertFromLaTeX=gi,n.version=z1,n.getWarnings=b1,n.setConstant=Ni,n.getConstant=K1,n.clearConstants=wi,n.setFunction=yi,n.clearFunctions=di,n.getCore=W1,n.getExpression=n.getEquation=Bt.getExpression,n.reserved=j1,n.clear=Qn,n.flush=Si,n.expressions=pi,n.functions=hi,n.register=Jn,n.validateName=m0,n.validVarName=Z1,n.supported=J1,n.numEquations=n.numExpressions=X1,n.setVar=Ei,n.getVar=ei,n.clearVars=mi,n.load=vi,n.getVars=ti,n.set=hn,n.get=H1,n.updateAPI=Mi,n.replaceFunction=fi,n.setOperator=si,n.getOperator=ii,n.aliasOperator=ri,n.tree=Wn,n.htmlTree=ci,n.addPeeker=oi,n.removePeeker=li,n.parse=ui}var bi=(function(){let t=new gn;re.parser=t,re.classes.Parser=gn,Nt.initParser(),e0.initDependencies(),ki();let e=Fi();re.core=e,re.classes.Math2=e.Math2,re.utils.symfunction=t.symfunction.bind(t),re.utils.callfunction=t.callfunction.bind(t),re.state.CONSTANTS=t.CONSTANTS;let u=Di();return re.libExports=u,Bi(u),u.updateAPI(),u})();typeof mn<"u"&&(mn.exports=bi)});var x0=c0((zi,s1)=>{"use strict";var P0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof s1<"u"&&P0===void 0&&(P0=O0(),$0());(function(){let t=P0.getCore(),e=t.PARSER,{Frac:u}=t,{Settings:w}=t,{isSymbol:_}=t.Utils,{FN:R}=t.groups,{NerdamerSymbol:L}=t,{text:X}=t.Utils,{inBrackets:z}=t.Utils,{isInt:Z}=t.Utils,{format:j}=t.Utils,{even:Ee}=t.Utils,{evaluate:Ne}=t.Utils,{N:Re}=t.groups,{S:ie}=t.groups,{PL:fe}=t.groups,{CP:g}=t.groups,{CB:H}=t.groups,{EX:de}=t.groups,{P:Oe}=t.groups,{LOG:ve}=w,we="exp",qe="abs",Se="sqrt",K="sin",l="cos",p="tan",o="sec",f="csc",m="cot",S="asin",M="acos",V="atan",F="asec",I="acsc",k="acot",se="sinh",ae="cosh",ce="tanh",Me="csch",me="sech",$e="coth",Xe="asech",ye="acsch",De="acoth";function Be(W){this.message=W||""}Be.prototype=new Error,L.prototype.hasIntegral=function(){return this.containsFunction("integrate")},L.prototype.fnTransform=function(){if(this.group!==R)return this;let Y,q=this.args[0],ee=new L(this.multiplier),B=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case se:Y=e.parse(j("(e^({0})-e^(-({0})))/2",q));break;case ae:Y=e.parse(j("(e^({0})+e^(-({0})))/2",q));break;case ce:Y=e.parse(j("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",q));break;case p:Y=e.parse(j("sin({0})/cos({0})",q));break;case f:Y=e.parse(j("1/sin({0})",q));break;case o:Y=e.parse(j("1/cos({0})",q));break;default:Y=B}else if(this.power.equals(2))switch(this.fname){case K:Y=e.parse(j("1/2-cos(2*({0}))/2",q));break;case l:Y=e.parse(j("1/2+cos(2*({0}))/2",q));break;case p:Y=e.parse(j("sin({0})^2/cos({0})^2",q));break;case ae:Y=e.parse(j("1/2+cosh(2*({0}))/2",q));break;case se:Y=e.parse(j("-1/2+cosh(2*({0}))/2",q));break;case ce:Y=e.parse(j("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",q));break;case o:Y=e.parse(j("(1-cos(2*({0})))/(1+cos(2*({0})))+1",q));break;default:Y=B}else if(this.fname===o)Y=e.parse(j("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===f)Y=e.parse(j("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===p)this.power.lessThan(0)?Y=e.parse(j("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):Y=e.parse(j("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===K&&this.power.lessThan(0))Y=e.parse(j("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===l&&this.power.lessThan(0))Y=e.parse(j("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===K&&this.power.equals(3))Y=e.parse(j("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===l&&this.power.equals(3))Y=e.parse(j("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===l||this.fname===K)&&Ee(this.power)){let T=this.power/2,ge=e.pow(this.clone().toLinear(),e.parse(2)).fnTransform(),a=e.expand(e.pow(ge,e.parse(T)));Y=new L(0),a.each(c=>{let A=c.fnTransform();Y=e.add(Y,A)},!0)}else Y=B;return e.multiply(Y,ee)},L.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===ie)return!1;if(this.fname&&(t.Utils.inTrig(this.fname)||t.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let Y in this.symbols)if(this.symbols[Y].hasTrig())return!0}return!1},t.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},t.Utils.toCommonDenominator=function(Y){if(Y.isComposite()&&Y.isLinear()){let q=new L(Y.multiplier),ee=new L(1),B=new L(0);return Y.each(ge=>{ee=e.multiply(ee,ge.getDenom())},!0),Y.each(ge=>{let a=ge.getNum(),c=ge.getDenom(),A=e.multiply(a,e.divide(ee.clone(),c));B=e.add(B,A)}),e.multiply(q,t.Algebra.divide(e.expand(B),e.expand(ee)))}return Y},t.Utils.inInverseTrig=function(Y){return[S,M,V,I,F,k].indexOf(Y)!==-1},t.Utils.inTrig=function(Y){return[l,K,p,o,f,m].indexOf(Y)!==-1},t.Utils.inHtrig=function(Y){return[se,ae,ce,ye,Xe,De].indexOf(Y)!==-1},t.Matrix.jacobian=function(Y,q){let ee=new t.Matrix;return q||=t.Utils.arrayGetVariables(Y),q.forEach((B,T)=>{Y.forEach((ge,a)=>{let c=t.Calculus.diff(ge.clone(),B);ee.set(a,T,c)})}),ee},t.Matrix.prototype.max=function(){let Y=new L(0);return this.each(q=>{let ee=q.abs();ee.gt(Y)&&(Y=ee)}),Y},t.Matrix.cMatrix=function(Y,q){let ee=new t.Matrix;return q.forEach((B,T)=>{ee.set(T,0,e.parse(Y))}),ee};let We=t.Utils.allFunctions=function(Y){for(let q=0,ee=Y.length;q<ee;q++)if(Y[q].group!==R)return!1;return!0},Le=t.Utils.cosAsinBtranform=function(Y,q){let ee=Y.args[0],B=q.args[0];return e.parse(j("(sin(({0})+({1}))-sin(({0})-({1})))/2",ee,B))},Ve=t.Utils.cosAsinAtranform=function(Y,q){if(Number(q.power)!==1)return e.multiply(Y,q);let ee=Y.args[0];return e.parse(j("(sin(2*({0})))/2",ee))},Qe=t.Utils.cosAsinBtranform=function(Y,q){let ee=Y.args[0],B=q.args[0];return e.parse(j("(cos(({0})+({1}))-cos(({0})-({1})))/2",ee,B))},Ae=t.Utils.trigTransform=function(Y){let q={},ee,B,T=new L(1);for(let ge=0,a=Y.length;ge<a;ge++)if(ee=Y[ge],ee.group===R){let{fname:c}=ee;c===l&&q[K]?(q[K].args[0].toString()===ee.args[0].toString()?B=Ve(ee,q[K]):B=Le(ee,q[K]),delete q[K],T=e.multiply(T,B)):c===K&&q[l]?(q[l].args[0].toString()===ee.args[0].toString()?B=Ve(ee,q[l]):B=Le(ee,q[l]),delete q[l],T=e.multiply(T,B)):c===K&&q[K]?(q[K].args[0].toString()===ee.args[0].toString()?(B=e.multiply(ee,q[K]),delete q[K]):(B=Qe(ee,q[K]),delete q[K]),T=B):q[c]=ee}else T=e.multiply(T,ee);for(let ge in q)Object.hasOwn(q,ge)&&(T=e.multiply(T,q[ge]));return T};t.Settings.integration_depth=10,t.Settings.max_lim_depth=10;let $=t.Calculus={version:"1.4.6",sum(W,Y,q,ee){if(Y.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${X(Y)} provided`);Y=Y.value;let B;if(t.Utils.isNumericSymbol(q)&&t.Utils.isNumericSymbol(ee)){let T=ee-q<200?"":"PARSE2NUMBER";q=Number(q),ee=Number(ee),B=t.Utils.block(T,()=>{let ge=W.text(),a={"~":!0},c=new t.NerdamerSymbol(0);for(let A=q;A<=ee;A++){a[Y]=new L(A);let x=e.parse(ge,a);c=e.add(c,x)}return c})}else B=e.symfunction("sum",[W,Y,q,ee]);return B},product(W,Y,q,ee){if(Y.group!==t.groups.S)throw new t.exceptions.NerdamerTypeError(`Index must be symbol. ${X(Y)} provided`);Y=Y.value;let B;if(t.Utils.isNumericSymbol(q)&&t.Utils.isNumericSymbol(ee)){let T=ee-q<200?"":"PARSE2NUMBER";B=t.Utils.block(T,()=>{q=Number(q),ee=Number(ee.multiplier);let ge=W.text(),a={},c=new t.NerdamerSymbol(1);for(let A=q;A<=ee;A++)a[Y]=new L(A),c=e.multiply(c,e.parse(ge,a));return c})}else B=e.symfunction("product",[W,Y,q,ee]);return B},diff(W,Y,q){if(t.Utils.isVector(W)){let c=new t.Vector([]);return W.each(A=>{c.elements.push($.diff(A,Y,q))}),c}if(t.Utils.isMatrix(W)){let c=new t.Matrix;return W.each((A,x,b)=>{c.set(x,b,$.diff(A,Y,q))}),c}if(W.LHS&&W.RHS)return new t.Equation($.diff(W.LHS.clone(),Y,q),$.diff(W.RHS.clone(),Y,q));let ee=_(Y)?Y.text():Y;if(q=_(q)?q.multiplier:q||1,ee===void 0&&(ee=t.Utils.variables(W)[0]),W.group===R&&W.fname===Se){let c=W.args[0],A=W.power.clone();(c.group!==Re||c.group!==Oe)&&(c.power=_(c.power)?e.multiply(c.power,e.multiply(new L(1/2)),A):c.power.multiply(new u(.5)).multiply(A),c.multiplier=c.multiplier.multiply(W.multiplier)),W=c}if(W.group===R&&!_(W.power)){let c=T(e.parse(W)),A=$.diff(W.args[0].clone(),ee);W=e.multiply(c,A)}else W=T(W);return q>1&&(q--,W=$.diff(W,Y,q)),W;function B(c){return(c.value===ee||c.contains(ee,!0))&&(c.multiplier=c.multiplier.multiply(c.power),c.power=c.power.subtract(new u(1)),c.power.equals(0)&&(c=L(c.multiplier))),c}function T(c){let A=c.group,x,b,Q;if(A===Re||A===ie&&c.value!==ee||A===Oe)c=L(0);else if(A===ie)c=B(c);else if(A===H){let J=c.multiplier.clone();c.toUnitMultiplier();let G=e.multiply(a(c),B(c));return G.multiplier=G.multiplier.multiply(J),G}else if(A===R&&c.power.equals(1)){let J=c.multiplier.clone();switch(c.toUnitMultiplier(),c.fname){case ve:Q=c.clone(),c=c.args[0].clone(),c.power=c.power.negate(),c.multiplier=Q.multiplier.divide(c.multiplier);break;case l:c.fname=K,c.multiplier.negate();break;case K:c.fname=l;break;case p:c.fname=o,c.power=new u(2);break;case o:c=ge(c,p);break;case f:c=ge(c,"-cot");break;case m:c.fname=f,c.multiplier.negate(),c.power=new u(2);break;case S:c=e.parse(`(sqrt(1-(${X(c.args[0])})^2))^(-1)`);break;case M:c=e.parse(`-(sqrt(1-(${X(c.args[0])})^2))^(-1)`);break;case V:c=e.parse(`(1+(${X(c.args[0])})^2)^(-1)`);break;case qe:b=c.args[0].clone(),b.toUnitMultiplier(),c=e.parse(`${z(X(c.args[0]))}/abs${z(X(b))}`);break;case"parens":c=L(1);break;case"cosh":c.fname="sinh";break;case"sinh":c.fname="cosh";break;case ce:c.fname=me,c.power=new u(2);break;case me:c=ge(c,"-tanh");break;case Me:{let G=String(c.args[0]);c=e.parse(`-coth(${G})*csch(${G})`);break}case $e:{let G=String(c.args[0]);c=e.parse(`-csch(${G})^2`);break}case"asinh":c=e.parse(`(sqrt(1+(${X(c.args[0])})^2))^(-1)`);break;case"acosh":c=e.parse(`(sqrt(-1+(${X(c.args[0])})^2))^(-1)`);break;case"atanh":c=e.parse(`(1-(${X(c.args[0])})^2)^(-1)`);break;case Xe:{let G=String(c.args[0]);c=e.parse(`-1/(sqrt(1/(${G})^2-1)*(${G})^2)`);break}case De:c=e.parse(`-1/((${c.args[0]})^2-1)`);break;case ye:{let G=String(c.args[0]);c=e.parse(`-1/(sqrt(1/(${G})^2+1)*(${G})^2)`);break}case F:{let G=String(c.args[0]);c=e.parse(`1/(sqrt(1-1/(${G})^2)*(${G})^2)`);break}case I:{let G=String(c.args[0]);c=e.parse(`-1/(sqrt(1-1/(${G})^2)*(${G})^2)`);break}case k:c=e.parse(`-1/((${c.args[0]})^2+1)`);break;case"S":{let G=String(c.args[0]);c=e.parse(`sin((pi*(${G})^2)/2)`);break}case"C":{let G=String(c.args[0]);c=e.parse(`cos((pi*(${G})^2)/2)`);break}case"Si":{let G=c.args[0];c=e.parse(`sin(${G})/(${G})`);break}case"Shi":{let G=c.args[0];c=e.parse(`sinh(${G})/(${G})`);break}case"Ci":{let G=c.args[0];c=e.parse(`cos(${G})/(${G})`);break}case"Chi":{let G=c.args[0];c=e.parse(`cosh(${G})/(${G})`);break}case"Ei":{let G=c.args[0];c=e.parse(`e^(${G})/(${G})`);break}case"Li":{let G=c.args[0];c=e.parse(`1/${w.LOG}(${G})`);break}case"erf":c=e.parse(`(2*e^(-(${c.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let G=String(c.args[0]),D=String(c.args[1]);c=e.parse(`(${D})/((${D})^2+(${G})^2)`);break}case"sign":c=new L(0);break;case"sinc":c=e.parse(j("(({0})*cos({0})-sin({0}))*({0})^(-2)",c.args[0]));break;case w.LOG10:c=e.parse(`1/((${c.args[0]})*${w.LOG}(10))`);break;default:c=e.symfunction("diff",[c,Y])}c.multiplier=c.multiplier.multiply(J)}else if(A===de||A===R&&_(c.power)){let J;A===de?J=c.value:A===R&&c.contains(ee)?J=c.fname+z(X(c.args[0])):J=c.value+z(X(c.args[0])),b=$.diff(e.multiply(e.parse(ve+z(J)),c.power.clone()),ee),c=e.multiply(c,b)}else if(A===R&&!c.power.equals(1))b=c.clone(),b.toLinear(),b.toUnitMultiplier(),c=e.multiply(B(c.clone()),T(b));else if(A===g||A===fe){let J=c.clone(),G=new L(0);for(let D in c.symbols)Object.hasOwn(c.symbols,D)&&(G=e.add(G,$.diff(c.symbols[D].clone(),ee)));c=e.multiply(B(J),G)}return c.updateHash(),c}function ge(c,A,x){return e.multiply(c,e.parse(A+z(x||X(c.args[0]))))}function a(c){let A=c.collectSymbols(),x=new L(0),b=A.length;for(let Q=0;Q<b;Q++){let J=$.diff(A[Q].clone(),ee);for(let G=0;G<b;G++)Q!==G&&(J=e.multiply(J,A[G].clone()));x=e.add(x,J)}return x}},integration:{u_substitution(W,Y){let q="__u__";function ee(x,b,Q){let J=$.diff(b,Y),G=Q?Q(x,b):e.divide(x.clone(),J);return G.contains(Y,!0)?null:G}function B(x,b){let Q=$.integrate(e.symfunction(x,[new L(q)]),q,0);return Q=Q.sub(new L(q),b),Q.updateHash(),Q}let T=W[0].clone(),ge=W[1].clone(),a=T.group,c=ge.group,A;if(a===R&&c!==R){let x=T.args[0];if(A=ee(ge,x.clone()),A)return e.multiply(A,B(T.fname,x));if(A=ee(ge,T),A)return $.integration.poly_integrate(T)}else if(c===R&&a!==R){let x=ge.args[0];if(A=ee(T,x.clone()),A)return e.multiply(A,B(ge.fname,x))}else if(a===R&&c===R){if(A=ee(T.clone(),ge.clone()),A||(A=ee(ge.clone(),T.clone()),A))return e.multiply($.integration.poly_integrate(ge),A)}else if(a===de&&c!==de){let x=T.power;if(A=ee(ge,x.clone()),!A){let J=$.integration.decompose_arg(x.clone(),Y),G=$.diff(J[2].clone(),Y),D=$.integration.decompose_arg(G.clone(),Y);if(e.multiply(J[1],D[1]).power.equals(ge.power)){let ne=e.divide(J[0].clone(),D[0].clone()),pe=e.multiply(ne.clone(),e.pow(new L(T.value),e.multiply(J[0],new L(q))));return pe=e.multiply(pe,new L(q)),$.integration.by_parts(pe,q,0,{}).sub(q,J[1].clone())}}let b=$.integrate(T.sub(x.clone(),new L(q)),q,0);return e.multiply(b.sub(new L(q),x),A)}else if(c===de&&a!==de){let x=ge.power;A=ee(T,x.clone());let b=$.integrate(ge.sub(x,new L(q)),q,0);return e.multiply(b.sub(new L(q),x),A)}else if(T.isComposite()||ge.isComposite()){let x=function(J,G){let D=$.diff(G,Y),ne=t.Algebra.Factor.factorInner(J),pe=t.Algebra.Factor.factorInner(D);return e.divide(ne,pe)},b=T.isComposite()?T.clone().toLinear():T.clone(),Q=ge.isComposite()?ge.clone().toLinear():ge.clone();if(A=ee(b.clone(),Q.clone(),x),A)return e.multiply($.integration.poly_integrate(ge),A);if(A=ee(Q.clone(),b.clone(),x),A)return e.multiply($.integration.poly_integrate(T),A)}},poly_integrate(W){let Y=W.power.toString(),q=W.multiplier.toDecimal(),ee=W.toUnitMultiplier().toLinear();return Number(Y)===-1?e.multiply(new L(q),e.symfunction(ve,[ee])):e.parse(j("({0})*({1})^(({2})+1)/(({2})+1)",q,ee,Y))},stop(W){throw W||="Unable to compute integral!",t.Utils.warn(W),new Be(W)},partial_fraction(W,Y,q,ee){_(Y)||(Y=e.parse(Y));let B;B=new L(0);let T=t.Algebra.PartFrac.partfrac(W,Y);return T.group===H&&T.isLinear()?(T.each(ge=>{ge.isLinear()||$.integration.stop()}),T.each(ge=>{B=e.add(B,$.integrate(ge,Y,q,ee))})):B=e.add(B,$.integrate(T,Y,q,ee)),B},get_udv(W){let Y=[[],[],[],[],[]],q=function(T){let ge=T.group;if(ge===R){let{fname:a}=T;t.Utils.inTrig(a)||t.Utils.inHtrig(a)?Y[3].push(T):t.Utils.inInverseTrig(a)?Y[1].push(T):a===ve?Y[0].push(T):$.integration.stop()}else ge===ie||T.isComposite()&&T.isLinear()||ge===H&&T.isLinear()?Y[2].push(T):ge===de||T.isComposite()&&!T.isLinear()?Y[4].push(T):$.integration.stop()};W.group===H?W.each(T=>{q(L.unwrapSQRT(T,!0))}):q(W);let ee,B=new L(1);for(let T=0;T<5;T++){let ge=Y[T],a,c=ge.length;if(c>0){if(c>1){a=new L(1);for(let A=0;A<c;A++)a=e.multiply(a,ge[A].clone())}else a=ge[0].clone();ee?B=e.multiply(B,a):(ee=a,ee.multiplier=ee.multiplier.multiply(W.multiplier))}}return[ee,B]},trig_sub(W,Y,q,ee,B,T){B||=$.integration.decompose_arg(W.clone().toLinear(),Y);let ge=B[3],a=B[2],c=B[0],A=B[1];if(A.power.equals(2)&&c.greaterThan(0)){let x=t.Utils.getU(W),b=e.parse(p+z(x)),Q=e.parse(`${o+z(x)}^2`),J=e.multiply(W.sub(A,b),Q),G=$.integrate(J,x,q,ee).sub(b,A);return t.Utils.clearU(b),G}},by_parts(W,Y,q,ee){ee.previous||=[];let B,T=$.integration.get_udv(W),ge=T[0],a=T[1],c=L.unwrapSQRT(e.expand($.diff(ge.clone(),Y)),!0),A=c.clone().stripVar(Y);c=e.divide(c,A.clone());let x=$.integrate(a.clone(),Y,q||0),b=e.multiply(x.clone(),c),Q=b.toString();if(ee.previous.indexOf(Q)!==-1&&t.Utils.inTrig(ge.fname)&&a.isE())return ee.is_cyclic=!0,new L(1);ee.previous.push(Q);let J=e.multiply(ge,x),G=b.multiplier.clone();b.toUnitMultiplier();let D=e.multiply($.integrate(b.clone(),Y,q,ee),A);if(D.multiplier=D.multiplier.multiply(G),B=e.subtract(J,D),ee.is_cyclic&&(ee.previous.pop(),ee.previous.length===0)){B=e.expand(B);let ne=new L(0);B.each(pe=>{pe.contains(Y)||(ne=e.add(ne,pe.clone()))}),B=e.divide(e.subtract(B,ne.clone()),e.subtract(new L(1),ne))}return B},decompose_arg:t.Utils.decompose_fn},integrate(W,Y,q,ee){if(!Y){let B=t.Utils.variables(W);B.length===1&&(Y=B[0]),Y||="x"}if(t.Utils.isVector(W)){let B=new t.Vector([]);return W.each(T=>{B.elements.push($.integrate(T,Y))}),B}return isNaN(Y)||e.error(`variable expected but received ${Y}`),W.isConstant(!0)?e.multiply(W.clone(),e.parse(Y)):(ee||={},t.Utils.block("PARSE2NUMBER",()=>{q||=0;let B=_(Y)?Y.toString():Y,T=L.unwrapSQRT(W.clone(),!0),ge=T.group,a;try{if(++q>t.Settings.integration_depth&&$.integration.stop("Maximum depth reached. Exiting!"),!T.contains(B,!0))a=e.multiply(T.clone(),e.parse(B));else if(ge===ie)a=$.integration.poly_integrate(T,B,q);else if(ge===de)if(T.previousGroup===R&&!(T.fname==="sqrt"||T.fname===w.PARENTHESIS)&&$.integration.stop(),T.contains(B)&&T.previousGroup!==R)T.power.contains(B)?$.integration.stop():($.diff(T.clone().toLinear(),B).contains(B)&&$.integration.stop(),a=$.integration.poly_integrate(T,B,q));else{let c=$.diff(T.power.clone(),B);if(c.contains(B)){let A=c.stripVar(B),x=e.divide(c.clone(),A.clone());if(x.group===ie&&x.isLinear())return A.multiplier=A.multiplier.divide(new u(2)),e.parse(j("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",A,B,T.multiplier));$.integration.stop()}if(T.isE())c.isLinear()?a=T:c.isE()&&c.power.group===ie&&c.power.power.equals(1)?a=e.multiply(e.symfunction("Ei",[T.power.clone()]),T.power):$.integration.stop();else{let A=e.symfunction(ve,[e.parse(T.value)]);a=e.divide(T,A)}a=e.divide(a,c)}else if(T.isComposite()&&T.isLinear()){let c=e.parse(T.multiplier);T.toUnitMultiplier(),a=new L(0),T.each(A=>{a=e.add(a,$.integrate(A,B,q))}),a=e.multiply(c,a)}else if(ge===g)if(T.power.greaterThan(1)&&(T=e.expand(T)),T.power.equals(1))a=new L(0),T.each(c=>{a=e.add(a,$.integrate(c,B,q))},!0);else{let c=Number(T.power),A=T.multiplier.clone();T.toUnitMultiplier();let x=T.clone().toLinear(),b=$.integration.decompose_arg(x,B),Q=b[3],J=b[2],G=b[0],D=b[1];if(c===-1&&D.group!==fe&&D.power.equals(2)){let ne=Z(Q)?Q>0:!0;if(D.group===ie&&D.power.equals(2)&&ne){let pe=function(He){let je=new L(1);return He.each(ze=>{je=e.multiply(je,ze.fname==="abs"?ze.args[0]:ze)}),je},Ce=G.clone(),Te=Q.clone();Ce=e.pow(Ce,new L(1/2)),Te=e.pow(Te,new L(1/2));let Fe=e.multiply(pe(Te),pe(Ce)),xe=e.symfunction(V,[e.divide(e.multiply(G,D.toLinear()),Fe.clone())]);a=e.divide(xe,Fe)}else if(D.group===ie&&D.isLinear())a=e.divide($.integration.poly_integrate(T),G);else if(D.power.equals(4)){let pe=z,Ce=e.parse(`${Se+pe(G)}*${B}^2`),Te=e.parse(`${Se+pe(2)}*${pe(G)}^${pe("1/4")}*${pe(Q)}^${pe("1/4")}*${B}`),Fe=e.parse(Se+pe(Q)),xe=e.add(e.add(Ce.clone(),Te.clone()),Fe.clone()),He=e.add(e.subtract(Ce,Te),Fe),je=e.parse(`${Se+pe(2)}*${pe(Q)}^${pe("3/4")}`),ze=e.parse(`${Se+pe(Q)}*${pe(Q)}^${pe("1/4")}*${B}`),at=e.parse(`2*${pe(Q)}*${Se}${pe(2)}*${pe(Q)}^${pe("1/4")}`),nt=e.divide(e.subtract(je.clone(),ze.clone()),e.multiply(at.clone(),He)),pt=e.divide(e.add(je,ze),e.multiply(at,xe.clone()));a=e.add($.integrate(nt,B,q,ee),$.integrate(pt,B,q,ee))}else a=$.integration.partial_fraction(T,B,q)}else if(c===-1/2)if(D.group===ie&&D.power.equals(2))if(J.multiplier.lessThan(0)&&!Q.multiplier.lessThan(0))if(G.negate(),Q.isConstant()&&G.isConstant()){let ne=e.symfunction(Se,[G.clone()]),pe=e.symfunction(Se,[e.multiply(G.clone(),Q)]);a=e.divide(e.symfunction(S,[e.divide(J.toLinear(),pe)]),ne)}else{let ne=e.symfunction(Se,[G]),pe=e.multiply(ne.clone(),D.clone().toLinear());a=e.divide(e.symfunction(V,[e.divide(pe,e.symfunction(Se,[x.clone()]))]),ne)}else $.integration.stop();else $.integration.stop();else if(c===1/2&&D.power.equals(2)&&G.greaterThan(0))$.integration.stop();else if(D.isLinear()&&D.group!==fe)a=e.divide($.integration.poly_integrate(T),G);else if(D.power.equals(2)&&G.greaterThan(0)){let ne=e.parse(Se+z(G)),pe=e.parse(Se+z(Q)),Ce=e.multiply(ne.clone(),pe.clone()).invert(),Te=e.pow(Q,new L(T.power)),Fe=t.Utils.getU(T),xe=e.multiply(Ce,D.clone().toLinear()),He=e.symfunction(V,[xe]),je=(Math.abs(T.power)-1)*2,ze=$.integrate(e.parse(`${l+z(Fe)}^${je}`));return t.Utils.clearU(Fe),e.multiply(ze.sub(Fe,He),Te)}else if(T.group!==H&&!T.power.lessThan(0))a=$.integration.by_parts(T,B,q,ee);else{let ne=T.clone().toLinear(),Ce=t.Algebra.Factor.factorInner(ne).toString()!==ne.toString();if(t.Algebra.degree(ne,e.parse(B)).equals(2)&&!Ce)try{let Te=t.Algebra.sqComplete(ne,B),Fe=t.Utils.getU(ne),xe=Te.f.sub(Te.a,Fe),He=e.pow(xe,e.parse(T.power));a=$.integrate(He,Fe).sub(Fe,Te.a)}catch(Te){if(Te.message==="timeout")throw Te;$.integration.stop()}else a=$.integration.partial_fraction(T,B,q,ee)}a.multiplier=a.multiplier.multiply(A)}else if(ge===R){let c=T.args[0],A=T.multiplier.clone();T.toUnitMultiplier();let x=$.integration.decompose_arg(c,B),b=x[0],Q=x[1],{fname:J}=T;if(J===ve||J===S||J===M||J===V&&Q.isLinear()){let G=T.power.toString();if(Z(G)&&(q-=G),c.isComposite()){let D=t.Utils.getU(T),ne=e.pow(e.parse(ve+z(D)),new L(G)),pe=$.diff(c,B),Ce=e.multiply(ne,pe),Te=$.integrate(Ce,D,q,ee);a=e.multiply(e.parse(A),Te.sub(D,c))}else a=e.multiply(e.parse(A),$.integration.by_parts(T,B,q,ee))}else if(J===p&&T.power.lessThan(0)){let G=T.clone();return G.power.negate(),G.fname=m,e.multiply(e.parse(A),$.integrate(G,B,q))}else{if(!b.contains(B,!0)&&T.isLinear())if(J===qe){let G=e.divide(c.clone(),b.clone());if(G.group===ie&&!G.power.lessThan(0))if(t.Utils.even(G.power))a=$.integrate(c,B,q);else{let D=$.integrate(G,B,q);D.power=D.power.subtract(new u(1)),a=e.multiply(e.multiply(e.symfunction(qe,[G.toLinear()]),D),b)}else $.integration.stop()}else{let G=T.args[0].group,D=$.integration.decompose_arg(c,B);switch((!(G===g||G===ie||G===H)||!D[1].power.equals(1)||c.hasFunc())&&$.integration.stop(),J){case l:a=e.symfunction(K,[c]);break;case K:a=e.symfunction(l,[c]),a.negate();break;case p:a=e.parse(j(`${w.LOG}(sec({0}))`,c));break;case o:a=e.parse(j(`${w.LOG}(tan({0})+sec({0}))`,c));break;case f:a=e.parse(j(`-${w.LOG}(csc({0})+cot({0}))`,c));break;case m:a=e.parse(j(`${w.LOG}(sin({0}))`,c));break;case se:a=e.symfunction(ae,[c]);break;case ae:a=e.symfunction(se,[c]);break;case ce:a=e.parse(j(`${w.LOG}(cosh({0}))`,c));break;case F:a=$.integration.by_parts(T,B,q,ee);break;case I:a=$.integration.by_parts(T,B,q,ee);break;case k:a=$.integration.by_parts(T,B,q,ee);break;case Xe:a=$.integration.by_parts(T,B,q,ee);break;case ye:a=$.integration.by_parts(T,B,q,ee);break;case De:a=$.integration.by_parts(T,B,q,ee);break;case me:a=e.parse(j("atan(sinh({0}))",c));break;case Me:a=e.parse(j(`${w.LOG}(tanh(({0})/2))`,c));break;case $e:a=e.parse(j(`${w.LOG}(sinh({0}))`,c));break;case we:a=$.integrate(e.parse(j("e^({0})",c)),B,q);break;case"S":{let ne=T.args[0].clone(),pe=$.integration.decompose_arg(ne,B),Ce=pe[1],Te=pe[0],Fe=pe[3];a=e.parse(j("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Te,Fe,Q));break}case"C":{let ne=T.args[0].clone(),pe=$.integration.decompose_arg(ne,B),Ce=pe[1],Te=pe[0],Fe=pe[3];a=e.parse(j("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Te,Fe,Ce));break}case"erf":{let ne=T.args[0].clone(),pe=$.integration.decompose_arg(ne,B),Ce=pe[1],Te=pe[0];a=e.parse(j("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Te,Ce,ne));break}case"sign":a=e.multiply(T.clone(),c.clone());break;default:$.integration.stop()}a=e.divide(a,b)}else if(Q.isLinear())if(J===l||J===K){let G=Number(T.power);if(G<0)T.fname=J===K?f:o,T.invert().updateHash(),a=$.integrate(T,B,q);else{let D=T.args[0],ne=T.clone(),pe=T.clone(),Ce=new L((G-1)/G),Te=e.multiply(b.clone(),new L(G)).invert();ne.power=ne.power.subtract(new u(1)),pe.power=pe.power.subtract(new u(2));let Fe=e.symfunction(J===l?K:l,[c.clone()]);J===K&&Fe.negate(),a=e.add(e.multiply(e.multiply(Te,ne),Fe),e.multiply(Ce,$.integrate(e.parse(pe),B,q)))}}else if(J===p||J===m){if(T.args[0].isLinear(B)){let G=T.power.subtract(new u(1)).toString(),D=T.clone().toUnitMultiplier(),ne=e.parse(j(`${J===m?"-":""}1/({2}*{0})*{3}({1})^({0})`,G,c,b,J));D.power=D.power.subtract(new u(2)),D.power.equals(0)&&(D=e.parse(D)),a=e.subtract(ne,$.integrate(D,B,q))}}else if(J===o||J===f){let G=T.power.subtract(new u(1)).toString(),D=T.power.subtract(new u(2)).toString(),ne=J===o?p:m,pe=T.clone().toUnitMultiplier(),Ce=j(`${J===f?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,b,G,D,c,J,ne),Te=e.parse(Ce);pe.power=pe.power.subtract(new u(2)),pe.power.equals(0)&&(pe=e.parse(pe)),a=e.add(Te,e.multiply(new L(D/G),$.integrate(pe,B,q)))}else(J===ae||J===se)&&T.power.equals(2)?a=$.integrate(T.fnTransform(),B,q):$.integration.stop();else $.integration.stop();a.multiplier=a.multiplier.multiply(A)}}else if(ge===fe)a=$.integration.partial_fraction(T,B,q);else if(ge===H){T.getDenom().group===ie&&(T=e.expand(T));let A=T.stripVar(B),x=e.divide(T.clone(),A.clone());if(A.contains(B)&&(x=e.multiply(x,A),A=new L(1)),x.group===H){let b=x.collectSymbols().sort((J,G)=>J.group===G.group?Number(J.power)===Number(G.power)?J<G?1:-1:G.power-J.power:G.group-J.group).map(J=>{let G=L.unwrapSQRT(J,!0);return G.fname===we?e.parse(j("({1})*e^({0})",G.args[0],G.multiplier)):G}),Q=b.length;if(T.power<0){if(Q===2)return $.integrate(e.expand(T),B,q,ee)}else if(Q===2){try{a=$.integration.u_substitution(b,B)}catch(J){if(J.message==="timeout")throw J}if(!a){let J=b[0].group,G=b[1].group,D=b[0],ne=b[1],pe=D.fname,Ce=ne.fname;if(T=e.multiply(D.clone(),ne.clone()),J===R&&G===R)if(pe===ve||Ce===ve)a=$.integration.by_parts(T.clone(),B,q,ee);else{b.sort((ze,at)=>at.fname>ze.fname);let Te=D.args[0];(!Te.isLinear()||!(Te.group===g||Te.group===H||Te.group===ie))&&$.integration.stop();let Fe=$.integration.decompose_arg(Te,B),xe=Fe[1],He=Fe[0];xe.isLinear()||$.integration.stop();let je=ne.args[0];if(Te.equals(je))if(pe===K&&Ce===l||pe===l&&Ce===K)if(D.power.lessThan(0)&&$.integration.stop(),pe===K&&D.power.add(ne.power).equals(0))D.fname=p,D.updateHash(),a=$.integrate(D,B,q);else if(Ee(D.power)&&Ce===l&&ne.power.lessThan(0)){let ze=Number(D.power)/2,at=e.parse(j("(1-cos({0})^2)^({1})",D.args[0],ze));a=$.integrate(e.expand(e.multiply(at,ne.clone())),B,q,ee)}else if(Ee(D.power)&&Ce===K&&ne.power.lessThan(0)){let ze=Number(D.power)/2,at=e.parse(j("(1-sin({0})^2)^({1})",D.args[0],ze));a=$.integrate(e.expand(e.multiply(at,ne.clone())),B,q,ee)}else{let ze=t.Utils.even(D.power),at=t.Utils.even(ne.power);if(a=new L(0),!ze||!at){let nt,pt;ze?(nt=D,pt=ne):(nt=ne,pt=D);let At=nt.fname===l?-1:1,lt=(pt.power-1)/2,Ct=e.parse(`(1-${nt.fname}${t.Utils.inBrackets(Te)}^2)^${lt}`);e.expand(e.multiply(new L(At),e.multiply(nt.clone(),Ct))).each(Ot=>{a=e.add(a,$.integration.poly_integrate(Ot.clone()))})}else{let nt=function(Ct){let Ot=Ct.power/2,Lt;return Ct.fname===l?Lt=`((1/2)+(cos(2*(${Ct.args[0]}))/2))^${Ot}`:Lt=`((1/2)-(cos(2*(${Ct.args[0]}))/2))^${Ot}`,e.parse(Lt)},pt=nt(D),At=nt(ne),Dt=e.multiply(pt,At);return e.expand(Dt).each(Ct=>{a=e.add(a,$.integrate(Ct,B,q))}),e.multiply(a,A)}}else if(pe===o&&Ce===p&&xe.isLinear()&&ne.isLinear())a=e.parse(j("sec({0})^({1})/({1})",D.args[0],D.power));else if(pe===p&&Ce===o&&xe.isLinear())if(D.isLinear()&&ne.isLinear())a=e.divide(e.symfunction(o,[Te.clone()]),He);else if(Ee(D.power)){let ze=Number(D.power)/2,at=e.parse(j("(sec({0})^2-1)^({1})",D.args[0],ze));a=$.integrate(e.expand(e.multiply(at,ne)),B,q)}else $.integration.stop();else if(pe===o&&Ce===l)D.fname=l,D.invert().updateHash(),a=$.integrate(e.multiply(D,ne),B,q);else if(pe===K&&Ce===f)ne.fname=K,ne.invert().updateHash(),a=$.integrate(e.multiply(D,ne),B,q);else if(pe===p&&(Ce===l||Ce===K)&&ne.power.lessThan(0)){let ze=e.multiply(D.fnTransform(),ne);a=$.integrate(e.expand(ze),B,q)}else{let ze=e.multiply(D.fnTransform(),ne.fnTransform());a=$.integrate(e.expand(ze),B,q)}else if((pe===K||pe===l)&&(Ce===K||Ce===l))if(D.isLinear()&&ne.isLinear())if(D.args[0].isLinear()&&ne.args[0].isLinear()){let ze,at;Ce===K?(ze=D.args[0],at=ne.args[0]):(at=D.args[0],ze=ne.args[0]);let nt=e.parse(j("(sin(({1})+({0}))+sin(({1})-({0})))/2",ze.toString(),at.toString()));a=$.integrate(nt,B,q)}else{let ze=Ae(b);a=$.integrate(e.expand(ze),B,q)}else{let ze=new L(1);b.forEach(nt=>{let pt=nt.fnTransform();ze=e.multiply(ze,pt)});let at=e.expand(ze);a=$.integrate(at,B,q),a.hasIntegral()&&(a=$.integrate(Ae(ze.collectSymbols()),B,q))}else $.integration.stop()}else if(J===R&&G===ie){let Te=D.isLinear();if(D.fname===l&&Te&&ne.power.equals(-1))a=e.symfunction("Ci",[D.args[0]]);else if(D.fname===l&&ne.power.equals(-1))a=$.integrate(e.multiply(D.fnTransform(),ne.clone()),B,q);else if(D.fname===ae&&Te&&ne.power.equals(-1))a=e.symfunction("Chi",[D.args[0]]);else if(D.fname===ae&&ne.power.equals(-1))a=$.integrate(e.multiply(D.fnTransform(),ne.clone()),B,q);else if(D.fname===K&&Te&&ne.power.equals(-1))a=e.symfunction("Si",[D.args[0]]);else if(D.fname===K&&ne.power.equals(-1))a=$.integrate(e.multiply(D.fnTransform(),ne.clone()),B,q);else if(D.fname===se&&Te&&ne.power.equals(-1))a=e.symfunction("Shi",[D.args[0]]);else if(D.fname===se&&ne.power.equals(-1))a=$.integrate(e.multiply(D.fnTransform(),ne.clone()),B,q);else if(D.fname===ve&&ne.power.equals(-1))a=$.integration.poly_integrate(D,B,q);else if(D.fname==="erf"){if(ne.power.equals(1)){let Fe=$.integration.decompose_arg(D.args[0],B),xe=Fe[0],He=Fe[1],je=D.args[0].toString();a=e.parse(j("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",xe,He,je))}}else a=$.integration.by_parts(T,B,q,ee)}else if(J===de&&G===ie){let Te=pe===ve?$.integration.decompose_arg(D.args[0],B)[1]:null;D.isE()&&(D.power.group===ie||D.power.group===H)&&ne.power.equals(-1)?a=e.symfunction("Ei",[D.power.clone()]):pe===ve&&Te.value===ne.value?a=$.integration.poly_integrate(D,B,q):a=$.integration.by_parts(T,B,q,ee)}else if(J===fe&&G===ie){if(ne.value===D.value&&D.power.equals(-1)){let Te=Math.min.apply(null,t.Utils.keys(D.symbols)),Fe=Math.min(Te,ne.power),xe=ne.clone();xe.power=new u(Fe),ne=e.divide(ne,xe.clone());let He=new L(0);D.each(je=>{He=e.add(He,e.divide(je.clone(),xe.clone()))}),He.multiplier=D.multiplier,T=e.divide(ne,He)}else T=e.expand(T);a=$.integration.partial_fraction(T,B,q)}else if(J===g&&G===ie){let Te=D.clone().toLinear(),Fe=t.Algebra.degree(Te,e.parse(B)).equals(1);if(D.power.equals(-1/2)){let xe=$.integration.decompose_arg(D.clone().toLinear(),B),He=xe[0].negate(),je=xe[1],ze=xe[3],at=Number(D.power),nt=Number(ne.power);if(Z(nt)&&t.Utils.even(nt)&&je.power.equals(2)){let pt=e.divide(e.multiply(e.pow(ze.clone(),new L(2)),e.symfunction(Se,[e.divide(ze.clone(),He.clone())])),e.pow(He.clone(),new L(2)));pt=e.multiply(pt,e.symfunction(Se,[ze]).invert());let At=e.parse("sin(u)");At.power=At.power.multiply(ne.power);let Dt=$.integrate(At,"u",q),lt=e.parse(`${S}(${Se}(${He}/${ze})*${B})`);a=e.multiply(pt,Dt.sub(new L("u"),lt))}else if(at===-1/2){let pt=function(At,Dt){let lt=e.parse($.integrate(At,B,q,ee).sub(B,j(Dt,B)));if(!lt.hasIntegral())return lt};nt===-1?a=pt(e.expand(e.expand(e.pow(e.multiply(D.invert(),ne.invert()),new L(2)))).invert(),"sqrt(1-1/({0})^2)"):nt===-2&&(a=pt(e.sqrt(e.expand(e.divide(e.pow(T,new L(2)).invert(),e.pow(new L(B),new L(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(D.power.equals(-1)&&ne.isLinear()&&Fe)a=$.integration.partial_fraction(T,B,q);else if(!D.power.lessThan(0)&&Z(D.power)){let xe=e.expand(D);a=new L(0),xe.each(He=>{He.group===fe?He.each(je=>{a=e.add(a,$.integrate(e.multiply(ne.clone(),je),B,q))}):a=e.add(a,$.integrate(e.multiply(ne.clone(),He),B,q))})}else if(D.power.lessThan(-2))a=$.integration.by_parts(T,B,q,ee);else if(D.power.lessThan(0)&&ne.power.greaterThan(1)){let xe=$.integration.decompose_arg(D.clone().toLinear(),B),He=xe[0].negate(),je=xe[1],ze=xe[3],at=D.clone().toLinear();if(je.group!==fe&&je.isLinear()){let nt=Number(ne.power),pt="_u_",At=new L(pt),Dt=e.expand(e.divide(e.pow(e.subtract(At.clone(),ze.clone()),new L(nt)),At.clone())),lt={};lt[pt]=at;let Ct=e.parse(Dt,lt);a=$.integrate(Ct,B,0)}else if(ne.power.greaterThan(je.power)||ne.power.equals(je.power)){let nt=new t.Algebra.Classes.Factors;D=t.Algebra.Factor.coeffFactor(D.invert(),nt);let pt=t.Algebra.divide(ne,D);pt.group===H?a=$.integration.by_parts(T,B,q,ee):(a=new L(0),pt.each(At=>{a=e.add(a,$.integrate(At,B,q))}),nt.each(At=>{a=e.divide(a,At)}),a=e.expand(a))}else a=$.integration.partial_fraction(T,B,q)}else if(D.power.den.equals(2)){let xe=$.integration.decompose_arg(D.clone().toLinear(),B),He=xe[3],je=xe[1],ze=xe[0],at=xe[2];if(je.power.equals(2)&&ze.lessThan(0)){He.equals(1)||(A=e.multiply(A,e.pow(He,new L(2))));let nt=B,pt=e.divide(e.pow(ze.clone().negate(),new L(1/2)),e.pow(He,new L(1/2))),At=e.symfunction(l,[new L(nt)]),Dt=e.pow(e.symfunction(l,[new L(nt)]),new L(D.power.num)),lt=e.pow(e.symfunction(K,[new L(nt)]),new L(ne.power)),Ct=e.multiply(e.multiply(Dt,At),lt);a=$.integrate(Ct,nt,q).sub(nt,e.symfunction(S,[e.multiply(new L(B),pt)]))}else a=$.integration.partial_fraction(T,B,q,ee)}else Fe&&(a=$.integration.partial_fraction(T,B,q))}else if(D.isComposite()&&ne.isComposite())if(a=new L(0),D.power.greaterThan(0)&&ne.power.greaterThan(0))e.expand(T).each(Fe=>{a=e.add(a,$.integrate(Fe,B,q))},!0);else{let Te=Number(D.power),Fe=Number(ne.power);if(Te<0&&Fe>0){let xe=D;D=ne,ne=xe}Te===-1&&Fe===-1?a=$.integration.partial_fraction(T,B):D.each(xe=>{let He=e.multiply(xe,ne.clone()),je=$.integrate(He,B,q);a=e.add(a,je)})}else if(J===g&&b[0].power.greaterThan(0))D=e.expand(D),a=new L(0),D.each(Te=>{a=e.add(a,$.integrate(e.multiply(Te,ne.clone()),B,q))},!0);else if(J===R&&G===de&&t.Utils.inHtrig(D.fname))D=D.fnTransform(),a=$.integrate(e.expand(e.multiply(D,ne)),B,q);else if(J===R&&G===g||G===R&&J===g){if(G===R&&J===g){let at=D;D=ne,ne=at}let Te,Fe,xe,He,je=L.unwrapSQRT($.diff(D.clone(),B),!0),ze=L.unwrapSQRT(ne,!0);if(je.power.equals(ze.power)){if(Te=new L(ne.power),xe=je.clone().toLinear(),He=ne.clone().toLinear(),Fe=t.Algebra.divide(xe.toLinear(),He),Fe.isConstant()){let at=e.pow(Fe,Te.negate());a=e.multiply(at,$.integration.poly_integrate(D.clone()))}}else a=$.integration.by_parts(T,B,q,ee)}else{let Te=D.clone().toLinear(),Fe=ne.clone().toLinear();J===de&&G===de&&D.power.contains(B)&&ne.power.contains(B)&&!Te.contains(B)&&!Fe.contains(B)?a=e.parse(j("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Te.toString(),Fe.toString(),D.power.multiplier.toString(),ne.power.multiplier.toString(),B)):a=$.integration.by_parts(T,B,q,ee)}}}else if(Q===3&&(b[2].group===ie&&b[2].power.lessThan(2)||b[0].group===g)){let J=b[0];if(J.group===g){J.power.greaterThan(1)&&(J=e.expand(J));let G=e.multiply(b[1],b[2]);a=new L(0),J.each(D=>{let ne=e.multiply(D,G.clone()),pe=$.integrate(ne,B,q);a=e.add(a,pe)},!0)}else a=$.integration.by_parts(T,B,q,ee)}else if(We(b)){let J=new L(1);for(let G=0,D=b.length;G<D;G++)J=e.multiply(J,b[G].fnTransform());J=e.expand(J),a=$.integrate(J,B,q)}else{let J=Ae(b);a=$.integrate(e.expand(J),B,q)}}else{if(x.equals(1))return $.integrate(e.expand(T),B,q);x.clone().toLinear().isPoly(!0)&&t.Utils.variables(x).length>1&&(x=t.Algebra.Factor.factorInner(x)),a=$.integrate(x,B,q)}a=e.multiply(a,A)}if(a)return a}catch(c){if(c.message==="timeout"||!(c instanceof Be||c instanceof t.exceptions.DivisionByZero))throw c}return e.symfunction("integrate",[W,Y])},!1))},defint(W,Y,q,ee){ee||="x";let B=function(A,x,b){try{return e.parse(A,x)}catch(Q){if(Q.message==="timeout")throw Q;return $.Limit.limit(A,ee,b)}},T=t.Utils.variables(W),ge=W.hasTrig(),a,c;if(T.length===1&&!ee&&(ee=T[0]),ge||(c=$.integrate(W,ee)),!ge&&!c.hasIntegral()){let A={},x={};A[ee]=q,x[ee]=Y;let b=B(c,A,q,ee),Q=B(c,x,Y,ee);a=e.subtract(b,Q)}else if(T.length===1&&Y.isConstant()&&q.isConstant()){let A=t.Utils.build(W);a=new L(t.Math2.num_integrate(A,Number(Y),Number(q)))}else a=e.symfunction("defint",[W,Y,q,ee]);return a},Limit:{interval(W,Y){return e.parse(j("[{0}, {1}]",W,Y))},diverges(){return $.Limit.interval("-Infinity","Infinity")},divide(W,Y,q,ee,B){if(B++>w.max_lim_depth)return;let T=W.clone(),ge=Y.clone();if(Y.fname===qe){let ne=W.sign(),pe=ee.sign();if(ee.isInfinity)return e.multiply(new L(ne),new L(pe));if(ee.equals(0)){let Ce=e.parse(W.multiplier),Te=e.parse(Y.multiplier);return e.divide(e.multiply(Ce,$.Limit.interval("-1","1")),Te)}return $.Limit.diverges()}let a=function(ne){if(t.Utils.isVector(ne)){for(let pe=0;pe<ne.elements.length;pe++)if(!ne.elements[pe].isInfinity)return!1;return!0}return ne.isInfinity},c=function(ne,pe){return t.Utils.isVector(ne)?!1:ne.equals(pe)},A,x=0,b,Q,J;do if(b=Ne($.Limit.limit(W.clone(),q,ee,B)),Q=Ne($.Limit.limit(Y.clone(),q,ee,B)),J=a(b)&&a(Q)||c(b,0)&&c(Q,0),J){let ne=$.diff(W.clone(),q),pe=$.diff(Y.clone(),q),Ce=e.divide(ne,pe);W=Ce.getNum(),Y=Ce.getDenom()}while(J&&++x<w.max_lim_depth);if(x>=w.max_lim_depth)return;let G=Q.equals(0),D=Number(ge.power);return ee.isConstant(!0)&&G?A=L.infinity(t.Utils.even(D)&&b.lessThan(0)?-1:void 0):G?A=$.Limit.diverges():A=e.divide(b,Q),A},rewriteToLog(W){let Y=W.power.clone();return W.toLinear(),e.pow(new L("e"),e.multiply(Y,e.symfunction(`${w.LOG}`,[W])))},getSubbed(W,Y,q){let ee;W.group===de&&(W=$.rewriteToLog(W));try{ee=W.sub(Y,q)}catch(B){if(B.message==="timeout")throw B;ee=W}return ee},isInterval(W){return t.Utils.isVector(W)},isConvergent(W){return!($.Limit.isInterval(W)&&W.elements[0].isInfinity&&W.elements[1].isInfinity||W.containsFunction("limit"))},limit(W,Y,q,ee){if(W.isLinear()&&W.isComposite()){let ge=new L(0);return W.each(a=>{ge=e.add(ge,$.Limit.limit(a,Y,q,ee))},!0),ge}if(W=t.Algebra.Simplify.simplify(W),ee||=1,ee++>w.max_lim_depth)return;let B=e.parse(W.multiplier);W.toUnitMultiplier();let T;try{if(W.isConstant(!0))T=W;else{let ge={};ge[Y]=q;try{let a=e.parse(W.sub(Y,q),ge);(a.isConstant(!0)||a.isInfinity)&&(T=a)}catch(a){if(a.message==="timeout")throw a}if(!T){let a=W.getNum(),c=W.getDenom();if(c.isConstant(!0)){if(W.group===de){let A=W.clone().toLinear(),x=W.power.clone(),b=A.getNum(),Q=A.getDenom(),J=t.Utils.decompose_fn(Q,Y,!0);if(b.group===ie&&b.multiplier.isOne()&&J.ax.group===ie&&J.b.isConstant(!0)&&J.a.isOne()&&J.b.isConstant(!0))T=e.parse(j("(1/e^({0}))",J.b));else{let G=$.Limit.rewriteToLog(W.clone()),D=G.power.clone(),ne=G.clone().toLinear(),pe=$.Limit.limit(ne,Y,q,ee),Ce=$.Limit.limit(D,Y,q,ee);T=e.pow(pe,Ce)}}else if(W.group===R&&W.args.length===1){let A,x=$.Limit.limit(W.args[0],Y,q,ee);if(t.Utils.isVector(x))return T=x.map(Q=>{let J=W.clone();return J.args[0]=Q,$.Limit.limit(e.symfunction(W.fname,[Q]),Y,q,ee)}),e.multiply(B,T);let b;if(x.isConstant(!0)){b=e.symfunction(W.fname,[x]);try{Ne(b),A=!0}catch(Q){if(Q.message==="timeout")throw Q;A=!1}}if(A)T=b;else if($.Limit.isConvergent(x)){if(W.fname===ve)switch(x.toString()){case"0":T=L.infinity().negate();break;case"Infinity":T=L.infinity();break;case"-Infinity":T=L.infinity();break}else if((W.fname===l||W.fname===K)&&q.isInfinity)T=$.Limit.interval(-1,1);else if(W.fname===p){let Q=W.args[0],J=Q.getNum(),G=Q.getDenom(),D=J.toUnitMultiplier();(q.isInfinity||D.equals("pi")&&G.equals(2))&&(T=$.Limit.diverges())}else if(W.fname===w.FACTORIAL&&x.isInfinity)return L.infinity()}}else if(W.group===ie){if(W.power>0)return e.parse(W,ge);t.Utils.even(W.power)?T=L.infinity():T=$.Limit.diverges()}else if(W.group===H){let A,x,b=W.collectSymbols().sort((J,G)=>J.group-G.group),Q=b.pop();for(A=Ne($.Limit.limit(Q,Y,q,ee));b.length;){let J=b.pop();x=Ne($.Limit.limit(J,Y,q,ee)),A.isInfinity||!$.Limit.isConvergent(A)&&x.equals(0)||A.equals(0)&&$.Limit.isConvergent(x)?(J.containsFunction(ve)&&(J=[Q,Q=J][0]),J.invert(),A.isInfinity&&x.isInfinity?A=L.infinity():A=$.Limit.divide(Q,J,Y,q,ee)):(A=e.multiply(A,x),Q=e.multiply(Q,J))}T=A}else if(W.isComposite()){let A;W.isLinear()||(W=e.expand(W)),T=new L(0);let x=W.collectSymbols().sort((J,G)=>G.group-J.group),b=[],Q=new L(0);for(let J=0,G=x.length;J<G;J++){let D=x[J].clone();D.group===R||D.group===H&&D.hasFunc()?Q=e.add(Q,D):b.push(D)}b.unshift(Q),b.length!==1&&(x=b);for(let J=0,G=x.length;J<G;J++){let D=x[J];try{A=$.Limit.limit(D,Y,q,ee)}catch(ne){if(ne.message==="timeout")throw ne;A=$.Limit.diverges()}try{T=e.add(T,A)}catch(ne){if(ne.message==="timeout")throw ne;if(ee++>w.max_lim_depth)return;T=$.Limit.limit($.diff(W,Y),Y,q,ee)}}}}else T=$.Limit.divide(a,c,Y,q,ee)}}T||=e.symfunction("limit",[W,Y,q])}catch(ge){if(ge.message==="timeout")throw ge;T=e.symfunction("limit",[W,Y,q])}return e.multiply(B,T)}},Fresnel:{S(W){return W.isConstant(!0)?$.defint(e.parse("sin(pi*x^2/2)"),L(0),W,"x"):e.symfunction("S",[W])},C(W){return W.isConstant(!0)?$.defint(e.parse("cos(pi*x^2/2)"),L(0),W,"x"):e.symfunction("C",[W])}}};P0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return $.diff}},{name:"sum",visible:!0,numargs:4,build(){return $.sum}},{name:"product",visible:!0,numargs:4,build(){return $.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return $.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return $.defint}},{name:"S",visible:!0,numargs:1,build(){return $.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return $.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return $.Limit.limit}}]),P0.updateAPI()})()});var $0=c0((Wi,o1)=>{"use strict";var d0;typeof o1<"u"&&(d0=O0(),x0());(function(){let t=d0.getCore(),e=t.PARSER,{N:u}=t.groups,{P:w}=t.groups,{S:_}=t.groups,{EX:R}=t.groups,{FN:L}=t.groups,{PL:X}=t.groups,{CP:z}=t.groups,{CB:Z}=t.groups,{keys:j}=t.Utils,{even:Ee}=t.Utils,{variables:Ne}=t.Utils,{format:Re}=t.Utils,{round:ie}=t.Utils,{Frac:fe}=t,{isInt:g}=t.Utils,{NerdamerSymbol:H}=t,{CONST_HASH:de}=t.Settings,Oe=t.Utils.importFunctions(),ve=t.Utils.evaluate;function we(l,p,o){if(t.Utils.isSymbol(l))this.parse(l),this.variable||=p;else if(isNaN(l))typeof l=="string"&&this.parse(e.parse(l));else{if(o||=0,p===void 0)throw new t.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[o]=l,this.fill(l)}}we.fromArray=function(p,o){if(typeof o>"u")throw new t.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let f=new we;return f.coeffs=p,f.variable=o,f},we.fit=function(p,o,f,m,S,M){let V=new Array(S+1),F=f-o;V[0]=o,V[S]=p,F-=p*m**S;for(let I=S-1;I>0;I--){let k=m**I,se=F/k,ce=Math.sign(se)*Math.floor(Math.abs(se));F-=ce*k,V[I]=ce}if(F!==0)return null;for(let I=0;I<V.length;I++)V[I]=new fe(V[I]);return we.fromArray(V,M)},we.prototype={parse(l,p){if(this.variable=Ne(l)[0],!l.isPoly())throw t.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${t.Utils.text(l)}`);if(p||=[],l.power.absEquals(1)||(l=e.expand(l)),l.group===t.groups.N)p[0]=l.multiplier;else if(l.group===t.groups.S)p[l.power.toDecimal()]=l.multiplier;else for(let o in l.symbols){if(!Object.hasOwn(l.symbols,o))continue;let f=l.symbols[o],m=f.power;if(t.Utils.isSymbol(m))throw new t.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");m=f.group===u?0:m.toDecimal(),f.symbols?this.parse(f,p):p[m]=f.multiplier}this.coeffs=p,this.fill()},fill(l){l=Number(l)||0;let p=this.coeffs.length;for(let o=0;o<p;o++)this.coeffs[o]===void 0&&(this.coeffs[o]=new fe(l));return this},trim(){let l=this.coeffs.length;for(;l--;){let p=this.coeffs[l],o=p.equals(0);if(p&&o){if(l===0)break;this.coeffs.pop()}else break}return this},modP(l){let p=this.coeffs.length;for(let o=0;o<p;o++){let f=this.coeffs[o],m;if(f<0){let V;for(m=o;m<p;m++)if(this.coeffs[m]>0){V=this.coeffs[m];break}if(V){for(;m>o;m--)this.coeffs[m]=this.coeffs[m].subtract(new fe(1)),this.coeffs[m-1]=this.coeffs[m-1].add(new fe(l));f=this.coeffs[o]}}let S=f.mod(l),M=f.subtract(S).divide(l);if(!M.equals(0)){let V=o+1,F=this.coeffs[V]||new fe(0);F=F.add(M),this.coeffs[V]=new fe(F),this.coeffs[o]=new fe(S)}}return this},add(l){let p=Math.max(this.coeffs.length,l.coeffs.length);for(let o=0;o<p;o++){let f=this.coeffs[o]||new fe(0),m=l.coeffs[o]||new fe(0);this.coeffs[o]=f.add(m)}return this},subtract(l){let p=Math.max(this.coeffs.length,l.coeffs.length);for(let o=0;o<p;o++){let f=this.coeffs[o]||new fe(0),m=l.coeffs[o]||new fe(0);this.coeffs[o]=f.subtract(m)}return this},divide(l){let{variable:p}=this,o=t.Utils.arrayClone(this.coeffs),f=t.Utils.arrayClone(l.coeffs),m=o.length,S=f.length-1,M=[];for(let I=0;I<m;I++){let k=m-(I+1),se=k-S,ae=o[k].divide(f[S]);if(se<0)break;M[se]=ae;for(let ce=0;ce<=S;ce++)o[ce+se]=o[ce+se].subtract(f[ce].multiply(ae))}let V=we.fromArray(o,p||"x").trim();return[we.fromArray(M,p||"x"),V]},multiply(l){let p=this.coeffs.length,o=l.coeffs.length,f=[];for(let m=0;m<p;m++){let S=this.coeffs[m];for(let M=0;M<o;M++){let V=m+M,F=l.coeffs[M],I=f[V]||new fe(0);f[V]=I.add(S.multiply(F))}}return this.coeffs=f,this},isZero(){let l=this.coeffs.length;for(let p=0;p<l;p++)if(!this.coeffs[p].equals(0))return!1;return!0},sub(l){let p=new fe(0),o=this.coeffs.length;for(let f=0;f<o;f++){let m=this.coeffs[f];m.equals(0)||(p=p.add(m.multiply(new fe(l**f))))}return p},clone(){let l=new we;return l.coeffs=this.coeffs,l.variable=this.variable,l},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let l=this.lc(),p=this.coeffs.length;for(let o=0;o<p;o++)this.coeffs[o]=this.coeffs[o].divide(l);return this},gcd(l){let p=this.coeffs.length-1,o=l.coeffs.length-1,f;if(p<o)return l.gcd(this);let m=this;for(;!l.isZero();){let M=l.clone();m=m.clone(),f=m.divide(M),l=f[1],m=M}let S=t.Math2.QGCD.apply(null,m.coeffs);if(!S.equals(1)){let M=m.coeffs.length;for(let V=0;V<M;V++)m.coeffs[V]=m.coeffs[V].divide(S)}return m},diff(){let l=[],p=this.coeffs.length;for(let o=1;o<p;o++)l.push(this.coeffs[o].multiply(new fe(o)));return this.coeffs=l,this},integrate(){let l=[0],p=this.coeffs.length;for(let o=0;o<p;o++){let f=new fe(o+1);l[f]=this.coeffs[o].divide(f)}return this.coeffs=l,this},gcf(l){let p=function(m){for(let S=0;S<m.length;S++)if(!m[S].equals(0))return S},o=[];for(let m=0;m<this.coeffs.length;m++){let S=this.coeffs[m];!S.equals(0)&&o.indexOf(S)===-1&&o.push(S)}let f=[t.Math2.QGCD.apply(void 0,o),p(this.coeffs)].toDecimal();if(l){let m=[];m[f[1]-1]=f[0],f=we.fromArray(m,this.variable).fill()}return f},quad(l){let p=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let o=this.coeffs[2]||0,f=this.coeffs[1]||0,m=this.coeffs[0],S=f*f-4*o*m;return S<0&&!l||(p[0]=(-f+Math.sqrt(S))/(2*o),p[1]=(-f-Math.sqrt(S))/(2*o)),p},squareFree(){let l=this.clone(),p=1,o=l.clone().diff(),f=l.clone().gcd(o),m=l.divide(f)[0],S=we.fromArray([new fe(1)],l.variable);for(;!f.equalsNumber(1);){let M=m.gcd(f),V=m.divide(M)[0];if(!V.equalsNumber(1)&&p>1){let F=V.clone();for(let I=1;I<p;I++)F.multiply(V.clone());V=F}S=S.multiply(V),p++,m=M,f=f.divide(M)[0]}return[S,m,p]},toSymbol(){let l=this.coeffs.length,{variable:p}=this;if(l===0)return new t.NerdamerSymbol(0);let o=l-1,f="";for(let m=0;m<l;m++){let S=m===o?"":"+",M=this.coeffs[m];M.equals(0)||(f+=`${M}*${p}^${m}${S}`)}return e.parse(f)},equalsNumber(l){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(l)},toString(){return this.toSymbol().toString()}},H.prototype.coeffs=function(p,o){o&&!this.isPoly(!0)&&e.error("Polynomial expected when requesting coefficients with order"),p||=[];let f=this.clone().distributeMultiplier();if(f.isComposite())for(let m in f.symbols){if(!Object.hasOwn(f.symbols,m))continue;let S=f.symbols[m];S.isComposite()?S.clone().distributeMultiplier().coeffs(p,o):o?p[S.isConstant()?0:S.power.toDecimal()]=S.multiplier:p.push(S.multiplier)}else if(o)p[f.isConstant(!0)?0:f.power.toDecimal()]=f.multiplier;else if(f.group===Z&&f.isImaginary()){let m=new H(f.multiplier);f.each(S=>{(S.isConstant(!0)||S.imaginary)&&(m=e.multiply(m,S))}),p.push(m)}else p.push(f.multiplier);if(o)for(let m=0;m<p.length;m++)p[m]===void 0&&(p[m]=new H(0));return p},H.prototype.tBase=function(p){if(typeof p>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let o=[],f=this.collectSymbols(null,null,null,!0),m=f.length;for(let S=0;S<m;S++){let M=f[S],V=M.group,F=new Se(M.multiplier,[],p);if(V===Z)for(let I in M.symbols){if(!Object.hasOwn(M.symbols,I))continue;let k=M.symbols[I];F.terms[p[I]]=k.power}else F.terms[p[M.value]]=M.power;o.push(F.fill()),F.updateCount()}return o},H.prototype.altVar=function(p){let o=this.multiplier.toString(),f=this.power.toString();return(o==="1"?"":`${o}*`)+p+(f==="1"?"":`^${f}`)},H.prototype.sameVars=function(p){if(!(this.symbols||this.group===p.group))return!1;for(let o in this.symbols){if(!Object.hasOwn(this.symbols,o))continue;let f=this.symbols[o],m=p.symbols[o];if(!m||f.value!==m.value)return!1}return!0},H.prototype.groupTerms=function(p){p=String(p);let o,f,m,S=[];return this.each(M=>{if(M.group===X){m=M.groupTerms(p);for(let V=0;V<m.length;V++){let F=m[V];F&&(S[V]=F)}}else o=t.Utils.decompose_fn(M,p,!0),f=o.x.value===p?Number(o.x.power):0,S[f]=e.add(S[f]||new H(0),o.a)}),S},H.prototype.collectFactors=function(){let p=[];return this.group===Z?this.each(o=>{p.push(o.clone())}):p.push(this.clone()),p};function qe(){this.factors={},this.length=0}qe.prototype.getNumberSymbolics=function(){let p=0;return this.each(o=>{o.isConstant(!0)||p++}),p},qe.prototype.add=function(p){if(p.equals(0))return this;if(p.equals(-1)&&this.length>0){let o=t.Utils.firstObject(this.factors,null,!0),f=e.symfunction(t.Settings.PARENTHESIS,[o.obj]).negate();return delete this.factors[o.key],this.add(f),this.length--,this}if(p.group===Z){let o=this;p.multiplier.equals(1)||o.add(new H(p.multiplier)),p.each(f=>{o.add(f)})}else{this.preAdd&&(p=this.preAdd(p)),this.pFactor&&(p=e.pow(p,new H(this.pFactor)));let o=p.isConstant();if(o&&p.equals(1))return this;let f=o?p.value:p.text();f in this.factors?(this.factors[f]=e.multiply(this.factors[f],p),this.factors[f].equals(1)&&(delete this.factors[f],this.length--)):(this.factors[f]=p,this.length++)}return this},qe.prototype.toSymbol=function(){let p=new H(1),o=Object.values(this.factors).sort((f,m)=>f.group>m.group);for(let f=0,m=o.length;f<m;f++){let S=o[f],M=S.power.equals(1)&&S.fname!==""?e.symfunction(t.PARENTHESIS,[S]):S;p=e.multiply(p,M)}return p.fname===""&&(p=H.unwrapPARENS(p)),p},qe.prototype.merge=function(p){for(let o in p)o in this.factors?this.factors[o]=e.multiply(this.factors[o],p[o]):this.factors[o]=p[o];return this},qe.prototype.each=function(p){for(let o in this.factors){if(!Object.hasOwn(this.factors,o))continue;let f=this.factors[o];f.fname===t.PARENTHESIS&&f.isLinear()&&(f=f.args[0]),p.call(this,f,o)}return this},qe.prototype.count=function(){return j(this.factors).length},qe.prototype.clean=function(){try{let p=t.Settings.CONST_HASH;this.factors[p].lessThan(0)&&(this.factors[p].equals(-1)?delete this.factors[p]:this.factors[p].negate(),this.each(o=>{o.negate()}))}catch(p){if(p.message==="timeout")throw p}},qe.prototype.toString=function(){return this.toSymbol().toString()};function Se(l,p,o){this.terms=p||[],this.coeff=l,this.map=o,this.sum=new t.Frac(0),this.image=void 0}Se.prototype.updateCount=function(){this.count||=0;for(let p=0;p<this.terms.length;p++)this.terms[p].equals(0)||this.count++;return this},Se.prototype.getVars=function(){let p=[];for(let o=0;o<this.terms.length;o++){let f=this.terms[o],m=this.getRevMap();f.equals(0)||p.push(this.revMap[o])}return p.join(" ")},Se.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count},Se.prototype.toSymbol=function(p){p||=this.getRevMap();let o=new H(this.coeff);for(let f=0;f<this.terms.length;f++){let m=p[f],S=this.terms[f];if(S.equals(0)||m===de)continue;let M=new H(m);M.power=S,o=e.multiply(o,M)}return o},Se.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let p={};for(let o in this.map)Object.hasOwn(this.map,o)&&(p[this.map[o]]=o);return this.revMap=p,p},Se.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},Se.prototype.getImg=function(){return this.image||this.generateImage(),this.image},Se.prototype.fill=function(){let p=this.map.length;for(let o=0;o<p;o++)typeof this.terms[o]>"u"?this.terms[o]=new t.Frac(0):this.sum=this.sum.add(this.terms[o]);return this},Se.prototype.divide=function(p){let o=this.coeff.divide(p.coeff),f=this.terms.length,m=new Se(o,[],this.map);for(let S=0;S<f;S++)m.terms[S]=this.terms[S].subtract(p.terms[S]),m.sum=m.sum.add(m.terms[S]);return m},Se.prototype.multiply=function(p){let o=this.coeff.multiply(p.coeff),f=this.terms.length,m=new Se(o,[],this.map);for(let S=0;S<f;S++)m.terms[S]=this.terms[S].add(p.terms[S]),m.sum=m.sum.add(m.terms[S]);return m},Se.prototype.isZero=function(){return this.coeff.equals(0)},Se.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},t.Utils.toMapObj=function(p){let o=0,f={};for(let m=0;m<p.length;m++){let S=p[m];typeof f[S]>"u"&&(f[S]=o,o++)}return f.length=o,f},t.Utils.filledArray=function(p,o,f){let m=[];for(;o--;)m[o]=f?new f(p):p;return m},t.Utils.arrSum=function(p){let o=0,f=p.length;for(let m=0;m<f;m++)o+=p[m];return o},t.Utils.haveIntersection=function(p,o){return o.length>p.length&&([p,o]=[o,p]),p.some(f=>o.indexOf(f)>-1)},t.Utils.subFunctions=function(p,o){o||={};let f=[],m=new Set(Ne(p));return p.each(S=>{if(S.group===L||S.previousGroup===L){let M=t.Utils.text(S,"hash"),V=o[M];if(V)f.push(S.altVar(V));else{let F=0,I;do I=S.fname+j(o).length+(F>0?String(F):""),F++;while(m.has(I));o[M]=I,f.push(S.altVar(I))}}else S.group===Z||S.group===X||S.group===z?f.push(t.Utils.subFunctions(S,o)):f.push(S.text())}),p.group===z||p.group===X?p.altVar(t.Utils.inBrackets(f.join("+"))):p.group===Z?p.altVar(t.Utils.inBrackets(f.join("*"))):p.text()},t.Utils.getFunctionsSubs=function(p){let o={};for(let f in p)Object.hasOwn(p,f)&&(o[p[f]]=e.parse(f));return o};let K=t.Algebra={version:"1.4.6",proots(l,p){p||=7;let o=0,f=[],m=function(M,V,F){let I=S(M,V,F).concat(f);for(let k=0;k<o;k++)I.unshift(0);return I};if(l instanceof H&&l.isPoly()){if(l.distributeMultiplier(),l.group===X){let ae=t.Utils.arrayMin(j(l.symbols)),ce=l.symbols[ae].clone().toUnitMultiplier();l=e.expand(e.divide(l,ce)),f.push(0)}if(l.group===t.groups.S)return[0];if(l.group===t.groups.PL){let ae=j(l.symbols),ce=t.Utils.arrayMin(ae);l=t.PARSER.divide(l,t.PARSER.parse(`${l.value}^${ce}`))}let M=j(l.symbols).sort().pop(),V=l.group===t.groups.PL?l.symbols:l.symbols[M],F=V.group,I=F===_?[V.power.toDecimal()]:j(V.symbols),k=[],se=t.Utils.arrayMax(I);for(let ae=1;ae<=se;ae++){let ce=0;I.indexOf(`${ae}`)!==-1&&(F===_?ce=V.multiplier:ce=V.symbols[ae].multiplier),k.unshift(ce)}return k.push(l.symbols[de].multiplier),V.group===_&&(k[0]=V.multiplier),m(k,I,se)}if(t.Utils.isArray(l)){let M=l,V=[],F=[],I=0;for(let se=0;se<M.length;se++){let ae=M[se][0],ce=M[se][1],Me=ce-I-1;for(let me=0;me<Me;me++)V.unshift(0);V.unshift(ae),ce!==0&&F.push(ce),I=ce}let k=Math.max.apply(void 0,F);return m(V,F,k)}throw new t.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function S(M,V,F){let k,se=M.slice(0);if(M.unshift(F),F>100)throw new t.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let ae=[],ce={};for(ce.Degree=F,k=0;k<F;k++)ae.push(0);let Me=ae.slice(0);function me(Ae,$,W,Y,q,ee){q[0]=ee.b=Y[0],q[1]=ee.a=-($*ee.b)+Y[1];for(let B=2;B<Ae;B++)q[B]=-($*ee.a+W*ee.b)+Y[B],ee.b=ee.a,ee.a=q[B]}function $e(Ae,$,W,Y,q,ee,B,T,ge){let a={},c=3;return a.b=a.a=0,me($,B,T,ee,ge,a),q.c=a.a,q.d=a.b,Math.abs(q.c)<=100*Ae*Math.abs(ee[$-1])&&Math.abs(q.d)<=100*Ae*Math.abs(ee[$-2])||(q.h=T*Y,Math.abs(q.d)>=Math.abs(q.c)?(c=2,q.e=W/q.d,q.f=q.c/q.d,q.g=B*Y,q.a3=q.e*(q.g+W)+q.h*(Y/q.d),q.a1=-W+q.f*Y,q.a7=q.h+(q.f+B)*W):(c=1,q.e=W/q.c,q.f=q.d/q.c,q.g=q.e*B,q.a3=q.e*W+(q.g+q.h/q.c)*Y,q.a1=-(W*(q.d/q.c))+Y,q.a7=q.g*q.d+q.h*q.f+W)),c}function Xe(Ae,$,W,Y,q,ee,B,T,ge){if(W===3){B[1]=B[0]=0;for(let c=2;c<$;c++)B[c]=T[c-2];return}let a=W===1?q:Y;if(Math.abs(ee.a1)>10*Ae*Math.abs(a)){ee.a7/=ee.a1,ee.a3/=ee.a1,B[0]=ge[0],B[1]=-(ge[0]*ee.a7)+ge[1];for(let c=2;c<$;c++)B[c]=-(ge[c-1]*ee.a7)+T[c-2]*ee.a3+ge[c]}else{B[0]=0,B[1]=-(ge[0]*ee.a7);for(let c=2;c<$;c++)B[c]=-(ge[c-1]*ee.a7)+T[c-2]*ee.a3}}function ye(Ae,$,W,Y,q,ee,B,T,ge,a,c,A,x,b,Q,J,G){let D,ne,pe,Ce,Te,Fe,xe,He,je;$.b=$.a=0,Ae===3||(Ae===2?(D=(W+c)*a+A,ne=(a+x)*T+b*ge):(D=W+x*B+A*a,ne=T+(x+b*a)*ge),pe=-(Q[J-1]/G[J]),Ce=-(Q[J-2]+pe*G[J-1])/G[J],Te=b*Ce*Y,Fe=pe*ee,xe=pe*pe*q,He=-(Fe+xe)+Te,je=-He+ne+pe*D,je!==0&&($.a=-((x*(xe+Fe)+b*(pe*Y+Ce*ee))/je)+x,$.b=b*(1+He/je)))}function De(Ae,$,W,Y){let q,ee;if(Y.sr=Y.si=Y.lr=Y.li=0,Ae===0){Y.sr=$===0?Y.sr:-(W/$);return}if(W===0){Y.lr=-($/Ae);return}let B=$/2;Math.abs(B)<Math.abs(W)?(ee=W>=0?Ae:-Ae,ee=-ee+B*(B/Math.abs(W)),q=Math.sqrt(Math.abs(ee))*Math.sqrt(Math.abs(W))):(ee=-(Ae/B*(W/B))+1,q=Math.sqrt(Math.abs(ee))*Math.abs(B)),ee>=0?(q=B>=0?-q:q,Y.lr=(-B+q)/Ae,Y.sr=Y.lr===0?Y.sr:W/Y.lr/Ae):(Y.lr=Y.sr=-(B/Ae),Y.si=Math.abs(q/Ae),Y.li=-Y.si)}function Be(Ae,$,W,Y,q,ee,B,T,ge,a,c,A){let x={},b,Q,J,G,D,ne,pe,Ce,Te,Fe,xe,He=0,je,ze=0;W.NZ=0,ne=Y,Ce=q;do{if(x.li=x.lr=x.si=x.sr=0,De(1,ne,Ce,x),W.szr=x.sr,W.szi=x.si,W.lzr=x.lr,W.lzi=x.li,Math.abs(Math.abs(W.szr)-Math.abs(W.lzr))>.01*Math.abs(W.lzr))break;for(me(B,ne,Ce,ge,ee,T),Q=Math.abs(-(W.szr*T.b)+T.a)+Math.abs(W.szi*T.b),Fe=Math.sqrt(Math.abs(Ce)),b=2*Math.abs(ee[0]),D=-(W.szr*T.b),xe=1;xe<$;xe++)b=b*Fe+Math.abs(ee[xe]);if(b=b*Fe+Math.abs(D+T.a),b=(9*b+2*Math.abs(D)-7*(Math.abs(T.a+D)+Fe*Math.abs(T.b)))*Ae,Q<=20*b){W.NZ=2;break}if(He++,He>20)break;if(He>=2&&G<=.01&&Q>=J&&!ze){for(G=G<Ae?Math.sqrt(Ae):Math.sqrt(G),ne-=ne*G,Ce+=Ce*G,me(B,ne,Ce,ge,ee,T),xe=0;xe<5;xe++)je=$e(Ae,$,T.a,T.b,c,A,ne,Ce,a),Xe(Ae,$,je,T.a,T.b,c,A,a,ee);ze=1,He=0}J=Q,je=$e(Ae,$,T.a,T.b,c,A,ne,Ce,a),Xe(Ae,$,je,T.a,T.b,c,A,a,ee),je=$e(Ae,$,T.a,T.b,c,A,ne,Ce,a),ye(je,T,T.a,c.a1,c.a3,c.a7,T.b,c.c,c.d,c.f,c.g,c.h,ne,Ce,A,$,ge),pe=T.a,Te=T.b,Te!==0&&(G=Math.abs((-Ce+Te)/Te),ne=pe,Ce=Te)}while(Te!==0)}function We(Ae,$,W,Y,q,ee,B,T,ge){let a,c,A,x,b,Q,J,G,D,ne,pe,Ce=Y-1;for($.NZ=pe=D=0,J=W.a;;){for(Q=q[0],B[0]=Q,ne=1;ne<ee;ne++)B[ne]=Q=Q*J+q[ne];for(A=Math.abs(Q),x=Math.abs(J),a=.5*Math.abs(B[0]),ne=1;ne<ee;ne++)a=a*x+Math.abs(B[ne]);if(A<=20*Ae*(2*a-A)){$.NZ=1,$.szr=J,$.szi=0;break}if(pe++,pe>10)break;if(pe>=2&&Math.abs(G)<=.001*Math.abs(-G+J)&&A>b){D=1,$.a=J;break}for(b=A,ge[0]=c=T[0],ne=1;ne<Y;ne++)ge[ne]=c=c*J+T[ne];if(Math.abs(c)>Math.abs(T[Ce])*10*Ae)for(G=-(Q/c),T[0]=B[0],ne=1;ne<Y;ne++)T[ne]=G*ge[ne-1]+B[ne];else for(T[0]=0,ne=1;ne<Y;ne++)T[ne]=ge[ne-1];for(c=T[0],ne=1;ne<Y;ne++)c=c*J+T[ne];G=Math.abs(c)>Math.abs(T[Ce])*10*Ae?-(Q/c):0,J+=G}return D}function Le(Ae,$,W,Y,q,ee,B,T,ge,a,c,A){let x={},b={},Q=new Array($),J=new Array($),G,D,ne,pe,Ce,Te,Fe,xe,He,je,ze,at,nt,pt,At,Dt,lt,Ct,qt,Ot=1,Lt,Jt,a0,Yt,r0,Kt;for(A.NZ=0,pe=ne=.25,Ce=Y,xe=q,x.b=x.a=0,me(ge,c,q,T,a,x),G=x.a,D=x.b,b.h=b.g=b.f=b.e=b.d=b.c=b.a7=b.a3=b.a1=0,Yt=$e(Ae,B,G,D,b,ee,c,q,Q),Lt=0;Lt<W;Lt++){if(Ct=1,Xe(Ae,B,Yt,G,D,b,ee,Q,a),Yt=$e(Ae,B,G,D,b,ee,c,q,Q),ye(Yt,x,G,b.a1,b.a3,b.a7,D,b.c,b.d,b.f,b.g,b.h,c,q,ee,B,T),At=x.a,lt=Dt=x.b,je=ee[B-1]===0?0:-(T[B]/ee[B-1]),ze=nt=1,Lt!==0&&Yt!==3&&(nt=lt===0?nt:Math.abs((lt-xe)/lt),ze=je===0?ze:Math.abs((je-Ce)/je),pt=nt<Fe?nt*Fe:1,at=ze<Te?ze*Te:1,r0=pt<pe?1:0,Jt=at<ne?1:0,Jt||r0)){for(qt=0;qt<B;qt++)J[qt]=ee[qt];for(He=je,a0=Kt=0;;){if(!(Ct&&(Ct=0)==0&&Jt&&(!r0||at<pt))){if(Be(Ae,B,A,At,Dt,a,ge,x,T,Q,b,ee),G=x.a,D=x.b,A.NZ>0)return;if(Ot=Kt=1,pe*=.25,a0||!Jt)Ot=0;else for(qt=0;qt<B;qt++)ee[qt]=J[qt]}if(Ot!==0){if(x.a=He,Ot=We(Ae,A,x,B,T,ge,a,ee,Q),He=x.a,A.NZ>0)return;if(a0=1,ne*=.25,Ot!==0){At=-(He+He),Dt=He*He;continue}}for(qt=0;qt<B;qt++)ee[qt]=J[qt];if(!r0||Kt)break}me(ge,c,q,T,a,x),G=x.a,D=x.b,Yt=$e(Ae,B,G,D,b,ee,c,q,Q)}xe=lt,Ce=je,Fe=nt,Te=ze}}function Ve(Ae,$,W,Y){let q=Ae.Degree,ee=Math.PI/180,B=Math.LN2,T=Ae.Degree+1,ge=new Array(T),a=new Array(T),c=new Array(T),A=new Array(T),x={},b={},Q,J,G,D,ne,pe,Ce,Te,Fe,xe,He,je,ze,at,nt,pt,At,Dt,lt,Ct,qt,Ot,Lt,Jt;je=1;do J=je,je/=2,ze=1+je;while(ze>1);let a0=Number.MIN_VALUE/J,Yt=Math.cos(94*ee),r0=Math.sin(94*ee),Kt=Math.sqrt(.5),w0=-Kt;for(b.NZ=lt=0,b.szr=b.szi=b.lzr=b.lzi=0;$[q]===0;)W[lt]=Y[lt]=0,q--,lt++;for(Lt=q+1;q>=1;){if(q<=2){q<2?(W[Ae.Degree-1]=-($[1]/$[0]),Y[Ae.Degree-1]=0):(x.li=x.lr=x.si=x.sr=0,De($[0],$[1],$[2],x),W[Ae.Degree-2]=x.sr,Y[Ae.Degree-2]=x.si,W[Ae.Degree-1]=x.lr,Y[Ae.Degree-1]=x.li);break}for(Ce=0,Te=Number.MAX_VALUE,k=0;k<Lt;k++)xe=Math.abs($[k]),xe>Ce&&(Ce=xe),xe!==0&&xe<Te&&(Te=xe);if(Fe=a0/Te,(Fe<=1&&Ce>=10||Fe>1&&Number.MAX_VALUE/Fe>=Ce)&&(Fe=Fe===0?Number.MIN_VALUE:Fe,qt=Math.floor(Math.log(Fe)/B+.5),ne=2**qt,ne!==1))for(k=0;k<Lt;k++)$[k]*=ne;for(let it=0;it<Lt;it++)a[it]=Math.abs($[it]);a[q]=-a[q],Ot=q-1,xe=Math.exp((Math.log(-a[q])-Math.log(a[0]))/q),a[Ot]!==0&&(He=-a[q]/a[Ot],xe=He<xe?He:xe),He=xe;do{xe=He,He=.1*xe,pe=a[0];for(let it=1;it<Lt;it++)pe=pe*He+a[it]}while(pe>0);D=xe;do{G=pe=a[0];for(let it=1;it<q;it++)pe=xe*pe+a[it],G=xe*G+pe;pe=xe*pe+a[q],D=pe/G,xe-=D}while(Math.abs(D/xe)>.005);Q=xe;for(let it=1;it<q;it++)ge[it]=(q-it)*$[it]/q;for(ge[0]=$[0],je=$[q],ze=$[Ot],Jt=ge[Ot]===0?1:0,Ct=0;Ct<5;Ct++)if(at=ge[Ot],Jt){for(let it=0;it<Ot;it++)lt=Ot-it,ge[lt]=ge[lt-1];ge[0]=0,Jt=ge[Ot]===0?1:0}else{pt=-je/at;for(let it=0;it<Ot;it++)lt=Ot-it,ge[lt]=pt*ge[lt-1]+$[lt];ge[0]=$[0],Jt=Math.abs(ge[Ot])<=Math.abs(ze)*J*10?1:0}for(let it=0;it<q;it++)A[it]=ge[it];for(Ct=1;Ct<=20;Ct++)if(Dt=-(r0*w0)+Yt*Kt,w0=r0*Kt+Yt*w0,Kt=Dt,nt=Q*Kt,At=-(2*nt),Le(J,T,20*Ct,nt,Q,ge,q,$,Lt,c,At,b),b.NZ===0)for(let it=0;it<q;it++)ge[it]=A[it];else{lt=Ae.Degree-q,W[lt]=b.szr,Y[lt]=b.szi,Lt-=b.NZ,q=Lt-1;for(let it=0;it<Lt;it++)$[it]=c[it];b.NZ===1||(W[lt+1]=b.lzr,Y[lt+1]=b.lzi);break}if(Ct>20){Ae.Degree-=q;break}}}Ve(ce,se,Me,ae);let Qe=ae.length;for(k=0;k<Qe;k++){let Ae=ie(ae[k],p+8),$=ie(Me[k],p+8);$=p-String($).length>2?$:Me[k];let W=Ae<0?"-":"";$===0&&($=""),Ae===0&&(Ae=""),Math.abs(Ae)===1?Ae=`${W}i`:Ae?Ae=`${Ae}*i`:Ae="";let Y=$&&Ae?`${$}+${Ae}`:$+Ae;Me[k]=Y.replace(/\+-/gu,"-")}return Me}},roots(l){if(l.isConstant(!0,!0))return t.Utils.nroots(l);let p=K.proots(l).map(o=>e.parse(o));return t.Vector.fromArray(p)},froot(l,p,o){return function(m){let M=o||t.Utils.build(t.Calculus.diff(l.clone())),V=l instanceof Function?l:t.Utils.build(l),F=1e4,I=!1,k=0;for(;!I;){let se=m-V(m)/M(m),ae=Math.abs(se)-Math.abs(m),ce=Math.abs(ae);m=se,ce<1e-12?I=!0:k>F&&(m=null,I=!0),k++}return m}(Number(p))},quad(l,p,o){let f=function(m,S,M,V){return e.parse(`-(${S}+${V}*sqrt((${S})^2-4*(${m})*(${M})))/(2*${m})`)};return[f(l,p,o,1),f(l,p,o,-1)]},sumProd(l,p){return K.quad(-p,l,-1).map(o=>o.invert())},coeffs(l,p,o){l=e.expand(l),o||=[new H(0)];let f=Ne(l);p===void 0&&f.length===1&&(p=f[0]),p=String(p),l.group===R&&l.contains(p,!0)&&e.error(`Unable to get coefficients using expression ${l.toString()}`),f=Ne(l);let m=l.contains("pi")||l.contains("e")||l.containsFunction("sqrt");if(f.length===1&&f[0]===p&&!l.isImaginary()&&!m){let S=new we(l).coeffs.map(M=>new H(M));for(let M=0,V=S.length;M<V;M++){let F=S[M],I=o[M];I&&(F=e.add(I,F)),o[M]=F}}else if(f.length===1&&f[0]===p&&!l.isImaginary()&&m&&l.group===z){let S=t.Utils.getCoeffs(l,p);for(let M=0,V=S.length;M<V;M++){let F=S[M],I=o[M];I&&(F=e.add(I,F)),o[M]=F}}else if(p||e.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),f.indexOf(p)===-1)o[0]=e.add(l,o[0]);else{o||=[new H(0)];let S;if(l.group===Z){let M=l.symbols[p];M||e.error("Expression is not a polynomial!");let V=Number(M.power);S=e.divide(l.clone(),M.clone()),(S.contains(p,!0)||V<0||!g(V))&&e.error("Expression is not a polynomial!");let F=o[V];F&&(S=e.add(F,S)),o[V]=S}else l.group===z&&l.each(M=>{K.coeffs(M.clone(),p,o)},!0)}for(let S=0,M=o.length;S<M;S++)typeof o[S]>"u"&&(o[S]=new H(0));return o},polyPowers(l,p,o){o||=[];let f=l.group;if(f===X&&p===l.value)o=o.concat(j(l.symbols));else if(f===z)for(let m in l.symbols){if(!Object.hasOwn(l.symbols,m))continue;let S=l.symbols[m],M=S.group,V=S.value;if(M===_&&p===V)o.push(S.power);else if(M===X||M===z)o=K.polyPowers(S,p,o);else if(M===Z&&S.contains(p)){let F=S.symbols[p];F&&o.push(F.power)}else(M===u||p!==V)&&o.push(0)}else f===Z&&l.contains(p)&&o.push(t.Utils.decompose_fn(l,p,!0).x.power);return t.Utils.arrayUnique(o).sort()},Factor:{split(l){let p=new H(1),o=new H(1);return K.Factor.factorInner(l,new qe).each(f=>{let m=e.parse(f);f.isConstant(!0)?p=e.multiply(p,m):o=e.multiply(o,m)}),[p,o]},mix(l,p){let o=j(l),f=o.length,m=[];for(let S=0;S<f;S++){let M=o[S],V=l[M],F=m.length;for(let I=0;I<F;I++){let k=m[I]*M;m.push(k),p&&m.push(-k)}for(let I=1;I<=V;I++)m.push(M**I)}return m},common(l,p){try{if(l.group===z){let o=e.expand(l.clone(),!0).collectSymbols(null,null,(V,F)=>(F.length||1)-(V.length||1)),f={},m=[];for(let V=0;V<o.length;V++){let F=o[V];m.push(F.multiplier.clone()),F.each(I=>{let k=Number(I.power);if(isNaN(k))throw new Error("exiting");I.value in f?(k<f[I.value][0]&&(f[I.value][0]=k),f[I.value][1].push(I)):f[I.value]=[k,[I]]})}let S=new H(1);for(let V in f)f[V][1].length===o.length&&(S=e.multiply(S,e.pow(new H(V),new H(f[V][0]))));let M=t.Math2.QGCD.apply(null,m);if(!M.equals(1)){p.add(new H(M));for(let V=0;V<o.length;V++)o[V].multiplier=o[V].multiplier.divide(M)}if(!S.equals(1)){p.add(S),l=new H(0);for(let V=0;V<o.length;V++)l=e.add(l,e.divide(o[V],S.clone()))}}}catch(o){if(o.message==="timeout")throw o}return l},zeroes(l,p){let o=function(){throw new t.exceptions.ValueLimitExceededError("Exiting")};try{let f,m,S;l=e.expand(l.clone());let M=l.toString(),V=Ne(l);m=new H(0);let F=[],I=[];for(let k=0,se=V.length;k<V.length;k++){let ae={};for(let Me=0;Me<se;Me++)k!==Me&&(ae[V[Me]]=0);f=e.parse(M,ae);let ce=f.power;g(ce)||o(),F.push(f),I.push(f.power)}if(t.Utils.allSame(I)){let k=l.length,se=F.length,ae=Math.round((Math.sqrt(8*k-1)-3)/2);se===2?S=new fe(I[0]/(k-1)):se===3&&ae!==0?S=new fe(I[0]/ae):S=t.Math2.QGCD.apply(null,I)}else S=t.Math2.QGCD.apply(null,I);if(!g(S))return l;for(let k=0;k<F.length;k++){let se=F[k],ae=se.power.clone().divide(S);if((se.multiplier.num<0||se.multiplier.den<0)&&ae%2===0)return l;se.multiplier=new fe(se.multiplier**(1/ae)),se.power=S.clone(),m=e.add(m,se)}if(m.group!==z)return l;for(;;){let k=K.div(l.clone(),m.clone());if(k[1].equals(0)){if(l=k[0],p.add(m.clone()),l.equals(1))break}else break}}catch(f){if(f.message==="timeout")throw f}return l},factor(l,p){t.Utils.checkTimeout();let o=p?[...p]:null;try{let f=K.Factor.factorInner(l,p);return f=f.pushMinus(),f}catch(f){if(f.message==="timeout")throw f;return p&&p.splice(0,p.length,...o),l}},factorInner(l,p){if(t.Utils.checkTimeout(),l.isConstant()&&l.isInteger())return t.Math2.factor(l);let o=e.parse(l);if(o.isConstant())return o.isInteger()?t.Math2.factor(o):l;if(o.equals(0)||o.equals(1))return o;let f=K.Factor._factor(o,p);if(f.equals(l)||f.equals(0)||f.equals(1))return f;if(f.group===Z){let m=new H(1),S=e.parse(f.power),M=e.parse(f.multiplier);f.toUnitMultiplier(),f.multiplier.lessThan(0)&&(m.negate(),f.negate()),f.each(F=>{let I=e.parse(K.Factor._factor(F));if(M=e.multiply(M,H.create(I.multiplier)),I.toUnitMultiplier(),I.group===Z){let k=new H(1);I.each(se=>{let ae=e.parse(K.Factor._factor(se));ae.group===Z&&(M=e.multiply(M,H.create(ae.multiplier)),ae.toUnitMultiplier()),k=e.multiply(k,ae)}),k=e.pow(k,new H(I.power)),m=e.multiply(m,k)}else m=e.multiply(m,I)});let V=e.pow(m,S);f=e.multiply(M,V)}return f},quadFactor(l,p){if(l.isPoly()&&K.degree(l.equals(2))){let o=t.Utils.variables(l)[0],f=K.coeffs(l,o);if(f.length<3)return l;let m=K.Factor._factor(f[2].clone());if(m.group===Z){let S=m.collectSymbols();if(S.length>2)return l;let M=e.multiply(e.parse(f[0]),e.parse(S[0])),V=e.parse(f[1]).negate(),F=e.parse(S[1]),I=K.quad(F,V,M).filter(k=>t.Utils.isInt(k));if(I.length===1){let k=I[0],se=e.divide(f[0],e.parse(k));t.Utils.isInt(se)&&(p.add(e.parse(Re("({0})*({1})+({2})",S[1],o,se))),p.add(e.parse(Re("({0})*({1})+({2})",S[0],o,k))),l=new H(1))}}}return l},cubeFactor(l,p){if(l.isComposite()){let o=l.collectSymbols();if(o.length===2){let f=o[0].sign(),m=o[0].clone().abs(),S=o[1].sign(),M=o[1].clone().abs();if(m.isCube()&&M.isCube()){f<S&&([f,S]=[S,f],[m,M]=[M,m]);let V=e.parse(m.getNth(3)),F=e.parse(M.getNth(3)),I=e.multiply(e.expand(e.pow(m.clone().toUnitMultiplier(),e.parse("1/3"))),V),k=e.multiply(e.expand(e.pow(M.clone().toUnitMultiplier(),e.parse("1/3"))),F);f===1&&S===-1?(p.add(e.parse(Re("(({0})-({1}))",I,k))),p.add(e.parse(Re("(({0})^2+({0})*({1})+({1})^2)",I,k))),l=H(1)):f===1&&S===1&&(p.add(e.parse(Re("(({0})+({1}))",I,k))),p.add(e.parse(Re("(({0})^2-({0})*({1})+({1})^2)",I,k))),l=H(1))}}}return l},_factor(l,p){t.Utils.checkTimeout();let o=l.group;if(l.group===L){let m=l.args[0];if(m.group===_&&m.isSimple())return l}else if(l.group===_&&l.isSimple())return l;if(l.group===z){l.distributeMultiplier(!0);let m=new H(0);l.each(S=>{(S.group===z&&S.power.greaterThan(1)||S.group===Z)&&(S=e.expand(S)),m=e.add(m,S)}),m.power=l.power,l=m}l.group===L&&l.fname!=="sqrt"&&(l=t.Utils.evaluate(l));let f=l.clone();try{if(l.group===Z){let S=e.parse(l.power),M=K.Simplify.strip(l.getDenom()),V=K.Simplify.strip(l.getNum()),F=M.pop(),I=V.pop();if(I.equals(l))return l;let k=K.Factor.factorInner(I),se=K.Factor.factorInner(F),ae=K.Simplify.unstrip(V,k),ce=K.Simplify.unstrip(M,se);return e.divide(ae,ce)}if(l.group===_)return l;if(l.isConstant())return l.equals(1)||l.equals(0)||!l.isInteger()?l.clone():t.Math2.factor(l);let m=l.power.clone();if(g(m)&&!(m.lessThan(0)&&l.group===L)){let S=m.sign();l.toLinear(),p||=new qe;let M={};l=e.parse(t.Utils.subFunctions(l,M)),j(M).length>0&&(p.preAdd=function(Me){return e.parse(Me,t.Utils.getFunctionsSubs(M))}),l.isLinear()||(p.pFactor=l.power.toString(),l.toLinear());let V=Ne(l);l.isImaginary()&&V.push(t.Settings.IMAGINARY);let F=V.length>1;if(F){let ce=!0,Me=!0;if(l.each(me=>{me.group!==_&&(ce=!1),me.multiplier.equals(1)||(Me=!1)}),ce&&Me)return e.pow(e.parse(l,t.Utils.getFunctionsSubs(M)),e.parse(m))}let I=new qe;l=K.Factor.coeffFactor(l,I),I.each(ce=>{Ee(m)&&ce.lessThan(0)&&ce.negate(),S<0&&ce.invert(),p.add(ce)});let k=new qe;if(l=K.Factor.powerFactor(l,k),k.each(ce=>{S<0&&ce.invert(),p.add(ce)}),F)l=K.Factor.cubeFactor(l,p),l=K.Factor.mfactor(l,p),p.each(ce=>{S<0&&ce.power.negate()});else{let ce=V[0];l=K.Factor.squareFree(l,p,ce);let Me=new qe;l=K.Factor.trialAndError(l,Me,ce);let me=Me.toSymbol();if(me.equals(f))return me;for(let $e in Me.factors){if(!Object.hasOwn(Me.factors,$e))continue;let Xe=Me.factors[$e];p.add(e.pow(Xe,e.parse(m)))}l.equals(f)&&(l=K.Factor.quadFactor(l,p))}l=e.parse(l,t.Utils.getFunctionsSubs(M));let se=p.length===1;p.add(e.pow(l,e.parse(m)));let ae=p.toSymbol();return se&&l.equals(1)&&ae.isLinear()&&(ae=e.pow(ae,e.parse(m))),ae}return l}catch(m){if(m?.message==="timeout")throw m;return f}},reduce(l,p){if(l.group===z&&l.length===2){let o=l.collectSymbols().sort((f,m)=>m.multiplier-f.multiplier);if(o[0].power.equals(o[1].power)){let f=e.parse(o[0].power),m=o[0].clone().toLinear(),S=o[1].clone().toLinear();p.add(e.add(m.clone(),S.clone())),S.negate();let M=Number(f),V=new H(0);for(let F=1;F<=M;F++){let I=e.pow(m.clone(),e.subtract(f.clone(),new H(F))),k=e.pow(S.clone(),e.subtract(new H(F),new H(1)));V=e.add(V,e.multiply(I,k))}return V}}return l},squareFree(l,p,o){if(l.isConstant()||l.group===_||!l.isPoly())return l;let m=new we(l,o).squareFree(),S=m[2];if(S!==1){let M=m[1].toSymbol();return M.power=M.power.multiply(new fe(S)),p.add(K.Factor.factorInner(M)),K.Factor.squareFree(m[0].toSymbol(),p)}return l},powerFactor(l,p){if(l.group!==X||l.previousGroup===R)return l;let o=j(l.symbols);if(!t.Utils.allNumeric(o))return l;let f=t.Utils.arrayMin(o),m=new H(0),S=e.parse(`${l.value}^${f}`);return l.each(M=>{M=e.divide(M,S.clone()),m=e.add(m,M)}),p.add(S),m},coeffFactor(l,p){if(l.isComposite()){let o=t.Math2.QGCD.apply(null,l.coeffs());if(o.equals(1)){let f=function(M){let V;return M.group===Z?(V=0,M.each(F=>{V+=F.power})):V=Number(M.power),V},m=l.collectSymbols(null,null,null,!0).sort((M,V)=>M.isConstant(!0)?1:V.power-M.power),S=m[0];(f(S)>f(m[1])||m[1].isConstant(!0))&&S.multiplier.lessThan(0)&&(p.add(new H(-1)),l.each(M=>{M.negate()},!0))}else l.each(f=>{f.isComposite()?f.each(m=>{m.multiplier=m.multiplier.divide(o)}):f.multiplier=f.multiplier.divide(o)}),l.updateHash();p&&p.add(new H(o))}return l},trialAndError(l,p,o){let f=l.clone();try{let m=[];if(l.isConstant()||l.group===_||!l.isPoly())return l;let S=new we(l,o),M=S.coeffs[0],V=t.Math2.ifactor(M),F=K.proots(l);for(let I=0;I<F.length;I++){let k=F[I],se=1;if(!isNaN(k)){for(let $e in V){if(!Object.hasOwn(V,$e))continue;let Xe=t.Utils.round(Math.log($e)/Math.log(Math.abs(k)),8);if(g(Xe)){k=$e,se=Xe;break}}let ae=new fe(k),ce=[new fe(ae.num).negate()];ce[se]=new fe(ae.den);let Me=we.fromArray(ce,S.variable).fill(),me=S.divide(Me);me[1].equalsNumber(0)&&(S=me[0],m.push(Me.toSymbol()))}}return S.equalsNumber(1)||(S=K.Factor.search(S,p)),m.forEach(I=>{p.add(I)}),S.toSymbol()}catch(m){if(m.message==="timeout")throw m;return f}},search(l,p,o){o||=10;let f=l.variable,m=function(me,$e,Xe,ye){let De=we.fit(me,$e,Xe,o,ye,f);if(De&&De.coeffs.length>1){let Be=l.divide(De);if(Be[1].equalsNumber(0))return p.add(De.toSymbol()),[Be[0],De]}return null},S=l.coeffs[0],M=t.Math2.ifactor(S),V=l.lc(),F=t.Math2.ifactor(V),I=l.sub(o),k=t.Math2.ifactor(I),se=K.Factor.mix(k,I<0),ae=Math.ceil(l.coeffs.length/2),ce=V.lessThan(0),Me=S.lessThan(0);for(F[1]=1,M[1]=1;ae--;)for(let me in F)if(Object.hasOwn(F,me)){for(let $e in M)if(Object.hasOwn(M,$e))for(let Xe=0;Xe<se.length;Xe++){let ye=m(me,$e,se[Xe],ae);if(ye)return l=ye[0],t.Utils.isPrime(l.sub(o))||(l=K.Factor.search(l,p)),l;ye||(ce&&Me?ye=m(-me,-$e,se[Xe],ae):ce?ye=m(-me,$e,se[Xe],ae):Me&&(ye=m(me,-$e,se[Xe],ae)))}}return l},mSqfrFactor(l,p){if(l.group!==L){let o=Ne(l).reverse();for(let f=0;f<o.length;f++){let m=!1;do{if(o[f]===l.value){p.add(l),l=new H(1);continue}let S=t.Calculus.diff(l,o[f]),M=K.Factor.coeffFactor(S);if(M.equals(0)||M.equals(1)||M.equals(-1))break;let V=!0;M.isConstant()&&l.isComposite()&&l.each(I=>{I.multiplier%M!==0&&(V=!1)},!0);let F;if(V){let I=l.clone();if(F=K.divWithCheck(l,M.clone()),m=F[1].equals(0),l.equals(F[0])&&F[1].equals(0)){l=I;break}if(F[0].isConstant()){p.add(F[0]);break}}else m=!1;m&&(p.add(F[0]),l=M)}while(m)}}return l},sqdiff(l,p){if(l.isConstant("all"))return l;try{let o=function(S){return t.Utils.block("POSITIVE_MULTIPLIERS",()=>H.unwrapPARENS(Oe.sqrt(Oe.abs(S))),!0)},f=t.Utils.separate(l.clone());if(!f)return l;let m=[];for(let S in f)S!=="constants"&&m.push(f[S]);if(m.sort((S,M)=>M.power-S.power),m.length===2){let S,M;if(S=m.pop(),M=m.pop(),Ee(S.power)&&Ee(M.power)&&S.sign()===M.sign()&&S.group===_&&M.group===_)throw new Error("Unable to factor");if(S.isComposite()&&M.power.equals(2)&&S.sign()!==M.sign()){M=o(M);let V=K.Factor.factorInner(e.add(S,f.constants));V.power.equals(2)&&(V.toLinear(),p.add(e.subtract(V.clone(),M.clone())),p.add(e.add(V,M)),l=new H(1))}else if(S=S.powSimp(),M=M.powSimp(),(S.group===_||S.fname==="")&&S.power.equals(2)&&(M.group===_||M.fname==="")&&M.power.equals(2)&&!f.constants){if(S.multiplier.lessThan(0)){let V=M;M=S,S=V}S.multiplier.greaterThan(0)&&(S=o(S),M=o(M)),p.add(e.subtract(S.clone(),M.clone())),p.add(e.add(S,M)),l=new H(1)}}}catch(o){if(o.message==="timeout")throw o}return l},mfactor(l,p){if(l.group===L)if(l.fname==="sqrt"){let o=new qe,f=K.Factor.common(l.args[0].clone(),o);f=K.Factor.coeffFactor(f,null),l=e.multiply(e.symfunction("sqrt",[f]),e.parse(l.multiplier)),o.each(m=>{l=e.multiply(l,e.parse(t.Utils.format("sqrt({0})",m)))})}else p.add(l),l=new H(1);else{l=K.Factor.mSqfrFactor(l,p);let o=Ne(l),f=l.collectSymbols().map(F=>H.unwrapSQRT(F)),m={},S={},M=o.length,V=f.length;for(let F=0;F<M;F++){let I=o[F];m[I]=new H(0);for(let k=0;k<V;k++){let se=f[k];if(se.contains(I)){let ae=se.value===I?se.power.toDecimal():se.symbols[I].power.toDecimal();(!S[I]||ae<S[I])&&(S[I]=ae),m[I]=e.add(m[I],se.clone())}}}for(let F in m){if(!Object.hasOwn(m,F))continue;let I=e.parse(`${F}^${S[F]}`),k=e.divide(m[F],I),se=e.expand(k);if(se.equals(1)||se.equals(-1))break;let ae=K.div(l.clone(),se);if(ae[0].equals(0))break;if(ae[1].equals(0)){let Me=!1;if(ae[0].each(me=>{g(me.multiplier)||(Me=!0)}),Me){ae[1]=e.expand(e.multiply(ae[1],se));break}}let ce=g(se)&&se.lessThan(0);if(ae[1].equals(0)&&!ce){let Me=K.divWithCheck(l.clone(),ae[0].clone()),me=Me[0];if(me.equals(0)||(l=Me[1],me.equals(-1)&&!l.equals(0)))return l;let $e=ae[0];if(l.equals($e)){let Xe=K.Factor.reduce($e,p);return l.equals(Xe)?Xe:K.Factor.mfactor(Xe,p)}return p.add($e),l.equals(0)?me:me.isConstant("all")?(p.add(me),me):(l=K.Factor.mfactor(me,p),l)}}}return l=K.Factor.sqdiff(l,p),l=K.Factor.zeroes(l,p),l}},allLinear(l){let p=l.length;for(let o=0;o<p;o++)if(!K.isLinear(l[o]))return!1;return!0},isLinear(l){let p=!1,o=l.group;if(o===X||o===z){p=!0;for(let f in l.symbols){if(!Object.hasOwn(l.symbols,f))continue;let m=l.symbols[f],S=m.group;if((S===L||S===R)&&(p=!1),S===Z)p=Ne(m).length===1;else if(S===X||S===z)p=K.isLinear(m);else if(m.group!==u&&m.power.toString()!=="1"){p=!1;break}}}else o===_&&l.power===1&&(p=!0);return p},gcd(...l){let p;if(l.length===1&&l[0]instanceof t.Vector?p=l[0].elements:p=l,p.length===0)return new H(1);if(p.length===1)return p[0];let o=[],f=!1;for(let m=0;m<p.length;m++)if(p[m].group===L&&p[m].fname==="gcd")p=p.concat(p[m].args),p.splice(m,1);else{let S=Ne(p[m]);if(t.Utils.haveIntersection(S,o)){f=!0;break}else o=o.concat(S)}if(f||o.length===0){if(p.every(m=>m.getDenom().equals(1))){let m=p[0];for(let S=1;S<p.length;S++)m=K.gcd_(p[S],m);return m}return e.divide(K.gcd.apply(null,p.map(m=>m.getNum())),K.lcm.apply(null,p.map(m=>m.getDenom())))}return e.symfunction("gcd",p)},gcd_(l,p){if((l.group===L||l.group===w)&&(l=t.Utils.block("PARSE2NUMBER",()=>e.parse(l))),p.group===L&&(p=t.Utils.block("PARSE2NUMBER",()=>e.parse(p))),l.isConstant()&&p.isConstant())return new H(t.Math2.QGCD(new fe(Number(l)),new fe(Number(p))));let o=e.multiply(l.getDenom()||new H(1),p.getDenom()||new H(1)).invert();if(l=e.multiply(l.clone(),o.clone()),p=e.multiply(p.clone(),o.clone()),l=e.expand(l),p=e.expand(p),l.group===Z||p.group===Z){let F=e.divide(l.clone(),p.clone()),I=e.multiply(p.clone(),F.getDenom().invert());if(!I.equals(1))return I}if(l.group===R||p.group===R){let F=new H(t.Math2.GCD(l.multiplier,p.multiplier)),I=K.gcd_(l.value===de?new H(1):e.parse(l.value),p.value===de?new H(1):e.parse(p.value)),k=K.gcd_(e.parse(l.power),e.parse(p.power));return e.multiply(F,e.pow(I,k))}if(l.length<p.length){let F=l;l=p,p=F}let f=Ne(l),m=Ne(p);if(f.length===m.length&&f.length===1&&f[0]===m[0]||f.length===1&&m.length===0||f.length===0&&m.length===1)return l=new we(l),p=new we(p),e.divide(l.gcd(p).toSymbol(),o);let S=[];l.each(F=>{S.push(F.multiplier)}),p.each(F=>{S.push(F.multiplier)});let M;for(;!p.equals(0);){let F=p.clone();if(l=l.clone(),M=K.div(l,F),p=M[1],M[0].equals(0))return e.divide(new H(t.Math2.QGCD(l.multiplier,p.multiplier)),o);l=F}let V=t.Math2.QGCD.apply(void 0,S);return V.equals(1)||l.each(F=>{F.multiplier=F.multiplier.divide(V)}),l.equals(1)&&!l.isConstant()&&!p.isConstant()?e.divide(e.symfunction("gcd",[l,p]),o):e.divide(l,o)},lcm(...l){let p;l.length===1?l[0]instanceof t.Vector?p=l[0].elements:e.error("lcm expects either 1 vector or 2 or more arguments"):p=l;let o=p.reduce((M,V)=>e.multiply(M,V.clone()),new H(1)),f=(function(V,F){F=Number(F);let I=[],k,se,ae,ce=2**V.length;for(se=F;se<ce;se++){k=[],ae=V.length-1;do(se&1<<ae)!==0&&k.push(V[ae]);while(ae--);k.length===F&&I.push(k)}return I})(p,p.length-1).map(M=>M.reduce((V,F)=>e.multiply(V,F.clone()),new H(1))),m;return p.every(M=>t.Utils.isVariableSymbol(M))?m=e.symfunction("gcd",t.Utils.arrayUnique(f)):m=K.gcd.apply(null,f),e.divide(o,m)},divide(l,p){let o,f=t.Algebra.Factor.factorInner(l.clone());o=f.getDenom(),o.isConstant("all")?o=new H(1):l=e.expand(H.unwrapPARENS(e.multiply(f,o.clone())));let m=K.div(l,p),S=e.divide(m[1],p);return e.divide(e.add(m[0],S),o)},divWithCheck(l,p){let o=[new H(0),l.clone()],f=K.div(l,p),m=l.clone(),S=e.multiply(f[0].clone(),p.clone());S=e.add(S,f[1].clone());let M=e.subtract(m,S);return M=e.expand(M),M.equals(0)?f:o},div(l,p){let o=[new H(0),l.clone()];try{if(p.isConstant("all"))return l.each(se=>{se.multiplier=se.multiplier.divide(p.multiplier)}),[l,new H(0)];if(l=e.expand(l),p=e.expand(p),l.group===_&&p.group===z){let se=l.value,ae=t.Utils.decompose_fn(p.clone(),se,!0);if(l.isLinear()&&ae.x&&ae.x.isLinear()&&p.isLinear()){let ce=H.create(l.multiplier);return[e.divide(ce.clone(),ae.a.clone()),e.divide(e.multiply(ce,ae.b),ae.a).negate()]}}if(l.group===_&&p.group===_){let se=e.divide(l.clone(),p.clone());return se.isConstant()?[se,new H(0)]:[new H(0),l.clone()]}let f=l.hasFunc(),m=p.hasFunc(),S=!1,M;if(f||m){S=!0;let se={};l=e.parse(t.Utils.subFunctions(l,se)),p=e.parse(t.Utils.subFunctions(p,se)),M=t.Utils.getFunctionsSubs(se)}let V=t.Utils.arrayUnique(Ne(l).concat(Ne(p))),F,I,k;if((l.isImaginary()||p.isImaginary())&&V.push(t.Settings.IMAGINARY),V.length===1){let se=new we(l).divide(new we(p));F=se[0].toSymbol(),I=se[1].toSymbol()}else{V.push(de);let se=function(Le){let Ve=new H(0);for(let Qe=0;Qe<Le.length;Qe++){let Ae=Le[Qe].toSymbol();Ve=e.add(Ve,Ae)}return Ve},ae=function(Le,Ve){let Qe=Math.max.apply(null,Le.terms),Ae=0,$;if(!Ve){for(let W=0;W<Le.terms.length;W++)if(Le.terms[W].equals(Qe)&&($=W,Ae++),Ae>1)return}if(Ve){for(let W=0;W<Le.terms.length;W++)if(Le.terms[W].equals(Qe)){$=W;break}}return[Qe,$,Le]},ce=t.Utils.toMapObj(V),Me=function(Le,Ve){return Ve.sum.subtract(Le.sum)},me=l.tBase(ce).sort(Me),$e=p.tBase(ce).sort(Me),Xe=function(Le,Ve){Ve||=0;let Qe=Le[Ve],Ae=Le.length;if(!Qe)return;let $=ae(Qe);for(let q=Ve+1;q<Ae;q++){let ee=Le[q],B=Qe.sum.equals(ee.sum);if(!B&&$)break;if(B){let T,ge,a,c,A=Qe.terms.length;for(let Q=0;Q<A;Q++){let J=Qe.terms[Q],G=ee.terms[Q];(typeof T>"u"||J.greaterThan(T))&&(T=J,a=Q),(typeof ge>"u"||G.greaterThan(ge))&&(ge=G,c=Q)}let x=T.subtract(ee.terms[a]),b=ge.subtract(Qe.terms[c]);if(b>x){$=[ge,c,ee];break}if(x>b){$=[T,a,Qe];break}}else if($=ae(ee),$)break;$=ae(ee)}if(!$)return ae(Le[0],!0);let W,Y;for(let q=0;q<$e.length;q++){let ee=$e[q].terms;if(Y=$[1],Y===ee.length-1)return;if(W=ee[Y],!W.equals(0))break}return W.equals(0)?Xe(Le,++Ve):$},ye=function(Le,Ve){if(!Le||!Ve)return!1;for(let Qe=0;Qe<Le.terms.length;Qe++)if(Le.terms[Qe].lessThan(Ve.terms[Qe]))return!1;return!0},De=ye(me[0],$e[0])&&me[0].count>$e[0].count?$e:me,Be=Xe(De),We=[];if(Be){let Le=Be[1],Ve=function(B,T){return B[0].sum.equals(T[0].sum)?B.length>=T.length:!0},Qe=function(B,T,ge){let a=[];for(let c=0;c<B.length;c++){let A=B[c];for(let x=0;x<A.terms.length;x++){let b=a[x],Q=A.terms[x];c===0?a[x]=Q:b&&!b.equals(Q)&&(a[x]=void 0)}}for(let c=0;c<a.length;c++){let A=a[c];if(A&&!A.equals(0))return c}return ge},Ae=function(B,T){let ge=B.len(),a=T.len(),c=T.terms[Le],A=B.terms[Le];return a>ge&&c.greaterThan(A)?a-ge:c.subtract(A)};Le=Qe(me,$e,Le),me.sort(Ae),$e.sort(Ae);let $=$e[0],W=me[0];if(k=new Se(new fe(1),[],W.map),$.sum.greaterThan(W.sum)&&W.len()>1)for(let B=0;B<W.terms.length;B++){let T=$.terms[B].subtract(W.terms[B]);if(T.equals(0))k.terms[B]=new fe(0);else{let ge=T.add(new fe(1));k.terms[B]=T;for(let a=0;a<me.length;a++)me[a].terms[B]=me[a].terms[B].add(ge)}}let Y=ye(me[0],$e[0]),q=0,ee=200;for(;Y&&Ve(me,$e);){if(q++>ee)throw new t.exceptions.InfiniteLoopError("Unable to compute!");let B=me[0].divide($e[0]);We.push(B),me.shift();for(let T=1;T<$e.length;T++){let ge=$e[T].multiply(B).generateImage(),a=me.length;a===0&&(ge.coeff=ge.coeff.neg(),me.push(ge),me.sort(Ae));for(let c=0;c<a;c++){let A=me[c];if(A.getImg()===ge.getImg()){A.coeff=A.coeff.subtract(ge.coeff),A.coeff.equals(0)&&(t.Utils.remove(me,c),c--);break}c===a-1&&(ge.coeff=ge.coeff.neg(),me.push(ge),me.sort(Ae))}}if(Y=ye(me[0],$e[0]),!Y&&me.length>=$e.length){for(let T=1;T<me.length;T++)if(Y=ye(me[T],$e[0]),Y){me.unshift(t.Utils.remove(me,T));break}}}}F=se(We),I=se(me),typeof k<"u"&&(k=k.toSymbol(),F=e.divide(F,k.clone()),I=e.divide(I,k))}return S&&(F=e.parse(F.text(),M),I=e.parse(I.text(),M)),[F,I]}catch(f){if(f.message==="timeout")throw f;return o}},line(l,p,o){t.Utils.isArray(l)&&(l=t.Utils.convertToVector(l)),t.Utils.isArray(p)&&(p=t.Utils.convertToVector(p)),o=e.parse(o||"x"),(!t.Utils.isVector(l)||!t.Utils.isVector(p))&&e.error(`Line expects a vector! Received "${l}" & "${p}"`);let f=e.subtract(p.e(1).clone(),l.e(1).clone()),m=e.subtract(p.e(2).clone(),l.e(2).clone()),S=e.divide(m,f),M=e.multiply(o,S.clone()),V=e.multiply(l.e(1).clone(),S);return e.add(e.subtract(M,V),l.e(2).clone())},PartFrac:{createTemplate(l,p,o,f){l=K.Factor.factorInner(l),l.each((se,ae)=>{if(se.group===L&&se.fname===""&&se.args[0].group===_){let ce=se.args[0];l.symbols?(delete l.symbols[ae],l.symbols[ce.value]=ce):l=se.args[0]}});let m,S,M,V=p.collectFactors(),F=[],I=[],k=new H(1);for(let se=0;se<V.length;se++){let ae=H.unwrapPARENS(V[se]);if(ae.power.greaterThan(1)){S=Number(ae.power),m=ae.clone().toLinear(),M=Number(K.degree(m,f));for(let ce=0;ce<S;ce++){let Me=e.pow(m.clone(),new H(ce+1));o.push(Me.clone());let me=e.divide(l.clone(),Me.clone());I.push(M),F.push(me)}}else{M=Number(K.degree(ae,f)),o.push(ae);let ce=e.divide(l.clone(),ae.clone());ce=e.expand(H.unwrapPARENS(ce)),I.push(M),F.push(ce)}}return o=o.map(se=>e.multiply(se,k.clone())),[o,F,I]},partfrac(l,p,o){let f=Ne(l);p||=e.parse(f[0]);try{let m,S,M,V=e.expand(l.getNum()),F=e.expand(l.getDenom().toUnitMultiplier());if(V.multiplier=l.multiplier,m=V.groupTerms(p),Number(K.degree(V,p))>=Number(K.degree(F,p))?(S=K.div(V.clone(),e.expand(F.clone())),M=S[0],V=S[1],m=V.groupTerms(p)):M=new H(0),Number(K.degree(F,p))===1){let Ae=e.divide(V,F);return o?[M,Ae]:e.add(M,Ae)}let I=K.Factor.factorInner(F),k=K.PartFrac.createTemplate(F.clone(),I,[],p),se=k[0],ae=k[1],ce=k[2],Me=[m.length],me=[],$e=[],Xe=[],ye,De;ae.forEach((Ae,$)=>{ye=se[$],De=ce[$];for(let W=0;W<De;W++){$e.push(ye.clone());let Y=H.create(p,W),q=e.expand(e.multiply(Ae,Y.clone())).groupTerms(p),ee=q.length;Me.push(ee),me.push(q),Xe.push(Y.clone())}});let Be=t.Utils.arrayMax(Me),We=new t.Matrix(t.Utils.fillHoles(m,Be)).transpose(),Le=new t.Matrix;for(let Ae=0;Ae<me.length;Ae++)Le.elements.push(t.Utils.fillHoles(me[Ae],Be));let Ve=e.multiply(Le.transpose().invert(),We),Qe=o?[M]:M;return Ve.each((Ae,$)=>{let W=e.multiply(Xe[$],e.divide(Ae,$e[$]));o?Qe.push(W):Qe=e.add(Qe,W)}),Qe}catch(m){if(m.message==="timeout")throw m;try{if(l.isComposite()){let S={};l.each(V=>{let F=V.getDenom(),I=V.getNum(),k=S[F];S[F]=k?e.add(k,I):I});let M=new H(0);for(let V in S)Object.hasOwn(S,V)&&(M=e.add(M,e.divide(S[V],e.parse(V))));l=M}}catch(S){if(S.message==="timeout")throw S}}return l}},degree(l,p,o){if(o||={nd:[],sd:[],depth:0},!p){let S=Ne(l);if(S.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(S.length===0)return new H(0);p=e.parse(S[0])}let f=l.group;l.isComposite()?(l=l.clone(),l.distributeExponent(),l.each(S=>{o.depth++,K.degree(S,p,o),o.depth--})):l.group===Z?l.each(S=>{o.depth++,K.degree(S,p,o),o.depth++}):f===R&&l.value===p.value?o.sd.push(l.power.clone()):f===_&&l.value===p.value?o.nd.push(e.parse(l.power)):o.nd.push(new H(0));let m=o.nd.length>0?t.Utils.arrayMax(o.nd):void 0;return o.depth===0&&o.sd.length>0?(m!==void 0&&o.sd.unshift(m),e.symfunction("max",o.sd)):(t.Utils.isSymbol(m)||(m=e.parse(m)),m)},sqComplete(l,p,o){t.Utils.isSymbol(p)||(p=e.parse(p));let f=function(me){throw me||="Stopping",new t.exceptions.ValueLimitExceededError(me)};l.isPoly(!0)||f("Must be a polynomial!");let m=t.Utils.inBrackets;l=l.clone();let S=t.Algebra.degree(l,p);S.equals(2)||f(`Cannot complete square for degree ${S}`);let M=t.Algebra.coeffs(l,p),V=M[2],F=M[1].sign(),I=e.divide(M[1],new H(2)),k=e.pow(I.clone(),new H(2)),se=Oe.sqrt(V),ae=e.divide(Oe.sqrt(k),se.clone()),ce=e.subtract(M[0],e.pow(ae.clone(),new H(2)));if(o)return[V,I,ce];let Me=e.parse(m(`${se.clone()}*${p}${F<0?"-":"+"}${ae}`));return{a:Me,c:ce,f:e.add(e.pow(Me.clone(),new H(2)),ce.clone())}},Simplify:{strip(l){let p=e.parse(l.multiplier);l.toUnitMultiplier();let o=e.parse(l.power);return l.toLinear(),[p,o,l]},unstrip(l,p){let o=l[0],f=l[1];return e.multiply(o,e.pow(p,f))},complexSimp(l,p){let o=l.realpart(),f=l.imagpart(),m=p.realpart(),S=p.imagpart(),M=e.multiply(o.clone(),m.clone()),V=e.multiply(f.clone(),S.clone()),F=e.multiply(m.clone(),f),I=e.multiply(o,S.clone()),k=e.add(e.pow(m,new H(2)),e.pow(S,new H(2)));return e.divide(e.add(e.add(M,V),e.multiply(e.subtract(F,I),H.imaginary())),k)},trigSimp(l){let p=!0,o=0;for(;p&&l.containsFunction(["cos","sin","tan"]);){o++,p=!1,l=l.clone();let f=K.Simplify.strip(l);l=f.pop();let m=l.clone();if(l.group===z){let S=new H(0);l.each(M=>{let V=K.Simplify.trigSimp(M.fnTransform());S=e.add(S,V)},!0),m=e.pow(e.multiply(new H(l.multiplier),S),new H(l.power)),p=m.text()!==l.text()}else if(l.group===Z){let S=l.getNum(),M=l.getDenom();if(S.fname==="sin"&&M.fname==="cos"&&S.args[0].equals(M.args[0])&&S.power.equals(M.power))m=e.parse(t.Utils.format("(({1})/({0}))*tan({2})^({3})",M.multiplier,S.multiplier,S.args[0],S.power)),p=!0;else if(S.fname==="tan"&&M.fname==="sin"&&S.args[0].equals(M.args[0])&&S.power.equals(M.power))m=e.parse(t.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",M.multiplier,S.multiplier,S.args[0],S.power)),p=!0;else{let V=new H(1),F={workDone:p};m.each(I=>{if(I.fname==="tan")I=e.parse(t.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",I.multiplier,K.Simplify._simplify(I.args[0]),I.power)),F.workDone=!0;else if(I.containsFunction(["cos","sin","tan"])){let k=K.Simplify.trigSimp(I);I.equals(k)||(I=k,F.workDone=!0)}V=e.multiply(V,I)}),p=F.workDone,m=V}}else if((l.fname==="cos"||l.fname==="sin")&&l.args[0].group===z){let S=0,M=new H(0),V=e.parse("pi/2");if(l.args[0].each(F=>{let I=e.divide(F.clone(),V.clone());I=K.Simplify._simplify(I),I=t.Utils.evaluate(I),g(I)?S+=I.multiplier.num.toJSNumber():M=e.add(M,F)}),S){S+=l.fname==="cos"?1:0,S%=4,S+=S<0?4:0;let F=["sin({0})","cos({0})","-sin({0})","-cos({0})"],I=t.Utils.format(F[S],M);m=e.parse(I),p=!0}else if(Object.keys(l.args[0].symbols).length>1){let F=l.args[0].clone(),I=Object.values(F.symbols),k=I[0],ae=I.slice(1).map(Me=>`(${Me.text()})`).join("+"),ce;l.fname==="sin"?ce=t.Utils.format("sin({0})cos({1})+sin({1})cos({0})",k,ae):ce=t.Utils.format("cos({0})cos({1})-sin({1})sin({0})",k,ae),m=e.parse(ce),p=!0}}else if((l.fname==="cos"||l.fname==="sin")&&l.args[0].multiplier.sign()===-1){let S=l.args[0].clone().negate(),M=t.Utils.format(`${l.fname}({0})`,S);l.fname==="sin"&&(M=`-${M}`),m=e.parse(M),p=!0}if(l.fname==="sin"&&l.args[0].multiplier.equals(2)&&!l.args[0].equals(2)){let S=l.args[0].clone().toUnitMultiplier(),M=t.Utils.format("2sin({0})cos({0})",S);m=e.parse(M),p=!0}if(m=K.Simplify.unstrip(f,m).distributeMultiplier(),l=m,o>10)break}return l},logArgSimp(l,p){if(p.value==="1"||p.value===1)return new H(0);let o=new H(0),f=p.multiplier.clone();if(p.toUnitMultiplier(),!f.equals(1)){let m=t.Utils.format("({0}({1}))",l,f);o=e.add(o,e.parse(m))}if(p.group===Z)p.each(m=>{m=m.clone();let S=m.power.clone();K.Simplify.strip(m);let M=t.Utils.format("(({1})*{0}({2}))",l,S,m);o=e.add(o,e.parse(M))});else{let m=p.clone(),S=m.power.clone();K.Simplify.strip(m);let M=t.Utils.format("(({1})*{0}({2}))",l,S,m);o=e.add(o,e.parse(M))}return o},logSimp(l){if(l.group===L&&(l.fname==="log"||l.fname==="log10")){let p=l.clone(),o=K.Simplify.strip(l);l=o.pop();let f=l.args[0].clone(),m=f.getNum().clone(),S=f.getDenom().clone(),M=l.fname,V=K.Simplify.logArgSimp(M,m);if(!S.equals(1)){let F=K.Simplify.logArgSimp(M,S);V=e.subtract(V,F)}V=K.Simplify.unstrip(o,V).distributeMultiplier(),l=V}else if(l.containsFunction(["log","log10"]))for(let p in l.symbols){if(!Object.hasOwn(l.symbols,p))continue;let o=l.symbols[p];l.symbols[p]=K.Simplify.logSimp(o)}return l},_sqrtCompression(l,p,o){let f=K.Simplify.strip(l),m=Me=>Me.fname==="abs",S=Me=>Me.args[0],M=Me=>m(Me)?S(Me):null,V=Me=>Me.type===_&&Me.value.startsWith("baseunit_"),F=(Me,me)=>{let $e=S(me);return $e.equals(M(Me))?[me,null]:$e.equals(Me)&&V(Me)?[me,null]:[null,me]},I,k=!1,se=(Me,me)=>{for(let $e=0;$e<Me.length;$e++){let Xe=Me[$e];if(Xe.isSQRT()){for(let ye=0;ye<me.length;ye++){let De=me[ye];if([De,Xe]=F(De,Xe),De!==null){me[ye]=De,I=!0,k=!0;break}}Me[$e]=Xe,Me=Me.filter(ye=>ye),me=me.filter(ye=>ye)}}return[Me,me]},ae=p.collectFactors(),ce=o.collectFactors();do I=!1,[ae,ce]=se(ae,ce),[ce,ae]=se(ce,ae);while(I);return k&&(l=ae.reduce((Me,me)=>Me=e.multiply(Me,me),new H(1)),l=ce.reduce((Me,me)=>Me=e.divide(Me,me),l)),l=K.Simplify.unstrip(f,l),l},fracSimp(l){let p=l.getDenom(),o=l.getNum();if(o.isImaginary()&&p.isImaginary()&&(l=K.Simplify.complexSimp(o,p)),l.isComposite()){l.power>1&&(l=e.expand(l));let f=l.collectSymbols(),m,S,M,V,F,I,k,se,ae,ce,Me;for(S=f.pop();f.length;)M=f.pop(),V=e.parse(S.getDenom()),F=e.parse(M.getDenom()),I=S.getNum(),k=M.getNum(),Me=e.multiply(V.clone(),F.clone()),ae=e.multiply(I,F),ce=e.multiply(k,V),se=e.add(ae,ce),S=e.divide(se,Me);return p=e.expand(S.getDenom()),o=e.expand(S.getNum()),o.isImaginary()&&p.isImaginary()?m=K.Simplify.complexSimp(o,p):m=e.divide(o,p),m.equals(l)?l:K.Simplify._simplify(m)}return l=K.Simplify._sqrtCompression(l,o,p),l=K.Simplify.simpleFracSimp(l),l},simpleFracSimp(l){let p=l.getDenom(),o=l.getNum(),f;return p=e.expand(p),o=e.expand(o),o.isImaginary()&&p.isImaginary()?f=K.Simplify.complexSimp(o,p):f=e.divide(o,p),f.equals(l)?l:f},ratSimp(l){if(l.group===Z){let p=l.getDenom(),o=l.getNum().distributeMultiplier(),f=K.Simplify.fracSimp(p),m=K.Simplify.fracSimp(o);l=e.divide(m,f)}return l},sqrtSimp(l,p){let o,f=!1,m=l.clone();try{if(l.isSQRT()){let S=l.multiplier.clone(),M=l.args[0].clone(),V=K.Factor.factorInner(M),F=e.parse(V.multiplier),I=F.sign();o=new H(1);let k;if(V.group===Z){let se=new H(1);V.each(ce=>{if(ce=e.parse(ce),ce.group===u){let Me=e.sqrt(ce.clone());g(Me)?o=e.multiply(o,Me):se=e.multiply(se,ce)}else se=e.multiply(se,ce)});let ae=e.multiply(se,e.parse(I));k=e.sqrt(ae.clone()),k.isImaginary()&&(k=e.sqrt(e.expand(ae.clone())))}else k=V.clone().toUnitMultiplier(),k=e.multiply(k,new H(I)),k=e.sqrt(k);o=e.multiply(o,k),o=e.pow(o,e.parse(l.power)),o=e.multiply(o,e.sqrt(F.abs())),o=e.multiply(o,e.parse(S)),f=!0}else l.isComposite()&&l.isLinear()?(o=new H(0),l.each(S=>{o=e.add(o,K.Simplify.sqrtSimp(S))},!0),o=e.pow(o,e.parse(l.power)),o=e.multiply(o,e.parse(l.multiplier)),f=!0):l.group===Z&&(o=new H(1),l.each(S=>{let M=K.Simplify.sqrtSimp(S);o=e.multiply(o,M)}),o=e.pow(o,e.parse(l.power)),o=e.multiply(o,e.parse(l.multiplier)),f=!0);return f||o&&!g(o)&&(o=null),o||=e.parse(l),o}catch(S){if(S.message==="timeout")throw S;return m}},patternSub(l){let p={},o=function(m){let S=!1;return m.each(M=>{M.group===z?S=!0:M.symbols&&(S=o(M))}),S},f=function(m){m.each(S=>{if(!(!S.symbols&&S.group!==L)){if(o(S))f(S);else if(!p[S.value]){let M=t.Utils.getU(l);p[S.value]=M,l=l.sub(S.value,M)}}},!0)};return f(l),[l,p]},simplify(l){if(l.simplify)return l.simplify();let p=K.Simplify._simplify(l);return p=p.pushMinus(),p=e.parse(p),p},_simplify(l){let p=K.Simplify.strip(l.clone());if(l=p.pop(),l=K.Simplify.fracSimp(l),l.isConstant()||l.group===t.groups.S)return p.push(l),K.Simplify.unstrip(p,l);let o=l.clone();if(o=K.Simplify.sqrtSimp(o,p),o=K.Simplify.trigSimp(o),o=K.Simplify.logSimp(o),o=K.Simplify.ratSimp(o),o=K.Factor.factorInner(o),o.group===t.groups.CP&&o.isLinear()){let f=o.multiplier.clone();o.toUnitMultiplier();let m=new H(0);return o.each(S=>{let M=K.Simplify._simplify(S);m=e.add(m,M)}),o=m,o=e.multiply(o,new H(f)),o.multiplier.equals(-1)&&o.distributeMultiplier(),o=K.Simplify.unstrip(p,o),o}return o=K.Simplify.unstrip(p,o),o}},Classes:{Polynomial:we,Factors:qe,MVTerm:Se}};t.Expression.prototype.simplify=function(){t.Utils.armTimeout();try{let p;if(typeof this.symbol.LHS>"u")p=new t.Expression(K.Simplify.simplify(this.symbol));else{let o=this.symbol.clone();o.LHS=K.Simplify.simplify(o.LHS),o.RHS=K.Simplify.simplify(o.RHS),p=o}return p}catch(p){if(p.message==="timeout")throw p;return this}finally{t.Utils.disarmTimeout()}},t.Collection.prototype.simplify=function(){return this.elements=this.elements.map(p=>K.Simplify.simplify(p)),this},t.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(p=>p.map(o=>K.Simplify.simplify(o))),this},d0.useAlgebraDiv=function(){let p=K.divideFn=e.divide,o=0;e.divide=function f(m,S){o++;let M;return o===1?M=t.Algebra.divide(m,S):M=f(m,S),o=0,M}},d0.useParserDiv=function(){K.divideFn&&(e.divide=K.divideFn),delete K.divideFn},d0.register([{name:"factor",visible:!0,numargs:1,build(){return K.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return K.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return K.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return K.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return K.roots}},{name:"divide",visible:!0,numargs:2,build(){return K.divide}},{name:"div",visible:!0,numargs:2,build(){return K.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return K.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return K.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...p){let o=K.coeffs(...p);return new t.Vector(o)}}}]),d0.coeffs=function(...p){let o=t.PARSER;for(let m=0;m<p.length;m++)typeof p[m]=="string"?p[m]=o.parse(p[m]):p[m]&&p[m].symbol?p[m]=p[m].symbol.clone():t.Utils.isSymbol(p[m])&&(p[m]=p[m].clone());let f=K.coeffs(...p);return new t.Expression(new t.Vector(f))},d0.register([{name:"line",visible:!0,numargs:[2,3],build(){return K.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(p,o){try{return o||=Ne(p)[0],K.sqComplete(p.clone(),o).f}catch(f){if(f.message==="timeout")throw f;return p}}}}]),d0.updateAPI()})()});var u1=c0((Qi,l1)=>{"use strict";var D0;typeof l1<"u"&&(D0=O0(),x0(),$0());(function(){let t=D0.getCore(),e=t.PARSER,u=t.Algebra,w=t.Calculus,_=w.integration.decompose_arg,{evaluate:R}=t.Utils,{remove:L}=t.Utils,{format:X}=t.Utils,{build:z}=t.Utils,{knownVariable:Z}=t.Utils,{NerdamerSymbol:j}=t,{isSymbol:Ee}=t.Utils,{variables:Ne}=t.Utils,{S:Re}=t.groups,{PL:ie}=t.groups,{CB:fe}=t.groups,{CP:g}=t.groups,{FN:H}=t.groups,{Settings:de}=t,{range:Oe}=t.Utils,{isArray:ve}=t.Utils;t.Settings.SOLVE_RADIUS=1e3,t.Settings.ROOTS_PER_SIDE=10,t.Settings.make_pi_conversions=!1,t.Settings.STEP_SIZE=.1,t.Settings.EPSILON=2e-13,t.Settings.MAX_NEWTON_ITERATIONS=200,t.Settings.NEWTON_EPSILON=2e-15,t.Settings.MAX_NON_LINEAR_TRIES=12,t.Settings.NON_LINEAR_JUMP_AT=50,t.Settings.NON_LINEAR_JUMP_SIZE=100,t.Settings.NON_LINEAR_START=.01,t.Settings.NEWTON_SLICES=200,t.Settings.SOLUTION_PROXIMITY=1e-14,t.Settings.FILTER_SOLUTIONS=!0,t.Settings.MAX_SOLVE_DEPTH=10,t.Settings.ZERO_EPSILON=1e-9,t.Settings.MAX_BISECTION_ITER=2e3,t.Settings.BI_SECTION_EPSILON=1e-12,t.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},t.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let f in this.symbols){if(!Object.hasOwn(this.symbols,f))continue;let m=this.symbols[f];if(m.group===ie&&m.hasNegativeTerms()||this.symbols[f].power.lessThan(0))return!0}return!1};function we(o,f){if(f.isConstant()&&o.isConstant()&&!o.equals(f)||o.equals(t.Settings.IMAGINARY)&&f.isConstant(!0)||f.equals(t.Settings.IMAGINARY)&&o.isConstant(!0))throw new t.exceptions.NerdamerValueError(`${o.toString()} does not equal ${f.toString()}`);this.LHS=o,this.RHS=f}we.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(o){return`${this.LHS.text(o)}=${this.RHS.text(o)}`},toLHS(o){o=!!o;let f=this.removeDenom(),m=f.LHS,S=f.RHS;m.isConstant(!0)&&!S.isConstant(!0)&&([m,S]=[S,m]);let M=e.subtract(m,S),V=o?e.expand(M):M;return V=new we(V,new j(0)).removeDenom().LHS,V},removeDenom(){let o=this.LHS.clone(),f=this.RHS.clone(),m=e.multiply(o.getDenom(),f.getDenom());if(o=e.expand(e.multiply(o,m.clone())),f=e.expand(e.multiply(f,m)),f.group===g&&f.group!==g){let S=o;o=f,f=S}if(o.group===fe){let S=new j(o.multiplier),M=f.clone();o.each(V=>{V.power.lessThan(0)?M=e.divide(M,V):S=e.multiply(S,V)}),o=S,f=M}else if(o.group===g)for(let S in o.symbols){if(!Object.hasOwn(o.symbols,S))continue;let M=o.symbols[S];if(M.group===fe)for(let V in M.symbols){if(!Object.hasOwn(M.symbols,V))continue;let F=M.symbols[V];if(F.power.lessThan(0))return new we(e.expand(e.multiply(F.clone().toLinear(),o)),e.expand(e.multiply(F.clone().toLinear(),f)))}}return new we(o,f)},clone(){return new we(this.LHS.clone(),this.RHS.clone())},sub(o,f){let m=this.clone();return m.LHS=m.LHS.sub(o.clone(),f.clone()),m.RHS=m.RHS.sub(o.clone(),f.clone()),m},isZero(){return t.Utils.evaluate(this.toLHS()).equals(0)},latex(o){return[this.LHS.latex(o),this.RHS.latex(o)].join("=")}},e.equals=function(f,m){return new we(f,m)},(function(){let f=e.functions.simplify[0];e.functions.simplify[0]=function(S){return S instanceof we?(S.LHS=f(S.LHS),S.RHS=f(S.RHS),S):f(S)}})(),t.Expression.prototype.equals=function(f){return f instanceof t.Expression&&(f=f.symbol),new we(this.symbol,f)},t.Expression.prototype.solveFor=function(f){t.Utils.armTimeout();try{let{symbol:m}=this;if(this.symbol instanceof we){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(f))return[new t.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(f))return[new t.Expression(this.symbol.RHS)]}return p(m,f).map(V=>(V=t.Algebra.Simplify.simplify(e.parse(V)),new t.Expression(V)))}finally{t.Utils.disarmTimeout()}},t.Expression.prototype.expand=function(){if(this.symbol instanceof we){let f=this.symbol.clone();return f.RHS=e.expand(f.RHS),f.LHS=e.expand(f.LHS),new t.Expression(f)}return new t.Expression(e.expand(this.symbol))},t.Expression.prototype.variables=function(){return this.symbol instanceof we?t.Utils.arrayUnique(t.Utils.variables(this.symbol.LHS).concat(t.Utils.variables(this.symbol.RHS))):t.Utils.variables(this.symbol)};let qe=function(f,m){return e.equals(f,m)};t.Equation=we;let Se=t.Utils.checkAll=function(f,m){for(let S=0;S<f.length;S++)if(m(f[S]))return!1;return!0},K=t.Solve={version:"2.0.3",solutions:[],solve(o,f){let m=de.PARSE2NUMBER;de.PARSE2NUMBER=!1;let S=p(o,String(f));return de.PARSE2NUMBER=m,new t.Vector(S)},toLHS(o,f){if(Ee(o))return o;if(!(o instanceof we)){let m=o.split("=");m[1]||="0",o=new we(e.parse(m[0]),e.parse(m[1]))}return o.toLHS(f)},solveCircle(o,f){let m=f.map(I=>e.parse(I)),S=[],M=[];for(let I=0;I<o.length;I++){let k=[];for(let se=0;se<m.length;se++)k.push(Number(t.Algebra.degree(o[I],m[se])));k.push(t.Utils.arraySum(k,!0)),S.push(k)}let V=o[0],F=o[1];if(S[0][2]>S[1][2]&&([F,V]=[V,F],[S[1],S[0]]=[S[0],S[1]]),S[0][0]===1&&S[0][2]===2&&S[1][0]===2&&S[1][2]===4){let I=f[0],k=f[1],se=p(e.parse(F,Z(I,p(e.parse(V),I)[0])),k).map(ce=>ce.toString()),ae=[p(e.parse(V,Z(k,se[0])))[0].toString()];se[1]&&ae.push(p(e.parse(V,Z(k,se[1])))[0].toString()),de.SOLUTIONS_AS_OBJECT?(M={},M[I]=ae,M[k]=se):(se.unshift(k),ae.unshift(I),M=[ae,se])}return M},solveNonLinearSystem(o,f,m){if(f<0)return[];m=typeof m>"u"?t.Settings.NON_LINEAR_START:m;let S=t.Settings.MAX_NON_LINEAR_TRIES,M=Math.floor(S/2);f=typeof f>"u"?S:f;let V=t.Settings.NON_LINEAR_JUMP_AT,F=t.Settings.NON_LINEAR_JUMP_SIZE,I=!0,k=function(Ae,$){return Ae.map((W,Y)=>Number($.get(Y,0)))},se=t.Utils.arrayGetVariables(o),ae=t.Matrix.jacobian(o,se,Ae=>z(Ae,se),!0),ce=t.Settings.MAX_NEWTON_ITERATIONS,Me,me,$e,Xe,ye,De,Be,We,Le=o.map(Ae=>z(Ae,se)),Ve=ae.map(Ae=>z(Ae,se),!0);Xe=t.Matrix.cMatrix(0,se);let Qe=t.Matrix.cMatrix(m,se);$e=0;do{if($e>ce){I=!1;break}Me=k(se,Qe),Be=Qe.clone();let Ae=Me,$=Qe;Le.forEach((Y,q)=>{$.set(q,0,Y(...Ae))});let W=new t.Matrix;if(Ve.each((Y,q,ee)=>{let B=Y(...Ae);W.set(q,ee,B)}),W=W.invert(),me=e.multiply(W,Qe).negate(),We=me.subtract(Xe,Y=>e.parse(Number(Y))),Xe=Be.add(me,Y=>e.parse(Number(Y))),Qe=Xe,$e>=V&&ye>1){f===M&&(m=0);let Y=f>M?1:-1,q=f%Math.floor(M)+1;return m+=Y*q*F,K.solveNonLinearSystem(o,--f,m)}if(De=ye,$e++,ye=We.max(),Number(ye)===Number(De))break}while(Number(ye)>=Number.EPSILON);return I?K.systemSolutions(Qe,se,!0,Ae=>t.Utils.round(Number(Ae),14)):[]},systemSolutions(o,f,m,S){let M=t.Settings.SOLUTIONS_AS_OBJECT?{}:[];return o.each((V,F)=>{let I=(m?e.expand(V):V).valueOf();S&&(I=S.call(V,I));let k=f[F];t.Settings.SOLUTIONS_AS_OBJECT?M[k]=I:M.push([k,I])}),M},solveSystemBySubstitution(o){let f=Ne(o[0]),m=Ne(o[1]);return o.length===2&&f.length===2&&t.Utils.arrayEqual(f,m)?K.solveCircle(o,f):[]},solveSystem(o,f){for(let k=0;k<o.length;k++)o[k]=K.toLHS(o[k]);let m=o.length,S=new t.Matrix,M=new t.Matrix,V=!1,F;if(typeof f>"u"){if(!u.allLinear(o))try{return K.solveNonLinearSystem(o)}catch(k){if(k.message==="timeout")throw k;if(k instanceof t.exceptions.DivisionByZero)return K.solveSystemBySubstitution(o)}if(F=t.Utils.arrayGetVariables(o),F.length===1){let k=0,se,ae;do ae=o[k].clone(),k>0&&(ae=ae.sub(F[0],se[0])),se=p(ae,F[0]);while(++k<o.length);let ce;return de.SOLUTIONS_AS_OBJECT?(ce={},ce[F[0]]=se):se.length===0?ce=se:ce=[F[0],se],ce}if(F.length<o.length){let k=[],se=o.length;for(let me=0;me<se-1;me++)k.push(e.parse(o[me]));let ae={},ce=K.solveSystem(k,F);Array.isArray(ce)?ce.forEach(me=>{ae[me[0]]=me[1]}):ae=ce;let Me=!0;for(let me=se-1;me<se;me++)e.parse(o[me],ae).equals(0)||(Me=!1);if(Me)return ce}for(let k=0;k<F.length;k++)D0.setVar(F[k],"delete");for(let k=0;k<m;k++){let se=o[k];for(let ce=0;ce<F.length;ce++){let Me=F[ce],me=[];se.each(Xe=>{Xe.contains(Me)&&(me=me.concat(Xe.coeffs()))});let $e=t.Utils.arraySum(me);S.set(k,ce,$e)}let ae=se.clone();F.forEach(ce=>{ae=ae.stripVar(ce,!0)}),M.set(k,0,ae.negate())}}else{F=f,V=!0;for(let k=0;k<m;k++){M.set(k,0,new j(0));let se=e.expand(o[k]).collectSummandSymbols();for(let ae=0;ae<f.length;ae++){S.set(k,ae,new j(0));let ce=f[ae];for(let Me=0;Me<se.length;Me++){let me=se[Me],$e=!1;for(let Xe=0;Xe<f.length;Xe++)me.contains(f[Xe])&&($e&&t.err(`Multiple variables found for term ${me}`),$e=!0);if(me.contains(ce)){let Xe=_(L(se,Me),ce);Me--,S.set(k,ae,e.add(S.get(k,ae),Xe[0]))}}}for(let ae=0;ae<se.length;ae++)M.set(k,0,e.add(M.get(k,0),se[ae]))}}if(F.length!==o.length||S.determinant().equals(0))throw new t.exceptions.SolveError("System does not have a distinct solution");S=S.invert();let I=S.multiply(M);return t.Utils.isArray(f)&&I.each(k=>k.negate()),K.systemSolutions(I,F,V)},quad(o,f,m){let S=e.subtract(e.pow(f.clone(),j(2)),e.multiply(e.multiply(m.clone(),o.clone()),j(4)));S=e.expand(S);let M=e.pow(S,j(.5)),V=e.parse(e.multiply(new j(2),m.clone()));return[e.parse(X("(-({0})+({1}))/({2})",f,M,V)),e.parse(X("(-({0})-({1}))/({2})",f,M,V))]},cubic(o,f,m,S){let M=S.text(),V=m.text(),F=f.text(),I=o.text(),k=`(-(${V})^3/(27*(${M})^3)+(${V})*(${F})/(6*(${M})^2)-(${I})/(2*(${M})))`,se=`((${F})/(3*(${M}))-(${V})^2/(9*(${M})^2))`,ae=`(${V})/(3*(${M}))`,ce=`((${k})+sqrt((${k})^2+(${se})^3))^(1/3)+((${k})-sqrt((${k})^2+(${se})^3))^(1/3)-(${ae})`,Me="1/2+sqrt(3)/2*i";return[e.parse(ce),e.parse(`(${ce})(${Me})`),e.parse(`(${ce})(${Me})^2`)]},quartic(o,f,m,S,M){let V={};t.Utils.arrayUnique(Ne(M).concat(Ne(S)).concat(Ne(m)).concat(Ne(f)).concat(Ne(o))).forEach(De=>{V[De]=1}),M=M.toString(),S=S.toString(),m=m.toString(),f=f.toString(),o=o.toString();let F,I=e.parse(X("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",M,S,m)).toString(),k=e.parse(X("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",M,S,m,f)).toString(),se=e.parse(X("12*({0})*({4})-3*({1})*({3})+({2})^2",M,S,m,f,o)).toString(),ae=e.parse(X("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",M,S,m,f,o)).toString(),ce=e.parse(X("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",se,ae)).toString(),Me=e.parse(X("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",M,I,ce,se)).toString(),me=e.parse(X("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",M,S,I,k,Me)),$e=e.parse(X("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",M,S,I,k,Me)),Xe=e.parse(X("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",M,S,I,k,Me)),ye=e.parse(X("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",M,S,I,k,Me));return[me,$e,Xe,ye]},divideAndConquer(o,f){let m=[],S=t.Algebra.Factor.factorInner(o);return S.group===fe&&S.each(M=>{M=j.unwrapPARENS(M),m=m.concat(p(M,f))}),m},csolve(o,f){return t.Utils.block("IGNORE_E",()=>{let m,S,M,V,F,I,k,se,ae=[],ce=t.Utils.decompose_fn(o,f,!0);if(ce.x.group===Re){m=e.parse(ce.x.power),S=Number(m),M=e.pow(e.divide(ce.b.negate(),ce.a),m.invert()),V=j.toPolarFormArray(M),F=V[0],I=V[1],k=F.toString(),se=m.toString();let Me,me,$e;for(let Xe=0;Xe<S;Xe++)Me=Xe,$e=X("({0})*e^(2*{1}*pi*{2}*{3})",k,Me,m,t.Settings.IMAGINARY),me=e.parse($e),ae.push(me)}return ae},!0)},getPoints(o,f,m){f||=.01;let S=[],M=z(o),F=Math.round(0),I=M(F),k=t.Settings.ROOTS_PER_SIDE,se=k;S.push(Math.floor(F/2)),S.push(Math.abs(F)),S.push(F),o.each(me=>{me.containsFunction(t.Settings.LOG)&&S.push(.1)});let ae=Oe(-t.Settings.SOLVE_RADIUS,F,f),ce=Oe(F,t.Settings.SOLVE_RADIUS,f),Me=function(me,$e){let Xe,ye,De,Be=[],We=me[0],Le=Math.sign(M(We));for(let Ve=0,Qe=me.length;Ve<Qe&&Be.length<$e;Ve++)Xe=me[Ve],ye=M(Xe),De=Math.sign(ye),!isNaN(De)&&(De!==Le&&(Be.push(Xe),Be.push(me[Ve-1])),Le=De);S=S.concat(Be)};if(Me(ae,se),Me(ce,k),m){let me=t.Settings.SOLVE_RADIUS;Me([me,me*me],1),Me([-me*me,-me],1)}return S},bisection(o,f){let m=o-1,S=o+1;if(Math.sign(f(m))!==Math.sign(f(S))){let M=0,V,F;do{if(V=Math.abs(S-m),M++>t.Settings.MAX_BISECTION_ITER||isNaN(V))return;F=(m+S)/2,f(m)*f(F)>0?m=F:S=F}while(V>=de.EPSILON);let I=(m+S)/2,k=f(I);return!isNaN(k)&&Math.abs(k)<=t.Settings.BI_SECTION_EPSILON?t.Utils.round(I,13):void 0}},bSearch(o,f,m){let S=m(o),M=m(f);if(Math.sign(S)===Math.sign(M)||isNaN(S)||isNaN(M))return;let V=80,F=0;do{let I=(o+f)/2,k=Math.sign(S),se=Math.sign(m(I));if(k===se){if(I===o)break;o=I,S=m(o)}else{if(I===f)break;f=I,M=m(f)}F++}while(o!==f&&F<V);if(!(!isFinite(m(o))||!isFinite(m(f))))return o},Newton(o,f,m,S){let M=t.Settings.MAX_NEWTON_ITERATIONS,V=0,F=o,I,k,se;do{let ae=f(F);if(F===0&&ae===0){I=0;break}if(V++,V>M)return;let ce=m(F);if(isNaN(ce)||isNaN(ae))return;if(ce===0)I+=se;else{if(!isFinite(ae)||!isFinite(ce)||Math.abs(ae)>1e25)return K.bSearch(S,F,f);I=F-ae/ce}if(se=I-F,se===0&&!isFinite(ce))return;k=Math.abs(se),F=I}while(k>de.NEWTON_EPSILON);return I},rewrite(o,f,m){if(f||=new j(0),o.isComposite()&&o.isLinear()){let V=[],F=[];o.each(I=>{I=I.clone(),I.fname==="sqrt"&&I.contains(m)?V.push(I):F.push(I)},!0),V.length===1&&(f=e.expand(e.pow(e.subtract(f,t.Utils.arraySum(F)),new j(2))),o=e.expand(e.pow(j.unwrapSQRT(V[0]),new j(2))))}else o=j.unwrapSQRT(e.expand(o));let S=0,M=o.length;if(o.group===g&&o.contains(m)&&o.isLinear()){o.distributeMultiplier();let V=new j(0);return o.each(F=>{F.contains(m)?(S++,V=e.add(V,F.clone())):f=e.subtract(f,F.clone())}),o=V,S!==M?K.rewrite(o,f,m):[o,f]}if(o.group===fe&&o.contains(m)&&o.isLinear()){if(o.multiplier.lessThan(0)&&(o.multiplier=o.multiplier.multiply(new t.Frac(-1)),f.multiplier=f.multiplier.multiply(new t.Frac(-1))),f.equals(0))return new j(0);let V=new j(1);return o.each(F=>{F.contains(m)?V=e.multiply(V,F.clone()):f=e.divide(f,F.clone())}),o=V,K.rewrite(o,f,m)}if(!o.isLinear()&&o.contains(m)){let V=e.parse(o.power.clone().invert());return o=e.pow(o,V.clone()),f=e.pow(e.expand(f),V.clone()),K.rewrite(o,f,m)}return o.group===H||o.group===Re||o.group===ie?[o,f]:[o,f]},sqrtSolve(o,f){let m=new j(0),S=new j(0);if(o.isComposite()&&(o.each(M=>{M.fname==="sqrt"&&M.contains(f)?m=e.add(m,M.clone()):S=e.add(S,M.clone())}),!m.equals(0))){let M=e.expand(e.multiply(e.parse(o.multiplier),e.subtract(e.pow(S,new j(2)),e.pow(m,new j(2))))),V=p(M,f);return V=V.filter(F=>{if(F.isImaginary())return!0;let I={};return I[f]=F,!!R(o,I).equals(0)}),V}}},l=function(o,f,m,S){let M=o.toString(),V=M.match(/(?<![a-z])abs/gu);if(!V||V.length>2||o.LHS.group!==H&&o.RHS.group!==H)return null;let F=o.constructor(M.replace(/(?<![a-z])abs/u,"")),I=o.constructor(M.replace(/(?<![a-z])abs/u,"(-1)")),k=p(F,f,null,m,S);return[p(I,f,null,m,S),k]};function p(o,f,m,S,M){if(S||=0,S++>de.MAX_SOLVE_DEPTH)return m;m||=[];let V={},F={};F[f]=0;let I=function(ye,De){let Be=Ee(ye);if(!(ye===void 0||typeof ye=="number"&&isNaN(ye))){if(ve(ye))ye.forEach(We=>{I(We)});else if(ye.valueOf()!=="null"){if(typeof t.Settings.PRE_ADD_SOLUTION=="function"&&(ye=t.Settings.PRE_ADD_SOLUTION(ye)),Be||(ye=e.parse(ye)),t.Settings.make_pi_conversions&&De){let Le=e.divide(ye.clone(),new j(Math.PI)),Ve=Le.multiplier,Qe=Math.abs(Ve.num),Ae=Math.abs(Ve.den);Qe<10&&Ae<10&&(ye=e.multiply(Le,new j("pi")))}let We=ye.toString();V[We]||m.push(ye),V[We]=!0}}};if(o instanceof we){let ye=l(o,f,m,S,M);if(ye)return I(ye),m;if(o.isZero())return[new j(0)];if(o.LHS.equals(f)&&!o.RHS.contains(f,!0))return[o.RHS];if(o.RHS.equals(f)&&!o.LHS.contains(f,!0))return[o.LHS]}if(o instanceof t.Vector&&(o=o.elements),ve(o))return K.solveSystem(o,f);if(f||="x",Ee(o)&&R(o.getDenom(),F).equals(0)===!0)return m;if(o.group===Re&&o.contains(f)){try{let ye={};ye[f]=0,R(M,ye,"numer"),I(new j(0))}catch(ye){if(ye.message==="timeout")throw ye}return m}if(o.group===fe){let ye=o.getNum();if(ye.group===fe){let De=String(f);return ye.each(Be=>{Be.contains(De)&&p(Be,f,m,S,o)}),m}return p(ye,f,m,S,M)}o.group===H&&o.fname==="sqrt"&&(o=e.pow(j.unwrapSQRT(o),new j(2)));let k=(t.Utils.isSymbol(o)?o:K.toLHS(o,!1)).getNum(),se=t.Utils.variables(k),ae=se.length;if(t.Utils.isInt(k.power)&&k.power>1&&(k=e.parse(k).toLinear()),(k.group===Re||k.group===fe)&&k.contains(f))return[new j(0)];let ce={},Me,me=function(ye){ye=e.expand(ye,{expand_denominator:!0,expand_functions:!0});let De=ye.clone();if(ye.symbols)for(let Be in ye.symbols){if(!Object.hasOwn(ye.symbols,Be))continue;let We=ye.symbols[Be],Le=We.getDenom();if(!Le.isConstant(!0)&&ye.isComposite()){let W=new j(0);return ye.each(Y=>{W=e.add(W,e.multiply(Y,Le.clone()))}),me(e.multiply(e.parse(ye.multiplier),W))}let Ve=_(We,f),Qe=Ve[1].fname===t.Settings.SQRT,Ae=j.unwrapSQRT(Ve[1]),$=Ae.power.clone();if(!Ee($)&&!$.equals(1/2)){if($.den.gt(1)){if(Qe)return ye=e.subtract(ye,We.clone()),ye=e.add(ye,e.multiply(Ve[0].clone(),Ae)),me(ye);let W=ce[$.den];ce[$.den]=W?W++:1}else if($.sign()===-1){let W=e.parse(`${f}^${Math.abs($)}`),Y=ye;return Y.each((q,ee)=>{q.contains(f)&&(Y.symbols[ee]=e.multiply(q,W.clone()))}),ce={},me(e.parse(Y))}else if(We.group===ie){let W=t.Utils.arrayMin(t.Utils.keys(We.symbols));if(W<0){let Y=e.parse(`${f}^${Math.abs(W)}`),q=new j(0);return De.each(ee=>{q=e.add(q,e.multiply(ee.clone(),Y.clone()))},!0),q}}}}return ye},$e=function(ye){let De=new j(0),Be=new j(0);return ye.each(We=>{We.contains(f,!0)?De=e.add(De,We.clone()):Be=e.subtract(Be,We.clone())}),[De,Be]};if(K.inverseFunctionSolve=function(De,Be,We){let Le=_(Be.args[0],f);if(Le[1].group===Re)return e.divide(e.symfunction(De,[e.divide(We,e.parse(Be.multiplier))]),Le[0])},k=me(k),k.equals(0))return[k];let Xe=t.Utils.keys(ce);if(Xe.length===1&&(Me=Xe[0],k.each((ye,De)=>{if(ye.contains(f)){let Be=_(ye,f),We=Be[1],Le=We.power;Le.den.gt(1)&&(We.power=Le.multiply(new t.Frac(Me)),k.symbols[De]=e.multiply(We,Be[0]))}}),k=e.parse(k)),I(K.sqrtSolve(k,f)),ae===1)if(k.isPoly(!0)){let ye=new t.Algebra.Classes.Factors;if(t.Algebra.Factor.factorInner(k,ye),ye.getNumberSymbolics()>1)for(let De in ye.factors)Object.hasOwn(ye.factors,De)&&I(p(ye.factors[De],f));else{let De=t.Utils.getCoeffs(k,f),Be=De.length-1,We=!1;if(se[0]===f){if(Se(De,Le=>Le.group!==t.groups.N)){let Le=t.Algebra.proots(k);Se(Le,Ve=>!t.Utils.isInt(Ve))&&(We=!0,Le.forEach(Ve=>{I(new j(Ve))}))}if(!We)if(o=e.parse(o),o instanceof t.Equation&&(o=o.toLHS()),Be===1)I(e.divide(De[0],De[1].negate()));else if(Be===2)I(e.expand(K.quad.apply(void 0,De)));else if(Be===3){let Le=[],Ve=t.Algebra.Factor.factorInner(o);Le=[],Le.length>0?I(Le):I(K.cubic.apply(void 0,De))}else u.proots(k).map(I)}}}else{let ye=k.hasTrig(),De=K.getPoints(k,.1),Be=K.getPoints(k,.05),We=K.getPoints(k,.01,!0),Le=t.Utils.arrayUnique(De.concat(Be).concat(We)).sort((B,T)=>B-T),Ve,Qe,Ae,$=z(k.clone()),W=[];for(Ve=0;Ve<Le.length;Ve++){if(Qe=Le[Ve],Ae=K.bisection(Qe,$),typeof Ae>"u"){W.push(Qe);continue}I(Ae,ye)}Le=W;let Y=w.diff(k.clone()),q=z(Y),ee=Le[0];for(Ve=0;Ve<Le.length;Ve++)Qe=Le[Ve],I(K.Newton(Qe,$,q,ee),ye),ee=Qe;m.sort((B,T)=>{let ge=B.text("decimals"),a=T.text("decimals"),c=Number(ge),A=Number(a);return isNaN(c)&&isNaN(A)?ge.localeCompare(a):isNaN(c)&&!isNaN(A)?-1:!isNaN(c)&&isNaN(A)?1:c-A}),m=m.map(B=>B.isConstant()?new j(Number(Number(B).toPrecision(15))):B),m=m.filter((B,T,ge)=>{let a=Number(Number(B).toPrecision(15)),c=Number(ge[T-1]);return T===0||isNaN(a)||isNaN(c)?!0:Math.abs(a-c)>=de.EPSILON})}else if(!k.hasFunc(f)&&k.isComposite())try{let ye=t.Algebra.Factor.factorInner(k.clone()),De=e.expand(e.parse(ye)),Be=e.expand(k.clone()),We=e.subtract(De,Be),Le=!0;if(We.equals(0)||(Le=!1),Le&&ye.group===fe)ye.each(Ve=>{I(p(Ve,f))});else{let Ve=t.Utils.getCoeffs(k,f);switch(Ve.length-1){case 0:{let $=$e(k),W=$[0],Y=$[1];if(W.group===t.groups.EX){let q=t.Settings.LOG,ee=`${q}((${Y})/(${W.multiplier}))/(${q}(${W.value})*${W.power.multiplier})`,B=e.parse(ee);I(B)}break}case 1:I(e.divide(Ve[0],Ve[1].negate()));break;case 2:I(K.quad.apply(void 0,Ve));break;case 3:I(K.cubic.apply(void 0,Ve));break;case 4:I(K.quartic.apply(void 0,Ve));break;default:I(K.csolve(k,f)),m.length===0&&I(K.divideAndConquer(k,f))}m.length===0&&I(p(ye,f,m,S))}}catch(ye){if(ye.message==="timeout")throw ye}else try{let ye=K.rewrite(k,null,f),De=ye[0],Be=ye[1];if(De.group===H)if(De.fname==="abs")De.args[0].toString()===f&&I([Be.clone(),Be.negate()]);else if(De.fname==="sin")I(K.inverseFunctionSolve("asin",De,Be));else if(De.fname==="cos")I(K.inverseFunctionSolve("acos",De,Be));else if(De.fname==="tan")I(K.inverseFunctionSolve("atan",De,Be));else if(De.fname===t.Settings.LOG){let We=_(De.args[0],f),Le=We[1];if(Le.group===Re){Be=e.divide(e.subtract(e.pow(De.args.length>1?De.args[1]:new j("e"),e.divide(Be,e.parse(De.multiplier))),We[3]),We[0]);let Ve=new we(Le,Be).toLHS();I(p(Ve,f))}}else I(e.subtract(De,Be));else{let We=new we(De,Be).toLHS();if(We.equals(k))throw new Error("Stopping. No stop condition exists");I(p(We,f))}}catch(ye){if(ye.message==="timeout")throw ye;if(k.group===fe)I(0);else if(k.group===g){let De=$e(k),Be=De[0],We=De[1];if(Be.group===t.groups.EX&&Be.value===f){let Le=Be.power.clone().invert();I(e.pow(We,Le))}}}if(Me&&(m=m.map(ye=>e.pow(ye,new j(Me)))),Ee(o)){let ye={};m=m.filter(De=>{try{ye[f]=De;let Be=Number(R(o,ye));return isNaN(Be),!0}catch(Be){if(Be.message==="timeout")throw Be;return!1}})}return m}D0.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return p}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return t.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return qe}}]),D0.updateAPI()})()});var a1=c0((Ji,J0)=>{"use strict";var F0;typeof J0<"u"&&(F0=O0(),x0(),$0());(function(){let t=F0.getCore(),e=t.PARSER,{NerdamerSymbol:u}=t,{format:w}=t.Utils,{isVector:_}=t.Utils,{isArray:R}=t.Utils,L=t.Vector,{S:X}=t.groups,z=t.groups.EX,{CP:Z}=t.groups,{PL:j}=t.groups,{CB:Ee}=t.groups,{FN:Ne}=t.groups;t.Settings.Laplace_integration_depth=40,u.prototype.findFunction=function(fe){if(this.group===Ne&&this.fname===fe)return this.clone();let g;if(this.symbols){for(let H in this.symbols)if(Object.hasOwn(this.symbols,H)&&(g=this.symbols[H].findFunction(fe),g))break}return g};let Re=t.Extra={version:"1.4.2",LaPlace:{transform(ie,fe,g){ie=ie.clone(),fe=fe.toString(),ie=u.unwrapSQRT(ie,!0);let H,de=ie.stripVar(fe),Oe=ie.group;if(ie=e.divide(ie,de.clone()),ie.isConstant()||!ie.contains(fe,!0))H=e.parse(w("({0})/({1})",ie,g));else if(Oe===X&&t.Utils.isInt(ie.power)){let ve=String(ie.power);H=e.parse(w("factorial({0})/({1})^({0}+1)",ve,g))}else if(ie.group===X&&ie.power.equals(1/2))H=e.parse(w("sqrt(pi)/(2*({0})^(3/2))",g));else if(ie.isComposite())H=new u(0),ie.each(ve=>{H=e.add(H,Re.LaPlace.transform(ve,fe,g))},!0);else if(ie.isE()&&(ie.power.group===X||ie.power.group===Ee)){let ve=ie.power.stripVar(fe);H=e.parse(w("1/(({1})-({0}))",ve,g))}else{let ve=["sin","cos","sinh","cosh"];if(ie.group===Ne&&ve.indexOf(ie.fname)!==-1&&(ie.args[0].group===X||ie.args[0].group===Ee)){let we=ie.args[0].stripVar(fe);switch(ie.fname){case"sin":H=e.parse(w("({0})/(({1})^2+({0})^2)",we,g));break;case"cos":H=e.parse(w("({1})/(({1})^2+({0})^2)",we,g));break;case"sinh":H=e.parse(w("({0})/(({1})^2-({0})^2)",we,g));break;case"cosh":H=e.parse(w("({1})/(({1})^2-({0})^2)",we,g));break}}else{let we=t.Settings.integration_depth<t.Settings.Laplace_integration_depth,qe;we&&(qe=t.Settings.integration_depth,t.Settings.integration_depth=t.Settings.Laplace_integration_depth),t.Utils.block("PARSE2NUMBER",()=>{let Se=fe,K=ie.sub(fe,Se),l=e.parse(`e^(-${g}*${Se})*${K}`);if(H=t.Calculus.integrate(l,Se),H.hasIntegral()){H=e.symfunction("laplace",[ie,fe,g]);return}H=H.sub(fe,0),H=e.expand(e.multiply(H,new u(-1))),H=H.sub(Se,fe)},!1),H=t.Utils.block("PARSE2NUMBER",()=>e.parse(H),!0),we&&(t.Settings.integration_depth=qe)}}return e.multiply(H,de)},inverse(ie,fe,g){let H=ie.clone();return t.Utils.block("POSITIVE_MULTIPLIERS",()=>{let de;if(ie.group===Ee&&(ie=t.Algebra.PartFrac.partfrac(e.expand(ie),fe)),ie.group===X||ie.group===Ee||ie.isComposite()){let Oe,ve,we,qe,Se,K,l,p,o=ie.multiplier.clone();ie.toUnitMultiplier();let f=ie.getNum(),m=ie.getDenom().toUnitMultiplier();m.group===Z||m.group===j?(ve=m.power.clone(),m.toLinear()):ve=new t.Frac(1);let S=fe.toString(),M=t.Utils.decompose_fn(m,S,!0),V=t.Utils.decompose_fn(e.expand(f.clone()),S,!0);f.multiplier=f.multiplier.multiply(o);let F=function(){de=e.multiply(de,f),de.multiplier=de.multiplier.multiply(ie.multiplier),de=e.divide(de,M.a)};if((m.group===X||m.group===Ee)&&M.x.value===S&&M.b.equals(0)&&t.Utils.isInt(M.x.power))Oe=M.x.power-1,p=t.Math2.factorial(Oe),de=e.divide(e.pow(g,new u(Oe)),new u(p)),F();else if(m.group===Z&&ve.equals(1)){if(M.x.group===t.groups.PL&&t.Algebra.degree(m).equals(2)){let I=t.Algebra.sqComplete(m,S),k=t.Utils.getU(m);we=t.Utils.decompose_fn(I.a,S,!0).b;let se=Re.LaPlace.inverse(e.parse(`1/((${k})^2+(${I.c}))`),k,g);de=e.multiply(se,e.parse(`(${o})*e^(-(${we})*(${g}))`))}else if(M.x.isLinear()&&!f.contains(S))g=e.divide(g,M.a.clone()),Oe=ve-1,p=Oe===0||Oe===1?"1":`(${ve}-1)!`,de=e.parse(w("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",g,M.a,M.b,ve,p)),F();else if(M.x.group===X&&M.x.power.equals(2))if(f.contains(S)){if(we=new u(1),f.group===Ee){let me=new u(1);f.each($e=>{$e.contains(S)?me=e.multiply(me,$e):we=e.multiply(we,$e)}),f=me}l=t.Utils.decompose_fn(f,S,!0);let I=l.a,k=l.b,se=I.containsFunction("sin"),ae=I.containsFunction("cos"),ce=k.containsFunction("cos"),Me=k.containsFunction("sin");if(l.x.value===S&&l.x.isLinear()&&!(se&&ce||ae||Me))de=e.parse(w("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",g,l.a,M.a,M.b));else if(se&&ce){let me=I.findFunction("sin"),$e=k.findFunction("cos");if(me.args[0].equals($e.args[0])&&!me.args[0].contains(S)){qe=e.divide(k,$e.toUnitMultiplier()).toString();let Xe=me.args[0].toString();Se=M.b;let ye=e.divide(I,me.toUnitMultiplier());K="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",de=e.parse(w(K,g,we,qe,Xe,Se,ye))}}}else de=e.parse(w("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",g,f,M.a,M.b))}else if(M.x.power.num&&M.x.power.num.equals(3)&&M.x.power.den.equals(2)&&f.contains("sqrt(pi)")&&!f.contains(S)&&f.isLinear())qe=e.divide(f.clone(),e.parse("sqrt(pi)")),de=e.parse(w("(2*({2})*sqrt({0}))/({1})",g,M.a,qe,f));else if(ve.equals(2)&&M.x.power.equals(2))if(f.contains(S))if(l=t.Utils.decompose_fn(e.expand(f.clone()),S,!0),l.x.isComposite()){let I=[],k=f.collectSymbols(se=>{se=u.unwrapPARENS(se);let ae=t.Utils.decompose_fn(se,S,!0);return ae.symbol=se,ae}).sort((se,ae)=>{let ce=se.x.value===S?se.x.power:0;return(ae.x.value===S?ae.x.power:0)-ce});we=new u(-1);for(let se=0;se<k.length;se++){let ae=k[se];ae.x.value===S?I.push(ae):we=e.multiply(we,ae.symbol)}I[0].x.power.equals(2)&&I[1].x.power.equals(1)&&I[1].b.equals(0)&&!I[0].b.equals(0)&&(qe=I[0].a.negate(),K="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",de=e.parse(w(K,g,we,qe,I[0].b,M.a,M.b)))}else l.x.isLinear()?(we=e.divide(l.a,new u(2)),K="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",de=e.parse(w(K,g,we,M.a,M.b))):l.x.power.equals(2)&&(l.b.equals(0)?(we=e.divide(l.a,new u(2)),K="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",de=e.parse(w(K,g,we,M.a,M.b))):(we=e.divide(l.a,new u(2)),Se=l.b.negate(),K="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",de=e.parse(w(K,g,we,M.a,M.b,Se))));else we=e.divide(f,new u(2)),K="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",de=e.parse(w(K,g,we,M.a,M.b));else ie.isComposite()&&(ve.equals(2)&&M.x.group===X?de=e.parse(`(${o})*(${g})*e^(-(${M.b})*(${g}))`):(de=new u(0),ie=t.Algebra.PartFrac.partfrac(e.expand(ie),fe),ie.each(I=>{de=e.add(de,Re.LaPlace.inverse(I,fe,g))},!0)))}return de||=e.symfunction("ilt",[H,fe,g]),de},!0)}},Statistics:{frequencyMap(ie){let fe={};for(let g=0,H=ie.length;g<H;g++){let Oe=ie[g].toString();fe[Oe]||=0,fe[Oe]++}return fe},sort(ie){return ie.sort((fe,g)=>((!fe.isConstant()||!g.isConstant())&&e.error("Unable to sort! All values must be numeric"),fe.multiplier.subtract(g.multiplier)))},count(ie){return new u(ie.length)},sum(ie,fe){let g=new u(0);for(let H=0,de=ie.length;H<de;H++){let Oe=ie[H].clone();fe?g=e.add(e.pow(e.subtract(Oe,fe.clone()),new u(2)),g):g=e.add(Oe,g)}return g},mean(...ie){return _(ie[0])?Re.Statistics.mean(...ie[0].elements):e.divide(Re.Statistics.sum(ie),Re.Statistics.count(ie))},median(...ie){let fe;if(_(ie[0]))return Re.Statistics.median(...ie[0].elements);try{let g=Re.Statistics.sort(ie),H=ie.length;if(t.Utils.even(H)){let de=H/2;fe=Re.Statistics.mean(g[de-1],g[de])}else fe=g[Math.floor(H/2)]}catch(g){if(g.message==="timeout")throw g;fe=e.symfunction("median",ie)}return fe},mode(...ie){let fe;if(_(ie[0]))return Re.Statistics.mode(...ie[0].elements);let g=Re.Statistics.frequencyMap(ie);if(t.Utils.keys(g).length===1)fe=ie[0];else{let H={};for(let Oe in g){if(!Object.hasOwn(g,Oe))continue;let ve=g[Oe];if(ve in H){let we=H[ve];R(we)?we.push(Oe):H[ve]=[Oe,H[ve]]}else H[ve]=Oe}let de=H[Math.max.apply(null,t.Utils.keys(H))];R(de)?fe=e.symfunction("mode",de.sort()):fe=e.parse(de)}return fe},gVariance(ie,fe){let g=Re.Statistics.mean(...fe),H=Re.Statistics.sum(fe,g);return e.multiply(ie,H)},variance(...ie){if(_(ie[0]))return Re.Statistics.variance(...ie[0].elements);let fe=e.divide(new u(1),Re.Statistics.count(ie));return Re.Statistics.gVariance(fe,ie)},sampleVariance(...ie){if(_(ie[0]))return Re.Statistics.sampleVariance(...ie[0].elements);let fe=e.divide(new u(1),e.subtract(Re.Statistics.count(ie),new u(1)));return Re.Statistics.gVariance(fe,ie)},standardDeviation(...ie){return _(ie[0])?Re.Statistics.standardDeviation(...ie[0].elements):e.pow(Re.Statistics.variance(...ie),new u(1/2))},sampleStandardDeviation(...ie){return _(ie[0])?Re.Statistics.sampleStandardDeviation(...ie[0].elements):e.pow(Re.Statistics.sampleVariance(...ie),new u(1/2))},zScore(ie,fe,g){return e.divide(e.subtract(ie,fe),g)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};F0.register([{name:"laplace",visible:!0,numargs:3,build(){return Re.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Re.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Re.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Re.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Re.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Re.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Re.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Re.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Re.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Re.Statistics.zScore}}]),F0.updateAPI()})();typeof J0<"u"&&(J0.exports=F0)});var Xi=c0((Yi,c1)=>{var Vi=O0();$0();x0();u1();a1();c1.exports=Vi});return Xi();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
