"use strict";var nerdamer=(()=>{var w0=(h,n)=>()=>(n||h((n={exports:{}}).exports,n),n.exports);var U1=w0((Bi,n1)=>{var Xt=(function(h){"use strict";var n=1e7,t=7,T=9007199254740992,X=ot(T),re="0123456789abcdefghijklmnopqrstuvwxyz",ce=typeof BigInt=="function";function z(f,e,i,u){return typeof f>"u"?z[0]:typeof e<"u"?+e==10&&!i?x(f):Te(f,e,i,u):x(f)}function ie(f,e){this.value=f,this.sign=e,this.isSmall=!1}ie.prototype=Object.create(z.prototype);function D(f){this.value=f,this.sign=f<0,this.isSmall=!0}D.prototype=Object.create(z.prototype);function c(f){this.value=f}c.prototype=Object.create(z.prototype);function te(f){return-T<f&&f<T}function ot(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function Re(f){Ue(f);var e=f.length;if(e<4&&F(f,X)<0)switch(e){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*n;default:return f[0]+(f[1]+f[2]*n)*n}return f}function Ue(f){for(var e=f.length;f[--e]===0;);f.length=e+1}function ge(f){for(var e=new Array(f),i=-1;++i<f;)e[i]=0;return e}function ye(f){return f>0?Math.floor(f):Math.ceil(f)}function Se(f,e){var i=f.length,u=e.length,g=new Array(i),S=0,N=n,E,q;for(q=0;q<u;q++)E=f[q]+e[q]+S,S=E>=N?1:0,g[q]=E-S*N;for(;q<i;)E=f[q]+S,S=E===N?1:0,g[q++]=E-S*N;return S>0&&g.push(S),g}function W(f,e){return f.length>=e.length?Se(f,e):Se(e,f)}function Ce(f,e){var i=f.length,u=new Array(i),g=n,S,N;for(N=0;N<i;N++)S=f[N]-g+e,e=Math.floor(S/g),u[N]=S-e*g,e+=1;for(;e>0;)u[N++]=e%g,e=Math.floor(e/g);return u}ie.prototype.add=function(f){var e=x(f);if(this.sign!==e.sign)return this.subtract(e.negate());var i=this.value,u=e.value;return e.isSmall?new ie(Ce(i,Math.abs(u)),this.sign):new ie(W(i,u),this.sign)},ie.prototype.plus=ie.prototype.add,D.prototype.add=function(f){var e=x(f),i=this.value;if(i<0!==e.sign)return this.subtract(e.negate());var u=e.value;if(e.isSmall){if(te(i+u))return new D(i+u);u=ot(Math.abs(u))}return new ie(Ce(u,Math.abs(i)),i<0)},D.prototype.plus=D.prototype.add,c.prototype.add=function(f){return new c(this.value+x(f).value)},c.prototype.plus=c.prototype.add;function qe(f,e){var i=f.length,u=e.length,g=new Array(i),S=0,N=n,E,q;for(E=0;E<u;E++)q=f[E]-S-e[E],q<0?(q+=N,S=1):S=0,g[E]=q;for(E=u;E<i;E++){if(q=f[E]-S,q<0)q+=N;else{g[E++]=q;break}g[E]=q}for(;E<i;E++)g[E]=f[E];return Ue(g),g}function Be(f,e,i){var u;return F(f,e)>=0?u=qe(f,e):(u=qe(e,f),i=!i),u=Re(u),typeof u=="number"?(i&&(u=-u),new D(u)):new ie(u,i)}function Ve(f,e,i){var u=f.length,g=new Array(u),S=-e,N=n,E,q;for(E=0;E<u;E++)q=f[E]+S,S=Math.floor(q/N),q%=N,g[E]=q<0?q+N:q;return g=Re(g),typeof g=="number"?(i&&(g=-g),new D(g)):new ie(g,i)}ie.prototype.subtract=function(f){var e=x(f);if(this.sign!==e.sign)return this.add(e.negate());var i=this.value,u=e.value;return e.isSmall?Ve(i,Math.abs(u),this.sign):Be(i,u,this.sign)},ie.prototype.minus=ie.prototype.subtract,D.prototype.subtract=function(f){var e=x(f),i=this.value;if(i<0!==e.sign)return this.add(e.negate());var u=e.value;return e.isSmall?new D(i-u):Ve(u,Math.abs(i),i>=0)},D.prototype.minus=D.prototype.subtract,c.prototype.subtract=function(f){return new c(this.value-x(f).value)},c.prototype.minus=c.prototype.subtract,ie.prototype.negate=function(){return new ie(this.value,!this.sign)},D.prototype.negate=function(){var f=this.sign,e=new D(-this.value);return e.sign=!f,e},c.prototype.negate=function(){return new c(-this.value)},ie.prototype.abs=function(){return new ie(this.value,!1)},D.prototype.abs=function(){return new D(Math.abs(this.value))},c.prototype.abs=function(){return new c(this.value>=0?this.value:-this.value)};function et(f,e){var i=f.length,u=e.length,g=i+u,S=ge(g),N=n,E,q,C,P,Z;for(C=0;C<i;++C){P=f[C];for(var oe=0;oe<u;++oe)Z=e[oe],E=P*Z+S[C+oe],q=Math.floor(E/N),S[C+oe]=E-q*N,S[C+oe+1]+=q}return Ue(S),S}function Oe(f,e){var i=f.length,u=new Array(i),g=n,S=0,N,E;for(E=0;E<i;E++)N=f[E]*e+S,S=Math.floor(N/g),u[E]=N-S*g;for(;S>0;)u[E++]=S%g,S=Math.floor(S/g);return u}function J(f,e){for(var i=[];e-- >0;)i.push(0);return i.concat(f)}function l(f,e){var i=Math.max(f.length,e.length);if(i<=30)return et(f,e);i=Math.ceil(i/2);var u=f.slice(i),g=f.slice(0,i),S=e.slice(i),N=e.slice(0,i),E=l(g,N),q=l(u,S),C=l(W(g,u),W(N,S)),P=W(W(E,J(qe(qe(C,E),q),i)),J(q,2*i));return Ue(P),P}function w(f,e){return-.012*f-.012*e+15e-6*f*e>0}ie.prototype.multiply=function(f){var e=x(f),i=this.value,u=e.value,g=this.sign!==e.sign,S;if(e.isSmall){if(u===0)return z[0];if(u===1)return this;if(u===-1)return this.negate();if(S=Math.abs(u),S<n)return new ie(Oe(i,S),g);u=ot(S)}return w(i.length,u.length)?new ie(l(i,u),g):new ie(et(i,u),g)},ie.prototype.times=ie.prototype.multiply;function r(f,e,i){return f<n?new ie(Oe(e,f),i):new ie(et(e,ot(f)),i)}D.prototype._multiplyBySmall=function(f){return te(f.value*this.value)?new D(f.value*this.value):r(Math.abs(f.value),ot(Math.abs(this.value)),this.sign!==f.sign)},ie.prototype._multiplyBySmall=function(f){return f.value===0?z[0]:f.value===1?this:f.value===-1?this.negate():r(Math.abs(f.value),this.value,this.sign!==f.sign)},D.prototype.multiply=function(f){return x(f)._multiplyBySmall(this)},D.prototype.times=D.prototype.multiply,c.prototype.multiply=function(f){return new c(this.value*x(f).value)},c.prototype.times=c.prototype.multiply;function m(f){var e=f.length,i=ge(e+e),u=n,g,S,N,E,q;for(N=0;N<e;N++){E=f[N],S=0-E*E;for(var C=N;C<e;C++)q=f[C],g=2*(E*q)+i[N+C]+S,S=Math.floor(g/u),i[N+C]=g-S*u;i[N+e]=S}return Ue(i),i}ie.prototype.square=function(){return new ie(m(this.value),!1)},D.prototype.square=function(){var f=this.value*this.value;return te(f)?new D(f):new ie(m(ot(Math.abs(this.value))),!1)},c.prototype.square=function(f){return new c(this.value*this.value)};function v(f,e){var i=f.length,u=e.length,g=n,S=ge(e.length),N=e[u-1],E=Math.ceil(g/(2*N)),q=Oe(f,E),C=Oe(e,E),P,Z,oe,pe,ae,De,Le;for(q.length<=i&&q.push(0),C.push(0),N=C[u-1],Z=i-u;Z>=0;Z--){for(P=g-1,q[Z+u]!==N&&(P=Math.floor((q[Z+u]*g+q[Z+u-1])/N)),oe=0,pe=0,De=C.length,ae=0;ae<De;ae++)oe+=P*C[ae],Le=Math.floor(oe/g),pe+=q[Z+ae]-(oe-Le*g),oe=Le,pe<0?(q[Z+ae]=pe+g,pe=-1):(q[Z+ae]=pe,pe=0);for(;pe!==0;){for(P-=1,oe=0,ae=0;ae<De;ae++)oe+=q[Z+ae]-g+C[ae],oe<0?(q[Z+ae]=oe+g,oe=0):(q[Z+ae]=oe,oe=1);pe+=oe}S[Z]=P}return q=_(q,E)[0],[Re(S),Re(q)]}function y(f,e){for(var i=f.length,u=e.length,g=[],S=[],N=n,E,q,C,P,Z;i;){if(S.unshift(f[--i]),Ue(S),F(S,e)<0){g.push(0);continue}q=S.length,C=S[q-1]*N+S[q-2],P=e[u-1]*N+e[u-2],q>u&&(C=(C+1)*N),E=Math.ceil(C/P);do{if(Z=Oe(e,E),F(Z,S)<=0)break;E--}while(E);g.push(E),S=qe(S,Z)}return g.reverse(),[Re(g),Re(S)]}function _(f,e){var i=f.length,u=ge(i),g=n,S,N,E,q;for(E=0,S=i-1;S>=0;--S)q=E*g+f[S],N=ye(q/e),E=q-N*e,u[S]=N|0;return[u,E|0]}function B(f,e){var i,u=x(e);if(ce)return[new c(f.value/u.value),new c(f.value%u.value)];var g=f.value,S=u.value,N;if(S===0)throw new Error("Cannot divide by zero");if(f.isSmall)return u.isSmall?[new D(ye(g/S)),new D(g%S)]:[z[0],f];if(u.isSmall){if(S===1)return[f,z[0]];if(S==-1)return[f.negate(),z[0]];var E=Math.abs(S);if(E<n){i=_(g,E),N=Re(i[0]);var q=i[1];return f.sign&&(q=-q),typeof N=="number"?(f.sign!==u.sign&&(N=-N),[new D(N),new D(q)]):[new ie(N,f.sign!==u.sign),new D(q)]}S=ot(E)}var C=F(g,S);if(C===-1)return[z[0],f];if(C===0)return[z[f.sign===u.sign?1:-1],z[0]];g.length+S.length<=200?i=v(g,S):i=y(g,S),N=i[0];var P=f.sign!==u.sign,Z=i[1],oe=f.sign;return typeof N=="number"?(P&&(N=-N),N=new D(N)):N=new ie(N,P),typeof Z=="number"?(oe&&(Z=-Z),Z=new D(Z)):Z=new ie(Z,oe),[N,Z]}ie.prototype.divmod=function(f){var e=B(this,f);return{quotient:e[0],remainder:e[1]}},c.prototype.divmod=D.prototype.divmod=ie.prototype.divmod,ie.prototype.divide=function(f){return B(this,f)[0]},c.prototype.over=c.prototype.divide=function(f){return new c(this.value/x(f).value)},D.prototype.over=D.prototype.divide=ie.prototype.over=ie.prototype.divide,ie.prototype.mod=function(f){return B(this,f)[1]},c.prototype.mod=c.prototype.remainder=function(f){return new c(this.value%x(f).value)},D.prototype.remainder=D.prototype.mod=ie.prototype.remainder=ie.prototype.mod,ie.prototype.pow=function(f){var e=x(f),i=this.value,u=e.value,g,S,N;if(u===0)return z[1];if(i===0)return z[0];if(i===1)return z[1];if(i===-1)return e.isEven()?z[1]:z[-1];if(e.sign)return z[0];if(!e.isSmall)throw new Error("The exponent "+e.toString()+" is too large.");if(this.isSmall&&te(g=Math.pow(i,u)))return new D(ye(g));for(S=this,N=z[1];u&!0&&(N=N.times(S),--u),u!==0;)u/=2,S=S.square();return N},D.prototype.pow=ie.prototype.pow,c.prototype.pow=function(f){var e=x(f),i=this.value,u=e.value,g=BigInt(0),S=BigInt(1),N=BigInt(2);if(u===g)return z[1];if(i===g)return z[0];if(i===S)return z[1];if(i===BigInt(-1))return e.isEven()?z[1]:z[-1];if(e.isNegative())return new c(g);for(var E=this,q=z[1];(u&S)===S&&(q=q.times(E),--u),u!==g;)u/=N,E=E.square();return q},ie.prototype.modPow=function(f,e){if(f=x(f),e=x(e),e.isZero())throw new Error("Cannot take modPow with modulus 0");var i=z[1],u=this.mod(e);for(f.isNegative()&&(f=f.multiply(z[-1]),u=u.modInv(e));f.isPositive();){if(u.isZero())return z[0];f.isOdd()&&(i=i.multiply(u).mod(e)),f=f.divide(2),u=u.square().mod(e)}return i},c.prototype.modPow=D.prototype.modPow=ie.prototype.modPow;function F(f,e){if(f.length!==e.length)return f.length>e.length?1:-1;for(var i=f.length-1;i>=0;i--)if(f[i]!==e[i])return f[i]>e[i]?1:-1;return 0}ie.prototype.compareAbs=function(f){var e=x(f),i=this.value,u=e.value;return e.isSmall?1:F(i,u)},D.prototype.compareAbs=function(f){var e=x(f),i=Math.abs(this.value),u=e.value;return e.isSmall?(u=Math.abs(u),i===u?0:i>u?1:-1):-1},c.prototype.compareAbs=function(f){var e=this.value,i=x(f).value;return e=e>=0?e:-e,i=i>=0?i:-i,e===i?0:e>i?1:-1},ie.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var e=x(f),i=this.value,u=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:F(i,u)*(this.sign?-1:1)},ie.prototype.compareTo=ie.prototype.compare,D.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var e=x(f),i=this.value,u=e.value;return e.isSmall?i==u?0:i>u?1:-1:i<0!==e.sign?i<0?-1:1:i<0?1:-1},D.prototype.compareTo=D.prototype.compare,c.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var e=this.value,i=x(f).value;return e===i?0:e>i?1:-1},c.prototype.compareTo=c.prototype.compare,ie.prototype.equals=function(f){return this.compare(f)===0},c.prototype.eq=c.prototype.equals=D.prototype.eq=D.prototype.equals=ie.prototype.eq=ie.prototype.equals,ie.prototype.notEquals=function(f){return this.compare(f)!==0},c.prototype.neq=c.prototype.notEquals=D.prototype.neq=D.prototype.notEquals=ie.prototype.neq=ie.prototype.notEquals,ie.prototype.greater=function(f){return this.compare(f)>0},c.prototype.gt=c.prototype.greater=D.prototype.gt=D.prototype.greater=ie.prototype.gt=ie.prototype.greater,ie.prototype.lesser=function(f){return this.compare(f)<0},c.prototype.lt=c.prototype.lesser=D.prototype.lt=D.prototype.lesser=ie.prototype.lt=ie.prototype.lesser,ie.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},c.prototype.geq=c.prototype.greaterOrEquals=D.prototype.geq=D.prototype.greaterOrEquals=ie.prototype.geq=ie.prototype.greaterOrEquals,ie.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},c.prototype.leq=c.prototype.lesserOrEquals=D.prototype.leq=D.prototype.lesserOrEquals=ie.prototype.leq=ie.prototype.lesserOrEquals,ie.prototype.isEven=function(){return(this.value[0]&1)===0},D.prototype.isEven=function(){return(this.value&1)===0},c.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},ie.prototype.isOdd=function(){return(this.value[0]&1)===1},D.prototype.isOdd=function(){return(this.value&1)===1},c.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},ie.prototype.isPositive=function(){return!this.sign},D.prototype.isPositive=function(){return this.value>0},c.prototype.isPositive=D.prototype.isPositive,ie.prototype.isNegative=function(){return this.sign},D.prototype.isNegative=function(){return this.value<0},c.prototype.isNegative=D.prototype.isNegative,ie.prototype.isUnit=function(){return!1},D.prototype.isUnit=function(){return Math.abs(this.value)===1},c.prototype.isUnit=function(){return this.abs().value===BigInt(1)},ie.prototype.isZero=function(){return!1},D.prototype.isZero=function(){return this.value===0},c.prototype.isZero=function(){return this.value===BigInt(0)},ie.prototype.isDivisibleBy=function(f){var e=x(f);return e.isZero()?!1:e.isUnit()?!0:e.compareAbs(2)===0?this.isEven():this.mod(e).isZero()},c.prototype.isDivisibleBy=D.prototype.isDivisibleBy=ie.prototype.isDivisibleBy;function R(f){var e=f.abs();if(e.isUnit())return!1;if(e.equals(2)||e.equals(3)||e.equals(5))return!0;if(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))return!1;if(e.lesser(49))return!0}function V(f,e){for(var i=f.prev(),u=i,g=0,S,N,E,q;u.isEven();)u=u.divide(2),g++;e:for(E=0;E<e.length;E++)if(!f.lesser(e[E])&&(q=Xt(e[E]).modPow(u,f),!(q.isUnit()||q.equals(i)))){for(S=g-1;S!=0;S--){if(q=q.square().mod(f),q.isUnit())return!1;if(q.equals(i))continue e}return!1}return!0}ie.prototype.isPrime=function(f){var e=R(this);if(e!==h)return e;var i=this.abs(),u=i.bitLength();if(u<=64)return V(i,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var g=Math.log(2)*u.toJSNumber(),S=Math.ceil(f===!0?2*Math.pow(g,2):g),N=[],E=0;E<S;E++)N.push(Xt(E+2));return V(i,N)},c.prototype.isPrime=D.prototype.isPrime=ie.prototype.isPrime,ie.prototype.isProbablePrime=function(f,e){var i=R(this);if(i!==h)return i;for(var u=this.abs(),g=f===h?5:f,S=[],N=0;N<g;N++)S.push(Xt.randBetween(2,u.minus(2),e));return V(u,S)},c.prototype.isProbablePrime=D.prototype.isProbablePrime=ie.prototype.isProbablePrime,ie.prototype.modInv=function(f){for(var e=Xt.zero,i=Xt.one,u=x(f),g=this.abs(),S,N,E;!g.isZero();)S=u.divide(g),N=e,E=u,e=i,u=g,i=N.subtract(S.multiply(i)),g=E.subtract(S.multiply(g));if(!u.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return e.compare(0)===-1&&(e=e.add(f)),this.isNegative()?e.negate():e},c.prototype.modInv=D.prototype.modInv=ie.prototype.modInv,ie.prototype.next=function(){var f=this.value;return this.sign?Ve(f,1,this.sign):new ie(Ce(f,1),this.sign)},D.prototype.next=function(){var f=this.value;return f+1<T?new D(f+1):new ie(X,!1)},c.prototype.next=function(){return new c(this.value+BigInt(1))},ie.prototype.prev=function(){var f=this.value;return this.sign?new ie(Ce(f,1),!0):Ve(f,1,this.sign)},D.prototype.prev=function(){var f=this.value;return f-1>-T?new D(f-1):new ie(X,!0)},c.prototype.prev=function(){return new c(this.value-BigInt(1))};for(var K=[1];2*K[K.length-1]<=n;)K.push(2*K[K.length-1]);var ue=K.length,ne=K[ue-1];function we(f){return Math.abs(f)<=n}ie.prototype.shiftLeft=function(f){var e=x(f).toJSNumber();if(!we(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var i=this;if(i.isZero())return i;for(;e>=ue;)i=i.multiply(ne),e-=ue-1;return i.multiply(K[e])},c.prototype.shiftLeft=D.prototype.shiftLeft=ie.prototype.shiftLeft,ie.prototype.shiftRight=function(f){var e,i=x(f).toJSNumber();if(!we(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftLeft(-i);for(var u=this;i>=ue;){if(u.isZero()||u.isNegative()&&u.isUnit())return u;e=B(u,ne),u=e[1].isNegative()?e[0].prev():e[0],i-=ue-1}return e=B(u,K[i]),e[1].isNegative()?e[0].prev():e[0]},c.prototype.shiftRight=D.prototype.shiftRight=ie.prototype.shiftRight;function me(f,e,i){e=x(e);for(var u=f.isNegative(),g=e.isNegative(),S=u?f.not():f,N=g?e.not():e,E=0,q=0,C=null,P=null,Z=[];!S.isZero()||!N.isZero();)C=B(S,ne),E=C[1].toJSNumber(),u&&(E=ne-1-E),P=B(N,ne),q=P[1].toJSNumber(),g&&(q=ne-1-q),S=C[0],N=P[0],Z.push(i(E,q));for(var oe=i(u?1:0,g?1:0)!==0?Xt(-1):Xt(0),pe=Z.length-1;pe>=0;pe-=1)oe=oe.multiply(ne).add(Xt(Z[pe]));return oe}ie.prototype.not=function(){return this.negate().prev()},c.prototype.not=D.prototype.not=ie.prototype.not,ie.prototype.and=function(f){return me(this,f,function(e,i){return e&i})},c.prototype.and=D.prototype.and=ie.prototype.and,ie.prototype.or=function(f){return me(this,f,function(e,i){return e|i})},c.prototype.or=D.prototype.or=ie.prototype.or,ie.prototype.xor=function(f){return me(this,f,function(e,i){return e^i})},c.prototype.xor=D.prototype.xor=ie.prototype.xor;var be=1<<30,ze=(n&-n)*(n&-n)|be;function _e(f){var e=f.value,i=typeof e=="number"?e|be:typeof e=="bigint"?e|BigInt(be):e[0]+e[1]*n|ze;return i&-i}function Fe(f,e){if(e.compareTo(f)<=0){var i=Fe(f,e.square(e)),u=i.p,g=i.e,S=u.multiply(e);return S.compareTo(f)<=0?{p:S,e:g*2+1}:{p:u,e:g*2}}return{p:Xt(1),e:0}}ie.prototype.bitLength=function(){var f=this;return f.compareTo(Xt(0))<0&&(f=f.negate().subtract(Xt(1))),f.compareTo(Xt(0))===0?Xt(0):Xt(Fe(f,Xt(2)).e).add(Xt(1))},c.prototype.bitLength=D.prototype.bitLength=ie.prototype.bitLength;function He(f,e){return f=x(f),e=x(e),f.greater(e)?f:e}function it(f,e){return f=x(f),e=x(e),f.lesser(e)?f:e}function Ge(f,e){if(f=x(f).abs(),e=x(e).abs(),f.equals(e))return f;if(f.isZero())return e;if(e.isZero())return f;for(var i=z[1],u,g;f.isEven()&&e.isEven();)u=it(_e(f),_e(e)),f=f.divide(u),e=e.divide(u),i=i.multiply(u);for(;f.isEven();)f=f.divide(_e(f));do{for(;e.isEven();)e=e.divide(_e(e));f.greater(e)&&(g=e,e=f,f=g),e=e.subtract(f)}while(!e.isZero());return i.isUnit()?f:f.multiply(i)}function Qe(f,e){return f=x(f).abs(),e=x(e).abs(),f.divide(Ge(f,e)).multiply(e)}function rt(f,e,i){f=x(f),e=x(e);var u=i||Math.random,g=it(f,e),S=He(f,e),N=S.subtract(g).add(1);if(N.isSmall)return g.add(Math.floor(u()*N));for(var E=j(N,n).value,q=[],C=!0,P=0;P<E.length;P++){var Z=C?E[P]+(P+1<E.length?E[P+1]/n:0):n,oe=ye(u()*Z);q.push(oe),oe<E[P]&&(C=!1)}return g.add(z.fromArray(q,n,!1))}var Te=function(f,e,i,u){i=i||re,f=String(f),u||(f=f.toLowerCase(),i=i.toLowerCase());var g=f.length,S,N=Math.abs(e),E={};for(S=0;S<i.length;S++)E[i[S]]=S;for(S=0;S<g;S++){var q=f[S];if(q!=="-"&&q in E&&E[q]>=N){if(q==="1"&&N===1)continue;throw new Error(q+" is not a valid digit in base "+e+".")}}e=x(e);var C=[],P=f[0]==="-";for(S=P?1:0;S<f.length;S++){var q=f[S];if(q in E)C.push(x(E[q]));else if(q==="<"){var Z=S;do S++;while(f[S]!==">"&&S<f.length);C.push(x(f.slice(Z+1,S)))}else throw new Error(q+" is not a valid character")}return b(C,e,P)};function b(f,e,i){var u=z[0],g=z[1],S;for(S=f.length-1;S>=0;S--)u=u.add(f[S].times(g)),g=g.times(e);return i?u.negate():u}function H(f,e){return e=e||re,f<e.length?e[f]:"<"+f+">"}function j(f,e){if(e=Xt(e),e.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var i=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return i.unshift([1]),{value:[].concat.apply([],i),isNegative:!1}}var u=!1;if(f.isNegative()&&e.isPositive()&&(u=!0,f=f.abs()),e.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:u};for(var g=[],S=f,N;S.isNegative()||S.compareAbs(e)>=0;){N=S.divmod(e),S=N.quotient;var E=N.remainder;E.isNegative()&&(E=e.minus(E).abs(),S=S.next()),g.push(E.toJSNumber())}return g.push(S.toJSNumber()),{value:g.reverse(),isNegative:u}}function O(f,e,i){var u=j(f,e);return(u.isNegative?"-":"")+u.value.map(function(g){return H(g,i)}).join("")}ie.prototype.toArray=function(f){return j(this,f)},D.prototype.toArray=function(f){return j(this,f)},c.prototype.toArray=function(f){return j(this,f)},ie.prototype.toString=function(f,e){if(f===h&&(f=10),f!==10||e)return O(this,f,e);for(var i=this.value,u=i.length,g=String(i[--u]),S="0000000",N;--u>=0;)N=String(i[u]),g+=S.slice(N.length)+N;var E=this.sign?"-":"";return E+g},D.prototype.toString=function(f,e){return f===h&&(f=10),f!=10||e?O(this,f,e):String(this.value)},c.prototype.toString=D.prototype.toString,c.prototype.toJSON=ie.prototype.toJSON=D.prototype.toJSON=function(){return this.toString()},ie.prototype.valueOf=function(){return parseInt(this.toString(),10)},ie.prototype.toJSNumber=ie.prototype.valueOf,D.prototype.valueOf=function(){return this.value},D.prototype.toJSNumber=D.prototype.valueOf,c.prototype.valueOf=c.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function G(f){if(te(+f)){var e=+f;if(e===ye(e))return ce?new c(BigInt(e)):new D(e);throw new Error("Invalid integer: "+f)}var i=f[0]==="-";i&&(f=f.slice(1));var u=f.split(/e/i);if(u.length>2)throw new Error("Invalid integer: "+u.join("e"));if(u.length===2){var g=u[1];if(g[0]==="+"&&(g=g.slice(1)),g=+g,g!==ye(g)||!te(g))throw new Error("Invalid integer: "+g+" is not a valid exponent.");var S=u[0],N=S.indexOf(".");if(N>=0&&(g-=S.length-N-1,S=S.slice(0,N)+S.slice(N+1)),g<0)throw new Error("Cannot include negative exponent part for integers");S+=new Array(g+1).join("0"),f=S}var E=/^([0-9][0-9]*)$/.test(f);if(!E)throw new Error("Invalid integer: "+f);if(ce)return new c(BigInt(i?"-"+f:f));for(var q=[],C=f.length,P=t,Z=C-P;C>0;)q.push(+f.slice(Z,C)),Z-=P,Z<0&&(Z=0),C-=P;return Ue(q),new ie(q,i)}function p(f){if(ce)return new c(BigInt(f));if(te(f)){if(f!==ye(f))throw new Error(f+" is not an integer.");return new D(f)}return G(f.toString())}function x(f){return typeof f=="number"?p(f):typeof f=="string"?G(f):typeof f=="bigint"?new c(f):f}for(var de=0;de<1e3;de++)z[de]=x(de),de>0&&(z[-de]=x(-de));return z.one=z[1],z.zero=z[0],z.minusOne=z[-1],z.max=He,z.min=it,z.gcd=Ge,z.lcm=Qe,z.isInstance=function(f){return f instanceof ie||f instanceof D||f instanceof c},z.randBetween=rt,z.fromArray=function(f,e,i){return b(f.map(x),x(e||10),i)},z})();typeof n1<"u"&&n1.hasOwnProperty("exports")&&(n1.exports=Xt);typeof define=="function"&&define.amd&&define(function(){return Xt})});var $1=w0((x1,i1)=>{(function(h){"use strict";var n=9e15,t=1e9,T="0123456789abcdef",X="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",re="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ce={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-n,maxE:n,crypto:!1},z,ie,D,c,te=!0,ot="[DecimalError] ",Re=ot+"Invalid argument: ",Ue=ot+"Precision limit exceeded",ge=ot+"crypto unavailable",ye="[object Decimal]",Se=Math.floor,W=Math.pow,Ce=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,qe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Be=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ve=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,et=1e7,Oe=7,J=9007199254740991,l=X.length-1,w=re.length-1,r={toStringTag:ye};r.absoluteValue=r.abs=function(){var d=new this.constructor(this);return d.s<0&&(d.s=1),R(d)},r.ceil=function(){return R(new this.constructor(this),this.e+1,2)},r.clampedTo=r.clamp=function(d,M){var A,I=this,U=I.constructor;if(d=new U(d),M=new U(M),!d.s||!M.s)return new U(NaN);if(d.gt(M))throw Error(Re+M);return A=I.cmp(d),A<0?d:I.cmp(M)>0?M:new U(I)},r.comparedTo=r.cmp=function(d){var M,A,I,U,L=this,Q=L.d,se=(d=new L.constructor(d)).d,he=L.s,le=d.s;if(!Q||!se)return!he||!le?NaN:he!==le?he:Q===se?0:!Q^he<0?1:-1;if(!Q[0]||!se[0])return Q[0]?he:se[0]?-le:0;if(he!==le)return he;if(L.e!==d.e)return L.e>d.e^he<0?1:-1;for(I=Q.length,U=se.length,M=0,A=I<U?I:U;M<A;++M)if(Q[M]!==se[M])return Q[M]>se[M]^he<0?1:-1;return I===U?0:I>U^he<0?1:-1},r.cosine=r.cos=function(){var d,M,A=this,I=A.constructor;return A.d?A.d[0]?(d=I.precision,M=I.rounding,I.precision=d+Math.max(A.e,A.sd())+Oe,I.rounding=1,A=B(I,H(I,A)),I.precision=d,I.rounding=M,R(c==2||c==3?A.neg():A,d,M,!0)):new I(1):new I(NaN)},r.cubeRoot=r.cbrt=function(){var d,M,A,I,U,L,Q,se,he,le,Me=this,Ae=Me.constructor;if(!Me.isFinite()||Me.isZero())return new Ae(Me);for(te=!1,L=Me.s*W(Me.s*Me,1/3),!L||Math.abs(L)==1/0?(A=m(Me.d),d=Me.e,(L=(d-A.length+1)%3)&&(A+=L==1||L==-2?"0":"00"),L=W(A,1/3),d=Se((d+1)/3)-(d%3==(d<0?-1:2)),L==1/0?A="5e"+d:(A=L.toExponential(),A=A.slice(0,A.indexOf("e")+1)+d),I=new Ae(A),I.s=Me.s):I=new Ae(L.toString()),Q=(d=Ae.precision)+3;;)if(se=I,he=se.times(se).times(se),le=he.plus(Me),I=F(le.plus(Me).times(se),le.plus(he),Q+2,1),m(se.d).slice(0,Q)===(A=m(I.d)).slice(0,Q))if(A=A.slice(Q-3,Q+1),A=="9999"||!U&&A=="4999"){if(!U&&(R(se,d+1,0),se.times(se).times(se).eq(Me))){I=se;break}Q+=4,U=1}else{(!+A||!+A.slice(1)&&A.charAt(0)=="5")&&(R(I,d+1,1),M=!I.times(I).times(I).eq(Me));break}return te=!0,R(I,d,Ae.rounding,M)},r.decimalPlaces=r.dp=function(){var d,M=this.d,A=NaN;if(M){if(d=M.length-1,A=(d-Se(this.e/Oe))*Oe,d=M[d],d)for(;d%10==0;d/=10)A--;A<0&&(A=0)}return A},r.dividedBy=r.div=function(d){return F(this,new this.constructor(d))},r.dividedToIntegerBy=r.divToInt=function(d){var M=this,A=M.constructor;return R(F(M,new A(d),0,1,1),A.precision,A.rounding)},r.equals=r.eq=function(d){return this.cmp(d)===0},r.floor=function(){return R(new this.constructor(this),this.e+1,3)},r.greaterThan=r.gt=function(d){return this.cmp(d)>0},r.greaterThanOrEqualTo=r.gte=function(d){var M=this.cmp(d);return M==1||M===0},r.hyperbolicCosine=r.cosh=function(){var d,M,A,I,U,L=this,Q=L.constructor,se=new Q(1);if(!L.isFinite())return new Q(L.s?1/0:NaN);if(L.isZero())return se;A=Q.precision,I=Q.rounding,Q.precision=A+Math.max(L.e,L.sd())+4,Q.rounding=1,U=L.d.length,U<32?(d=Math.ceil(U/3),M=(1/b(4,d)).toString()):(d=16,M="2.3283064365386962890625e-10"),L=Te(Q,1,L.times(M),new Q(1),!0);for(var he,le=d,Me=new Q(8);le--;)he=L.times(L),L=se.minus(he.times(Me.minus(he.times(Me))));return R(L,Q.precision=A,Q.rounding=I,!0)},r.hyperbolicSine=r.sinh=function(){var d,M,A,I,U=this,L=U.constructor;if(!U.isFinite()||U.isZero())return new L(U);if(M=L.precision,A=L.rounding,L.precision=M+Math.max(U.e,U.sd())+4,L.rounding=1,I=U.d.length,I<3)U=Te(L,2,U,U,!0);else{d=1.4*Math.sqrt(I),d=d>16?16:d|0,U=U.times(1/b(5,d)),U=Te(L,2,U,U,!0);for(var Q,se=new L(5),he=new L(16),le=new L(20);d--;)Q=U.times(U),U=U.times(se.plus(Q.times(he.times(Q).plus(le))))}return L.precision=M,L.rounding=A,R(U,M,A,!0)},r.hyperbolicTangent=r.tanh=function(){var d,M,A=this,I=A.constructor;return A.isFinite()?A.isZero()?new I(A):(d=I.precision,M=I.rounding,I.precision=d+7,I.rounding=1,F(A.sinh(),A.cosh(),I.precision=d,I.rounding=M)):new I(A.s)},r.inverseCosine=r.acos=function(){var d=this,M=d.constructor,A=d.abs().cmp(1),I=M.precision,U=M.rounding;return A!==-1?A===0?d.isNeg()?ne(M,I,U):new M(0):new M(NaN):d.isZero()?ne(M,I+4,U).times(.5):(M.precision=I+6,M.rounding=1,d=new M(1).minus(d).div(d.plus(1)).sqrt().atan(),M.precision=I,M.rounding=U,d.times(2))},r.inverseHyperbolicCosine=r.acosh=function(){var d,M,A=this,I=A.constructor;return A.lte(1)?new I(A.eq(1)?0:NaN):A.isFinite()?(d=I.precision,M=I.rounding,I.precision=d+Math.max(Math.abs(A.e),A.sd())+4,I.rounding=1,te=!1,A=A.times(A).minus(1).sqrt().plus(A),te=!0,I.precision=d,I.rounding=M,A.ln()):new I(A)},r.inverseHyperbolicSine=r.asinh=function(){var d,M,A=this,I=A.constructor;return!A.isFinite()||A.isZero()?new I(A):(d=I.precision,M=I.rounding,I.precision=d+2*Math.max(Math.abs(A.e),A.sd())+6,I.rounding=1,te=!1,A=A.times(A).plus(1).sqrt().plus(A),te=!0,I.precision=d,I.rounding=M,A.ln())},r.inverseHyperbolicTangent=r.atanh=function(){var d,M,A,I,U=this,L=U.constructor;return U.isFinite()?U.e>=0?new L(U.abs().eq(1)?U.s/0:U.isZero()?U:NaN):(d=L.precision,M=L.rounding,I=U.sd(),Math.max(I,d)<2*-U.e-1?R(new L(U),d,M,!0):(L.precision=A=I-U.e,U=F(U.plus(1),new L(1).minus(U),A+d,1),L.precision=d+4,L.rounding=1,U=U.ln(),L.precision=d,L.rounding=M,U.times(.5))):new L(NaN)},r.inverseSine=r.asin=function(){var d,M,A,I,U=this,L=U.constructor;return U.isZero()?new L(U):(M=U.abs().cmp(1),A=L.precision,I=L.rounding,M!==-1?M===0?(d=ne(L,A+4,I).times(.5),d.s=U.s,d):new L(NaN):(L.precision=A+6,L.rounding=1,U=U.div(new L(1).minus(U.times(U)).sqrt().plus(1)).atan(),L.precision=A,L.rounding=I,U.times(2)))},r.inverseTangent=r.atan=function(){var d,M,A,I,U,L,Q,se,he,le=this,Me=le.constructor,Ae=Me.precision,ke=Me.rounding;if(le.isFinite()){if(le.isZero())return new Me(le);if(le.abs().eq(1)&&Ae+4<=w)return Q=ne(Me,Ae+4,ke).times(.25),Q.s=le.s,Q}else{if(!le.s)return new Me(NaN);if(Ae+4<=w)return Q=ne(Me,Ae+4,ke).times(.5),Q.s=le.s,Q}for(Me.precision=se=Ae+10,Me.rounding=1,A=Math.min(28,se/Oe+2|0),d=A;d;--d)le=le.div(le.times(le).plus(1).sqrt().plus(1));for(te=!1,M=Math.ceil(se/Oe),I=1,he=le.times(le),Q=new Me(le),U=le;d!==-1;)if(U=U.times(he),L=Q.minus(U.div(I+=2)),U=U.times(he),Q=L.plus(U.div(I+=2)),Q.d[M]!==void 0)for(d=M;Q.d[d]===L.d[d]&&d--;);return A&&(Q=Q.times(2<<A-1)),te=!0,R(Q,Me.precision=Ae,Me.rounding=ke,!0)},r.isFinite=function(){return!!this.d},r.isInteger=r.isInt=function(){return!!this.d&&Se(this.e/Oe)>this.d.length-2},r.isNaN=function(){return!this.s},r.isNegative=r.isNeg=function(){return this.s<0},r.isPositive=r.isPos=function(){return this.s>0},r.isZero=function(){return!!this.d&&this.d[0]===0},r.lessThan=r.lt=function(d){return this.cmp(d)<0},r.lessThanOrEqualTo=r.lte=function(d){return this.cmp(d)<1},r.logarithm=r.log=function(d){var M,A,I,U,L,Q,se,he,le=this,Me=le.constructor,Ae=Me.precision,ke=Me.rounding,nt=5;if(d==null)d=new Me(10),M=!0;else{if(d=new Me(d),A=d.d,d.s<0||!A||!A[0]||d.eq(1))return new Me(NaN);M=d.eq(10)}if(A=le.d,le.s<0||!A||!A[0]||le.eq(1))return new Me(A&&!A[0]?-1/0:le.s!=1?NaN:A?0:1/0);if(M)if(A.length>1)L=!0;else{for(U=A[0];U%10===0;)U/=10;L=U!==1}if(te=!1,se=Ae+nt,Q=He(le,se),I=M?ue(Me,se+10):He(d,se),he=F(Q,I,se,1),y(he.d,U=Ae,ke))do if(se+=10,Q=He(le,se),I=M?ue(Me,se+10):He(d,se),he=F(Q,I,se,1),!L){+m(he.d).slice(U+1,U+15)+1==1e14&&(he=R(he,Ae+1,0));break}while(y(he.d,U+=10,ke));return te=!0,R(he,Ae,ke)},r.minus=r.sub=function(d){var M,A,I,U,L,Q,se,he,le,Me,Ae,ke,nt=this,yt=nt.constructor;if(d=new yt(d),!nt.d||!d.d)return!nt.s||!d.s?d=new yt(NaN):nt.d?d.s=-d.s:d=new yt(d.d||nt.s!==d.s?nt:NaN),d;if(nt.s!=d.s)return d.s=-d.s,nt.plus(d);if(le=nt.d,ke=d.d,se=yt.precision,he=yt.rounding,!le[0]||!ke[0]){if(ke[0])d.s=-d.s;else if(le[0])d=new yt(nt);else return new yt(he===3?-0:0);return te?R(d,se,he):d}if(A=Se(d.e/Oe),Me=Se(nt.e/Oe),le=le.slice(),L=Me-A,L){for(Ae=L<0,Ae?(M=le,L=-L,Q=ke.length):(M=ke,A=Me,Q=le.length),I=Math.max(Math.ceil(se/Oe),Q)+2,L>I&&(L=I,M.length=1),M.reverse(),I=L;I--;)M.push(0);M.reverse()}else{for(I=le.length,Q=ke.length,Ae=I<Q,Ae&&(Q=I),I=0;I<Q;I++)if(le[I]!=ke[I]){Ae=le[I]<ke[I];break}L=0}for(Ae&&(M=le,le=ke,ke=M,d.s=-d.s),Q=le.length,I=ke.length-Q;I>0;--I)le[Q++]=0;for(I=ke.length;I>L;){if(le[--I]<ke[I]){for(U=I;U&&le[--U]===0;)le[U]=et-1;--le[U],le[I]+=et}le[I]-=ke[I]}for(;le[--Q]===0;)le.pop();for(;le[0]===0;le.shift())--A;return le[0]?(d.d=le,d.e=K(le,A),te?R(d,se,he):d):new yt(he===3?-0:0)},r.modulo=r.mod=function(d){var M,A=this,I=A.constructor;return d=new I(d),!A.d||!d.s||d.d&&!d.d[0]?new I(NaN):!d.d||A.d&&!A.d[0]?R(new I(A),I.precision,I.rounding):(te=!1,I.modulo==9?(M=F(A,d.abs(),0,3,1),M.s*=d.s):M=F(A,d,0,I.modulo,1),M=M.times(d),te=!0,A.minus(M))},r.naturalExponential=r.exp=function(){return Fe(this)},r.naturalLogarithm=r.ln=function(){return He(this)},r.negated=r.neg=function(){var d=new this.constructor(this);return d.s=-d.s,R(d)},r.plus=r.add=function(d){var M,A,I,U,L,Q,se,he,le,Me,Ae=this,ke=Ae.constructor;if(d=new ke(d),!Ae.d||!d.d)return!Ae.s||!d.s?d=new ke(NaN):Ae.d||(d=new ke(d.d||Ae.s===d.s?Ae:NaN)),d;if(Ae.s!=d.s)return d.s=-d.s,Ae.minus(d);if(le=Ae.d,Me=d.d,se=ke.precision,he=ke.rounding,!le[0]||!Me[0])return Me[0]||(d=new ke(Ae)),te?R(d,se,he):d;if(L=Se(Ae.e/Oe),I=Se(d.e/Oe),le=le.slice(),U=L-I,U){for(U<0?(A=le,U=-U,Q=Me.length):(A=Me,I=L,Q=le.length),L=Math.ceil(se/Oe),Q=L>Q?L+1:Q+1,U>Q&&(U=Q,A.length=1),A.reverse();U--;)A.push(0);A.reverse()}for(Q=le.length,U=Me.length,Q-U<0&&(U=Q,A=Me,Me=le,le=A),M=0;U;)M=(le[--U]=le[U]+Me[U]+M)/et|0,le[U]%=et;for(M&&(le.unshift(M),++I),Q=le.length;le[--Q]==0;)le.pop();return d.d=le,d.e=K(le,I),te?R(d,se,he):d},r.precision=r.sd=function(d){var M,A=this;if(d!==void 0&&d!==!!d&&d!==1&&d!==0)throw Error(Re+d);return A.d?(M=we(A.d),d&&A.e+1>M&&(M=A.e+1)):M=NaN,M},r.round=function(){var d=this,M=d.constructor;return R(new M(d),d.e+1,M.rounding)},r.sine=r.sin=function(){var d,M,A=this,I=A.constructor;return A.isFinite()?A.isZero()?new I(A):(d=I.precision,M=I.rounding,I.precision=d+Math.max(A.e,A.sd())+Oe,I.rounding=1,A=rt(I,H(I,A)),I.precision=d,I.rounding=M,R(c>2?A.neg():A,d,M,!0)):new I(NaN)},r.squareRoot=r.sqrt=function(){var d,M,A,I,U,L,Q=this,se=Q.d,he=Q.e,le=Q.s,Me=Q.constructor;if(le!==1||!se||!se[0])return new Me(!le||le<0&&(!se||se[0])?NaN:se?Q:1/0);for(te=!1,le=Math.sqrt(+Q),le==0||le==1/0?(M=m(se),(M.length+he)%2==0&&(M+="0"),le=Math.sqrt(M),he=Se((he+1)/2)-(he<0||he%2),le==1/0?M="5e"+he:(M=le.toExponential(),M=M.slice(0,M.indexOf("e")+1)+he),I=new Me(M)):I=new Me(le.toString()),A=(he=Me.precision)+3;;)if(L=I,I=L.plus(F(Q,L,A+2,1)).times(.5),m(L.d).slice(0,A)===(M=m(I.d)).slice(0,A))if(M=M.slice(A-3,A+1),M=="9999"||!U&&M=="4999"){if(!U&&(R(L,he+1,0),L.times(L).eq(Q))){I=L;break}A+=4,U=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(R(I,he+1,1),d=!I.times(I).eq(Q));break}return te=!0,R(I,he,Me.rounding,d)},r.tangent=r.tan=function(){var d,M,A=this,I=A.constructor;return A.isFinite()?A.isZero()?new I(A):(d=I.precision,M=I.rounding,I.precision=d+10,I.rounding=1,A=A.sin(),A.s=1,A=F(A,new I(1).minus(A.times(A)).sqrt(),d+10,0),I.precision=d,I.rounding=M,R(c==2||c==4?A.neg():A,d,M,!0)):new I(NaN)},r.times=r.mul=function(d){var M,A,I,U,L,Q,se,he,le,Me=this,Ae=Me.constructor,ke=Me.d,nt=(d=new Ae(d)).d;if(d.s*=Me.s,!ke||!ke[0]||!nt||!nt[0])return new Ae(!d.s||ke&&!ke[0]&&!nt||nt&&!nt[0]&&!ke?NaN:!ke||!nt?d.s/0:d.s*0);for(A=Se(Me.e/Oe)+Se(d.e/Oe),he=ke.length,le=nt.length,he<le&&(L=ke,ke=nt,nt=L,Q=he,he=le,le=Q),L=[],Q=he+le,I=Q;I--;)L.push(0);for(I=le;--I>=0;){for(M=0,U=he+I;U>I;)se=L[U]+nt[I]*ke[U-I-1]+M,L[U--]=se%et|0,M=se/et|0;L[U]=(L[U]+M)%et|0}for(;!L[--Q];)L.pop();return M?++A:L.shift(),d.d=L,d.e=K(L,A),te?R(d,Ae.precision,Ae.rounding):d},r.toBinary=function(d,M){return j(this,2,d,M)},r.toDecimalPlaces=r.toDP=function(d,M){var A=this,I=A.constructor;return A=new I(A),d===void 0?A:(v(d,0,t),M===void 0?M=I.rounding:v(M,0,8),R(A,d+A.e+1,M))},r.toExponential=function(d,M){var A,I=this,U=I.constructor;return d===void 0?A=V(I,!0):(v(d,0,t),M===void 0?M=U.rounding:v(M,0,8),I=R(new U(I),d+1,M),A=V(I,!0,d+1)),I.isNeg()&&!I.isZero()?"-"+A:A},r.toFixed=function(d,M){var A,I,U=this,L=U.constructor;return d===void 0?A=V(U):(v(d,0,t),M===void 0?M=L.rounding:v(M,0,8),I=R(new L(U),d+U.e+1,M),A=V(I,!1,d+I.e+1)),U.isNeg()&&!U.isZero()?"-"+A:A},r.toFraction=function(d){var M,A,I,U,L,Q,se,he,le,Me,Ae,ke,nt=this,yt=nt.d,at=nt.constructor;if(!yt)return new at(nt);if(le=A=new at(1),I=he=new at(0),M=new at(I),L=M.e=we(yt)-nt.e-1,Q=L%Oe,M.d[0]=W(10,Q<0?Oe+Q:Q),d==null)d=L>0?M:le;else{if(se=new at(d),!se.isInt()||se.lt(le))throw Error(Re+se);d=se.gt(M)?L>0?M:le:se}for(te=!1,se=new at(m(yt)),Me=at.precision,at.precision=L=yt.length*Oe*2;Ae=F(se,M,0,1,1),U=A.plus(Ae.times(I)),U.cmp(d)!=1;)A=I,I=U,U=le,le=he.plus(Ae.times(U)),he=U,U=M,M=se.minus(Ae.times(U)),se=U;return U=F(d.minus(A),I,0,1,1),he=he.plus(U.times(le)),A=A.plus(U.times(I)),he.s=le.s=nt.s,ke=F(le,I,L,1).minus(nt).abs().cmp(F(he,A,L,1).minus(nt).abs())<1?[le,I]:[he,A],at.precision=Me,te=!0,ke},r.toHexadecimal=r.toHex=function(d,M){return j(this,16,d,M)},r.toNearest=function(d,M){var A=this,I=A.constructor;if(A=new I(A),d==null){if(!A.d)return A;d=new I(1),M=I.rounding}else{if(d=new I(d),M===void 0?M=I.rounding:v(M,0,8),!A.d)return d.s?A:d;if(!d.d)return d.s&&(d.s=A.s),d}return d.d[0]?(te=!1,A=F(A,d,0,M,1).times(d),te=!0,R(A)):(d.s=A.s,A=d),A},r.toNumber=function(){return+this},r.toOctal=function(d,M){return j(this,8,d,M)},r.toPower=r.pow=function(d){var M,A,I,U,L,Q,se=this,he=se.constructor,le=+(d=new he(d));if(!se.d||!d.d||!se.d[0]||!d.d[0])return new he(W(+se,le));if(se=new he(se),se.eq(1))return se;if(I=he.precision,L=he.rounding,d.eq(1))return R(se,I,L);if(M=Se(d.e/Oe),M>=d.d.length-1&&(A=le<0?-le:le)<=J)return U=be(he,se,A,I),d.s<0?new he(1).div(U):R(U,I,L);if(Q=se.s,Q<0){if(M<d.d.length-1)return new he(NaN);if((d.d[M]&1)==0&&(Q=1),se.e==0&&se.d[0]==1&&se.d.length==1)return se.s=Q,se}return A=W(+se,le),M=A==0||!isFinite(A)?Se(le*(Math.log("0."+m(se.d))/Math.LN10+se.e+1)):new he(A+"").e,M>he.maxE+1||M<he.minE-1?new he(M>0?Q/0:0):(te=!1,he.rounding=se.s=1,A=Math.min(12,(M+"").length),U=Fe(d.times(He(se,I+A)),I),U.d&&(U=R(U,I+5,1),y(U.d,I,L)&&(M=I+10,U=R(Fe(d.times(He(se,M+A)),M),M+5,1),+m(U.d).slice(I+1,I+15)+1==1e14&&(U=R(U,I+1,0)))),U.s=Q,te=!0,he.rounding=L,R(U,I,L))},r.toPrecision=function(d,M){var A,I=this,U=I.constructor;return d===void 0?A=V(I,I.e<=U.toExpNeg||I.e>=U.toExpPos):(v(d,1,t),M===void 0?M=U.rounding:v(M,0,8),I=R(new U(I),d,M),A=V(I,d<=I.e||I.e<=U.toExpNeg,d)),I.isNeg()&&!I.isZero()?"-"+A:A},r.toSignificantDigits=r.toSD=function(d,M){var A=this,I=A.constructor;return d===void 0?(d=I.precision,M=I.rounding):(v(d,1,t),M===void 0?M=I.rounding:v(M,0,8)),R(new I(A),d,M)},r.toString=function(){var d=this,M=d.constructor,A=V(d,d.e<=M.toExpNeg||d.e>=M.toExpPos);return d.isNeg()&&!d.isZero()?"-"+A:A},r.truncated=r.trunc=function(){return R(new this.constructor(this),this.e+1,1)},r.valueOf=r.toJSON=function(){var d=this,M=d.constructor,A=V(d,d.e<=M.toExpNeg||d.e>=M.toExpPos);return d.isNeg()?"-"+A:A};function m(d){var M,A,I,U=d.length-1,L="",Q=d[0];if(U>0){for(L+=Q,M=1;M<U;M++)I=d[M]+"",A=Oe-I.length,A&&(L+=me(A)),L+=I;Q=d[M],I=Q+"",A=Oe-I.length,A&&(L+=me(A))}else if(Q===0)return"0";for(;Q%10===0;)Q/=10;return L+Q}function v(d,M,A){if(d!==~~d||d<M||d>A)throw Error(Re+d)}function y(d,M,A,I){var U,L,Q,se;for(L=d[0];L>=10;L/=10)--M;return--M<0?(M+=Oe,U=0):(U=Math.ceil((M+1)/Oe),M%=Oe),L=W(10,Oe-M),se=d[U]%L|0,I==null?M<3?(M==0?se=se/100|0:M==1&&(se=se/10|0),Q=A<4&&se==99999||A>3&&se==49999||se==5e4||se==0):Q=(A<4&&se+1==L||A>3&&se+1==L/2)&&(d[U+1]/L/100|0)==W(10,M-2)-1||(se==L/2||se==0)&&(d[U+1]/L/100|0)==0:M<4?(M==0?se=se/1e3|0:M==1?se=se/100|0:M==2&&(se=se/10|0),Q=(I||A<4)&&se==9999||!I&&A>3&&se==4999):Q=((I||A<4)&&se+1==L||!I&&A>3&&se+1==L/2)&&(d[U+1]/L/1e3|0)==W(10,M-3)-1,Q}function _(d,M,A){for(var I,U=[0],L,Q=0,se=d.length;Q<se;){for(L=U.length;L--;)U[L]*=M;for(U[0]+=T.indexOf(d.charAt(Q++)),I=0;I<U.length;I++)U[I]>A-1&&(U[I+1]===void 0&&(U[I+1]=0),U[I+1]+=U[I]/A|0,U[I]%=A)}return U.reverse()}function B(d,M){var A,I,U;if(M.isZero())return M;I=M.d.length,I<32?(A=Math.ceil(I/3),U=(1/b(4,A)).toString()):(A=16,U="2.3283064365386962890625e-10"),d.precision+=A,M=Te(d,1,M.times(U),new d(1));for(var L=A;L--;){var Q=M.times(M);M=Q.times(Q).minus(Q).times(8).plus(1)}return d.precision-=A,M}var F=(function(){function d(I,U,L){var Q,se=0,he=I.length;for(I=I.slice();he--;)Q=I[he]*U+se,I[he]=Q%L|0,se=Q/L|0;return se&&I.unshift(se),I}function M(I,U,L,Q){var se,he;if(L!=Q)he=L>Q?1:-1;else for(se=he=0;se<L;se++)if(I[se]!=U[se]){he=I[se]>U[se]?1:-1;break}return he}function A(I,U,L,Q){for(var se=0;L--;)I[L]-=se,se=I[L]<U[L]?1:0,I[L]=se*Q+I[L]-U[L];for(;!I[0]&&I.length>1;)I.shift()}return function(I,U,L,Q,se,he){var le,Me,Ae,ke,nt,yt,at,Kt,wt,s0,Tt,Zt,R0,f0,B0,L0,I0,V0,o0,U0,x0=I.constructor,G0=I.s==U.s?1:-1,zt=I.d,Lt=U.d;if(!zt||!zt[0]||!Lt||!Lt[0])return new x0(!I.s||!U.s||(zt?Lt&&zt[0]==Lt[0]:!Lt)?NaN:zt&&zt[0]==0||!Lt?G0*0:G0/0);for(he?(nt=1,Me=I.e-U.e):(he=et,nt=Oe,Me=Se(I.e/nt)-Se(U.e/nt)),o0=Lt.length,I0=zt.length,wt=new x0(G0),s0=wt.d=[],Ae=0;Lt[Ae]==(zt[Ae]||0);Ae++);if(Lt[Ae]>(zt[Ae]||0)&&Me--,L==null?(f0=L=x0.precision,Q=x0.rounding):se?f0=L+(I.e-U.e)+1:f0=L,f0<0)s0.push(1),yt=!0;else{if(f0=f0/nt+2|0,Ae=0,o0==1){for(ke=0,Lt=Lt[0],f0++;(Ae<I0||ke)&&f0--;Ae++)B0=ke*he+(zt[Ae]||0),s0[Ae]=B0/Lt|0,ke=B0%Lt|0;yt=ke||Ae<I0}else{for(ke=he/(Lt[0]+1)|0,ke>1&&(Lt=d(Lt,ke,he),zt=d(zt,ke,he),o0=Lt.length,I0=zt.length),L0=o0,Tt=zt.slice(0,o0),Zt=Tt.length;Zt<o0;)Tt[Zt++]=0;U0=Lt.slice(),U0.unshift(0),V0=Lt[0],Lt[1]>=he/2&&++V0;do ke=0,le=M(Lt,Tt,o0,Zt),le<0?(R0=Tt[0],o0!=Zt&&(R0=R0*he+(Tt[1]||0)),ke=R0/V0|0,ke>1?(ke>=he&&(ke=he-1),at=d(Lt,ke,he),Kt=at.length,Zt=Tt.length,le=M(at,Tt,Kt,Zt),le==1&&(ke--,A(at,o0<Kt?U0:Lt,Kt,he))):(ke==0&&(le=ke=1),at=Lt.slice()),Kt=at.length,Kt<Zt&&at.unshift(0),A(Tt,at,Zt,he),le==-1&&(Zt=Tt.length,le=M(Lt,Tt,o0,Zt),le<1&&(ke++,A(Tt,o0<Zt?U0:Lt,Zt,he))),Zt=Tt.length):le===0&&(ke++,Tt=[0]),s0[Ae++]=ke,le&&Tt[0]?Tt[Zt++]=zt[L0]||0:(Tt=[zt[L0]],Zt=1);while((L0++<I0||Tt[0]!==void 0)&&f0--);yt=Tt[0]!==void 0}s0[0]||s0.shift()}if(nt==1)wt.e=Me,ie=yt;else{for(Ae=1,ke=s0[0];ke>=10;ke/=10)Ae++;wt.e=Ae+Me*nt-1,R(wt,se?L+wt.e+1:L,Q,yt)}return wt}})();function R(d,M,A,I){var U,L,Q,se,he,le,Me,Ae,ke,nt=d.constructor;e:if(M!=null){if(Ae=d.d,!Ae)return d;for(U=1,se=Ae[0];se>=10;se/=10)U++;if(L=M-U,L<0)L+=Oe,Q=M,Me=Ae[ke=0],he=Me/W(10,U-Q-1)%10|0;else if(ke=Math.ceil((L+1)/Oe),se=Ae.length,ke>=se)if(I){for(;se++<=ke;)Ae.push(0);Me=he=0,U=1,L%=Oe,Q=L-Oe+1}else break e;else{for(Me=se=Ae[ke],U=1;se>=10;se/=10)U++;L%=Oe,Q=L-Oe+U,he=Q<0?0:Me/W(10,U-Q-1)%10|0}if(I=I||M<0||Ae[ke+1]!==void 0||(Q<0?Me:Me%W(10,U-Q-1)),le=A<4?(he||I)&&(A==0||A==(d.s<0?3:2)):he>5||he==5&&(A==4||I||A==6&&(L>0?Q>0?Me/W(10,U-Q):0:Ae[ke-1])%10&1||A==(d.s<0?8:7)),M<1||!Ae[0])return Ae.length=0,le?(M-=d.e+1,Ae[0]=W(10,(Oe-M%Oe)%Oe),d.e=-M||0):Ae[0]=d.e=0,d;if(L==0?(Ae.length=ke,se=1,ke--):(Ae.length=ke+1,se=W(10,Oe-L),Ae[ke]=Q>0?(Me/W(10,U-Q)%W(10,Q)|0)*se:0),le)for(;;)if(ke==0){for(L=1,Q=Ae[0];Q>=10;Q/=10)L++;for(Q=Ae[0]+=se,se=1;Q>=10;Q/=10)se++;L!=se&&(d.e++,Ae[0]==et&&(Ae[0]=1));break}else{if(Ae[ke]+=se,Ae[ke]!=et)break;Ae[ke--]=0,se=1}for(L=Ae.length;Ae[--L]===0;)Ae.pop()}return te&&(d.e>nt.maxE?(d.d=null,d.e=NaN):d.e<nt.minE&&(d.e=0,d.d=[0])),d}function V(d,M,A){if(!d.isFinite())return it(d);var I,U=d.e,L=m(d.d),Q=L.length;return M?(A&&(I=A-Q)>0?L=L.charAt(0)+"."+L.slice(1)+me(I):Q>1&&(L=L.charAt(0)+"."+L.slice(1)),L=L+(d.e<0?"e":"e+")+d.e):U<0?(L="0."+me(-U-1)+L,A&&(I=A-Q)>0&&(L+=me(I))):U>=Q?(L+=me(U+1-Q),A&&(I=A-U-1)>0&&(L=L+"."+me(I))):((I=U+1)<Q&&(L=L.slice(0,I)+"."+L.slice(I)),A&&(I=A-Q)>0&&(U+1===Q&&(L+="."),L+=me(I))),L}function K(d,M){var A=d[0];for(M*=Oe;A>=10;A/=10)M++;return M}function ue(d,M,A){if(M>l)throw te=!0,A&&(d.precision=A),Error(Ue);return R(new d(X),M,1,!0)}function ne(d,M,A){if(M>w)throw Error(Ue);return R(new d(re),M,A,!0)}function we(d){var M=d.length-1,A=M*Oe+1;if(M=d[M],M){for(;M%10==0;M/=10)A--;for(M=d[0];M>=10;M/=10)A++}return A}function me(d){for(var M="";d--;)M+="0";return M}function be(d,M,A,I){var U,L=new d(1),Q=Math.ceil(I/Oe+4);for(te=!1;;){if(A%2&&(L=L.times(M),O(L.d,Q)&&(U=!0)),A=Se(A/2),A===0){A=L.d.length-1,U&&L.d[A]===0&&++L.d[A];break}M=M.times(M),O(M.d,Q)}return te=!0,L}function ze(d){return d.d[d.d.length-1]&1}function _e(d,M,A){for(var I,U,L=new d(M[0]),Q=0;++Q<M.length;){if(U=new d(M[Q]),!U.s){L=U;break}I=L.cmp(U),(I===A||I===0&&L.s===A)&&(L=U)}return L}function Fe(d,M){var A,I,U,L,Q,se,he,le=0,Me=0,Ae=0,ke=d.constructor,nt=ke.rounding,yt=ke.precision;if(!d.d||!d.d[0]||d.e>17)return new ke(d.d?d.d[0]?d.s<0?0:1/0:1:d.s?d.s<0?0:d:NaN);for(M==null?(te=!1,he=yt):he=M,se=new ke(.03125);d.e>-2;)d=d.times(se),Ae+=5;for(I=Math.log(W(2,Ae))/Math.LN10*2+5|0,he+=I,A=L=Q=new ke(1),ke.precision=he;;){if(L=R(L.times(d),he,1),A=A.times(++Me),se=Q.plus(F(L,A,he,1)),m(se.d).slice(0,he)===m(Q.d).slice(0,he)){for(U=Ae;U--;)Q=R(Q.times(Q),he,1);if(M==null)if(le<3&&y(Q.d,he-I,nt,le))ke.precision=he+=10,A=L=se=new ke(1),Me=0,le++;else return R(Q,ke.precision=yt,nt,te=!0);else return ke.precision=yt,Q}Q=se}}function He(d,M){var A,I,U,L,Q,se,he,le,Me,Ae,ke,nt=1,yt=10,at=d,Kt=at.d,wt=at.constructor,s0=wt.rounding,Tt=wt.precision;if(at.s<0||!Kt||!Kt[0]||!at.e&&Kt[0]==1&&Kt.length==1)return new wt(Kt&&!Kt[0]?-1/0:at.s!=1?NaN:Kt?0:at);if(M==null?(te=!1,Me=Tt):Me=M,wt.precision=Me+=yt,A=m(Kt),I=A.charAt(0),Math.abs(L=at.e)<15e14){for(;I<7&&I!=1||I==1&&A.charAt(1)>3;)at=at.times(d),A=m(at.d),I=A.charAt(0),nt++;L=at.e,I>1?(at=new wt("0."+A),L++):at=new wt(I+"."+A.slice(1))}else return le=ue(wt,Me+2,Tt).times(L+""),at=He(new wt(I+"."+A.slice(1)),Me-yt).plus(le),wt.precision=Tt,M==null?R(at,Tt,s0,te=!0):at;for(Ae=at,he=Q=at=F(at.minus(1),at.plus(1),Me,1),ke=R(at.times(at),Me,1),U=3;;){if(Q=R(Q.times(ke),Me,1),le=he.plus(F(Q,new wt(U),Me,1)),m(le.d).slice(0,Me)===m(he.d).slice(0,Me))if(he=he.times(2),L!==0&&(he=he.plus(ue(wt,Me+2,Tt).times(L+""))),he=F(he,new wt(nt),Me,1),M==null)if(y(he.d,Me-yt,s0,se))wt.precision=Me+=yt,le=Q=at=F(Ae.minus(1),Ae.plus(1),Me,1),ke=R(at.times(at),Me,1),U=se=1;else return R(he,wt.precision=Tt,s0,te=!0);else return wt.precision=Tt,he;he=le,U+=2}}function it(d){return String(d.s*d.s/0)}function Ge(d,M){var A,I,U;for((A=M.indexOf("."))>-1&&(M=M.replace(".","")),(I=M.search(/e/i))>0?(A<0&&(A=I),A+=+M.slice(I+1),M=M.substring(0,I)):A<0&&(A=M.length),I=0;M.charCodeAt(I)===48;I++);for(U=M.length;M.charCodeAt(U-1)===48;--U);if(M=M.slice(I,U),M){if(U-=I,d.e=A=A-I-1,d.d=[],I=(A+1)%Oe,A<0&&(I+=Oe),I<U){for(I&&d.d.push(+M.slice(0,I)),U-=Oe;I<U;)d.d.push(+M.slice(I,I+=Oe));M=M.slice(I),I=Oe-M.length}else I-=U;for(;I--;)M+="0";d.d.push(+M),te&&(d.e>d.constructor.maxE?(d.d=null,d.e=NaN):d.e<d.constructor.minE&&(d.e=0,d.d=[0]))}else d.e=0,d.d=[0];return d}function Qe(d,M){var A,I,U,L,Q,se,he,le,Me;if(M.indexOf("_")>-1){if(M=M.replace(/(\d)_(?=\d)/g,"$1"),Ve.test(M))return Ge(d,M)}else if(M==="Infinity"||M==="NaN")return+M||(d.s=NaN),d.e=NaN,d.d=null,d;if(qe.test(M))A=16,M=M.toLowerCase();else if(Ce.test(M))A=2;else if(Be.test(M))A=8;else throw Error(Re+M);for(L=M.search(/p/i),L>0?(he=+M.slice(L+1),M=M.substring(2,L)):M=M.slice(2),L=M.indexOf("."),Q=L>=0,I=d.constructor,Q&&(M=M.replace(".",""),se=M.length,L=se-L,U=be(I,new I(A),L,L*2)),le=_(M,A,et),Me=le.length-1,L=Me;le[L]===0;--L)le.pop();return L<0?new I(d.s*0):(d.e=K(le,Me),d.d=le,te=!1,Q&&(d=F(d,U,se*4)),he&&(d=d.times(Math.abs(he)<54?W(2,he):z.pow(2,he))),te=!0,d)}function rt(d,M){var A,I=M.d.length;if(I<3)return M.isZero()?M:Te(d,2,M,M);A=1.4*Math.sqrt(I),A=A>16?16:A|0,M=M.times(1/b(5,A)),M=Te(d,2,M,M);for(var U,L=new d(5),Q=new d(16),se=new d(20);A--;)U=M.times(M),M=M.times(L.plus(U.times(Q.times(U).minus(se))));return M}function Te(d,M,A,I,U){var L,Q,se,he,le=1,Me=d.precision,Ae=Math.ceil(Me/Oe);for(te=!1,he=A.times(A),se=new d(I);;){if(Q=F(se.times(he),new d(M++*M++),Me,1),se=U?I.plus(Q):I.minus(Q),I=F(Q.times(he),new d(M++*M++),Me,1),Q=se.plus(I),Q.d[Ae]!==void 0){for(L=Ae;Q.d[L]===se.d[L]&&L--;);if(L==-1)break}L=se,se=I,I=Q,Q=L,le++}return te=!0,Q.d.length=Ae+1,Q}function b(d,M){for(var A=d;--M;)A*=d;return A}function H(d,M){var A,I=M.s<0,U=ne(d,d.precision,1),L=U.times(.5);if(M=M.abs(),M.lte(L))return c=I?4:1,M;if(A=M.divToInt(U),A.isZero())c=I?3:2;else{if(M=M.minus(A.times(U)),M.lte(L))return c=ze(A)?I?2:3:I?4:1,M;c=ze(A)?I?1:4:I?3:2}return M.minus(U).abs()}function j(d,M,A,I){var U,L,Q,se,he,le,Me,Ae,ke,nt=d.constructor,yt=A!==void 0;if(yt?(v(A,1,t),I===void 0?I=nt.rounding:v(I,0,8)):(A=nt.precision,I=nt.rounding),!d.isFinite())Me=it(d);else{for(Me=V(d),Q=Me.indexOf("."),yt?(U=2,M==16?A=A*4-3:M==8&&(A=A*3-2)):U=M,Q>=0&&(Me=Me.replace(".",""),ke=new nt(1),ke.e=Me.length-Q,ke.d=_(V(ke),10,U),ke.e=ke.d.length),Ae=_(Me,10,U),L=he=Ae.length;Ae[--he]==0;)Ae.pop();if(!Ae[0])Me=yt?"0p+0":"0";else{if(Q<0?L--:(d=new nt(d),d.d=Ae,d.e=L,d=F(d,ke,A,I,0,U),Ae=d.d,L=d.e,le=ie),Q=Ae[A],se=U/2,le=le||Ae[A+1]!==void 0,le=I<4?(Q!==void 0||le)&&(I===0||I===(d.s<0?3:2)):Q>se||Q===se&&(I===4||le||I===6&&Ae[A-1]&1||I===(d.s<0?8:7)),Ae.length=A,le)for(;++Ae[--A]>U-1;)Ae[A]=0,A||(++L,Ae.unshift(1));for(he=Ae.length;!Ae[he-1];--he);for(Q=0,Me="";Q<he;Q++)Me+=T.charAt(Ae[Q]);if(yt){if(he>1)if(M==16||M==8){for(Q=M==16?4:3,--he;he%Q;he++)Me+="0";for(Ae=_(Me,U,M),he=Ae.length;!Ae[he-1];--he);for(Q=1,Me="1.";Q<he;Q++)Me+=T.charAt(Ae[Q])}else Me=Me.charAt(0)+"."+Me.slice(1);Me=Me+(L<0?"p":"p+")+L}else if(L<0){for(;++L;)Me="0"+Me;Me="0."+Me}else if(++L>he)for(L-=he;L--;)Me+="0";else L<he&&(Me=Me.slice(0,L)+"."+Me.slice(L))}Me=(M==16?"0x":M==2?"0b":M==8?"0o":"")+Me}return d.s<0?"-"+Me:Me}function O(d,M){if(d.length>M)return d.length=M,!0}function G(d){return new this(d).abs()}function p(d){return new this(d).acos()}function x(d){return new this(d).acosh()}function de(d,M){return new this(d).plus(M)}function f(d){return new this(d).asin()}function e(d){return new this(d).asinh()}function i(d){return new this(d).atan()}function u(d){return new this(d).atanh()}function g(d,M){d=new this(d),M=new this(M);var A,I=this.precision,U=this.rounding,L=I+4;return!d.s||!M.s?A=new this(NaN):!d.d&&!M.d?(A=ne(this,L,1).times(M.s>0?.25:.75),A.s=d.s):!M.d||d.isZero()?(A=M.s<0?ne(this,I,U):new this(0),A.s=d.s):!d.d||M.isZero()?(A=ne(this,L,1).times(.5),A.s=d.s):M.s<0?(this.precision=L,this.rounding=1,A=this.atan(F(d,M,L,1)),M=ne(this,L,1),this.precision=I,this.rounding=U,A=d.s<0?A.minus(M):A.plus(M)):A=this.atan(F(d,M,L,1)),A}function S(d){return new this(d).cbrt()}function N(d){return R(d=new this(d),d.e+1,2)}function E(d,M,A){return new this(d).clamp(M,A)}function q(d){if(!d||typeof d!="object")throw Error(ot+"Object expected");var M,A,I,U=d.defaults===!0,L=["precision",1,t,"rounding",0,8,"toExpNeg",-n,0,"toExpPos",0,n,"maxE",0,n,"minE",-n,0,"modulo",0,9];for(M=0;M<L.length;M+=3)if(A=L[M],U&&(this[A]=ce[A]),(I=d[A])!==void 0)if(Se(I)===I&&I>=L[M+1]&&I<=L[M+2])this[A]=I;else throw Error(Re+A+": "+I);if(A="crypto",U&&(this[A]=ce[A]),(I=d[A])!==void 0)if(I===!0||I===!1||I===0||I===1)if(I)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[A]=!0;else throw Error(ge);else this[A]=!1;else throw Error(Re+A+": "+I);return this}function C(d){return new this(d).cos()}function P(d){return new this(d).cosh()}function Z(d){var M,A,I;function U(L){var Q,se,he,le=this;if(!(le instanceof U))return new U(L);if(le.constructor=U,Le(L)){le.s=L.s,te?!L.d||L.e>U.maxE?(le.e=NaN,le.d=null):L.e<U.minE?(le.e=0,le.d=[0]):(le.e=L.e,le.d=L.d.slice()):(le.e=L.e,le.d=L.d?L.d.slice():L.d);return}if(he=typeof L,he==="number"){if(L===0){le.s=1/L<0?-1:1,le.e=0,le.d=[0];return}if(L<0?(L=-L,le.s=-1):le.s=1,L===~~L&&L<1e7){for(Q=0,se=L;se>=10;se/=10)Q++;te?Q>U.maxE?(le.e=NaN,le.d=null):Q<U.minE?(le.e=0,le.d=[0]):(le.e=Q,le.d=[L]):(le.e=Q,le.d=[L]);return}if(L*0!==0){L||(le.s=NaN),le.e=NaN,le.d=null;return}return Ge(le,L.toString())}if(he==="string")return(se=L.charCodeAt(0))===45?(L=L.slice(1),le.s=-1):(se===43&&(L=L.slice(1)),le.s=1),Ve.test(L)?Ge(le,L):Qe(le,L);if(he==="bigint")return L<0?(L=-L,le.s=-1):le.s=1,Ge(le,L.toString());throw Error(Re+L)}if(U.prototype=r,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=q,U.clone=Z,U.isDecimal=Le,U.abs=G,U.acos=p,U.acosh=x,U.add=de,U.asin=f,U.asinh=e,U.atan=i,U.atanh=u,U.atan2=g,U.cbrt=S,U.ceil=N,U.clamp=E,U.cos=C,U.cosh=P,U.div=oe,U.exp=pe,U.floor=ae,U.hypot=De,U.ln=Pe,U.log=Ke,U.log10=je,U.log2=$e,U.max=ft,U.min=_t,U.mod=ut,U.mul=Nt,U.pow=It,U.random=Mt,U.round=xt,U.sign=n0,U.sin=a0,U.sinh=u0,U.sqrt=c0,U.sub=Ct,U.sum=d0,U.tan=pt,U.tanh=F0,U.trunc=T0,d===void 0&&(d={}),d&&d.defaults!==!0)for(I=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],M=0;M<I.length;)d.hasOwnProperty(A=I[M++])||(d[A]=this[A]);return U.config(d),U}function oe(d,M){return new this(d).div(M)}function pe(d){return new this(d).exp()}function ae(d){return R(d=new this(d),d.e+1,3)}function De(){var d,M,A=new this(0);for(te=!1,d=0;d<arguments.length;)if(M=new this(arguments[d++]),M.d)A.d&&(A=A.plus(M.times(M)));else{if(M.s)return te=!0,new this(1/0);A=M}return te=!0,A.sqrt()}function Le(d){return d instanceof z||d&&d.toStringTag===ye||!1}function Pe(d){return new this(d).ln()}function Ke(d,M){return new this(d).log(M)}function $e(d){return new this(d).log(2)}function je(d){return new this(d).log(10)}function ft(){return _e(this,arguments,-1)}function _t(){return _e(this,arguments,1)}function ut(d,M){return new this(d).mod(M)}function Nt(d,M){return new this(d).mul(M)}function It(d,M){return new this(d).pow(M)}function Mt(d){var M,A,I,U,L=0,Q=new this(1),se=[];if(d===void 0?d=this.precision:v(d,1,t),I=Math.ceil(d/Oe),this.crypto)if(crypto.getRandomValues)for(M=crypto.getRandomValues(new Uint32Array(I));L<I;)U=M[L],U>=429e7?M[L]=crypto.getRandomValues(new Uint32Array(1))[0]:se[L++]=U%1e7;else if(crypto.randomBytes){for(M=crypto.randomBytes(I*=4);L<I;)U=M[L]+(M[L+1]<<8)+(M[L+2]<<16)+((M[L+3]&127)<<24),U>=214e7?crypto.randomBytes(4).copy(M,L):(se.push(U%1e7),L+=4);L=I/4}else throw Error(ge);else for(;L<I;)se[L++]=Math.random()*1e7|0;for(I=se[--L],d%=Oe,I&&d&&(U=W(10,Oe-d),se[L]=(I/U|0)*U);se[L]===0;L--)se.pop();if(L<0)A=0,se=[0];else{for(A=-1;se[0]===0;A-=Oe)se.shift();for(I=1,U=se[0];U>=10;U/=10)I++;I<Oe&&(A-=Oe-I)}return Q.e=A,Q.d=se,Q}function xt(d){return R(d=new this(d),d.e+1,this.rounding)}function n0(d){return d=new this(d),d.d?d.d[0]?d.s:0*d.s:d.s||NaN}function a0(d){return new this(d).sin()}function u0(d){return new this(d).sinh()}function c0(d){return new this(d).sqrt()}function Ct(d,M){return new this(d).sub(M)}function d0(){var d=0,M=arguments,A=new this(M[d]);for(te=!1;A.s&&++d<M.length;)A=A.plus(M[d]);return te=!0,R(A,this.precision,this.rounding)}function pt(d){return new this(d).tan()}function F0(d){return new this(d).tanh()}function T0(d){return R(d=new this(d),d.e+1,1)}z=Z(ce),z.prototype.constructor=z,z.default=z.Decimal=z,X=new z(X),re=new z(re),typeof define=="function"&&define.amd?define(function(){return z}):typeof i1<"u"&&i1.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(r[Symbol.for("nodejs.util.inspect.custom")]=r.toString,r[Symbol.toStringTag]="Decimal"),i1.exports=z):(h||(h=typeof self<"u"&&self&&self.self==self?self:window),D=h.Decimal,z.noConflict=function(){return h.Decimal=D,z},h.Decimal=z)})(x1)});var P1=w0((Vi,d1)=>{"use strict";var k1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083],D1={};for(let h of k1)D1[h]=!0;var xn="3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196",$n="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901",kn=["-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375","0","24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375","369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000","24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375","399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625","1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777","5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000","76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875","3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375","22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375","14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808","1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625","139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375","1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875","9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000","9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771","5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875","246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375","133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875","705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383","101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625","10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000","1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875","525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375","9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601","407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000","2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625","186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625","664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875","2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032","124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875","827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625","17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375","137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000","746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431","64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375","2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125","74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125","35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131","102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625","10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000","248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375","7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375","3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117","218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000","5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375","15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375","5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625","4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744","38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125","573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875","23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375","58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000","728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093","86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625","2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125","139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125","16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853","34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625","345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000","1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625","274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125","7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889","5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000","2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875","521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625","66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375","335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608","20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625","2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625","31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875","432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000","1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071","5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875","451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625","1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125","3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819","155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375","46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000","3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375","1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625","84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627","802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000","25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875","732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875","22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375","21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688","76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625","40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625","200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375","488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000","8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239","58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625","2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625","27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875","2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797","6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875","82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000","584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625","4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625","3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333","1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000","328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875","2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125","636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125","266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776","3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125","499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375","8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375","51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000","2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687","937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125","5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875","58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625","2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647","150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875","162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000","27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625","1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875","8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037","84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000","1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625","4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625","362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125","8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384","1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125","88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625","752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875","15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000","17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357","39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875","18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625","46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875","23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397","538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875","24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000","166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125","142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625","380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577","79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000","26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625","71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375","342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125","190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288","15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125","36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375","1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625","7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000","15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581","2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125","441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875","91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875","167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473","22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125","1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000","25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875","616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125","979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419","1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000","614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125","106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375","1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625","983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464","30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625","33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875","9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375","396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000","1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357","559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375","365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875","59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125","13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147","1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625","281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000","228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125","2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375","1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733","1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000","158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375","12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375","578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375","8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984","12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625","683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375","1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625","546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000","2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253","6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625","13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625","1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"];typeof d1<"u"&&(d1.exports={PRIMES:k1,PRIMES_SET:D1,LONG_PI:xn,LONG_E:$n,BIG_LOG_CACHE:kn})});var b0=w0((Gi,T1)=>{"use strict";var z1=typeof globalThis.nerdamerBigInt>"u"?U1():globalThis.nerdamerBigInt,W1=typeof globalThis.nerdamerBigDecimal>"u"?$1():globalThis.nerdamerBigDecimal,Dn=typeof globalThis.nerdamerConstants>"u"?P1():globalThis.nerdamerConstants,Q1={convert(h,n){let t=Number(h),T;if(t===0)T=[0,1];else if(Math.abs(t)<1e-6||Math.abs(t)>1e20){let X=this.quickConversion(t);if(X[1]<=1e16){let re=Math.abs(t),ce=t/re;T=this.fullConversion(re.toFixed(`${X[1]}`.length-1)),T[0]*=ce}else T=X}else T=this.fullConversion(t);return T},quickConversion(h){let n=function(T){typeof T!="string"&&(T=T.toString());let X="",re=T.charAt(0);return re==="-"?(T=T.substr(1,T.length),X="-"):re==="+"&&(T=T.substr(1,T.length)),{sign:X,value:T}};function t(T){Vt.isScientific(T)&&(T=j0(T));let X=n(T),re=X.value.split("."),ce;re.length===1?ce=re[0]:ce=re[0]+re[1];let z=re[1]?re[1].length:0,ie=`1${"0".repeat(z)}`;return ce!=="0"&&(ce=ce.replace(/^0+/u,"")),[X.sign+ce,ie]}return t(h)},fullConversion(h){let n=Number(h),t=Math.abs(n)>1e10?1e-16:1e-30,T=!1,X=0,re=1,ce=1,z=0,ie=0,D=n,c,te,ot=1e-14;for(;!T;){ie++;let Re;if(Math.abs(D)>1e10){let ge=Math.round(D);Re=Math.abs(D-ge)/Math.abs(ge)<ot?ge:Math.floor(D)}else Re=Math.floor(D);c=X+Re*ce,te=re+Re*z;let Ue=D-Re;Ue<t&&(T=!0),D=1/Ue,X=ce,re=z,ce=c,z=te,(Math.abs(c/te-n)<t||ie>30)&&(T=!0)}return[c,te]}},Ut={bigInt:z1,bigDec:W1,isInt:()=>!1,scientificToDecimal:()=>"",DivisionByZero:Error,Settings:{PRECISION:21,USE_BIG:!1},Fraction:Q1},Xe=class h{constructor(n){if(this.num,this.den,n instanceof h)return n;if(n===void 0)return this;try{if(Ut.isInt(n))try{this.num=Ut.bigInt(n),this.den=Ut.bigInt(1)}catch(t){if(t.message==="timeout")throw t;return h.simple(n)}else{let t=n instanceof Ut.bigDec?Ut.Fraction.quickConversion(n):Ut.Fraction.convert(n);this.num=new Ut.bigInt(t[0]),this.den=new Ut.bigInt(t[1])}}catch(t){if(t.message==="timeout")throw t;return h.simple(n)}}static create(n){if(n instanceof h)return n;n=n.toString();let t=n.charAt(0)==="-";t&&(n=n.substr(1,n.length-1));let T=new h(n);return t&&T.negate(),T}static isFrac(n){return n instanceof h}static quick(n,t){let T=new h;return T.num=new Ut.bigInt(n),T.den=new Ut.bigInt(t),T}static simple(n){let T=String(Ut.scientificToDecimal(n)).split("."),X=T.join(""),re="1",ce=(T[1]||"").length;for(let ie=0;ie<ce;ie++)re+="0";return h.quick(X,re).simplify()}multiply(n){if(this.isOne())return n.clone();if(n.isOne())return this.clone();let t=this.clone();return t.num=t.num.multiply(n.num),t.den=t.den.multiply(n.den),t.simplify()}divide(n){if(n.equals(0))throw new Ut.DivisionByZero("Division by zero not allowed!");return this.clone().multiply(n.clone().invert()).simplify()}subtract(n){return this.clone().add(n.clone().neg())}sub(n){return this.subtract(n)}neg(){return this.num=this.num.multiply(-1),this}add(n){let t=this.den,T=n.den,X=this.clone(),re=X.num,ce=n.num;return t.equals(T)?X.num=re.add(ce):(X.num=re.multiply(T).add(ce.multiply(t)),X.den=t.multiply(T)),X.simplify()}mod(n){let t=this.clone(),T=n.clone();return t.num=t.num.multiply(T.den),t.den=t.den.multiply(T.den),T.num=T.num.multiply(this.den),T.den=T.den.multiply(this.den),t.num=t.num.mod(T.num),t.simplify()}simplify(){let n=Ut.bigInt.gcd(this.num,this.den);return this.num=this.num.divide(n),this.den=this.den.divide(n),this}clone(){let n=new h;return n.num=new Ut.bigInt(this.num),n.den=new Ut.bigInt(this.den),n}decimal(n){let t=this.num.isNegative()?"-":"";if(this.num.equals(this.den))return"1";n||=Ut.Settings.PRECISION,n+=2;let T=[],X=this.num.abs(),re=this.den,ce;for(ce=0;ce<n;ce++){let D=X.divide(re),c=X.subtract(D.multiply(re));if(T.push(D),c.equals(0))break;X=c.times(10)}let z=T.shift();if(T.length===0)return t+z.toString();if(ce===n){let D=[];for(let c=0;c<2;c++)D.unshift(T.pop());T.push(Math.round(Number(D.join("."))))}let ie=`${z.toString()}.${T.join("")}`;return t+ie}toDecimal(n){return n||=Ut.Settings.PRECISION,n?this.decimal(n):this.num.valueOf()/this.den.valueOf()}qcompare(n){return[this.num.multiply(n.den),n.num.multiply(this.den)]}equals(n){isNaN(n)||(n=new h(n));let t=this.qcompare(n);return t[0].equals(t[1])}absEquals(n){isNaN(n)||(n=new h(n));let t=this.qcompare(n);return t[0].abs().equals(t[1])}greaterThan(n){isNaN(n)||(n=new h(n));let t=this.qcompare(n);return t[0].gt(t[1])}gt(n){return this.greaterThan(n)}gte(n){return this.greaterThan(n)||this.equals(n)}lte(n){return this.lessThan(n)||this.equals(n)}lessThan(n){isNaN(n)||(n=new h(n));let t=this.qcompare(n);return t[0].lt(t[1])}lt(n){return this.lessThan(n)}isInteger(){return this.den.equals(1)}negate(){return this.num=this.num.multiply(-1),this}invert(){let n=this.den;if(!this.num.equals(0)){let t=this.num.isNegative();this.den=this.num.abs(),this.num=n,t&&(this.num=this.num.multiply(-1))}return this}isOne(){return this.num.equals(1)&&this.den.equals(1)}sign(){return this.num.isNegative()?-1:1}abs(){return this.num=this.num.abs(),this}gcd(n){return h.quick(Ut.bigInt.gcd(n.num,this.num),Ut.bigInt.lcm(n.den,this.den))}toString(){return this.den.equals(1)?this.num.toString():`${this.num.toString()}/${this.den.toString()}`}valueOf(){return Ut.Settings.USE_BIG?new Ut.bigDec(this.num.toString()).div(new Ut.bigDec(this.den.toString())):this.num.valueOf()/this.den.valueOf()}isNegative(){return this.toDecimal()<0}contains(n){let t=typeof n=="number"?new h(n):n;return this.mod(t).equals(0)}},D0={isVector:()=>!1,Vector:{fromArray:()=>({})},remove:()=>{}};function g0(h,...n){if(this.elements=[],typeof h>"u")return;let t=h;if(D0.isVector(t)||(t=D0.Vector.fromArray([t,...n])),t){let{elements:T}=t;for(let X=0,re=T.length;X<re;X++)this.add(T[X])}}g0.fromArray=function(n){function t(T){return g0.apply(this,T)}return t.prototype=g0.prototype,new t(n)};g0.prototype={elements:[],add(h){this.contains(h)||this.elements.push(h.clone())},contains(h){for(let n=0;n<this.elements.length;n++){let t=this.elements[n];if(h.equals(t))return!0}return!1},each(h){let{elements:n}=this,t=new g0;for(let T=0,X=n.length;T<X;T++){let re=n[T];h.call(this,re,t,T)}return t},clone(){let h=new g0;return this.each(n=>{h.add(n.clone())}),h},union(h){let n=this.clone();return h.each(t=>{n.add(t)}),n},difference(h){let n=this.clone();return h.each(t=>{n.remove(t)}),n},remove(h){for(let n=0,t=this.elements.length;n<t;n++)if(this.elements[n].equals(h))return D0.remove(this.elements,n),!0;return!1},intersection(h){let n=new g0,t=this;return h.each(T=>{t.contains(T)&&n.add(T)}),n},intersects(h){return this.intersection(h).elements.length>0},isSubset(h){let{elements:n}=h;for(let t=0,T=n.length;t<T;t++)if(!this.contains(n[t]))return!1;return!0},toString(){return`{${this.elements.join(",")}}`}};var y0={_:null,block:()=>{}};function Pt(){this.elements=[]}Pt.prototype.append=function(n){this.elements.push(n)};Pt.prototype.getItems=function(){return this.elements};Pt.prototype.toString=function(){return y0._.prettyPrint(this.elements)};Pt.prototype.dimensions=function(){return this.elements.length};Pt.prototype.text=function(h){return`(${this.elements.map(n=>n.text(h)).join(",")})`};Pt.create=function(n){let t=new Pt;return n&&t.append(n),t};Pt.prototype.clone=function(n){let t=Pt.create();return t.elements=this.elements.map(T=>T.clone()),t};Pt.prototype.expand=function(n){return this.elements=this.elements.map(t=>y0._.expand(t,n)),this};Pt.prototype.evaluate=function(h){return this.elements=this.elements.map(n=>y0._.evaluate(n,h)),this};Pt.prototype.map=function(n){let t=this.clone();return t.elements=t.elements.map((T,X)=>n(T,X+1)),t};Pt.prototype.add=function(n){return y0.block("SAFE",()=>{let t=n.elements||n;return this.elements.length!==t.length?null:this.map((T,X)=>y0._.add(T,t[X-1]))},void 0,this)};Pt.prototype.subtract=function(n){return y0.block("SAFE",()=>{let t=n.elements||n;return this.elements.length!==t.length?null:this.map((T,X)=>y0._.subtract(T,t[X-1]))},void 0,this)};var J1={Settings:{SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0},nround:(h,n)=>Math.round(h*10**n)/10**n};function Vt(h){return this instanceof Vt?(h=String(typeof h>"u"?0:h),h.startsWith("-")?(this.sign=-1,h=h.substr(1,h.length)):this.sign=1,Vt.isScientific(h)?this.fromScientific(h):this.convert(h),this):new Vt(h)}Vt.prototype={fromScientific(h){let n=String(h).toLowerCase().split("e");this.coeff=n[0],this.exponent=Number(n[1]);let t=this.coeff.split(".");this.wholes=t[0]||"",this.dec=t[1]||"";let{dec:T}=this;return this.decp=T==="0"?0:T.length,this},convert(h){let n=h.split("."),t=n[0]||"",T=n[1]||"";t=Vt.removeLeadingZeroes(t),T=Vt.removeTrailingZeroes(T);let X=t.length,re=t+T,ce=Vt.leadingZeroes(re).length;this.exponent=X-(ce+1);let z=Vt.removeLeadingZeroes(re);this.coeff=`${z.charAt(0)}.${Vt.removeTrailingZeroes(z.substr(1,z.length))||"0"}`;let ie=this.coeff.split(".")[1]||"";return this.decp=ie==="0"?0:ie.length,this.dec=T,this.wholes=t,this},round(h){let n=this.copy();if(h=Number(h),h===0)n.coeff=n.coeff.charAt(0);else{let t=this.coeff.substring(0,h+1),T=this.coeff.substring(h+1,h+3),X=Number(T.charAt(0));Number(T.charAt(1))>4&&X++,n.coeff=t+X}return n},copy(){let h=new Vt(0);return h.coeff=this.coeff,h.exponent=this.exponent,h.sign=this.sign,h},toString(h){let n;if(J1.Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS&&this.exponent===0&&this.decp<h)this.decp===0&&this.wholes!==void 0?n=this.wholes:n=this.coeff;else{let t=typeof h>"u"?this.coeff:Vt.round(this.coeff,Math.min(h,this.decp||1)),T=this.exponent;t.startsWith("10.")&&(t=typeof h>"u"?t.replace(/^10\./u,"1.0"):Vt.round(t.replace(/^10\./u,"1.0"),Math.min(h,this.decp||1)),T=Number(T)+1),n=this.exponent===0?t:`${t}e${T}`}return(this.sign===-1?"-":"")+n}};Vt.isScientific=function(n){return/\d+\.?\d*e[+-]*\d+/iu.test(n)};Vt.leadingZeroes=function(n){let t=n.match(/^(?<zeros>0*).*$/u);return t?t[1]:""};Vt.removeLeadingZeroes=function(n){let t=n.match(/^0*(?<rest>.*)$/u);return t?t[1]:""};Vt.removeTrailingZeroes=function(n){let t=n.match(/0*$/u);return t?n.substring(0,n.length-t[0].length):""};Vt.round=function(n,t){let T=String(J1.nround(n,t)),X=T.includes(".")?T.split(".").pop():"",re=t-X.length;return re>0&&(T.includes(".")||(T+="."),T+=new Array(re+1).join("0")),T};function t0(h){let n=function(t){this.name=h,this.message=t===void 0?"":t;let T=new Error(this.message);T.name=this.name,this.stack=T.stack};return n.prototype=Object.create(Error.prototype),n}function Ft(h){return Array.isArray(h)}function kt(h){return`(${h})`}function Pn(h,n){return h<0==n<0}function Dt(...h){return h.shift().replace(/\{(?<idx>\d+)\}/gu,(T,X)=>{let re=h[X];return typeof re=="function"?re():re})}function bn(h,n,t){let T=[];t||=1;for(let X=h;X<=n;X++)T.push(X*t);return T}function Fn(h){return h&&String(h)}function Bn(h,n,t,T){return h.substr(0,n)+T+h.substr(t,h.length)}function Vn(h){return h!==void 0&&h.custom}function Gn(h){return Math.max.apply(void 0,h)}function w1(h){return Math.min.apply(void 0,h)}function bt(h){return Number(h)%2===0}function S1(h){return 1/(h%1)%2===0}function v1(h){let n=h.length,t=[];for(let T=0;T<n;T++){let X=h[T];t.indexOf(X)===-1&&t.push(X)}return t}function Xn(h){return[].slice.call(h)}function vt(h){return typeof h=="number"?Number.isInteger(h):typeof h<"u"&&/^[-+]?\d+e?\+?\d*$/gimu.test(h.toString())}function Hn(h,n){if(h.sort(),n.sort(),h.length===n.length){for(let t=0;t<h.length;t++)if(h[t]!==n[t])return!1;return!0}return!1}function jn(h){let n=[],t=h.length;for(let T=0;T<t;T++)n[T]=h[T].clone();return n}function Y1(h){return/^\d+\.?\d*$/u.test(h)}function E0(h,n=14){return vt(h)?Number(h)>=Number.MAX_VALUE?h.toString():Number(h):Math.round(h*10**n)/10**n}function Zn(h,n){n||=20;let t=[],T,X,re;t.push(h[0]);for(let ce=0;ce<h.length-1;ce++){T=h[ce],X=h[ce+1]-T,re=X/n;for(let z=0;z<n;z++)T+=re,t.push(T)}return t}function K1(h,n){if(Ft(h)){let t=h.length;for(let T=0;T<t;T++)n.call(h,T)}else for(let t in h)Object.hasOwn(h,t)&&n.call(h,t)}function q0(h,n){let t;return Ft(h)?t=h.splice(n,1)[0]:(t=h[n],delete h[n]),t}function zn(h,n){let t={};return t[h]=n,t}function Wn(h){for(let n=0;n<h.length;n++)if(!Y1(h[n]))return!1;return!0}function j0(h){let n=Math.sign(h),t=Math.abs(h);if(/\d+\.?\d*e[+-]*\d+/iu.test(String(t))){let X=String(t).toLowerCase().split("e"),re=X.pop(),ce=Math.abs(Number(re)),z=Math.sign(Number(re)),ie=X[0].split(".");if(z===-1)ce-=ie[0].length,ce<0?t=`${ie[0].slice(0,ce)}.${ie[0].slice(ce)}${ie.length===2?ie[1]:""}`:t=`0.${new Array(ce+1).join("0")}${ie.join("")}`;else{let D=ie[1];D&&(ce-=D.length),ce<0?t=`${ie[0]+D.slice(0,ce)}.${D.slice(ce)}`:t=ie.join("")+new Array(ce+1).join("0")}}return n<0?`-${t}`:String(t)}function r1(h){let n=h[0];for(let t=1,T=h.length;t<T;t++)if(!h[t].equals(n))return!1;return!0}function Qn(h,n){typeof n!=="function"&&(n=function(X,re){return X===re});let T=[];for(;h.length;){let X=h[0];if(h.length===1){T.push(X);break}let re=[];T.push(X);for(let ce=1;ce<h.length;ce++){let z=h[ce];n(X,z)||re.push(z)}h=re}return T}function Jn(h,n){let t=h.length,T=[];for(let ce=0;ce<h.length;ce++)T.push([h[ce],n[ce]]);T.sort((ce,z)=>Number(ce[0])-Number(z[0]));let X=[],re=[];for(let ce=0;ce<t;ce++)X.push(T[ce][0]),re.push(T[ce][1]);return[X,re]}var y1=t0("DivisionByZero"),b1=t0("ParseError"),e0=t0("UndefinedError"),N1=t0("OutOfFunctionDomainError"),Yn=t0("MaximumIterationsReached"),I1=t0("NerdamerTypeError"),s1=t0("ParityError"),$0=t0("OperatorError"),Kn=t0("OutOfRangeError"),E1=t0("DimensionError"),en=t0("InvalidVariableNameError"),ei=t0("ValueLimitExceededError"),F1=t0("NerdamerValueError"),ti=t0("SolveError"),ni=t0("InfiniteLoopError"),B1=t0("UnexpectedTokenError");function M1(h){return h instanceof Pt}function V1(h){return h instanceof g0}function o1(h,n,t){let X=Object.keys(h)[0];return n?X:t?{key:X,obj:h[X]}:h[X]}var{keys:q1}=Object,c1={N:1,P:2};function k0(h){return h.group===c1.N||h.group===c1.P}var tn={S:3};function G1(h){return h.group===tn.S&&h.multiplier.equals(1)&&h.power.equals(1)}var nn={N:1};function A1(h){for(let n=0;n<h.length;n++)if(h[n].group!==nn.N)return!1;return!0}var O1={RESERVED:[]};function l1(h){let n=function(t){O1.RESERVED.indexOf(t)===-1&&O1.RESERVED.push(t)};typeof h=="string"?n(h):K1(h,t=>{n(t)})}var P0={RESERVED:[]};function ii(h){let n=P0.RESERVED.indexOf(h);n!==-1&&(P0.RESERVED[n]=void 0)}var f1={ALLOW_CHARS:[],VALIDATION_REGEX:/^[a-z_][a-z\d_]*$/iu};function M0(h,n="variable"){if(f1.ALLOW_CHARS.indexOf(h)!==-1)return;if(!f1.VALIDATION_REGEX.test(h))throw new en(`${h} is not a valid ${n} name`)}var rn={RESERVED:[]};function a1(h){return rn.RESERVED.indexOf(h)!==-1}var W0={WARNINGS:[],SHOW_WARNINGS:!1};function _1(h){W0.WARNINGS.push(h),W0.SHOW_WARNINGS&&console&&console.warn&&console.warn(h)}function ri(){return W0.WARNINGS}var sn={EXPRESSIONS:[]};function si(){return sn.EXPRESSIONS.length}var on={Settings:{}};function oi(h){return on.Settings[h]}function li(h){try{return M0(h),P0.RESERVED.indexOf(h)===-1}catch(n){if(n.message==="timeout")throw n;return!1}}function ai(h){return h?P0.RESERVED:P0.RESERVED.join(", ")}var Q0={_version:"",C:{}};function ui(h){if(h)try{return Q0.C[h].version}catch(n){if(n.message==="timeout")throw n;return`No module named ${h} found!`}return Q0._version}function ci(){return Q0.C}var ln={functions:null};function fi(){return q1(ln.functions)}var an={CONSTANTS:null};function pi(h){return String(an.CONSTANTS[h])}var O0={VARS:null};function hi(h){return O0.VARS[h]}function gi(h,n){h||="text";let t={};if(h==="object")t=O0.VARS;else for(let T in O0.VARS)Object.hasOwn(O0.VARS,T)&&(h==="latex"?t[T]=O0.VARS[T].latex(n):h==="text"&&(t[T]=O0.VARS[T].text(n)));return t}var Yt={_:null,C:null};function mi(h,n){return Yt._.toTeX(h,n)}function di(h){return Yt._.getOperator(h)}function wi(h,n){Yt._.aliasOperator(h,n)}function Si(h,n){Yt._.setOperator(h,n)}function vi(h,n){Yt._.peekers[h]&&Yt._.peekers[h].push(n)}function yi(h,n){let t=Yt._.peekers[h];if(t){let T=t.indexOf(n);T!==-1&&q0(t,T)}}function un(h){return Yt._.tree(Yt._.toRPN(Yt._.tokenize(h)))}function Ni(h){return String(h).split(";").map(n=>Yt._.parse(n))}function Ei(h){return Yt._.tokenize(Yt._.toRPN(h))}function Mi(h,n){return`<div class="tree">
    <ul>
        <li>
${un(h).toHTML(3,n)}
        </li>
    </ul>
</div>`}function Ai(h,n,t){let T=Yt._.functions[h],X=typeof t>"u"?T[1]:t;Yt._.functions[h]=[n(T[0],Yt.C),X]}var Bt={EXPRESSIONS:[],USER_FUNCTIONS:[],LaTeX:{latex:()=>"",parse:()=>""},text:()=>"",functions:{},Math2:{},_:null,Expression:null};function _i(h,n,t){let T=h?{}:[];for(let X=0;X<Bt.EXPRESSIONS.length;X++){let re=n?Bt.LaTeX.latex(Bt.EXPRESSIONS[X],t):Bt.text(Bt.EXPRESSIONS[X],t);h?T[X+1]=re:T.push(re)}return T}function Ii(h,n){let t=h?{}:[];for(let T=0;T<Bt.USER_FUNCTIONS.length;T++){let X,re,ce=Bt.USER_FUNCTIONS[T],z=Bt.functions[ce][2];if(z)({params:X,body:re}=z);else{let c=Bt.Math2[ce].toString();[,X]=/\((?<params>.*?)\)/u.exec(c),X=X.split(",").map(te=>te.trim()),re="{JavaScript}"}let ie=`${ce}(${X.join(", ")})=${re}`,D=Bt.text(ie,n);h?t[T+1]=D:t.push(D)}return t}function qi(h){h=h.replace(/_(?<char>[A-Za-z0-9])/gu,(...t)=>`${t[0]} `),h=h.replace(/\^(?<char>[A-Za-z0-9])/gu,(...t)=>`^{${t[1]}}`),h=h.replace(/(?<cmd>\\[A-Za-z]+)(?<digit>\d)/gu,(...t)=>`${t[1]}{${t[2]}}`),h=h.replace(/(?<cmd>\\[A-Za-z]+\{.*?\})(?<digit>\d)/gu,(...t)=>`${t[1]}{${t[2]}}`);let n=Bt.LaTeX.parse(Bt._.tokenize(h));return new Bt.Expression(Bt._.parse(n))}var i0={libExports:null,VARS:{},_clearFunctions:()=>{},_initConstants:()=>{},clear:null};function Oi(){for(let h in i0.VARS)Object.hasOwn(i0.VARS,h)&&delete i0.VARS[h];return i0.libExports}function Ci(){return i0._clearFunctions(),i0.libExports}function Ti(){return i0.libExports}function Ri(){return i0.clear("all"),i0.libExports}function Li(h){return h.call(i0.libExports),i0.libExports}var Z0={libExports:null,CONSTANTS:{}};function Ui(h,n){if(M0(h),!a1(h))if(n==="delete"||n==="")delete Z0.CONSTANTS[h];else{if(isNaN(n))throw new I1("Constant must be a number!");Z0.CONSTANTS[h]=n}return Z0.libExports}var p0={libExports:null,VARS:{},CONSTANTS:{},parse:()=>null,isSymbol:()=>!1};function xi(h,n){return M0(h),h in p0.CONSTANTS&&Ht(`Cannot set value for constant ${h}`),n==="delete"||n===""?delete p0.VARS[h]:p0.VARS[h]=p0.isSymbol(n)?n:p0.parse(n),p0.libExports}var p1={libExports:null,_setFunction:()=>!1};function $i(h,n,t){if(!p1._setFunction(h,n,t))throw new Error("Failed to set function!");return p1.libExports}var S0={libExports:null,EXPRESSIONS:[]};function X1(h,n=!1){if(h==="all")S0.EXPRESSIONS.length=0;else if(h==="last")S0.EXPRESSIONS.pop();else if(h==="first")S0.EXPRESSIONS.shift();else{let t=h?h-1:S0.EXPRESSIONS.length;n===!0?S0.EXPRESSIONS[t]=void 0:q0(S0.EXPRESSIONS,t)}return S0.libExports}var C0={libExports:null,Settings:null,functions:null};function cn(h){let n=C0.libExports.getCore();if(Ft(h))for(let t=0;t<h.length;t++)h&&cn(h[t]);else if(h&&C0.Settings.exclude.indexOf(h.name)===-1){if(h.dependencies){for(let X=0;X<h.dependencies.length;X++)if(!n[h.dependencies[X]])throw new Error(Dt("{0} requires {1} to be loaded!",h.name,h.dependencies[X]))}let t=h.parent,T=h.build.call(n);if(t){n[t]||(n[h.parent]={});let X=t==="nerdamer"?C0.libExports:n[t];X[h.name]=T}h.visible&&(C0.functions[h.name]=[T,h.numargs])}}var jt={bigDec:null,Settings:null,functions:null,symfunction:null,NerdamerSymbol:null};function C1(h,n){if(typeof h=="object"&&h!==null){let T=h;for(let X in T)Object.hasOwn(T,X)&&C1(X,T[X])}["SAFE"].indexOf(h)!==-1&&Ht(`Cannot modify setting: ${h}`),h==="PRECISION"?(jt.bigDec.set({precision:n}),jt.Settings.PRECISION=n,n>21&&C1("USE_BIG",!0)):h==="USE_LN"&&n===!0?(jt.Settings.LOG="LN",jt.Settings.LOG10="log",jt.functions.log=jt.Settings.LOG_FNS.log10,jt.functions.log[0]=function(X){return X.isConstant()?new jt.NerdamerSymbol(Math.log10(X)):jt.symfunction(jt.Settings.LOG10,[X])},jt.functions.LN=jt.Settings.LOG_FNS.log,delete jt.functions.log10):jt.Settings[h]=n}var h0={libExports:null,functions:null,parse:null,callfunction:null,Expression:null};function ki(h=!1){let n=function(T){return function(...re){for(let ce=0;ce<re.length;ce++)re[ce]=h0.parse(re[ce]);return new h0.Expression(l0("PARSE2NUMBER",()=>h0.callfunction(T,re)))}};for(let t in h0.functions)(!(t in h0.libExports)||h)&&(h0.libExports[t]=n(t))}var fn={suppress_errors:!1};function Ht(h,n=void 0){if(!fn.suppress_errors)throw n?new n(h):new Error(h)}var pn={PRIMES_SET:{}};function z0(h){if(h in pn.PRIMES_SET)return!0;let n=Math.floor(Math.sqrt(h));for(let t=2;t<=n;t++)if(h%t===0)return!1;return!0}var A0={starttime:0,timeout:0,TIMEOUT:800};function H1(){A0.starttime=Date.now(),A0.timeout=A0.TIMEOUT}function j1(){A0.starttime=0}function h1(){if(A0.starttime!==0&&Date.now()>A0.starttime+A0.timeout)throw new Error("timeout")}var v0={PRIMES:[],PRIMES_SET:{}};function Di(h){if(h1(),z0(h))return[h];let n=h,t=1,T=[],X=2220446049250313e-31;for(;t<n;){h1();let re=h/t,ce=Math.floor(re);if(re-ce<=X&&t>1){if(z0(t)&&(v0.PRIMES_SET[t]||(v0.PRIMES.push(t),v0.PRIMES_SET[t]=!0),T.push(t)),z0(ce)){T.push(ce);break}n=ce}t++}return T.sort((re,ce)=>re-ce)}function Z1(h){let n=v0.PRIMES[v0.PRIMES.length-1]||2;for(let t=n;t<h;t++)z0(t)&&v0.PRIMES.push(t),v0.PRIMES_SET[t]=!0}var u1={Settings:{}};function l0(h,n,t=void 0,T=void 0){let X=u1.Settings[h];u1.Settings[h]=t===void 0?!0:!!t;let re=n.call(T);return u1.Settings[h]=X,re}var hn={_:{parse:()=>{}}};function qt(h,n=void 0){return l0("PARSE2NUMBER",()=>hn._.parse(h,n),!0)}var ct={EXPRESSIONS:[],Settings:{EXPRESSION_DECP:5},LaTeX:{latex:()=>""},text:()=>"",variables:()=>[],isVector:()=>!1,isSymbol:()=>!1,isExpression:()=>!1,isNumericSymbol:()=>!1,isFraction:()=>!1,isArray:Ft,_:{parse:()=>{},add:()=>{},subtract:()=>{},multiply:()=>{},divide:()=>{},pow:()=>{},expand:()=>{}},Build:null};function Gt(h){this.symbol=h}Gt.getExpression=function(n,t=void 0){(n==="last"||!n)&&(n=ct.EXPRESSIONS.length),n==="first"&&(n=1);let T=Number(n)-1,X=ct.EXPRESSIONS[T];return X&&new Gt(X)};Gt.prototype={text(h="decimals",n=void 0){n||=ct.Settings.EXPRESSION_DECP;let t=this.symbol;return t.text_?t.text_(h):ct.text(this.symbol,h,void 0,n)},latex(h){return this.symbol.latex?this.symbol.latex(h):ct.LaTeX.latex(this.symbol,h)},valueOf(){return this.symbol.valueOf()},evaluate(...h){if(ct.isVector(this.symbol)&&this.symbol.dimensions()===0)return this;let n=h[0],t,T=1;typeof n=="string"?t=n.charAt(0)==="%"?Gt.getExpression(n.substr(1)).text():n:n instanceof Gt||ct.isSymbol(n)?t=n.text():(t=this.symbol.text(),T--);let X=h[T]||{};return new Gt(l0("PARSE2NUMBER",()=>ct._.parse(t,X),!0))},buildFunction(h){return ct.Build.build(this.symbol,h)},isNumber(){return ct.isNumericSymbol(this.symbol)},isInfinity(){return Math.abs(this.symbol.multiplier.valueOf())===1/0},isImaginary(){return qt(ct._.parse(this.symbol)).isImaginary()},variables(){return ct.variables(this.symbol)},toString(){try{return ct.isArray(this.symbol)?`[${this.symbol.toString()}]`:this.symbol.toString()}catch(h){if(h.message==="timeout")throw h;return""}},toDecimal(h){ct.Settings.precision=h;let n=ct.text(this.symbol,"decimals");return ct.Settings.precision=void 0,n},isFraction(){return ct.isFraction(this.symbol)},isPolynomial(){return this.symbol.isPoly()},sub(h,n){return new Gt(this.symbol.sub(ct._.parse(h),ct._.parse(n)))},operation(h,n){return ct.isExpression(n)?n=n.symbol:ct.isSymbol(n)||(n=ct._.parse(n)),new Gt(ct._[h](this.symbol.clone(),n.clone()))},add(h){return this.operation("add",h)},subtract(h){return this.operation("subtract",h)},multiply(h){return this.operation("multiply",h)},divide(h){return this.operation("divide",h)},pow(h){return this.operation("pow",h)},expand(){return new Gt(ct._.expand(this.symbol))},each(h,n){if(this.symbol.each)this.symbol.each(h,n);else if(ct.isArray(this.symbol))for(let t=0;t<this.symbol.length;t++)h.call(this.symbol,this.symbol[t],t);else h.call(this.symbol)},eq(h){ct.isSymbol(h)||(h=ct._.parse(h));try{return ct._.subtract(this.symbol.clone(),h).equals(0)}catch(n){if(n.message==="timeout")throw n;return!1}},lt(h){ct.isSymbol(h)||(h=ct._.parse(h));try{return qt(ct._.subtract(this.symbol.clone(),h)).lessThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gt(h){ct.isSymbol(h)||(h=ct._.parse(h));try{return qt(ct._.subtract(this.symbol.clone(),h)).greaterThan(0)}catch(n){if(n.message==="timeout")throw n;return!1}},gte(h){return this.gt(h)||this.eq(h)},lte(h){return this.lt(h)||this.eq(h)},numerator(){return new Gt(this.symbol.getNum())},denominator(){return new Gt(this.symbol.getDenom())},hasFunction(h){return this.symbol.containsFunction(h)},contains(h){return this.symbol.contains(h)}};Gt.prototype.toTeX=Gt.prototype.latex;var Je={Frac:Xe,NerdamerSymbol:null,isVector:()=>!1,isArray:Ft,isMatrix:()=>!1,isSymbol:()=>!1,block:l0,_:null,Settings:{PRECISION:1e-14},text:()=>"",LaTeX:null};function At(h,...n){this.multiplier=new Je.Frac(1),Je.isVector(h)?this.elements=h.elements?.slice(0)??[]:Je.isArray(h)?this.elements=h.slice(0):Je.isMatrix(h)?h.elements.length===1?(this.elements=[...h.elements[0]],this.rowVector=!0):h.elements.length>1&&Array.isArray(h.elements[0])&&h.elements[0].length===1&&(this.elements=h.elements.map(t=>t[0]),this.rowVector=!1):typeof h>"u"?this.elements=[]:this.elements=[h,...n]}At.arrayPrefill=function(n,t){let T=[];t||=0;for(let X=0;X<n;X++)T[X]=t;return T};At.fromArray=function(n){let t=new At;return t.elements=n,t};At.fromSet=function(n){return At.fromArray(n.elements)};At.prototype={custom:!0,e(h){return h<1||h>this.elements.length?null:this.elements[h-1]},set(h,n){Je.isSymbol(n)||(n=new Je.NerdamerSymbol(n)),this.elements[h]=n},dimensions(){return this.elements.length},modulus(){return Je.block("SAFE",()=>Je._.pow(this.dot(this.clone()),new Je.NerdamerSymbol(.5)),void 0,this)},eql(h){let n=this.elements.length,t=h.elements||h;if(n!==t.length)return!1;do if(Math.abs(Je._.subtract(this.elements[n-1],t[n-1]).valueOf())>Je.Settings.PRECISION)return!1;while(--n);return!0},clone(){let h=new At,n=this.elements.length;for(let t=0;t<n;t++)h.elements.push(this.elements[t].clone());return h.rowVector=this.rowVector,h},expand(h){return this.elements=this.elements.map(n=>Je._.expand(n,h)),this},map(h){let n=[];return this.each((t,T)=>{n.push(h(t,T))}),new At(n)},each(h){let n=this.elements.length,t=n,T;do T=t-n,h(this.elements[T],T+1);while(--n)},toUnitVector(){return Je.block("SAFE",()=>{let h=this.modulus();return h.valueOf()===0?this.clone():this.map(n=>Je._.divide(n,h))},void 0,this)},angleFrom(h){return Je.block("SAFE",()=>{let n=h.elements||h;if(this.elements.length!==n.length)return null;let T=new Je.NerdamerSymbol(0),X=new Je.NerdamerSymbol(0),re=new Je.NerdamerSymbol(0);this.each((D,c)=>{T=Je._.add(T,Je._.multiply(D,n[c-1])),X=Je._.add(X,Je._.multiply(D,D)),re=Je._.add(re,Je._.multiply(n[c-1],n[c-1]))}),X=Je._.pow(X,new Je.NerdamerSymbol(.5)),re=Je._.pow(re,new Je.NerdamerSymbol(.5));let ce=Je._.multiply(X,re);if(ce.valueOf()===0)return null;let z=Je._.divide(T,ce),ie=z.valueOf();return ie<-1&&(z=-1),ie>1&&(z=1),new Je.NerdamerSymbol(Math.acos(z))},void 0,this)},isParallelTo(h){let n=this.angleFrom(h).valueOf();return n===null?null:n<=Je.Settings.PRECISION},isAntiparallelTo(h){let n=this.angleFrom(h).valueOf();return n===null?null:Math.abs(n-Math.PI)<=Je.Settings.PRECISION},isPerpendicularTo(h){let n=this.dot(h);return n===null?null:Math.abs(n)<=Je.Settings.PRECISION},add(h){return Je.block("SAFE",()=>{let n=h.elements||h;return this.elements.length!==n.length?null:this.map((t,T)=>Je._.add(t,n[T-1]))},void 0,this)},subtract(h){return Je.block("SAFE",()=>{let n=h.elements||h;return this.elements.length!==n.length?null:this.map((t,T)=>Je._.subtract(t,n[T-1]))},void 0,this)},multiply(h){return this.map(n=>n.clone()*h.clone())},x(h){return this.multiply(h)},dot(h){return Je.block("SAFE",()=>{let n=h.elements||h,t=new Je.NerdamerSymbol(0),T=this.elements.length;if(T!==n.length)return null;do t=Je._.add(t,Je._.multiply(this.elements[T-1],n[T-1]));while(--T);return t},void 0,this)},cross(h){let n=h.elements||h;if(this.elements.length!==3||n.length!==3)return null;let t=this.rowVector&&h.rowVector,T=this.elements;return Je.block("SAFE",()=>{let X=new At([Je._.subtract(Je._.multiply(T[1],n[2]),Je._.multiply(T[2],n[1])),Je._.subtract(Je._.multiply(T[2],n[0]),Je._.multiply(T[0],n[2])),Je._.subtract(Je._.multiply(T[0],n[1]),Je._.multiply(T[1],n[0]))]);return X.rowVector=t,X},void 0,this)},toUnitMultiplier(){return this},max(){let h=0,n=this.elements.length,t=n,T;do T=t-n,Math.abs(this.elements[T].valueOf())>Math.abs(h.valueOf())&&(h=this.elements[T]);while(--n);return h},magnitude(){let h=new Je.NerdamerSymbol(0);return this.each(n=>{h=Je._.add(h,Je._.pow(n,new Je.NerdamerSymbol(2)))}),Je._.sqrt(h)},indexOf(h){let n=null,t=this.elements.length,T=t,X;do X=T-t,n===null&&this.elements[X].valueOf()===h.valueOf()&&(n=X+1);while(--t);return n},text_(h,n){let t=Je.text(this,n);return(this.rowVector?"[":"")+t+(this.rowVector?"]":"")},text(h,n){let t=Je.text(this,n);return(this.rowVector?"[":"")+t+(this.rowVector?"]":"")},toString(){return this.text()},latex(h){let n=[];for(let t=0;t<this.elements.length;t++)n.push(Je.LaTeX.latex(this.elements[t],h));return`[${n.join(", ")}]`}};var lt={Frac:Xe,NerdamerSymbol:null,Vector:At,isMatrix:()=>!1,isVector:()=>!1,isArray:Ft,isSymbol:()=>!1,block:l0,_:null,err:()=>{},LaTeX:null};function dt(...h){this.multiplier=new lt.Frac(1);let n=h,t=n.length,T,X=[];if(lt.isMatrix(n))for(T=0;T<t;T++)X.push(n[T].slice(0));else{let re,ce,z;for(T=0;T<t;T++)re=n[T],lt.isVector(re)&&(re=re.elements),lt.isArray(re)||(re=[re]),z=re.length,ce&&ce!==z&&lt.err("Unable to create Matrix. Row dimensions do not match!"),X.push(re),ce=z}this.elements=X}dt.identity=function(n){let t=new dt;for(let T=0;T<n;T++){t.elements.push([]);for(let X=0;X<n;X++)t.set(T,X,T===X?new lt.NerdamerSymbol(1):new lt.NerdamerSymbol(0))}return t};dt.fromArray=function(n){function t(T){return dt.apply(this,T)}return t.prototype=dt.prototype,new t(n)};dt.zeroMatrix=function(n,t){let T=new dt;for(let X=0;X<n;X++)T.elements.push(lt.Vector.arrayPrefill(t,new lt.NerdamerSymbol(0)));return T};dt.prototype={custom:!0,get(h,n){if(this.elements[h])return this.elements[h][n]},map(h,n){let t=new dt;return this.each((T,X,re)=>{t.set(X,re,h.call(t,T),n)}),t},set(h,n,t,T){this.elements[h]||=[],T||lt.isSymbol(t)?this.elements[h][n]=t:this.elements[h][n]=new lt.NerdamerSymbol(t)},cols(){return this.elements[0].length},rows(){return this.elements.length},row(h){return!h||h>this.cols()?[]:this.elements[h-1]},col(h){let n=this.rows(),t=[];if(h>this.cols()||!h)return t;for(let T=0;T<n;T++)t.push(this.elements[T][h-1]);return t},eachElement(h){let n=this.rows(),t=this.cols(),T,X;for(T=0;T<n;T++)for(X=0;X<t;X++)h.call(this,this.elements[T][X],T,X)},determinant(){if(!this.isSquare())return null;let h=this.toRightTriangular(),n=h.elements[0][0],t=h.elements.length-1,T=t,X;do X=T-t+1,n=lt._.multiply(n,h.elements[X][X]);while(--t);return n},isSquare(){return this.elements.length===this.elements[0].length},isSingular(){return this.isSquare()&&this.determinant()===0},augment(h){let n=this.rows(),t=h.rows();n!==t&&lt.err("Cannot augment matrix. Rows don't match.");for(let T=0;T<n;T++)this.elements[T]=this.elements[T].concat(h.elements[T]);return this},clone(){let h=this.rows(),n=this.cols(),t=new dt;for(let T=0;T<h;T++){t.elements[T]=[];for(let X=0;X<n;X++){let re=this.elements[T][X];t.elements[T][X]=lt.isSymbol(re)?re.clone():re}}return t},toUnitMultiplier(){return this},expand(h){return this.eachElement(n=>lt._.expand(n,h)),this},evaluate(h){return this.eachElement(n=>lt._.evaluate(n,h)),this},invert(){return this.isSquare()||lt.err("Matrix is not square!"),lt.block("SAFE",()=>{let h=this.elements.length,n=h,t,T,X=dt.identity(h),re=this.augment(X).toRightTriangular(),ce,z=re.elements[0].length,ie,D,c,te=[],ot;do{t=h-1,D=[],ce=z,te[t]=[],c=re.elements[t][t];do ie=z-ce,ot=lt._.divide(re.elements[t][ie],c.clone()),D.push(ot),ie>=n&&te[t].push(ot);while(--ce);for(re.elements[t]=D,T=0;T<t;T++){D=[],ce=z;do ie=z-ce,D.push(lt._.subtract(re.elements[T][ie].clone(),lt._.multiply(re.elements[t][ie].clone(),re.elements[T][t].clone())));while(--ce);re.elements[T]=D}}while(--h);return dt.fromArray(te)},void 0,this)},toRightTriangular(){return lt.block("SAFE",()=>{let h=this.clone(),n,t,T,X=this.elements.length,re=X,ce,z,ie=this.elements[0].length,D;do{if(ce=re-X,t=h.elements[ce][ce],t.valueOf()===0){for(let c=ce+1;c<re;c++)if(T=h.elements[c][ce],T&&T.valueOf()!==0){n=[],z=ie;do D=ie-z,n.push(lt._.add(h.elements[ce][D].clone(),h.elements[c][D].clone()));while(--z);h.elements[ce]=n;break}}if(t=h.elements[ce][ce],t.valueOf()!==0)for(let c=ce+1;c<re;c++){let te=lt._.divide(h.elements[c][ce].clone(),h.elements[ce][ce].clone());n=[],z=ie;do D=ie-z,n.push(D<=ce?new lt.NerdamerSymbol(0):lt._.subtract(h.elements[c][D].clone(),lt._.multiply(h.elements[ce][D].clone(),te.clone())));while(--z);h.elements[c]=n}}while(--X);return h},void 0,this)},transpose(){let h=this.elements.length,n=this.elements[0].length,t=new dt,T=n,X,re,ce;do{X=n-T,t.elements[X]=[],re=h;do ce=h-re,t.elements[X][ce]=this.elements[ce][X].clone();while(--re)}while(--T);return t},canMultiplyFromLeft(h){let n=lt.isMatrix(h)?h.elements.length:h.length;return this.elements[0].length===n},sameSize(h){return this.rows()===h.rows()&&this.cols()===h.cols()},multiply(h){return lt.block("SAFE",()=>{let n=h.elements||h;if(!this.canMultiplyFromLeft(n)){if(this.sameSize(h)){let Re=new dt,Ue=this.rows();for(let ge=0;ge<Ue;ge++){let ye=lt._.multiply(new lt.Vector(this.elements[ge]),new lt.Vector(h.elements[ge]));Re.elements[ge]=ye.elements}return Re}return null}let t=this.elements.length,T=t,X,re,ce=n[0].length,z,ie=this.elements[0].length,D=[],c,te,ot;do{X=T-t,D[X]=[],re=ce;do{z=ce-re,c=new lt.NerdamerSymbol(0),te=ie;do ot=ie-te,c=lt._.add(c,lt._.multiply(this.elements[X][ot],n[ot][z]));while(--te);D[X][z]=c}while(--re)}while(--t);return dt.fromArray(D)},void 0,this)},add(h,n){let t=new dt;return this.sameSize(h)&&this.eachElement((T,X,re)=>{let ce=lt._.add(T.clone(),h.elements[X][re].clone());n&&(ce=n.call(t,ce,T,h.elements[X][re])),t.set(X,re,ce)}),t},subtract(h,n){let t=new dt;return this.sameSize(h)&&this.eachElement((T,X,re)=>{let ce=lt._.subtract(T.clone(),h.elements[X][re].clone());n&&(ce=n.call(t,ce,T,h.elements[X][re])),t.set(X,re,ce)}),t},negate(){return this.each(h=>h.negate()),this},toVector(){if(this.rows()===1||this.cols()===1){let h=new lt.Vector;return h.elements=this.elements,h}return this},toString(h,n){let t=this.rows(),T=[];h=h===void 0?`
`:h;for(let X=0;X<t;X++)T.push(`[${this.elements[X].map(re=>{let ce=n?re.multiplier.toDecimal():re.toString();return re===void 0?"":ce}).join(",")}]`);return`matrix${kt(T.join(","))}`},text(){return`matrix(${this.elements.map(h=>`[${h.toString("")}]`)})`},latex(h){let n=this.cols(),{elements:t}=this;return Dt("\\begin{vmatrix}{0}\\end{vmatrix}",()=>{let T=[];for(let X in t){if(!Object.hasOwn(t,X))continue;let re=[];for(let ce=0;ce<n;ce++)re.push(lt.LaTeX.latex(t[X][ce],h));T.push(re.join(" & "))}return T.join(" \\cr ")})}};dt.prototype.each=dt.prototype.eachElement;var Jt={Math2:{},Frac:Xe,NerdamerSymbol:null,isInt:()=>!1,nround:(h,n)=>h,even:()=>!1,block:(h,n)=>n(),_:null,variables:()=>[],inBrackets:h=>`(${h})`,FN:5,N:1,S:3,P:2,EX:4,CB:7},r0={dependencies:{},reformat:{},getProperName(h){return{continuedFraction:"continuedFraction"}[h]||h},compileDependencies(h,n){let t=r0.dependencies[h],T=n&&n[1]?n[1]:"",X=n&&n[0]?n[0]:{};for(let re in t){if(typeof t[re]=="object")continue;let ce=re.split("."),z=t[re];if(typeof z=="function"){let ie=z.toString();!ie.startsWith("function")&&!ie.startsWith("(")&&!ie.startsWith("async")&&(ie=`function ${ie}`),z=ie}T+=`let ${ce.length>1?ce[1]:ce[0]}=${z};`,X[re]=ce.pop()}return[X,T]},getArgsDeps(h,n){let{args:t}=h,T=n,X=function(re){re.group===Jt.FN&&(T=r0.compileDependencies(re.fname,T))};for(let re=0;re<t.length;re++)h.args[re].each(X);return T},build(h,n){let{Math2:t,NerdamerSymbol:T,block:X,_:re,variables:ce,inBrackets:z,FN:ie,N:D,S:c,P:te,EX:ot,CB:Re}=Jt;h=X("PARSE2NUMBER",()=>re.parse(h),!0);let Ue=ce(h),ge=[],ye=[],Se=function(qe,Be){qe.fname===""&&(qe=T.unwrapPARENS(qe)),Be||=[];let Ve=[],{group:et}=qe,Oe="",J=function(r){let m=r===Re?"*":"+",v=[];for(let _ in qe.symbols){if(!Object.hasOwn(qe.symbols,_))continue;let B=qe.symbols[_],F=Se(B,Be)[0];B.isComposite()&&(F=z(F)),v.push(F)}let y=v.join(m);return y=y&&!qe.multiplier.equals(1)?z(y):y,y},l=function(r){let m;if(r in Math)m=`Math.${r}`;else{if(r=r0.getProperName(r),ge.indexOf(r)===-1){let v=t[r].toString();!v.startsWith("function")&&!v.startsWith("(")&&!v.startsWith("async")&&(v=`function ${v}`),Be.push(`let ${r} = ${v}; `),ge.push(r)}m=r}return m+=z(qe.args.map(v=>Se(v,Be)[0]).join(",")),m};et===D?Ve.push(qe.multiplier.toDecimal()):qe.multiplier.equals(-1)?Oe="-":qe.multiplier.equals(1)||Ve.push(qe.multiplier.toDecimal());let w;if(et===c||et===te)w=qe.value;else if(et===ie)if(ye=r0.compileDependencies(qe.fname,ye),ye=r0.getArgsDeps(qe,ye),r0.reformat[qe.fname]){let r=r0.reformat[qe.fname](qe,ye);ye=r[1],w=r[0]}else w=l(qe.fname);else if(et===ot){let r=qe.previousGroup;r===D||r===c?w=qe.value:r===ie?(w=l(qe.fname),ye=r0.compileDependencies(qe.fname,ye),ye=r0.getArgsDeps(qe,ye)):w=J(qe.previousGroup)}else w=J(qe.group);if(qe.group!==D&&!qe.power.equals(1)){let r=Se(re.parse(qe.power));Be.push(r[1]),w=`Math.pow${z(`${w},${r[0]}`)}`}return w&&Ve.push(Oe+w),[Ve.join("*"),Be.join("").replace(/\n+\s+/gu," ")]};n&&(Ue=n);let W=Se(h);for(let qe in ye[0]){if(!Object.hasOwn(ye[0],qe))continue;let Be=ye[0][qe];W[1]=W[1].replace(qe,Be),ye[1]=ye[1].replace(qe,Be)}return new Function(...Ue,`${(ye[1]||"")+W[1]} return ${W[0]};`)}},gn=(function(n){let t="1.1.16",{bigInt:T}=n,{bigDec:X}=n;X.set({precision:250});let re={},{PRIMES:ce}=n.constants,{PRIMES_SET:z}=n.constants,ie={},D={callPeekers:!1,init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i",FUNCTION_MODULES:[Math],ALLOW_CHARS:["\u03C0"],USE_MULTICHARACTER_VARS:!0,POWER_OPERATOR:"^",FUNCTION_REGEX:/^\s*(?<fnName>[a-z_][a-z0-9_]*)\((?<fnArgs>[a-z0-9_,\s]*)\)\s*:?=\s*(?<fnBody>.+)\s*$/iu,VALIDATION_REGEX:/^[a-z_ABEZHIKMNoOPTX][0-9a-z_ABEZHIKMNoOPTX]*$/iu,IMPLIED_MULTIPLICATION_REGEX:/(?<coeff>[+\-/*]*[0-9]+)(?<vars>[a-z_ABEZHIKMNoOPTX]+[+\-/*]*)/giu,ALIASES:{\u03C0:"pi","\u221E":"Infinity"},POSITIVE_MULTIPLIERS:!1,CACHE:{},SILENCE_WARNINGS:!1,PRECISION:21,EXPRESSION_DECP:19,DEFAULT_DECP:16,VECTOR:"vector",PARENTHESIS:"parens",SQRT:"sqrt",ABS:"abs",FACTORIAL:"factorial",DOUBLEFACTORIAL:"dfactorial",LONG_PI:n.constants.LONG_PI,LONG_E:n.constants.LONG_E,PI:Math.PI,E:Math.E,LOG:"log",LOG10:"log10",LOG10_LATEX:"log_{10}",LOG2:"log2",LOG2_LATEX:"log_{2}",LOG1P:"log1p",LOG1P_LATEX:"ln\\left( 1 + {0} \\right)",MAX_EXP:2e5,SCIENTIFIC_MAX_DECIMAL_PLACES:14,SCIENTIFIC_IGNORE_ZERO_EXPONENTS:!0,SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT:7,TIMEOUT:800};(function(){D.CACHE.roots={};let i=40,u=40;for(let g=2;g<=i;g++)for(let S=2;S<=u;S++){let N=T(g).pow(S);D.CACHE.roots[`${N}-${S}`]=g}})(),Object.defineProperty(A0,"TIMEOUT",{get:()=>D.TIMEOUT,configurable:!0});let c=null,te=null,ot=null,Re=null,Ue=re.N=1,ge=re.P=2,ye=re.S=3,Se=re.EX=4,W=re.FN=5,Ce=re.PL=6,qe=re.CB=7,Be=re.CP=8,Ve=D.CONST_HASH="#",{PARENTHESIS:et}=D,{SQRT:Oe}=D,{ABS:J}=D,{FACTORIAL:l}=D,{DOUBLEFACTORIAL:w}=D,r=[],m={},v=[],y=[],_=[];Object.defineProperty(fn,"suppress_errors",{get:()=>D.suppress_errors,configurable:!0}),rn.RESERVED=v,W0.WARNINGS=y,Object.defineProperty(W0,"SHOW_WARNINGS",{get:()=>D.SHOW_WARNINGS,configurable:!0}),Object.defineProperty(sn,"EXPRESSIONS",{get:()=>r,configurable:!0}),on.Settings=D,Q0._version=t,Object.defineProperty(Q0,"C",{get:()=>ot,configurable:!0}),f1.ALLOW_CHARS=D.ALLOW_CHARS,f1.VALIDATION_REGEX=D.VALIDATION_REGEX,pn.PRIMES_SET=z,v0.PRIMES=ce,v0.PRIMES_SET=z;let B=function(e){return Re(e)?B(e.multiplier.toDecimal()):Number(e)%1!==0};Re=function(e){return e instanceof p};let F=function(e){return e instanceof Gt},R=function(e,i=null,u=null){if(u||={c:[],add(g){this.c.indexOf(g)===-1&&isNaN(g)&&this.c.push(g)}},Re(e)){let{group:g}=e,S=e.previousGroup;if(g===Se&&R(e.power,i,u),g===Be||g===qe||S===Be||S===qe)for(let N in e.symbols)Object.hasOwn(e.symbols,N)&&R(e.symbols[N],i,u);else if(g===ye||S===ye)e.value==="e"||e.value==="pi"||e.value===D.IMAGINARY||u.add(e.value);else if(g===Ce||S===Ce)R(o1(e.symbols),i,u);else if(g===Se)isNaN(Number(e.value))||u.add(e.value),R(e.power,i,u);else if(g===W&&!i&&e.args)for(let N=0;N<e.args.length;N++)R(e.args[N],i,u)}return u.c.sort()},V=function(e,i){let u=new p(0);for(let g=0;g<e.length;g++){let S=e[g];u=c.add(u,Re(S)?S:c.parse(S))}return i?Number(u):u},K=function(e,i){e=c.expand(e),i||={};let u=function(g,S){i[g]||=new p(0),i[g]=c.add(i[g],S.clone())};return e.each(g=>{g.isConstant("all")?u("constants",g):g.group===ye?u(g.value,g):g.group===W&&(g.fname===J||g.fname==="")?K(g.args[0]):g.group===Se||g.group===W||u(R(g).join(" "),g)}),i},ue=function(e,i){i||=e.length;for(let u=0;u<i;u++)e[u]||(e[u]=new p(0));return e},ne=function(e){return e instanceof At},we=function(e){return e instanceof dt};c1.N=Ue,c1.P=ge,tn.S=ye;let me=function(e){return Re(e)?e.multiplier.lessThan(0):e<0},be=function(e,i,u){let S={},N;for(let E=0;E<u.length;E++)S[u[E]]=new p(Math.floor(Math.random()*5)+1);return l0("PARSE2NUMBER",()=>{N=c.parse(e,S).equals(c.parse(i,S))}),N},ze=function(e,i,u){if(!i){let g=typeof e;if(g==="string"){let S=e;if(!/:?=/u.test(S))return!1;let N=D.FUNCTION_REGEX.exec(S);if(!N)return!1;let[,E,q,C]=N;e=E,i=q.split(",").map(P=>P.trim()),u=C}else if(g==="function"){let S=e,N=S.name;return M0(N),a1(N)?!1:(ot.Math2[N]=S,c.functions[N]=[void 0,S.length],_.includes(N)||_.push(N),!0)}else return!1}return e=e.trim(),M0(e),a1(e)?!1:(i||=R(c.parse(u)),i=i.map(g=>g.trim()),c.functions[e]=[c.mappedFunction,i.length,{name:e,params:i,body:u}],_.includes(e)||_.push(e),!0)},_e=function(){for(let e of _)delete ot.Math2[e],delete c.functions[e]},Fe=function(e){let i,u,g;if(e.group===W&&e.fname===""?(i=p.unwrapPARENS(c.parse(e).toLinear()),u=c.parse(e.power)):e.group===ge&&(i=c.parse(e.value),u=c.parse(e.power)),i&&u&&i.group===Ue&&u.group===Ue&&i.multiplier.isNegative()){g=[];let N=p.toPolarFormArray(qt(e))[0],E=c.arg(i),q=u.multiplier.den.toString(),C=u.multiplier.num.toString(),P="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let Z=0;Z<Number(q);Z++){let oe=qt(c.parse(Dt("(({0})+2*pi*({1}))/({2})",E,Z,q))).multiplier.toDecimal();g.push(qt(c.parse(Dt(P,N,q,D.IMAGINARY,oe,C))))}return At.fromArray(g)}if(e.isConstant(!0,!0)){let S=e.sign(),N=qt(e.abs()),E=c.sqrt(N);g=[E.clone(),E.negate()],S<0&&(g=g.map(q=>c.multiply(q,p.imaginary())))}else g=[c.parse(e)];return At.fromArray(g)},He=function(e,i,u){i=String(i);let g,S;if(e.group===Be){let q=c.expand(e.clone()).stripVar(i);g=c.subtract(e.clone(),q.clone()),S=q}else g=e.clone();let N=g.stripVar(i),E=c.divide(g.clone(),N.clone());return S||=new p(0),u?{a:N,x:E,ax:g,b:S}:[N,E,g,S]},it=function(e){let u="u",g=0,S=R(e);for(;!(v.indexOf(u)===-1&&S.indexOf(u)===-1);)u="u"+g++;for(let N=0,E=v.length;N<=E;N++)if(!v[N]){v[N]=u;break}return u};P0.RESERVED=v;let Ge=function(e){let i=R(e[0],null,null);for(let u=1,g=e.length;u<g;u++)i=i.concat(R(e[u]));return i=v1(i).sort(),i};O1.RESERVED=v,u1.Settings=D;let Qe=function(){let e={};for(let i in c.functions)Object.hasOwn(c.functions,i)&&(e[i]=c.functions[i][0]);return e},rt=function(e,i,u){let g=[];e.each(S=>{let N,E;S.contains(i)?(N=S.stripVar(i),E=c.divide(S.clone(),N.clone()).power.toDecimal()):(N=S,E=0);let q=g[E];g[E]=q?c.add(q,N):N},!0);for(let S=0;S<g.length;S++)g[S]||=new p(0);return g},Te=function(e){if(Ft(e)){let i=new At([]);for(let u=0;u<e.length;u++)i.elements.push(Te(e[u]));return i}return Re(e)?e:c.parse(e)};nn.N=Ue;let b=function(e){for(let i=0;i<e.length;i++)if(!(e[i].isPi()||e[i].isE())&&!e[i].isConstant(!0))return!1;return!0},H=function(e,i,u){(i.isComposite()&&!e.isComposite()||i.isLinear()&&!e.isLinear())&&([e,i]=[i,e]);let g=new p(0);return e.isLinear()?e.each(S=>{if(i.isComposite())i.isLinear()?i.each(N=>{let E=c.multiply(c.parse(S),c.parse(N)),q=c.expand(c.parse(E),u);g=c.add(g,q)},!0):g=c.add(g,c.multiply(S,c.parse(i)));else{let N=c.multiply(c.parse(S),c.parse(i));g=c.add(g,c.expand(N,u))}},!0):g=c.multiply(e,i),g},j={DivisionByZero:y1,ParseError:b1,OutOfFunctionDomainError:N1,UndefinedError:e0,MaximumIterationsReached:Yn,NerdamerTypeError:I1,ParityError:s1,OperatorError:$0,OutOfRangeError:Kn,DimensionError:E1,InvalidVariableNameError:en,ValueLimitExceededError:ei,NerdamerValueError:F1,SolveError:ti,InfiniteLoopError:ni,UnexpectedTokenError:B1},O={csc(e){return 1/Math.sin(e)},sec(e){return 1/Math.cos(e)},cot(e){return 1/Math.tan(e)},acsc(e){return Math.asin(1/e)},asec(e){return Math.acos(1/e)},acot(e){return Math.PI/2-Math.atan(e)},erf(e){let i=1/(1+.5*Math.abs(e)),u=1-i*Math.exp(-e*e-1.26551223+i*(1.00002368+i*(.37409196+i*(.09678418+i*(-.18628806+i*(.27886807+i*(-1.13520398+i*(1.48851587+i*(-.82215223+i*.17087277)))))))));return e>=0?u:-u},diff(e){return function(g){return(e(g+.001)-e(g-.001))/.002}},median(...e){e.sort((u,g)=>u-g);let i=Math.floor(e.length/2);return e.length%2?e[i]:(e[i-1]+e[i])/2},fromContinued(e){let i=e.fractions.slice(),u=1/i.pop();for(let g=0,S=i.length;g<S;g++)u=1/(i.pop()+u);return e.sign*(e.whole+u)},continuedFraction(e,i){i||=20;let u=Math.sign(e),g=Math.abs(e),S=Math.floor(g),N=g-S,E=0,q=!1,C=1e-14,P=1e7,Z,oe,pe={whole:S,sign:u,fractions:[]};for(;!q&&N!==0&&(Z=1/N,oe=Math.floor(Z),!(oe>P&&O.fromContinued(pe)-e<=Number.EPSILON));)pe.fractions.push(oe),N=Z-oe,(N<=C||E>=i-1)&&(q=!0),E++;let ae=pe.fractions.length-1;return pe.fractions[ae]===1&&(pe.fractions.pop(),pe.fractions[--ae]++),pe},bigpow(e,i){e instanceof Xe||(e=Xe.create(e)),i instanceof Xe||(i=Xe.create(i));let u=new Xe(0);if(i.isInteger())u.num=e.num.pow(i.toString()),u.den=e.den.pow(i.toString());else{let g=Xe.create(e.num**i.num),S=Xe.create(e.den**i.num);u.num=O.nthroot(g,i.den.toString()),u.den=O.nthroot(S,i.den)}return u},gamma(e){let u=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*O.gamma(1-e));e-=1;let g=u[0];for(let N=1;N<9;N++)g+=u[N]/(e+N);let S=e+7+.5;return Math.sqrt(2*Math.PI)*S**(e+.5)*Math.exp(-S)*g},bigfactorial(e){let i=new T(1);for(let u=2;u<=e;u++)i=i.times(u);return new Xe(i)},bigLog(e){let i=n.constants.BIG_LOG_CACHE;if(i[e])return Xe.quick.apply(null,i[e].split("/"));e=new Xe(e);let u=80,g=new Xe(0),S=e.subtract(new Xe(1)),N=e.add(new Xe(1));for(let E=0;E<u;E++){let q=new Xe(2*E+1),C=O.bigpow(S.divide(N),q),P=q.clone().invert().multiply(C);g=g.add(P)}return g.multiply(new Xe(2))},factorial(e){let i=e%1===0;if(i&&e<0)return NaN;if(!i)return O.gamma(e+1);let u=1;for(let g=2;g<=e;g++)u*=g;return u},dfactorial(e){let i=new Xe(1);if(vt(e)){let u=e%2===0,g=u?e/2:(e+1)/2;if(u)for(let S=1;S<=g;S++)i=i.multiply(new Xe(2).multiply(new Xe(S)));else for(let S=1;S<=g;S++)i=i.multiply(new Xe(2).multiply(new Xe(S)).subtract(new Xe(1)))}else i=2**((1+2*e-Math.cos(Math.PI*e))/4)*Math.PI**((Math.cos(Math.PI*e)-1)/4)*O.gamma(1+e/2);return i},GCD(...e){let i=v1(e.map(S=>Math.abs(S))).sort(),u=Math.abs(i.shift()),g=i.length;for(;g-- >0;){let S=Math.abs(i.shift());for(;;){if(u%=S,u===0){u=S;break}if(S%=u,S===0)break}}return u},QGCD(...e){let i=e[0];for(let u=1;u<e.length;u++){let g=e[u],S=i.isNegative()&&g.isNegative()?-1:1;i=g.gcd(i),S<0&&i.negate()}return i},LCM(e,i){return e*i/O.GCD(e,i)},pow(e,i){return e<0&&Math.abs(i)<1?1/i%2===0?NaN:-(Math.abs(e)**i):e**i},factor(e){e=Number(e);let i=Math.sign(e);e=Math.abs(e);let u=O.ifactor(e),g=new p;g.symbols={},g.group=qe;for(let S in u){if(!Object.hasOwn(u,S))continue;let N=new p(1);N.group=ge,N.value=S;let E=new p(u[S]);N.power=E,g.symbols[S]=N}return g.updateHash(),e===1&&(g=new p(e)),i<0&&g.negate(),g},sfactor(e,i){i||={};let u=Math.floor(Math.sqrt(e)),g=ce[ce.length-1];u>g&&e<1e6&&Z1(u);let S=ce.length;for(let N=0;N<S;N++){let E=ce[N];for(;e%E===0;)e/=E,i[E]=(i[E]||0)+1}return e>1&&(i[e]=1),i},ifactor(e){let i=new T(e),u=new T(String(e));if(u.equals(0))return{0:1};let g=u.isNegative()?-1:1;u=u.abs();let S={};if(u.lt("65536"))S=O.sfactor(u,S);else{let N=function(E){E.isPrime()?S[E]=(S[E]||0)+1:S=O.sfactor(E,S)};try{let q={value:0},C=function(P,Z,oe){let pe=new T(P),ae=2,De=new T(P),Le=new T(1);for(;Le.equals(1);){for(let Pe=0;Pe<=ae&&Le.equals(1);Pe++){if(oe.value++>1e3)throw new Error("stopping");De=De.pow(2).add(1).mod(Z),Le=T.gcd(De.minus(pe).abs(),Z)}ae*=2,pe=De}return Le.equals(Z)?C(P+1,Z,oe):Le};for(;!u.abs().equals(1);)if(u.isPrime()){N(u);break}else{let P=C(2,u,q);N(P),u=u.divide(P)}}catch(E){if(E.message==="timeout")throw E;S={},N(i)}}if(g===-1){let N=w1(q1(S));S[`-${N}`]=S[N],delete S[N]}return S},boxfactor(e,i){i||=200;let u,g,S=Math.floor(5/12*e),N=0,E=!1;for(;u=Math.floor(e/S),g=e%S,g!==0;){if(E)return[e,1];S=Math.max(g,S-g),N++,E=N>i}return[u,S,N]},fib(e){let i=Math.sign(e);e=Math.abs(e),i=bt(e)?i:Math.abs(i);let u=0,g=1,S=1;for(let N=2;N<=e;N++)S=u+g,u=g,g=S;return S*i},mod(e,i){return e%i},integer_part(e){return Math.sign(e)*Math.floor(Math.abs(e))},simpson(e,i,u,g){let S=function(pe,ae,De){let Le=pe(ae),Pe=1e-12;return isNaN(Le)&&(Le=pe(De===1?ae+Pe:ae-Pe)),Le};g||=1e-4;let N=Math.abs(Math.floor((u-i)/g));N%2!==0&&N++;let E=(u-i)/N,q=S(e,i,1),C=!1,P=i+E,Z,oe;for(let pe=1;pe<N;pe++)Z=C?2:4,oe=Z*S(e,P,1),q+=oe,C=!C,P+=E;return(q+S(e,P,2))*(E/3)},num_integrate(e,i,u,g,S){if(S<0)throw new Error("max depth cannot be negative");function N(C,P,Z,oe,pe,ae,De,Le,Pe,Ke,$e){if($e.nanEncountered)return NaN;let je=Z-P,ft=C(P+je*.25),_t=C(Z-je*.25);if(isNaN(ft)){$e.nanEncountered=!0;return}if(isNaN(_t)){$e.nanEncountered=!0;return}let ut=je*(oe+4*ft+pe)/12,Nt=je*(pe+4*_t+ae)/12,It=ut+Nt,Mt=(It-De)/15;if($e.maxDepthCount>1e3*Pe)return;if(Ke>Pe)return $e.maxDepthCount++,It+Mt;if(Math.abs(Mt)<Le)return It+Mt;let xt=P+je*.5,n0=N(C,P,xt,oe,ft,pe,ut,Le*.5,Pe,Ke+1,$e);if(isNaN(n0))return $e.nanEncountered=!0,NaN;let a0=N(C,xt,Z,pe,_t,ae,Nt,Le*.5,Pe,Ke+1,$e);return isNaN(a0)?($e.nanEncountered=!0,NaN):n0+a0}function E(C,P,Z,oe,pe){let ae={maxDepthCount:0,nanEncountered:!1};oe===void 0&&(oe=1e-9),pe===void 0&&(pe=45);let De=C(P),Le=C(.5*(P+Z)),Pe=C(Z),Ke=(De+4*Le+Pe)*(Z-P)/6,$e=N(C,P,Z,De,Le,Pe,Ke,oe,pe,1,ae);if(ae.maxDepthCount>0&&_1(`integrate-adaptive-simpson: Warning: maximum recursion depth (${pe}) reached ${ae.maxDepthCount} times`),ae.nanEncountered)throw new Error("Function does not converge over interval!");return $e}let q;try{q=E(e,i,u,g,S)}catch(C){if(C.message==="timeout")throw C;return O.simpson(e,i,u)}return E0(q,12)},Ci(e){let u=.5772156649015329,g=0;for(let S=1;S<20;S++){let N=2*S;g+=(-1)**S*e**N/(N*O.factorial(N))}return Math.log(e)+u+g},Si(e){let u=0;for(let g=0;g<20;g++){let S=2*g;u+=(-1)**g*e**(S+1)/((S+1)*O.factorial(S+1))}return u},Ei(e){if(Number(e)===0)return-1/0;let i=30,u=.5772156649015329,g=0;for(let S=1;S<i;S++)g+=e**S/(S*O.factorial(S));return u+Math.abs(Math.log(e))+g},Shi(e){let u=0,g,S;for(let N=0;N<30;N++)g=2*N,S=g+1,u+=e**S/(S*S*O.factorial(g));return u},Chi(e){let u=.5772156649015329,g=function(S){return(Math.cosh(S)-1)/S};return Math.log(e)+u+O.num_integrate(g,.002,e,.001)},Li(e){return O.Ei(O.bigLog(e))},gamma_incomplete(e,i){let u=e-1,g=0,S=i||0;for(let N=0;N<u;N++)g+=S**N/O.factorial(N);return O.factorial(u)*Math.exp(-S)*g},step(e){return e>0?1:e<0?0:.5},rect(e){let i=Math.abs(e);return i===.5?i:i>.5?0:1},sinc(e){return e.equals(0)?1:Math.sin(e)/e},tri(e){return e=Math.abs(e),e>=1?0:1-e},nthroot(e,i){if(e instanceof Xe||(e=new Xe(e.toString())),i instanceof Xe||(i=new Xe(i.toString())),i.equals(1))return e;let u=e.divide(new Xe(2)),g=new Xe(1e-15),S,N,E,q=i.clone().invert(),C=i.subtract(new Xe(1));do{let P=O.bigpow(u,C),Z=q.multiply(e.divide(P).subtract(u)).toDecimal(25);if(S=Xe.create(Z),E)break;u=u.add(S),Z=S.toDecimal(),E=N?N===Z:!1,N=Z}while(S.abs().gte(g));return u},sqrt(e){e instanceof Xe||(e=new Xe(e));let i,u,g,S,N=0,E=!1,q=new Xe(1e-20);i=e.divide(new Xe(2));let C=1e3;do{if(N>C)throw new Error(`Unable to calculate square root for ${e}`);i=i.add(e.divide(i)).divide(new Xe(2)),i=new Xe(i.decimal(30)),u=e.subtract(i.multiply(i)),S=g?g.equals(u):!1,(u.clone().abs().lessThan(q)||S)&&(E=!0),g=u,N++}while(!E);return i}};D.FUNCTION_MODULES.push(O),l1(O),Math.sign||=function(i){return i=Number(i),i===0||isNaN(i)?i:i>0?1:-1},Math.cosh||=function(i){let u=Math.exp(i);return(u+1/u)/2},Math.sech||=function(i){return 1/Math.cosh(i)},Math.csch||=function(i){return 1/Math.sinh(i)},Math.coth||=function(i){return 1/Math.tanh(i)},Math.sinh||=function(i){let u=Math.exp(i);return(u-1/u)/2},Math.tanh||=function(i){if(i===1/0)return 1;if(i===-1/0)return-1;let u=Math.exp(2*i);return(u-1)/(u+1)},Math.asinh||=function(i){return i===-1/0?i:Math.log(i+Math.sqrt(i*i+1))},Math.acosh||=function(i){return Math.log(i+Math.sqrt(i*i-1))},Math.atanh||=function(i){return Math.log((1+i)/(1-i))/2},Math.trunc||=function(i){return isNaN(i)?NaN:i>0?Math.floor(i):Math.ceil(i)};function G(e,i=void 0,u=void 0,g=void 0){let S=i==="hash",N,E=S?void 0:i,q=E==="decimal"||E==="decimals"||E==="decimals_or_scientific";E==="decimals_or_scientific"&&typeof g>"u"&&(g=D.DEFAULT_DECP);function C(P,Z){switch(i){case"decimals":case"decimal":return N||=function(oe){return!1},Z?P.toDecimal(Z):P.valueOf();case"recurring":{N||=function(ut){return ut.indexOf("'")!==-1};let oe=P.toString(),pe=/^-?\d+(?:\/\d+)?$/u.exec(oe);if(pe.length===0)return oe;let ae=pe[0].split("/"),De=!1,Le=Number(ae[0]);Le<0&&(Le=-Le,De=!0);let Pe=Number(ae[1]);Pe||=1;let Ke=Math.floor(Le/Pe),$e=10*(Le-Ke*Pe);for(Ke=`${Ke.toString()}.`;$e&&$e<Pe;)$e*=10,Ke+="0";let je="",ft=[],_t=0;for(;;){if(typeof ft[$e]<"u"){let It=je.slice(0,ft[$e]),Mt=je.slice(ft[$e]),xt=`${Ke+It}'${Mt}'`;return(De?"-":"")+xt.replace("'0'","").replace(/\.$/u,"")}let ut=Math.floor($e/Pe),Nt=$e-ut*Pe;ft[$e]=_t,je+=ut.toString(),_t+=1,$e=10*Nt}}case"mixed":{N||=function(ft){return ft.indexOf("/")!==-1};let oe=P.toString(),pe=/^-?\d+(?:\/\d+)?$/u.exec(oe);if(pe.length===0)return oe;let ae=pe[0].split("/"),De=new T(ae[0]),Le=new T(ae[1]);Le.equals(0)&&(Le=new T(1));let Pe=De.divmod(Le),{quotient:Ke}=Pe,{remainder:$e}=Pe,je=ae[0][0]==="-"||Ke.equals(0)||$e.equals(0)?"":"+";return(Ke.equals(0)?"":Ke.toString())+je+($e.equals(0)?"":`${$e.toString()}/${ae[1]}`)}case"scientific":return N||=function(oe){return!1},new Vt(P.valueOf()).toString(D.SCIENTIFIC_MAX_DECIMAL_PLACES);case"decimals_or_scientific":{N||=function(ae){return!1};let oe=P.valueOf(),pe=new Vt(oe);return Math.abs(pe.exponent)>=D.SCIENTIFIC_SWITCH_FROM_DECIMALS_MIN_EXPONENT?pe.toString(D.SCIENTIFIC_MAX_DECIMAL_PLACES):Z?P.toDecimal(Z):oe}default:return N||=function(oe){return oe.indexOf("/")!==-1},P.toString()}}if(Re(e)){let P="",Z="",oe="",pe=e.group||u,{value:ae}=e;if(!S){let $e=C(e.multiplier);String($e)==="-1"&&String(e.multiplier)==="-1"&&(oe="-",$e="1"),String($e)!=="1"&&(P=$e);let je=e.power?C(e.power):"";String(je)!=="1"&&(Re(je)?Z=G(je,E):Z=je)}switch(pe){case Ue:{P="";let $e;E==="decimals_or_scientific"?$e=C(e.multiplier,g):g&&q?$e=e.multiplier.toDecimal(g):$e=C(e.multiplier),ae=String(e.multiplier)==="-1"?"1":$e,Z="";break}case Ce:ae=e.collectSymbols().map($e=>{let je=G($e,E,u,g);return je==="0"&&(je=""),je}).sort().join("+").replace(/\+-/gu,"-");break;case Be:ae=e.collectSymbols().map($e=>{let je=G($e,E,u,g);return je==="0"&&(je=""),je}).sort().join("+").replace(/\+-/gu,"-");break;case qe:ae=e.collectSymbols($e=>{let je=$e.group;return(je===Ce||je===Be)&&$e.power.equals(1)&&$e.multiplier.equals(1)?kt(G($e,E)):G($e,E)}).join("*");break;case Se:{let $e=e.previousGroup,je=e.power.group;$e===Ce&&(ae=e.collectSymbols(G,E).join("+").replace("+-","-")),!($e===Ue||$e===ye||$e===W)&&!S&&(ae=kt(ae)),(je===Be||je===qe||je===Ce||e.power.multiplier.toString()!=="1")&&Z&&(Z=kt(Z));break}}if(pe===W&&(ae=e.fname+kt(e.args.map($e=>G($e,E)).join(","))),pe===W&&e.fname in ie){let $e=G(e.args[0]),je=G(e.args[1]);e.args[0].isComposite()&&($e=kt($e)),e.args[1].isComposite()&&(je=kt(je)),ae=$e+ie[e.fname]+je}let De=typeof N=="function"?N(Z):!1;if(Z&&pe!==Se&&De&&(Z=kt(Z)),((pe===Be||pe===Ce)&&(P&&String(P)!=="1"||oe==="-")||(pe===qe||pe===Be||pe===Ce)&&Z&&String(Z)!=="1"||!S&&pe===ge&&String(ae)==="-1"||e.fname===et)&&(ae=kt(ae)),g&&(i==="decimal"||(i==="decimals"||i==="decimals_or_scientific")&&P))if(P.toString().includes("e")){if(i!=="decimals_or_scientific"){let $e=Number(P),je=$e.toExponential(),ft=$e.toPrecision(g);P=je.length<ft.length?je:ft}}else P=E0(Number(P),g);let Le=oe+P,Pe=typeof N=="function"?N(P):!1;if(P&&Pe&&(Le=kt(Le)),Number(Z)<0&&(Z=kt(Z)),P&&(Le=`${Le}*`),Z){if(ae==="e"&&D.E_TO_EXP)return`${Le}exp${kt(Z)}`;Z=D.POWER_OPERATOR+Z}pe===Se&&ae.charAt(0)==="-"&&(ae=kt(ae));let Ke=Le+ae;return e.parens&&(Ke=kt(Ke)),Ke+Z}if(ne(e)){let P=e.elements.length,Z=[];for(let oe=0;oe<P;oe++)Z.push(e.elements[oe].text(i));return`[${Z.join(",")}]`}try{return e.toString()}catch(P){if(P.message==="timeout")throw P;return""}}ct.EXPRESSIONS=r,ct.Settings=D,ct.LaTeX=te,ct.text=G,ct.variables=R,ct.isVector=ne,ct.isSymbol=Re,ct.isExpression=F,ct.isNumericSymbol=k0,ct.isFraction=B,ct.isArray=Ft,Ut.bigInt=T,Ut.bigDec=X,Ut.isInt=vt,Ut.scientificToDecimal=j0,Ut.DivisionByZero=y1,Ut.Settings=D;function p(e){h1();let i=e==="Infinity";if(!(this instanceof p))return new p(e);typeof e=="object"&&e!==null&&e instanceof X&&(e=e.toString());let u=String(e);return/^(?<sign>-?\+?\d+)\.?\d*e?-?\+?\d*/iu.test(u)||typeof e=="object"&&e!==null&&e instanceof X?(this.group=Ue,this.value=Ve,this.multiplier=new Xe(e)):(this.group=ye,M0(e),this.value=e,this.multiplier=new Xe(1),this.imaginary=e===D.IMAGINARY,this.isInfinity=i),this.power=new Xe(1),this.args=void 0,this.fname=void 0,this.isImgSymbol=void 0,this}p.imaginary=function(){let i=new p(D.IMAGINARY);return i.imaginary=!0,i},p.infinity=function(i=void 0){let u=new p("Infinity");return i===-1&&u.negate(),u},p.shell=function(i,u){let g=new p(u);return g.group=i,g.symbols={},g.length=0,g},p.unwrapSQRT=function(i,u){let g=i.power;if(i.fname===Oe&&(i.isLinear()||u)){let S=i.args[0].clone();S.power=S.power.multiply(new Xe(1/2)),S.multiplier=S.multiplier.multiply(i.multiplier),i=S,u&&(i.power=g.multiply(new Xe(1/2)))}return i},p.hyp=function(i,u){return i||=new p(0),u||=new p(0),c.sqrt(c.add(c.pow(i.clone(),new p(2)),c.pow(u.clone(),new p(2))))},p.toPolarFormArray=function(i){let u=i.realpart(),g=i.imagpart(),S=p.hyp(u,g),N=u.equals(0)?c.parse("pi/2"):c.trig.atan(c.divide(g,u));return[S,N]},p.unwrapPARENS=function(i){if(i.fname===""){let u=i.args[0];return u.power=u.power.multiply(i.power),u.multiplier=u.multiplier.multiply(i.multiplier),i.fname===""?p.unwrapPARENS(u):u}return i},p.create=function(i,u){return u=u===void 0?1:u,c.parse(`(${i})^(${u})`)},p.prototype={pushMinus(){let e=this;if((this.group===qe||this.group===Be||this.group===Ce)&&this.multiplier.lessThan(0)&&!bt(this.power)){e=this.clone();let i=e.multiplier.clone();i.negate(),e.toUnitMultiplier();for(let u in e.symbols)if(Object.hasOwn(e.symbols,u)&&(e.symbols[u]=e.symbols[u].clone().negate(),e.group===qe))break;e.length>0&&e.each(u=>u.pushMinus()),e=c.parse(e),e=c.multiply(c.parse(i),e)}return e},getNth(e){let i=qt(c.pow(c.parse(this.multiplier),c.parse(String(e)).invert())),u=c.parse(E0(i));return qt(c.pow(u,c.parse(String(e)))).equals(c.parse(this.multiplier))?u:i},isToNth(e){let i=this.getNth(e),u=vt(i),g;return this.group===qe?(g=!0,this.each(S=>{S.isToNth(e)||(g=!1)})):g=this.group===Ue?!0:vt(c.divide(c.parse(this.power),c.parse(e))),u&&g},isSquare(){return this.isToNth(2)},isCube(){return this.isToNth(3)},isSimple(){return this.power.equals(1)&&this.multiplier.equals(1)},powSimp(){if(this.group===qe){let e=[],i=this.multiplier.sign();if(this.each(P=>{let Z=P.power;Re(Z)||Z.equals(1)||e.push(Z)}),e.length===0)return this.clone();let u=new Xe(w1(e)),g=this.multiplier.clone().abs(),S=O.ifactor(g.valueOf()),N=new Xe(1),E=new Xe(1);for(let P in S){if(!Object.hasOwn(S,P))continue;let Z=new Xe(S[P]);Z.lessThan(u)||(Z=Z.divide(u).subtract(new Xe(1)),E=E.multiply(new Xe(P))),N=N.multiply(c.parse(`${kt(P)}^${kt(Z)}`).multiplier)}let q=new p(E);this.each(P=>{P=P.clone(),P.power=P.power.divide(u),q=c.multiply(q,P)});let C=c.symfunction(et,[q]);return C.power=u,C.multiplier=i<0?N.negate():N,C}return this.clone()},equals(e){let i;return Re(e)?i=e:i=new p(e),this.value===i.value&&this.power.equals(i.power)&&this.multiplier.equals(i.multiplier)&&this.group===i.group},abs(){let e=this.clone();return e.multiplier.abs(),e},gt(e){return Re(e)||(e=new p(e)),this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)},gte(e){return Re(e)||(e=new p(e)),this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.greaterThan(e.multiplier)},lt(e){return Re(e)||(e=new p(e)),this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)},lte(e){return Re(e)||(e=new p(e)),this.equals(e)||this.isConstant()&&e.isConstant()&&this.multiplier.lessThan(e.multiplier)},isPoly(e=!1){let i=this.group,u=this.power;if(!vt(u)||Number(u)<0)return!1;if(i===Ue||i===ye||this.isConstant(!0))return!0;let g=R(this);if(i===qe&&g.length===1){let S=g[0];if(!S)return!0;for(let N in this.symbols){if(!Object.hasOwn(this.symbols,N))continue;let E=this.symbols[N];if(E.group===W&&!E.args[0].isConstant()||!E.contains(S)&&!E.isConstant(!0))return!1}return!0}if(this.isComposite()||i===qe&&e){if(!e&&g.length>1)return!1;for(let S in this.symbols)if(!this.symbols[S].isPoly(e))return!1;return!0}return!1},stripVar(e,i=!1){let u;return(this.group===Ce||this.group===ye)&&this.value===e?u=new p(i?0:this.multiplier):this.group===qe&&this.isLinear()?(u=new p(1),this.each(g=>{g.contains(e,!0)||(u=c.multiply(u,g.clone()))}),u.multiplier=u.multiplier.multiply(this.multiplier)):this.group===Be&&!this.isLinear()?u=new p(this.multiplier):this.group===Be&&this.isLinear()?(u=new p(0),this.each(g=>{if(!g.contains(e)){let S=g.clone();S.multiplier=S.multiplier.multiply(this.multiplier),u=c.add(u,S)}}),u.equals(0)&&(u=new p(this.multiplier))):this.group===Se&&this.power.contains(e,!0)?u=new p(this.multiplier):this.group===W&&this.contains(e)?u=new p(this.multiplier):u=this.clone(),u},toArray(e,i){i||={arr:[],add(g,S){let N=this.arr[S];this.arr[S]=N?c.add(N,g):g}};let u=this.group;if(u===ye&&this.contains(e))i.add(new p(this.multiplier),this.power);else if(u===qe){let g=this.stripVar(e),S=c.divide(this.clone(),g.clone()),N=S.isConstant()?0:S.power;i.add(g,N)}else if(u===Ce&&this.value===e)this.each((g,S)=>{i.add(g.stripVar(e),S)});else if(u===Be)this.each(g=>{g.toArray(e,i)});else{if(this.contains(e))throw new I1("Cannot convert to array! Exiting");i.add(this.clone(),0)}i=i.arr;for(let g=0;g<i.length;g++)i[g]||=new p(0);return i},hasFunc(e){let i=this.group===W||this.group===Se;if(i&&!e||i&&this.contains(e))return!0;if(this.symbols){for(let u in this.symbols)if(this.symbols[u].hasFunc(e))return!0}return!1},sub(e,i){e=Re(e)?e.clone():c.parse(e),i=Re(i)?i.clone():c.parse(i),(e.group===Ue||e.group===ge)&&Ht("Cannot substitute a number. Must be a variable");let u=!1,g=e.multiplier.equals(1),S=this.multiplier.clone(),N;if(this.value===e.value&&(this.group!==Ce&&e.group!==Ce||this.group===Ce&&e.group===Ce))(g||e.multiplier.equals(this.multiplier))&&(e.isLinear()?N=i:e.power.equals(this.power)&&(N=i,u=!0),e.multiplier.equals(this.multiplier)&&(S=new Xe(1)));else if(this.group===qe||this.previousGroup===qe)N=new p(1),this.each(E=>{let q=c.parse(E.sub(e,i));N=c.multiply(N,q)});else if(this.isComposite()){let E=this.clone();if(e.isComposite()&&E.isComposite()&&E.isLinear()&&e.isLinear()){let q=function(C,P){for(let Z in C.symbols){if(!Object.hasOwn(C.symbols,Z))continue;let oe=C.symbols[Z];if(oe.isComposite()&&q(oe,P)||oe.equals(P))return!0}return!1};for(let C in e.symbols)if(Object.hasOwn(e.symbols,C)&&!q(E,e.symbols[C]))return E.clone();N=c.add(c.subtract(E.clone(),e),i)}else N=new p(0),E.each(q=>{N=c.add(N,q.sub(e,i))})}else if(this.group===Se)N=c.parse(this.value).sub(e,i);else if(this.group===W){let E=[];for(let q=0;q<this.args.length;q++){let C=this.args[q];Re(C)||(C=c.parse(C)),E.push(C.sub(e,i))}N=c.symfunction(this.fname,E)}if(N){if(!u){let E=this.group===Se?this.power.sub(e,i):c.parse(this.power);N=c.pow(N,E)}return N.multiplier=N.multiplier.multiply(S),N}return this.clone()},isMonomial(){if(this.group===ye)return!0;if(this.group===qe){for(let e in this.symbols)if(this.symbols[e].group!==ye)return!1}else return!1;return!0},isPi(){return this.group===ye&&this.value==="pi"},sign(){return this.multiplier.sign()},isE(){return this.value==="e"},isSQRT(){return this.fname===Oe},isConstant(e,i){if(i&&this.group===qe){for(let u in this.symbols)if(this.symbols[u].isConstant(!0))return!0}if(e==="functions"&&this.isComposite()){let u=!0;return this.each(g=>{g.isConstant(e,i)||(u=!1)},!0),u}if(e==="all"&&(this.isPi()||this.isE()))return!0;if(e&&this.group===W){for(let u=0;u<this.args.length;u++)if(!this.args[u].isConstant(e))return!1;return!0}return e?k0(this):this.value===Ve},isImaginary(){if(this.imaginary)return!0;if(this.symbols){for(let e in this.symbols)if(this.symbols[e].isImaginary())return!0}return!1},realpart(){if(this.isConstant())return this.clone();if(this.imaginary)return new p(0);if(this.isComposite()){let e=new p(0);return this.each(i=>{e=c.add(e,i.realpart())}),e}return this.isImaginary()?new p(0):this.clone()},imagpart(){if(this.group===ye&&this.isImaginary()){let e=this;return this.power.isNegative()&&(e=this.clone(),e.power.negate(),e.multiplier.negate()),new p(e.multiplier)}if(this.isComposite()){let e=new p(0);return this.each(i=>{e=c.add(e,i.imagpart())}),e}return this.group===qe?this.stripVar(D.IMAGINARY):new p(0)},isInteger(){return this.isConstant()&&this.multiplier.isInteger()},isLinear(e){if(e){if(this.isConstant()||!this.contains(e,!0))return!0;if(this.group===ye)return this.value===e?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(let i in this.symbols)if(!this.symbols[i].isLinear(e))return!1;return!0}return this.group===qe?this.symbols[e]?this.symbols[e].isLinear(e):!0:!1}return this.power.equals(1)},containsFunction(e){if(typeof e=="string"&&(e=[e]),this.group===W&&e.indexOf(this.fname)!==-1)return!0;if(this.symbols){for(let i in this.symbols)if(this.symbols[i].containsFunction(e))return!0}return!1},multiplyPower(e){if(this.group===Ue&&this.multiplier.equals(1))return this;let i=this.power;if(this.group!==Se&&Re(e)&&e.group===Ue){let u=e.multiplier;this.group===Ue&&!u.isInteger()&&this.convert(ge),this.power=i.equals(1)?u.clone():i.multiply(u),this.group===ge&&vt(this.power)&&(this.value=Number(this.value)**Number(this.power),this.toLinear(),this.convert(Ue))}else{this.group!==Se&&(i=new p(i),this.convert(Se));let u=c.multiply(i,e);this.power=u}return this},setPower(e,i=!1){if(this.group===Ue&&this.multiplier.equals(1))return this;if(this.group===Se&&!Re(e))this.group=this.previousGroup,delete this.previousGroup,this.group===Ue?(this.multiplier=new Xe(this.value),this.value=Ve):this.power=e;else{let u=!1;Re(e)&&(e.group===Ue?e=e.multiplier:u=!0);let g=u?Se:ge;this.power=e,this.group===Ue&&g&&this.convert(g,i)}return this},isInverse(){return this.group===Se?this.power.multiplier.lessThan(0):Number(this.power)<0},clone(e=void 0){let i=this,u=e||new p(0),g=["value","group","length","previousGroup","imaginary","fname","args","isInfinity","scientific"],S=g.length,N;if(i.symbols){u.symbols={};for(let E in i.symbols)Object.hasOwn(i.symbols,E)&&(u.symbols[E]=i.symbols[E].clone())}for(N=0;N<S;N++)i[g[N]]!==void 0&&(u[g[N]]=i[g[N]]);return u.power=i.power.clone(),u.multiplier=i.multiplier.clone(),i.isConversion&&(u.isConversion=i.isConversion),i.isUnit&&(u.isUnit=i.isUnit),u},toUnitMultiplier(e=!1){return this.multiplier.num=new T(this.multiplier.num.isNegative()&&e?-1:1),this.multiplier.den=new T(1),this},toLinear(){return this.power.equals(1)?this:(this.setPower(new Xe(1)),this)},each(e,i=!1){if(this.symbols)for(let u in this.symbols){if(!Object.hasOwn(this.symbols,u))continue;let g=this.symbols[u];if(g.group===Ce&&i)for(let S in g.symbols)Object.hasOwn(g.symbols,S)&&e.call(u,g.symbols[S],S);else e.call(this,g,u)}else e.call(this,this,this.value)},valueOf(){return this.group===Ue?this.multiplier.valueOf():this.power.equals(0)?1:this.multiplier.equals(0)?0:G(this,"decimals")},contains(e,i=!1){e=String(e);let u=this.group;if(this.value===e)return!0;if(this.symbols){for(let g in this.symbols)if(this.symbols[g].contains(e,i))return!0}if(u===W||this.previousGroup===W){for(let g=0;g<this.args.length;g++)if(this.args[g].contains(e,i))return!0}return u===Se&&(i&&this.power.contains(e,i)||this.value===e)?!0:this.value===e},negate(){return this.multiplier.negate(),(this.group===Be||this.group===Ce)&&this.distributeMultiplier(),this},invert(e=!1,i=!1){return e||(this.multiplier=this.multiplier.invert()),Re(this.power)?this.power.negate():this.group===qe&&i?this.each(u=>u.invert()):this.power&&this.group!==Ue&&this.power.negate(),this},distributeMultiplier(e=!1){let i=e?this.power.absEquals(1):this.power.equals(1);if(this.symbols&&i&&this.group!==qe&&!this.multiplier.equals(1)){for(let u in this.symbols){if(!Object.hasOwn(this.symbols,u))continue;let g=this.symbols[u];g.multiplier=g.multiplier.multiply(this.multiplier),g.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent(){if(!this.power.equals(1)){let e=this.power;for(let i in this.symbols){if(!Object.hasOwn(this.symbols,i))continue;let u=this.symbols[i];u.group===Se?u.power=c.multiply(u.power,new p(e)):Re(this.symbols[i].power)?this.symbols[i].power=c.multiply(this.symbols[i].power,new p(e)):this.symbols[i].power=this.symbols[i].power.multiply(e)}this.toLinear()}return this},convert(e,i=void 0){if(e>W){let u=this.clone();this.symbols={},e===qe?u.toUnitMultiplier():this.toUnitMultiplier(),this.group===W&&(u.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[u.keyForGroup(e)]=u,this.group=e,this.length=1}else if(e===Se)this.group===Ue&&this.multiplier.equals(1)||(this.group!==Se&&(this.previousGroup=this.group),this.group===Ue?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=G(this,"hash"),this.group=Se);else if(e===Ue){let u=this.multiplier.toDecimal();this.symbols&&=void 0,new p(this.group===ge?Number(u)*Number(this.value)**Number(this.power):u).clone(this)}else e===ge&&this.group===Ue&&(this.value=i?this.multiplier.num.toString():Math.abs(Number(this.multiplier.num.toString())),this.toUnitMultiplier(!i),this.group=ge);return this},insert(e,i){if(Re(e)||Ht(`Object ${e} is not of type NerdamerSymbol!`),this.symbols){let{group:u}=this;if(u>W){let g=e.keyForGroup(u),S=g in this.symbols?this.symbols[g]:!1;if(i==="add"){let N=g;S?(this.symbols[N]=c.add(S,e),this.symbols[N].multiplier.equals(0)&&(delete this.symbols[N],this.length--,this.length===0&&(this.convert(Ue),this.multiplier=new Xe(0)))):(this.symbols[g]=e,this.length++)}else e.group===ge&&vt(e.power)&&e.convert(Ue),e.group===Se?(e.parens=e.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(e.multiplier.clone().abs()),e.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(e.multiplier),e.toUnitMultiplier()),S&&(e=c.multiply(q0(this.symbols,g),e),e.isConstant()&&(this.multiplier=this.multiplier.multiply(e.multiplier),e=new p(1)),this.length--),e.isOne(!0)?e.multiplier.lessThan(0)&&this.negate():(this.symbols[g]=e,this.length++);this.length===0&&this.convert(Ue),(this.group===Be||this.group===qe)&&this.updateHash()}}return this},attach(e){if(Ft(e)){for(let i=0;i<e.length;i++)this.insert(e[i],"add");return this}return this.insert(e,"add")},combine(e){if(Ft(e)){for(let i=0;i<e.length;i++)this.insert(e[i],"multiply");return this}return this.insert(e,"multiply")},updateHash(){if(this.group!==Ue)if(this.group===W){let e="",{args:i}=this,u=this.fname===et;for(let S=0;S<i.length;S++)e+=(S===0?"":",")+G(i[S]);let g=u?"":this.fname;this.value=g+(u?e:kt(e))}else this.group===ye||this.group===Ce||(this.value=G(this,"hash"))},keyForGroup(e){let i=this.group,u;if(i===Ue)u=this.value;else if(i===ye||i===ge)e===Ce?u=this.power.toDecimal():u=this.value;else if(i===W)e===Ce?u=this.power.toDecimal():u=G(this,"hash");else{if(i===Ce)return e===qe?u=G(this,"hash"):e===Be?this.power.equals(1)?u=this.value:u=kt(G(this,"hash"))+D.POWER_OPERATOR+this.power.toDecimal():e===Ce?u=this.power.toString():u=this.value,u;i===Be?(e===Be&&(u=G(this,"hash")),e===Ce?u=this.power.toDecimal():u=this.value):i===qe?e===Ce?u=this.power.toDecimal():u=G(this,"hash"):i===Se&&(e===Ce?u=G(this.power):u=G(this,"hash"))}return u},collectSymbols(e,i,u,g){let S=[];if(this.symbols)for(let N in this.symbols){if(!Object.hasOwn(this.symbols,N))continue;let E=this.symbols[N];g&&(E.group===Ce||E.group===Be)?S=S.concat(E.collectSymbols()):S.push(e?e(E,i):E)}else S.push(this);return u===null&&(u=void 0),S.sort(u)},collectSummandSymbols(e,i,u,g){let S=[];if(!this.symbols||this.group===qe)S.push(this);else for(let N in this.symbols){if(!Object.hasOwn(this.symbols,N))continue;let E=this.symbols[N];g&&(E.group===Ce||E.group===Be)?S=S.concat(E.collectSymbols()):S.push(e?e(E,i):E)}return u===null&&(u=void 0),S.sort(u)},latex(e){return te.latex(this,e)},text(e=void 0){return G(this,e)},isOne(e=!1){let i=e?"absEquals":"equals";return this.group===Ue?this.multiplier[i](1):this.power.equals(0)},isComposite(){let e=this.group,i=this.previousGroup;return e===Be||e===Ce||i===Ce||i===Be},isCombination(){let e=this.group,i=this.previousGroup;return e===qe||i===qe},lessThan(e){return this.multiplier.lessThan(e)},greaterThan(e){return Re(e)||(e=new p(e)),!this.isConstant(!0)||!e.isConstant(!0)?!1:this.multiplier.greaterThan(e.multiplier)},getDenom(){let e,i;if(i=this.clone(),this.group===qe&&this.power.lessThan(0)&&(i=c.expand(i)),i.power.lessThan(0)||i.group===Se&&i.power.multiplier.lessThan(0)){let u=c.parse(i.multiplier.den);e=i.toUnitMultiplier(),e.power.negate(),e=c.multiply(u,e)}else if(i.group===qe){e=c.parse(i.multiplier.den);for(let u in i.symbols){if(!Object.hasOwn(i.symbols,u))continue;let g=i.symbols[u];(Number(g.power)<0||g.group===Se&&g.power.multiplier.lessThan(0))&&(e=c.multiply(e,i.symbols[u].clone().invert()))}}else e=c.parse(i.multiplier.den);return e},getNum(){let e,i;return i=this.clone(),i.group===qe&&i.power.lessThan(0)&&(i=c.expand(i)),i.power.greaterThan(0)&&i.group!==qe||i.group===Se&&i.power.multiplier.greaterThan(0)?e=c.multiply(c.parse(i.multiplier.num),i.toUnitMultiplier()):i.group===qe?(e=c.parse(i.multiplier.num),i.each(u=>{(Number(u.power)>0||u.group===Se&&u.power.multiplier.greaterThan(0))&&(e=c.multiply(e,u.clone()))})):e=c.parse(i.multiplier.num),e},toString(){return this.text()}};function x(){let e=this,i={},u={names:[],actions:[]};function g(o,s){this.start=o,this.end=s}g.prototype.isConstant=function(){return this.start.isConstant()&&this.end.isConstant()},g.prototype.text=function(){return`${G(this.start)}:${G(this.end)}`};function S(o,s,a){if(this.type=s,this.value=o,a!==void 0&&(this.column=a+1),s===S.OPERATOR){let k=C[o];for(let $ in k)Object.hasOwn(k,$)&&(this[$]=k[$])}else s===S.FUNCTION&&(this.precedence=S.MAX_PRECEDENCE,this.leftAssoc=!1)}S.prototype.toString=function(){return this.is_prefix?`\`${this.value}`:this.value},S.OPERATOR="OPERATOR",S.VARIABLE_OR_LITERAL="VARIABLE_OR_LITERAL",S.FUNCTION="FUNCTION",S.UNIT="UNIT",S.KEYWORD="KEYWORD",S.MAX_PRECEDENCE=999,this.classes={Collection:Pt,Slice:g,Token:S};let N={prec:void 0,cos(o,s){let a=c.parse(String(Math.cos(o)*Math.cosh(s))),k=c.parse(String(Math.sin(o)*Math.sinh(s)));return c.subtract(a,c.multiply(k,p.imaginary()))},sin(o,s){let a=c.parse(String(Math.sin(o)*Math.cosh(s))),k=c.parse(String(Math.cos(o)*Math.sinh(s)));return c.subtract(a,c.multiply(k,p.imaginary()))},tan(o,s){let a=c.parse(String(Math.sin(2*o)/(Math.cos(2*o)+Math.cosh(2*s)))),k=c.parse(String(Math.sinh(2*s)/(Math.cos(2*o)+Math.cosh(2*s))));return c.add(a,c.multiply(k,p.imaginary()))},sec(o,s){let a=this.removeDen(this.cos(o,s));return c.subtract(a[0],c.multiply(a[1],p.imaginary()))},csc(o,s){let a=this.removeDen(this.sin(o,s));return c.add(a[0],c.multiply(a[1],p.imaginary()))},cot(o,s){let a=this.removeDen(this.tan(o,s));return c.subtract(a[0],c.multiply(a[1],p.imaginary()))},acos(o,s){let a=this.fromArray([o,s]),k=c.pow(a.clone(),new p(2)),$=c.expand(k),fe=c.multiply(Ct(c.subtract(new p(1),$)),p.imaginary()),ee=c.expand(c.add(a.clone(),fe)),Y=Ae(ee);return c.expand(c.multiply(p.imaginary().negate(),Y))},asin(o,s){return c.subtract(c.parse("pi/2"),this.acos(o,s))},atan(o,s){if(o.equals(0)&&(s.equals(1)||s.equals(-1)))return c.parse(`${p.infinity()}*${D.IMAGINARY}*${s}`);let a=N.fromArray([o,s]),k=c.expand(c.multiply(p.imaginary(),a.clone())),$=Ae(c.expand(c.subtract(new p(1),k.clone()))),fe=Ae(c.expand(c.add(new p(1),k.clone())));return c.expand(c.multiply(c.divide(p.imaginary(),new p(2)),c.subtract($,fe)))},asec(o,s){let a=this.removeDen([o,s]);return a[1].negate(),this.acos(...a)},acsc(o,s){let a=this.removeDen([o,s]);return a[1].negate(),this.asin(...a)},acot(o,s){let a=this.removeDen([o,s]);return a[1].negate(),this.atan(...a)},cosh(o,s){let a=c.parse(String(Math.cosh(o)*Math.cos(s))),k=c.parse(String(Math.sinh(o)*Math.sin(s)));return c.add(a,c.multiply(k,p.imaginary()))},sinh(o,s){let a=c.parse(String(Math.sinh(o)*Math.cos(s))),k=c.parse(String(Math.cosh(o)*Math.sin(s)));return c.add(a,c.multiply(k,p.imaginary()))},tanh(o,s){let a=c.parse(String(Math.sinh(2*o)/(Math.cos(2*s)+Math.cosh(2*o)))),k=c.parse(String(Math.sin(2*s)/(Math.cos(2*s)+Math.cosh(2*o))));return c.subtract(a,c.multiply(k,p.imaginary()))},sech(o,s){let a=this.removeDen(this.cosh(o,s));return c.subtract(a[0],c.multiply(a[1],p.imaginary()))},csch(o,s){let a=this.removeDen(this.sinh(o,s));return c.subtract(a[0],c.multiply(a[1],p.imaginary()))},coth(o,s){let a=this.removeDen(this.tanh(o,s));return c.add(a[0],c.multiply(a[1],p.imaginary()))},acosh(o,s){let a=this.fromArray([o,s]),k=Ct(c.add(a.clone(),new p(1))),$=Ct(c.subtract(a.clone(),new p(1)));return c.expand(Ae(c.add(a,c.expand(c.multiply(k,$)))))},asinh(o,s){let a=this.fromArray([o,s]),k=Ct(c.add(new p(1),c.expand(c.pow(a.clone(),new p(2)))));return c.expand(Ae(c.add(a,k)))},atanh(o,s){let a=this.fromArray([o,s]),k=Ae(c.add(a.clone(),new p(1))),$=Ae(c.subtract(new p(1),a));return c.expand(c.divide(c.subtract(k,$),new p(2)))},asech(o,s){let a=this.removeDen([o,s]);return a[1].negate(),this.acosh(...a)},acsch(o,s){let a=this.removeDen([o,s]);return a[1].negate(),this.asinh(...a)},acoth(o,s){let a=this.removeDen([o,s]);return a[1].negate(),this.atanh(...a)},sqrt(o){let s=o.realpart(),a=o.imagpart(),k=p.hyp(s,a),$=c.add(s.clone(),k),fe=Ct(c.multiply(new p(2),$.clone()));return c.add(c.divide($.clone(),fe.clone()),c.multiply(c.divide(a,fe),p.imaginary()))},log(o,s){let a=Ae(p.hyp(o,s)),k=D.USE_BIG?new p(X.atan2(s.multiplier.toDecimal(),o.multiplier.toDecimal())):Math.atan2(s,o),$=c.parse(k);return c.add(a,c.multiply(p.imaginary(),$))},erf(o,s){return c.symfunction("erf",[o])},removeDen(o){let s,a;Ft(o)?(s=o[0],a=o[1]):(s=o.realpart(),a=o.imagpart());let k=s**2+a**2,$=c.parse(String(s/k)),fe=c.parse(String(a/k));return[$,fe]},fromArray(o){return c.add(o[0],c.multiply(p.imaginary(),o[1]))},evaluate(o,s){let a,k,$=o.power.sign();if(o.power=o.power.abs(),o.power.greaterThan(1)&&(o=c.expand(o)),$<0){let fe=this.removeDen(o);a=fe[0],k=fe[1]}else a=o.realpart(),k=o.imagpart();return a.isConstant("all")&&k.isConstant("all")?this[s](a,k):c.symfunction(s,[o])}},E=this.trig={cos(o){if(o.equals("pi")&&o.multiplier.den.equals(2))return new p(0);if(D.PARSE2NUMBER){if(o.equals(new p(D.PI/2)))return new p(0);if(o.isConstant())return D.USE_BIG?new p(X.cos(o.multiplier.toDecimal())):new p(Math.cos(o.valueOf()));if(o.isImaginary())return N.evaluate(o,"cos")}if(o.equals(0))return new p(1);let s,a=!1,k=nt(o.multiplier.toDecimal()),$=o.multiplier.abs();if(o.multiplier=$,o.isPi()&&o.isLinear())if(vt($))s=new p(bt($)?1:-1);else{let fe=Number($.num),ee=Number($.den);ee===2?s=new p(0):ee===3?(s=c.parse("1/2"),a=!0):ee===4?(s=c.parse("1/sqrt(2)"),a=!0):ee===6?(s=c.parse("sqrt(3)/2"),a=!0):s=c.symfunction("cos",[o])}return a&&(k===2||k===3)&&s.negate(),s||=c.symfunction("cos",[o]),s},sin(o){if(D.PARSE2NUMBER){if(o.isConstant())return Number(o.multiplier.toDecimal())%Math.PI===0?new p(0):D.USE_BIG?new p(X.sin(o.multiplier.toDecimal())):new p(Math.sin(o.valueOf()));if(o.isImaginary())return N.evaluate(o,"sin")}if(o.equals(0))return new p(0);let s,a=!1,k=nt(o.multiplier.toDecimal()),$=o.multiplier.sign(),fe=o.multiplier.abs();if(o.multiplier=fe,o.equals("pi"))s=new p(0);else if(o.isPi()&&o.isLinear())if(vt(fe))s=new p(0);else{let ee=fe.num,Y=fe.den;Y.equals(2)?(s=new p(1),a=!0):Y.equals(3)?(s=c.parse("sqrt(3)/2"),a=!0):Y.equals(4)?(s=c.parse("1/sqrt(2)"),a=!0):Y.equals(6)?(s=c.parse("1/2"),a=!0):s=c.multiply(new p($),c.symfunction("sin",[o]))}return s||=c.multiply(new p($),c.symfunction("sin",[o])),a&&(k===3||k===4)&&s.negate(),s},tan(o){if(D.PARSE2NUMBER){if(Number(o.multiplier.toDecimal())%Math.PI===0&&o.isLinear())return new p(0);if(o.isConstant())return D.USE_BIG?new p(X.tan(o.multiplier.toDecimal())):new p(Math.tan(o.valueOf()));if(o.isImaginary())return N.evaluate(o,"tan")}let s,a=!1,k=nt(o.multiplier.toDecimal()),$=o.multiplier;if(o.multiplier=$,o.isPi()&&o.isLinear())if(vt($))s=new p(0);else{let fe=$.num,ee=$.den;if(ee.equals(2))throw new e0(`tan is undefined for ${o.toString()}`);ee.equals(3)?(s=c.parse("sqrt(3)"),a=!0):ee.equals(4)?(s=new p(1),a=!0):ee.equals(6)?(s=c.parse("1/sqrt(3)"),a=!0):s=c.symfunction("tan",[o])}return s||=c.symfunction("tan",[o]),a&&(k===2||k===4)&&s.negate(),s},sec(o){if(D.PARSE2NUMBER)return o.isConstant()?D.USE_BIG?new p(new X(1).dividedBy(X.cos(o.multiplier.toDecimal()))):new p(O.sec(o.valueOf())):o.isImaginary()?N.evaluate(o,"sec"):c.parse(Dt("1/cos({0})",o));let s,a=!1,k=nt(o.multiplier.toDecimal()),$=o.multiplier.abs();if(o.multiplier=$,o.isPi()&&o.isLinear())if(vt($))s=new p(bt($)?1:-1);else{let fe=$.num,ee=$.den;if(ee.equals(2))throw new e0(`sec is undefined for ${o.toString()}`);ee.equals(3)?(s=new p(2),a=!0):ee.equals(4)?(s=c.parse("sqrt(2)"),a=!0):ee.equals(6)?(s=c.parse("2/sqrt(3)"),a=!0):s=c.symfunction("sec",[o])}return a&&(k===2||k===3)&&s.negate(),s||=c.symfunction("sec",[o]),s},csc(o){if(D.PARSE2NUMBER)return o.isConstant()?D.USE_BIG?new p(new X(1).dividedBy(X.sin(o.multiplier.toDecimal()))):new p(O.csc(o.valueOf())):o.isImaginary()?N.evaluate(o,"csc"):c.parse(Dt("1/sin({0})",o));let s,a=!1,k=nt(o.multiplier.toDecimal()),$=o.multiplier.sign(),fe=o.multiplier.abs();if(o.multiplier=fe,o.isPi()&&o.isLinear()){if(vt(fe))throw new e0(`csc is undefined for ${o.toString()}`);{let ee=fe.num,Y=fe.den;Y.equals(2)?(s=new p(1),a=!0):Y.equals(3)?(s=c.parse("2/sqrt(3)"),a=!0):Y.equals(4)?(s=c.parse("sqrt(2)"),a=!0):Y.equals(6)?(s=new p(2),a=!0):s=c.multiply(new p($),c.symfunction("csc",[o]))}}return s||=c.multiply(new p($),c.symfunction("csc",[o])),a&&(k===3||k===4)&&s.negate(),s},cot(o){if(D.PARSE2NUMBER)return Number(o.multiplier.toDecimal())%(Math.PI/2)===0?new p(0):o.isConstant()?D.USE_BIG?new p(new X(1).dividedBy(X.tan(o.multiplier.toDecimal()))):new p(O.cot(o.valueOf())):o.isImaginary()?N.evaluate(o,"cot"):c.parse(Dt("1/tan({0})",o));let s,a=!1,k=nt(o.multiplier.toDecimal()),$=o.multiplier;if(o.multiplier=$,o.isPi()&&o.isLinear()){if(vt($))throw new e0(`cot is undefined for ${o.toString()}`);{let fe=$.num,ee=$.den;ee.equals(2)?s=new p(0):ee.equals(3)?(s=c.parse("1/sqrt(3)"),a=!0):ee.equals(4)?(s=new p(1),a=!0):ee.equals(6)?(s=c.parse("sqrt(3)"),a=!0):s=c.symfunction("cot",[o])}}return s||=c.symfunction("cot",[o]),a&&(k===2||k===4)&&s.negate(),s},acos(o){if(D.PARSE2NUMBER){if(o.isConstant()){if(o.gt(1)||o.lt(-1)){let s=o.toString();return wt(qt(`pi/2-asin(${s})`))}return D.USE_BIG?new p(X.acos(o.multiplier.toDecimal())):new p(Math.acos(o.valueOf()))}if(o.isImaginary())return N.evaluate(o,"acos")}return c.symfunction("acos",[o])},asin(o){if(D.PARSE2NUMBER){if(o.isConstant()){if(o.gt(1)||o.lt(-1)){let s=D.IMAGINARY,a=o.multiplier.toDecimal();return wt(qt(`${s}*log(sqrt(1-${a}^2)-${s}*${a})`))}return D.USE_BIG?new p(X.asin(o.multiplier.toDecimal())):new p(Math.asin(o.valueOf()))}if(o.isImaginary())return N.evaluate(o,"asin")}return c.symfunction("asin",[o])},atan(o){let s;if(o.equals(0))s=new p(0);else{if(D.PARSE2NUMBER)return o.isConstant()?D.USE_BIG?new p(X.atan(o.multiplier.toDecimal())):new p(Math.atan(o.valueOf())):o.isImaginary()?N.evaluate(o,"atan"):c.symfunction("atan",[o]);o.equals(-1)?s=c.parse("-pi/4"):s=c.symfunction("atan",[o])}return s},asec(o){if(D.PARSE2NUMBER){if(o.equals(0))throw new N1("Input is out of the domain of sec!");if(o.isConstant())return E.acos(o.invert());if(o.isImaginary())return N.evaluate(o,"asec")}return c.symfunction("asec",[o])},acsc(o){if(D.PARSE2NUMBER){if(o.isConstant())return E.asin(o.invert());if(o.isImaginary())return N.evaluate(o,"acsc")}return c.symfunction("acsc",[o])},acot(o){if(D.PARSE2NUMBER){if(o.isConstant())return c.add(c.parse("pi/2"),E.atan(o).negate());if(o.isImaginary())return N.evaluate(o,"acot")}return c.symfunction("acot",[o])},atan2(o,s){if(o.equals(0)&&s.equals(0))throw new e0("atan2 is undefined for 0, 0");return D.PARSE2NUMBER&&o.isConstant()&&s.isConstant()?new p(Math.atan2(o,s)):c.symfunction("atan2",[o,s])}},q=this.trigh={cosh(o){if(D.PARSE2NUMBER){if(o.isConstant())return new p(Math.cosh(o.valueOf()));if(o.isImaginary())return N.evaluate(o,"cosh")}return c.symfunction("cosh",[o])},sinh(o){if(D.PARSE2NUMBER){if(o.isConstant())return new p(Math.sinh(o.valueOf()));if(o.isImaginary())return N.evaluate(o,"sinh")}return c.symfunction("sinh",[o])},tanh(o){if(D.PARSE2NUMBER){if(o.isConstant())return new p(Math.tanh(o.valueOf()));if(o.isImaginary())return N.evaluate(o,"tanh")}return c.symfunction("tanh",[o])},sech(o){return D.PARSE2NUMBER?o.isConstant()?new p(Math.sech(o.valueOf())):o.isImaginary()?N.evaluate(o,"sech"):c.parse(Dt("1/cosh({0})",o)):c.symfunction("sech",[o])},csch(o){return D.PARSE2NUMBER?o.isConstant()?new p(Math.csch(o.valueOf())):o.isImaginary()?N.evaluate(o,"csch"):c.parse(Dt("1/sinh({0})",o)):c.symfunction("csch",[o])},coth(o){return D.PARSE2NUMBER?o.isConstant()?new p(Math.coth(o.valueOf())):o.isImaginary()?N.evaluate(o,"coth"):c.parse(Dt("1/tanh({0})",o)):c.symfunction("coth",[o])},acosh(o){let s;return D.PARSE2NUMBER&&o.isImaginary()?s=N.evaluate(o,"acosh"):D.PARSE2NUMBER?s=qt(c.parse(Dt(`${D.LOG}(({0})+sqrt(({0})^2-1))`,o.toString()))):s=c.symfunction("acosh",[o]),s},asinh(o){let s;return D.PARSE2NUMBER&&o.isImaginary()?s=N.evaluate(o,"asinh"):D.PARSE2NUMBER?s=qt(c.parse(Dt(`${D.LOG}(({0})+sqrt(({0})^2+1))`,o.toString()))):s=c.symfunction("asinh",[o]),s},atanh(o){let s;return D.PARSE2NUMBER&&o.isImaginary()?s=N.evaluate(o,"atanh"):D.PARSE2NUMBER?s=qt(c.parse(Dt(`(1/2)*${D.LOG}((1+({0}))/(1-({0})))`,o.toString()))):s=c.symfunction("atanh",[o]),s},asech(o){let s;return D.PARSE2NUMBER&&o.isImaginary()?s=N.evaluate(o,"asech"):D.PARSE2NUMBER?s=qt(Ae(c.add(o.clone().invert(),Ct(c.subtract(c.pow(o,new p(-2)),new p(1)))))):s=c.symfunction("asech",[o]),s},acsch(o){let s;return D.PARSE2NUMBER&&o.isImaginary()?s=N.evaluate(o,"acsch"):D.PARSE2NUMBER?s=qt(c.parse(Dt(`${D.LOG}((1+sqrt(1+({0})^2))/({0}))`,o.toString()))):s=c.symfunction("acsch",[o]),s},acoth(o){let s;return D.PARSE2NUMBER&&o.isImaginary()?s=N.evaluate(o,"acoth"):D.PARSE2NUMBER?o.equals(1)?s=p.infinity():s=qt(c.divide(Ae(c.divide(c.add(o.clone(),new p(1)),c.subtract(o.clone(),new p(1)))),new p(2))):s=c.symfunction("acoth",[o]),s}};this.units={};let C={"\\":{precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(o){return o}},"!!":{precedence:7,operator:"!!",action:"dfactorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(o){return c.symfunction(D.DOUBLEFACTORIAL,[o])}},"!":{precedence:7,operator:"!",action:"factorial",prefix:!1,postfix:!0,leftAssoc:!0,operation(o){return je(o)}},"^":{precedence:6,operator:"^",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"**":{precedence:6,operator:"**",action:"pow",prefix:!1,postfix:!1,leftAssoc:!0},"%":{precedence:4,operator:"%",action:"percent",prefix:!1,postfix:!0,leftAssoc:!0,overloaded:!0,overloadAction:"mod",overloadLeftAssoc:!1,operation(o){return c.divide(o,new p(100))}},"*":{precedence:4,operator:"*",action:"multiply",prefix:!1,postfix:!1,leftAssoc:!1},"/":{precedence:4,operator:"/",action:"divide",prefix:!1,postfix:!1,leftAssoc:!1},"+":{precedence:3,operator:"+",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o}},plus:{precedence:3,operator:"plus",action:"add",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o}},"-":{precedence:3,operator:"-",action:"subtract",prefix:!0,postfix:!1,leftAssoc:!1,operation(o){return o.negate()}},"=":{precedence:2,operator:"=",action:"equals",prefix:!1,postfix:!1,leftAssoc:!1},"==":{precedence:1,operator:"==",action:"eq",prefix:!1,postfix:!1,leftAssoc:!1},"<":{precedence:1,operator:"<",action:"lt",prefix:!1,postfix:!1,leftAssoc:!1},"<=":{precedence:1,operator:"<=",action:"lte",prefix:!1,postfix:!1,leftAssoc:!1},">":{precedence:1,operator:">",action:"gt",prefix:!1,postfix:!1,leftAssoc:!1},"=>":{precedence:1,operator:"=>",action:"gte",prefix:!1,postfix:!1,leftAssoc:!1},",":{precedence:0,operator:",",action:"comma",prefix:!1,postfix:!1,leftAssoc:!1},":":{precedence:0,operator:",",action:"assign",prefix:!1,postfix:!1,leftAssoc:!1,vectorFn:"slice"},":=":{precedence:0,operator:",",action:"functionAssign",prefix:!1,postfix:!1,leftAssoc:!0}},P={"(":{type:"round",id:1,is_open:!0,is_close:!1},")":{type:"round",id:2,is_open:!1,is_close:!0},"[":{type:"square",id:3,is_open:!0,is_close:!1,maps_to:"vector"},"]":{type:"square",id:4,is_open:!1,is_close:!0},"{":{type:"curly",id:5,is_open:!0,is_close:!1,maps_to:"NerdamerSet"},"}":{type:"curly",id:6,is_open:!1,is_close:!0}},Z=this.functions={cos:[E.cos,1],sin:[E.sin,1],tan:[E.tan,1],sec:[E.sec,1],csc:[E.csc,1],cot:[E.cot,1],acos:[E.acos,1],asin:[E.asin,1],atan:[E.atan,1],arccos:[E.acos,1],arcsin:[E.asin,1],arctan:[E.atan,1],asec:[E.asec,1],acsc:[E.acsc,1],acot:[E.acot,1],atan2:[E.atan2,2],acoth:[q.acoth,1],asech:[q.asech,1],acsch:[q.acsch,1],sinh:[q.sinh,1],cosh:[q.cosh,1],tanh:[q.tanh,1],asinh:[q.asinh,1],sech:[q.sech,1],csch:[q.csch,1],coth:[q.coth,1],acosh:[q.acosh,1],atanh:[q.atanh,1],log10:[void 0,1],log2:[void 0,1],log1p:[void 0,1],exp:[xt,1],radians:[n0,1],degrees:[a0,1],min:[he,-1],max:[se,-1],erf:[void 0,1],floor:[void 0,1],ceil:[void 0,1],trunc:[void 0,1],Si:[void 0,1],step:[void 0,1],rect:[void 0,1],sinc:[Mt,1],tri:[void 0,1],sign:[le,1],Ci:[void 0,1],Ei:[void 0,1],Shi:[void 0,1],Chi:[void 0,1],Li:[void 0,1],fib:[void 0,1],fact:[je,1],factorial:[je,1],continuedFraction:[ft,[1,2]],dfactorial:[void 0,1],gamma_incomplete:[void 0,[1,2]],round:[ke,[1,2]],scientific:[pt,[1,2]],mod:[ut,2],pfactor:[T0,1],vector:[U0,-1],matrix:[x0,-1],NerdamerSet:[G0,-1],imatrix:[s0,-1],parens:[Ke,-1],sqrt:[Ct,1],cbrt:[d0,1],nthroot:[F0,2],log:[Ae,[1,2]],expand:[Kt,1],abs:[$e,1],invert:[An,1],determinant:[zt,1],size:[Lt,1],transpose:[Mn,1],dot:[Nn,2],cross:[En,2],vecget:[Tt,2],vecset:[R0,3],vectrim:[Zt,[1,2]],matget:[f0,3],matset:[o0,4],matgetrow:[B0,2],matsetrow:[L0,3],matgetcol:[I0,2],matsetcol:[V0,3],rationalize:[c0,1],IF:[Nt,3],isIn:[It,2],realpart:[d,1],imagpart:[M,1],conjugate:[A,1],arg:[I,1],polarform:[U,1],rectform:[L,1],sort:[Me,[1,2]],integer_part:[void 0,1],union:[_n,2],contains:[qn,2],intersection:[In,2],difference:[On,2],intersects:[Cn,2],isSubset:[Tn,2],primes:[Rn,2],print:[Ln,-1]};this.error=Ht;let oe=function(o){let s=D.FUNCTION_MODULES,a=s.length;for(let k=0;k<a;k++){let $=s[k];if(o in $)return $[o]}return Ht(`The function ${o} is undefined!`)};this.override=function(s,a){i[s]||=[],i[s].push(this[s]),this[s]=a},this.restore=function(s){this[s]&&=i[s].pop()},this.extend=function(s,a,k){let $=this;if(typeof this[s]=="function"&&typeof a=="function"){let ee=this[s];this[s]=function(Ee,Ne){return Re(Ee)&&Re(Ne)&&!k?ee.call($,Ee,Ne):a.call($,Ee,Ne,ee)}}},this.symfunction=function(s,a){let k=new p(s);return k.group=W,typeof a=="object"&&(a=[].slice.call(a)),k.args=a,k.fname=s===et?"":s,k.updateHash(),k},this.callfunction=function(s,a,k=void 0){let $=Z[s];$||Ht(`Nerdamer currently does not support the function ${s}`);let fe=$[1]||k,ee=$[0],Y;if(a instanceof Array||(a=a===void 0?[]:[a]),fe!==-1){let Ne=Ft(fe),Ie=Ne?fe[0]:fe,ve=Ne?fe[1]:fe,Ze=a.length,gt=`${s} requires a {0} of {1} arguments. {2} provided!`;Ze<Ie&&Ht(Dt(gt,"minimum",Ie,Ze)),Ze>ve&&Ht(Dt(gt,"maximum",ve,Ze))}let Ee=A1(a);return ee?Y=ee.apply($[2],a):(ee=oe(s),D.PARSE2NUMBER&&Ee?Y=yt(ee.apply(ee,a)):Y=c.symfunction(s,a)),Y},this.operator_filter_regex=(function(){let s=`^\\${Object.keys(C).filter(a=>a.length===1).join("\\")}`;return new RegExp(`([${s}])\\s+([${s}])`)})(),this.setOperator=function(s,a=void 0,k=void 0){let $=s.operator;if(C[$]=s,a&&(this[s.action]=a),e[$]=s.operation,!s.action&&!(s.prefix||s.postif)&&(s.action=$),k==="over"||k==="under"){let{precedence:fe}=s;for(let ee in C){if(!Object.hasOwn(C,ee))continue;let Y=C[ee];(k==="over"?Y.precedence>=fe:Y.precedence>fe)&&Y.precedence++}}},this.getOperator=function(s){return C[s]},this.aliasOperator=function(s,a){let k={},$=C[s];for(let fe in $)Object.hasOwn($,fe)&&(k[fe]=$[fe]);k.operator=a,this.setOperator(k)},this.getOperators=function(){return C},this.getBrackets=function(){return P};let pe=function(s,a){s=String(s);for(let k=0;k<u.actions.length;k++)s=u.actions[k].call(a,s);for(s=s.replace(/\s+/gu," "),/e/giu.test(s)&&(s=s.replace(/-+\d+\.?\d*e\+?-?\d+/giu,k=>j0(k)),s=s.replace(/(?<![A-Za-z])\d+\.?\d*e\+?-?\d+/giu,k=>j0(k))),s=s.replace(D.IMPLIED_MULTIPLICATION_REGEX,(k,$,fe,ee,Y)=>{let Ee=Y.charAt(ee),Ne="",Ie="*";return Ee.match(/[+\-/*]/u)||(Ne=Y.charAt(ee-1)),Ne.match(/[a-z]/iu)&&(Ie=""),$+Ie+fe}).replace(/(?<varname>[a-z0-9_]+)/giu,(k,$)=>D.USE_MULTICHARACTER_VARS===!1&&!($ in Z)&&isNaN($)?$.split("").join("*"):$).replace(/\)\(/gu,")*(")||"0";;){let k=s;if(s=s.replace(/(?<prefix>[a-z0-9_]+)(?<open>\()|(?<close>\))(?<suffix>[a-z0-9]+)/giu,($,fe,ee,Y,Ee)=>{let Ne=fe||Y,Ie=ee||Ee;return Ne in Z?Ne+Ie:`${Ne}*${Ie}`}),k===s)break}return s};this.initConstants=function(){this.CONSTANTS={E:new p(D.E),PI:new p(D.PI)}},this.prettyPrint=function(s){if(Array.isArray(s)){let a=s,k=a.map($=>c.prettyPrint($)).join(", ");return a.type==="vector"?`vector<${k}>`:`(${k})`}return s.toString()},this.peekers={pre_operator:[],post_operator:[],pre_function:[],post_function:[]},this.callPeekers=function(s,...a){if(D.callPeekers){let k=this.peekers[s],$=a.map(Fn);for(let fe=0;fe<k.length;fe++)k[fe].apply(null,$)}},this.tokenize=function(s){s=String(s),s=s.trim().replace(/\s+/gu," ");for(let mt in P){if(!Object.hasOwn(P,mt))continue;let Ot=new RegExp(P[mt].is_close?`\\s+\\${mt}`:`\\${mt}\\s+`,"g");s=s.replace(Ot,mt)}let a=0,k=s.length,$=0,fe=[],ee=[fe],Y=ee[0],Ee=0,Ne=[],Ie=!1,ve,Ze=" ",gt="",St=",",We="-",xe="*",tt=function(mt=void 0,Ot=void 0){let Rt=[];mt!==void 0&&(Rt.type=mt),Rt.column=Ot,ee.push(Rt),Y.push(Rt),Y=Rt,Ee++},Ye=function(){ee.pop(),Y=ee[--Ee]},st=function(mt){mt=mt===void 0?a:mt;let Ot=mt+1;for(;s.charAt(Ot++)in C;);return s.substring(mt,Ot-1)},Et=function(mt){let Ot=a-mt.length,Rt=[],Qt=mt.charAt(0),H0=mt.length,N0;for(N0=1;N0<H0;N0++){let R1=mt.charAt(N0),L1=Qt+R1;L1 in C?Qt=L1:(Rt.push(new S(Qt,S.OPERATOR,Ot+N0)),Qt=R1)}return Rt.push(new S(Qt,S.OPERATOR,Ot+N0)),Rt},ht=function(mt,Ot=void 0){Ot===void 0&&(Ot=s.substring($,mt)),Ot in c.units?Y.push(new S(Ot,S.UNIT,$)):Ot!==""&&Y.push(new S(Ot,S.VARIABLE_OR_LITERAL,$))},$t=function(mt){Y.push(new S(mt,S.FUNCTION,$))},Wt=function(mt){$=mt+1},m0=function(){$=$+ve.length-2,a=$-1};for(;a<k;a++){let mt=s.charAt(a);if(mt in C){ht(a);let Rt=Y[0]&&Y1(Y[0])&&mt===xe;Ie&&$<a&&!(mt===St||Rt)&&(Ie=!1,Ye()),Wt(a+1),ve=st(a),m0(),Y.push(...Et(ve))}else if(mt in P){let Ot=P[mt];if(Ot.is_open){Ne.push([Ot,$]);let Rt=s.substring($,a);Rt in Z?$t(Rt):Rt!==""&&Y.push(new S(Rt,S.VARIABLE_OR_LITERAL,$)),tt(Ot.maps_to,a)}else if(Ot.is_close){let Rt=Ne.pop();if(Rt){if(Rt[0].id!==Ot.id-1)throw new s1("Parity error")}else throw new s1(`Missing open bracket for bracket at: ${a+1}`);ht(a),Ye()}Wt(a)}else if(mt===Ze){let Ot=s.substring($,a),Rt=s.charAt(a+1);if(Ie){if(Ot in C)Y.push(new S(Ot,S.OPERATOR,a));else{ht(void 0,Ot),Ye();let Qt=Rt in C;(Qt&&C[Rt].value===We||!Qt)&&Y.push(new S(xe,S.OPERATOR,a))}Ie=!1}else{let Qt=s.substring($,a);Qt in Z?(Ie=!0,$t(Qt),tt()):Qt in C?Y.push(new S(Qt,S.OPERATOR,a)):(ht(void 0,Qt),Rt=s.charAt(a+1),Ot!==gt&&Rt!==gt&&!(Ot in C)&&!(Rt in C)&&Y.push(new S(xe,S.OPERATOR,a)))}Wt(a)}}if(Ne.length){let mt=Ne.pop();throw new s1(`Missing closed bracket for bracket at ${mt[1]+1}`)}return ht(a),fe},this.toRPN=function(s){let a=s.type,k=s.length,$,fe,ee=[],Y=[],Ee=[],Ne=function(ve,Ze){for(;ve.length;)Ze.push(ve.pop())};for($=0;$<k;$++){let Ie=s[$];if(Ie.type!==S.OPERATOR)break;if(!Ie.prefix)throw new $0("Not a prefix operator");Ie.is_prefix=!0,Y.push(Ie)}for(;$<k;$++){if(fe=s[$],fe.type===S.OPERATOR){let Ie=fe;if(Ie.overloaded){let ve=s[$+1];ve&&ve.type===S.VARIABLE_OR_LITERAL&&(Ie.postfix=!1,Ie.action=Ie.overloadAction,Ie.leftAssoc=Ie.overloadLeftAssoc)}for(;Y.length;){let ve=Y[Y.length-1];if(!(ve.precedence>Ie.precedence||!Ie.leftAssoc&&ve.precedence===Ie.precedence))break;ee.push(Y.pop())}if((a==="vector"||a==="set")&&"vectorFn"in Ie&&(Ie.action=Ie.vectorFn),Ie.postfix){let ve=s[$-1];if(ve){if(ve.type===S.OPERATOR&&!ve.postfix)throw new $0(`Unexpected prefix operator '${ve.value}'! at ${ve.column}`)}else throw new $0(`Unexpected prefix operator '${fe.value}'! at ${fe.column}`)}else{let ve;do{let Ze=s[$+1];if(ve=Ze?Ze.type===S.OPERATOR:!1,ve){if(!Ze.prefix)throw new $0(`A prefix operator was expected at ${Ze.column}`);Ze.is_prefix=!0,Ee.push(Ze),$++}}while(ve)}for(Ie.is_prefix?Ee.push(Ie):Y.push(Ie);Ee.length&&(Ie.leftAssoc||!Ie.leftAssoc&&Ee[Ee.length-1].precedence>=Ie.precedence);)Y.push(Ee.pop())}else if(fe.type===S.VARIABLE_OR_LITERAL){ee.length===0&&Ne(Ee,Y),ee.push(fe);let Ie=Y[Y.length-1];(!Ie||!Ie.leftAssoc)&&Ne(Ee,ee)}else fe.type===S.FUNCTION?Y.push(fe):fe.type===S.UNIT&&ee.push(fe);if(Array.isArray(fe)){let Ie=fe;ee.push(this.toRPN(fe)),Ie.type&&ee.push(new S(Ie.type,S.FUNCTION,Ie.column))}}return Ne(Y,ee),Ne(Ee,ee),ee},this.parseRPN=function(s,a){try{a||={};for(let ee in a)Object.hasOwn(a,ee)&&(a[ee]=c.parse(a[ee],{}));D.PARSE2NUMBER&&("e"in a||(a.e=new p(D.E)),"pi"in a||(a.pi=new p(D.PI)));let k=[],$;for(let ee=0,Y=s.length;ee<Y;ee++)if($=s[ee],Array.isArray($)&&($=this.parseRPN($,a)),$)if($.type===S.OPERATOR)if($.is_prefix||$.postfix)k.push($.operation(k.pop()));else{let Ee=k.pop(),Ne=k.pop();if(typeof Ne>"u")throw new $0(`${$} is not a valid postfix operator at ${$.column}`);let Ie=$.action==="comma";Ne instanceof g0&&!Ie&&(Ne=At.fromSet(Ne)),Ee instanceof g0&&!Ie&&(Ee=At.fromSet(Ee)),this.callPeekers("pre_operator",Ne,Ee,$);let ve=c[$.action](Ne,Ee);this.callPeekers("post_operator",ve,Ne,Ee,$),k.push(ve)}else if($.type===S.FUNCTION){let Ee=k.pop(),{parent:Ne}=Ee;Ee instanceof Pt||(Ee=Pt.create(Ee));let Ie=$.value,ve=Ee.getItems();this.callPeekers("pre_function",Ie,ve);let Ze=c.callfunction(Ie,ve);this.callPeekers("post_function",Ze,Ie,ve);let gt=k[k.length-1],St=s[ee+1],We=St&&St.type===S.OPERATOR&&St.value===",";Ne&&(Ze.parent=Ne),k.push(Ze)}else{let Ee,Ne=$.value;if(Ne in D.ALIASES)$=c.parse(D.ALIASES[$]);else if($.type===S.VARIABLE_OR_LITERAL)$=new p(Ne);else if($.type===S.UNIT){let Ie=new p(Ne);Ie.isUnit=!0,$=Ie}Ne in c.CONSTANTS?(Ee=$,$=new p(c.CONSTANTS[Ne])):Ne in a&&Ne!==a[Ne].toString()?(Ee=$,$=a[Ne].clone()):Ne in m&&(Ee=$,$=m[Ne].clone()),Ee&&($.subbed=Ee),k.push($)}let fe=k[0];if(["undefined","string","number"].indexOf(typeof fe)!==-1)throw new B1("Unexpected token!");return fe}catch(k){if(k.message==="timeout")throw k;[N1].forEach(ee=>{if(k instanceof ee){let Y=k.column;throw new ee(`${k.message}${Y?`: ${Y}`:""}`)}});let fe=k.column;throw new b1(`${k.message}${fe?`: ${fe}`:""}`)}};function ae(o){this.type=o.type,this.value=o.value,this.left=o.left,this.right=o.right}ae.prototype.toString=function(){let s=this.left?`${this.left.toString()}---`:"",a=this.right?`---${this.right.toString()}`:"";return`${s}(${this.value})${a}`},ae.prototype.toHTML=function(s,a){s||=0,a=typeof a>"u"?4:a;let k=function(Ee){return" ".repeat(a*Ee)},$="",fe=this.left?`${k(s+1)}<li>
${this.left.toHTML(s+2,a)}${k(s+1)}</li> 
`:"",ee=this.right?`${k(s+1)}<li>
${this.right.toHTML(s+2,a)}${k(s+1)}</li>
`:"";return $=`${k(s)}<div class="${this.type.toLowerCase()}"><span>${this.value}</span></div>${k(s)}
`,(fe||ee)&&($+=`${k(s)}<ul>
${fe}${ee}${k(s)}</ul>
`),$},this.tree=function(s){let a=[];for(let k=0;k<s.length;k++){let $=s[k];if(Array.isArray($)){$=this.tree($),a.push($);continue}if($.type===S.OPERATOR)if($.is_prefix||$.postfix){let fe=$.is_prefix?"left":"right",ee=a.pop();$=new ae($),$[fe]=ee,a.push($)}else $=new ae($),$.right=a.pop(),$.left=a.pop(),a.push($);else if($.type===S.FUNCTION){$=new ae($);let fe=a.pop();if($.right=fe,$.value==="object"){let ee=a[a.length-1];if(ee){for(;ee.right;)ee=ee.right;ee.right=$;continue}}a.push($)}else a.push(new ae($))}return a[0]},this.parse=function(s,a){s=pe(s,this),a||={};let k=this.tokenize(s),$=this.toRPN(k);return this.parseRPN($,a)},this.toObject=function(s){return function k($){let fe=[];for(let ee=0,Y=$.length;ee<Y;ee++){let Ee=$[ee],Ne=Ee.value;if(Ee.type===S.VARIABLE_OR_LITERAL)fe.push(new p(Ne));else if(Ee.type===S.FUNCTION){ee++;let Ie=c.symfunction(Ne,k($[ee]));Ie.isConversion=!0,fe.push(Ie)}else Ee.type===S.OPERATOR?fe.push(Ne):fe.push(k(Ee))}return fe}(c.tokenize(s))};let De=function(s){let a=0,k=[[]];for(let $=0,fe=s.length;$<fe;$++)s[$]===","?(a++,k[a]=[]):k[a].push(s[$]);return k},Le=function(o){return o.replace(/^\\left\((?<inner>.+)\\right\)$/gu,(s,a)=>a||s)},Pe=function(o){let s=[];for(;o.length;){let a=o.shift(),k=o[0],$=Ft(k),fe=k==="-";if(a==="^"&&(k==="+"?o.shift():$&&k[0]==="+"&&k.shift(),$&&k.length===1&&o.unshift(o.shift()[0])),a==="^"&&($&&k[0]==="-"||fe)){let ee=s.pop(),Y=s[s.length-1],Ee="1";Y==="*"?(s.pop(),Ee=s.pop()):Ft(Y)&&(Ee=s.pop()),s.push(Ee,"/",ee,a),$?k.shift():o.shift(),$&&k.length===1&&s.push(o.shift()[0])}else s.push(a)}return s};this.toTeX=function(s,a){a||={};let k=a.decimals===!0?"decimals":void 0,$=typeof s=="string"?this.toObject(s):s,fe=[],ee=typeof a.cdot>"u"?"\\cdot":a.cdot;if($=Pe($),Ft($)){let Y=[],Ee,Ne;for(let Ie=0;Ie<$.length;Ie++)Ee=$[Ie],$[Ie+1]==="^"?(Ne=$[Ie+2],Y.push(`${te.braces(this.toTeX([Ee]))}^${te.braces(this.toTeX([Ne]))}`),Ie+=2):Y.push(Ee);$=Y}for(let Y=0,Ee=$.length;Y<Ee;Y++){let Ne=$[Y];if(Ne==="*"&&(Ne=ee),Re(Ne))if(Ne.group===W){let{fname:Ie}=Ne,ve;if(Ie===Oe)ve=`\\sqrt${te.braces(this.toTeX(Ne.args))}`;else if(Ie===J)ve=te.brackets(this.toTeX(Ne.args),"abs");else if(Ie===et)ve=te.brackets(this.toTeX(Ne.args),"parens");else if(Ie===D.LOG10)ve=`\\${D.LOG10_LATEX}\\left( ${this.toTeX(Ne.args)}\\right)`;else if(Ie===D.LOG2)ve=`\\${D.LOG2_LATEX}\\left( ${this.toTeX(Ne.args)}\\right)`;else if(Ie===D.LOG1P)ve=`\\${Dt(D.LOG1P_LATEX,this.toTeX(Ne.args))}`;else if(Ie==="integrate"){let Ze=De(Ne.args),gt=te.braces(this.toTeX(Ze[0])),St=this.toTeX(Ze[1]);ve=`\\int ${gt}\\, d${St}`}else if(Ie==="defint"){let Ze=De(Ne.args),gt=te.braces(this.toTeX(Ze[0])),St=this.toTeX(Ze[3]),We=this.toTeX(Ze[1]),xe=this.toTeX(Ze[2]);ve=`\\int\\limits_{${We}}^{${xe}} ${gt}\\, d${St}`}else if(Ie==="diff"){let Ze=De(Ne.args),gt="",St=te.braces(this.toTeX(Ze[0]));if(Ze.length===1){let We=[];for(let xe=0;xe<Ze[0].length;xe++)Ze[0][xe].group===3&&We.push(Ze[0][xe].value);We.sort(),gt=We.length>0?`\\frac{d}{d ${We[0]}}`:"\\frac{d}{d x}"}else Ze.length===2?gt=`\\frac{d}{d ${Ze[1]}}`:gt=`\\frac{d^{${Ze[2]}}}{d ${this.toTeX(Ze[1])}^{${Ze[2]}}}`;ve=`${gt}\\left(${St}\\right)`}else if(Ie==="sum"||Ie==="product"){let Ze=[[],[],[],[]],gt=0;for(let St=0;St<Ne.args.length;St++){if(Ne.args[St]===","){gt++;continue}Ze[gt].push(Ne.args[St])}ve=(Ie==="sum"?"\\sum_":"\\prod_")+te.braces(`${this.toTeX(Ze[1])} = ${this.toTeX(Ze[2])}`),ve+=`^${te.braces(this.toTeX(Ze[3]))}${te.braces(this.toTeX(Ze[0]))}`}else if(Ie==="limit"){let Ze=this.toTeX.bind(this),gt=c,St=De(Ne.args).map(We=>Array.isArray(We)?gt.toTeX(We.join("")):Ze(String(We)));ve=`\\lim_${te.braces(`${St[1]}\\to ${St[2]}`)} ${te.braces(St[0])}`}else Ie===l||Ie===w?ve=this.toTeX(Ne.args)+(Ie===l?"!":"!!"):ve=te.latex(Ne,k);fe.push(ve)}else fe.push(te.latex(Ne,k));else Ft(Ne)?fe.push(te.brackets(this.toTeX(Ne))):Ne==="/"?fe.push(te.frac(Le(fe.pop()),Le(this.toTeX([$[++Y]])))):fe.push(Ne)}return fe.join(" ")};function Ke(o){return D.PARSE2NUMBER?o:c.symfunction("parens",[o])}function $e(o){if(o.isInfinity)return p.infinity();if(o.multiplier.lessThan(0)&&o.multiplier.negate(),o.isImaginary()){let a=o.realpart(),k=o.imagpart();if(a.isConstant()&&k.isConstant())return Ct(c.add(c.pow(a,new p(2)),c.pow(k,new p(2))))}else{if(k0(o)||bt(o.power))return o;if(G1(o)&&typeof o.value=="string"&&o.value.startsWith("baseunit_"))return o}if(o.isComposite()){let a=[];o.each($=>{a.push($.multiplier)}),O.QGCD.apply(null,a).lessThan(0)&&(o.multiplier=o.multiplier.multiply(new Xe(-1)),o.distributeMultiplier())}let s=c.parse(o.multiplier);return o.toUnitMultiplier(),c.multiply(s,c.symfunction(J,[o]))}function je(o){let s;if(ne(o)){let a=new At;return o.each((k,$)=>{a.set($-1,je(k))}),a}if(we(o)){let a=new dt;return o.each((k,$,fe)=>{a.set($,fe,je(k))}),a}if(D.PARSE2NUMBER&&o.isConstant())return vt(o)?s=O.bigfactorial(o):s=O.gamma(o.multiplier.add(new Xe(1)).toDecimal()),s=yt(s),s;if(o.isConstant()&&o.getDenom().equals(2)){let k=o.getNum(),$,fe,ee;o.multiplier.isNegative()?(ee=c.subtract(k.negate(),new p(1)).multiplier.divide(new Xe(2)),$=c.pow(new p(-4),new p(ee)).multiplier.multiply(O.bigfactorial(ee)),fe=O.bigfactorial(new Xe(2).multiply(ee))):(ee=c.add(k,new p(1)).multiplier.divide(new Xe(2)),$=O.bigfactorial(new Xe(2).multiply(ee)),fe=c.pow(new p(4),new p(ee)).multiplier.multiply(O.bigfactorial(ee)));let Y=$.divide(fe);return c.multiply(c.parse("sqrt(pi)"),new p(Y))}return c.symfunction(l,[o])}function ft(o,s){let a=qt(o);if(a.isConstant()){let k=O.continuedFraction(a,s),$=At.fromArray(k.fractions.map(fe=>new p(fe)));return At.fromArray([new p(k.sign),new p(k.whole),$])}return c.symfunction("continuedFraction",[o,s])}function _t(o){let s=qt(o);return s.isConstant()?new p(O.erf(s)):s.isImaginary()?N.erf(o):c.symfunction("erf",[o])}function ut(o,s){if(o.isConstant()&&s.isConstant()){let k=new p(1);return k.multiplier=k.multiplier.multiply(o.multiplier.mod(s.multiplier)),k}let a=c.divide(o.clone(),s.clone());return vt(a)?new p(0):c.symfunction("mod",[o,s])}function Nt(o,s,a){return typeof o!="boolean"&&k0(o)&&(o=!!Number(o)),o?s:a}function It(o,s){if(we(o)){for(let a=0,k=o.rows();a<k;a++)for(let $=0,fe=o.cols();$<fe;$++)if(o.elements[a][$].equals(s))return new p(1)}else if(o.elements){for(let a=0,k=o.elements.length;a<k;a++)if(o.elements[a].equals(s))return new p(1)}return new p(0)}function Mt(o){return D.PARSE2NUMBER?o.isConstant()?new p(O.sinc(o)):c.parse(Dt("sin({0})/({0})",o)):c.symfunction("sinc",[o])}function xt(o){return o.fname===D.LOG&&o.isLinear()?c.pow(o.args[0],p.create(o.multiplier)):c.parse(Dt("e^({0})",o))}function n0(o){return c.parse(Dt("({0})*pi/180",o))}function a0(o){return c.parse(Dt("({0})*180/pi",o))}function u0(o){let s,a,k;if(o.group===W&&o.fname===""?(s=p.unwrapPARENS(c.parse(o).toLinear()),a=c.parse(o.power)):o.group===ge&&(s=c.parse(o.value),a=c.parse(o.power)),s&&a&&s.group===Ue&&a.group===Ue){k=[];let $=p.toPolarFormArray(o),fe=c.parse(s).abs().toString(),ee=I(s).toString(),Y=a.multiplier.den.toString(),Ee=a.multiplier.num.toString(),Ne="(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})";for(let Ie=0;Ie<Number(Y);Ie++){let ve=qt(c.parse(Dt("(({0})+2*pi*({1}))/({2})",ee,Ie,Y))).multiplier.toDecimal();k.push(qt(c.parse(Dt(Ne,fe,Y,D.IMAGINARY,ve,Ee))))}return At.fromArray(k)}if(o.isConstant(!0)){let $=o.sign(),fe=qt(o.abs()),ee=c.sqrt(fe);k=[ee.clone(),ee.negate()],$<0&&(k=k.map(Y=>c.multiply(Y,p.imaginary())))}else k=[c.parse(o)];return At.fromArray(k)}function c0(o){if(o.isComposite()){let s=new p(0),a,k,$,fe,ee,Y,Ee,Ne;return o.each(Ie=>{a=Ie.getNum(),k=Ie.getDenom(),$=s.getNum(),fe=s.getDenom(),ee=c.multiply(k,$),Y=c.multiply(a,fe),Ee=c.expand(c.add(ee,Y)),Ne=c.multiply(fe,k),s=c.divide(Ee,Ne)},!0),s}return o}function Ct(o){Re(o)||(o=c.parse(o));let s=c.symfunction("sqrt",[o]);if(o.group===Se)return c.symfunction(Oe,[o]);o.fname===""&&o.power.equals(1)&&(o=o.args[0]);let a=o.multiplier.sign()<0;if(D.PARSE2NUMBER){if(o.isConstant()&&!a)return new p(X.sqrt(o.multiplier.toDecimal()));if(o.isImaginary())return N.sqrt(o);if(o.group===ye)return c.symfunction("sqrt",[o])}let k,$,fe=o.isConstant();if(o.group===qe&&o.isLinear()){let ee=Ct(new p(o.multiplier));for(let Y in o.symbols){if(!Object.hasOwn(o.symbols,Y))continue;let Ee=o.symbols[Y];ee=c.multiply(ee,Ct(Ee))}$=ee}else if(o.fname===Oe){let ee=o.args[0],Y=o.multiplier;ee.setPower(o.power.multiply(new Xe(.25))),$=ee,Y.equals(1)||($=c.multiply(Ct(c.parse(Y)),$))}else if(!o.power.isInteger())o.setPower(o.power.multiply(new Xe(.5))),$=o;else if(Number(o.multiplier)<0&&o.group===ye){let ee=c.parse(o.multiplier).negate(),Y=c.parse(o).toUnitMultiplier().negate();$=c.multiply(c.symfunction(D.SQRT,[Y]),Ct(ee))}else{let ee=o.power.sign();o.power=o.power.abs(),fe&&o.multiplier.lessThan(0)&&(k=p.imaginary(),o.multiplier=o.multiplier.abs());let Y=Number(o.multiplier.toDecimal()),Ee=Math.abs(Y),Ne=Math.sqrt(Ee),Ie;if(vt(Ne))Ie=new p(Ne);else if(vt(Y)){let ve=O.ifactor(Y),Ze=1;for(let gt in ve){if(!Object.hasOwn(ve,gt))continue;let St=ve[gt],We=St-St%2;if(We){let xe=Number(gt)**We;Ze*=Number(gt)**(We/2),Y/=xe}}Ie=c.multiply(c.symfunction(Oe,[new p(Y)]),new p(Ze))}else{let ve=[new p(o.multiplier.num),new p(o.multiplier.den)],Ze=[new p(1),new p(1)],gt=[new p(1),new p(1)],St=c;for(let We=0;We<2;We++){let xe=ve[We];T0(xe).each(tt=>{tt=p.unwrapPARENS(tt);let Ye=tt.clone().toLinear(),st=Number(tt.power),Et=st%2,ht=(st-Et)/2;Ze[We]=St.multiply(Ze[We],St.pow(Ye,new p(ht))),gt[We]=St.multiply(gt[We],Ct(St.pow(Ye,new p(Et))))})}Ie=c.divide(c.multiply(Ze[0],gt[0]),c.multiply(Ze[1],gt[1]))}o=o.toUnitMultiplier(!0),o.isOne()?$=o:bt(o.power.toString())?$=c.pow(o.clone(),new p(.5)):$=c.symfunction(Oe,[o]),ee<0&&$.power.negate(),Ie&&($=c.multiply(Ie,$)),k&&($=c.multiply(k,$))}return me&&D.PARSE2NUMBER&&$.text()!==s.text()?c.parse($):$}function d0(o){if(!o.isConstant(!0)){let s,a=Number(o.power)/3,k=c.pow(c.parse(o.multiplier),new p(1/3)),$=o.toUnitMultiplier();return vt(a)?s=c.pow($.toLinear(),c.parse(String(a))):$.group===qe?(s=new p(1),$.each(fe=>{s=c.multiply(s,d0(fe))})):s=c.symfunction("cbrt",[$]),c.multiply(k,s)}return F0(o,new p(3))}function pt(o,s){return o.scientific=s||10,o}function F0(o,s,a=void 0,k=void 0){if(s=qt(c.parse(s)),s.equals(0))throw new e0("Unable to calculate nthroots of zero");if(Number(o)<0&&bt(s))throw new Error("Cannot calculate nthroot of negative number for even powers");if(!o.isConstant(!0)){let Y=[o,s];return typeof a<"u"&&Y.push(a),typeof k<"u"&&Y.push(k),c.symfunction("nthroot",Y)}o.group!==Ue&&(o=qt(o)),typeof k>"u"&&(k=!0),a||=25;let $=o.sign(),fe,ee;if($<0&&(o=$e(o)),vt(o)&&s.isConstant())return Number(o)<18446744073709552e3?ee=Xe.create(Number(o)**(1/Number(s))):ee=O.nthroot(o,s),k?fe=new p(ee):fe=new p(ee.toDecimal(a)),c.multiply(new p($),fe)}function T0(o){if(o.greaterThan(9999999999998891e26)||o.equals(-1))return o;if(o.equals(Math.PI))return new p(Math.PI);o=qt(o.clone());let s;if(o.isConstant()){s=new p(1);let a=o.toString();if(vt(a)){let k=O.ifactor(a);for(let $ in k){if(!Object.hasOwn(k,$))continue;let fe=k[$];s=c.multiply(s,c.symfunction("parens",[new p($).setPower(new Xe(fe))]))}}else{let k=T0(new p(o.multiplier.num)),$=T0(new p(o.multiplier.den));s=c.multiply(c.symfunction("parens",[k]),c.symfunction("parens",[$]).invert())}}else s=c.symfunction("pfactor",[o]);return s}function d(o){return o.realpart()}function M(o){return o.imagpart()}function A(o){let s=o.realpart(),a=o.imagpart();return c.add(s,c.multiply(a.negate(),p.imaginary()))}function I(o){let s=o.realpart(),a=o.imagpart();return s.isConstant()&&a.isConstant()?a.equals(0)&&s.equals(1)?c.parse("0"):a.equals(1)&&s.equals(0)?c.parse("pi/2"):a.equals(0)&&s.equals(-1)?c.parse("pi"):a.equals(-1)&&s.equals(0)?c.parse("-pi/2"):a.equals(1)&&s.equals(1)?c.parse("pi/4"):a.equals(1)&&s.equals(-1)?c.parse("pi*3/4"):a.equals(-1)&&s.equals(1)?c.parse("-pi/4"):a.equals(-1)&&s.equals(-1)?c.parse("-pi*3/4"):new p(Math.atan2(Number(a),Number(s))):c.symfunction("atan2",[a,s])}function U(o){let s=p.toPolarFormArray(o),a=s[1],k=s[0],$=c.parse(Dt("e^({0}*({1}))",D.IMAGINARY,a));return c.multiply(k,$)}function L(o){let s=o.clone();try{let a=He(o,"e",!0),k=c.divide(a.x.power,p.imaginary()),$=qt(E.tan(k)),fe=c.pow(a.a,new p(2)),ee=$.getDenom(!0),Y=$.getNum();return p.hyp(Y,ee).equals(a.a)?c.add(ee,c.multiply(p.imaginary(),Y)):s}catch(a){if(a.message==="timeout")throw a;return s}}function Q(o,s){s.forEach(Y=>{Y.numVal=qt(Y).multiplier});let a,k,$,fe,ee;for(;;){if(a=s.length,a<2)return s[0];k=s.pop(),$=s[a-2],(o==="min"?k.numVal<$.numVal:k.numVal>$.numVal)&&(s.pop(),s.push(k))}}function se(...o){return r1(o)?o[0]:A1(o)?new p(Math.max.apply(null,o)):D.SYMBOLIC_MIN_MAX&&b(o)?Q("max",o):c.symfunction("max",o)}function he(...o){return r1(o)?o[0]:A1(o)?new p(Math.min.apply(null,o)):D.SYMBOLIC_MIN_MAX&&b(o)?Q("min",o):c.symfunction("min",o)}function le(o){return o.isConstant(!0)?new p(Math.sign(qt(o))):c.symfunction("sign",[o])}function Me(o,s){s=s?s.toString():"asc";let a=function($){return $.group===Ue?$.multiplier:$.group===W?$.fname===""?a($.args[0]):$.fname:$.group===ye?$.power:$.value},k=ne(o)?o.elements:o.collectSymbols();return new At(k.sort(($,fe)=>{let ee=a($),Y=a(fe);return s==="desc"?Y-ee:ee-Y}))}function Ae(o,s=void 0){if(o.equals(1))return new p(0);let a;if(o.fname===Oe&&o.multiplier.equals(1))return a=c.divide(Ae(o.args[0]),new p(2)),o.power.sign()<0&&a.negate(),a;if(o.equals(0))throw new e0(`${D.LOG}(0) is undefined!`);if(o.isImaginary())return N.evaluate(o,D.LOG);if(o.isConstant()&&typeof s<"u"&&s.isConstant()){let k=Math.log(o),$=Math.log(s);a=new p(k/$)}else if(o.group===Se&&o.power.multiplier.lessThan(0)||o.power.toString()==="-1")o.power.negate(),a=Ae(o).negate();else if(o.value==="e"&&o.multiplier.equals(1)){let k=o.power;a=Re(k)?k:new p(k)}else if(o.group===W&&o.fname==="exp"){let k=o.args[0];o.multiplier.equals(1)?a=c.multiply(k,new p(o.power)):a=c.symfunction(D.LOG,[o])}else if(D.PARSE2NUMBER&&k0(o)){o=c.parse(o);let k;o.multiplier.lessThan(0)&&(o.negate(),k=c.multiply(new p(Math.PI),new p("i"))),a=new p(Math.log(o.multiplier.toDecimal())),k&&(a=c.add(a,k))}else{let k;!o.power.equals(1)&&!o.contains("e")&&o.multiplier.isOne()&&(k=o.group===Se?o.power:new p(o.power),o.toLinear());let $=typeof s>"u"?[o]:[o,s];$.length>1&&r1($)?a=new p(1):a=c.symfunction(D.LOG,$),k&&(a=c.multiply(k,a))}return a}function ke(o,s){let a=s&&s.isConstant()||typeof s>"u";if(o.isConstant()&&a){let $,fe,ee;$=o,s&&s.lessThan(0)&&(s=$e(s),fe=Number(o).toExponential().toString().split("e"),$=fe[0],ee=fe[1]);let Y=new p(E0(Number($),Number(s)||0));return c.multiply(Y,c.pow(new p(10),new p(ee||0)))}let k=[o];return typeof s<"u"&&k.push(s),c.symfunction("round",k)}function nt(o){let s=Number(o)%2,a;return s<0&&(s=2+s),s>=0&&s<=.5?a=1:s>.5&&s<=1?a=2:s>1&&s<=1.5?a=3:a=4,a}function yt(o){if(!isFinite(o)){let a=Math.sign(o),k=new p(String(Math.abs(o)));return k.multiplier=k.multiplier.multiply(new Xe(a)),k}if(Re(o))return o;if(typeof o=="number")try{o=Xe.simple(o)}catch(a){if(a.message==="timeout")throw a;o=new Xe(o)}let s=new p(0);return s.multiplier=o,s}function at(o){let s=o.group,a;if(s===Be){let k=o.getNum(),$=o.getDenom()||new p(1),fe=Number(o.power),ee=new p(1);if(Math.abs(fe)===1){$.each(Ne=>{Ne.group===qe?ee=c.multiply(ee,at(Ne.getDenom())):Ne.power.lessThan(0)&&(ee=c.multiply(ee,at(Ne.clone().toUnitMultiplier())))});let Y=new p(0);$.each(Ne=>{Y=c.add(c.divide(Ne,ee.clone()),Y)}),ee.invert();let Ee;k.isComposite()?(Ee=new p(0),k.each(Ne=>{Ee=c.add(c.multiply(at(Ne),ee.clone()),Ee)})):Ee=c.multiply(ee,k),a=c.divide(Ee,Y)}}else s===qe?(a=new p(1),o.each(k=>{a=c.multiply(a,c.clean(k))})):s===W&&o.args.length===1&&o.args[0].isConstant()&&(a=l0("PARSE2NUMBER",()=>c.parse(o),!0));return a||=o,a}function Kt(o,s){return s||={expand_denominator:!0,expand_functions:!0},wt(o,s)}function wt(o,s){if(Array.isArray(o))return o.map(k=>wt(k,s));if(o.expand)return o.expand(s);if(s||={},o.group===W&&o.fname===""){let k=wt(o.args[0],s),$=wt(c.pow(k,c.parse(o.power)),s);return c.multiply(c.parse(o.multiplier),$).distributeMultiplier()}if([Ue,ge,ye].indexOf(o.group)!==-1)return o;let a=o.clone();try{let k=o.multiplier.toString(),$=Number(o.power),fe=o;if(o.isComposite()&&vt(o.power)&&o.power>0){let ee=$-1,Y=new p(0);o.each(Ne=>{Y=c.add(Y,wt(c.parse(Ne),s))});let Ee=c.parse(Y);for(let Ne=0;Ne<ee;Ne++)Ee=H(Ee,Y,s);fe=c.multiply(c.parse(k),Ee).distributeMultiplier()}else if(o.group===W&&s.expand_functions===!0){let ee=[];o.args.forEach(Y=>{ee.push(wt(Y,s))}),fe=c.pow(c.symfunction(o.fname,ee),c.parse(o.power)),fe=c.multiply(fe,c.parse(o.multiplier))}else if(o.isComposite()&&vt(o.power)&&o.power<0&&s.expand_denominator===!0)o=o.invert(),fe=wt(o,s),fe.invert();else if(o.group===qe){let ee=function(Ne){switch(Ne.group){case Be:return 0;case Ce:return 1;case qe:return 2;case W:return 3;default:return 4}},Y=o.collectSymbols().sort((Ne,Ie)=>ee(Ie)-ee(Ne)).map(Ne=>{let Ie=c.pow(Ne,c.parse(String($)));return wt(Ie,s)}),Ee=Y.pop();Ee.isComposite()&&Ee.isLinear()?(Y.forEach(Ne=>{Ee=H(Ee,Ne,s)}),Ee.isComposite()?(Ee.power>1&&(Ee=wt(c.pow(Ee,c.parse(Ee.power)),s)),fe=c.multiply(c.parse(k),Ee).distributeMultiplier()):fe=Ee):(fe=Ee,Y.forEach(Ne=>{fe=c.multiply(fe,Ne)}),fe=c.multiply(fe,c.parse(k)).distributeMultiplier()),fe.group===qe&&(fe=c.parse(fe))}else fe=o;return fe}catch(k){if(k.message==="timeout")throw k;return a}}function s0(o){return dt.identity(o)}function Tt(o,s){return s.isConstant()&&vt(s)?o.elements[Number(s)]:c.symfunction("vecget",[o,s])}function Zt(o,s){return s=typeof s>"u"?1e-14:s,o=o.clone(),s=Number(s),o.elements.sort((a,k)=>k.group-a.group),o.elements=Qn(o.elements,(a,k)=>Number(c.subtract(qt(a),qt(k)).abs())<=s),o}function R0(o,s,a){return s.isConstant?(o.elements[Number(s)]=a,o):c.symfunction("vecset",[o,s,a])}function f0(o,s,a){return s.isConstant()&&a.isConstant()?o.elements[Number(s)][Number(a)]:c.symfunction("matget",[o,s,a])}function B0(o,s){return s.isConstant()?new dt(o.elements[s]):c.symfunction("matgetrow",[o,s])}function L0(o,s,a){if(!s.isConstant())return c.symfunction("matsetrow",[o,s,a]);if(o.elements[Number(s)].length!==a.elements.length)throw new E1("Matrix row must match row dimensions!");let k=o.clone();return k.elements[Number(s)]=a.clone().elements,k}function I0(o,s){if(!s.isConstant())return c.symfunction("matgetcol",[o,s]);let a=Number(s),k=dt.fromArray([]);return o.each(($,fe,ee)=>{ee===a&&k.elements.push([$.clone()])}),k}function V0(o,s,a){if(!s.isConstant())return c.symfunction("matsetcol",[o,s,a]);let k=Number(s);if(o.rows()!==a.elements.length)throw new E1("Matrix column length must match number of rows!");return a.each((($,fe)=>{o.set(fe-1,k,$.elements[0].clone())})),o}function o0(o,s,a,k){return o.elements[s][a]=k,o}function U0(...o){return new At(o)}function x0(...o){return dt.fromArray(o)}function G0(...o){return g0.fromArray(o)}function zt(o){return we(o)?o.determinant():o}function Lt(o){let s;return we(o)?s=[new p(o.cols()),new p(o.rows())]:ne(o)||V1(o)?s=new p(o.elements.length):Ht("size expects a matrix or a vector"),s}function Nn(o,s){return we(o)&&(o=new At(o)),we(s)&&(s=new At(s)),ne(o)&&ne(s)?o.dot(s):c.multiply(o.clone(),s.clone())}function En(o,s){return we(o)&&(o=new At(o)),we(s)&&(s=new At(s)),ne(o)&&ne(s)?o.cross(s):c.multiply(o.clone(),s.clone())}function Mn(o){return we(o)?o.transpose():Ht("function transpose expects a matrix")}function An(o){return we(o)?o.invert():Ht("invert expects a matrix")}function _n(o,s){return o.union(s)}function In(o,s){return o.intersection(s)}function qn(o,s){return o.contains(s)}function On(o,s){return o.difference(s)}function Cn(o,s){return new p(Number(o.intersects(s)))}function Tn(o,s){return new p(Number(o.isSubset(s)))}function Rn(o,s){s??=o;let a=ce.slice(o,s).map(k=>new p(k));return a.length===1?a[0]:a.length===0?new p(0):new At(a)}function Ln(...o){o.forEach(s=>{console.log(s.toString())})}function m1(o){if(!Re(o.power)&&o.power.absEquals(.5)){let s=o.power.sign(),a=Ct(o.group===ge?new p(o.value):o.toLinear());return s<0&&a.invert(),a}return o}function Un(o){if(o.group===ge){let s=o.value,a=Di(s)[0];if(!a)return _1("Unable to compute prime factors. This should not happen. Please review and report."),o;let $=new Xe(Math.log(s)/Math.log(a)).multiply(o.power);if($.den>o.power.den)return o;vt($)?o=new p(a**Number($)):o=new p(a).setPower($)}return o}this.expand=wt,this.round=ke,this.clean=at,this.sqrt=Ct,this.cbrt=d0,this.abs=$e,this.log=Ae,this.rationalize=c0,this.nthroot=F0,this.arg=I,this.conjugate=A,this.imagpart=M,this.realpart=d,this.getFunction=function(s){return Z[s][0]},this.addPreprocessor=function(s,a,k,$){let{names:fe}=u,{actions:ee}=u;if(typeof a!="function")throw new Error("Incorrect parameters. Function expected!");k?$?(fe.splice(k,0,s),ee.splice(k,0,a)):(fe[k]=s,ee[k]=a):(fe.push(s),ee.push(a))},this.getPreprocessors=function(){let s={};for(let a=0,k=u.names.length;a<k;a++){let $=u.names[a];s[$]={order:a,action:u.actions[a]}}return s},this.removePreprocessor=function(s,a){let k=u.names.indexOf(s);a?(q0(u.names,k),q0(u.actions,k)):(u.names[k]=void 0,u.actions[k]=void 0)},this.mappedFunction=function(...s){let a={},{params:k}=this;for(let $=0;$<k.length;$++)a[k[$]]=String(s[$]);return c.parse(this.body,a)},this.add=function(s,a){let k=Re(s),$=Re(a);if(k&&$){if(s.unit||a.unit)return c.Unit.add(s,a);if(s.isInfinity||a.isInfinity){let ht=s.multiplier.lessThan(0),$t=a.multiplier.lessThan(0);if(s.isInfinity&&a.isInfinity&&ht!==$t)throw new e0(`(${s})+(${a}) is not defined!`);let Wt=p.infinity();return $t&&Wt.negate(),Wt}if(s.isComposite()&&s.isLinear()&&a.isComposite()&&a.isLinear()&&(s.distributeMultiplier(),a.distributeMultiplier(),a.length>s.length&&s.group===a.group&&([s,a]=[a,s])),s.multiplier.equals(0))return a;if(a.multiplier.equals(0))return s;if(s.isConstant()&&a.isConstant()&&D.PARSE2NUMBER)return new p(s.multiplier.add(a.multiplier).toDecimal(D.PRECISION));let ee=s.group,Y=a.group,Ee=s.power.toString(),Ne=a.power.toString();if(ee<Y||ee===Y&&Number(Ee)>Number(Ne)&&Number(Ne)>0)return this.add(a,s);if(ee===qe&&Y===Ce&&s.value===a.value){let ht=s;s=a,a=ht,ee=s.group,Y=a.group,Ee=s.power.toString(),Ne=a.power.toString()}let Ie=Ee===Ne,ve=s.value,Ze=a.value,gt=s.isComposite(),St=a.isComposite(),We,xe,tt;if(gt&&(We=G(s,"hash")),St&&(xe=G(a,"hash")),ee===Be&&Y===Be&&a.isLinear()&&!s.isLinear()&&We!==xe)return this.add(a,s);ee===Ce&&Y===Ce&&(ve=We,Ze=xe);let Ye=ee===ge&&Y===Ue,st=s.value===a.multiplier.toString(),Et=ve===Ze||We===xe&&We!==void 0||Ye&&st;if(Et&&Ie&&ee===Y)if(Ye&&(a=a.convert(ge)),ee===Ce&&(Y===ye||Y===ge))s.distributeMultiplier(),tt=s.attach(a);else if(tt=s,s.multiplier.isOne()&&a.multiplier.isOne()&&ee===Be&&s.isLinear()&&a.isLinear())for(let ht in a.symbols){if(!Object.hasOwn(a.symbols,ht))continue;let $t=a.symbols[ht];tt.attach($t)}else tt.multiplier=tt.multiplier.add(a.multiplier);else if(Et&&ee!==Ce)ee===Be&&Y===Ce?(a.insert(s,"add"),tt=a):(tt=p.shell(Ce).attach([s,a]),tt.value=ee===Ce?We:ve);else if(gt&&s.isLinear()){let ht=ee===Y,$t=ee===Ce&&Y===Ce;if($t&&(ht=s.value===a.value),s.distributeMultiplier(),a.isComposite()&&a.isLinear()&&ht){a.distributeMultiplier();for(let Wt in a.symbols){if(!Object.hasOwn(a.symbols,Wt))continue;let m0=a.symbols[Wt];s.attach(m0)}tt=s}else $t&&s.value!==xe||ee===Ce&&!Et?(tt=p.shell(Be).attach([s,a]),tt.updateHash()):tt=s.attach(a)}else{if(ee===W&&s.fname===Oe&&Y!==Se&&a.power.equals(.5)){let ht=a.multiplier.clone();a=Ct(a.toUnitMultiplier().toLinear()),a.multiplier=ht}s.length===2&&a.length===2&&bt(s.power)&&bt(a.power)?tt=c.add(wt(s),wt(a)):(tt=p.shell(Be).attach([s,a]),tt.updateHash())}if(tt.multiplier.equals(0)&&(tt=new p(0)),tt.length===1){let ht=tt.multiplier;tt=o1(tt.symbols),tt.multiplier=tt.multiplier.multiply(ht)}return tt}if($&&!k){let ee=s;s=a,a=ee,ee=$,$=k,k=ee}let fe=we(a);if(k&&fe){let ee=new dt;a.eachElement((Y,Ee,Ne)=>{ee.set(Ee,Ne,c.add(s.clone(),Y))}),a=ee}else if(we(s)&&fe)a=s.add(a);else if(k&&ne(a))a.each((ee,Y)=>{Y--,a.elements[Y]=c.add(s.clone(),a.elements[Y])});else if(ne(s)&&ne(a))a.each((ee,Y)=>{Y--,a.elements[Y]=c.add(s.elements[Y],a.elements[Y])});else{if(ne(s)&&we(a))return c.add(a,s);if(we(s)&&ne(a)){if(a.elements.length===s.rows()){let ee=new dt,Y=s.cols();return a.each((Ee,Ne)=>{let Ie=[];if(ne(Ee))for(let ve=0;ve<Y;ve++)Ie.push(c.add(s.elements[Ne-1][ve].clone(),Ee.elements[ve].clone()));else for(let ve=0;ve<Y;ve++)Ie.push(c.add(s.elements[Ne-1][ve].clone(),Ee.clone()));ee.elements.push(Ie)}),ee}Ht("Dimensions must match!")}}return a},this.subtract=function(s,a){let k=Re(s),$=Re(a),fe;if(k&&$){let ee=s,Y=a;return ee.unit||Y.unit?c.Unit.subtract(ee,Y):this.add(ee,Y.negate())}if($&&ne(s))a=s.map(ee=>c.subtract(ee,a.clone()));else if(k&&ne(a))a=a.map(ee=>c.subtract(s.clone(),ee));else if(ne(s)&&ne(a)||M1(s)&&M1(a))s.dimensions()===a.dimensions()?a=s.subtract(a):c.error("Unable to subtract vectors/collections. Dimensions do not match.");else if(we(s)&&ne(a)){if(a.elements.length===s.rows()){let ee=new dt,Y=s.cols();return a.each((Ee,Ne)=>{let Ie=[];for(let ve=0;ve<Y;ve++)Ie.push(c.subtract(s.elements[Ne-1][ve].clone(),Ee.clone()));ee.elements.push(Ie)}),ee}Ht("Dimensions must match!")}else if(ne(s)&&we(a)){let ee=a.clone().negate();return c.add(ee,s)}else if(we(s)&&we(a))a=s.subtract(a);else if(we(s)&&$){let ee=new dt;s.each((Y,Ee,Ne)=>{ee.set(Ee,Ne,c.subtract(Y,a.clone()))}),a=ee}else if(k&&we(a)){let ee=new dt;a.each((Y,Ee,Ne)=>{ee.set(Ee,Ne,c.subtract(s.clone(),Y))}),a=ee}return a},this.multiply=function(s,a){let k=Re(s),$=Re(a);if(k&&a instanceof Pt)return a.elements.push(s),a;if(k&&$){if(a.isUnit){let Ye=s.clone();return s.unit=a,Ye}if(s.unit||a.unit)return c.Unit.multiply(s,a);if(s.isInfinity||a.isInfinity){if(s.equals(0)||a.equals(0))throw new e0(`${s}*${a} is undefined!`);if(a.power.lessThan(0)){if(!s.isInfinity)return new p(0);throw new e0("Infinity/Infinity is not defined!")}let Ye=s.multiplier.multiply(a.multiplier).sign(),st=p.infinity();if(s.isConstant()||a.isConstant()||s.isInfinity&&a.isInfinity)return Ye<0&&st.negate(),st}if(s.multiplier.equals(0)||a.multiplier.equals(0))return new p(0);if(s.isOne())return a.clone();if(a.isOne())return s.clone();if(s.isConstant()&&a.isConstant()&&D.PARSE2NUMBER){let Ye,st=s.multiplier.num.abs().toString().length,Et=s.multiplier.den.toString().length,ht=st-Et,$t=a.multiplier.num.abs().toString().length,Wt=a.multiplier.den.toString().length,m0=$t-Wt,mt=D.PRECISION-5;if(ht<-mt||ht>mt||m0<-mt||m0>mt){let Rt=new X(String(s.multiplier.num)),Qt=new X(String(s.multiplier.den)),H0=new X(String(a.multiplier.num)),N0=new X(String(a.multiplier.den));Ye=new p(Rt.times(H0).dividedBy(Qt).dividedBy(N0).toFixed())}else{let Rt=new X(s.multiplier.toDecimal()),Qt=new X(a.multiplier.toDecimal()),H0=Rt.times(Qt).toFixed();Ye=new p(H0)}return Ye}if(a.group>s.group&&a.group!==Be)return this.multiply(a,s);if(s.group===qe&&a.group===Ce&&s.value===a.value){let Ye=s;s=a,a=Ye}let Y=s.group,Ee=a.group,Ne=a.multiplier.num,Ie=a.multiplier.den;if(Y===W&&s.fname===Oe&&!a.isConstant()&&s.args[0].value===a.value&&!s.args[0].multiplier.lessThan(0)){let Ye=s.power,st=c.parse(s.multiplier);s=c.multiply(st,s.args[0].clone()),s.setPower(new Xe(.5).multiply(Ye)),Y=s.group}else Y===W&&s.fname===Oe&&s.multiplier.equals(1)&&s.power.equals(-1)&&a.isConstant()&&s.args[0].equals(a)&&(s=c.symfunction(Oe,[a.clone()]),a=new p(1));let ve=s.value,Ze=a.value,gt=new Xe(s.sign()),St=Y===ge&&Ee===Ue&&a.multiplier.equals(s.value),We=St?new Xe(1).multiply(s.multiplier).abs():s.multiplier.multiply(a.multiplier).abs(),xe=s.clone().toUnitMultiplier();if(a=a.clone().toUnitMultiplier(!0),Y===W&&Ee===W){let Ye=s.args[0].clone(),st=a.args[0].clone();if(s.fname===Oe&&a.fname===Oe&&s.isLinear()&&a.isLinear()){let Et=c.divide(Ye,st).invert();Et.gt(1)&&vt(Et)&&(xe=c.multiply(s.args[0].clone(),Ct(Et.clone())),a=new p(1))}else if(s.fname===l&&a.fname===l&&!Ye.isConstant()&&!st.isConstant()&&a.power<0){let Et=c.subtract(Ye.clone(),st.clone());if(Et.isConstant()){let ht=new p(1);if(Et<0){for(let $t=0,Wt=Math.abs(Et);$t<=Wt;$t++){let m0=c.add(Ye.clone(),new p($t));ht=c.multiply(ht,m0)}xe=c.multiply(c.pow(Ye,new p(s.power)),c.pow(ht,new p(a.power))),a=new p(1)}else{for(let $t=0,Wt=Math.abs(Et);$t<=Wt;$t++){let m0=c.add(st.clone(),new p($t));ht=c.multiply(ht,m0)}xe=c.multiply(c.pow(ht,new p(s.power)),c.pow(st,new p(a.power))),a=new p(1)}}}}if(ve===Ze&&Y===Ce&&Y===Ee&&(ve=s.text("hash"),Ze=a.text("hash")),Ee===Se&&a.previousGroup===Ce&&Y===Ce&&(ve=G(s,"hash",Se)),(ve===Ze||St)&&!(Y===Ce&&(Ee===ye||Ee===ge||Ee===W))&&!(Y===Ce&&Ee===qe)){let Ye=s.power,st=a.power,Et=Re(Ye),ht=Re(st),$t=Et||ht;Y===Ce&&Ee!==Ce&&a.previousGroup!==Ce&&Ye.equals(1)?(xe=new p(0),s.each(Wt=>{xe=c.add(xe,c.multiply(Wt,a.clone()))},!0)):($t?xe.power=c.add(Re(Ye)?Ye:new p(Ye),Re(st)?st:new p(st)):Y===Ue?xe.power=Ye:xe.power=Ye.add(st),xe.power.equals(0)&&(xe=xe.convert(Ue)),$t&&xe.convert(Se),s.imaginary&&a.imaginary&&bt(Number(xe.power)%2)&&(xe=new p(1),We.negate()),xe.group!==Se&&xe.previousGroup&&(xe.previousGroup=void 0),xe.multiplier=xe.multiplier.multiply(a.multiplier))}else if(Y===qe&&s.isLinear())if(Ee===qe&&a.distributeExponent(),Ee===qe&&a.isLinear()){for(let Ye in a.symbols){if(!Object.hasOwn(a.symbols,Ye))continue;let st=a.symbols[Ye];xe=xe.combine(st)}xe.multiplier=xe.multiplier.multiply(a.multiplier)}else xe.combine(a);else if(Y===Ue)xe=a.clone().toUnitMultiplier(!0);else if(Y===qe)xe.distributeExponent(),xe.combine(a);else if(!a.isOne()){let Ye=a.multiplier.clone();a.toUnitMultiplier(),xe=p.shell(qe).combine([xe,a]),xe.multiplier=xe.multiplier.multiply(Ye)}if(xe.group===ge){let Ye=Math.log(xe.value),st=Math.log(Ne)/Ye,Et=Math.log(Ie)/Ye,ht=We.num/Ne,$t=We.den/Ie;st!==0&&vt(st)&&vt(ht)&&(xe.power=xe.power.add(new Xe(st)),We.num/=Ne),Et!==0&&vt(Et)&&vt($t)&&(xe.power=xe.power.subtract(new Xe(Et)),We.den/=Ie)}if(xe.length===1){let Ye=xe.multiplier;xe=o1(xe.symbols),xe.multiplier=xe.multiplier.multiply(Ye)}let tt=xe.power.toString();if(bt(tt)&&xe.fname===Oe){gt=gt.multiply(new Xe(xe.sign()));let Ye=xe.power;xe=xe.args[0],xe=c.multiply(new p(We),c.pow(xe,new p(Ye.divide(new Xe(2))))),gt.lessThan(0)&&xe.negate()}else xe.multiplier=xe.multiplier.multiply(We).multiply(gt),xe.group===Be&&xe.isImaginary()&&xe.distributeMultiplier();return xe.group===ge&&vt(xe.power.toDecimal())&&(xe=xe.convert(Ue)),xe}if($&&!k){let Y=s;s=a,a=Y,Y=$,$=k,k=Y}let fe=we(a),ee=we(s);if(k&&fe){let Y=new dt;a.eachElement((Ee,Ne,Ie)=>{Y.set(Ne,Ie,c.multiply(s.clone(),Ee))}),a=Y}else if(ee&&fe)a=s.multiply(a);else if(k&&ne(a))a.each((Y,Ee)=>{Ee--,a.elements[Ee]=c.multiply(s.clone(),a.elements[Ee])});else if(ne(s)&&ne(a))a.each((Y,Ee)=>{Ee--,a.elements[Ee]=c.multiply(s.elements[Ee],a.elements[Ee])});else{if(ne(s)&&we(a))return this.multiply(a,s);if(we(s)&&ne(a)){if(a.elements.length===s.rows()){let Y=new dt,Ee=s.cols();return a.each((Ne,Ie)=>{let ve=[];for(let Ze=0;Ze<Ee;Ze++)ve.push(c.multiply(s.elements[Ie-1][Ze].clone(),Ne.clone()));Y.elements.push(ve)}),Y}Ht("Dimensions must match!")}}return a},this.divide=function(s,a){let k=Re(s),$=Re(a);if(k&&$){if(s.unit||a.unit)return c.Unit.divide(s,a);let Y;if(a.equals(0))throw new y1("Division by zero not allowed!");return s.isConstant()&&a.isConstant()?(Y=s.clone(),Y.multiplier=Y.multiplier.divide(a.multiplier)):(a.invert(),Y=c.multiply(s,a)),Y}let fe=ne(s),ee=ne(a);if(k&&ee)a=a.map(Y=>c.divide(s.clone(),Y));else if(fe&&$)a=s.map(Y=>c.divide(Y,a.clone()));else if(fe&&ee)s.dimensions()===a.dimensions()?a=a.map((Y,Ee)=>c.divide(s.elements[--Ee],Y)):c.error("Cannot divide vectors. Dimensions do not match!");else{let Y=we(s),Ee=we(a);if(Y&&$){let Ne=new dt;s.eachElement((Ie,ve,Ze)=>{Ne.set(ve,Ze,c.divide(Ie,a.clone()))}),a=Ne}else if(k&&Ee){let Ne=new dt;a.eachElement((Ie,ve,Ze)=>{Ne.set(ve,Ze,c.divide(s.clone(),Ie))}),a=Ne}else if(Y&&Ee){let Ne=new dt;s.rows()===a.rows()&&s.cols()===a.cols()?(s.eachElement((Ie,ve,Ze)=>{Ne.set(ve,Ze,c.divide(Ie,a.elements[ve][Ze]))}),a=Ne):c.error("Dimensions do not match!")}else if(Y&&ee)if(s.cols()===a.dimensions()){let Ne=new dt;s.eachElement((Ie,ve,Ze)=>{Ne.set(ve,Ze,c.divide(Ie,a.elements[ve].clone()))}),a=Ne}else c.error("Unable to divide matrix by vector.")}return a},this.pow=function(s,a){let k=Re(s),$=Re(a);if(k&&$){if(s.unit||a.unit)return c.Unit.pow(s,a);if(s.group===W&&s.fname===J&&bt(a)){let We=s.multiplier.clone(),xe=c.pow(s.args[0],a);return xe.multiplier=We,xe}if(s.isInfinity||a.isInfinity){if(s.isInfinity&&a.isInfinity)throw new e0(`(${s})^(${a}) is undefined!`);if(s.isConstant()&&a.isInfinity){if(s.equals(0)){if(a.lessThan(0))throw new e0("0^Infinity is undefined!");return new p(0)}if(s.equals(1))throw new e0(`1^${a.toString()} is undefined!`);if(a.lessThan(0))return new p(0);if(!s.lessThan(0))return p.infinity()}if(s.isInfinity&&a.isConstant()){if(a.equals(0))throw new e0(`${s}^0 is undefined!`);return a.lessThan(0)?new p(0):c.multiply(p.infinity(),c.pow(new p(s.sign()),a.clone()))}}let fe=s.equals(0),ee=a.equals(0);if(fe&&ee)throw new e0("0^0 is undefined!");if(fe&&a.isConstant()&&a.multiplier.greaterThan(0))return new p(0);if(ee)return new p(1);let Y=a.isConstant(),Ee=s.isConstant(),Ne=a.isInteger(),Ie=s.multiplier,ve=s.clone();if(Ee&&Y&&s.equals(0)&&a.lessThan(0))throw new e0("Division by zero is not allowed!");if(D.PARSE2NUMBER&&Ee&&Y&&s.sign()<0&&S1(a)){let We=Math.PI*Number(a.multiplier.toDecimal()),xe=new p(Math.cos(We)),tt=c.multiply(p.imaginary(),new p(Math.sin(We)));return c.add(xe,tt)}if(D.PARSE2NUMBER&&s.isImaginary()&&Y&&vt(a)&&!a.lessThan(0)){let We,xe,tt,Ye,st,Et=s.realpart(),ht=s.imagpart();if(Et.isConstant("all")&&ht.isConstant("all"))return st=D.USE_BIG?new p(X.atan2(ht.multiplier.toDecimal(),Et.multiplier.toDecimal()).times(a.toString())):Math.atan2(Number(ht.multiplier.toDecimal()),Number(Et.multiplier.toDecimal()))*Number(a.multiplier.toDecimal()),xe=new p(st),We=c.pow(p.hyp(Et,ht),a),tt=c.multiply(We.clone(),c.trig.cos(xe.clone())),Ye=c.multiply(We,c.trig.sin(xe)),c.add(tt,c.multiply(p.imaginary(),Ye))}ve.toUnitMultiplier();let Ze;if(ve.group===W&&ve.fname===Oe&&!Y){let We=ve.args[0];We.multiplyPower(new p(.5)),We.multiplier.multiply(ve.multiplier),We.multiplyPower(a),ve=We}else Ze=Ie.sign(),S1(a)&&Ze<0&&(ve.negate(),ve=c.symfunction(et,[ve]),ve.negate()),ve.multiplyPower(a);let gt,St;if(Ee&&Y&&D.PARSE2NUMBER){let We;Ze<0&&(s.negate(),a.multiplier.den.equals(2)?We=new p(D.IMAGINARY):vt(a.multiplier)?bt(a.multiplier)?We=new p(1):We=new p(-1):bt(a.multiplier.den)?We=c.pow(c.symfunction(et,[new p(Ze)]),a.clone()):We=new p(Ze**a.multiplier.num));let xe=Number(s.multiplier.toDecimal())**Number(a.multiplier.toDecimal());if(xe!==0||s.multiplier.equals(0))ve=new p(xe);else{let tt=new X(s.multiplier.toDecimal()),Ye=new X(a.multiplier.toDecimal());ve=new p(tt.pow(Ye).toFixed())}We&&(ve=c.multiply(ve,We))}else if(Ne&&!Ie.equals(1)){if(a.abs().gt(D.MAX_EXP))return a.sign()<0?new p(0):p.infinity();let xe=a.multiplier.toDecimal(),tt=Math.sign(Number(xe)),Ye=Math.abs(Number(xe)),st=new Xe(1);st.num=Ie.num.pow(Ye),st.den=Ie.den.pow(Ye),tt<0&&st.invert(),ve.multiplier=ve.multiplier.multiply(st)}else{let We=s.sign();if(a.isConstant()&&s.isConstant()&&!a.multiplier.den.equals(1)&&We<0)if(a.multiplier.den.equals(2)){let xe=new p(D.IMAGINARY);s.negate(),a.lessThan(0)&&(xe.negate(),a.negate()),ve=c.multiply(c.pow(s,a),xe)}else{let xe=s.clone();xe.multiplier.negate(),ve=c.pow(c.symfunction(et,[new p(Ze)]),a.clone());let tt=c.pow(new p(xe.multiplier.num),a.clone()),Ye=c.pow(new p(xe.multiplier.den),a.clone()),st=c.divide(tt,Ye);ve=c.multiply(ve,st)}else if(D.PARSE2NUMBER&&a.isImaginary()){let xe=a.realpart(),tt=a.imagpart(),Ye=s.clone().toLinear(),st=c.pow(Ye.clone(),xe),Et=Ae(Ye.clone()),ht=E.cos(c.multiply(tt.clone(),Et)),$t=c.multiply(E.sin(c.multiply(tt,Ae(Ye))),p.imaginary());ve=c.multiply(st,c.add(ht,$t)),ve=c.expand(c.parse(ve))}else{let xe=s.group===Ue&&We<0;if(gt=m1(new p(xe?Ie.num:Math.abs(Ie.num)).setPower(a.clone())),St=m1(new p(Ie.den).setPower(a.clone()).invert()),s.imaginary)if(Ne){let tt=Math.sign(a),st=$e(a)%4;ve=new p(bt(st)?-1:D.IMAGINARY),(st===0||tt<0&&st===1||tt>0&&st===3)&&ve.negate()}else{let tt=a.multiplier.multiply(Xe.quick(1,2)),Ye=(-1)**tt.num;ve=bt(tt.den)?new p(-1).setPower(tt,!0):new p(Ye)}if(We<0&&!xe&&ve.negate(),Y&&s.group!==Se){let tt=bt(a.multiplier.den),Ye=bt(s.power),st=ve.power.toDecimal(),Et=bt(st);if(tt&&Ye&&!Et){if(st==="1"||st==="1")typeof ve.value=="string"&&ve.value.startsWith("baseunit_")||(ve=c.symfunction(J,[ve]));else if(vt(st))ve=c.multiply(c.symfunction(J,[ve.clone().toLinear()]),ve.clone().setPower(new Xe(Number(st)-1)));else{let ht=ve.power;ve=c.symfunction(J,[ve.toLinear()]).setPower(ht)}D.POSITIVE_MULTIPLIERS&&ve.fname===J&&(ve=ve.args[0])}}if(a.equals(2)&&ve.group===qe){let tt=new p(1);ve.each(Ye=>{tt=c.multiply(tt,c.pow(Ye,a))}),ve=tt}}}if(ve=m1(ve),gt&&St&&(ve=c.multiply(ve,Un(c.multiply(gt,St)))),ve.fname===Oe){let We=ve.group===Se,xe=We?ve.power.multiplier.toString():ve.power.toString();if(bt(xe)){let tt=We?c.divide(ve.power,new p(2)):new p(ve.power.divide(new Xe(2))),Ye=ve.multiplier;ve=c.pow(ve.args[0],tt),ve.multiplier=ve.multiplier.multiply(Ye)}}else if(!D.IGNORE_E&&ve.isE()&&ve.group===Se&&ve.power.contains("pi")&&ve.power.contains(D.IMAGINARY)&&a.group===qe){let We=a.stripVar(D.IMAGINARY);ve=c.add(E.cos(We),c.multiply(p.imaginary(),E.sin(We)))}return ve}if(ne(s)&&$)s=s.map(fe=>c.pow(fe,a.clone()));else if(we(s)&&$){let fe=new dt;s.eachElement((ee,Y,Ee)=>{fe.set(Y,Ee,c.pow(ee,a.clone()))}),s=fe}else if(k&&we(a)){let fe=new dt;a.eachElement((ee,Y,Ee)=>{fe.set(Y,Ee,c.pow(s.clone(),ee))}),s=fe}return s},this.comma=function(s,a){return s instanceof Pt||(s=Pt.create(s)),s.append(a),s},this.mod=function(s,a){return ut(s,a)},this.slice=function(s,a){return new g(s,a)},this.equals=function(s,a){return s.group!==ye&&!s.isLinear()&&Ht(`Cannot set equality for ${s.toString()}`),m[s.value]=a.clone(),a},this.percent=function(s){return c.divide(s,new p(100))},this.assign=function(s,a){if(s instanceof Pt&&a instanceof Pt)return s.elements.map((k,$)=>c.assign(k,a.elements[$])),At.fromArray(a.elements);if(s.parent){let k=s.parent;return k.elements[k.getter]=a,delete k.getter,k}if(s.group!==ye)throw new F1(`Cannot complete operation. Incorrect LH value for ${s}`);return m[s.value]=a,a},this.functionAssign=function(s,a){let k=s.elements.pop();return ze(k,s.elements,a)};let X0=function(s){return new p(s===!0?1:0)};this.eq=function(s,a){return X0(s.equals(a))},this.gt=function(s,a){return X0(s.gt(a))},this.gte=function(s,a){return X0(s.gte(a))},this.lt=function(s,a){return X0(s.lt(a))},this.lte=function(s,a){return X0(s.lte(a))},this.factorial=function(s){return this.symfunction(l,[s])},this.dfactorial=function(s){return this.symfunction(w,[s])}}c=new x,hn._=c,ct._=c,Object.defineProperty(ln,"functions",{get:()=>c.functions,configurable:!0}),Object.defineProperty(an,"CONSTANTS",{get:()=>c.CONSTANTS,configurable:!0}),Object.defineProperty(O0,"VARS",{get:()=>m,configurable:!0}),Object.defineProperty(i0,"VARS",{get:()=>m,configurable:!0}),i0._clearFunctions=_e,i0._initConstants=()=>c.initConstants(),Yt._=c,Yt.C=ot,te={parser:(function(){let i=["classes","setOperator","getOperators","getBrackets","tokenize","toRPN","tree","units"],u=new x;for(let S in u)i.indexOf(S)===-1&&delete u[S];u.setOperator({precedence:8,operator:"\\",action:"slash",prefix:!0,postfix:!1,leftAssoc:!0,operation(S){return S}}),u.setOperator({precedence:8,operator:"\\,",action:"slash_comma",prefix:!0,postfix:!1,leftAssoc:!0,operation(S){return S}});let g=u.getBrackets();return g["{"].maps_to=void 0,u})(),space:"~",dot:" \\cdot ",latex(e,i){if(e.clone&&(e=e.clone()),e instanceof c.classes.Collection&&(e=e.elements),Ft(e)){let pe=[];for(let ae=0;ae<e.length;ae++){let De=e[ae];Re(De)||(De=c.parse(De)),pe.push(this.latex(De,i))}return this.brackets(pe.join(", "),"square")}if(we(e)){let pe=`\\begin{pmatrix}
`;for(let ae=0;ae<e.elements.length;ae++){let De=[],Le=e.elements[ae];for(let Pe=0;Pe<Le.length;Pe++)De.push(this.latex(Le[Pe],i));pe+=De.join(" & "),ae<e.elements.length-1&&(pe+=`\\\\
`)}return pe+="\\end{pmatrix}",pe}if(ne(e)){let pe="\\left[";for(let ae=0;ae<e.elements.length;ae++)pe+=`${this.latex(e.elements[ae],i)} ${ae===e.elements.length-1?"":",\\,"}`;return pe+="\\right]",pe}if(V1(e)){let pe="\\{";for(let ae=0;ae<e.elements.length;ae++)pe+=`${this.latex(e.elements[ae],i)} ${ae===e.elements.length-1?"":",\\,"}`;return pe+="\\}",pe}e=e.clone();let u=i==="decimal"||i==="decimals",{power:g}=e,S=me(g),N=e.multiplier.lessThan(0);if(e.group===ge&&u)return String(e.multiplier.toDecimal()*e.value**e.power.toDecimal());e.multiplier=e.multiplier.abs();let E;u?E=[String(e.multiplier.toDecimal()),""]:E=[e.multiplier.num,e.multiplier.den];let q=this.value(e,S,i,N),C;S&&g.negate(),u?(C=Re(g)?te.latex(g,i):String(g.toDecimal()),String(C)==="1"&&(C="")):Re(g)?C=this.latex(g,i):C=this.formatFrac(g,!0);let P=["",""],Z=S?1:0;return P[Z]=C,((N?"-":"")+this.set(E,q,P,e.group===qe)).replace(/\+-/giu,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},symbols:{arccos:"\\arccos",cos:"\\cos",csc:"\\csc",exp:"\\exp",ker:"\\ker",limsup:"\\limsup",min:"\\min",sinh:"\\sinh",arcsin:"\\arcsin",cosh:"\\cosh",deg:"\\deg",gcd:"\\gcd",lg:"\\lg",ln:"\\ln",Pr:"\\Pr",sqrt:"\\sqrt",sup:"\\sup",arctan:"\\arctan",cot:"\\cot",det:"\\det",hom:"\\hom",lim:"\\lim",log:"\\log",LN:"\\LN",sec:"\\sec",tan:"\\tan",arg:"\\arg",coth:"\\coth",dim:"\\dim",inf:"\\inf",liminf:"\\liminf",max:"\\max",sin:"\\sin",tanh:"\\tanh"},value(e,i,u,g){let{group:S}=e,{previousGroup:N}=e,E=["",""],q=i?1:0;if(e.isInfinity)E[q]="\\infty";else if(S===ye||S===ge||N===ye||N===ge||N===Ue){let C=this.formatSubscripts(e.value);C.replace&&(C=C.replace(/(?<prefix>.+)_$/u,"$1\\_"));let P=String(C).split("_"),Z=this.greek[P[0]];Z&&(P[0]=Z,C=P.join("_"));let oe=this.symbols[P[0]];oe&&(P[0]=oe,C=P.join("_")),E[q]=C}else if(S===W||N===W){let C=[],{fname:P}=e;for(let Z=0;Z<e.args.length;Z++){let oe=e.args[Z],pe;typeof oe=="string"?pe=oe:pe=this.latex(oe,u),C.push(pe)}if(P===Oe)E[q]=`\\sqrt${this.braces(C.join(","))}`;else if(P===J)E[q]=this.brackets(C.join(","),"abs");else if(P===et)E[q]=this.brackets(C.join(","),"parens");else if(P==="limit")E[q]=` \\lim\\limits_{${C[1]} \\to ${C[2]}} ${C[0]}`;else if(P==="integrate")E[q]=`\\int${this.braces(C[0])}${this.braces(`d${C[1]}`)}`;else if(P==="defint")E[q]=`\\int\\limits_${this.braces(C[1])}^${this.braces(C[2])} ${C[0]} d${C[3]}`;else if(P===l||P===w){let Z=e.args[0];Z.power.equals(1)&&(Z.isComposite()||Z.isCombination())&&(C[0]=this.brackets(C[0])),E[q]=C[0]+(P===l?"!":"!!")}else if(P==="floor")E[q]=`\\left \\lfloor${this.braces(C[0])}\\right \\rfloor`;else if(P==="ceil")E[q]=`\\left \\lceil${this.braces(C[0])}\\right \\rceil`;else if(P===D.LOG&&C.length>1)E[q]=`\\mathrm${this.braces(D.LOG)}_${this.braces(C[1])}${this.brackets(C[0])}`;else if(P===D.LOG10)E[q]=`\\mathrm${this.braces(D.LOG)}_${this.braces(10)}${this.brackets(C[0])}`;else if(P===D.LOG2)E[q]=`\\mathrm${this.braces(D.LOG)}_${this.braces(2)}${this.brackets(C[0])}`;else if(P===D.LOG1P)E[q]=`\\ln${this.brackets(`1 + ${C[0]}`)}`;else if(P==="sum"){let Z=C[0],oe=C[1],pe=C[2],ae=C[3];E[q]=`\\sum\\limits_{${this.braces(oe)}=${this.braces(pe)}}^${this.braces(ae)} ${this.braces(Z)}`}else if(P==="product"){let Z=C[0],oe=C[1],pe=C[2],ae=C[3];E[q]=`\\prod\\limits_{${this.braces(oe)}=${this.braces(pe)}}^${this.braces(ae)} ${this.braces(Z)}`}else if(P==="nthroot")E[q]=`\\sqrt[${C[1]}]${this.braces(C[0])}`;else if(P==="mod")E[q]=`${C[0]} \\bmod ${C[1]}`;else if(P==="realpart")E[q]=`\\operatorname{Re}${this.brackets(C[0])}`;else if(P==="imagpart")E[q]=`\\operatorname{Im}${this.brackets(C[0])}`;else{let Z=P===""?"":`\\mathrm${this.braces(P.replace(/_/gu,"\\_"))}`;e.isConversion?E[q]=Z+this.brackets(C.join(""),"parens"):E[q]=Z+this.brackets(C.join(","),"parens")}}else if(e.isComposite()){let C=e.collectSymbols().sort(S===Be||N===Be?(pe,ae)=>ae.group-pe.group:(pe,ae)=>{let De=Re(pe.power)?-1:pe.power;return(Re(ae.power)?-1:ae.power)-De}),P=[],Z=C.length;for(let pe=0;pe<Z;pe++)P.push(te.latex(C[pe],u));let oe=P.join("+");E[q]=!(e.isLinear()&&e.multiplier.equals(1))||g?this.brackets(oe,"parens"):oe}else if(S===qe||N===Se||N===qe){S===qe&&e.distributeExponent();let C=[],P=[],Z=[],oe=[],pe=0,ae=0,De=function(Le,Pe,Ke){if(Ke>1&&Pe.length>0){let $e=Pe.length;for(let je=0;je<$e;je++){let ft=Pe[je],_t=Le[ft];/^\\left\(.+\\right\)\^\{.+\}$/gu.test(_t)||/^\\left\(.+\\right\)$/gu.test(_t)||(Le[ft]=te.brackets(_t,"parens"))}}return Le};e.each(Le=>{let Pe=me(Le.power),Ke;Pe?(Ke=te.latex(Le.invert(),u),ae++,Le.isComposite()&&(!e.multiplier.den.equals(1)&&Math.abs(Le.power)===1&&(Ke=te.brackets(Ke,"parens")),Z.push(C.length)),C.push(Ke)):(Ke=te.latex(Le,u),pe++,Le.isComposite()&&(!e.multiplier.num.equals(1)&&Math.abs(Le.power)===1&&(Ke=te.brackets(Ke,"parens")),oe.push(P.length)),P.push(Ke))}),De(P,oe,pe),E[0]=P.join(this.dot),De(C,Z,ae),E[1]=C.join(this.dot)}return E},set(e,i,u,g){let S=function(pe){return/^\\left\(.+\\right\)$/u.test(pe)};u&&=this.formatP(u);let N;g&&(N=u[0],u[0]=""),i=this.merge(i,u);let E=e[0],q=e[1],C=i[0],P=i[1];C&&Number(E)===1&&(E=""),Number(q)===1&&(q="");let Z=this.join(E,C,S(C)?"":this.dot),oe=this.join(q,P,S(P)?"":this.dot);if(Z&&oe){let pe=this.frac(Z,oe);return g&&N&&(pe=this.brackets(pe)+N),pe}return Z},merge(e,i){let u=[];for(let g=0;g<2;g++)u[g]=e[g]+i[g];return u},join(e,i,u){return!e&&!i?"":e&&!i?e:i&&!e?i:e+u+i},formatSubscripts(e){let i=e.toString().split("_"),u="";for(;i.length>1;)i.length>0&&(u=`_${this.braces(i.pop()+u)}`);return i[0]+u},formatP(e){for(let i=0;i<2;i++){let u=e[i];u&&(e[i]=`^${this.braces(u)}`)}return e},formatFrac(e,i){let u=e.num.toString(),g=e.den.toString();return i&&u==="1"&&g==="1"?"":g==="1"?u:this.frac(u,g)},frac(e,i){return`\\frac${this.braces(e)}${this.braces(i)}`},braces(e){return`{${e}}`},brackets(e,i){i||="parens";let g={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[i];return`\\left${g[0]}${e}\\right${g[1]}`},filterTokens(e){let i=[];Ft(e)&&(i.type=e.type);let u=["\\","left","right","big","Big","large","Large"];for(let g=0,S=e.length;g<S;g++){let N=e[g],E=e[g+1];N.value==="\\"&&E.value==="\\"?i.push(N):Ft(N)?i.push(te.filterTokens(N)):u.indexOf(N.value)===-1&&i.push(N)}return i},parse(e){let i,u,g="",S=this.filterTokens(e),N={cdot:"",times:"",infty:"Infinity"},E=function(P){return S[typeof P>"u"?++i:i+=P]},q=function(){return te.parse(E())},C=function(P){return P in N?N[P]:P==="*"&&S[i+1].value==="&"?(E(2),","):P==="&"?(E(),","):P==="\\"?"],[":P};for(i=0,u=S.length;i<u;i++){let P=S[i];if(P.value==="frac"){let Z=q(),oe=q();g+=`${Z}/${oe}`}else if(P.value in te.symbols)if(P.value===Oe&&S[i+1].type==="vector"&&S[i+2].type==="NerdamerSet"){let Z=q(),oe=q();g+=`${oe}^${kt(`1/${Z}`)}`}else g+=P.value+q();else if(P.value==="int"){let Z=q();i++;let oe=E().value;oe=C(oe.substring(1,oe.length)),g+=`integrate${kt(`${Z},${oe}`)}`}else if(P.value==="int_"){let Z=q();i++;let oe=E().value;oe===void 0&&(i--,oe=q());let pe=q(),ae=E().value;ae===","&&(ae=E().value),ae==="differentialD"&&(i++,ae=E().value),ae==="mathrm"&&(i++,ae=E().value),g+=`defint${kt(`${pe},${Z},${oe},${ae}`)}`}else if(P.value&&P.value.startsWith("int_")){let Z=P.value.replace("int_","");i++;let oe=E().value;oe===void 0&&(i--,oe=q());let pe=q(),ae=E().value;ae===","&&(ae=E().value),ae==="differentialD"&&(i++,ae=E().value),ae==="mathrm"&&(i++,ae=E().value),g+=`defint${kt(`${pe},${Z},${oe},${ae}`)}`}else if(P.value==="mathrm"){let Z=S[++i][0].value;g+=Z+q()}else if(P.value==="sum_"||P.value==="prod_"){let Z=P.value==="sum_"?"sum":"product",oe=E();i++;let pe=q(),ae=q();g+=Z+kt([ae,C(oe[0]),C(oe[2]),C(pe)].join(","))}else if(P.value==="lim_"){let Z=E();g+=`limit${kt([q(),C(Z[0]),C(Z[2])].join(","))}`}else if(P.value==="begin"){let Z=E();Array.isArray(Z)&&Z[0].value==="matrix"&&(g+="matrix([")}else if(P.value==="end"){let Z=E();Array.isArray(Z)&&Z[0].value==="matrix"&&(g+="])")}else Array.isArray(P)?g+=C(te.parse(P)):g+=C(P.value.toString())}return kt(g)}},Object.defineProperty(Bt,"EXPRESSIONS",{get:()=>r,configurable:!0}),Object.defineProperty(Bt,"USER_FUNCTIONS",{get:()=>_,configurable:!0}),Bt.LaTeX=te,Bt.text=G,Bt.functions=c.functions,Bt._=c,Je.Frac=Xe,Je.NerdamerSymbol=p,Je.isVector=ne,Je.isArray=Ft,Je.isMatrix=we,Je.isSymbol=Re,Je.block=l0,Je._=c,Je.Settings=D,Je.text=G,Je.LaTeX=te,lt.Frac=Xe,lt.NerdamerSymbol=p,lt.Vector=At,lt.isMatrix=we,lt.isVector=ne,lt.isArray=Ft,lt.isSymbol=Re,lt.block=l0,lt._=c,lt.err=Ht,lt.LaTeX=te,D0.isVector=ne,D0.Vector=At,D0.remove=q0,y0._=c,y0.block=l0,Jt.Math2=O,Jt.Frac=Xe,Jt.NerdamerSymbol=p,Jt.isInt=vt,Jt.nround=E0,Jt.even=bt,Jt.block=l0,Jt._=c,Jt.variables=R,Jt.inBrackets=kt,Jt.FN=W,Jt.N=Ue,Jt.S=ye,Jt.P=ge,Jt.EX=Se,Jt.CB=qe,r0.dependencies={_rename:{"Math2.factorial":"factorial"},factorial:{"Math2.gamma":O.gamma},gamma_incomplete:{"Math2.factorial":O.factorial},Li:{"Math2.Ei":O.Ei,"Math2.bigLog":O.bigLog,Frac:Xe},Ci:{"Math2.factorial":O.factorial},Ei:{"Math2.factorial":O.factorial},Si:{"Math2.factorial":O.factorial},Shi:{"Math2.factorial":O.factorial},Chi:{isInt:vt,nround:E0,"Math2.num_integrate":O.num_integrate},factor:{"Math2.ifactor":O.ifactor,NerdamerSymbol:p},num_integrate:{"Math2.simpson":O.simpson,nround:E0},fib:{even:bt}},r0.reformat={diff(e,i){let u=e.args[1].toString(),g=`let f = ${r0.build(e.args[0].toString(),[u])};`,S=O.diff.toString();return!S.startsWith("function")&&!S.startsWith("(")&&!S.startsWith("async")&&(S=`function ${S}`),i[1]+=`let diff = ${S};`,i[1]+=g,[`diff(f)(${u})`,i]}},ct.Build=r0,(function(){l1(c.CONSTANTS),l1(c.functions),c.initConstants(),c.error||=Ht,D.LOG_FNS={log:c.functions.log,log10:c.functions.log10}})();let de={allSame:r1,allNumeric:Wn,arguments2Array:Xn,armTimeout:H1,arrayAddSlices:Zn,arrayClone:jn,arrayMax:Gn,arrayMin:w1,arrayEqual:Hn,arrayUnique:v1,arrayGetVariables:Ge,arraySum:V,block:l0,build:r0.build,checkTimeout:h1,clearU:ii,comboSort:Jn,compare:be,convertToVector:Te,customError:t0,customType:Vn,decompose_fn:He,disarmTimeout:j1,each:K1,evaluate:qt,even:bt,evenFraction:S1,fillHoles:ue,firstObject:o1,format:Dt,generatePrimes:Z1,getCoeffs:rt,getU:it,importFunctions:Qe,inBrackets:kt,isArray:Ft,isExpression:F,isFraction:B,isInt:vt,isMatrix:we,isNegative:me,isNumericSymbol:k0,isPrime:z0,isReserved:a1,isSymbol:Re,isVariableSymbol:G1,isVector:ne,isCollection:M1,keys:q1,knownVariable:zn,nroots:Fe,remove:q0,reserveNames:l1,range:bn,round:E0,sameSign:Pn,scientificToDecimal:j0,separate:K,stringReplace:Bn,text:G,validateName:M0,variables:R,warn:_1};ot={groups:re,NerdamerSymbol:p,Expression:Gt,Collection:Pt,Frac:Xe,Vector:At,Matrix:dt,Parser:x,Scientific:Vt,Fraction:Q1,Math2:O,LaTeX:te,Utils:de,PARSER:c,PARENTHESIS:et,Settings:D,err:Ht,bigInt:T,bigDec:X,exceptions:j},Bt.Math2=ot.Math2,Bt.Expression=Gt;let f=function(e,i,u,g){H1();try{let S=!1;if(ze(e))return gn;e!==null&&typeof e=="object"&&e instanceof Gt&&(e=e.toString()),Ft(u)||(u=typeof u>"u"?[]:[u]),u.forEach(E=>{if(E==="numer"){S=!0;return}let q=c.functions[E];q&&q[1]===1&&(e=`${E}(${e})`)});let N=l0("PARSE2NUMBER",()=>c.parse(e,i),S||D.PARSE2NUMBER);return g?r[g-1]=N:r.push(N),new Gt(N)}finally{j1()}};return i0.libExports=f,Z0.libExports=f,Z0.CONSTANTS=c.CONSTANTS,p0.libExports=f,p0.VARS=m,p0.CONSTANTS=c.CONSTANTS,p0.parse=c.parse.bind(c),p0.isSymbol=Re,p1.libExports=f,p1._setFunction=ze,S0.libExports=f,S0.EXPRESSIONS=r,C0.libExports=f,C0.Settings=D,C0.functions=c.functions,jt.bigDec=X,jt.Settings=D,jt.functions=c.functions,jt.symfunction=c.symfunction.bind(c),jt.NerdamerSymbol=p,h0.libExports=f,h0.functions=c.functions,h0.parse=c.parse.bind(c),h0.callfunction=c.callfunction.bind(c),h0.Expression=Gt,f.rpn=Ei,f.convertToLaTeX=mi,f.convertFromLaTeX=qi,f.version=ui,f.getWarnings=ri,f.setConstant=Ui,f.getConstant=pi,f.clearConstants=Ti,f.setFunction=$i,f.clearFunctions=Ci,f.getCore=ci,f.getExpression=f.getEquation=Gt.getExpression,f.reserved=ai,f.clear=X1,i0.clear=X1,f.flush=Ri,f.expressions=_i,f.functions=Ii,f.register=cn,f.validateName=M0,f.validVarName=li,f.supported=fi,f.numEquations=f.numExpressions=si,f.setVar=xi,f.getVar=hi,f.clearVars=Oi,f.load=Li,f.getVars=gi,f.set=C1,f.get=oi,f.updateAPI=ki,f.replaceFunction=Ai,f.setOperator=Si,f.getOperator=di,f.aliasOperator=wi,f.tree=un,f.htmlTree=Mi,f.addPeeker=vi,f.removePeeker=yi,f.parse=Ni,f.updateAPI(),f})({bigInt:z1,bigDec:W1,constants:Dn});typeof T1<"u"&&(T1.exports=gn)});var Y0=w0((Xi,mn)=>{"use strict";var J0=typeof globalThis<"u"&&globalThis.nerdamer?globalThis.nerdamer:void 0;typeof mn<"u"&&J0===void 0&&(J0=b0(),K0());(function(){let n=J0.getCore(),t=n.PARSER,{Frac:T}=n,{Settings:X}=n,{isSymbol:re}=n.Utils,{FN:ce}=n.groups,{NerdamerSymbol:z}=n,{text:ie}=n.Utils,{inBrackets:D}=n.Utils,{isInt:c}=n.Utils,{format:te}=n.Utils,{even:ot}=n.Utils,{evaluate:Re}=n.Utils,{N:Ue}=n.groups,{S:ge}=n.groups,{PL:ye}=n.groups,{CP:Se}=n.groups,{CB:W}=n.groups,{EX:Ce}=n.groups,{P:qe}=n.groups,{LOG:Be}=X,Ve="exp",et="abs",Oe="sqrt",J="sin",l="cos",w="tan",r="sec",m="csc",v="cot",y="asin",_="acos",B="atan",F="asec",R="acsc",V="acot",K="sinh",ue="cosh",ne="tanh",we="csch",me="sech",be="coth",ze="asech",_e="acsch",Fe="acoth";function He(H){this.message=H||""}He.prototype=new Error,z.prototype.hasIntegral=function(){return this.containsFunction("integrate")},z.prototype.fnTransform=function(){if(this.group!==ce)return this;let j,O=this.args[0],G=new z(this.multiplier),p=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case K:j=t.parse(te("(e^({0})-e^(-({0})))/2",O));break;case ue:j=t.parse(te("(e^({0})+e^(-({0})))/2",O));break;case ne:j=t.parse(te("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",O));break;case w:j=t.parse(te("sin({0})/cos({0})",O));break;case m:j=t.parse(te("1/sin({0})",O));break;case r:j=t.parse(te("1/cos({0})",O));break;default:j=p}else if(this.power.equals(2))switch(this.fname){case J:j=t.parse(te("1/2-cos(2*({0}))/2",O));break;case l:j=t.parse(te("1/2+cos(2*({0}))/2",O));break;case w:j=t.parse(te("sin({0})^2/cos({0})^2",O));break;case ue:j=t.parse(te("1/2+cosh(2*({0}))/2",O));break;case K:j=t.parse(te("-1/2+cosh(2*({0}))/2",O));break;case ne:j=t.parse(te("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",O));break;case r:j=t.parse(te("(1-cos(2*({0})))/(1+cos(2*({0})))+1",O));break;default:j=p}else if(this.fname===r)j=t.parse(te("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===m)j=t.parse(te("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===w)this.power.lessThan(0)?j=t.parse(te("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):j=t.parse(te("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===J&&this.power.lessThan(0))j=t.parse(te("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===l&&this.power.lessThan(0))j=t.parse(te("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===J&&this.power.equals(3))j=t.parse(te("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===l&&this.power.equals(3))j=t.parse(te("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if((this.fname===l||this.fname===J)&&ot(this.power)){let x=this.power/2,de=t.pow(this.clone().toLinear(),t.parse(2)).fnTransform(),f=t.expand(t.pow(de,t.parse(x)));j=new z(0),f.each(e=>{let i=e.fnTransform();j=t.add(j,i)},!0)}else j=p;return t.multiply(j,G)},z.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===ge)return!1;if(this.fname&&(n.Utils.inTrig(this.fname)||n.Utils.inInverseTrig(this.fname)))return!0;if(this.symbols){for(let j in this.symbols)if(this.symbols[j].hasTrig())return!0}return!1},n.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},n.Utils.toCommonDenominator=function(j){if(j.isComposite()&&j.isLinear()){let O=new z(j.multiplier),G=new z(1),p=new z(0);return j.each(de=>{G=t.multiply(G,de.getDenom())},!0),j.each(de=>{let f=de.getNum(),e=de.getDenom(),i=t.multiply(f,t.divide(G.clone(),e));p=t.add(p,i)}),t.multiply(O,n.Algebra.divide(t.expand(p),t.expand(G)))}return j},n.Utils.inInverseTrig=function(j){return[y,_,B,R,F,V].indexOf(j)!==-1},n.Utils.inTrig=function(j){return[l,J,w,r,m,v].indexOf(j)!==-1},n.Utils.inHtrig=function(j){return[K,ue,ne,_e,ze,Fe].indexOf(j)!==-1},n.Matrix.jacobian=function(j,O){let G=new n.Matrix;return O||=n.Utils.arrayGetVariables(j),O.forEach((p,x)=>{j.forEach((de,f)=>{let e=n.Calculus.diff(de.clone(),p);G.set(f,x,e)})}),G},n.Matrix.prototype.max=function(){let j=new z(0);return this.each(O=>{let G=O.abs();G.gt(j)&&(j=G)}),j},n.Matrix.cMatrix=function(j,O){let G=new n.Matrix;return O.forEach((p,x)=>{G.set(x,0,t.parse(j))}),G};let it=n.Utils.allFunctions=function(j){for(let O=0,G=j.length;O<G;O++)if(j[O].group!==ce)return!1;return!0},Ge=n.Utils.cosAsinBtranform=function(j,O){let G=j.args[0],p=O.args[0];return t.parse(te("(sin(({0})+({1}))-sin(({0})-({1})))/2",G,p))},Qe=n.Utils.cosAsinAtranform=function(j,O){if(Number(O.power)!==1)return t.multiply(j,O);let G=j.args[0];return t.parse(te("(sin(2*({0})))/2",G))},rt=n.Utils.cosAsinBtranform=function(j,O){let G=j.args[0],p=O.args[0];return t.parse(te("(cos(({0})+({1}))-cos(({0})-({1})))/2",G,p))},Te=n.Utils.trigTransform=function(j){let O={},G,p,x=new z(1);for(let de=0,f=j.length;de<f;de++)if(G=j[de],G.group===ce){let{fname:e}=G;e===l&&O[J]?(O[J].args[0].toString()===G.args[0].toString()?p=Qe(G,O[J]):p=Ge(G,O[J]),delete O[J],x=t.multiply(x,p)):e===J&&O[l]?(O[l].args[0].toString()===G.args[0].toString()?p=Qe(G,O[l]):p=Ge(G,O[l]),delete O[l],x=t.multiply(x,p)):e===J&&O[J]?(O[J].args[0].toString()===G.args[0].toString()?(p=t.multiply(G,O[J]),delete O[J]):(p=rt(G,O[J]),delete O[J]),x=p):O[e]=G}else x=t.multiply(x,G);for(let de in O)Object.hasOwn(O,de)&&(x=t.multiply(x,O[de]));return x};n.Settings.integration_depth=10,n.Settings.max_lim_depth=10;let b=n.Calculus={version:"1.4.6",sum(H,j,O,G){if(j.group!==n.groups.S)throw new n.exceptions.NerdamerTypeError(`Index must be symbol. ${ie(j)} provided`);j=j.value;let p;if(n.Utils.isNumericSymbol(O)&&n.Utils.isNumericSymbol(G)){let x=G-O<200?"":"PARSE2NUMBER";O=Number(O),G=Number(G),p=n.Utils.block(x,()=>{let de=H.text(),f={"~":!0},e=new n.NerdamerSymbol(0);for(let i=O;i<=G;i++){f[j]=new z(i);let u=t.parse(de,f);e=t.add(e,u)}return e})}else p=t.symfunction("sum",[H,j,O,G]);return p},product(H,j,O,G){if(j.group!==n.groups.S)throw new n.exceptions.NerdamerTypeError(`Index must be symbol. ${ie(j)} provided`);j=j.value;let p;if(n.Utils.isNumericSymbol(O)&&n.Utils.isNumericSymbol(G)){let x=G-O<200?"":"PARSE2NUMBER";p=n.Utils.block(x,()=>{O=Number(O),G=Number(G.multiplier);let de=H.text(),f={},e=new n.NerdamerSymbol(1);for(let i=O;i<=G;i++)f[j]=new z(i),e=t.multiply(e,t.parse(de,f));return e})}else p=t.symfunction("product",[H,j,O,G]);return p},diff(H,j,O){if(n.Utils.isVector(H)){let e=new n.Vector([]);return H.each(i=>{e.elements.push(b.diff(i,j,O))}),e}if(n.Utils.isMatrix(H)){let e=new n.Matrix;return H.each((i,u,g)=>{e.set(u,g,b.diff(i,j,O))}),e}if(H.LHS&&H.RHS)return new n.Equation(b.diff(H.LHS.clone(),j,O),b.diff(H.RHS.clone(),j,O));let G=re(j)?j.text():j;if(O=re(O)?O.multiplier:O||1,G===void 0&&(G=n.Utils.variables(H)[0]),H.group===ce&&H.fname===Oe){let e=H.args[0],i=H.power.clone();(e.group!==Ue||e.group!==qe)&&(e.power=re(e.power)?t.multiply(e.power,t.multiply(new z(1/2)),i):e.power.multiply(new T(.5)).multiply(i),e.multiplier=e.multiplier.multiply(H.multiplier)),H=e}if(H.group===ce&&!re(H.power)){let e=x(t.parse(H)),i=b.diff(H.args[0].clone(),G);H=t.multiply(e,i)}else H=x(H);return O>1&&(O--,H=b.diff(H,j,O)),H;function p(e){return(e.value===G||e.contains(G,!0))&&(e.multiplier=e.multiplier.multiply(e.power),e.power=e.power.subtract(new T(1)),e.power.equals(0)&&(e=z(e.multiplier))),e}function x(e){let i=e.group,u,g,S;if(i===Ue||i===ge&&e.value!==G||i===qe)e=z(0);else if(i===ge)e=p(e);else if(i===W){let N=e.multiplier.clone();e.toUnitMultiplier();let E=t.multiply(f(e),p(e));return E.multiplier=E.multiplier.multiply(N),E}else if(i===ce&&e.power.equals(1)){let N=e.multiplier.clone();switch(e.toUnitMultiplier(),e.fname){case Be:S=e.clone(),e=e.args[0].clone(),e.power=e.power.negate(),e.multiplier=S.multiplier.divide(e.multiplier);break;case l:e.fname=J,e.multiplier.negate();break;case J:e.fname=l;break;case w:e.fname=r,e.power=new T(2);break;case r:e=de(e,w);break;case m:e=de(e,"-cot");break;case v:e.fname=m,e.multiplier.negate(),e.power=new T(2);break;case y:e=t.parse(`(sqrt(1-(${ie(e.args[0])})^2))^(-1)`);break;case _:e=t.parse(`-(sqrt(1-(${ie(e.args[0])})^2))^(-1)`);break;case B:e=t.parse(`(1+(${ie(e.args[0])})^2)^(-1)`);break;case et:g=e.args[0].clone(),g.toUnitMultiplier(),e=t.parse(`${D(ie(e.args[0]))}/abs${D(ie(g))}`);break;case"parens":e=z(1);break;case"cosh":e.fname="sinh";break;case"sinh":e.fname="cosh";break;case ne:e.fname=me,e.power=new T(2);break;case me:e=de(e,"-tanh");break;case we:{let E=String(e.args[0]);e=t.parse(`-coth(${E})*csch(${E})`);break}case be:{let E=String(e.args[0]);e=t.parse(`-csch(${E})^2`);break}case"asinh":e=t.parse(`(sqrt(1+(${ie(e.args[0])})^2))^(-1)`);break;case"acosh":e=t.parse(`(sqrt(-1+(${ie(e.args[0])})^2))^(-1)`);break;case"atanh":e=t.parse(`(1-(${ie(e.args[0])})^2)^(-1)`);break;case ze:{let E=String(e.args[0]);e=t.parse(`-1/(sqrt(1/(${E})^2-1)*(${E})^2)`);break}case Fe:e=t.parse(`-1/((${e.args[0]})^2-1)`);break;case _e:{let E=String(e.args[0]);e=t.parse(`-1/(sqrt(1/(${E})^2+1)*(${E})^2)`);break}case F:{let E=String(e.args[0]);e=t.parse(`1/(sqrt(1-1/(${E})^2)*(${E})^2)`);break}case R:{let E=String(e.args[0]);e=t.parse(`-1/(sqrt(1-1/(${E})^2)*(${E})^2)`);break}case V:e=t.parse(`-1/((${e.args[0]})^2+1)`);break;case"S":{let E=String(e.args[0]);e=t.parse(`sin((pi*(${E})^2)/2)`);break}case"C":{let E=String(e.args[0]);e=t.parse(`cos((pi*(${E})^2)/2)`);break}case"Si":{let E=e.args[0];e=t.parse(`sin(${E})/(${E})`);break}case"Shi":{let E=e.args[0];e=t.parse(`sinh(${E})/(${E})`);break}case"Ci":{let E=e.args[0];e=t.parse(`cos(${E})/(${E})`);break}case"Chi":{let E=e.args[0];e=t.parse(`cosh(${E})/(${E})`);break}case"Ei":{let E=e.args[0];e=t.parse(`e^(${E})/(${E})`);break}case"Li":{let E=e.args[0];e=t.parse(`1/${X.LOG}(${E})`);break}case"erf":e=t.parse(`(2*e^(-(${e.args[0]})^2))/sqrt(pi)`);break;case"atan2":{let E=String(e.args[0]),q=String(e.args[1]);e=t.parse(`(${q})/((${q})^2+(${E})^2)`);break}case"sign":e=new z(0);break;case"sinc":e=t.parse(te("(({0})*cos({0})-sin({0}))*({0})^(-2)",e.args[0]));break;case X.LOG10:e=t.parse(`1/((${e.args[0]})*${X.LOG}(10))`);break;default:e=t.symfunction("diff",[e,j])}e.multiplier=e.multiplier.multiply(N)}else if(i===Ce||i===ce&&re(e.power)){let N;i===Ce?N=e.value:i===ce&&e.contains(G)?N=e.fname+D(ie(e.args[0])):N=e.value+D(ie(e.args[0])),g=b.diff(t.multiply(t.parse(Be+D(N)),e.power.clone()),G),e=t.multiply(e,g)}else if(i===ce&&!e.power.equals(1))g=e.clone(),g.toLinear(),g.toUnitMultiplier(),e=t.multiply(p(e.clone()),x(g));else if(i===Se||i===ye){let N=e.clone(),E=new z(0);for(let q in e.symbols)Object.hasOwn(e.symbols,q)&&(E=t.add(E,b.diff(e.symbols[q].clone(),G)));e=t.multiply(p(N),E)}return e.updateHash(),e}function de(e,i,u){return t.multiply(e,t.parse(i+D(u||ie(e.args[0]))))}function f(e){let i=e.collectSymbols(),u=new z(0),g=i.length;for(let S=0;S<g;S++){let N=b.diff(i[S].clone(),G);for(let E=0;E<g;E++)S!==E&&(N=t.multiply(N,i[E].clone()));u=t.add(u,N)}return u}},integration:{u_substitution(H,j){let O="__u__";function G(u,g,S){let N=b.diff(g,j),E=S?S(u,g):t.divide(u.clone(),N);return E.contains(j,!0)?null:E}function p(u,g){let S=b.integrate(t.symfunction(u,[new z(O)]),O,0);return S=S.sub(new z(O),g),S.updateHash(),S}let x=H[0].clone(),de=H[1].clone(),f=x.group,e=de.group,i;if(f===ce&&e!==ce){let u=x.args[0];if(i=G(de,u.clone()),i)return t.multiply(i,p(x.fname,u));if(i=G(de,x),i)return b.integration.poly_integrate(x)}else if(e===ce&&f!==ce){let u=de.args[0];if(i=G(x,u.clone()),i)return t.multiply(i,p(de.fname,u))}else if(f===ce&&e===ce){if(i=G(x.clone(),de.clone()),i||(i=G(de.clone(),x.clone()),i))return t.multiply(b.integration.poly_integrate(de),i)}else if(f===Ce&&e!==Ce){let u=x.power;if(i=G(de,u.clone()),!i){let N=b.integration.decompose_arg(u.clone(),j),E=b.diff(N[2].clone(),j),q=b.integration.decompose_arg(E.clone(),j);if(t.multiply(N[1],q[1]).power.equals(de.power)){let C=t.divide(N[0].clone(),q[0].clone()),P=t.multiply(C.clone(),t.pow(new z(x.value),t.multiply(N[0],new z(O))));return P=t.multiply(P,new z(O)),b.integration.by_parts(P,O,0,{}).sub(O,N[1].clone())}}let g=b.integrate(x.sub(u.clone(),new z(O)),O,0);return t.multiply(g.sub(new z(O),u),i)}else if(e===Ce&&f!==Ce){let u=de.power;i=G(x,u.clone());let g=b.integrate(de.sub(u,new z(O)),O,0);return t.multiply(g.sub(new z(O),u),i)}else if(x.isComposite()||de.isComposite()){let u=function(N,E){let q=b.diff(E,j),C=n.Algebra.Factor.factorInner(N),P=n.Algebra.Factor.factorInner(q);return t.divide(C,P)},g=x.isComposite()?x.clone().toLinear():x.clone(),S=de.isComposite()?de.clone().toLinear():de.clone();if(i=G(g.clone(),S.clone(),u),i)return t.multiply(b.integration.poly_integrate(de),i);if(i=G(S.clone(),g.clone(),u),i)return t.multiply(b.integration.poly_integrate(x),i)}},poly_integrate(H){let j=H.power.toString(),O=H.multiplier.toDecimal(),G=H.toUnitMultiplier().toLinear();return Number(j)===-1?t.multiply(new z(O),t.symfunction(Be,[G])):t.parse(te("({0})*({1})^(({2})+1)/(({2})+1)",O,G,j))},stop(H){throw H||="Unable to compute integral!",n.Utils.warn(H),new He(H)},partial_fraction(H,j,O,G){re(j)||(j=t.parse(j));let p;p=new z(0);let x=n.Algebra.PartFrac.partfrac(H,j);return x.group===W&&x.isLinear()?(x.each(de=>{de.isLinear()||b.integration.stop()}),x.each(de=>{p=t.add(p,b.integrate(de,j,O,G))})):p=t.add(p,b.integrate(x,j,O,G)),p},get_udv(H){let j=[[],[],[],[],[]],O=function(x){let de=x.group;if(de===ce){let{fname:f}=x;n.Utils.inTrig(f)||n.Utils.inHtrig(f)?j[3].push(x):n.Utils.inInverseTrig(f)?j[1].push(x):f===Be?j[0].push(x):b.integration.stop()}else de===ge||x.isComposite()&&x.isLinear()||de===W&&x.isLinear()?j[2].push(x):de===Ce||x.isComposite()&&!x.isLinear()?j[4].push(x):b.integration.stop()};H.group===W?H.each(x=>{O(z.unwrapSQRT(x,!0))}):O(H);let G,p=new z(1);for(let x=0;x<5;x++){let de=j[x],f,e=de.length;if(e>0){if(e>1){f=new z(1);for(let i=0;i<e;i++)f=t.multiply(f,de[i].clone())}else f=de[0].clone();G?p=t.multiply(p,f):(G=f,G.multiplier=G.multiplier.multiply(H.multiplier))}}return[G,p]},trig_sub(H,j,O,G,p,x){p||=b.integration.decompose_arg(H.clone().toLinear(),j);let de=p[3],f=p[2],e=p[0],i=p[1];if(i.power.equals(2)&&e.greaterThan(0)){let u=n.Utils.getU(H),g=t.parse(w+D(u)),S=t.parse(`${r+D(u)}^2`),N=t.multiply(H.sub(i,g),S),E=b.integrate(N,u,O,G).sub(g,i);return n.Utils.clearU(g),E}},by_parts(H,j,O,G){G.previous||=[];let p,x=b.integration.get_udv(H),de=x[0],f=x[1],e=z.unwrapSQRT(t.expand(b.diff(de.clone(),j)),!0),i=e.clone().stripVar(j);e=t.divide(e,i.clone());let u=b.integrate(f.clone(),j,O||0),g=t.multiply(u.clone(),e),S=g.toString();if(G.previous.indexOf(S)!==-1&&n.Utils.inTrig(de.fname)&&f.isE())return G.is_cyclic=!0,new z(1);G.previous.push(S);let N=t.multiply(de,u),E=g.multiplier.clone();g.toUnitMultiplier();let q=t.multiply(b.integrate(g.clone(),j,O,G),i);if(q.multiplier=q.multiplier.multiply(E),p=t.subtract(N,q),G.is_cyclic&&(G.previous.pop(),G.previous.length===0)){p=t.expand(p);let C=new z(0);p.each(P=>{P.contains(j)||(C=t.add(C,P.clone()))}),p=t.divide(t.subtract(p,C.clone()),t.subtract(new z(1),C))}return p},decompose_arg:n.Utils.decompose_fn},integrate(H,j,O,G){if(!j){let p=n.Utils.variables(H);p.length===1&&(j=p[0]),j||="x"}if(n.Utils.isVector(H)){let p=new n.Vector([]);return H.each(x=>{p.elements.push(b.integrate(x,j))}),p}return isNaN(j)||t.error(`variable expected but received ${j}`),H.isConstant(!0)?t.multiply(H.clone(),t.parse(j)):(G||={},n.Utils.block("PARSE2NUMBER",()=>{O||=0;let p=re(j)?j.toString():j,x=z.unwrapSQRT(H.clone(),!0),de=x.group,f;try{if(++O>n.Settings.integration_depth&&b.integration.stop("Maximum depth reached. Exiting!"),!x.contains(p,!0))f=t.multiply(x.clone(),t.parse(p));else if(de===ge)f=b.integration.poly_integrate(x,p,O);else if(de===Ce)if(x.previousGroup===ce&&!(x.fname==="sqrt"||x.fname===X.PARENTHESIS)&&b.integration.stop(),x.contains(p)&&x.previousGroup!==ce)x.power.contains(p)?b.integration.stop():(b.diff(x.clone().toLinear(),p).contains(p)&&b.integration.stop(),f=b.integration.poly_integrate(x,p,O));else{let e=b.diff(x.power.clone(),p);if(e.contains(p)){let i=e.stripVar(p),u=t.divide(e.clone(),i.clone());if(u.group===ge&&u.isLinear())return i.multiplier=i.multiplier.divide(new T(2)),t.parse(te("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",i,p,x.multiplier));b.integration.stop()}if(x.isE())e.isLinear()?f=x:e.isE()&&e.power.group===ge&&e.power.power.equals(1)?f=t.multiply(t.symfunction("Ei",[x.power.clone()]),x.power):b.integration.stop();else{let i=t.symfunction(Be,[t.parse(x.value)]);f=t.divide(x,i)}f=t.divide(f,e)}else if(x.isComposite()&&x.isLinear()){let e=t.parse(x.multiplier);x.toUnitMultiplier(),f=new z(0),x.each(i=>{f=t.add(f,b.integrate(i,p,O))}),f=t.multiply(e,f)}else if(de===Se)if(x.power.greaterThan(1)&&(x=t.expand(x)),x.power.equals(1))f=new z(0),x.each(e=>{f=t.add(f,b.integrate(e,p,O))},!0);else{let e=Number(x.power),i=x.multiplier.clone();x.toUnitMultiplier();let u=x.clone().toLinear(),g=b.integration.decompose_arg(u,p),S=g[3],N=g[2],E=g[0],q=g[1];if(e===-1&&q.group!==ye&&q.power.equals(2)){let C=c(S)?S>0:!0;if(q.group===ge&&q.power.equals(2)&&C){let P=function(De){let Le=new z(1);return De.each(Pe=>{Le=t.multiply(Le,Pe.fname==="abs"?Pe.args[0]:Pe)}),Le},Z=E.clone(),oe=S.clone();Z=t.pow(Z,new z(1/2)),oe=t.pow(oe,new z(1/2));let pe=t.multiply(P(oe),P(Z)),ae=t.symfunction(B,[t.divide(t.multiply(E,q.toLinear()),pe.clone())]);f=t.divide(ae,pe)}else if(q.group===ge&&q.isLinear())f=t.divide(b.integration.poly_integrate(x),E);else if(q.power.equals(4)){let P=D,Z=t.parse(`${Oe+P(E)}*${p}^2`),oe=t.parse(`${Oe+P(2)}*${P(E)}^${P("1/4")}*${P(S)}^${P("1/4")}*${p}`),pe=t.parse(Oe+P(S)),ae=t.add(t.add(Z.clone(),oe.clone()),pe.clone()),De=t.add(t.subtract(Z,oe),pe),Le=t.parse(`${Oe+P(2)}*${P(S)}^${P("3/4")}`),Pe=t.parse(`${Oe+P(S)}*${P(S)}^${P("1/4")}*${p}`),Ke=t.parse(`2*${P(S)}*${Oe}${P(2)}*${P(S)}^${P("1/4")}`),$e=t.divide(t.subtract(Le.clone(),Pe.clone()),t.multiply(Ke.clone(),De)),je=t.divide(t.add(Le,Pe),t.multiply(Ke,ae.clone()));f=t.add(b.integrate($e,p,O,G),b.integrate(je,p,O,G))}else f=b.integration.partial_fraction(x,p,O)}else if(e===-1/2)if(q.group===ge&&q.power.equals(2))if(N.multiplier.lessThan(0)&&!S.multiplier.lessThan(0))if(E.negate(),S.isConstant()&&E.isConstant()){let C=t.symfunction(Oe,[E.clone()]),P=t.symfunction(Oe,[t.multiply(E.clone(),S)]);f=t.divide(t.symfunction(y,[t.divide(N.toLinear(),P)]),C)}else{let C=t.symfunction(Oe,[E]),P=t.multiply(C.clone(),q.clone().toLinear());f=t.divide(t.symfunction(B,[t.divide(P,t.symfunction(Oe,[u.clone()]))]),C)}else b.integration.stop();else b.integration.stop();else if(e===1/2&&q.power.equals(2)&&E.greaterThan(0))b.integration.stop();else if(q.isLinear()&&q.group!==ye)f=t.divide(b.integration.poly_integrate(x),E);else if(q.power.equals(2)&&E.greaterThan(0)){let C=t.parse(Oe+D(E)),P=t.parse(Oe+D(S)),Z=t.multiply(C.clone(),P.clone()).invert(),oe=t.pow(S,new z(x.power)),pe=n.Utils.getU(x),ae=t.multiply(Z,q.clone().toLinear()),De=t.symfunction(B,[ae]),Le=(Math.abs(x.power)-1)*2,Pe=b.integrate(t.parse(`${l+D(pe)}^${Le}`));return n.Utils.clearU(pe),t.multiply(Pe.sub(pe,De),oe)}else if(x.group!==W&&!x.power.lessThan(0))f=b.integration.by_parts(x,p,O,G);else{let C=x.clone().toLinear(),Z=n.Algebra.Factor.factorInner(C).toString()!==C.toString();if(n.Algebra.degree(C,t.parse(p)).equals(2)&&!Z)try{let oe=n.Algebra.sqComplete(C,p),pe=n.Utils.getU(C),ae=oe.f.sub(oe.a,pe),De=t.pow(ae,t.parse(x.power));f=b.integrate(De,pe).sub(pe,oe.a)}catch(oe){if(oe.message==="timeout")throw oe;b.integration.stop()}else f=b.integration.partial_fraction(x,p,O,G)}f.multiplier=f.multiplier.multiply(i)}else if(de===ce){let e=x.args[0],i=x.multiplier.clone();x.toUnitMultiplier();let u=b.integration.decompose_arg(e,p),g=u[0],S=u[1],{fname:N}=x;if(N===Be||N===y||N===_||N===B&&S.isLinear()){let E=x.power.toString();if(c(E)&&(O-=E),e.isComposite()){let q=n.Utils.getU(x),C=t.pow(t.parse(Be+D(q)),new z(E)),P=b.diff(e,p),Z=t.multiply(C,P),oe=b.integrate(Z,q,O,G);f=t.multiply(t.parse(i),oe.sub(q,e))}else f=t.multiply(t.parse(i),b.integration.by_parts(x,p,O,G))}else if(N===w&&x.power.lessThan(0)){let E=x.clone();return E.power.negate(),E.fname=v,t.multiply(t.parse(i),b.integrate(E,p,O))}else{if(!g.contains(p,!0)&&x.isLinear())if(N===et){let E=t.divide(e.clone(),g.clone());if(E.group===ge&&!E.power.lessThan(0))if(n.Utils.even(E.power))f=b.integrate(e,p,O);else{let q=b.integrate(E,p,O);q.power=q.power.subtract(new T(1)),f=t.multiply(t.multiply(t.symfunction(et,[E.toLinear()]),q),g)}else b.integration.stop()}else{let E=x.args[0].group,q=b.integration.decompose_arg(e,p);switch((!(E===Se||E===ge||E===W)||!q[1].power.equals(1)||e.hasFunc())&&b.integration.stop(),N){case l:f=t.symfunction(J,[e]);break;case J:f=t.symfunction(l,[e]),f.negate();break;case w:f=t.parse(te(`${X.LOG}(sec({0}))`,e));break;case r:f=t.parse(te(`${X.LOG}(tan({0})+sec({0}))`,e));break;case m:f=t.parse(te(`-${X.LOG}(csc({0})+cot({0}))`,e));break;case v:f=t.parse(te(`${X.LOG}(sin({0}))`,e));break;case K:f=t.symfunction(ue,[e]);break;case ue:f=t.symfunction(K,[e]);break;case ne:f=t.parse(te(`${X.LOG}(cosh({0}))`,e));break;case F:f=b.integration.by_parts(x,p,O,G);break;case R:f=b.integration.by_parts(x,p,O,G);break;case V:f=b.integration.by_parts(x,p,O,G);break;case ze:f=b.integration.by_parts(x,p,O,G);break;case _e:f=b.integration.by_parts(x,p,O,G);break;case Fe:f=b.integration.by_parts(x,p,O,G);break;case me:f=t.parse(te("atan(sinh({0}))",e));break;case we:f=t.parse(te(`${X.LOG}(tanh(({0})/2))`,e));break;case be:f=t.parse(te(`${X.LOG}(sinh({0}))`,e));break;case Ve:f=b.integrate(t.parse(te("e^({0})",e)),p,O);break;case"S":{let C=x.args[0].clone(),P=b.integration.decompose_arg(C,p),Z=P[1],oe=P[0],pe=P[3];f=t.parse(te("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",oe,pe,S));break}case"C":{let C=x.args[0].clone(),P=b.integration.decompose_arg(C,p),Z=P[1],oe=P[0],pe=P[3];f=t.parse(te("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",oe,pe,Z));break}case"erf":{let C=x.args[0].clone(),P=b.integration.decompose_arg(C,p),Z=P[1],oe=P[0];f=t.parse(te("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",oe,Z,C));break}case"sign":f=t.multiply(x.clone(),e.clone());break;default:b.integration.stop()}f=t.divide(f,g)}else if(S.isLinear())if(N===l||N===J){let E=Number(x.power);if(E<0)x.fname=N===J?m:r,x.invert().updateHash(),f=b.integrate(x,p,O);else{let q=x.args[0],C=x.clone(),P=x.clone(),Z=new z((E-1)/E),oe=t.multiply(g.clone(),new z(E)).invert();C.power=C.power.subtract(new T(1)),P.power=P.power.subtract(new T(2));let pe=t.symfunction(N===l?J:l,[e.clone()]);N===J&&pe.negate(),f=t.add(t.multiply(t.multiply(oe,C),pe),t.multiply(Z,b.integrate(t.parse(P),p,O)))}}else if(N===w||N===v){if(x.args[0].isLinear(p)){let E=x.power.subtract(new T(1)).toString(),q=x.clone().toUnitMultiplier(),C=t.parse(te(`${N===v?"-":""}1/({2}*{0})*{3}({1})^({0})`,E,e,g,N));q.power=q.power.subtract(new T(2)),q.power.equals(0)&&(q=t.parse(q)),f=t.subtract(C,b.integrate(q,p,O))}}else if(N===r||N===m){let E=x.power.subtract(new T(1)).toString(),q=x.power.subtract(new T(2)).toString(),C=N===r?w:v,P=x.clone().toUnitMultiplier(),Z=te(`${N===m?"-":""}1/({0}*{1})*{4}({3})^({2})*{5}({3})`,g,E,q,e,N,C),oe=t.parse(Z);P.power=P.power.subtract(new T(2)),P.power.equals(0)&&(P=t.parse(P)),f=t.add(oe,t.multiply(new z(q/E),b.integrate(P,p,O)))}else(N===ue||N===K)&&x.power.equals(2)?f=b.integrate(x.fnTransform(),p,O):b.integration.stop();else b.integration.stop();f.multiplier=f.multiplier.multiply(i)}}else if(de===ye)f=b.integration.partial_fraction(x,p,O);else if(de===W){x.getDenom().group===ge&&(x=t.expand(x));let i=x.stripVar(p),u=t.divide(x.clone(),i.clone());if(i.contains(p)&&(u=t.multiply(u,i),i=new z(1)),u.group===W){let g=u.collectSymbols().sort((N,E)=>N.group===E.group?Number(N.power)===Number(E.power)?N<E?1:-1:E.power-N.power:E.group-N.group).map(N=>{let E=z.unwrapSQRT(N,!0);return E.fname===Ve?t.parse(te("({1})*e^({0})",E.args[0],E.multiplier)):E}),S=g.length;if(x.power<0){if(S===2)return b.integrate(t.expand(x),p,O,G)}else if(S===2){try{f=b.integration.u_substitution(g,p)}catch(N){if(N.message==="timeout")throw N}if(!f){let N=g[0].group,E=g[1].group,q=g[0],C=g[1],P=q.fname,Z=C.fname;if(x=t.multiply(q.clone(),C.clone()),N===ce&&E===ce)if(P===Be||Z===Be)f=b.integration.by_parts(x.clone(),p,O,G);else{g.sort((Pe,Ke)=>Ke.fname>Pe.fname);let oe=q.args[0];(!oe.isLinear()||!(oe.group===Se||oe.group===W||oe.group===ge))&&b.integration.stop();let pe=b.integration.decompose_arg(oe,p),ae=pe[1],De=pe[0];ae.isLinear()||b.integration.stop();let Le=C.args[0];if(oe.equals(Le))if(P===J&&Z===l||P===l&&Z===J)if(q.power.lessThan(0)&&b.integration.stop(),P===J&&q.power.add(C.power).equals(0))q.fname=w,q.updateHash(),f=b.integrate(q,p,O);else if(ot(q.power)&&Z===l&&C.power.lessThan(0)){let Pe=Number(q.power)/2,Ke=t.parse(te("(1-cos({0})^2)^({1})",q.args[0],Pe));f=b.integrate(t.expand(t.multiply(Ke,C.clone())),p,O,G)}else if(ot(q.power)&&Z===J&&C.power.lessThan(0)){let Pe=Number(q.power)/2,Ke=t.parse(te("(1-sin({0})^2)^({1})",q.args[0],Pe));f=b.integrate(t.expand(t.multiply(Ke,C.clone())),p,O,G)}else{let Pe=n.Utils.even(q.power),Ke=n.Utils.even(C.power);if(f=new z(0),!Pe||!Ke){let $e,je;Pe?($e=q,je=C):($e=C,je=q);let ft=$e.fname===l?-1:1,ut=(je.power-1)/2,Nt=t.parse(`(1-${$e.fname}${n.Utils.inBrackets(oe)}^2)^${ut}`);t.expand(t.multiply(new z(ft),t.multiply($e.clone(),Nt))).each(Mt=>{f=t.add(f,b.integration.poly_integrate(Mt.clone()))})}else{let $e=function(Nt){let Mt=Nt.power/2,xt;return Nt.fname===l?xt=`((1/2)+(cos(2*(${Nt.args[0]}))/2))^${Mt}`:xt=`((1/2)-(cos(2*(${Nt.args[0]}))/2))^${Mt}`,t.parse(xt)},je=$e(q),ft=$e(C),_t=t.multiply(je,ft);return t.expand(_t).each(Nt=>{f=t.add(f,b.integrate(Nt,p,O))}),t.multiply(f,i)}}else if(P===r&&Z===w&&ae.isLinear()&&C.isLinear())f=t.parse(te("sec({0})^({1})/({1})",q.args[0],q.power));else if(P===w&&Z===r&&ae.isLinear())if(q.isLinear()&&C.isLinear())f=t.divide(t.symfunction(r,[oe.clone()]),De);else if(ot(q.power)){let Pe=Number(q.power)/2,Ke=t.parse(te("(sec({0})^2-1)^({1})",q.args[0],Pe));f=b.integrate(t.expand(t.multiply(Ke,C)),p,O)}else b.integration.stop();else if(P===r&&Z===l)q.fname=l,q.invert().updateHash(),f=b.integrate(t.multiply(q,C),p,O);else if(P===J&&Z===m)C.fname=J,C.invert().updateHash(),f=b.integrate(t.multiply(q,C),p,O);else if(P===w&&(Z===l||Z===J)&&C.power.lessThan(0)){let Pe=t.multiply(q.fnTransform(),C);f=b.integrate(t.expand(Pe),p,O)}else{let Pe=t.multiply(q.fnTransform(),C.fnTransform());f=b.integrate(t.expand(Pe),p,O)}else if((P===J||P===l)&&(Z===J||Z===l))if(q.isLinear()&&C.isLinear())if(q.args[0].isLinear()&&C.args[0].isLinear()){let Pe,Ke;Z===J?(Pe=q.args[0],Ke=C.args[0]):(Ke=q.args[0],Pe=C.args[0]);let $e=t.parse(te("(sin(({1})+({0}))+sin(({1})-({0})))/2",Pe.toString(),Ke.toString()));f=b.integrate($e,p,O)}else{let Pe=Te(g);f=b.integrate(t.expand(Pe),p,O)}else{let Pe=new z(1);g.forEach($e=>{let je=$e.fnTransform();Pe=t.multiply(Pe,je)});let Ke=t.expand(Pe);f=b.integrate(Ke,p,O),f.hasIntegral()&&(f=b.integrate(Te(Pe.collectSymbols()),p,O))}else b.integration.stop()}else if(N===ce&&E===ge){let oe=q.isLinear();if(q.fname===l&&oe&&C.power.equals(-1))f=t.symfunction("Ci",[q.args[0]]);else if(q.fname===l&&C.power.equals(-1))f=b.integrate(t.multiply(q.fnTransform(),C.clone()),p,O);else if(q.fname===ue&&oe&&C.power.equals(-1))f=t.symfunction("Chi",[q.args[0]]);else if(q.fname===ue&&C.power.equals(-1))f=b.integrate(t.multiply(q.fnTransform(),C.clone()),p,O);else if(q.fname===J&&oe&&C.power.equals(-1))f=t.symfunction("Si",[q.args[0]]);else if(q.fname===J&&C.power.equals(-1))f=b.integrate(t.multiply(q.fnTransform(),C.clone()),p,O);else if(q.fname===K&&oe&&C.power.equals(-1))f=t.symfunction("Shi",[q.args[0]]);else if(q.fname===K&&C.power.equals(-1))f=b.integrate(t.multiply(q.fnTransform(),C.clone()),p,O);else if(q.fname===Be&&C.power.equals(-1))f=b.integration.poly_integrate(q,p,O);else if(q.fname==="erf"){if(C.power.equals(1)){let pe=b.integration.decompose_arg(q.args[0],p),ae=pe[0],De=pe[1],Le=q.args[0].toString();f=t.parse(te("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",ae,De,Le))}}else f=b.integration.by_parts(x,p,O,G)}else if(N===Ce&&E===ge){let oe=P===Be?b.integration.decompose_arg(q.args[0],p)[1]:null;q.isE()&&(q.power.group===ge||q.power.group===W)&&C.power.equals(-1)?f=t.symfunction("Ei",[q.power.clone()]):P===Be&&oe.value===C.value?f=b.integration.poly_integrate(q,p,O):f=b.integration.by_parts(x,p,O,G)}else if(N===ye&&E===ge){if(C.value===q.value&&q.power.equals(-1)){let oe=Math.min.apply(null,n.Utils.keys(q.symbols)),pe=Math.min(oe,C.power),ae=C.clone();ae.power=new T(pe),C=t.divide(C,ae.clone());let De=new z(0);q.each(Le=>{De=t.add(De,t.divide(Le.clone(),ae.clone()))}),De.multiplier=q.multiplier,x=t.divide(C,De)}else x=t.expand(x);f=b.integration.partial_fraction(x,p,O)}else if(N===Se&&E===ge){let oe=q.clone().toLinear(),pe=n.Algebra.degree(oe,t.parse(p)).equals(1);if(q.power.equals(-1/2)){let ae=b.integration.decompose_arg(q.clone().toLinear(),p),De=ae[0].negate(),Le=ae[1],Pe=ae[3],Ke=Number(q.power),$e=Number(C.power);if(c($e)&&n.Utils.even($e)&&Le.power.equals(2)){let je=t.divide(t.multiply(t.pow(Pe.clone(),new z(2)),t.symfunction(Oe,[t.divide(Pe.clone(),De.clone())])),t.pow(De.clone(),new z(2)));je=t.multiply(je,t.symfunction(Oe,[Pe]).invert());let ft=t.parse("sin(u)");ft.power=ft.power.multiply(C.power);let _t=b.integrate(ft,"u",O),ut=t.parse(`${y}(${Oe}(${De}/${Pe})*${p})`);f=t.multiply(je,_t.sub(new z("u"),ut))}else if(Ke===-1/2){let je=function(ft,_t){let ut=t.parse(b.integrate(ft,p,O,G).sub(p,te(_t,p)));if(!ut.hasIntegral())return ut};$e===-1?f=je(t.expand(t.expand(t.pow(t.multiply(q.invert(),C.invert()),new z(2)))).invert(),"sqrt(1-1/({0})^2)"):$e===-2&&(f=je(t.sqrt(t.expand(t.divide(t.pow(x,new z(2)).invert(),t.pow(new z(p),new z(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(q.power.equals(-1)&&C.isLinear()&&pe)f=b.integration.partial_fraction(x,p,O);else if(!q.power.lessThan(0)&&c(q.power)){let ae=t.expand(q);f=new z(0),ae.each(De=>{De.group===ye?De.each(Le=>{f=t.add(f,b.integrate(t.multiply(C.clone(),Le),p,O))}):f=t.add(f,b.integrate(t.multiply(C.clone(),De),p,O))})}else if(q.power.lessThan(-2))f=b.integration.by_parts(x,p,O,G);else if(q.power.lessThan(0)&&C.power.greaterThan(1)){let ae=b.integration.decompose_arg(q.clone().toLinear(),p),De=ae[0].negate(),Le=ae[1],Pe=ae[3],Ke=q.clone().toLinear();if(Le.group!==ye&&Le.isLinear()){let $e=Number(C.power),je="_u_",ft=new z(je),_t=t.expand(t.divide(t.pow(t.subtract(ft.clone(),Pe.clone()),new z($e)),ft.clone())),ut={};ut[je]=Ke;let Nt=t.parse(_t,ut);f=b.integrate(Nt,p,0)}else if(C.power.greaterThan(Le.power)||C.power.equals(Le.power)){let $e=new n.Algebra.Classes.Factors;q=n.Algebra.Factor.coeffFactor(q.invert(),$e);let je=n.Algebra.divide(C,q);je.group===W?f=b.integration.by_parts(x,p,O,G):(f=new z(0),je.each(ft=>{f=t.add(f,b.integrate(ft,p,O))}),$e.each(ft=>{f=t.divide(f,ft)}),f=t.expand(f))}else f=b.integration.partial_fraction(x,p,O)}else if(q.power.den.equals(2)){let ae=b.integration.decompose_arg(q.clone().toLinear(),p),De=ae[3],Le=ae[1],Pe=ae[0],Ke=ae[2];if(Le.power.equals(2)&&Pe.lessThan(0)){De.equals(1)||(i=t.multiply(i,t.pow(De,new z(2))));let $e=p,je=t.divide(t.pow(Pe.clone().negate(),new z(1/2)),t.pow(De,new z(1/2))),ft=t.symfunction(l,[new z($e)]),_t=t.pow(t.symfunction(l,[new z($e)]),new z(q.power.num)),ut=t.pow(t.symfunction(J,[new z($e)]),new z(C.power)),Nt=t.multiply(t.multiply(_t,ft),ut);f=b.integrate(Nt,$e,O).sub($e,t.symfunction(y,[t.multiply(new z(p),je)]))}else f=b.integration.partial_fraction(x,p,O,G)}else pe&&(f=b.integration.partial_fraction(x,p,O))}else if(q.isComposite()&&C.isComposite())if(f=new z(0),q.power.greaterThan(0)&&C.power.greaterThan(0))t.expand(x).each(pe=>{f=t.add(f,b.integrate(pe,p,O))},!0);else{let oe=Number(q.power),pe=Number(C.power);if(oe<0&&pe>0){let ae=q;q=C,C=ae}oe===-1&&pe===-1?f=b.integration.partial_fraction(x,p):q.each(ae=>{let De=t.multiply(ae,C.clone()),Le=b.integrate(De,p,O);f=t.add(f,Le)})}else if(N===Se&&g[0].power.greaterThan(0))q=t.expand(q),f=new z(0),q.each(oe=>{f=t.add(f,b.integrate(t.multiply(oe,C.clone()),p,O))},!0);else if(N===ce&&E===Ce&&n.Utils.inHtrig(q.fname))q=q.fnTransform(),f=b.integrate(t.expand(t.multiply(q,C)),p,O);else if(N===ce&&E===Se||E===ce&&N===Se){if(E===ce&&N===Se){let Ke=q;q=C,C=Ke}let oe,pe,ae,De,Le=z.unwrapSQRT(b.diff(q.clone(),p),!0),Pe=z.unwrapSQRT(C,!0);if(Le.power.equals(Pe.power)){if(oe=new z(C.power),ae=Le.clone().toLinear(),De=C.clone().toLinear(),pe=n.Algebra.divide(ae.toLinear(),De),pe.isConstant()){let Ke=t.pow(pe,oe.negate());f=t.multiply(Ke,b.integration.poly_integrate(q.clone()))}}else f=b.integration.by_parts(x,p,O,G)}else{let oe=q.clone().toLinear(),pe=C.clone().toLinear();N===Ce&&E===Ce&&q.power.contains(p)&&C.power.contains(p)&&!oe.contains(p)&&!pe.contains(p)?f=t.parse(te("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",oe.toString(),pe.toString(),q.power.multiplier.toString(),C.power.multiplier.toString(),p)):f=b.integration.by_parts(x,p,O,G)}}}else if(S===3&&(g[2].group===ge&&g[2].power.lessThan(2)||g[0].group===Se)){let N=g[0];if(N.group===Se){N.power.greaterThan(1)&&(N=t.expand(N));let E=t.multiply(g[1],g[2]);f=new z(0),N.each(q=>{let C=t.multiply(q,E.clone()),P=b.integrate(C,p,O);f=t.add(f,P)},!0)}else f=b.integration.by_parts(x,p,O,G)}else if(it(g)){let N=new z(1);for(let E=0,q=g.length;E<q;E++)N=t.multiply(N,g[E].fnTransform());N=t.expand(N),f=b.integrate(N,p,O)}else{let N=Te(g);f=b.integrate(t.expand(N),p,O)}}else{if(u.equals(1))return b.integrate(t.expand(x),p,O);u.clone().toLinear().isPoly(!0)&&n.Utils.variables(u).length>1&&(u=n.Algebra.Factor.factorInner(u)),f=b.integrate(u,p,O)}f=t.multiply(f,i)}if(f)return f}catch(e){if(e.message==="timeout"||!(e instanceof He||e instanceof n.exceptions.DivisionByZero))throw e}return t.symfunction("integrate",[H,j])},!1))},defint(H,j,O,G){G||="x";let p=function(i,u,g){try{return t.parse(i,u)}catch(S){if(S.message==="timeout")throw S;return b.Limit.limit(i,G,g)}},x=n.Utils.variables(H),de=H.hasTrig(),f,e;if(x.length===1&&!G&&(G=x[0]),de||(e=b.integrate(H,G)),!de&&!e.hasIntegral()){let i={},u={};i[G]=O,u[G]=j;let g=p(e,i,O,G),S=p(e,u,j,G);f=t.subtract(g,S)}else if(x.length===1&&j.isConstant()&&O.isConstant()){let i=n.Utils.build(H);f=new z(n.Math2.num_integrate(i,Number(j),Number(O)))}else f=t.symfunction("defint",[H,j,O,G]);return f},Limit:{interval(H,j){return t.parse(te("[{0}, {1}]",H,j))},diverges(){return b.Limit.interval("-Infinity","Infinity")},divide(H,j,O,G,p){if(p++>X.max_lim_depth)return;let x=H.clone(),de=j.clone();if(j.fname===et){let C=H.sign(),P=G.sign();if(G.isInfinity)return t.multiply(new z(C),new z(P));if(G.equals(0)){let Z=t.parse(H.multiplier),oe=t.parse(j.multiplier);return t.divide(t.multiply(Z,b.Limit.interval("-1","1")),oe)}return b.Limit.diverges()}let f=function(C){if(n.Utils.isVector(C)){for(let P=0;P<C.elements.length;P++)if(!C.elements[P].isInfinity)return!1;return!0}return C.isInfinity},e=function(C,P){return n.Utils.isVector(C)?!1:C.equals(P)},i,u=0,g,S,N;do if(g=Re(b.Limit.limit(H.clone(),O,G,p)),S=Re(b.Limit.limit(j.clone(),O,G,p)),N=f(g)&&f(S)||e(g,0)&&e(S,0),N){let C=b.diff(H.clone(),O),P=b.diff(j.clone(),O),Z=t.divide(C,P);H=Z.getNum(),j=Z.getDenom()}while(N&&++u<X.max_lim_depth);if(u>=X.max_lim_depth)return;let E=S.equals(0),q=Number(de.power);return G.isConstant(!0)&&E?i=z.infinity(n.Utils.even(q)&&g.lessThan(0)?-1:void 0):E?i=b.Limit.diverges():i=t.divide(g,S),i},rewriteToLog(H){let j=H.power.clone();return H.toLinear(),t.pow(new z("e"),t.multiply(j,t.symfunction(`${X.LOG}`,[H])))},getSubbed(H,j,O){let G;H.group===Ce&&(H=b.rewriteToLog(H));try{G=H.sub(j,O)}catch(p){if(p.message==="timeout")throw p;G=H}return G},isInterval(H){return n.Utils.isVector(H)},isConvergent(H){return!(b.Limit.isInterval(H)&&H.elements[0].isInfinity&&H.elements[1].isInfinity||H.containsFunction("limit"))},limit(H,j,O,G){if(H.isLinear()&&H.isComposite()){let de=new z(0);return H.each(f=>{de=t.add(de,b.Limit.limit(f,j,O,G))},!0),de}if(H=n.Algebra.Simplify.simplify(H),G||=1,G++>X.max_lim_depth)return;let p=t.parse(H.multiplier);H.toUnitMultiplier();let x;try{if(H.isConstant(!0))x=H;else{let de={};de[j]=O;try{let f=t.parse(H.sub(j,O),de);(f.isConstant(!0)||f.isInfinity)&&(x=f)}catch(f){if(f.message==="timeout")throw f}if(!x){let f=H.getNum(),e=H.getDenom();if(e.isConstant(!0)){if(H.group===Ce){let i=H.clone().toLinear(),u=H.power.clone(),g=i.getNum(),S=i.getDenom(),N=n.Utils.decompose_fn(S,j,!0);if(g.group===ge&&g.multiplier.isOne()&&N.ax.group===ge&&N.b.isConstant(!0)&&N.a.isOne()&&N.b.isConstant(!0))x=t.parse(te("(1/e^({0}))",N.b));else{let E=b.Limit.rewriteToLog(H.clone()),q=E.power.clone(),C=E.clone().toLinear(),P=b.Limit.limit(C,j,O,G),Z=b.Limit.limit(q,j,O,G);x=t.pow(P,Z)}}else if(H.group===ce&&H.args.length===1){let i,u=b.Limit.limit(H.args[0],j,O,G);if(n.Utils.isVector(u))return x=u.map(S=>{let N=H.clone();return N.args[0]=S,b.Limit.limit(t.symfunction(H.fname,[S]),j,O,G)}),t.multiply(p,x);let g;if(u.isConstant(!0)){g=t.symfunction(H.fname,[u]);try{Re(g),i=!0}catch(S){if(S.message==="timeout")throw S;i=!1}}if(i)x=g;else if(b.Limit.isConvergent(u)){if(H.fname===Be)switch(u.toString()){case"0":x=z.infinity().negate();break;case"Infinity":x=z.infinity();break;case"-Infinity":x=z.infinity();break}else if((H.fname===l||H.fname===J)&&O.isInfinity)x=b.Limit.interval(-1,1);else if(H.fname===w){let S=H.args[0],N=S.getNum(),E=S.getDenom(),q=N.toUnitMultiplier();(O.isInfinity||q.equals("pi")&&E.equals(2))&&(x=b.Limit.diverges())}else if(H.fname===X.FACTORIAL&&u.isInfinity)return z.infinity()}}else if(H.group===ge){if(H.power>0)return t.parse(H,de);n.Utils.even(H.power)?x=z.infinity():x=b.Limit.diverges()}else if(H.group===W){let i,u,g=H.collectSymbols().sort((N,E)=>N.group-E.group),S=g.pop();for(i=Re(b.Limit.limit(S,j,O,G));g.length;){let N=g.pop();u=Re(b.Limit.limit(N,j,O,G)),i.isInfinity||!b.Limit.isConvergent(i)&&u.equals(0)||i.equals(0)&&b.Limit.isConvergent(u)?(N.containsFunction(Be)&&(N=[S,S=N][0]),N.invert(),i.isInfinity&&u.isInfinity?i=z.infinity():i=b.Limit.divide(S,N,j,O,G)):(i=t.multiply(i,u),S=t.multiply(S,N))}x=i}else if(H.isComposite()){let i;H.isLinear()||(H=t.expand(H)),x=new z(0);let u=H.collectSymbols().sort((N,E)=>E.group-N.group),g=[],S=new z(0);for(let N=0,E=u.length;N<E;N++){let q=u[N].clone();q.group===ce||q.group===W&&q.hasFunc()?S=t.add(S,q):g.push(q)}g.unshift(S),g.length!==1&&(u=g);for(let N=0,E=u.length;N<E;N++){let q=u[N];try{i=b.Limit.limit(q,j,O,G)}catch(C){if(C.message==="timeout")throw C;i=b.Limit.diverges()}try{x=t.add(x,i)}catch(C){if(C.message==="timeout")throw C;if(G++>X.max_lim_depth)return;x=b.Limit.limit(b.diff(H,j),j,O,G)}}}}else x=b.Limit.divide(f,e,j,O,G)}}x||=t.symfunction("limit",[H,j,O])}catch(de){if(de.message==="timeout")throw de;x=t.symfunction("limit",[H,j,O])}return t.multiply(p,x)}},Fresnel:{S(H){return H.isConstant(!0)?b.defint(t.parse("sin(pi*x^2/2)"),z(0),H,"x"):t.symfunction("S",[H])},C(H){return H.isConstant(!0)?b.defint(t.parse("cos(pi*x^2/2)"),z(0),H,"x"):t.symfunction("C",[H])}}};J0.register([{name:"diff",visible:!0,numargs:[1,3],build(){return b.diff}},{name:"sum",visible:!0,numargs:4,build(){return b.sum}},{name:"product",visible:!0,numargs:4,build(){return b.product}},{name:"integrate",visible:!0,numargs:[1,2],build(){return b.integrate}},{name:"defint",visible:!0,numargs:[3,4],build(){return b.defint}},{name:"S",visible:!0,numargs:1,build(){return b.Fresnel.S}},{name:"C",visible:!0,numargs:1,build(){return b.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build(){return b.Limit.limit}}]),J0.updateAPI()})()});var K0=w0((Hi,dn)=>{"use strict";var _0;typeof dn<"u"&&(_0=b0(),Y0());(function(){let n=_0.getCore(),t=n.PARSER,{N:T}=n.groups,{P:X}=n.groups,{S:re}=n.groups,{EX:ce}=n.groups,{FN:z}=n.groups,{PL:ie}=n.groups,{CP:D}=n.groups,{CB:c}=n.groups,{keys:te}=n.Utils,{even:ot}=n.Utils,{variables:Re}=n.Utils,{format:Ue}=n.Utils,{round:ge}=n.Utils,{Frac:ye}=n,{isInt:Se}=n.Utils,{NerdamerSymbol:W}=n,{CONST_HASH:Ce}=n.Settings,qe=n.Utils.importFunctions(),Be=n.Utils.evaluate;function Ve(l,w,r){if(n.Utils.isSymbol(l))this.parse(l),this.variable||=w;else if(isNaN(l))typeof l=="string"&&this.parse(t.parse(l));else{if(r||=0,w===void 0)throw new n.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[r]=l,this.fill(l)}}Ve.fromArray=function(w,r){if(typeof r>"u")throw new n.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");let m=new Ve;return m.coeffs=w,m.variable=r,m},Ve.fit=function(w,r,m,v,y,_){let B=new Array(y+1),F=m-r;B[0]=r,B[y]=w,F-=w*v**y;for(let R=y-1;R>0;R--){let V=v**R,K=F/V,ne=Math.sign(K)*Math.floor(Math.abs(K));F-=ne*V,B[R]=ne}if(F!==0)return null;for(let R=0;R<B.length;R++)B[R]=new ye(B[R]);return Ve.fromArray(B,_)},Ve.prototype={parse(l,w){if(this.variable=Re(l)[0],!l.isPoly())throw n.exceptions.NerdamerTypeError(`Polynomial Expected! Received ${n.Utils.text(l)}`);if(w||=[],l.power.absEquals(1)||(l=t.expand(l)),l.group===n.groups.N)w[0]=l.multiplier;else if(l.group===n.groups.S)w[l.power.toDecimal()]=l.multiplier;else for(let r in l.symbols){if(!Object.hasOwn(l.symbols,r))continue;let m=l.symbols[r],v=m.power;if(n.Utils.isSymbol(v))throw new n.exceptions.NerdamerTypeError("power cannot be a NerdamerSymbol");v=m.group===T?0:v.toDecimal(),m.symbols?this.parse(m,w):w[v]=m.multiplier}this.coeffs=w,this.fill()},fill(l){l=Number(l)||0;let w=this.coeffs.length;for(let r=0;r<w;r++)this.coeffs[r]===void 0&&(this.coeffs[r]=new ye(l));return this},trim(){let l=this.coeffs.length;for(;l--;){let w=this.coeffs[l],r=w.equals(0);if(w&&r){if(l===0)break;this.coeffs.pop()}else break}return this},modP(l){let w=this.coeffs.length;for(let r=0;r<w;r++){let m=this.coeffs[r],v;if(m<0){let B;for(v=r;v<w;v++)if(this.coeffs[v]>0){B=this.coeffs[v];break}if(B){for(;v>r;v--)this.coeffs[v]=this.coeffs[v].subtract(new ye(1)),this.coeffs[v-1]=this.coeffs[v-1].add(new ye(l));m=this.coeffs[r]}}let y=m.mod(l),_=m.subtract(y).divide(l);if(!_.equals(0)){let B=r+1,F=this.coeffs[B]||new ye(0);F=F.add(_),this.coeffs[B]=new ye(F),this.coeffs[r]=new ye(y)}}return this},add(l){let w=Math.max(this.coeffs.length,l.coeffs.length);for(let r=0;r<w;r++){let m=this.coeffs[r]||new ye(0),v=l.coeffs[r]||new ye(0);this.coeffs[r]=m.add(v)}return this},subtract(l){let w=Math.max(this.coeffs.length,l.coeffs.length);for(let r=0;r<w;r++){let m=this.coeffs[r]||new ye(0),v=l.coeffs[r]||new ye(0);this.coeffs[r]=m.subtract(v)}return this},divide(l){let{variable:w}=this,r=n.Utils.arrayClone(this.coeffs),m=n.Utils.arrayClone(l.coeffs),v=r.length,y=m.length-1,_=[];for(let R=0;R<v;R++){let V=v-(R+1),K=V-y,ue=r[V].divide(m[y]);if(K<0)break;_[K]=ue;for(let ne=0;ne<=y;ne++)r[ne+K]=r[ne+K].subtract(m[ne].multiply(ue))}let B=Ve.fromArray(r,w||"x").trim();return[Ve.fromArray(_,w||"x"),B]},multiply(l){let w=this.coeffs.length,r=l.coeffs.length,m=[];for(let v=0;v<w;v++){let y=this.coeffs[v];for(let _=0;_<r;_++){let B=v+_,F=l.coeffs[_],R=m[B]||new ye(0);m[B]=R.add(y.multiply(F))}}return this.coeffs=m,this},isZero(){let l=this.coeffs.length;for(let w=0;w<l;w++)if(!this.coeffs[w].equals(0))return!1;return!0},sub(l){let w=new ye(0),r=this.coeffs.length;for(let m=0;m<r;m++){let v=this.coeffs[m];v.equals(0)||(w=w.add(v.multiply(new ye(l**m))))}return w},clone(){let l=new Ve;return l.coeffs=this.coeffs,l.variable=this.variable,l},deg(){return this.trim(),this.coeffs.length-1},lc(){return this.coeffs[this.deg()].clone()},monic(){let l=this.lc(),w=this.coeffs.length;for(let r=0;r<w;r++)this.coeffs[r]=this.coeffs[r].divide(l);return this},gcd(l){let w=this.coeffs.length-1,r=l.coeffs.length-1,m;if(w<r)return l.gcd(this);let v=this;for(;!l.isZero();){let _=l.clone();v=v.clone(),m=v.divide(_),l=m[1],v=_}let y=n.Math2.QGCD.apply(null,v.coeffs);if(!y.equals(1)){let _=v.coeffs.length;for(let B=0;B<_;B++)v.coeffs[B]=v.coeffs[B].divide(y)}return v},diff(){let l=[],w=this.coeffs.length;for(let r=1;r<w;r++)l.push(this.coeffs[r].multiply(new ye(r)));return this.coeffs=l,this},integrate(){let l=[0],w=this.coeffs.length;for(let r=0;r<w;r++){let m=new ye(r+1);l[m]=this.coeffs[r].divide(m)}return this.coeffs=l,this},gcf(l){let w=function(v){for(let y=0;y<v.length;y++)if(!v[y].equals(0))return y},r=[];for(let v=0;v<this.coeffs.length;v++){let y=this.coeffs[v];!y.equals(0)&&r.indexOf(y)===-1&&r.push(y)}let m=[n.Math2.QGCD.apply(void 0,r),w(this.coeffs)].toDecimal();if(l){let v=[];v[m[1]-1]=m[0],m=Ve.fromArray(v,this.variable).fill()}return m},quad(l){let w=[];if(this.coeffs.length>3)throw new Error(`Cannot calculate quadratic order of ${this.coeffs.length-1}`);if(this.coeffs.length===0)throw new Error("Polynomial array has no terms");let r=this.coeffs[2]||0,m=this.coeffs[1]||0,v=this.coeffs[0],y=m*m-4*r*v;return y<0&&!l||(w[0]=(-m+Math.sqrt(y))/(2*r),w[1]=(-m-Math.sqrt(y))/(2*r)),w},squareFree(){let l=this.clone(),w=1,r=l.clone().diff(),m=l.clone().gcd(r),v=l.divide(m)[0],y=Ve.fromArray([new ye(1)],l.variable);for(;!m.equalsNumber(1);){let _=v.gcd(m),B=v.divide(_)[0];if(!B.equalsNumber(1)&&w>1){let F=B.clone();for(let R=1;R<w;R++)F.multiply(B.clone());B=F}y=y.multiply(B),w++,v=_,m=m.divide(_)[0]}return[y,v,w]},toSymbol(){let l=this.coeffs.length,{variable:w}=this;if(l===0)return new n.NerdamerSymbol(0);let r=l-1,m="";for(let v=0;v<l;v++){let y=v===r?"":"+",_=this.coeffs[v];_.equals(0)||(m+=`${_}*${w}^${v}${y}`)}return t.parse(m)},equalsNumber(l){return this.trim(),this.coeffs.length===1&&this.coeffs[0].toDecimal()===String(l)},toString(){return this.toSymbol().toString()}},W.prototype.coeffs=function(w,r){r&&!this.isPoly(!0)&&t.error("Polynomial expected when requesting coefficients with order"),w||=[];let m=this.clone().distributeMultiplier();if(m.isComposite())for(let v in m.symbols){if(!Object.hasOwn(m.symbols,v))continue;let y=m.symbols[v];y.isComposite()?y.clone().distributeMultiplier().coeffs(w,r):r?w[y.isConstant()?0:y.power.toDecimal()]=y.multiplier:w.push(y.multiplier)}else if(r)w[m.isConstant(!0)?0:m.power.toDecimal()]=m.multiplier;else if(m.group===c&&m.isImaginary()){let v=new W(m.multiplier);m.each(y=>{(y.isConstant(!0)||y.imaginary)&&(v=t.multiply(v,y))}),w.push(v)}else w.push(m.multiplier);if(r)for(let v=0;v<w.length;v++)w[v]===void 0&&(w[v]=new W(0));return w},W.prototype.tBase=function(w){if(typeof w>"u")throw new Error("NerdamerSymbol.tBase requires a map object!");let r=[],m=this.collectSymbols(null,null,null,!0),v=m.length;for(let y=0;y<v;y++){let _=m[y],B=_.group,F=new Oe(_.multiplier,[],w);if(B===c)for(let R in _.symbols){if(!Object.hasOwn(_.symbols,R))continue;let V=_.symbols[R];F.terms[w[R]]=V.power}else F.terms[w[_.value]]=_.power;r.push(F.fill()),F.updateCount()}return r},W.prototype.altVar=function(w){let r=this.multiplier.toString(),m=this.power.toString();return(r==="1"?"":`${r}*`)+w+(m==="1"?"":`^${m}`)},W.prototype.sameVars=function(w){if(!(this.symbols||this.group===w.group))return!1;for(let r in this.symbols){if(!Object.hasOwn(this.symbols,r))continue;let m=this.symbols[r],v=w.symbols[r];if(!v||m.value!==v.value)return!1}return!0},W.prototype.groupTerms=function(w){w=String(w);let r,m,v,y=[];return this.each(_=>{if(_.group===ie){v=_.groupTerms(w);for(let B=0;B<v.length;B++){let F=v[B];F&&(y[B]=F)}}else r=n.Utils.decompose_fn(_,w,!0),m=r.x.value===w?Number(r.x.power):0,y[m]=t.add(y[m]||new W(0),r.a)}),y},W.prototype.collectFactors=function(){let w=[];return this.group===c?this.each(r=>{w.push(r.clone())}):w.push(this.clone()),w};function et(){this.factors={},this.length=0}et.prototype.getNumberSymbolics=function(){let w=0;return this.each(r=>{r.isConstant(!0)||w++}),w},et.prototype.add=function(w){if(w.equals(0))return this;if(w.equals(-1)&&this.length>0){let r=n.Utils.firstObject(this.factors,null,!0),m=t.symfunction(n.Settings.PARENTHESIS,[r.obj]).negate();return delete this.factors[r.key],this.add(m),this.length--,this}if(w.group===c){let r=this;w.multiplier.equals(1)||r.add(new W(w.multiplier)),w.each(m=>{r.add(m)})}else{this.preAdd&&(w=this.preAdd(w)),this.pFactor&&(w=t.pow(w,new W(this.pFactor)));let r=w.isConstant();if(r&&w.equals(1))return this;let m=r?w.value:w.text();m in this.factors?(this.factors[m]=t.multiply(this.factors[m],w),this.factors[m].equals(1)&&(delete this.factors[m],this.length--)):(this.factors[m]=w,this.length++)}return this},et.prototype.toSymbol=function(){let w=new W(1),r=Object.values(this.factors).sort((m,v)=>m.group>v.group);for(let m=0,v=r.length;m<v;m++){let y=r[m],_=y.power.equals(1)&&y.fname!==""?t.symfunction(n.PARENTHESIS,[y]):y;w=t.multiply(w,_)}return w.fname===""&&(w=W.unwrapPARENS(w)),w},et.prototype.merge=function(w){for(let r in w)r in this.factors?this.factors[r]=t.multiply(this.factors[r],w[r]):this.factors[r]=w[r];return this},et.prototype.each=function(w){for(let r in this.factors){if(!Object.hasOwn(this.factors,r))continue;let m=this.factors[r];m.fname===n.PARENTHESIS&&m.isLinear()&&(m=m.args[0]),w.call(this,m,r)}return this},et.prototype.count=function(){return te(this.factors).length},et.prototype.clean=function(){try{let w=n.Settings.CONST_HASH;this.factors[w].lessThan(0)&&(this.factors[w].equals(-1)?delete this.factors[w]:this.factors[w].negate(),this.each(r=>{r.negate()}))}catch(w){if(w.message==="timeout")throw w}},et.prototype.toString=function(){return this.toSymbol().toString()};function Oe(l,w,r){this.terms=w||[],this.coeff=l,this.map=r,this.sum=new n.Frac(0),this.image=void 0}Oe.prototype.updateCount=function(){this.count||=0;for(let w=0;w<this.terms.length;w++)this.terms[w].equals(0)||this.count++;return this},Oe.prototype.getVars=function(){let w=[];for(let r=0;r<this.terms.length;r++){let m=this.terms[r],v=this.getRevMap();m.equals(0)||w.push(this.revMap[r])}return w.join(" ")},Oe.prototype.len=function(){return typeof this.count>"u"&&this.updateCount(),this.count},Oe.prototype.toSymbol=function(w){w||=this.getRevMap();let r=new W(this.coeff);for(let m=0;m<this.terms.length;m++){let v=w[m],y=this.terms[m];if(y.equals(0)||v===Ce)continue;let _=new W(v);_.power=y,r=t.multiply(r,_)}return r},Oe.prototype.getRevMap=function(){if(this.revMap)return this.revMap;let w={};for(let r in this.map)Object.hasOwn(this.map,r)&&(w[this.map[r]]=r);return this.revMap=w,w},Oe.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},Oe.prototype.getImg=function(){return this.image||this.generateImage(),this.image},Oe.prototype.fill=function(){let w=this.map.length;for(let r=0;r<w;r++)typeof this.terms[r]>"u"?this.terms[r]=new n.Frac(0):this.sum=this.sum.add(this.terms[r]);return this},Oe.prototype.divide=function(w){let r=this.coeff.divide(w.coeff),m=this.terms.length,v=new Oe(r,[],this.map);for(let y=0;y<m;y++)v.terms[y]=this.terms[y].subtract(w.terms[y]),v.sum=v.sum.add(v.terms[y]);return v},Oe.prototype.multiply=function(w){let r=this.coeff.multiply(w.coeff),m=this.terms.length,v=new Oe(r,[],this.map);for(let y=0;y<m;y++)v.terms[y]=this.terms[y].add(w.terms[y]),v.sum=v.sum.add(v.terms[y]);return v},Oe.prototype.isZero=function(){return this.coeff.equals(0)},Oe.prototype.toString=function(){return`{ coeff: ${this.coeff.toString()}, terms: [${this.terms.join(",")}]: sum: ${this.sum.toString()}, count: ${this.count}}`},n.Utils.toMapObj=function(w){let r=0,m={};for(let v=0;v<w.length;v++){let y=w[v];typeof m[y]>"u"&&(m[y]=r,r++)}return m.length=r,m},n.Utils.filledArray=function(w,r,m){let v=[];for(;r--;)v[r]=m?new m(w):w;return v},n.Utils.arrSum=function(w){let r=0,m=w.length;for(let v=0;v<m;v++)r+=w[v];return r},n.Utils.haveIntersection=function(w,r){return r.length>w.length&&([w,r]=[r,w]),w.some(m=>r.indexOf(m)>-1)},n.Utils.subFunctions=function(w,r){r||={};let m=[],v=new Set(Re(w));return w.each(y=>{if(y.group===z||y.previousGroup===z){let _=n.Utils.text(y,"hash"),B=r[_];if(B)m.push(y.altVar(B));else{let F=0,R;do R=y.fname+te(r).length+(F>0?String(F):""),F++;while(v.has(R));r[_]=R,m.push(y.altVar(R))}}else y.group===c||y.group===ie||y.group===D?m.push(n.Utils.subFunctions(y,r)):m.push(y.text())}),w.group===D||w.group===ie?w.altVar(n.Utils.inBrackets(m.join("+"))):w.group===c?w.altVar(n.Utils.inBrackets(m.join("*"))):w.text()},n.Utils.getFunctionsSubs=function(w){let r={};for(let m in w)Object.hasOwn(w,m)&&(r[w[m]]=t.parse(m));return r};let J=n.Algebra={version:"1.4.6",proots(l,w){w||=7;let r=0,m=[],v=function(_,B,F){let R=y(_,B,F).concat(m);for(let V=0;V<r;V++)R.unshift(0);return R};if(l instanceof W&&l.isPoly()){if(l.distributeMultiplier(),l.group===ie){let ue=n.Utils.arrayMin(te(l.symbols)),ne=l.symbols[ue].clone().toUnitMultiplier();l=t.expand(t.divide(l,ne)),m.push(0)}if(l.group===n.groups.S)return[0];if(l.group===n.groups.PL){let ue=te(l.symbols),ne=n.Utils.arrayMin(ue);l=n.PARSER.divide(l,n.PARSER.parse(`${l.value}^${ne}`))}let _=te(l.symbols).sort().pop(),B=l.group===n.groups.PL?l.symbols:l.symbols[_],F=B.group,R=F===re?[B.power.toDecimal()]:te(B.symbols),V=[],K=n.Utils.arrayMax(R);for(let ue=1;ue<=K;ue++){let ne=0;R.indexOf(`${ue}`)!==-1&&(F===re?ne=B.multiplier:ne=B.symbols[ue].multiplier),V.unshift(ne)}return V.push(l.symbols[Ce].multiplier),B.group===re&&(V[0]=B.multiplier),v(V,R,K)}if(n.Utils.isArray(l)){let _=l,B=[],F=[],R=0;for(let K=0;K<_.length;K++){let ue=_[K][0],ne=_[K][1],we=ne-R-1;for(let me=0;me<we;me++)B.unshift(0);B.unshift(ue),ne!==0&&F.push(ne),R=ne}let V=Math.max.apply(void 0,F);return v(B,F,V)}throw new n.exceptions.NerdamerTypeError("Cannot calculate roots. NerdamerSymbol must be a polynomial!");function y(_,B,F){let V,K=_.slice(0);if(_.unshift(F),F>100)throw new n.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");let ue=[],ne={};for(ne.Degree=F,V=0;V<F;V++)ue.push(0);let we=ue.slice(0);function me(Te,b,H,j,O,G){O[0]=G.b=j[0],O[1]=G.a=-(b*G.b)+j[1];for(let p=2;p<Te;p++)O[p]=-(b*G.a+H*G.b)+j[p],G.b=G.a,G.a=O[p]}function be(Te,b,H,j,O,G,p,x,de){let f={},e=3;return f.b=f.a=0,me(b,p,x,G,de,f),O.c=f.a,O.d=f.b,Math.abs(O.c)<=100*Te*Math.abs(G[b-1])&&Math.abs(O.d)<=100*Te*Math.abs(G[b-2])||(O.h=x*j,Math.abs(O.d)>=Math.abs(O.c)?(e=2,O.e=H/O.d,O.f=O.c/O.d,O.g=p*j,O.a3=O.e*(O.g+H)+O.h*(j/O.d),O.a1=-H+O.f*j,O.a7=O.h+(O.f+p)*H):(e=1,O.e=H/O.c,O.f=O.d/O.c,O.g=O.e*p,O.a3=O.e*H+(O.g+O.h/O.c)*j,O.a1=-(H*(O.d/O.c))+j,O.a7=O.g*O.d+O.h*O.f+H)),e}function ze(Te,b,H,j,O,G,p,x,de){if(H===3){p[1]=p[0]=0;for(let e=2;e<b;e++)p[e]=x[e-2];return}let f=H===1?O:j;if(Math.abs(G.a1)>10*Te*Math.abs(f)){G.a7/=G.a1,G.a3/=G.a1,p[0]=de[0],p[1]=-(de[0]*G.a7)+de[1];for(let e=2;e<b;e++)p[e]=-(de[e-1]*G.a7)+x[e-2]*G.a3+de[e]}else{p[0]=0,p[1]=-(de[0]*G.a7);for(let e=2;e<b;e++)p[e]=-(de[e-1]*G.a7)+x[e-2]*G.a3}}function _e(Te,b,H,j,O,G,p,x,de,f,e,i,u,g,S,N,E){let q,C,P,Z,oe,pe,ae,De,Le;b.b=b.a=0,Te===3||(Te===2?(q=(H+e)*f+i,C=(f+u)*x+g*de):(q=H+u*p+i*f,C=x+(u+g*f)*de),P=-(S[N-1]/E[N]),Z=-(S[N-2]+P*E[N-1])/E[N],oe=g*Z*j,pe=P*G,ae=P*P*O,De=-(pe+ae)+oe,Le=-De+C+P*q,Le!==0&&(b.a=-((u*(ae+pe)+g*(P*j+Z*G))/Le)+u,b.b=g*(1+De/Le)))}function Fe(Te,b,H,j){let O,G;if(j.sr=j.si=j.lr=j.li=0,Te===0){j.sr=b===0?j.sr:-(H/b);return}if(H===0){j.lr=-(b/Te);return}let p=b/2;Math.abs(p)<Math.abs(H)?(G=H>=0?Te:-Te,G=-G+p*(p/Math.abs(H)),O=Math.sqrt(Math.abs(G))*Math.sqrt(Math.abs(H))):(G=-(Te/p*(H/p))+1,O=Math.sqrt(Math.abs(G))*Math.abs(p)),G>=0?(O=p>=0?-O:O,j.lr=(-p+O)/Te,j.sr=j.lr===0?j.sr:H/j.lr/Te):(j.lr=j.sr=-(p/Te),j.si=Math.abs(O/Te),j.li=-j.si)}function He(Te,b,H,j,O,G,p,x,de,f,e,i){let u={},g,S,N,E,q,C,P,Z,oe,pe,ae,De=0,Le,Pe=0;H.NZ=0,C=j,Z=O;do{if(u.li=u.lr=u.si=u.sr=0,Fe(1,C,Z,u),H.szr=u.sr,H.szi=u.si,H.lzr=u.lr,H.lzi=u.li,Math.abs(Math.abs(H.szr)-Math.abs(H.lzr))>.01*Math.abs(H.lzr))break;for(me(p,C,Z,de,G,x),S=Math.abs(-(H.szr*x.b)+x.a)+Math.abs(H.szi*x.b),pe=Math.sqrt(Math.abs(Z)),g=2*Math.abs(G[0]),q=-(H.szr*x.b),ae=1;ae<b;ae++)g=g*pe+Math.abs(G[ae]);if(g=g*pe+Math.abs(q+x.a),g=(9*g+2*Math.abs(q)-7*(Math.abs(x.a+q)+pe*Math.abs(x.b)))*Te,S<=20*g){H.NZ=2;break}if(De++,De>20)break;if(De>=2&&E<=.01&&S>=N&&!Pe){for(E=E<Te?Math.sqrt(Te):Math.sqrt(E),C-=C*E,Z+=Z*E,me(p,C,Z,de,G,x),ae=0;ae<5;ae++)Le=be(Te,b,x.a,x.b,e,i,C,Z,f),ze(Te,b,Le,x.a,x.b,e,i,f,G);Pe=1,De=0}N=S,Le=be(Te,b,x.a,x.b,e,i,C,Z,f),ze(Te,b,Le,x.a,x.b,e,i,f,G),Le=be(Te,b,x.a,x.b,e,i,C,Z,f),_e(Le,x,x.a,e.a1,e.a3,e.a7,x.b,e.c,e.d,e.f,e.g,e.h,C,Z,i,b,de),P=x.a,oe=x.b,oe!==0&&(E=Math.abs((-Z+oe)/oe),C=P,Z=oe)}while(oe!==0)}function it(Te,b,H,j,O,G,p,x,de){let f,e,i,u,g,S,N,E,q,C,P,Z=j-1;for(b.NZ=P=q=0,N=H.a;;){for(S=O[0],p[0]=S,C=1;C<G;C++)p[C]=S=S*N+O[C];for(i=Math.abs(S),u=Math.abs(N),f=.5*Math.abs(p[0]),C=1;C<G;C++)f=f*u+Math.abs(p[C]);if(i<=20*Te*(2*f-i)){b.NZ=1,b.szr=N,b.szi=0;break}if(P++,P>10)break;if(P>=2&&Math.abs(E)<=.001*Math.abs(-E+N)&&i>g){q=1,b.a=N;break}for(g=i,de[0]=e=x[0],C=1;C<j;C++)de[C]=e=e*N+x[C];if(Math.abs(e)>Math.abs(x[Z])*10*Te)for(E=-(S/e),x[0]=p[0],C=1;C<j;C++)x[C]=E*de[C-1]+p[C];else for(x[0]=0,C=1;C<j;C++)x[C]=de[C-1];for(e=x[0],C=1;C<j;C++)e=e*N+x[C];E=Math.abs(e)>Math.abs(x[Z])*10*Te?-(S/e):0,N+=E}return q}function Ge(Te,b,H,j,O,G,p,x,de,f,e,i){let u={},g={},S=new Array(b),N=new Array(b),E,q,C,P,Z,oe,pe,ae,De,Le,Pe,Ke,$e,je,ft,_t,ut,Nt,It,Mt=1,xt,n0,a0,u0,c0,Ct;for(i.NZ=0,P=C=.25,Z=j,ae=O,u.b=u.a=0,me(de,e,O,x,f,u),E=u.a,q=u.b,g.h=g.g=g.f=g.e=g.d=g.c=g.a7=g.a3=g.a1=0,u0=be(Te,p,E,q,g,G,e,O,S),xt=0;xt<H;xt++){if(Nt=1,ze(Te,p,u0,E,q,g,G,S,f),u0=be(Te,p,E,q,g,G,e,O,S),_e(u0,u,E,g.a1,g.a3,g.a7,q,g.c,g.d,g.f,g.g,g.h,e,O,G,p,x),ft=u.a,ut=_t=u.b,Le=G[p-1]===0?0:-(x[p]/G[p-1]),Pe=$e=1,xt!==0&&u0!==3&&($e=ut===0?$e:Math.abs((ut-ae)/ut),Pe=Le===0?Pe:Math.abs((Le-Z)/Le),je=$e<pe?$e*pe:1,Ke=Pe<oe?Pe*oe:1,c0=je<P?1:0,n0=Ke<C?1:0,n0||c0)){for(It=0;It<p;It++)N[It]=G[It];for(De=Le,a0=Ct=0;;){if(!(Nt&&(Nt=0)==0&&n0&&(!c0||Ke<je))){if(He(Te,p,i,ft,_t,f,de,u,x,S,g,G),E=u.a,q=u.b,i.NZ>0)return;if(Mt=Ct=1,P*=.25,a0||!n0)Mt=0;else for(It=0;It<p;It++)G[It]=N[It]}if(Mt!==0){if(u.a=De,Mt=it(Te,i,u,p,x,de,f,G,S),De=u.a,i.NZ>0)return;if(a0=1,C*=.25,Mt!==0){ft=-(De+De),_t=De*De;continue}}for(It=0;It<p;It++)G[It]=N[It];if(!c0||Ct)break}me(de,e,O,x,f,u),E=u.a,q=u.b,u0=be(Te,p,E,q,g,G,e,O,S)}ae=ut,Z=Le,pe=$e,oe=Pe}}function Qe(Te,b,H,j){let O=Te.Degree,G=Math.PI/180,p=Math.LN2,x=Te.Degree+1,de=new Array(x),f=new Array(x),e=new Array(x),i=new Array(x),u={},g={},S,N,E,q,C,P,Z,oe,pe,ae,De,Le,Pe,Ke,$e,je,ft,_t,ut,Nt,It,Mt,xt,n0;Le=1;do N=Le,Le/=2,Pe=1+Le;while(Pe>1);let a0=Number.MIN_VALUE/N,u0=Math.cos(94*G),c0=Math.sin(94*G),Ct=Math.sqrt(.5),d0=-Ct;for(g.NZ=ut=0,g.szr=g.szi=g.lzr=g.lzi=0;b[O]===0;)H[ut]=j[ut]=0,O--,ut++;for(xt=O+1;O>=1;){if(O<=2){O<2?(H[Te.Degree-1]=-(b[1]/b[0]),j[Te.Degree-1]=0):(u.li=u.lr=u.si=u.sr=0,Fe(b[0],b[1],b[2],u),H[Te.Degree-2]=u.sr,j[Te.Degree-2]=u.si,H[Te.Degree-1]=u.lr,j[Te.Degree-1]=u.li);break}for(Z=0,oe=Number.MAX_VALUE,V=0;V<xt;V++)ae=Math.abs(b[V]),ae>Z&&(Z=ae),ae!==0&&ae<oe&&(oe=ae);if(pe=a0/oe,(pe<=1&&Z>=10||pe>1&&Number.MAX_VALUE/pe>=Z)&&(pe=pe===0?Number.MIN_VALUE:pe,It=Math.floor(Math.log(pe)/p+.5),C=2**It,C!==1))for(V=0;V<xt;V++)b[V]*=C;for(let pt=0;pt<xt;pt++)f[pt]=Math.abs(b[pt]);f[O]=-f[O],Mt=O-1,ae=Math.exp((Math.log(-f[O])-Math.log(f[0]))/O),f[Mt]!==0&&(De=-f[O]/f[Mt],ae=De<ae?De:ae),De=ae;do{ae=De,De=.1*ae,P=f[0];for(let pt=1;pt<xt;pt++)P=P*De+f[pt]}while(P>0);q=ae;do{E=P=f[0];for(let pt=1;pt<O;pt++)P=ae*P+f[pt],E=ae*E+P;P=ae*P+f[O],q=P/E,ae-=q}while(Math.abs(q/ae)>.005);S=ae;for(let pt=1;pt<O;pt++)de[pt]=(O-pt)*b[pt]/O;for(de[0]=b[0],Le=b[O],Pe=b[Mt],n0=de[Mt]===0?1:0,Nt=0;Nt<5;Nt++)if(Ke=de[Mt],n0){for(let pt=0;pt<Mt;pt++)ut=Mt-pt,de[ut]=de[ut-1];de[0]=0,n0=de[Mt]===0?1:0}else{je=-Le/Ke;for(let pt=0;pt<Mt;pt++)ut=Mt-pt,de[ut]=je*de[ut-1]+b[ut];de[0]=b[0],n0=Math.abs(de[Mt])<=Math.abs(Pe)*N*10?1:0}for(let pt=0;pt<O;pt++)i[pt]=de[pt];for(Nt=1;Nt<=20;Nt++)if(_t=-(c0*d0)+u0*Ct,d0=c0*Ct+u0*d0,Ct=_t,$e=S*Ct,ft=-(2*$e),Ge(N,x,20*Nt,$e,S,de,O,b,xt,e,ft,g),g.NZ===0)for(let pt=0;pt<O;pt++)de[pt]=i[pt];else{ut=Te.Degree-O,H[ut]=g.szr,j[ut]=g.szi,xt-=g.NZ,O=xt-1;for(let pt=0;pt<xt;pt++)b[pt]=e[pt];g.NZ===1||(H[ut+1]=g.lzr,j[ut+1]=g.lzi);break}if(Nt>20){Te.Degree-=O;break}}}Qe(ne,K,we,ue);let rt=ue.length;for(V=0;V<rt;V++){let Te=ge(ue[V],w+8),b=ge(we[V],w+8);b=w-String(b).length>2?b:we[V];let H=Te<0?"-":"";b===0&&(b=""),Te===0&&(Te=""),Math.abs(Te)===1?Te=`${H}i`:Te?Te=`${Te}*i`:Te="";let j=b&&Te?`${b}+${Te}`:b+Te;we[V]=j.replace(/\+-/gu,"-")}return we}},roots(l){if(l.isConstant(!0,!0))return n.Utils.nroots(l);let w=J.proots(l).map(r=>t.parse(r));return n.Vector.fromArray(w)},froot(l,w,r){return function(v){let _=r||n.Utils.build(n.Calculus.diff(l.clone())),B=l instanceof Function?l:n.Utils.build(l),F=1e4,R=!1,V=0;for(;!R;){let K=v-B(v)/_(v),ue=Math.abs(K)-Math.abs(v),ne=Math.abs(ue);v=K,ne<1e-12?R=!0:V>F&&(v=null,R=!0),V++}return v}(Number(w))},quad(l,w,r){let m=function(v,y,_,B){return t.parse(`-(${y}+${B}*sqrt((${y})^2-4*(${v})*(${_})))/(2*${v})`)};return[m(l,w,r,1),m(l,w,r,-1)]},sumProd(l,w){return J.quad(-w,l,-1).map(r=>r.invert())},coeffs(l,w,r){l=t.expand(l),r||=[new W(0)];let m=Re(l);w===void 0&&m.length===1&&(w=m[0]),w=String(w),l.group===ce&&l.contains(w,!0)&&t.error(`Unable to get coefficients using expression ${l.toString()}`),m=Re(l);let v=l.contains("pi")||l.contains("e")||l.containsFunction("sqrt");if(m.length===1&&m[0]===w&&!l.isImaginary()&&!v){let y=new Ve(l).coeffs.map(_=>new W(_));for(let _=0,B=y.length;_<B;_++){let F=y[_],R=r[_];R&&(F=t.add(R,F)),r[_]=F}}else if(m.length===1&&m[0]===w&&!l.isImaginary()&&v&&l.group===D){let y=n.Utils.getCoeffs(l,w);for(let _=0,B=y.length;_<B;_++){let F=y[_],R=r[_];R&&(F=t.add(R,F)),r[_]=F}}else if(w||t.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),m.indexOf(w)===-1)r[0]=t.add(l,r[0]);else{r||=[new W(0)];let y;if(l.group===c){let _=l.symbols[w];_||t.error("Expression is not a polynomial!");let B=Number(_.power);y=t.divide(l.clone(),_.clone()),(y.contains(w,!0)||B<0||!Se(B))&&t.error("Expression is not a polynomial!");let F=r[B];F&&(y=t.add(F,y)),r[B]=y}else l.group===D&&l.each(_=>{J.coeffs(_.clone(),w,r)},!0)}for(let y=0,_=r.length;y<_;y++)typeof r[y]>"u"&&(r[y]=new W(0));return r},polyPowers(l,w,r){r||=[];let m=l.group;if(m===ie&&w===l.value)r=r.concat(te(l.symbols));else if(m===D)for(let v in l.symbols){if(!Object.hasOwn(l.symbols,v))continue;let y=l.symbols[v],_=y.group,B=y.value;if(_===re&&w===B)r.push(y.power);else if(_===ie||_===D)r=J.polyPowers(y,w,r);else if(_===c&&y.contains(w)){let F=y.symbols[w];F&&r.push(F.power)}else(_===T||w!==B)&&r.push(0)}else m===c&&l.contains(w)&&r.push(n.Utils.decompose_fn(l,w,!0).x.power);return n.Utils.arrayUnique(r).sort()},Factor:{split(l){let w=new W(1),r=new W(1);return J.Factor.factorInner(l,new et).each(m=>{let v=t.parse(m);m.isConstant(!0)?w=t.multiply(w,v):r=t.multiply(r,v)}),[w,r]},mix(l,w){let r=te(l),m=r.length,v=[];for(let y=0;y<m;y++){let _=r[y],B=l[_],F=v.length;for(let R=0;R<F;R++){let V=v[R]*_;v.push(V),w&&v.push(-V)}for(let R=1;R<=B;R++)v.push(_**R)}return v},common(l,w){try{if(l.group===D){let r=t.expand(l.clone(),!0).collectSymbols(null,null,(B,F)=>(F.length||1)-(B.length||1)),m={},v=[];for(let B=0;B<r.length;B++){let F=r[B];v.push(F.multiplier.clone()),F.each(R=>{let V=Number(R.power);if(isNaN(V))throw new Error("exiting");R.value in m?(V<m[R.value][0]&&(m[R.value][0]=V),m[R.value][1].push(R)):m[R.value]=[V,[R]]})}let y=new W(1);for(let B in m)m[B][1].length===r.length&&(y=t.multiply(y,t.pow(new W(B),new W(m[B][0]))));let _=n.Math2.QGCD.apply(null,v);if(!_.equals(1)){w.add(new W(_));for(let B=0;B<r.length;B++)r[B].multiplier=r[B].multiplier.divide(_)}if(!y.equals(1)){w.add(y),l=new W(0);for(let B=0;B<r.length;B++)l=t.add(l,t.divide(r[B],y.clone()))}}}catch(r){if(r.message==="timeout")throw r}return l},zeroes(l,w){let r=function(){throw new n.exceptions.ValueLimitExceededError("Exiting")};try{let m,v,y;l=t.expand(l.clone());let _=l.toString(),B=Re(l);v=new W(0);let F=[],R=[];for(let V=0,K=B.length;V<B.length;V++){let ue={};for(let we=0;we<K;we++)V!==we&&(ue[B[we]]=0);m=t.parse(_,ue);let ne=m.power;Se(ne)||r(),F.push(m),R.push(m.power)}if(n.Utils.allSame(R)){let V=l.length,K=F.length,ue=Math.round((Math.sqrt(8*V-1)-3)/2);K===2?y=new ye(R[0]/(V-1)):K===3&&ue!==0?y=new ye(R[0]/ue):y=n.Math2.QGCD.apply(null,R)}else y=n.Math2.QGCD.apply(null,R);if(!Se(y))return l;for(let V=0;V<F.length;V++){let K=F[V],ue=K.power.clone().divide(y);if((K.multiplier.num<0||K.multiplier.den<0)&&ue%2===0)return l;K.multiplier=new ye(K.multiplier**(1/ue)),K.power=y.clone(),v=t.add(v,K)}if(v.group!==D)return l;for(;;){let V=J.div(l.clone(),v.clone());if(V[1].equals(0)){if(l=V[0],w.add(v.clone()),l.equals(1))break}else break}}catch(m){if(m.message==="timeout")throw m}return l},factor(l,w){n.Utils.checkTimeout();let r=w?[...w]:null;try{let m=J.Factor.factorInner(l,w);return m=m.pushMinus(),m}catch(m){if(m.message==="timeout")throw m;return w&&w.splice(0,w.length,...r),l}},factorInner(l,w){if(n.Utils.checkTimeout(),l.isConstant()&&l.isInteger())return n.Math2.factor(l);let r=t.parse(l);if(r.isConstant())return r.isInteger()?n.Math2.factor(r):l;if(r.equals(0)||r.equals(1))return r;let m=J.Factor._factor(r,w);if(m.equals(l)||m.equals(0)||m.equals(1))return m;if(m.group===c){let v=new W(1),y=t.parse(m.power),_=t.parse(m.multiplier);m.toUnitMultiplier(),m.multiplier.lessThan(0)&&(v.negate(),m.negate()),m.each(F=>{let R=t.parse(J.Factor._factor(F));if(_=t.multiply(_,W.create(R.multiplier)),R.toUnitMultiplier(),R.group===c){let V=new W(1);R.each(K=>{let ue=t.parse(J.Factor._factor(K));ue.group===c&&(_=t.multiply(_,W.create(ue.multiplier)),ue.toUnitMultiplier()),V=t.multiply(V,ue)}),V=t.pow(V,new W(R.power)),v=t.multiply(v,V)}else v=t.multiply(v,R)});let B=t.pow(v,y);m=t.multiply(_,B)}return m},quadFactor(l,w){if(l.isPoly()&&J.degree(l.equals(2))){let r=n.Utils.variables(l)[0],m=J.coeffs(l,r);if(m.length<3)return l;let v=J.Factor._factor(m[2].clone());if(v.group===c){let y=v.collectSymbols();if(y.length>2)return l;let _=t.multiply(t.parse(m[0]),t.parse(y[0])),B=t.parse(m[1]).negate(),F=t.parse(y[1]),R=J.quad(F,B,_).filter(V=>n.Utils.isInt(V));if(R.length===1){let V=R[0],K=t.divide(m[0],t.parse(V));n.Utils.isInt(K)&&(w.add(t.parse(Ue("({0})*({1})+({2})",y[1],r,K))),w.add(t.parse(Ue("({0})*({1})+({2})",y[0],r,V))),l=new W(1))}}}return l},cubeFactor(l,w){if(l.isComposite()){let r=l.collectSymbols();if(r.length===2){let m=r[0].sign(),v=r[0].clone().abs(),y=r[1].sign(),_=r[1].clone().abs();if(v.isCube()&&_.isCube()){m<y&&([m,y]=[y,m],[v,_]=[_,v]);let B=t.parse(v.getNth(3)),F=t.parse(_.getNth(3)),R=t.multiply(t.expand(t.pow(v.clone().toUnitMultiplier(),t.parse("1/3"))),B),V=t.multiply(t.expand(t.pow(_.clone().toUnitMultiplier(),t.parse("1/3"))),F);m===1&&y===-1?(w.add(t.parse(Ue("(({0})-({1}))",R,V))),w.add(t.parse(Ue("(({0})^2+({0})*({1})+({1})^2)",R,V))),l=W(1)):m===1&&y===1&&(w.add(t.parse(Ue("(({0})+({1}))",R,V))),w.add(t.parse(Ue("(({0})^2-({0})*({1})+({1})^2)",R,V))),l=W(1))}}}return l},_factor(l,w){n.Utils.checkTimeout();let r=l.group;if(l.group===z){let v=l.args[0];if(v.group===re&&v.isSimple())return l}else if(l.group===re&&l.isSimple())return l;if(l.group===D){l.distributeMultiplier(!0);let v=new W(0);l.each(y=>{(y.group===D&&y.power.greaterThan(1)||y.group===c)&&(y=t.expand(y)),v=t.add(v,y)}),v.power=l.power,l=v}l.group===z&&l.fname!=="sqrt"&&(l=n.Utils.evaluate(l));let m=l.clone();try{if(l.group===c){let y=t.parse(l.power),_=J.Simplify.strip(l.getDenom()),B=J.Simplify.strip(l.getNum()),F=_.pop(),R=B.pop();if(R.equals(l))return l;let V=J.Factor.factorInner(R),K=J.Factor.factorInner(F),ue=J.Simplify.unstrip(B,V),ne=J.Simplify.unstrip(_,K);return t.divide(ue,ne)}if(l.group===re)return l;if(l.isConstant())return l.equals(1)||l.equals(0)||!l.isInteger()?l.clone():n.Math2.factor(l);let v=l.power.clone();if(Se(v)&&!(v.lessThan(0)&&l.group===z)){let y=v.sign();l.toLinear(),w||=new et;let _={};l=t.parse(n.Utils.subFunctions(l,_)),te(_).length>0&&(w.preAdd=function(we){return t.parse(we,n.Utils.getFunctionsSubs(_))}),l.isLinear()||(w.pFactor=l.power.toString(),l.toLinear());let B=Re(l);l.isImaginary()&&B.push(n.Settings.IMAGINARY);let F=B.length>1;if(F){let ne=!0,we=!0;if(l.each(me=>{me.group!==re&&(ne=!1),me.multiplier.equals(1)||(we=!1)}),ne&&we)return t.pow(t.parse(l,n.Utils.getFunctionsSubs(_)),t.parse(v))}let R=new et;l=J.Factor.coeffFactor(l,R),R.each(ne=>{ot(v)&&ne.lessThan(0)&&ne.negate(),y<0&&ne.invert(),w.add(ne)});let V=new et;if(l=J.Factor.powerFactor(l,V),V.each(ne=>{y<0&&ne.invert(),w.add(ne)}),F)l=J.Factor.cubeFactor(l,w),l=J.Factor.mfactor(l,w),w.each(ne=>{y<0&&ne.power.negate()});else{let ne=B[0];l=J.Factor.squareFree(l,w,ne);let we=new et;l=J.Factor.trialAndError(l,we,ne);let me=we.toSymbol();if(me.equals(m))return me;for(let be in we.factors){if(!Object.hasOwn(we.factors,be))continue;let ze=we.factors[be];w.add(t.pow(ze,t.parse(v)))}l.equals(m)&&(l=J.Factor.quadFactor(l,w))}l=t.parse(l,n.Utils.getFunctionsSubs(_));let K=w.length===1;w.add(t.pow(l,t.parse(v)));let ue=w.toSymbol();return K&&l.equals(1)&&ue.isLinear()&&(ue=t.pow(ue,t.parse(v))),ue}return l}catch(v){if(v?.message==="timeout")throw v;return m}},reduce(l,w){if(l.group===D&&l.length===2){let r=l.collectSymbols().sort((m,v)=>v.multiplier-m.multiplier);if(r[0].power.equals(r[1].power)){let m=t.parse(r[0].power),v=r[0].clone().toLinear(),y=r[1].clone().toLinear();w.add(t.add(v.clone(),y.clone())),y.negate();let _=Number(m),B=new W(0);for(let F=1;F<=_;F++){let R=t.pow(v.clone(),t.subtract(m.clone(),new W(F))),V=t.pow(y.clone(),t.subtract(new W(F),new W(1)));B=t.add(B,t.multiply(R,V))}return B}}return l},squareFree(l,w,r){if(l.isConstant()||l.group===re||!l.isPoly())return l;let v=new Ve(l,r).squareFree(),y=v[2];if(y!==1){let _=v[1].toSymbol();return _.power=_.power.multiply(new ye(y)),w.add(J.Factor.factorInner(_)),J.Factor.squareFree(v[0].toSymbol(),w)}return l},powerFactor(l,w){if(l.group!==ie||l.previousGroup===ce)return l;let r=te(l.symbols);if(!n.Utils.allNumeric(r))return l;let m=n.Utils.arrayMin(r),v=new W(0),y=t.parse(`${l.value}^${m}`);return l.each(_=>{_=t.divide(_,y.clone()),v=t.add(v,_)}),w.add(y),v},coeffFactor(l,w){if(l.isComposite()){let r=n.Math2.QGCD.apply(null,l.coeffs());if(r.equals(1)){let m=function(_){let B;return _.group===c?(B=0,_.each(F=>{B+=F.power})):B=Number(_.power),B},v=l.collectSymbols(null,null,null,!0).sort((_,B)=>_.isConstant(!0)?1:B.power-_.power),y=v[0];(m(y)>m(v[1])||v[1].isConstant(!0))&&y.multiplier.lessThan(0)&&(w.add(new W(-1)),l.each(_=>{_.negate()},!0))}else l.each(m=>{m.isComposite()?m.each(v=>{v.multiplier=v.multiplier.divide(r)}):m.multiplier=m.multiplier.divide(r)}),l.updateHash();w&&w.add(new W(r))}return l},trialAndError(l,w,r){let m=l.clone();try{let v=[];if(l.isConstant()||l.group===re||!l.isPoly())return l;let y=new Ve(l,r),_=y.coeffs[0],B=n.Math2.ifactor(_),F=J.proots(l);for(let R=0;R<F.length;R++){let V=F[R],K=1;if(!isNaN(V)){for(let be in B){if(!Object.hasOwn(B,be))continue;let ze=n.Utils.round(Math.log(be)/Math.log(Math.abs(V)),8);if(Se(ze)){V=be,K=ze;break}}let ue=new ye(V),ne=[new ye(ue.num).negate()];ne[K]=new ye(ue.den);let we=Ve.fromArray(ne,y.variable).fill(),me=y.divide(we);me[1].equalsNumber(0)&&(y=me[0],v.push(we.toSymbol()))}}return y.equalsNumber(1)||(y=J.Factor.search(y,w)),v.forEach(R=>{w.add(R)}),y.toSymbol()}catch(v){if(v.message==="timeout")throw v;return m}},search(l,w,r){r||=10;let m=l.variable,v=function(me,be,ze,_e){let Fe=Ve.fit(me,be,ze,r,_e,m);if(Fe&&Fe.coeffs.length>1){let He=l.divide(Fe);if(He[1].equalsNumber(0))return w.add(Fe.toSymbol()),[He[0],Fe]}return null},y=l.coeffs[0],_=n.Math2.ifactor(y),B=l.lc(),F=n.Math2.ifactor(B),R=l.sub(r),V=n.Math2.ifactor(R),K=J.Factor.mix(V,R<0),ue=Math.ceil(l.coeffs.length/2),ne=B.lessThan(0),we=y.lessThan(0);for(F[1]=1,_[1]=1;ue--;)for(let me in F)if(Object.hasOwn(F,me)){for(let be in _)if(Object.hasOwn(_,be))for(let ze=0;ze<K.length;ze++){let _e=v(me,be,K[ze],ue);if(_e)return l=_e[0],n.Utils.isPrime(l.sub(r))||(l=J.Factor.search(l,w)),l;_e||(ne&&we?_e=v(-me,-be,K[ze],ue):ne?_e=v(-me,be,K[ze],ue):we&&(_e=v(me,-be,K[ze],ue)))}}return l},mSqfrFactor(l,w){if(l.group!==z){let r=Re(l).reverse();for(let m=0;m<r.length;m++){let v=!1;do{if(r[m]===l.value){w.add(l),l=new W(1);continue}let y=n.Calculus.diff(l,r[m]),_=J.Factor.coeffFactor(y);if(_.equals(0)||_.equals(1)||_.equals(-1))break;let B=!0;_.isConstant()&&l.isComposite()&&l.each(R=>{R.multiplier%_!==0&&(B=!1)},!0);let F;if(B){let R=l.clone();if(F=J.divWithCheck(l,_.clone()),v=F[1].equals(0),l.equals(F[0])&&F[1].equals(0)){l=R;break}if(F[0].isConstant()){w.add(F[0]);break}}else v=!1;v&&(w.add(F[0]),l=_)}while(v)}}return l},sqdiff(l,w){if(l.isConstant("all"))return l;try{let r=function(y){return n.Utils.block("POSITIVE_MULTIPLIERS",()=>W.unwrapPARENS(qe.sqrt(qe.abs(y))),!0)},m=n.Utils.separate(l.clone());if(!m)return l;let v=[];for(let y in m)y!=="constants"&&v.push(m[y]);if(v.sort((y,_)=>_.power-y.power),v.length===2){let y,_;if(y=v.pop(),_=v.pop(),ot(y.power)&&ot(_.power)&&y.sign()===_.sign()&&y.group===re&&_.group===re)throw new Error("Unable to factor");if(y.isComposite()&&_.power.equals(2)&&y.sign()!==_.sign()){_=r(_);let B=J.Factor.factorInner(t.add(y,m.constants));B.power.equals(2)&&(B.toLinear(),w.add(t.subtract(B.clone(),_.clone())),w.add(t.add(B,_)),l=new W(1))}else if(y=y.powSimp(),_=_.powSimp(),(y.group===re||y.fname==="")&&y.power.equals(2)&&(_.group===re||_.fname==="")&&_.power.equals(2)&&!m.constants){if(y.multiplier.lessThan(0)){let B=_;_=y,y=B}y.multiplier.greaterThan(0)&&(y=r(y),_=r(_)),w.add(t.subtract(y.clone(),_.clone())),w.add(t.add(y,_)),l=new W(1)}}}catch(r){if(r.message==="timeout")throw r}return l},mfactor(l,w){if(l.group===z)if(l.fname==="sqrt"){let r=new et,m=J.Factor.common(l.args[0].clone(),r);m=J.Factor.coeffFactor(m,null),l=t.multiply(t.symfunction("sqrt",[m]),t.parse(l.multiplier)),r.each(v=>{l=t.multiply(l,t.parse(n.Utils.format("sqrt({0})",v)))})}else w.add(l),l=new W(1);else{l=J.Factor.mSqfrFactor(l,w);let r=Re(l),m=l.collectSymbols().map(F=>W.unwrapSQRT(F)),v={},y={},_=r.length,B=m.length;for(let F=0;F<_;F++){let R=r[F];v[R]=new W(0);for(let V=0;V<B;V++){let K=m[V];if(K.contains(R)){let ue=K.value===R?K.power.toDecimal():K.symbols[R].power.toDecimal();(!y[R]||ue<y[R])&&(y[R]=ue),v[R]=t.add(v[R],K.clone())}}}for(let F in v){if(!Object.hasOwn(v,F))continue;let R=t.parse(`${F}^${y[F]}`),V=t.divide(v[F],R),K=t.expand(V);if(K.equals(1)||K.equals(-1))break;let ue=J.div(l.clone(),K);if(ue[0].equals(0))break;if(ue[1].equals(0)){let we=!1;if(ue[0].each(me=>{Se(me.multiplier)||(we=!0)}),we){ue[1]=t.expand(t.multiply(ue[1],K));break}}let ne=Se(K)&&K.lessThan(0);if(ue[1].equals(0)&&!ne){let we=J.divWithCheck(l.clone(),ue[0].clone()),me=we[0];if(me.equals(0)||(l=we[1],me.equals(-1)&&!l.equals(0)))return l;let be=ue[0];if(l.equals(be)){let ze=J.Factor.reduce(be,w);return l.equals(ze)?ze:J.Factor.mfactor(ze,w)}return w.add(be),l.equals(0)?me:me.isConstant("all")?(w.add(me),me):(l=J.Factor.mfactor(me,w),l)}}}return l=J.Factor.sqdiff(l,w),l=J.Factor.zeroes(l,w),l}},allLinear(l){let w=l.length;for(let r=0;r<w;r++)if(!J.isLinear(l[r]))return!1;return!0},isLinear(l){let w=!1,r=l.group;if(r===ie||r===D){w=!0;for(let m in l.symbols){if(!Object.hasOwn(l.symbols,m))continue;let v=l.symbols[m],y=v.group;if((y===z||y===ce)&&(w=!1),y===c)w=Re(v).length===1;else if(y===ie||y===D)w=J.isLinear(v);else if(v.group!==T&&v.power.toString()!=="1"){w=!1;break}}}else r===re&&l.power===1&&(w=!0);return w},gcd(...l){let w;if(l.length===1&&l[0]instanceof n.Vector?w=l[0].elements:w=l,w.length===0)return new W(1);if(w.length===1)return w[0];let r=[],m=!1;for(let v=0;v<w.length;v++)if(w[v].group===z&&w[v].fname==="gcd")w=w.concat(w[v].args),w.splice(v,1);else{let y=Re(w[v]);if(n.Utils.haveIntersection(y,r)){m=!0;break}else r=r.concat(y)}if(m||r.length===0){if(w.every(v=>v.getDenom().equals(1))){let v=w[0];for(let y=1;y<w.length;y++)v=J.gcd_(w[y],v);return v}return t.divide(J.gcd.apply(null,w.map(v=>v.getNum())),J.lcm.apply(null,w.map(v=>v.getDenom())))}return t.symfunction("gcd",w)},gcd_(l,w){if((l.group===z||l.group===X)&&(l=n.Utils.block("PARSE2NUMBER",()=>t.parse(l))),w.group===z&&(w=n.Utils.block("PARSE2NUMBER",()=>t.parse(w))),l.isConstant()&&w.isConstant())return new W(n.Math2.QGCD(new ye(Number(l)),new ye(Number(w))));let r=t.multiply(l.getDenom()||new W(1),w.getDenom()||new W(1)).invert();if(l=t.multiply(l.clone(),r.clone()),w=t.multiply(w.clone(),r.clone()),l=t.expand(l),w=t.expand(w),l.group===c||w.group===c){let F=t.divide(l.clone(),w.clone()),R=t.multiply(w.clone(),F.getDenom().invert());if(!R.equals(1))return R}if(l.group===ce||w.group===ce){let F=new W(n.Math2.GCD(l.multiplier,w.multiplier)),R=J.gcd_(l.value===Ce?new W(1):t.parse(l.value),w.value===Ce?new W(1):t.parse(w.value)),V=J.gcd_(t.parse(l.power),t.parse(w.power));return t.multiply(F,t.pow(R,V))}if(l.length<w.length){let F=l;l=w,w=F}let m=Re(l),v=Re(w);if(m.length===v.length&&m.length===1&&m[0]===v[0]||m.length===1&&v.length===0||m.length===0&&v.length===1)return l=new Ve(l),w=new Ve(w),t.divide(l.gcd(w).toSymbol(),r);let y=[];l.each(F=>{y.push(F.multiplier)}),w.each(F=>{y.push(F.multiplier)});let _;for(;!w.equals(0);){let F=w.clone();if(l=l.clone(),_=J.div(l,F),w=_[1],_[0].equals(0))return t.divide(new W(n.Math2.QGCD(l.multiplier,w.multiplier)),r);l=F}let B=n.Math2.QGCD.apply(void 0,y);return B.equals(1)||l.each(F=>{F.multiplier=F.multiplier.divide(B)}),l.equals(1)&&!l.isConstant()&&!w.isConstant()?t.divide(t.symfunction("gcd",[l,w]),r):t.divide(l,r)},lcm(...l){let w;l.length===1?l[0]instanceof n.Vector?w=l[0].elements:t.error("lcm expects either 1 vector or 2 or more arguments"):w=l;let r=w.reduce((_,B)=>t.multiply(_,B.clone()),new W(1)),m=(function(B,F){F=Number(F);let R=[],V,K,ue,ne=2**B.length;for(K=F;K<ne;K++){V=[],ue=B.length-1;do(K&1<<ue)!==0&&V.push(B[ue]);while(ue--);V.length===F&&R.push(V)}return R})(w,w.length-1).map(_=>_.reduce((B,F)=>t.multiply(B,F.clone()),new W(1))),v;return w.every(_=>n.Utils.isVariableSymbol(_))?v=t.symfunction("gcd",n.Utils.arrayUnique(m)):v=J.gcd.apply(null,m),t.divide(r,v)},divide(l,w){let r,m=n.Algebra.Factor.factorInner(l.clone());r=m.getDenom(),r.isConstant("all")?r=new W(1):l=t.expand(W.unwrapPARENS(t.multiply(m,r.clone())));let v=J.div(l,w),y=t.divide(v[1],w);return t.divide(t.add(v[0],y),r)},divWithCheck(l,w){let r=[new W(0),l.clone()],m=J.div(l,w),v=l.clone(),y=t.multiply(m[0].clone(),w.clone());y=t.add(y,m[1].clone());let _=t.subtract(v,y);return _=t.expand(_),_.equals(0)?m:r},div(l,w){let r=[new W(0),l.clone()];try{if(w.isConstant("all"))return l.each(K=>{K.multiplier=K.multiplier.divide(w.multiplier)}),[l,new W(0)];if(l=t.expand(l),w=t.expand(w),l.group===re&&w.group===D){let K=l.value,ue=n.Utils.decompose_fn(w.clone(),K,!0);if(l.isLinear()&&ue.x&&ue.x.isLinear()&&w.isLinear()){let ne=W.create(l.multiplier);return[t.divide(ne.clone(),ue.a.clone()),t.divide(t.multiply(ne,ue.b),ue.a).negate()]}}if(l.group===re&&w.group===re){let K=t.divide(l.clone(),w.clone());return K.isConstant()?[K,new W(0)]:[new W(0),l.clone()]}let m=l.hasFunc(),v=w.hasFunc(),y=!1,_;if(m||v){y=!0;let K={};l=t.parse(n.Utils.subFunctions(l,K)),w=t.parse(n.Utils.subFunctions(w,K)),_=n.Utils.getFunctionsSubs(K)}let B=n.Utils.arrayUnique(Re(l).concat(Re(w))),F,R,V;if((l.isImaginary()||w.isImaginary())&&B.push(n.Settings.IMAGINARY),B.length===1){let K=new Ve(l).divide(new Ve(w));F=K[0].toSymbol(),R=K[1].toSymbol()}else{B.push(Ce);let K=function(Ge){let Qe=new W(0);for(let rt=0;rt<Ge.length;rt++){let Te=Ge[rt].toSymbol();Qe=t.add(Qe,Te)}return Qe},ue=function(Ge,Qe){let rt=Math.max.apply(null,Ge.terms),Te=0,b;if(!Qe){for(let H=0;H<Ge.terms.length;H++)if(Ge.terms[H].equals(rt)&&(b=H,Te++),Te>1)return}if(Qe){for(let H=0;H<Ge.terms.length;H++)if(Ge.terms[H].equals(rt)){b=H;break}}return[rt,b,Ge]},ne=n.Utils.toMapObj(B),we=function(Ge,Qe){return Qe.sum.subtract(Ge.sum)},me=l.tBase(ne).sort(we),be=w.tBase(ne).sort(we),ze=function(Ge,Qe){Qe||=0;let rt=Ge[Qe],Te=Ge.length;if(!rt)return;let b=ue(rt);for(let O=Qe+1;O<Te;O++){let G=Ge[O],p=rt.sum.equals(G.sum);if(!p&&b)break;if(p){let x,de,f,e,i=rt.terms.length;for(let S=0;S<i;S++){let N=rt.terms[S],E=G.terms[S];(typeof x>"u"||N.greaterThan(x))&&(x=N,f=S),(typeof de>"u"||E.greaterThan(de))&&(de=E,e=S)}let u=x.subtract(G.terms[f]),g=de.subtract(rt.terms[e]);if(g>u){b=[de,e,G];break}if(u>g){b=[x,f,rt];break}}else if(b=ue(G),b)break;b=ue(G)}if(!b)return ue(Ge[0],!0);let H,j;for(let O=0;O<be.length;O++){let G=be[O].terms;if(j=b[1],j===G.length-1)return;if(H=G[j],!H.equals(0))break}return H.equals(0)?ze(Ge,++Qe):b},_e=function(Ge,Qe){if(!Ge||!Qe)return!1;for(let rt=0;rt<Ge.terms.length;rt++)if(Ge.terms[rt].lessThan(Qe.terms[rt]))return!1;return!0},Fe=_e(me[0],be[0])&&me[0].count>be[0].count?be:me,He=ze(Fe),it=[];if(He){let Ge=He[1],Qe=function(p,x){return p[0].sum.equals(x[0].sum)?p.length>=x.length:!0},rt=function(p,x,de){let f=[];for(let e=0;e<p.length;e++){let i=p[e];for(let u=0;u<i.terms.length;u++){let g=f[u],S=i.terms[u];e===0?f[u]=S:g&&!g.equals(S)&&(f[u]=void 0)}}for(let e=0;e<f.length;e++){let i=f[e];if(i&&!i.equals(0))return e}return de},Te=function(p,x){let de=p.len(),f=x.len(),e=x.terms[Ge],i=p.terms[Ge];return f>de&&e.greaterThan(i)?f-de:e.subtract(i)};Ge=rt(me,be,Ge),me.sort(Te),be.sort(Te);let b=be[0],H=me[0];if(V=new Oe(new ye(1),[],H.map),b.sum.greaterThan(H.sum)&&H.len()>1)for(let p=0;p<H.terms.length;p++){let x=b.terms[p].subtract(H.terms[p]);if(x.equals(0))V.terms[p]=new ye(0);else{let de=x.add(new ye(1));V.terms[p]=x;for(let f=0;f<me.length;f++)me[f].terms[p]=me[f].terms[p].add(de)}}let j=_e(me[0],be[0]),O=0,G=200;for(;j&&Qe(me,be);){if(O++>G)throw new n.exceptions.InfiniteLoopError("Unable to compute!");let p=me[0].divide(be[0]);it.push(p),me.shift();for(let x=1;x<be.length;x++){let de=be[x].multiply(p).generateImage(),f=me.length;f===0&&(de.coeff=de.coeff.neg(),me.push(de),me.sort(Te));for(let e=0;e<f;e++){let i=me[e];if(i.getImg()===de.getImg()){i.coeff=i.coeff.subtract(de.coeff),i.coeff.equals(0)&&(n.Utils.remove(me,e),e--);break}e===f-1&&(de.coeff=de.coeff.neg(),me.push(de),me.sort(Te))}}if(j=_e(me[0],be[0]),!j&&me.length>=be.length){for(let x=1;x<me.length;x++)if(j=_e(me[x],be[0]),j){me.unshift(n.Utils.remove(me,x));break}}}}F=K(it),R=K(me),typeof V<"u"&&(V=V.toSymbol(),F=t.divide(F,V.clone()),R=t.divide(R,V))}return y&&(F=t.parse(F.text(),_),R=t.parse(R.text(),_)),[F,R]}catch(m){if(m.message==="timeout")throw m;return r}},line(l,w,r){n.Utils.isArray(l)&&(l=n.Utils.convertToVector(l)),n.Utils.isArray(w)&&(w=n.Utils.convertToVector(w)),r=t.parse(r||"x"),(!n.Utils.isVector(l)||!n.Utils.isVector(w))&&t.error(`Line expects a vector! Received "${l}" & "${w}"`);let m=t.subtract(w.e(1).clone(),l.e(1).clone()),v=t.subtract(w.e(2).clone(),l.e(2).clone()),y=t.divide(v,m),_=t.multiply(r,y.clone()),B=t.multiply(l.e(1).clone(),y);return t.add(t.subtract(_,B),l.e(2).clone())},PartFrac:{createTemplate(l,w,r,m){l=J.Factor.factorInner(l),l.each((K,ue)=>{if(K.group===z&&K.fname===""&&K.args[0].group===re){let ne=K.args[0];l.symbols?(delete l.symbols[ue],l.symbols[ne.value]=ne):l=K.args[0]}});let v,y,_,B=w.collectFactors(),F=[],R=[],V=new W(1);for(let K=0;K<B.length;K++){let ue=W.unwrapPARENS(B[K]);if(ue.power.greaterThan(1)){y=Number(ue.power),v=ue.clone().toLinear(),_=Number(J.degree(v,m));for(let ne=0;ne<y;ne++){let we=t.pow(v.clone(),new W(ne+1));r.push(we.clone());let me=t.divide(l.clone(),we.clone());R.push(_),F.push(me)}}else{_=Number(J.degree(ue,m)),r.push(ue);let ne=t.divide(l.clone(),ue.clone());ne=t.expand(W.unwrapPARENS(ne)),R.push(_),F.push(ne)}}return r=r.map(K=>t.multiply(K,V.clone())),[r,F,R]},partfrac(l,w,r){let m=Re(l);w||=t.parse(m[0]);try{let v,y,_,B=t.expand(l.getNum()),F=t.expand(l.getDenom().toUnitMultiplier());if(B.multiplier=l.multiplier,v=B.groupTerms(w),Number(J.degree(B,w))>=Number(J.degree(F,w))?(y=J.div(B.clone(),t.expand(F.clone())),_=y[0],B=y[1],v=B.groupTerms(w)):_=new W(0),Number(J.degree(F,w))===1){let Te=t.divide(B,F);return r?[_,Te]:t.add(_,Te)}let R=J.Factor.factorInner(F),V=J.PartFrac.createTemplate(F.clone(),R,[],w),K=V[0],ue=V[1],ne=V[2],we=[v.length],me=[],be=[],ze=[],_e,Fe;ue.forEach((Te,b)=>{_e=K[b],Fe=ne[b];for(let H=0;H<Fe;H++){be.push(_e.clone());let j=W.create(w,H),O=t.expand(t.multiply(Te,j.clone())).groupTerms(w),G=O.length;we.push(G),me.push(O),ze.push(j.clone())}});let He=n.Utils.arrayMax(we),it=new n.Matrix(n.Utils.fillHoles(v,He)).transpose(),Ge=new n.Matrix;for(let Te=0;Te<me.length;Te++)Ge.elements.push(n.Utils.fillHoles(me[Te],He));let Qe=t.multiply(Ge.transpose().invert(),it),rt=r?[_]:_;return Qe.each((Te,b)=>{let H=t.multiply(ze[b],t.divide(Te,be[b]));r?rt.push(H):rt=t.add(rt,H)}),rt}catch(v){if(v.message==="timeout")throw v;try{if(l.isComposite()){let y={};l.each(B=>{let F=B.getDenom(),R=B.getNum(),V=y[F];y[F]=V?t.add(V,R):R});let _=new W(0);for(let B in y)Object.hasOwn(y,B)&&(_=t.add(_,t.divide(y[B],t.parse(B))));l=_}}catch(y){if(y.message==="timeout")throw y}}return l}},degree(l,w,r){if(r||={nd:[],sd:[],depth:0},!w){let y=Re(l);if(y.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(y.length===0)return new W(0);w=t.parse(y[0])}let m=l.group;l.isComposite()?(l=l.clone(),l.distributeExponent(),l.each(y=>{r.depth++,J.degree(y,w,r),r.depth--})):l.group===c?l.each(y=>{r.depth++,J.degree(y,w,r),r.depth++}):m===ce&&l.value===w.value?r.sd.push(l.power.clone()):m===re&&l.value===w.value?r.nd.push(t.parse(l.power)):r.nd.push(new W(0));let v=r.nd.length>0?n.Utils.arrayMax(r.nd):void 0;return r.depth===0&&r.sd.length>0?(v!==void 0&&r.sd.unshift(v),t.symfunction("max",r.sd)):(n.Utils.isSymbol(v)||(v=t.parse(v)),v)},sqComplete(l,w,r){n.Utils.isSymbol(w)||(w=t.parse(w));let m=function(me){throw me||="Stopping",new n.exceptions.ValueLimitExceededError(me)};l.isPoly(!0)||m("Must be a polynomial!");let v=n.Utils.inBrackets;l=l.clone();let y=n.Algebra.degree(l,w);y.equals(2)||m(`Cannot complete square for degree ${y}`);let _=n.Algebra.coeffs(l,w),B=_[2],F=_[1].sign(),R=t.divide(_[1],new W(2)),V=t.pow(R.clone(),new W(2)),K=qe.sqrt(B),ue=t.divide(qe.sqrt(V),K.clone()),ne=t.subtract(_[0],t.pow(ue.clone(),new W(2)));if(r)return[B,R,ne];let we=t.parse(v(`${K.clone()}*${w}${F<0?"-":"+"}${ue}`));return{a:we,c:ne,f:t.add(t.pow(we.clone(),new W(2)),ne.clone())}},Simplify:{strip(l){let w=t.parse(l.multiplier);l.toUnitMultiplier();let r=t.parse(l.power);return l.toLinear(),[w,r,l]},unstrip(l,w){let r=l[0],m=l[1];return t.multiply(r,t.pow(w,m))},complexSimp(l,w){let r=l.realpart(),m=l.imagpart(),v=w.realpart(),y=w.imagpart(),_=t.multiply(r.clone(),v.clone()),B=t.multiply(m.clone(),y.clone()),F=t.multiply(v.clone(),m),R=t.multiply(r,y.clone()),V=t.add(t.pow(v,new W(2)),t.pow(y,new W(2)));return t.divide(t.add(t.add(_,B),t.multiply(t.subtract(F,R),W.imaginary())),V)},trigSimp(l){let w=!0,r=0;for(;w&&l.containsFunction(["cos","sin","tan"]);){r++,w=!1,l=l.clone();let m=J.Simplify.strip(l);l=m.pop();let v=l.clone();if(l.group===D){let y=new W(0);l.each(_=>{let B=J.Simplify.trigSimp(_.fnTransform());y=t.add(y,B)},!0),v=t.pow(t.multiply(new W(l.multiplier),y),new W(l.power)),w=v.text()!==l.text()}else if(l.group===c){let y=l.getNum(),_=l.getDenom();if(y.fname==="sin"&&_.fname==="cos"&&y.args[0].equals(_.args[0])&&y.power.equals(_.power))v=t.parse(n.Utils.format("(({1})/({0}))*tan({2})^({3})",_.multiplier,y.multiplier,y.args[0],y.power)),w=!0;else if(y.fname==="tan"&&_.fname==="sin"&&y.args[0].equals(_.args[0])&&y.power.equals(_.power))v=t.parse(n.Utils.format("(({1})/({0}))*cos({2})^(-({3}))",_.multiplier,y.multiplier,y.args[0],y.power)),w=!0;else{let B=new W(1),F={workDone:w};v.each(R=>{if(R.fname==="tan")R=t.parse(n.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",R.multiplier,J.Simplify._simplify(R.args[0]),R.power)),F.workDone=!0;else if(R.containsFunction(["cos","sin","tan"])){let V=J.Simplify.trigSimp(R);R.equals(V)||(R=V,F.workDone=!0)}B=t.multiply(B,R)}),w=F.workDone,v=B}}else if((l.fname==="cos"||l.fname==="sin")&&l.args[0].group===D){let y=0,_=new W(0),B=t.parse("pi/2");if(l.args[0].each(F=>{let R=t.divide(F.clone(),B.clone());R=J.Simplify._simplify(R),R=n.Utils.evaluate(R),Se(R)?y+=R.multiplier.num.toJSNumber():_=t.add(_,F)}),y){y+=l.fname==="cos"?1:0,y%=4,y+=y<0?4:0;let F=["sin({0})","cos({0})","-sin({0})","-cos({0})"],R=n.Utils.format(F[y],_);v=t.parse(R),w=!0}else if(Object.keys(l.args[0].symbols).length>1){let F=l.args[0].clone(),R=Object.values(F.symbols),V=R[0],ue=R.slice(1).map(we=>`(${we.text()})`).join("+"),ne;l.fname==="sin"?ne=n.Utils.format("sin({0})cos({1})+sin({1})cos({0})",V,ue):ne=n.Utils.format("cos({0})cos({1})-sin({1})sin({0})",V,ue),v=t.parse(ne),w=!0}}else if((l.fname==="cos"||l.fname==="sin")&&l.args[0].multiplier.sign()===-1){let y=l.args[0].clone().negate(),_=n.Utils.format(`${l.fname}({0})`,y);l.fname==="sin"&&(_=`-${_}`),v=t.parse(_),w=!0}if(l.fname==="sin"&&l.args[0].multiplier.equals(2)&&!l.args[0].equals(2)){let y=l.args[0].clone().toUnitMultiplier(),_=n.Utils.format("2sin({0})cos({0})",y);v=t.parse(_),w=!0}if(v=J.Simplify.unstrip(m,v).distributeMultiplier(),l=v,r>10)break}return l},logArgSimp(l,w){if(w.value==="1"||w.value===1)return new W(0);let r=new W(0),m=w.multiplier.clone();if(w.toUnitMultiplier(),!m.equals(1)){let v=n.Utils.format("({0}({1}))",l,m);r=t.add(r,t.parse(v))}if(w.group===c)w.each(v=>{v=v.clone();let y=v.power.clone();J.Simplify.strip(v);let _=n.Utils.format("(({1})*{0}({2}))",l,y,v);r=t.add(r,t.parse(_))});else{let v=w.clone(),y=v.power.clone();J.Simplify.strip(v);let _=n.Utils.format("(({1})*{0}({2}))",l,y,v);r=t.add(r,t.parse(_))}return r},logSimp(l){if(l.group===z&&(l.fname==="log"||l.fname==="log10")){let w=l.clone(),r=J.Simplify.strip(l);l=r.pop();let m=l.args[0].clone(),v=m.getNum().clone(),y=m.getDenom().clone(),_=l.fname,B=J.Simplify.logArgSimp(_,v);if(!y.equals(1)){let F=J.Simplify.logArgSimp(_,y);B=t.subtract(B,F)}B=J.Simplify.unstrip(r,B).distributeMultiplier(),l=B}else if(l.containsFunction(["log","log10"]))for(let w in l.symbols){if(!Object.hasOwn(l.symbols,w))continue;let r=l.symbols[w];l.symbols[w]=J.Simplify.logSimp(r)}return l},_sqrtCompression(l,w,r){let m=J.Simplify.strip(l),v=we=>we.fname==="abs",y=we=>we.args[0],_=we=>v(we)?y(we):null,B=we=>we.type===re&&we.value.startsWith("baseunit_"),F=(we,me)=>{let be=y(me);return be.equals(_(we))?[me,null]:be.equals(we)&&B(we)?[me,null]:[null,me]},R,V=!1,K=(we,me)=>{for(let be=0;be<we.length;be++){let ze=we[be];if(ze.isSQRT()){for(let _e=0;_e<me.length;_e++){let Fe=me[_e];if([Fe,ze]=F(Fe,ze),Fe!==null){me[_e]=Fe,R=!0,V=!0;break}}we[be]=ze,we=we.filter(_e=>_e),me=me.filter(_e=>_e)}}return[we,me]},ue=w.collectFactors(),ne=r.collectFactors();do R=!1,[ue,ne]=K(ue,ne),[ne,ue]=K(ne,ue);while(R);return V&&(l=ue.reduce((we,me)=>we=t.multiply(we,me),new W(1)),l=ne.reduce((we,me)=>we=t.divide(we,me),l)),l=J.Simplify.unstrip(m,l),l},fracSimp(l){let w=l.getDenom(),r=l.getNum();if(r.isImaginary()&&w.isImaginary()&&(l=J.Simplify.complexSimp(r,w)),l.isComposite()){l.power>1&&(l=t.expand(l));let m=l.collectSymbols(),v,y,_,B,F,R,V,K,ue,ne,we;for(y=m.pop();m.length;)_=m.pop(),B=t.parse(y.getDenom()),F=t.parse(_.getDenom()),R=y.getNum(),V=_.getNum(),we=t.multiply(B.clone(),F.clone()),ue=t.multiply(R,F),ne=t.multiply(V,B),K=t.add(ue,ne),y=t.divide(K,we);return w=t.expand(y.getDenom()),r=t.expand(y.getNum()),r.isImaginary()&&w.isImaginary()?v=J.Simplify.complexSimp(r,w):v=t.divide(r,w),v.equals(l)?l:J.Simplify._simplify(v)}return l=J.Simplify._sqrtCompression(l,r,w),l=J.Simplify.simpleFracSimp(l),l},simpleFracSimp(l){let w=l.getDenom(),r=l.getNum(),m;return w=t.expand(w),r=t.expand(r),r.isImaginary()&&w.isImaginary()?m=J.Simplify.complexSimp(r,w):m=t.divide(r,w),m.equals(l)?l:m},ratSimp(l){if(l.group===c){let w=l.getDenom(),r=l.getNum().distributeMultiplier(),m=J.Simplify.fracSimp(w),v=J.Simplify.fracSimp(r);l=t.divide(v,m)}return l},sqrtSimp(l,w){let r,m=!1,v=l.clone();try{if(l.isSQRT()){let y=l.multiplier.clone(),_=l.args[0].clone(),B=J.Factor.factorInner(_),F=t.parse(B.multiplier),R=F.sign();r=new W(1);let V;if(B.group===c){let K=new W(1);B.each(ne=>{if(ne=t.parse(ne),ne.group===T){let we=t.sqrt(ne.clone());Se(we)?r=t.multiply(r,we):K=t.multiply(K,ne)}else K=t.multiply(K,ne)});let ue=t.multiply(K,t.parse(R));V=t.sqrt(ue.clone()),V.isImaginary()&&(V=t.sqrt(t.expand(ue.clone())))}else V=B.clone().toUnitMultiplier(),V=t.multiply(V,new W(R)),V=t.sqrt(V);r=t.multiply(r,V),r=t.pow(r,t.parse(l.power)),r=t.multiply(r,t.sqrt(F.abs())),r=t.multiply(r,t.parse(y)),m=!0}else l.isComposite()&&l.isLinear()?(r=new W(0),l.each(y=>{r=t.add(r,J.Simplify.sqrtSimp(y))},!0),r=t.pow(r,t.parse(l.power)),r=t.multiply(r,t.parse(l.multiplier)),m=!0):l.group===c&&(r=new W(1),l.each(y=>{let _=J.Simplify.sqrtSimp(y);r=t.multiply(r,_)}),r=t.pow(r,t.parse(l.power)),r=t.multiply(r,t.parse(l.multiplier)),m=!0);return m||r&&!Se(r)&&(r=null),r||=t.parse(l),r}catch(y){if(y.message==="timeout")throw y;return v}},patternSub(l){let w={},r=function(v){let y=!1;return v.each(_=>{_.group===D?y=!0:_.symbols&&(y=r(_))}),y},m=function(v){v.each(y=>{if(!(!y.symbols&&y.group!==z)){if(r(y))m(y);else if(!w[y.value]){let _=n.Utils.getU(l);w[y.value]=_,l=l.sub(y.value,_)}}},!0)};return m(l),[l,w]},simplify(l){if(l.simplify)return l.simplify();let w=J.Simplify._simplify(l);return w=w.pushMinus(),w=t.parse(w),w},_simplify(l){let w=J.Simplify.strip(l.clone());if(l=w.pop(),l=J.Simplify.fracSimp(l),l.isConstant()||l.group===n.groups.S)return w.push(l),J.Simplify.unstrip(w,l);let r=l.clone();if(r=J.Simplify.sqrtSimp(r,w),r=J.Simplify.trigSimp(r),r=J.Simplify.logSimp(r),r=J.Simplify.ratSimp(r),r=J.Factor.factorInner(r),r.group===n.groups.CP&&r.isLinear()){let m=r.multiplier.clone();r.toUnitMultiplier();let v=new W(0);return r.each(y=>{let _=J.Simplify._simplify(y);v=t.add(v,_)}),r=v,r=t.multiply(r,new W(m)),r.multiplier.equals(-1)&&r.distributeMultiplier(),r=J.Simplify.unstrip(w,r),r}return r=J.Simplify.unstrip(w,r),r}},Classes:{Polynomial:Ve,Factors:et,MVTerm:Oe}};n.Expression.prototype.simplify=function(){n.Utils.armTimeout();try{let w;if(typeof this.symbol.LHS>"u")w=new n.Expression(J.Simplify.simplify(this.symbol));else{let r=this.symbol.clone();r.LHS=J.Simplify.simplify(r.LHS),r.RHS=J.Simplify.simplify(r.RHS),w=r}return w}catch(w){if(w.message==="timeout")throw w;return this}finally{n.Utils.disarmTimeout()}},n.Collection.prototype.simplify=function(){return this.elements=this.elements.map(w=>J.Simplify.simplify(w)),this},n.Matrix.prototype.simplify=function(){return this.elements=this.elements.map(w=>w.map(r=>J.Simplify.simplify(r))),this},_0.useAlgebraDiv=function(){let w=J.divideFn=t.divide,r=0;t.divide=function m(v,y){r++;let _;return r===1?_=n.Algebra.divide(v,y):_=m(v,y),r=0,_}},_0.useParserDiv=function(){J.divideFn&&(t.divide=J.divideFn),delete J.divideFn},_0.register([{name:"factor",visible:!0,numargs:1,build(){return J.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build(){return J.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build(){return J.gcd}},{name:"lcm",visible:!0,numargs:[1],build(){return J.lcm}},{name:"roots",visible:!0,numargs:-1,build(){return J.roots}},{name:"divide",visible:!0,numargs:2,build(){return J.divide}},{name:"div",visible:!0,numargs:2,build(){return J.div}},{name:"partfrac",visible:!0,numargs:[1,2],build(){return J.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build(){return J.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build(){return function(...w){let r=J.coeffs(...w);return new n.Vector(r)}}}]),_0.coeffs=function(...w){let r=n.PARSER;for(let v=0;v<w.length;v++)typeof w[v]=="string"?w[v]=r.parse(w[v]):w[v]&&w[v].symbol?w[v]=w[v].symbol.clone():n.Utils.isSymbol(w[v])&&(w[v]=w[v].clone());let m=J.coeffs(...w);return new n.Expression(new n.Vector(m))},_0.register([{name:"line",visible:!0,numargs:[2,3],build(){return J.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build(){return function(w,r){try{return r||=Re(w)[0],J.sqComplete(w.clone(),r).f}catch(m){if(m.message==="timeout")throw m;return w}}}}]),_0.updateAPI()})()});var Sn=w0((ji,wn)=>{"use strict";var e1;typeof wn<"u"&&(e1=b0(),Y0(),K0());(function(){let n=e1.getCore(),t=n.PARSER,T=n.Algebra,X=n.Calculus,re=X.integration.decompose_arg,{evaluate:ce}=n.Utils,{remove:z}=n.Utils,{format:ie}=n.Utils,{build:D}=n.Utils,{knownVariable:c}=n.Utils,{NerdamerSymbol:te}=n,{isSymbol:ot}=n.Utils,{variables:Re}=n.Utils,{S:Ue}=n.groups,{PL:ge}=n.groups,{CB:ye}=n.groups,{CP:Se}=n.groups,{FN:W}=n.groups,{Settings:Ce}=n,{range:qe}=n.Utils,{isArray:Be}=n.Utils;n.Settings.SOLVE_RADIUS=1e3,n.Settings.ROOTS_PER_SIDE=10,n.Settings.make_pi_conversions=!1,n.Settings.STEP_SIZE=.1,n.Settings.EPSILON=2e-13,n.Settings.MAX_NEWTON_ITERATIONS=200,n.Settings.NEWTON_EPSILON=2e-15,n.Settings.MAX_NON_LINEAR_TRIES=12,n.Settings.NON_LINEAR_JUMP_AT=50,n.Settings.NON_LINEAR_JUMP_SIZE=100,n.Settings.NON_LINEAR_START=.01,n.Settings.NEWTON_SLICES=200,n.Settings.SOLUTION_PROXIMITY=1e-14,n.Settings.FILTER_SOLUTIONS=!0,n.Settings.MAX_SOLVE_DEPTH=10,n.Settings.ZERO_EPSILON=1e-9,n.Settings.MAX_BISECTION_ITER=2e3,n.Settings.BI_SECTION_EPSILON=1e-12,n.NerdamerSymbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},n.NerdamerSymbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(let m in this.symbols){if(!Object.hasOwn(this.symbols,m))continue;let v=this.symbols[m];if(v.group===ge&&v.hasNegativeTerms()||this.symbols[m].power.lessThan(0))return!0}return!1};function Ve(r,m){if(m.isConstant()&&r.isConstant()&&!r.equals(m)||r.equals(n.Settings.IMAGINARY)&&m.isConstant(!0)||m.equals(n.Settings.IMAGINARY)&&r.isConstant(!0))throw new n.exceptions.NerdamerValueError(`${r.toString()} does not equal ${m.toString()}`);this.LHS=r,this.RHS=m}Ve.prototype={toString(){return`${this.LHS.toString()}=${this.RHS.toString()}`},text(r){return`${this.LHS.text(r)}=${this.RHS.text(r)}`},toLHS(r){r=!!r;let m=this.removeDenom(),v=m.LHS,y=m.RHS;v.isConstant(!0)&&!y.isConstant(!0)&&([v,y]=[y,v]);let _=t.subtract(v,y),B=r?t.expand(_):_;return B=new Ve(B,new te(0)).removeDenom().LHS,B},removeDenom(){let r=this.LHS.clone(),m=this.RHS.clone(),v=t.multiply(r.getDenom(),m.getDenom());if(r=t.expand(t.multiply(r,v.clone())),m=t.expand(t.multiply(m,v)),m.group===Se&&m.group!==Se){let y=r;r=m,m=y}if(r.group===ye){let y=new te(r.multiplier),_=m.clone();r.each(B=>{B.power.lessThan(0)?_=t.divide(_,B):y=t.multiply(y,B)}),r=y,m=_}else if(r.group===Se)for(let y in r.symbols){if(!Object.hasOwn(r.symbols,y))continue;let _=r.symbols[y];if(_.group===ye)for(let B in _.symbols){if(!Object.hasOwn(_.symbols,B))continue;let F=_.symbols[B];if(F.power.lessThan(0))return new Ve(t.expand(t.multiply(F.clone().toLinear(),r)),t.expand(t.multiply(F.clone().toLinear(),m)))}}return new Ve(r,m)},clone(){return new Ve(this.LHS.clone(),this.RHS.clone())},sub(r,m){let v=this.clone();return v.LHS=v.LHS.sub(r.clone(),m.clone()),v.RHS=v.RHS.sub(r.clone(),m.clone()),v},isZero(){return n.Utils.evaluate(this.toLHS()).equals(0)},latex(r){return[this.LHS.latex(r),this.RHS.latex(r)].join("=")}},t.equals=function(m,v){return new Ve(m,v)},(function(){let m=t.functions.simplify[0];t.functions.simplify[0]=function(y){return y instanceof Ve?(y.LHS=m(y.LHS),y.RHS=m(y.RHS),y):m(y)}})(),n.Expression.prototype.equals=function(m){return m instanceof n.Expression&&(m=m.symbol),new Ve(this.symbol,m)},n.Expression.prototype.solveFor=function(m){n.Utils.armTimeout();try{let{symbol:v}=this;if(this.symbol instanceof Ve){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(m))return[new n.Expression(this.symbol.LHS)];if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(m))return[new n.Expression(this.symbol.RHS)]}return w(v,m).map(B=>(B=n.Algebra.Simplify.simplify(t.parse(B)),new n.Expression(B)))}finally{n.Utils.disarmTimeout()}},n.Expression.prototype.expand=function(){if(this.symbol instanceof Ve){let m=this.symbol.clone();return m.RHS=t.expand(m.RHS),m.LHS=t.expand(m.LHS),new n.Expression(m)}return new n.Expression(t.expand(this.symbol))},n.Expression.prototype.variables=function(){return this.symbol instanceof Ve?n.Utils.arrayUnique(n.Utils.variables(this.symbol.LHS).concat(n.Utils.variables(this.symbol.RHS))):n.Utils.variables(this.symbol)};let et=function(m,v){return t.equals(m,v)};n.Equation=Ve;let Oe=n.Utils.checkAll=function(m,v){for(let y=0;y<m.length;y++)if(v(m[y]))return!1;return!0},J=n.Solve={version:"2.0.3",solutions:[],solve(r,m){let v=Ce.PARSE2NUMBER;Ce.PARSE2NUMBER=!1;let y=w(r,String(m));return Ce.PARSE2NUMBER=v,new n.Vector(y)},toLHS(r,m){if(ot(r))return r;if(!(r instanceof Ve)){let v=r.split("=");v[1]||="0",r=new Ve(t.parse(v[0]),t.parse(v[1]))}return r.toLHS(m)},solveCircle(r,m){let v=m.map(R=>t.parse(R)),y=[],_=[];for(let R=0;R<r.length;R++){let V=[];for(let K=0;K<v.length;K++)V.push(Number(n.Algebra.degree(r[R],v[K])));V.push(n.Utils.arraySum(V,!0)),y.push(V)}let B=r[0],F=r[1];if(y[0][2]>y[1][2]&&([F,B]=[B,F],[y[1],y[0]]=[y[0],y[1]]),y[0][0]===1&&y[0][2]===2&&y[1][0]===2&&y[1][2]===4){let R=m[0],V=m[1],K=w(t.parse(F,c(R,w(t.parse(B),R)[0])),V).map(ne=>ne.toString()),ue=[w(t.parse(B,c(V,K[0])))[0].toString()];K[1]&&ue.push(w(t.parse(B,c(V,K[1])))[0].toString()),Ce.SOLUTIONS_AS_OBJECT?(_={},_[R]=ue,_[V]=K):(K.unshift(V),ue.unshift(R),_=[ue,K])}return _},solveNonLinearSystem(r,m,v){if(m<0)return[];v=typeof v>"u"?n.Settings.NON_LINEAR_START:v;let y=n.Settings.MAX_NON_LINEAR_TRIES,_=Math.floor(y/2);m=typeof m>"u"?y:m;let B=n.Settings.NON_LINEAR_JUMP_AT,F=n.Settings.NON_LINEAR_JUMP_SIZE,R=!0,V=function(Te,b){return Te.map((H,j)=>Number(b.get(j,0)))},K=n.Utils.arrayGetVariables(r),ue=n.Matrix.jacobian(r,K,Te=>D(Te,K),!0),ne=n.Settings.MAX_NEWTON_ITERATIONS,we,me,be,ze,_e,Fe,He,it,Ge=r.map(Te=>D(Te,K)),Qe=ue.map(Te=>D(Te,K),!0);ze=n.Matrix.cMatrix(0,K);let rt=n.Matrix.cMatrix(v,K);be=0;do{if(be>ne){R=!1;break}we=V(K,rt),He=rt.clone();let Te=we,b=rt;Ge.forEach((j,O)=>{b.set(O,0,j(...Te))});let H=new n.Matrix;if(Qe.each((j,O,G)=>{let p=j(...Te);H.set(O,G,p)}),H=H.invert(),me=t.multiply(H,rt).negate(),it=me.subtract(ze,j=>t.parse(Number(j))),ze=He.add(me,j=>t.parse(Number(j))),rt=ze,be>=B&&_e>1){m===_&&(v=0);let j=m>_?1:-1,O=m%Math.floor(_)+1;return v+=j*O*F,J.solveNonLinearSystem(r,--m,v)}if(Fe=_e,be++,_e=it.max(),Number(_e)===Number(Fe))break}while(Number(_e)>=Number.EPSILON);return R?J.systemSolutions(rt,K,!0,Te=>n.Utils.round(Number(Te),14)):[]},systemSolutions(r,m,v,y){let _=n.Settings.SOLUTIONS_AS_OBJECT?{}:[];return r.each((B,F)=>{let R=(v?t.expand(B):B).valueOf();y&&(R=y.call(B,R));let V=m[F];n.Settings.SOLUTIONS_AS_OBJECT?_[V]=R:_.push([V,R])}),_},solveSystemBySubstitution(r){let m=Re(r[0]),v=Re(r[1]);return r.length===2&&m.length===2&&n.Utils.arrayEqual(m,v)?J.solveCircle(r,m):[]},solveSystem(r,m){for(let V=0;V<r.length;V++)r[V]=J.toLHS(r[V]);let v=r.length,y=new n.Matrix,_=new n.Matrix,B=!1,F;if(typeof m>"u"){if(!T.allLinear(r))try{return J.solveNonLinearSystem(r)}catch(V){if(V.message==="timeout")throw V;if(V instanceof n.exceptions.DivisionByZero)return J.solveSystemBySubstitution(r)}if(F=n.Utils.arrayGetVariables(r),F.length===1){let V=0,K,ue;do ue=r[V].clone(),V>0&&(ue=ue.sub(F[0],K[0])),K=w(ue,F[0]);while(++V<r.length);let ne;return Ce.SOLUTIONS_AS_OBJECT?(ne={},ne[F[0]]=K):K.length===0?ne=K:ne=[F[0],K],ne}if(F.length<r.length){let V=[],K=r.length;for(let me=0;me<K-1;me++)V.push(t.parse(r[me]));let ue={},ne=J.solveSystem(V,F);Array.isArray(ne)?ne.forEach(me=>{ue[me[0]]=me[1]}):ue=ne;let we=!0;for(let me=K-1;me<K;me++)t.parse(r[me],ue).equals(0)||(we=!1);if(we)return ne}for(let V=0;V<F.length;V++)e1.setVar(F[V],"delete");for(let V=0;V<v;V++){let K=r[V];for(let ne=0;ne<F.length;ne++){let we=F[ne],me=[];K.each(ze=>{ze.contains(we)&&(me=me.concat(ze.coeffs()))});let be=n.Utils.arraySum(me);y.set(V,ne,be)}let ue=K.clone();F.forEach(ne=>{ue=ue.stripVar(ne,!0)}),_.set(V,0,ue.negate())}}else{F=m,B=!0;for(let V=0;V<v;V++){_.set(V,0,new te(0));let K=t.expand(r[V]).collectSummandSymbols();for(let ue=0;ue<m.length;ue++){y.set(V,ue,new te(0));let ne=m[ue];for(let we=0;we<K.length;we++){let me=K[we],be=!1;for(let ze=0;ze<m.length;ze++)me.contains(m[ze])&&(be&&n.err(`Multiple variables found for term ${me}`),be=!0);if(me.contains(ne)){let ze=re(z(K,we),ne);we--,y.set(V,ue,t.add(y.get(V,ue),ze[0]))}}}for(let ue=0;ue<K.length;ue++)_.set(V,0,t.add(_.get(V,0),K[ue]))}}if(F.length!==r.length||y.determinant().equals(0))throw new n.exceptions.SolveError("System does not have a distinct solution");y=y.invert();let R=y.multiply(_);return n.Utils.isArray(m)&&R.each(V=>V.negate()),J.systemSolutions(R,F,B)},quad(r,m,v){let y=t.subtract(t.pow(m.clone(),te(2)),t.multiply(t.multiply(v.clone(),r.clone()),te(4)));y=t.expand(y);let _=t.pow(y,te(.5)),B=t.parse(t.multiply(new te(2),v.clone()));return[t.parse(ie("(-({0})+({1}))/({2})",m,_,B)),t.parse(ie("(-({0})-({1}))/({2})",m,_,B))]},cubic(r,m,v,y){let _=y.text(),B=v.text(),F=m.text(),R=r.text(),V=`(-(${B})^3/(27*(${_})^3)+(${B})*(${F})/(6*(${_})^2)-(${R})/(2*(${_})))`,K=`((${F})/(3*(${_}))-(${B})^2/(9*(${_})^2))`,ue=`(${B})/(3*(${_}))`,ne=`((${V})+sqrt((${V})^2+(${K})^3))^(1/3)+((${V})-sqrt((${V})^2+(${K})^3))^(1/3)-(${ue})`,we="1/2+sqrt(3)/2*i";return[t.parse(ne),t.parse(`(${ne})(${we})`),t.parse(`(${ne})(${we})^2`)]},quartic(r,m,v,y,_){let B={};n.Utils.arrayUnique(Re(_).concat(Re(y)).concat(Re(v)).concat(Re(m)).concat(Re(r))).forEach(Fe=>{B[Fe]=1}),_=_.toString(),y=y.toString(),v=v.toString(),m=m.toString(),r=r.toString();let F,R=t.parse(ie("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",_,y,v)).toString(),V=t.parse(ie("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",_,y,v,m)).toString(),K=t.parse(ie("12*({0})*({4})-3*({1})*({3})+({2})^2",_,y,v,m,r)).toString(),ue=t.parse(ie("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",_,y,v,m,r)).toString(),ne=t.parse(ie("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",K,ue)).toString(),we=t.parse(ie("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",_,R,ne,K)).toString(),me=t.parse(ie("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",_,y,R,V,we)),be=t.parse(ie("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",_,y,R,V,we)),ze=t.parse(ie("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",_,y,R,V,we)),_e=t.parse(ie("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",_,y,R,V,we));return[me,be,ze,_e]},divideAndConquer(r,m){let v=[],y=n.Algebra.Factor.factorInner(r);return y.group===ye&&y.each(_=>{_=te.unwrapPARENS(_),v=v.concat(w(_,m))}),v},csolve(r,m){return n.Utils.block("IGNORE_E",()=>{let v,y,_,B,F,R,V,K,ue=[],ne=n.Utils.decompose_fn(r,m,!0);if(ne.x.group===Ue){v=t.parse(ne.x.power),y=Number(v),_=t.pow(t.divide(ne.b.negate(),ne.a),v.invert()),B=te.toPolarFormArray(_),F=B[0],R=B[1],V=F.toString(),K=v.toString();let we,me,be;for(let ze=0;ze<y;ze++)we=ze,be=ie("({0})*e^(2*{1}*pi*{2}*{3})",V,we,v,n.Settings.IMAGINARY),me=t.parse(be),ue.push(me)}return ue},!0)},getPoints(r,m,v){m||=.01;let y=[],_=D(r),F=Math.round(0),R=_(F),V=n.Settings.ROOTS_PER_SIDE,K=V;y.push(Math.floor(F/2)),y.push(Math.abs(F)),y.push(F),r.each(me=>{me.containsFunction(n.Settings.LOG)&&y.push(.1)});let ue=qe(-n.Settings.SOLVE_RADIUS,F,m),ne=qe(F,n.Settings.SOLVE_RADIUS,m),we=function(me,be){let ze,_e,Fe,He=[],it=me[0],Ge=Math.sign(_(it));for(let Qe=0,rt=me.length;Qe<rt&&He.length<be;Qe++)ze=me[Qe],_e=_(ze),Fe=Math.sign(_e),!isNaN(Fe)&&(Fe!==Ge&&(He.push(ze),He.push(me[Qe-1])),Ge=Fe);y=y.concat(He)};if(we(ue,K),we(ne,V),v){let me=n.Settings.SOLVE_RADIUS;we([me,me*me],1),we([-me*me,-me],1)}return y},bisection(r,m){let v=r-1,y=r+1;if(Math.sign(m(v))!==Math.sign(m(y))){let _=0,B,F;do{if(B=Math.abs(y-v),_++>n.Settings.MAX_BISECTION_ITER||isNaN(B))return;F=(v+y)/2,m(v)*m(F)>0?v=F:y=F}while(B>=Ce.EPSILON);let R=(v+y)/2,V=m(R);return!isNaN(V)&&Math.abs(V)<=n.Settings.BI_SECTION_EPSILON?n.Utils.round(R,13):void 0}},bSearch(r,m,v){let y=v(r),_=v(m);if(Math.sign(y)===Math.sign(_)||isNaN(y)||isNaN(_))return;let B=80,F=0;do{let R=(r+m)/2,V=Math.sign(y),K=Math.sign(v(R));if(V===K){if(R===r)break;r=R,y=v(r)}else{if(R===m)break;m=R,_=v(m)}F++}while(r!==m&&F<B);if(!(!isFinite(v(r))||!isFinite(v(m))))return r},Newton(r,m,v,y){let _=n.Settings.MAX_NEWTON_ITERATIONS,B=0,F=r,R,V,K;do{let ue=m(F);if(F===0&&ue===0){R=0;break}if(B++,B>_)return;let ne=v(F);if(isNaN(ne)||isNaN(ue))return;if(ne===0)R+=K;else{if(!isFinite(ue)||!isFinite(ne)||Math.abs(ue)>1e25)return J.bSearch(y,F,m);R=F-ue/ne}if(K=R-F,K===0&&!isFinite(ne))return;V=Math.abs(K),F=R}while(V>Ce.NEWTON_EPSILON);return R},rewrite(r,m,v){if(m||=new te(0),r.isComposite()&&r.isLinear()){let B=[],F=[];r.each(R=>{R=R.clone(),R.fname==="sqrt"&&R.contains(v)?B.push(R):F.push(R)},!0),B.length===1&&(m=t.expand(t.pow(t.subtract(m,n.Utils.arraySum(F)),new te(2))),r=t.expand(t.pow(te.unwrapSQRT(B[0]),new te(2))))}else r=te.unwrapSQRT(t.expand(r));let y=0,_=r.length;if(r.group===Se&&r.contains(v)&&r.isLinear()){r.distributeMultiplier();let B=new te(0);return r.each(F=>{F.contains(v)?(y++,B=t.add(B,F.clone())):m=t.subtract(m,F.clone())}),r=B,y!==_?J.rewrite(r,m,v):[r,m]}if(r.group===ye&&r.contains(v)&&r.isLinear()){if(r.multiplier.lessThan(0)&&(r.multiplier=r.multiplier.multiply(new n.Frac(-1)),m.multiplier=m.multiplier.multiply(new n.Frac(-1))),m.equals(0))return new te(0);let B=new te(1);return r.each(F=>{F.contains(v)?B=t.multiply(B,F.clone()):m=t.divide(m,F.clone())}),r=B,J.rewrite(r,m,v)}if(!r.isLinear()&&r.contains(v)){let B=t.parse(r.power.clone().invert());return r=t.pow(r,B.clone()),m=t.pow(t.expand(m),B.clone()),J.rewrite(r,m,v)}return r.group===W||r.group===Ue||r.group===ge?[r,m]:[r,m]},sqrtSolve(r,m){let v=new te(0),y=new te(0);if(r.isComposite()&&(r.each(_=>{_.fname==="sqrt"&&_.contains(m)?v=t.add(v,_.clone()):y=t.add(y,_.clone())}),!v.equals(0))){let _=t.expand(t.multiply(t.parse(r.multiplier),t.subtract(t.pow(y,new te(2)),t.pow(v,new te(2))))),B=w(_,m);return B=B.filter(F=>{if(F.isImaginary())return!0;let R={};return R[m]=F,!!ce(r,R).equals(0)}),B}}},l=function(r,m,v,y){let _=r.toString(),B=_.match(/(?<![a-z])abs/gu);if(!B||B.length>2||r.LHS.group!==W&&r.RHS.group!==W)return null;let F=r.constructor(_.replace(/(?<![a-z])abs/u,"")),R=r.constructor(_.replace(/(?<![a-z])abs/u,"(-1)")),V=w(F,m,null,v,y);return[w(R,m,null,v,y),V]};function w(r,m,v,y,_){if(y||=0,y++>Ce.MAX_SOLVE_DEPTH)return v;v||=[];let B={},F={};F[m]=0;let R=function(_e,Fe){let He=ot(_e);if(!(_e===void 0||typeof _e=="number"&&isNaN(_e))){if(Be(_e))_e.forEach(it=>{R(it)});else if(_e.valueOf()!=="null"){if(typeof n.Settings.PRE_ADD_SOLUTION=="function"&&(_e=n.Settings.PRE_ADD_SOLUTION(_e)),He||(_e=t.parse(_e)),n.Settings.make_pi_conversions&&Fe){let Ge=t.divide(_e.clone(),new te(Math.PI)),Qe=Ge.multiplier,rt=Math.abs(Qe.num),Te=Math.abs(Qe.den);rt<10&&Te<10&&(_e=t.multiply(Ge,new te("pi")))}let it=_e.toString();B[it]||v.push(_e),B[it]=!0}}};if(r instanceof Ve){let _e=l(r,m,v,y,_);if(_e)return R(_e),v;if(r.isZero())return[new te(0)];if(r.LHS.equals(m)&&!r.RHS.contains(m,!0))return[r.RHS];if(r.RHS.equals(m)&&!r.LHS.contains(m,!0))return[r.LHS]}if(r instanceof n.Vector&&(r=r.elements),Be(r))return J.solveSystem(r,m);if(m||="x",ot(r)&&ce(r.getDenom(),F).equals(0)===!0)return v;if(r.group===Ue&&r.contains(m)){try{let _e={};_e[m]=0,ce(_,_e,"numer"),R(new te(0))}catch(_e){if(_e.message==="timeout")throw _e}return v}if(r.group===ye){let _e=r.getNum();if(_e.group===ye){let Fe=String(m);return _e.each(He=>{He.contains(Fe)&&w(He,m,v,y,r)}),v}return w(_e,m,v,y,_)}r.group===W&&r.fname==="sqrt"&&(r=t.pow(te.unwrapSQRT(r),new te(2)));let V=(n.Utils.isSymbol(r)?r:J.toLHS(r,!1)).getNum(),K=n.Utils.variables(V),ue=K.length;if(n.Utils.isInt(V.power)&&V.power>1&&(V=t.parse(V).toLinear()),(V.group===Ue||V.group===ye)&&V.contains(m))return[new te(0)];let ne={},we,me=function(_e){_e=t.expand(_e,{expand_denominator:!0,expand_functions:!0});let Fe=_e.clone();if(_e.symbols)for(let He in _e.symbols){if(!Object.hasOwn(_e.symbols,He))continue;let it=_e.symbols[He],Ge=it.getDenom();if(!Ge.isConstant(!0)&&_e.isComposite()){let H=new te(0);return _e.each(j=>{H=t.add(H,t.multiply(j,Ge.clone()))}),me(t.multiply(t.parse(_e.multiplier),H))}let Qe=re(it,m),rt=Qe[1].fname===n.Settings.SQRT,Te=te.unwrapSQRT(Qe[1]),b=Te.power.clone();if(!ot(b)&&!b.equals(1/2)){if(b.den.gt(1)){if(rt)return _e=t.subtract(_e,it.clone()),_e=t.add(_e,t.multiply(Qe[0].clone(),Te)),me(_e);let H=ne[b.den];ne[b.den]=H?H++:1}else if(b.sign()===-1){let H=t.parse(`${m}^${Math.abs(b)}`),j=_e;return j.each((O,G)=>{O.contains(m)&&(j.symbols[G]=t.multiply(O,H.clone()))}),ne={},me(t.parse(j))}else if(it.group===ge){let H=n.Utils.arrayMin(n.Utils.keys(it.symbols));if(H<0){let j=t.parse(`${m}^${Math.abs(H)}`),O=new te(0);return Fe.each(G=>{O=t.add(O,t.multiply(G.clone(),j.clone()))},!0),O}}}}return _e},be=function(_e){let Fe=new te(0),He=new te(0);return _e.each(it=>{it.contains(m,!0)?Fe=t.add(Fe,it.clone()):He=t.subtract(He,it.clone())}),[Fe,He]};if(J.inverseFunctionSolve=function(Fe,He,it){let Ge=re(He.args[0],m);if(Ge[1].group===Ue)return t.divide(t.symfunction(Fe,[t.divide(it,t.parse(He.multiplier))]),Ge[0])},V=me(V),V.equals(0))return[V];let ze=n.Utils.keys(ne);if(ze.length===1&&(we=ze[0],V.each((_e,Fe)=>{if(_e.contains(m)){let He=re(_e,m),it=He[1],Ge=it.power;Ge.den.gt(1)&&(it.power=Ge.multiply(new n.Frac(we)),V.symbols[Fe]=t.multiply(it,He[0]))}}),V=t.parse(V)),R(J.sqrtSolve(V,m)),ue===1)if(V.isPoly(!0)){let _e=new n.Algebra.Classes.Factors;if(n.Algebra.Factor.factorInner(V,_e),_e.getNumberSymbolics()>1)for(let Fe in _e.factors)Object.hasOwn(_e.factors,Fe)&&R(w(_e.factors[Fe],m));else{let Fe=n.Utils.getCoeffs(V,m),He=Fe.length-1,it=!1;if(K[0]===m){if(Oe(Fe,Ge=>Ge.group!==n.groups.N)){let Ge=n.Algebra.proots(V);Oe(Ge,Qe=>!n.Utils.isInt(Qe))&&(it=!0,Ge.forEach(Qe=>{R(new te(Qe))}))}if(!it)if(r=t.parse(r),r instanceof n.Equation&&(r=r.toLHS()),He===1)R(t.divide(Fe[0],Fe[1].negate()));else if(He===2)R(t.expand(J.quad.apply(void 0,Fe)));else if(He===3){let Ge=[],Qe=n.Algebra.Factor.factorInner(r);Ge=[],Ge.length>0?R(Ge):R(J.cubic.apply(void 0,Fe))}else T.proots(V).map(R)}}}else{let _e=V.hasTrig(),Fe=J.getPoints(V,.1),He=J.getPoints(V,.05),it=J.getPoints(V,.01,!0),Ge=n.Utils.arrayUnique(Fe.concat(He).concat(it)).sort((p,x)=>p-x),Qe,rt,Te,b=D(V.clone()),H=[];for(Qe=0;Qe<Ge.length;Qe++){if(rt=Ge[Qe],Te=J.bisection(rt,b),typeof Te>"u"){H.push(rt);continue}R(Te,_e)}Ge=H;let j=X.diff(V.clone()),O=D(j),G=Ge[0];for(Qe=0;Qe<Ge.length;Qe++)rt=Ge[Qe],R(J.Newton(rt,b,O,G),_e),G=rt;v.sort((p,x)=>{let de=p.text("decimals"),f=x.text("decimals"),e=Number(de),i=Number(f);return isNaN(e)&&isNaN(i)?de.localeCompare(f):isNaN(e)&&!isNaN(i)?-1:!isNaN(e)&&isNaN(i)?1:e-i}),v=v.map(p=>p.isConstant()?new te(Number(Number(p).toPrecision(15))):p),v=v.filter((p,x,de)=>{let f=Number(Number(p).toPrecision(15)),e=Number(de[x-1]);return x===0||isNaN(f)||isNaN(e)?!0:Math.abs(f-e)>=Ce.EPSILON})}else if(!V.hasFunc(m)&&V.isComposite())try{let _e=n.Algebra.Factor.factorInner(V.clone()),Fe=t.expand(t.parse(_e)),He=t.expand(V.clone()),it=t.subtract(Fe,He),Ge=!0;if(it.equals(0)||(Ge=!1),Ge&&_e.group===ye)_e.each(Qe=>{R(w(Qe,m))});else{let Qe=n.Utils.getCoeffs(V,m);switch(Qe.length-1){case 0:{let b=be(V),H=b[0],j=b[1];if(H.group===n.groups.EX){let O=n.Settings.LOG,G=`${O}((${j})/(${H.multiplier}))/(${O}(${H.value})*${H.power.multiplier})`,p=t.parse(G);R(p)}break}case 1:R(t.divide(Qe[0],Qe[1].negate()));break;case 2:R(J.quad.apply(void 0,Qe));break;case 3:R(J.cubic.apply(void 0,Qe));break;case 4:R(J.quartic.apply(void 0,Qe));break;default:R(J.csolve(V,m)),v.length===0&&R(J.divideAndConquer(V,m))}v.length===0&&R(w(_e,m,v,y))}}catch(_e){if(_e.message==="timeout")throw _e}else try{let _e=J.rewrite(V,null,m),Fe=_e[0],He=_e[1];if(Fe.group===W)if(Fe.fname==="abs")Fe.args[0].toString()===m&&R([He.clone(),He.negate()]);else if(Fe.fname==="sin")R(J.inverseFunctionSolve("asin",Fe,He));else if(Fe.fname==="cos")R(J.inverseFunctionSolve("acos",Fe,He));else if(Fe.fname==="tan")R(J.inverseFunctionSolve("atan",Fe,He));else if(Fe.fname===n.Settings.LOG){let it=re(Fe.args[0],m),Ge=it[1];if(Ge.group===Ue){He=t.divide(t.subtract(t.pow(Fe.args.length>1?Fe.args[1]:new te("e"),t.divide(He,t.parse(Fe.multiplier))),it[3]),it[0]);let Qe=new Ve(Ge,He).toLHS();R(w(Qe,m))}}else R(t.subtract(Fe,He));else{let it=new Ve(Fe,He).toLHS();if(it.equals(V))throw new Error("Stopping. No stop condition exists");R(w(it,m))}}catch(_e){if(_e.message==="timeout")throw _e;if(V.group===ye)R(0);else if(V.group===Se){let Fe=be(V),He=Fe[0],it=Fe[1];if(He.group===n.groups.EX&&He.value===m){let Ge=He.power.clone().invert();R(t.pow(it,Ge))}}}if(we&&(v=v.map(_e=>t.pow(_e,new te(we)))),ot(r)){let _e={};v=v.filter(Fe=>{try{_e[m]=Fe;let He=Number(ce(r,_e));return isNaN(He),!0}catch(He){if(He.message==="timeout")throw He;return!1}})}return v}e1.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build(){return w}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build(){return n.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build(){return et}}]),e1.updateAPI()})()});var vn=w0((Zi,g1)=>{"use strict";var t1;typeof g1<"u"&&(t1=b0(),Y0(),K0());(function(){let n=t1.getCore(),t=n.PARSER,{NerdamerSymbol:T}=n,{format:X}=n.Utils,{isVector:re}=n.Utils,{isArray:ce}=n.Utils,z=n.Vector,{S:ie}=n.groups,D=n.groups.EX,{CP:c}=n.groups,{PL:te}=n.groups,{CB:ot}=n.groups,{FN:Re}=n.groups;n.Settings.Laplace_integration_depth=40,T.prototype.findFunction=function(ye){if(this.group===Re&&this.fname===ye)return this.clone();let Se;if(this.symbols){for(let W in this.symbols)if(Object.hasOwn(this.symbols,W)&&(Se=this.symbols[W].findFunction(ye),Se))break}return Se};let Ue=n.Extra={version:"1.4.2",LaPlace:{transform(ge,ye,Se){ge=ge.clone(),ye=ye.toString(),ge=T.unwrapSQRT(ge,!0);let W,Ce=ge.stripVar(ye),qe=ge.group;if(ge=t.divide(ge,Ce.clone()),ge.isConstant()||!ge.contains(ye,!0))W=t.parse(X("({0})/({1})",ge,Se));else if(qe===ie&&n.Utils.isInt(ge.power)){let Be=String(ge.power);W=t.parse(X("factorial({0})/({1})^({0}+1)",Be,Se))}else if(ge.group===ie&&ge.power.equals(1/2))W=t.parse(X("sqrt(pi)/(2*({0})^(3/2))",Se));else if(ge.isComposite())W=new T(0),ge.each(Be=>{W=t.add(W,Ue.LaPlace.transform(Be,ye,Se))},!0);else if(ge.isE()&&(ge.power.group===ie||ge.power.group===ot)){let Be=ge.power.stripVar(ye);W=t.parse(X("1/(({1})-({0}))",Be,Se))}else{let Be=["sin","cos","sinh","cosh"];if(ge.group===Re&&Be.indexOf(ge.fname)!==-1&&(ge.args[0].group===ie||ge.args[0].group===ot)){let Ve=ge.args[0].stripVar(ye);switch(ge.fname){case"sin":W=t.parse(X("({0})/(({1})^2+({0})^2)",Ve,Se));break;case"cos":W=t.parse(X("({1})/(({1})^2+({0})^2)",Ve,Se));break;case"sinh":W=t.parse(X("({0})/(({1})^2-({0})^2)",Ve,Se));break;case"cosh":W=t.parse(X("({1})/(({1})^2-({0})^2)",Ve,Se));break}}else{let Ve=n.Settings.integration_depth<n.Settings.Laplace_integration_depth,et;Ve&&(et=n.Settings.integration_depth,n.Settings.integration_depth=n.Settings.Laplace_integration_depth),n.Utils.block("PARSE2NUMBER",()=>{let Oe=ye,J=ge.sub(ye,Oe),l=t.parse(`e^(-${Se}*${Oe})*${J}`);if(W=n.Calculus.integrate(l,Oe),W.hasIntegral()){W=t.symfunction("laplace",[ge,ye,Se]);return}W=W.sub(ye,0),W=t.expand(t.multiply(W,new T(-1))),W=W.sub(Oe,ye)},!1),W=n.Utils.block("PARSE2NUMBER",()=>t.parse(W),!0),Ve&&(n.Settings.integration_depth=et)}}return t.multiply(W,Ce)},inverse(ge,ye,Se){let W=ge.clone();return n.Utils.block("POSITIVE_MULTIPLIERS",()=>{let Ce;if(ge.group===ot&&(ge=n.Algebra.PartFrac.partfrac(t.expand(ge),ye)),ge.group===ie||ge.group===ot||ge.isComposite()){let qe,Be,Ve,et,Oe,J,l,w,r=ge.multiplier.clone();ge.toUnitMultiplier();let m=ge.getNum(),v=ge.getDenom().toUnitMultiplier();v.group===c||v.group===te?(Be=v.power.clone(),v.toLinear()):Be=new n.Frac(1);let y=ye.toString(),_=n.Utils.decompose_fn(v,y,!0),B=n.Utils.decompose_fn(t.expand(m.clone()),y,!0);m.multiplier=m.multiplier.multiply(r);let F=function(){Ce=t.multiply(Ce,m),Ce.multiplier=Ce.multiplier.multiply(ge.multiplier),Ce=t.divide(Ce,_.a)};if((v.group===ie||v.group===ot)&&_.x.value===y&&_.b.equals(0)&&n.Utils.isInt(_.x.power))qe=_.x.power-1,w=n.Math2.factorial(qe),Ce=t.divide(t.pow(Se,new T(qe)),new T(w)),F();else if(v.group===c&&Be.equals(1)){if(_.x.group===n.groups.PL&&n.Algebra.degree(v).equals(2)){let R=n.Algebra.sqComplete(v,y),V=n.Utils.getU(v);Ve=n.Utils.decompose_fn(R.a,y,!0).b;let K=Ue.LaPlace.inverse(t.parse(`1/((${V})^2+(${R.c}))`),V,Se);Ce=t.multiply(K,t.parse(`(${r})*e^(-(${Ve})*(${Se}))`))}else if(_.x.isLinear()&&!m.contains(y))Se=t.divide(Se,_.a.clone()),qe=Be-1,w=qe===0||qe===1?"1":`(${Be}-1)!`,Ce=t.parse(X("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))",Se,_.a,_.b,Be,w)),F();else if(_.x.group===ie&&_.x.power.equals(2))if(m.contains(y)){if(Ve=new T(1),m.group===ot){let me=new T(1);m.each(be=>{be.contains(y)?me=t.multiply(me,be):Ve=t.multiply(Ve,be)}),m=me}l=n.Utils.decompose_fn(m,y,!0);let R=l.a,V=l.b,K=R.containsFunction("sin"),ue=R.containsFunction("cos"),ne=V.containsFunction("cos"),we=V.containsFunction("sin");if(l.x.value===y&&l.x.isLinear()&&!(K&&ne||ue||we))Ce=t.parse(X("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",Se,l.a,_.a,_.b));else if(K&&ne){let me=R.findFunction("sin"),be=V.findFunction("cos");if(me.args[0].equals(be.args[0])&&!me.args[0].contains(y)){et=t.divide(V,be.toUnitMultiplier()).toString();let ze=me.args[0].toString();Oe=_.b;let _e=t.divide(R,me.toUnitMultiplier());J="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",Ce=t.parse(X(J,Se,Ve,et,ze,Oe,_e))}}}else Ce=t.parse(X("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",Se,m,_.a,_.b))}else if(_.x.power.num&&_.x.power.num.equals(3)&&_.x.power.den.equals(2)&&m.contains("sqrt(pi)")&&!m.contains(y)&&m.isLinear())et=t.divide(m.clone(),t.parse("sqrt(pi)")),Ce=t.parse(X("(2*({2})*sqrt({0}))/({1})",Se,_.a,et,m));else if(Be.equals(2)&&_.x.power.equals(2))if(m.contains(y))if(l=n.Utils.decompose_fn(t.expand(m.clone()),y,!0),l.x.isComposite()){let R=[],V=m.collectSymbols(K=>{K=T.unwrapPARENS(K);let ue=n.Utils.decompose_fn(K,y,!0);return ue.symbol=K,ue}).sort((K,ue)=>{let ne=K.x.value===y?K.x.power:0;return(ue.x.value===y?ue.x.power:0)-ne});Ve=new T(-1);for(let K=0;K<V.length;K++){let ue=V[K];ue.x.value===y?R.push(ue):Ve=t.multiply(Ve,ue.symbol)}R[0].x.power.equals(2)&&R[1].x.power.equals(1)&&R[1].b.equals(0)&&!R[0].b.equals(0)&&(et=R[0].a.negate(),J="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",Ce=t.parse(X(J,Se,Ve,et,R[0].b,_.a,_.b)))}else l.x.isLinear()?(Ve=t.divide(l.a,new T(2)),J="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",Ce=t.parse(X(J,Se,Ve,_.a,_.b))):l.x.power.equals(2)&&(l.b.equals(0)?(Ve=t.divide(l.a,new T(2)),J="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ce=t.parse(X(J,Se,Ve,_.a,_.b))):(Ve=t.divide(l.a,new T(2)),Oe=l.b.negate(),J="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",Ce=t.parse(X(J,Se,Ve,_.a,_.b,Oe))));else Ve=t.divide(m,new T(2)),J="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",Ce=t.parse(X(J,Se,Ve,_.a,_.b));else ge.isComposite()&&(Be.equals(2)&&_.x.group===ie?Ce=t.parse(`(${r})*(${Se})*e^(-(${_.b})*(${Se}))`):(Ce=new T(0),ge=n.Algebra.PartFrac.partfrac(t.expand(ge),ye),ge.each(R=>{Ce=t.add(Ce,Ue.LaPlace.inverse(R,ye,Se))},!0)))}return Ce||=t.symfunction("ilt",[W,ye,Se]),Ce},!0)}},Statistics:{frequencyMap(ge){let ye={};for(let Se=0,W=ge.length;Se<W;Se++){let qe=ge[Se].toString();ye[qe]||=0,ye[qe]++}return ye},sort(ge){return ge.sort((ye,Se)=>((!ye.isConstant()||!Se.isConstant())&&t.error("Unable to sort! All values must be numeric"),ye.multiplier.subtract(Se.multiplier)))},count(ge){return new T(ge.length)},sum(ge,ye){let Se=new T(0);for(let W=0,Ce=ge.length;W<Ce;W++){let qe=ge[W].clone();ye?Se=t.add(t.pow(t.subtract(qe,ye.clone()),new T(2)),Se):Se=t.add(qe,Se)}return Se},mean(...ge){return re(ge[0])?Ue.Statistics.mean(...ge[0].elements):t.divide(Ue.Statistics.sum(ge),Ue.Statistics.count(ge))},median(...ge){let ye;if(re(ge[0]))return Ue.Statistics.median(...ge[0].elements);try{let Se=Ue.Statistics.sort(ge),W=ge.length;if(n.Utils.even(W)){let Ce=W/2;ye=Ue.Statistics.mean(Se[Ce-1],Se[Ce])}else ye=Se[Math.floor(W/2)]}catch(Se){if(Se.message==="timeout")throw Se;ye=t.symfunction("median",ge)}return ye},mode(...ge){let ye;if(re(ge[0]))return Ue.Statistics.mode(...ge[0].elements);let Se=Ue.Statistics.frequencyMap(ge);if(n.Utils.keys(Se).length===1)ye=ge[0];else{let W={};for(let qe in Se){if(!Object.hasOwn(Se,qe))continue;let Be=Se[qe];if(Be in W){let Ve=W[Be];ce(Ve)?Ve.push(qe):W[Be]=[qe,W[Be]]}else W[Be]=qe}let Ce=W[Math.max.apply(null,n.Utils.keys(W))];ce(Ce)?ye=t.symfunction("mode",Ce.sort()):ye=t.parse(Ce)}return ye},gVariance(ge,ye){let Se=Ue.Statistics.mean(...ye),W=Ue.Statistics.sum(ye,Se);return t.multiply(ge,W)},variance(...ge){if(re(ge[0]))return Ue.Statistics.variance(...ge[0].elements);let ye=t.divide(new T(1),Ue.Statistics.count(ge));return Ue.Statistics.gVariance(ye,ge)},sampleVariance(...ge){if(re(ge[0]))return Ue.Statistics.sampleVariance(...ge[0].elements);let ye=t.divide(new T(1),t.subtract(Ue.Statistics.count(ge),new T(1)));return Ue.Statistics.gVariance(ye,ge)},standardDeviation(...ge){return re(ge[0])?Ue.Statistics.standardDeviation(...ge[0].elements):t.pow(Ue.Statistics.variance(...ge),new T(1/2))},sampleStandardDeviation(...ge){return re(ge[0])?Ue.Statistics.sampleStandardDeviation(...ge[0].elements):t.pow(Ue.Statistics.sampleVariance(...ge),new T(1/2))},zScore(ge,ye,Se){return t.divide(t.subtract(ge,ye),Se)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};t1.register([{name:"laplace",visible:!0,numargs:3,build(){return Ue.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build(){return Ue.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build(){return Ue.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build(){return Ue.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build(){return Ue.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build(){return Ue.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build(){return Ue.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build(){return Ue.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build(){return Ue.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build(){return Ue.Statistics.zScore}}]),t1.updateAPI()})();typeof g1<"u"&&(g1.exports=t1)});var bi=w0((zi,yn)=>{var Pi=b0();K0();Y0();Sn();vn();yn.exports=Pi});return bi();})();
/*! Bundled license information:

decimal.js/decimal.js:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
